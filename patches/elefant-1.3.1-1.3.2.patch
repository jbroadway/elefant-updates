Files elefant-1.3.1-beta/.htaccess and elefant-1.3.2-beta/.htaccess are identical
Files elefant-1.3.1-beta/LICENSE and elefant-1.3.2-beta/LICENSE are identical
Files elefant-1.3.1-beta/README.md and elefant-1.3.2-beta/README.md are identical
Files elefant-1.3.1-beta/apps/.htaccess and elefant-1.3.2-beta/apps/.htaccess are identical
Files elefant-1.3.1-beta/apps/admin/conf/config.php and elefant-1.3.2-beta/apps/admin/conf/config.php are identical
diff -urBNs elefant-1.3.1-beta/apps/admin/conf/embed.php elefant-1.3.2-beta/apps/admin/conf/embed.php
--- elefant-1.3.1-beta/apps/admin/conf/embed.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/admin/conf/embed.php	2012-09-13 09:15:24.000000000 -0500
@@ -17,6 +17,20 @@
 code[require] = "apps/admin/lib/Functions.php"
 code[callback] = "admin_status_codes"
 
+[admin/conditionalforward]
+label ="Pages: Conditional Redirect"
+
+to[label] = link
+to[type] = text
+to[initial] = "http://"
+to[regex] = "|^(http:/)?/.+$|"
+to[message] = Please enter a valid URL.
+
+user_type[label] = Access
+user_type[type] = select
+user_type[require] = "apps/admin/lib/Functions.php"
+user_type[callback] = "admin_user_groups"
+
 [admin/html]
 
 label = "Embed HTML Code"
@@ -28,4 +42,4 @@
 id[require] = "apps/admin/lib/Functions.php"
 id[filter] = admin_embed_filter
 
-; */ ?>
\ No newline at end of file
+; */ ?>
Files elefant-1.3.1-beta/apps/admin/css/960.css and elefant-1.3.2-beta/apps/admin/css/960.css are identical
Files elefant-1.3.1-beta/apps/admin/css/admin/add.png and elefant-1.3.2-beta/apps/admin/css/admin/add.png are identical
Files elefant-1.3.1-beta/apps/admin/css/admin/arrow-down.png and elefant-1.3.2-beta/apps/admin/css/admin/arrow-down.png are identical
Files elefant-1.3.1-beta/apps/admin/css/admin/arrow-right.png and elefant-1.3.2-beta/apps/admin/css/admin/arrow-right.png are identical
Files elefant-1.3.1-beta/apps/admin/css/admin/delete.png and elefant-1.3.2-beta/apps/admin/css/admin/delete.png are identical
Files elefant-1.3.1-beta/apps/admin/css/admin/dynamic-icon.png and elefant-1.3.2-beta/apps/admin/css/admin/dynamic-icon.png are identical
Files elefant-1.3.1-beta/apps/admin/css/admin/edit.png and elefant-1.3.2-beta/apps/admin/css/admin/edit.png are identical
Files elefant-1.3.1-beta/apps/admin/css/admin/elefant_logo.png and elefant-1.3.2-beta/apps/admin/css/admin/elefant_logo.png are identical
Files elefant-1.3.1-beta/apps/admin/css/admin/elefant_logo_login.png and elefant-1.3.2-beta/apps/admin/css/admin/elefant_logo_login.png are identical
Files elefant-1.3.1-beta/apps/admin/css/admin/file.png and elefant-1.3.2-beta/apps/admin/css/admin/file.png are identical
Files elefant-1.3.1-beta/apps/admin/css/admin/folder.png and elefant-1.3.2-beta/apps/admin/css/admin/folder.png are identical
Files elefant-1.3.1-beta/apps/admin/css/admin/lock.png and elefant-1.3.2-beta/apps/admin/css/admin/lock.png are identical
Files elefant-1.3.1-beta/apps/admin/css/admin/spacer.png and elefant-1.3.2-beta/apps/admin/css/admin/spacer.png are identical
Files elefant-1.3.1-beta/apps/admin/css/admin/tooltip-top.png and elefant-1.3.2-beta/apps/admin/css/admin/tooltip-top.png are identical
Files elefant-1.3.1-beta/apps/admin/css/admin/versions.png and elefant-1.3.2-beta/apps/admin/css/admin/versions.png are identical
diff -urBNs elefant-1.3.1-beta/apps/admin/css/admin.css elefant-1.3.2-beta/apps/admin/css/admin.css
--- elefant-1.3.1-beta/apps/admin/css/admin.css	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/admin/css/admin.css	2012-09-13 09:15:24.000000000 -0500
@@ -64,6 +64,12 @@
 	padding: 3px 3px 3px 7px;
 }
 
+.visible-notice {
+	border: 1px solid #fcd9a1;
+	background: #faf7e5;
+	padding: 3px 3px 3px 7px;
+}
+
 .different {
 	background: #e5f2ff;
 }
Files elefant-1.3.1-beta/apps/admin/css/debugger.css and elefant-1.3.2-beta/apps/admin/css/debugger.css are identical
Files elefant-1.3.1-beta/apps/admin/css/jquery.jgrowl.css and elefant-1.3.2-beta/apps/admin/css/jquery.jgrowl.css are identical
diff -urBNs elefant-1.3.1-beta/apps/admin/css/modal.css elefant-1.3.2-beta/apps/admin/css/modal.css
--- elefant-1.3.1-beta/apps/admin/css/modal.css	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/admin/css/modal.css	2012-09-13 09:15:24.000000000 -0500
@@ -48,4 +48,5 @@
 	border-top: 0px none;
 	padding: 15px;
 	height: 202px;
+	overflow-y: auto;
 }
Files elefant-1.3.1-beta/apps/admin/css/reset.css and elefant-1.3.2-beta/apps/admin/css/reset.css are identical
Files elefant-1.3.1-beta/apps/admin/css/text.css and elefant-1.3.2-beta/apps/admin/css/text.css are identical
Files elefant-1.3.1-beta/apps/admin/css/top-bar.css and elefant-1.3.2-beta/apps/admin/css/top-bar.css are identical
Files elefant-1.3.1-beta/apps/admin/forms/add.php and elefant-1.3.2-beta/apps/admin/forms/add.php are identical
Files elefant-1.3.1-beta/apps/admin/forms/edit.php and elefant-1.3.2-beta/apps/admin/forms/edit.php are identical
Files elefant-1.3.1-beta/apps/admin/handlers/add.php and elefant-1.3.2-beta/apps/admin/handlers/add.php are identical
diff -urBNs elefant-1.3.1-beta/apps/admin/handlers/bgsave.php elefant-1.3.2-beta/apps/admin/handlers/bgsave.php
--- elefant-1.3.1-beta/apps/admin/handlers/bgsave.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/admin/handlers/bgsave.php	2012-09-13 09:15:24.000000000 -0500
@@ -32,7 +32,7 @@
 		$error = $o->error;
 	} else {
 		Versions::add ($o);
-		$memcache->delete ('_admin_page_' . $_GET['id']);
+		$cache->delete ('_admin_page_' . $_GET['id']);
 		$_POST['page'] = $_GET['id'];
 		$this->hook ('admin/edit', $_POST);
 	}
@@ -49,4 +49,4 @@
 
 echo json_encode ($res);
 
-?>
\ No newline at end of file
+?>
Files elefant-1.3.1-beta/apps/admin/handlers/cancel.php and elefant-1.3.2-beta/apps/admin/handlers/cancel.php are identical
Files elefant-1.3.1-beta/apps/admin/handlers/compare.php and elefant-1.3.2-beta/apps/admin/handlers/compare.php are identical
diff -urBNs elefant-1.3.1-beta/apps/admin/handlers/conditionalforward.php elefant-1.3.2-beta/apps/admin/handlers/conditionalforward.php
--- elefant-1.3.1-beta/apps/admin/handlers/conditionalforward.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/admin/handlers/conditionalforward.php	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,27 @@
+<?php
+
+/**
+ * Forwards a user to the specified URL location
+ * if they match a specific access level.
+ * Works as a dynamic object to be embedded
+ * into the WYSIWYG editor.
+ */
+
+$url = isset ($data['to']) ? $data['to'] : $_GET['to'];
+$user_type = isset ($data['user_type']) ? $data['user_type'] : $_GET['user_type'];
+
+if (User::is_valid () && User::is ('admin')) {
+	printf (
+		'<p>%s:</p><p><a href="%s">%s</a></p>',
+		i18n_getf ('This page forwards members of the %s group to the following link', $user_type),
+		$url,
+		$url
+	);
+	return;
+}
+
+if (User::is ($user_type)) {
+	$this->redirect ($url);
+}
+
+?>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/admin/handlers/delete.php elefant-1.3.2-beta/apps/admin/handlers/delete.php
--- elefant-1.3.1-beta/apps/admin/handlers/delete.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/admin/handlers/delete.php	2012-09-13 09:15:24.000000000 -0500
@@ -25,9 +25,9 @@
 	return;
 }
 
-$memcache->delete ('_admin_page_' . $_GET['page']);
+$cache->delete ('_admin_page_' . $_GET['page']);
 $this->add_notification (i18n_get ('Page deleted.'));
 $this->hook ('admin/delete', $_GET);
 $this->redirect ('/');
 
-?>
\ No newline at end of file
+?>
diff -urBNs elefant-1.3.1-beta/apps/admin/handlers/edit.php elefant-1.3.2-beta/apps/admin/handlers/edit.php
--- elefant-1.3.1-beta/apps/admin/handlers/edit.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/admin/handlers/edit.php	2012-09-13 09:15:24.000000000 -0500
@@ -38,7 +38,7 @@
 	$wp->put ();
 	if (! $wp->error) {
 		Versions::add ($wp);
-		$memcache->delete ('_admin_page_' . $_GET['page']);
+		$cache->delete ('_admin_page_' . $_GET['page']);
 		$this->add_notification (i18n_get ('Page saved.'));
 		$_POST['page'] = $_GET['page'];
 		$lock->remove ();
@@ -57,4 +57,4 @@
 	echo $tpl->render ('admin/edit', $wp);
 }
 
-?>
\ No newline at end of file
+?>
Files elefant-1.3.1-beta/apps/admin/handlers/embed/filters.php and elefant-1.3.2-beta/apps/admin/handlers/embed/filters.php are identical
Files elefant-1.3.1-beta/apps/admin/handlers/embed.php and elefant-1.3.2-beta/apps/admin/handlers/embed.php are identical
Files elefant-1.3.1-beta/apps/admin/handlers/error.php and elefant-1.3.2-beta/apps/admin/handlers/error.php are identical
Files elefant-1.3.1-beta/apps/admin/handlers/forward.php and elefant-1.3.2-beta/apps/admin/handlers/forward.php are identical
Files elefant-1.3.1-beta/apps/admin/handlers/head/links.php and elefant-1.3.2-beta/apps/admin/handlers/head/links.php are identical
Files elefant-1.3.1-beta/apps/admin/handlers/head.php and elefant-1.3.2-beta/apps/admin/handlers/head.php are identical
Files elefant-1.3.1-beta/apps/admin/handlers/html.php and elefant-1.3.2-beta/apps/admin/handlers/html.php are identical
diff -urBNs elefant-1.3.1-beta/apps/admin/handlers/index.php elefant-1.3.2-beta/apps/admin/handlers/index.php
--- elefant-1.3.1-beta/apps/admin/handlers/index.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/admin/handlers/index.php	2012-09-13 09:15:24.000000000 -0500
@@ -13,6 +13,14 @@
 	$_POST['redirect'] = $_GET['redirect'];
 }
 
+if (! isset ($_POST['redirect']) || empty ($_POST['redirect'])) {
+	$_POST['redirect'] = '/';
+}
+
+if (! Validator::validate ($_POST['redirect'], 'header')) {
+	$_POST['redirect'] = '/';
+}
+
 if (! User::require_admin ()) {
 	$page->title = sprintf (
 		'<img src="%s" alt="%s" style="margin-left: -7px" />',
@@ -29,14 +37,6 @@
 	return;
 }
 
-if (! isset ($_POST['redirect']) || empty ($_POST['redirect'])) {
-	$_POST['redirect'] = '/';
-}
-
-if (! Form::verify_value ($_POST['redirect'], 'header')) {
-	$_POST['redirect'] = '/';
-}
-
 $this->redirect ($_POST['redirect']);
 
 ?>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/admin/handlers/page.php elefant-1.3.2-beta/apps/admin/handlers/page.php
--- elefant-1.3.1-beta/apps/admin/handlers/page.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/admin/handlers/page.php	2012-09-13 09:15:24.000000000 -0500
@@ -11,7 +11,7 @@
 $id = count ($this->params) ? $this->params[0] : 'index';
 
 // check if cached
-$res = $memcache->get ('_admin_page_' . $id);
+$res = $cache->get ('_admin_page_' . $id);
 if ($res) {
 	$page = (is_object ($res)) ? $res : unserialize ($res);
 
@@ -37,7 +37,7 @@
 }
 
 // access control
-if ($wp->access !== 'public') {
+if ($wp->access !== 'public' && ! User::is ('admin')) {
 	if (! User::require_login ()) {
 		$page->title = i18n_get ('Login required');
 		echo $this->run ('user/login');
@@ -61,7 +62,7 @@
 $page->head = $wp->head;
 
 // show admin edit buttons
-if (User::is_valid () && User::is ('admin')) {
+if (User::is_valid () && User::is('admin')) {
 	$lock = new Lock ('Webpage', $id);
 	$page->locked = $lock->exists ();
 	echo $tpl->render ('admin/editable', $page);
@@ -73,10 +74,10 @@
 if ($wp->access == 'public' && $out === $wp->body) {
 	// public page, no includes, cacheable.
 	$page->body = $out;
-	$memcache->set ('_admin_page_' . $id, serialize ($page));
+	$cache->set ('_admin_page_' . $id, serialize ($page));
 }
 
 // output the page body
 echo $out;
 
-?>
\ No newline at end of file
+?>
diff -urBNs elefant-1.3.1-beta/apps/admin/handlers/pages.php elefant-1.3.2-beta/apps/admin/handlers/pages.php
--- elefant-1.3.1-beta/apps/admin/handlers/pages.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/admin/handlers/pages.php	2012-09-13 09:15:24.000000000 -0500
@@ -1,18 +1,23 @@
 <?php
 
+/**
+ * Show a list of all pages for admins.
+ */
+
 $this->require_admin ();
 
 $page->layout = 'admin';
 $page->title = i18n_get ('All Pages');
 
 $limit = 20;
-$_GET['offset'] = (isset ($_GET['offset'])) ? $_GET['offset'] : 0;
+$num = isset ($_GET['offset']) ? $_GET['offset'] : 1;
+$offset = ($num - 1) * $limit;
 
 $lock = new Lock ();
 
 $pages = Webpage::query ('id, title, access')
 	->order ('title asc')
-	->fetch_orig ($limit, $_GET['offset']);
+	->fetch_orig ($limit, $offset);
 $count = Webpage::query ()->count ();
 
 foreach ($pages as $k => $p) {
@@ -20,12 +25,11 @@
 }
 
 echo $tpl->render ('admin/pages', array (
+	'limit' => $limit,
+	'total' => $count,
 	'pages' => $pages,
-	'count' => $count,
-	'offset' => $_GET['offset'],
-	'more' => ($count > $_GET['offset'] + $limit) ? true : false,
-	'prev' => $_GET['offset'] - $limit,
-	'next' => $_GET['offset'] + $limit
+	'count' => count ($pages),
+	'url' => '/admin/pages?offset=%d'
 ));
 
 ?>
\ No newline at end of file
Files elefant-1.3.1-beta/apps/admin/handlers/preview.php and elefant-1.3.2-beta/apps/admin/handlers/preview.php are identical
diff -urBNs elefant-1.3.1-beta/apps/admin/handlers/restore.php elefant-1.3.2-beta/apps/admin/handlers/restore.php
--- elefant-1.3.1-beta/apps/admin/handlers/restore.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/admin/handlers/restore.php	2012-09-13 09:15:24.000000000 -0500
@@ -34,9 +34,9 @@
 
 $this->add_notification ('Item restored.');
 if ($ver->class == 'Webpage') {
-	$memcache->delete ('_admin_page_' . $obj->id);
+	$cache->delete ('_admin_page_' . $obj->id);
 	$this->redirect ('/' . $obj->id);
 }
 $this->redirect ('/');
 
-?>
\ No newline at end of file
+?>
diff -urBNs elefant-1.3.1-beta/apps/admin/handlers/util/dates.php elefant-1.3.2-beta/apps/admin/handlers/util/dates.php
--- elefant-1.3.1-beta/apps/admin/handlers/util/dates.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/admin/handlers/util/dates.php	2012-09-13 09:15:24.000000000 -0500
@@ -37,17 +37,19 @@
 	i18n_get ('January February March April May June July August September October November December')
 );
 
+global $i18n;
+
 $page->add_script ('/js/jquery.localize.min.js');
 $page->add_script ('<script>
 $(function () {
 	$.localize_dates = function () {
 		$.localize.fullMonths = ' . json_encode ($full_months) . ';
 		$.localize.abbrMonths = ' . json_encode ($abbr_months) . ';
-		$(\'time.datetime\').localize(\'mmmm d, yyyy - h:MMa\');
-		$(\'time.shortdatetime\').localize(\'mmm d - h:MMa\');
-		$(\'time.date\').localize(\'mmmm d, yyyy\');
-		$(\'time.shortdate\').localize(\'mmm d\');
-		$(\'time.time\').localize(\'h:MMa\');
+		$(\'time.datetime\').localize(\'' . $i18n->date_format . ' - ' . $i18n->time_format . '\');
+		$(\'time.shortdatetime\').localize(\'' . $i18n->short_format . ' - ' . $i18n->time_format . '\');
+		$(\'time.date\').localize(\'' . $i18n->date_format . '\');
+		$(\'time.shortdate\').localize(\'' . $i18n->short_format . '\');
+		$(\'time.time\').localize(\'' . $i18n->time_format . '\');
 	};
 	$.localize_dates ();
 });
Files elefant-1.3.1-beta/apps/admin/handlers/util/modal.php and elefant-1.3.2-beta/apps/admin/handlers/util/modal.php are identical
diff -urBNs elefant-1.3.1-beta/apps/admin/handlers/util/wysiwyg.php elefant-1.3.2-beta/apps/admin/handlers/util/wysiwyg.php
--- elefant-1.3.1-beta/apps/admin/handlers/util/wysiwyg.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/admin/handlers/util/wysiwyg.php	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,12 @@
+<?php
+
+/**
+ * Call this to turn a textarea into a wysiwyg editor.
+ * To specify a custom field ID, call it like this:
+ *
+ *     {! admin/util/wysiwyg?field_id=my_field !}
+ */
+
+echo $tpl->render ('admin/wysiwyg', $data);
+
+?>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/admin/handlers/validator.php elefant-1.3.2-beta/apps/admin/handlers/validator.php
--- elefant-1.3.1-beta/apps/admin/handlers/validator.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/admin/handlers/validator.php	2012-09-13 09:15:24.000000000 -0500
@@ -7,15 +7,25 @@
  * validation.
  */
 
-if (count ($this->params) != 2) {
+if (count ($this->params) < 2) {
 	die ('Usage: /admin/validator/app/form');
-} elseif (! preg_match ('/^[a-zA-Z0-9_-]+$/', $this->params[0]) || ! preg_match ('/^[a-zA-Z0-9_-]+$/', $this->params[1])) {
+}
+
+$app = array_shift ($this->params);
+
+if (count ($this->params) > 1) {
+	$form = join ('/', $this->params);
+} else {
+	$form = $this->params[0];
+}
+
+if (! preg_match ('/^[a-zA-Z0-9_-]+$/', $app) || ! preg_match ('/^[a-zA-Z0-9\/_-]+$/', $form)) {
 	die ('Invalid app or form name');
-} elseif (! @file_exists ('apps/' . $this->params[0] . '/forms/' . $this->params[1] . '.php')) {
+} elseif (! @file_exists ('apps/' . $app . '/forms/' . $form . '.php')) {
 	die ('Form not found');
 }
 
-$rules = file_get_contents ('apps/' . $this->params[0] . '/forms/' . $this->params[1] . '.php');
+$rules = file_get_contents ('apps/' . $app . '/forms/' . $form . '.php');
 $rules = preg_replace ('/\$_(GET|POST|REQUEST)\[\'?(.+?)\'?\]/', '\2', $rules);
 $rules = parse_ini_string ($rules, true);
 
diff -urBNs elefant-1.3.1-beta/apps/admin/handlers/versions.php elefant-1.3.2-beta/apps/admin/handlers/versions.php
--- elefant-1.3.1-beta/apps/admin/handlers/versions.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/admin/handlers/versions.php	2012-09-13 09:15:24.000000000 -0500
@@ -7,12 +7,11 @@
 
 $page->layout = 'admin';
 
-if (! User::require_admin ()) {
-	$this->redirect ('/admin');
-}
+$this->require_admin ();
 
 $limit = 20;
-$_GET['offset'] = (isset ($_GET['offset'])) ? $_GET['offset'] : 0;
+$num = isset ($_GET['offset']) ? $_GET['offset'] : 1;
+$offset = ($num - 1) * $limit;
 $_GET['type'] = (isset ($_GET['type'])) ? $_GET['type'] : 'Webpage';
 
 $classes = Versions::get_classes ();
@@ -30,7 +29,7 @@
 	} else {
 		$obj = $class;
 	}
-	$history = Versions::history ($obj, $limit, $_GET['offset']);
+	$history = Versions::history ($obj, $limit, $offset);
 	$count = Versions::history ($obj, true);
 } else {
 	$history = array ();
@@ -45,9 +44,9 @@
 	return $u->name;
 }
 
-$page->title = i18n_get ('Versions of') . ' ' . $_GET['type'];
+$page->title = i18n_get ('Versions of') . ' ' . Template::sanitize ($_GET['type']);
 if (! empty ($_GET['id'])) {
-	$page->title .= ' / ' . $_GET['id'];
+	$page->title .= ' / ' . Template::sanitize ($_GET['id']);
 }
 
 echo $tpl->render ('admin/versions', array (
@@ -55,11 +54,10 @@
 	'type' => $_GET['type'],
 	'classes' => $classes,
 	'history' => $history,
-	'count' => $count,
-	'offset' => $_GET['offset'],
-	'more' => ($count > $_GET['offset'] + $limit) ? true : false,
-	'prev' => $_GET['offset'] - $limit,
-	'next' => $_GET['offset'] + $limit,
+	'limit' => $limit,
+	'total' => $count,
+	'count' => count ($history),
+	'url' => sprintf ('/admin/versions?type=%s&id=%s&offset=%%d', $_GET['type'], $_GET['id']),
 	'deleted' => $deleted
 ));
 
Files elefant-1.3.1-beta/apps/admin/handlers/wysiwyg/links.php and elefant-1.3.2-beta/apps/admin/handlers/wysiwyg/links.php are identical
Files elefant-1.3.1-beta/apps/admin/js/jquery.jgrowl.min.js and elefant-1.3.2-beta/apps/admin/js/jquery.jgrowl.min.js are identical
Files elefant-1.3.1-beta/apps/admin/js/jquery.simplemodal.1.4.2.min.js and elefant-1.3.2-beta/apps/admin/js/jquery.simplemodal.1.4.2.min.js are identical
Files elefant-1.3.1-beta/apps/admin/js/modal.js and elefant-1.3.2-beta/apps/admin/js/modal.js are identical
diff -urBNs elefant-1.3.1-beta/apps/admin/js/top-bar.js elefant-1.3.2-beta/apps/admin/js/top-bar.js
--- elefant-1.3.1-beta/apps/admin/js/top-bar.js	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/admin/js/top-bar.js	2012-09-13 09:15:24.000000000 -0500
@@ -1,3 +1,9 @@
+/**
+ * Provides client-side equivalent to `Controller::add_notification()`.
+ * Usage:
+ *
+ *     $.add_notification('My notification.');
+ */
 jQuery.add_notification = function (msg) {
 	var notices = $.cookie ('elefant_notification');
 	if (notices !== null) {
@@ -6,6 +12,43 @@
 	$.cookie ('elefant_notification', msg, {path: '/'});
 };
 
+/**
+ * Adds a confirmation to a link and turns its `data-*` properties
+ * into a `POST` request. Usage:
+ *
+ *     <a href="/post/here"
+ *        data-id="{{id}}"
+ *        onclick="$.confirm_and_post (this, 'Are you sure?')"
+ *     >Delete</a>
+ */
+jQuery.confirm_and_post = function (el, msg) {
+	if (window.event) {
+		window.event.preventDefault ();
+	}
+
+	if (! confirm (msg)) {
+		return false;
+	}
+
+	var $el = $(el),
+		params = $el.data ()
+		url = $el.attr ('href'),
+		$form = $('<form>')
+			.attr ('method', 'post')
+			.attr ('action', url);
+
+	$.each (params, function (name, value) {
+		$('<input type="hidden">')
+			.attr ('name', name)
+			.attr ('value', value)
+			.appendTo ($form);
+	});
+
+	$form.appendTo ('body');
+	$form.submit ();
+	return false;
+};
+
 $(function () {
 	var sliding_up = false;
 	$('body').append ('<div id="admin-bar"><div id="admin-links"></div><a href="/"><img id="admin-logo" src="/apps/admin/css/admin/spacer.png" alt="" /></a></div>');
Files elefant-1.3.1-beta/apps/admin/lib/Diff.php and elefant-1.3.2-beta/apps/admin/lib/Diff.php are identical
diff -urBNs elefant-1.3.1-beta/apps/admin/lib/Functions.php elefant-1.3.2-beta/apps/admin/lib/Functions.php
--- elefant-1.3.1-beta/apps/admin/lib/Functions.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/admin/lib/Functions.php	2012-09-13 09:15:24.000000000 -0500
@@ -40,9 +40,17 @@
 	);
 	foreach ($sources as $source) {
 		$files = glob ($source);
-		foreach ($files as $file) {
-			if (preg_match ('/\/([^\/]+)\.html$/', $file, $regs)) {
-				$layouts[] = $regs[1];
+		if ($files) {
+			foreach ($files as $file) {
+				if (preg_match ('/\/([^\/]+)\/([^\/]+)\.html$/', $file, $regs)) {
+					if ($regs[1] === $regs[2]) {
+						$layouts[] = $regs[1];
+					} else {
+						$layouts[] = $regs[1] . '/' . $regs[2];
+					}
+				} elseif (preg_match ('/\/([^\/]+)\.html$/', $file, $regs)) {
+					$layouts[] = $regs[1];
+				}
 			}
 		}
 	}
@@ -73,4 +81,19 @@
 	);
 }
 
+/**
+ * User access levels for the admin/conditional_forward dynamic object embed.
+ */
+function admin_user_groups () {
+	$list = User::access_list ();
+	$out = array ();
+	foreach ($list as $access) {
+		$out[] = (object) array (
+			'key' => $access,
+			'value' => i18n_get (ucfirst ($access))
+		);
+	}
+	return $out;
+}
+
 ?>
\ No newline at end of file
Files elefant-1.3.1-beta/apps/admin/lib/Lock.php and elefant-1.3.2-beta/apps/admin/lib/Lock.php are identical
diff -urBNs elefant-1.3.1-beta/apps/admin/models/Versions.php elefant-1.3.2-beta/apps/admin/models/Versions.php
--- elefant-1.3.1-beta/apps/admin/models/Versions.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/admin/models/Versions.php	2012-09-13 09:15:24.000000000 -0500
@@ -25,42 +25,46 @@
  */
 
 /**
- * Keeps a change history of any Model object.
+ * Keeps a change history of any [[Model]] object.
  *
  * Usage:
  *
- *   // saving a new version
- *   Versions::add ($obj);
- *
- *   // getting the history of an object
- *   $history = Versions::history ($obj);
- *
- *   // get recent changes by current user
- *   $recent = Versions::recent (User::$user);
- *
- *   // compare current version of a web page to previous:
- *
- *   // 1. fetch the page
- *   $w = new Webpage ('index');
- *
- *   // 2. get the previous version (limit=1, offset=1)
- *   $history = Versions::history ($w, 1, 1);
- *
- *   // 3. restore the first result's object
- *   $v = new Versions;
- *   $w2 = $v->restore ($history[0]);
- *
- *   // 4. compare the two
- *   $modified_fields = Versions::diff ($w, $w2);
+ *     <?php
+ *     
+ *     // saving a new version
+ *     Versions::add ($obj);
+ *     
+ *     // getting the history of an object
+ *     $history = Versions::history ($obj);
+ *     
+ *     // get recent changes by current user
+ *     $recent = Versions::recent (User::$user);
+ *     
+ *     // compare current version of a web page to previous:
+ *     
+ *     // 1. fetch the page
+ *     $w = new Webpage ('index');
+ *     
+ *     // 2. get the previous version (limit=1, offset=1)
+ *     $history = Versions::history ($w, 1, 1);
+ *     
+ *     // 3. restore the first result's object
+ *     $v = new Versions;
+ *     $w2 = $v->restore ($history[0]);
+ *     
+ *     // 4. compare the two
+ *     $modified_fields = Versions::diff ($w, $w2);
+ *     
+ *     ?>
  *
  * Fields:
  *
- * id - versions id
- * class - class name of the object
- * pkey - object's 'key' field value
- * user - user id or 0 if no user saved
- * ts - date/time of the change
- * serialized - serialized version of the object
+ * - `id` - versions id
+ * - `class` - class name of the object
+ * - `pkey` - object's 'key' field value
+ * - `user` - user id or 0 if no user saved
+ * - `ts` - date/time of the change
+ * - `serialized` - serialized version of the object
  */
 class Versions extends Model {
 	/**
@@ -80,7 +84,7 @@
 
 	/**
 	 * Recreate an object from the stored version. Takes any
-	 * result from recent() or history().
+	 * result from `recent()` or `history()`.
 	 */
 	public function restore ($vobj = false) {
 		if (! $vobj) {
@@ -152,7 +156,7 @@
 	 * of the changes themselves. Note that this looks at the data array
 	 * of the Model objects, not object properties, so it will not work
 	 * on ordinary objects, only Model-based objects and objects returned
-	 * by the recent() and history() methods.
+	 * by the `recent()` and `history()` methods.
 	 */
 	public static function diff ($obj1, $obj2) {
 		if (get_class ($obj1) === 'stdClass') {
Files elefant-1.3.1-beta/apps/admin/models/Webpage.php and elefant-1.3.2-beta/apps/admin/models/Webpage.php are identical
diff -urBNs elefant-1.3.1-beta/apps/admin/views/add/head.html elefant-1.3.2-beta/apps/admin/views/add/head.html
--- elefant-1.3.1-beta/apps/admin/views/add/head.html	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/admin/views/add/head.html	2012-09-13 09:15:24.000000000 -0500
@@ -1,8 +1,9 @@
-<script type="text/javascript" src="/js/json2.js"></script>
-<script type="text/javascript" src="/js/jstorage.js"></script>
-<script type="text/javascript" src="/js/jquery.autosave.js"></script>
-<script type="text/javascript" src="/js/jquery.verify_values.js"></script>
-<script type="text/javascript">
+<script src="/js/json2.js"></script>
+<script src="/js/jstorage.js"></script>
+<script src="/js/jquery.autosave.js"></script>
+<script src="/js/jquery.verify_values.js"></script>
+<script src="/js/urlify.js"></script>
+<script>
 $(function () {
 	$('#add-form').verify_values ({
 		handler: 'admin/add',
@@ -26,7 +27,7 @@
 });
 function webpage_add_title_to_id (f) {
 	if (f.elements.id.value == '') {
-		f.elements.id.value = f.elements.title.value.toLowerCase ().replace (/[^a-z0-9\-]+/g, '-');
+		f.elements.id.value = URLify (f.elements.title.value, 60).replace (/-$/, '');
 	}
 }
 function webpage_show_extra_options (link) {
diff -urBNs elefant-1.3.1-beta/apps/admin/views/add.html elefant-1.3.2-beta/apps/admin/views/add.html
--- elefant-1.3.1-beta/apps/admin/views/add.html	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/admin/views/add.html	2012-09-13 09:15:24.000000000 -0500
@@ -21,7 +21,7 @@
 <p>{"Access"}:<br />
 <select name="access">
 {% foreach User::access_list () %}
-	<option value="{{ loop_value }}"{% if access === $data->loop_value %} selected{% end %}>{{ loop_value|ucfirst }}</option>
+	<option value="{{ loop_value }}"{% if access === $data->loop_value %} selected{% end %}>{{ loop_value|ucfirst|i18n_get }}</option>
 {% end %}
 </select></p>
 <p>{"Alternate menu title"}:<br /><input type="text" name="menu_title" size="40" value="{{ menu_title }}" /></p>
Files elefant-1.3.1-beta/apps/admin/views/base.html and elefant-1.3.2-beta/apps/admin/views/base.html are identical
Files elefant-1.3.1-beta/apps/admin/views/compare.html and elefant-1.3.2-beta/apps/admin/views/compare.html are identical
Files elefant-1.3.1-beta/apps/admin/views/default-validation.html and elefant-1.3.2-beta/apps/admin/views/default-validation.html are identical
diff -urBNs elefant-1.3.1-beta/apps/admin/views/edit/head.html elefant-1.3.2-beta/apps/admin/views/edit/head.html
--- elefant-1.3.1-beta/apps/admin/views/edit/head.html	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/admin/views/edit/head.html	2012-09-13 09:15:24.000000000 -0500
@@ -1,9 +1,10 @@
-<script type="text/javascript" src="/js/json2.js"></script>
-<script type="text/javascript" src="/js/jstorage.js"></script>
-<script type="text/javascript" src="/js/jquery.autosave.js"></script>
-<script type="text/javascript" src="/js/jquery.bgsave.js"></script>
-<script type="text/javascript" src="/js/jquery.verify_values.js"></script>
-<script type="text/javascript">
+<script src="/js/json2.js"></script>
+<script src="/js/jstorage.js"></script>
+<script src="/js/jquery.autosave.js"></script>
+<script src="/js/jquery.bgsave.js"></script>
+<script src="/js/jquery.verify_values.js"></script>
+<script src="/js/urlify.js"></script>
+<script>
 $(function () {
 	$('#edit-form').verify_values ({
 		handler: 'admin/edit',
@@ -34,7 +35,7 @@
 });
 function webpage_add_title_to_id (f) {
 	if (f.elements.id.value == '') {
-		f.elements.id.value = f.elements.title.value.toLowerCase ().replace (/[^a-z0-9\-]+/g, '-');
+		f.elements.id.value = URLify (f.elements.title.value, 60).replace (/-$/, '');
 	}
 }
 function webpage_show_extra_options (link) {
diff -urBNs elefant-1.3.1-beta/apps/admin/views/edit.html elefant-1.3.2-beta/apps/admin/views/edit.html
--- elefant-1.3.1-beta/apps/admin/views/edit.html	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/admin/views/edit.html	2012-09-13 09:15:24.000000000 -0500
@@ -21,7 +21,7 @@
 <p>{"Access"}:<br />
 <select name="access">
 {% foreach User::access_list () %}
-	<option value="{{ loop_value }}"{% if access === $data->loop_value %} selected{% end %}>{{ loop_value|ucfirst }}</option>
+	<option value="{{ loop_value }}"{% if access === $data->loop_value %} selected{% end %}>{{ loop_value|ucfirst|i18n_get }}</option>
 {% end %}
 </select></p>
 <p>{"Alternate menu title"}:<br /><input type="text" name="menu_title" size="40" value="{{ menu_title|quotes }}" /></p>
Files elefant-1.3.1-beta/apps/admin/views/editable.html and elefant-1.3.2-beta/apps/admin/views/editable.html are identical
Files elefant-1.3.1-beta/apps/admin/views/head/links.html and elefant-1.3.2-beta/apps/admin/views/head/links.html are identical
Files elefant-1.3.1-beta/apps/admin/views/head.html and elefant-1.3.2-beta/apps/admin/views/head.html are identical
Files elefant-1.3.1-beta/apps/admin/views/index.html and elefant-1.3.2-beta/apps/admin/views/index.html are identical
Files elefant-1.3.1-beta/apps/admin/views/locked.html and elefant-1.3.2-beta/apps/admin/views/locked.html are identical
diff -urBNs elefant-1.3.1-beta/apps/admin/views/pages.html elefant-1.3.2-beta/apps/admin/views/pages.html
--- elefant-1.3.1-beta/apps/admin/views/pages.html	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/admin/views/pages.html	2012-09-13 09:15:24.000000000 -0500
@@ -1,7 +1,13 @@
 <p><a href="/admin/add">{"Add Page"}</a></p>
 
-{% if offset > 0 %}
-<p class="previous"><a href="/admin/pages?offset={{ prev }}">&laquo; {"Previous"}</a></p>
+<p style="float: left">
+{! navigation/pager?style=results&url=[url]&total=[total]&count=[count]&limit=[limit] !}
+</p>
+
+{% if total > $data->limit %}
+<div style="float: right">
+{! navigation/pager?style=numbers&url=[url]&total=[total]&count=[count]&limit=[limit] !}
+</div>
 {% end %}
 
 <p>
@@ -29,6 +35,6 @@
 </table>
 </p>
 
-{% if more %}
-<p class="next"><a href="/admin/pages?offset={{ next }}">{"Next"} &raquo;</a></p>
+{% if total > $data->limit %}
+{! navigation/pager?style=numbers&url=[url]&total=[total]&count=[count]&limit=[limit] !}
 {% end %}
diff -urBNs elefant-1.3.1-beta/apps/admin/views/versions.html elefant-1.3.2-beta/apps/admin/views/versions.html
--- elefant-1.3.1-beta/apps/admin/views/versions.html	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/admin/views/versions.html	2012-09-13 09:15:24.000000000 -0500
@@ -13,12 +13,18 @@
 </p>
 {% end %}
 
-{% if offset > 0 %}
-<p class="previous"><a href="/admin/versions?type={{ type }}&id={{ id }}&offset={{ prev }}">&laquo; {"Newer items"}</a></p>
+<p style="float: left">
+{! navigation/pager?style=results&url=[url]&total=[total]&count=[count]&limit=[limit] !}
+</p>
+
+{% if total > $data->limit %}
+<div style="float: right">
+{! navigation/pager?style=numbers&url=[url]&total=[total]&count=[count]&limit=[limit] !}
+</div>
 {% end %}
 
 {% if id === false %}
-	<p>
+	<p style="clear: both">
 	<table width="100%">
 		<tr>
 			<th width="30%">{"ID"}</th>
@@ -37,7 +43,7 @@
 	</table>
 	</p>
 {% else %}
-	<p>
+	<p style="clear: both">
 	<table>
 		<tr>
 			<th>{"Changed on"}</th>
@@ -63,6 +69,6 @@
 	</p>
 {% end %}
 
-{% if more %}
-<p class="next"><a href="/admin/versions?type={{ type }}&id={{ id }}&offset={{ next }}">{"Older items"} &raquo;</a></p>
+{% if total > $data->limit %}
+{! navigation/pager?style=numbers&url=[url]&total=[total]&count=[count]&limit=[limit] !}
 {% end %}
diff -urBNs elefant-1.3.1-beta/apps/admin/views/wysiwyg.html elefant-1.3.2-beta/apps/admin/views/wysiwyg.html
--- elefant-1.3.1-beta/apps/admin/views/wysiwyg.html	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/admin/views/wysiwyg.html	2012-09-13 09:15:24.000000000 -0500
@@ -15,7 +15,7 @@
 <?php } ?>
 <script type="text/javascript">
 $(function () {
-	$('#webpage-body').wysiwyg ({
+	$('#{% if field_id %}{{ field_id }}{% else %}webpage-body{% end %}').wysiwyg ({
 		initialContent: '<p><br /></p>',
 <?php if (file_exists ('js/wysiwyg/i18n/lang.' . $GLOBALS['i18n']->language . '.js')) { ?>
 		plugins: {
Files elefant-1.3.1-beta/apps/api/conf/config.php and elefant-1.3.2-beta/apps/api/conf/config.php are identical
Files elefant-1.3.1-beta/apps/api/handlers/index.php and elefant-1.3.2-beta/apps/api/handlers/index.php are identical
diff -urBNs elefant-1.3.1-beta/apps/api/handlers/v1.php elefant-1.3.2-beta/apps/api/handlers/v1.php
--- elefant-1.3.1-beta/apps/api/handlers/v1.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/api/handlers/v1.php	2012-09-13 09:15:24.000000000 -0500
@@ -5,7 +5,7 @@
  * `apps/api/conf/config.php`. Requests all require providing
  * an API token and an HMAC value calculated using a secret key
  * and the concatenation of the following data:
- * 
+ *
  * - Request method (e.g., GET)
  * - Request URI including host name (e.g., www.example.com/hello)
  * - Any additional raw request data (e.g., ?name=John&last=Doe)
@@ -13,15 +13,15 @@
  * A client calculation example:
  *
  *   <?php
- *   
+ *
  *   $token = 'my token';
  *   $secret = 'my secret api key';
  *   $data = 'GETwww.example.com/hello?name=John&last=Doe';
  *   $hash = hash_hmac ('sha256', $data, $secret);
- *   
+ *
  *   // Now make an HTTP Basic client request and use
  *   // $token as the user and $hash as the password.
- *   
+ *
  *   ?>
  *
  * The hash value will be recalculated based on the stored private
@@ -35,7 +35,7 @@
 $page->layout = false;
 header ('Content-Type: application/json');
 
-$this->require_auth (user\Auth\HMAC::init ($this, $memcache));
+$this->require_auth (user\Auth\HMAC::init ($this, $cache));
 
 $error = false;
 
@@ -220,4 +220,4 @@
 
 echo json_encode ($res);
 
-?>
\ No newline at end of file
+?>
diff -urBNs elefant-1.3.1-beta/apps/api/models/Api.php elefant-1.3.2-beta/apps/api/models/Api.php
--- elefant-1.3.1-beta/apps/api/models/Api.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/api/models/Api.php	2012-09-13 09:15:24.000000000 -0500
@@ -4,17 +4,17 @@
  * Elefant CMS - http://www.elefantcms.com/
  *
  * Copyright (c) 2011 Johnny Broadway
- * 
+ *
  * Permission is hereby granted, free of charge, to any person obtaining a copy
  * of this software and associated documentation files (the "Software"), to deal
  * in the Software without restriction, including without limitation the rights
  * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  * copies of the Software, and to permit persons to whom the Software is
  * furnished to do so, subject to the following conditions:
- * 
+ *
  * The above copyright notice and this permission notice shall be included in
  * all copies or substantial portions of the Software.
- * 
+ *
  * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
@@ -36,7 +36,7 @@
  *
  * To authenticate, use the `user\Auth\HMAC` authentication scheme:
  *
- *   $this->require_auth (user\Auth\HMAC::init ($this, $memcache));
+ *   $this->require_auth (user\Auth\HMAC::init ($this, $cache));
  */
 class Api extends Model {
 	/**
@@ -74,4 +74,4 @@
 	}
 }
 
-?>
\ No newline at end of file
+?>
Files elefant-1.3.1-beta/apps/blocks/conf/config.php and elefant-1.3.2-beta/apps/blocks/conf/config.php are identical
Files elefant-1.3.1-beta/apps/blocks/forms/add.php and elefant-1.3.2-beta/apps/blocks/forms/add.php are identical
Files elefant-1.3.1-beta/apps/blocks/forms/edit.php and elefant-1.3.2-beta/apps/blocks/forms/edit.php are identical
Files elefant-1.3.1-beta/apps/blocks/handlers/add.php and elefant-1.3.2-beta/apps/blocks/handlers/add.php are identical
diff -urBNs elefant-1.3.1-beta/apps/blocks/handlers/admin.php elefant-1.3.2-beta/apps/blocks/handlers/admin.php
--- elefant-1.3.1-beta/apps/blocks/handlers/admin.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/blocks/handlers/admin.php	2012-09-13 09:15:24.000000000 -0500
@@ -6,18 +6,17 @@
 
 $page->layout = 'admin';
 
-if (! User::require_admin ()) {
-	$this->redirect ('/admin');
-}
+$this->require_admin ();
 
 $limit = 20;
-$_GET['offset'] = (isset ($_GET['offset'])) ? $_GET['offset'] : 0;
+$num = isset ($_GET['offset']) ? $_GET['offset'] : 1;
+$offset = ($num - 1) * $limit;
 
 $lock = new Lock ();
 
 $blocks = Block::query ('id, title, access')
 	->order ('id asc')
-	->fetch_orig ($limit, $_GET['offset']);
+	->fetch_orig ($limit, $offset);
 $count = Block::query ()->count ();
 
 foreach ($blocks as $k => $b) {
@@ -26,12 +25,11 @@
 
 $page->title = i18n_get ('Blocks');
 echo $tpl->render ('blocks/admin', array (
+	'limit' => $limit,
+	'total' => $count,
 	'blocks' => $blocks,
-	'count' => $count,
-	'offset' => $_GET['offset'],
-	'more' => ($count > $_GET['offset'] + $limit) ? true : false,
-	'prev' => $_GET['offset'] - $limit,
-	'next' => $_GET['offset'] + $limit
+	'count' => count ($blocks),
+	'url' => '/blocks/admin?offset=%d'
 ));
 
 ?>
\ No newline at end of file
Files elefant-1.3.1-beta/apps/blocks/handlers/bgsave.php and elefant-1.3.2-beta/apps/blocks/handlers/bgsave.php are identical
Files elefant-1.3.1-beta/apps/blocks/handlers/delete.php and elefant-1.3.2-beta/apps/blocks/handlers/delete.php are identical
Files elefant-1.3.1-beta/apps/blocks/handlers/edit.php and elefant-1.3.2-beta/apps/blocks/handlers/edit.php are identical
Files elefant-1.3.1-beta/apps/blocks/handlers/index.php and elefant-1.3.2-beta/apps/blocks/handlers/index.php are identical
Files elefant-1.3.1-beta/apps/blocks/models/Block.php and elefant-1.3.2-beta/apps/blocks/models/Block.php are identical
Files elefant-1.3.1-beta/apps/blocks/views/add/head.html and elefant-1.3.2-beta/apps/blocks/views/add/head.html are identical
diff -urBNs elefant-1.3.1-beta/apps/blocks/views/add.html elefant-1.3.2-beta/apps/blocks/views/add.html
--- elefant-1.3.1-beta/apps/blocks/views/add.html	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/blocks/views/add.html	2012-09-13 09:15:24.000000000 -0500
@@ -15,7 +15,7 @@
 <p>{"Access"}:<br />
 <select name="access">
 {% foreach User::access_list () %}
-	<option value="{{ loop_value }}"{% if access === $data->loop_value %} selected{% end %}>{{ loop_value|ucfirst }}</option>
+	<option value="{{ loop_value }}"{% if access === $data->loop_value %} selected{% end %}>{{ loop_value|ucfirst|i18n_get }}</option>
 {% end %}
 </select></p>
 <p>{"Display title"}:<br />
diff -urBNs elefant-1.3.1-beta/apps/blocks/views/admin.html elefant-1.3.2-beta/apps/blocks/views/admin.html
--- elefant-1.3.1-beta/apps/blocks/views/admin.html	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/blocks/views/admin.html	2012-09-13 09:15:24.000000000 -0500
@@ -1,7 +1,13 @@
 <p><a href="/blocks/add">{"Add Block"}</a></p>
 
-{% if offset > 0 %}
-<p class="previous"><a href="/blocks/admin?offset={{ prev }}">&laquo; {"Previous"}</a></p>
+<p style="float: left">
+{! navigation/pager?style=results&url=[url]&total=[total]&count=[count]&limit=[limit] !}
+</p>
+
+{% if total > $data->limit %}
+<div style="float: right">
+{! navigation/pager?style=numbers&url=[url]&total=[total]&count=[count]&limit=[limit] !}
+</div>
 {% end %}
 
 <p>
@@ -29,6 +35,6 @@
 </table>
 </p>
 
-{% if more %}
-<p class="next"><a href="/blocks/admin?offset={{ next }}">{"Next"} &raquo;</a></p>
+{% if total > $data->limit %}
+{! navigation/pager?style=numbers&url=[url]&total=[total]&count=[count]&limit=[limit] !}
 {% end %}
Files elefant-1.3.1-beta/apps/blocks/views/edit/head.html and elefant-1.3.2-beta/apps/blocks/views/edit/head.html are identical
diff -urBNs elefant-1.3.1-beta/apps/blocks/views/edit.html elefant-1.3.2-beta/apps/blocks/views/edit.html
--- elefant-1.3.1-beta/apps/blocks/views/edit.html	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/blocks/views/edit.html	2012-09-13 09:15:24.000000000 -0500
@@ -15,7 +15,7 @@
 <p>{"Access"}:<br />
 <select name="access">
 {% foreach User::access_list () %}
-	<option value="{{ loop_value }}"{% if access === $data->loop_value %} selected{% end %}>{{ loop_value|ucfirst }}</option>
+	<option value="{{ loop_value }}"{% if access === $data->loop_value %} selected{% end %}>{{ loop_value|ucfirst|i18n_get }}</option>
 {% end %}
 </select></p>
 <p>{"Display title"}:<br />
Files elefant-1.3.1-beta/apps/blocks/views/editable.html and elefant-1.3.2-beta/apps/blocks/views/editable.html are identical
diff -urBNs elefant-1.3.1-beta/apps/blog/conf/config.php elefant-1.3.2-beta/apps/blog/conf/config.php
--- elefant-1.3.1-beta/apps/blog/conf/config.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/blog/conf/config.php	2012-09-13 09:15:24.000000000 -0500
@@ -25,6 +25,17 @@
 
 disqus_shortname = ""
 
+[Social Buttons]
+
+; Here you can enable/disable different social buttons
+; that will be displayed in the footer of each blog
+; post. To turn one off, set it to `Off`. To enable,
+; set it to `On`.
+
+twitter = On
+facebook = On
+google = On
+
 [Twitter]
 
 ; Set these to your twitter credentials to have blog posts automatically
diff -urBNs elefant-1.3.1-beta/apps/blog/conf/embed.php elefant-1.3.2-beta/apps/blog/conf/embed.php
--- elefant-1.3.1-beta/apps/blog/conf/embed.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/blog/conf/embed.php	2012-09-13 09:15:24.000000000 -0500
@@ -2,7 +2,7 @@
 
 [blog/headlines]
 
-label = "Blog: Latest Posts"
+label = "Blog: Headlines"
 
 tag[label] = "Tag (optional)"
 tag[type] = select
@@ -28,4 +28,12 @@
 url[regex] = "|^http://.+$|"
 url[message] = Please enter a valid URL.
 
+[blog/postsfeed]
+
+label = "Blog: Latest Posts"
+
+number[label] = "Number of Posts"
+number[type] = numeric
+number[initial] = 5
+
 ; */ ?>
\ No newline at end of file
Files elefant-1.3.1-beta/apps/blog/css/jquery.tagit.css and elefant-1.3.2-beta/apps/blog/css/jquery.tagit.css are identical
Files elefant-1.3.1-beta/apps/blog/forms/add.php and elefant-1.3.2-beta/apps/blog/forms/add.php are identical
Files elefant-1.3.1-beta/apps/blog/forms/edit.php and elefant-1.3.2-beta/apps/blog/forms/edit.php are identical
diff -urBNs elefant-1.3.1-beta/apps/blog/handlers/add.php elefant-1.3.2-beta/apps/blog/handlers/add.php
--- elefant-1.3.1-beta/apps/blog/handlers/add.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/blog/handlers/add.php	2012-09-13 09:15:24.000000000 -0500
@@ -37,7 +37,7 @@
 				);
 			}
 		}
-		
+
 		// autopost
 		if ($_POST['published'] == 'yes') {
 			require_once ('apps/blog/lib/Filters.php');
@@ -49,7 +49,7 @@
 
 			if ($autopost_tw && ! empty ($appconf['Twitter']['username']) && ! empty ($appconf['Twitter']['password'])) {
 				$b = new Bitly;
-				$short = $b->shorten ('http://' . $_SERVER['HTTP_HOST'] . '/blog/post/' . $p->id . '/' . blog_filter_title ($p->title));
+				$short = $b->shorten ('http://' . $_SERVER['HTTP_HOST'] . '/blog/post/' . $p->id . '/' . URLify::filter ($p->title));
 				$t = new twitter;
 				$t->username = $appconf['Twitter']['username'];
 				$t->password = $appconf['Twitter']['password'];
@@ -58,9 +58,9 @@
 		}
 
 		// reset blog rss cache
-		$memcache->delete ('blog_rss');
+		$cache->delete ('blog_rss');
 
-		$_POST['page'] = 'blog/post/' . $p->id . '/' . blog_filter_title ($p->title);
+		$_POST['page'] = 'blog/post/' . $p->id . '/' . URLify::filter ($p->title);
 		$this->hook ('blog/add', $_POST);
 		$this->redirect ('/blog/admin');
 	}
@@ -83,4 +83,4 @@
 	echo $tpl->render ('blog/add', $p);
 }
 
-?>
\ No newline at end of file
+?>
diff -urBNs elefant-1.3.1-beta/apps/blog/handlers/admin.php elefant-1.3.2-beta/apps/blog/handlers/admin.php
--- elefant-1.3.1-beta/apps/blog/handlers/admin.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/blog/handlers/admin.php	2012-09-13 09:15:24.000000000 -0500
@@ -6,20 +6,19 @@
 
 $page->layout = 'admin';
 
-if (! User::require_admin ()) {
-	$this->redirect ('/admin');
-}
+$this->require_admin ();
 
 require_once ('apps/blog/lib/Filters.php');
 
 $limit = 20;
-$_GET['offset'] = (isset ($_GET['offset'])) ? $_GET['offset'] : 0;
+$num = isset ($_GET['offset']) ? $_GET['offset'] : 1;
+$offset = ($num - 1) * $limit;
 
 $lock = new Lock ();
 
 $posts = blog\Post::query ('id, title, ts, author, published')
 	->order ('ts desc')
-	->fetch_orig ($limit, $_GET['offset']);
+	->fetch_orig ($limit, $offset);
 $count = blog\Post::query ()->count ();
 
 foreach ($posts as $k => $p) {
@@ -28,12 +27,11 @@
 
 $page->title = i18n_get ('Blog Posts');
 echo $tpl->render ('blog/admin', array (
+	'limit' => $limit,
+	'total' => $count,
 	'posts' => $posts,
-	'count' => $count,
-	'offset' => $_GET['offset'],
-	'more' => ($count > $_GET['offset'] + $limit) ? true : false,
-	'prev' => $_GET['offset'] - $limit,
-	'next' => $_GET['offset'] + $limit
+	'count' => count ($posts),
+	'url' => '/blog/admin?offset=%d'
 ));
 
 ?>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/blog/handlers/bgsave.php elefant-1.3.2-beta/apps/blog/handlers/bgsave.php
--- elefant-1.3.1-beta/apps/blog/handlers/bgsave.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/blog/handlers/bgsave.php	2012-09-13 09:15:24.000000000 -0500
@@ -32,7 +32,7 @@
 	} else {
 		Versions::add ($o);
 		require_once ('apps/blog/lib/Filters.php');
-		$_POST['page'] = 'blog/post/' . $o->id . '/' . blog_filter_title ($o->title);
+		$_POST['page'] = 'blog/post/' . $o->id . '/' . URLify::filter ($o->title);
 		$this->hook ('blog/edit', $_POST);
 	}
 }
diff -urBNs elefant-1.3.1-beta/apps/blog/handlers/by.php elefant-1.3.2-beta/apps/blog/handlers/by.php
--- elefant-1.3.1-beta/apps/blog/handlers/by.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/blog/handlers/by.php	2012-09-13 09:15:24.000000000 -0500
@@ -24,7 +24,7 @@
 $page->next = $page->num + 2;
 
 foreach ($posts as $post) {
-	$post->url = '/blog/post/' . $post->id . '/' . blog_filter_title ($post->title);
+	$post->url = '/blog/post/' . $post->id . '/' . URLify::filter ($post->title);
 	$post->tag_list = explode (',', $post->tags);
 	echo $tpl->render ('blog/post', $post);
 }
Files elefant-1.3.1-beta/apps/blog/handlers/commentcount.php and elefant-1.3.2-beta/apps/blog/handlers/commentcount.php are identical
diff -urBNs elefant-1.3.1-beta/apps/blog/handlers/delete.php elefant-1.3.2-beta/apps/blog/handlers/delete.php
--- elefant-1.3.1-beta/apps/blog/handlers/delete.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/blog/handlers/delete.php	2012-09-13 09:15:24.000000000 -0500
@@ -30,13 +30,13 @@
 }
 
 // reset blog rss cache
-$memcache->delete ('blog_rss');
+$cache->delete ('blog_rss');
 
 DB::execute ('delete from blog_post_tag where post_id = ?', $_GET['id']);
 
-$_GET['page'] = 'blog/post/' . $_GET['id'] . '/' . blog_filter_title ($title);
+$_GET['page'] = 'blog/post/' . $_GET['id'] . '/' . URLify::filter ($title);
 $this->hook ('blog/delete', $_GET);
 $this->add_notification (i18n_get ('Blog post deleted.'));
 $this->redirect ('/blog/admin');
 
-?>
\ No newline at end of file
+?>
Files elefant-1.3.1-beta/apps/blog/handlers/disqus/commentcount.php and elefant-1.3.2-beta/apps/blog/handlers/disqus/commentcount.php are identical
Files elefant-1.3.1-beta/apps/blog/handlers/disqus/comments.php and elefant-1.3.2-beta/apps/blog/handlers/disqus/comments.php are identical
diff -urBNs elefant-1.3.1-beta/apps/blog/handlers/edit.php elefant-1.3.2-beta/apps/blog/handlers/edit.php
--- elefant-1.3.1-beta/apps/blog/handlers/edit.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/blog/handlers/edit.php	2012-09-13 09:15:24.000000000 -0500
@@ -61,9 +61,9 @@
 				);
 			}
 		}
-		
+
 		require_once ('apps/blog/lib/Filters.php');
-		
+
 		// autopost
 		if ($autopost) {
 			if ($autopost_pom) {
@@ -73,7 +73,7 @@
 
 			if ($autopost_tw && ! empty ($appconf['Twitter']['username']) && ! empty ($appconf['Twitter']['password'])) {
 				$b = new Bitly;
-				$short = $b->shorten ('http://' . $_SERVER['HTTP_HOST'] . '/blog/post/' . $p->id . '/' . blog_filter_title ($p->title));
+				$short = $b->shorten ('http://' . $_SERVER['HTTP_HOST'] . '/blog/post/' . $p->id . '/' . URLify::filter ($p->title));
 				$t = new twitter;
 				$t->username = $appconf['Twitter']['username'];
 				$t->password = $appconf['Twitter']['password'];
@@ -82,9 +82,9 @@
 		}
 
 		// reset blog rss cache
-		$memcache->delete ('blog_rss');
+		$cache->delete ('blog_rss');
 
-		$_POST['page'] = 'blog/post/' . $p->id . '/' . blog_filter_title ($p->title);
+		$_POST['page'] = 'blog/post/' . $p->id . '/' . URLify::filter ($p->title);
 		$lock->remove ();
 		$this->hook ('blog/edit', $_POST);
 		$this->redirect ('/blog/admin');
@@ -105,4 +105,4 @@
 	echo $tpl->render ('blog/edit', $p);
 }
 
-?>
\ No newline at end of file
+?>
diff -urBNs elefant-1.3.1-beta/apps/blog/handlers/headlines.php elefant-1.3.2-beta/apps/blog/handlers/headlines.php
--- elefant-1.3.1-beta/apps/blog/handlers/headlines.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/blog/handlers/headlines.php	2012-09-13 09:15:24.000000000 -0500
@@ -12,7 +12,7 @@
 require_once ('apps/blog/lib/Filters.php');
 
 $p = new blog\Post;
-if ($data['tag'] !== '') {
+if (isset ($data['tag']) && $data['tag'] !== '') {
 	$posts = $p->tagged ($data['tag']);
 } else {
 	$posts = $p->headlines ();
Files elefant-1.3.1-beta/apps/blog/handlers/import/blogger.php and elefant-1.3.2-beta/apps/blog/handlers/import/blogger.php are identical
Files elefant-1.3.1-beta/apps/blog/handlers/import/csv.php and elefant-1.3.2-beta/apps/blog/handlers/import/csv.php are identical
Files elefant-1.3.1-beta/apps/blog/handlers/import/csv2.php and elefant-1.3.2-beta/apps/blog/handlers/import/csv2.php are identical
Files elefant-1.3.1-beta/apps/blog/handlers/import/wordpress.php and elefant-1.3.2-beta/apps/blog/handlers/import/wordpress.php are identical
Files elefant-1.3.1-beta/apps/blog/handlers/import.php and elefant-1.3.2-beta/apps/blog/handlers/import.php are identical
diff -urBNs elefant-1.3.1-beta/apps/blog/handlers/index.php elefant-1.3.2-beta/apps/blog/handlers/index.php
--- elefant-1.3.1-beta/apps/blog/handlers/index.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/blog/handlers/index.php	2012-09-13 09:15:24.000000000 -0500
@@ -40,8 +40,10 @@
 	}
 
 	foreach ($posts as $post) {
-		$post->url = '/blog/post/' . $post->id . '/' . blog_filter_title ($post->title);
+		$post->url = '/blog/post/' . $post->id . '/' . URLify::filter ($post->title);
 		$post->tag_list = explode (',', $post->tags);
+		$post->social_buttons = $appconf['Social Buttons'];
+		$post->body = $tpl->run_includes ($post->body);
 		echo $tpl->render ('blog/post', $post);
 	}
 }
diff -urBNs elefant-1.3.1-beta/apps/blog/handlers/post.php elefant-1.3.2-beta/apps/blog/handlers/post.php
--- elefant-1.3.1-beta/apps/blog/handlers/post.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/blog/handlers/post.php	2012-09-13 09:15:24.000000000 -0500
@@ -23,9 +23,10 @@
 
 $post = $p->orig ();
 $post->full = true;
-$post->url = '/blog/post/' . $post->id . '/' . blog_filter_title ($post->title);
+$post->url = '/blog/post/' . $post->id . '/' . URLify::filter ($post->title);
 $post->tag_list = explode (',', $post->tags);
 $post->body = $tpl->run_includes ($post->body);
+$post->social_buttons = $appconf['Social Buttons'];
 
 echo $tpl->render ('blog/post', $post);
 
diff -urBNs elefant-1.3.1-beta/apps/blog/handlers/postsfeed.php elefant-1.3.2-beta/apps/blog/handlers/postsfeed.php
--- elefant-1.3.1-beta/apps/blog/handlers/postsfeed.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/blog/handlers/postsfeed.php	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,34 @@
+<?php
+require_once ('apps/blog/lib/Filters.php');
+
+
+if ($data['number'] !== '') {
+    $page->limit = $data['number'];
+} else {
+    $page->limit = 5;
+}
+
+$page->offset = 0;
+
+$p = new blog\Post;
+$posts = $p->latest ($page->limit, $page->offset);
+$page->count = $p->query ()->where ('published', 'yes')->count ();
+
+	if (! is_array ($posts) || count ($posts) === 0) {
+	    echo '<p>' . i18n_get ('No posts yet... :(') . '</p>';
+	        if (User::require_admin ()) {
+		    echo '<p><a href="/blog/add">' . i18n_get ('Add Blog Post') . '</a></p>';
+	        }
+	} else {
+	    if (User::require_admin ()) {
+		echo '<p><a href="/blog/add">' . i18n_get ('Add Blog Post') . '</a></p>';
+	    }
+
+	    foreach ($posts as $post) {
+		$post->url = '/blog/post/' . $post->id . '/' . URLify::filter ($post->title);
+		$post->tag_list = explode (',', $post->tags);
+		$post->social_buttons = $appconf['Social Buttons'];
+		echo $tpl->render ('blog/post', $post);
+	    }
+	}
+?>
diff -urBNs elefant-1.3.1-beta/apps/blog/handlers/rss.php elefant-1.3.2-beta/apps/blog/handlers/rss.php
--- elefant-1.3.1-beta/apps/blog/handlers/rss.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/blog/handlers/rss.php	2012-09-13 09:15:24.000000000 -0500
@@ -4,23 +4,23 @@
  * Renders the RSS feed for the blog.
  */
 
-$res = $memcache->get ('_blog_rss');
+$res = $cache->get ('_blog_rss');
 if (! $res) {
 	require_once ('apps/blog/lib/Filters.php');
-	
+
 	$p = new blog\Post;
 	$page->posts = $p->latest (10, 0);
 	$page->title = $appconf['Blog']['title'];
 	$page->date = gmdate ('Y-m-d\TH:i:s');
 	foreach ($page->posts as $k => $post) {
-		$page->posts[$k]->url = '/blog/post/' . $post->id . '/' . blog_filter_title ($post->title);
+		$page->posts[$k]->url = '/blog/post/' . $post->id . '/' . URLify::filter ($post->title);
 	}
-	
+
 	$res = $tpl->render ('blog/rss', $page);
-	$memcache->set ('_blog_rss', $res, 1800); // half an hour
+	$cache->set ('_blog_rss', $res, 1800); // half an hour
 }
-$page->layout = false;
+$page->layout = FALSE;
 header ('Content-Type: text/xml');
 echo $res;
 
-?>
\ No newline at end of file
+?>
Files elefant-1.3.1-beta/apps/blog/handlers/rssviewer.php and elefant-1.3.2-beta/apps/blog/handlers/rssviewer.php are identical
diff -urBNs elefant-1.3.1-beta/apps/blog/handlers/tag.php elefant-1.3.2-beta/apps/blog/handlers/tag.php
--- elefant-1.3.1-beta/apps/blog/handlers/tag.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/blog/handlers/tag.php	2012-09-13 09:15:24.000000000 -0500
@@ -9,7 +9,7 @@
 require_once ('apps/blog/lib/Filters.php');
 
 $page->limit = 10;
-$page->tag = $this->params[0];
+$page->tag = urldecode ($this->params[0]);
 if (! $page->tag) {
 	$this->redirect ('/blog');
 }
@@ -24,7 +24,7 @@
 $page->next = $page->num + 2;
 
 foreach ($posts as $post) {
-	$post->url = '/blog/post/' . $post->id . '/' . blog_filter_title ($post->title);
+	$post->url = '/blog/post/' . $post->id . '/' . URLify::filter ($post->title);
 	$post->tag_list = explode (',', $post->tags);
 	echo $tpl->render ('blog/post', $post);
 }
Files elefant-1.3.1-beta/apps/blog/handlers/taglist.php and elefant-1.3.2-beta/apps/blog/handlers/taglist.php are identical
Files elefant-1.3.1-beta/apps/blog/handlers/tags.php and elefant-1.3.2-beta/apps/blog/handlers/tags.php are identical
Files elefant-1.3.1-beta/apps/blog/handlers/upgrade.php and elefant-1.3.2-beta/apps/blog/handlers/upgrade.php are identical
Files elefant-1.3.1-beta/apps/blog/js/autocomplete.js and elefant-1.3.2-beta/apps/blog/js/autocomplete.js are identical
Files elefant-1.3.1-beta/apps/blog/js/jquery.timepicker.js and elefant-1.3.2-beta/apps/blog/js/jquery.timepicker.js are identical
Files elefant-1.3.1-beta/apps/blog/js/tag-it.js and elefant-1.3.2-beta/apps/blog/js/tag-it.js are identical
Files elefant-1.3.1-beta/apps/blog/lib/Bitly.php and elefant-1.3.2-beta/apps/blog/lib/Bitly.php are identical
Files elefant-1.3.1-beta/apps/blog/lib/CsvParser.php and elefant-1.3.2-beta/apps/blog/lib/CsvParser.php are identical
diff -urBNs elefant-1.3.1-beta/apps/blog/lib/Filters.php elefant-1.3.2-beta/apps/blog/lib/Filters.php
--- elefant-1.3.1-beta/apps/blog/lib/Filters.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/blog/lib/Filters.php	2012-09-13 09:15:24.000000000 -0500
@@ -25,15 +25,6 @@
  */
 
 /**
- * Filter blog post titles for use in URLs. Makes them lowercase,
- * and changes any non A-Z or 0-9 character series into a dash.
- * Also removes any leading or trailing whitespace.
- */
-function blog_filter_title ($title) {
-	return trim (preg_replace ('/[^a-z0-9-]+/', '-', strtolower ($title)), ' -');
-}
-
-/**
  * Formats a date in the format YYYY-MM-DD HH:MM:SS into the
  * specifed format using `gmdate()`. The default format is
  * `F j, Y - g:ia`.
Files elefant-1.3.1-beta/apps/blog/lib/Functions.php and elefant-1.3.2-beta/apps/blog/lib/Functions.php are identical
Files elefant-1.3.1-beta/apps/blog/lib/Pingomatic.php and elefant-1.3.2-beta/apps/blog/lib/Pingomatic.php are identical
Files elefant-1.3.1-beta/apps/blog/lib/SimplePie.php and elefant-1.3.2-beta/apps/blog/lib/SimplePie.php are identical
Files elefant-1.3.1-beta/apps/blog/lib/Twitter.php and elefant-1.3.2-beta/apps/blog/lib/Twitter.php are identical
Files elefant-1.3.1-beta/apps/blog/models/Post.php and elefant-1.3.2-beta/apps/blog/models/Post.php are identical
Files elefant-1.3.1-beta/apps/blog/views/add/head.html and elefant-1.3.2-beta/apps/blog/views/add/head.html are identical
Files elefant-1.3.1-beta/apps/blog/views/add.html and elefant-1.3.2-beta/apps/blog/views/add.html are identical
diff -urBNs elefant-1.3.1-beta/apps/blog/views/admin.html elefant-1.3.2-beta/apps/blog/views/admin.html
--- elefant-1.3.1-beta/apps/blog/views/admin.html	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/blog/views/admin.html	2012-09-13 09:15:24.000000000 -0500
@@ -6,8 +6,14 @@
 	<a href="/blog/import">{"Import Posts"}</a>
 </p>
 
-{% if offset > 0 %}
-<p class="previous"><a href="/blog/admin?offset={{ prev }}">&laquo; {"Previous"}</a></p>
+<p style="float: left">
+{! navigation/pager?style=results&url=[url]&total=[total]&count=[count]&limit=[limit] !}
+</p>
+
+{% if total > $data->limit %}
+<div style="float: right">
+{! navigation/pager?style=numbers&url=[url]&total=[total]&count=[count]&limit=[limit] !}
+</div>
 {% end %}
 
 <p>
@@ -21,7 +27,7 @@
 	</tr>
 {% foreach posts %}
 	<tr>
-		<td><a href="/blog/post/{{ loop_value->id }}/{{ loop_value->title|blog_filter_title }}" target="_blank">{{ loop_value->title }}</a></td>
+		<td><a href="/blog/post/{{ loop_value->id }}/{{ loop_value->title|URLify::filter }}" target="_blank">{{ loop_value->title }}</a></td>
 		<td>{{ loop_value->ts|I18n::date_time }}</td>
 		<td>{{ loop_value->author }}</td>
 		<td>{{ loop_value->published|ucfirst }}</td>
@@ -37,6 +43,6 @@
 </table>
 </p>
 
-{% if more %}
-<p class="next"><a href="/blog/admin?offset={{ next }}">{"Next"} &raquo;</a></p>
+{% if total > $data->limit %}
+{! navigation/pager?style=numbers&url=[url]&total=[total]&count=[count]&limit=[limit] !}
 {% end %}
Files elefant-1.3.1-beta/apps/blog/views/by.html and elefant-1.3.2-beta/apps/blog/views/by.html are identical
Files elefant-1.3.1-beta/apps/blog/views/disqus/commentcount.html and elefant-1.3.2-beta/apps/blog/views/disqus/commentcount.html are identical
Files elefant-1.3.1-beta/apps/blog/views/disqus/comments.html and elefant-1.3.2-beta/apps/blog/views/disqus/comments.html are identical
Files elefant-1.3.1-beta/apps/blog/views/edit/head.html and elefant-1.3.2-beta/apps/blog/views/edit/head.html are identical
Files elefant-1.3.1-beta/apps/blog/views/edit.html and elefant-1.3.2-beta/apps/blog/views/edit.html are identical
diff -urBNs elefant-1.3.1-beta/apps/blog/views/headlines.html elefant-1.3.2-beta/apps/blog/views/headlines.html
--- elefant-1.3.1-beta/apps/blog/views/headlines.html	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/blog/views/headlines.html	2012-09-13 09:15:24.000000000 -0500
@@ -4,6 +4,6 @@
 
 <ul>
 {% foreach posts %}
-	<li>{% if dates %}{{ loop_value->ts|I18n::short_date }} {% end %}<a href="/blog/post/{{ loop_value->id }}/{{ loop_value->title|blog_filter_title }}">{{ loop_value->title }}</a></li>
+	<li>{% if dates %}{{ loop_value->ts|I18n::short_date }} {% end %}<a href="/blog/post/{{ loop_value->id }}/{{ loop_value->title|URLify::filter }}">{{ loop_value->title }}</a></li>
 {% end %}
 </ul>
Files elefant-1.3.1-beta/apps/blog/views/import/blogger.html and elefant-1.3.2-beta/apps/blog/views/import/blogger.html are identical
Files elefant-1.3.1-beta/apps/blog/views/import/csv.html and elefant-1.3.2-beta/apps/blog/views/import/csv.html are identical
Files elefant-1.3.1-beta/apps/blog/views/import/csv2.html and elefant-1.3.2-beta/apps/blog/views/import/csv2.html are identical
Files elefant-1.3.1-beta/apps/blog/views/import/wordpress.html and elefant-1.3.2-beta/apps/blog/views/import/wordpress.html are identical
Files elefant-1.3.1-beta/apps/blog/views/import.html and elefant-1.3.2-beta/apps/blog/views/import.html are identical
Files elefant-1.3.1-beta/apps/blog/views/index.html and elefant-1.3.2-beta/apps/blog/views/index.html are identical
diff -urBNs elefant-1.3.1-beta/apps/blog/views/post.html elefant-1.3.2-beta/apps/blog/views/post.html
--- elefant-1.3.1-beta/apps/blog/views/post.html	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/blog/views/post.html	2012-09-13 09:15:24.000000000 -0500
@@ -1,10 +1,12 @@
+{! admin/util/dates !}
+
 {% if full %}
 <p><a href="/blog">&laquo; {"Back to posts"}</a></p>
 {% end %}
 
 <div class="blog-post block">
 <h3><a href="{{ url }}">{{ title }}</a></h3>
-<p class="blog-info info">{{ ts|blog_filter_date }} - {" by "} <a href="/blog/by/{{ author }}">{{ author }}</a></p>
+<p class="blog-info info">{{ ts|I18n::date_time }} - {" by "} <a href="/blog/by/{{ author }}">{{ author }}</a></p>
 {{ body|none }}
 <div class="blog-tags info">
 {"Tags"}: 
@@ -15,8 +17,14 @@
 <hr />
 <div class="blog-comments">
 {{ controller.run ('blog/commentcount', $data)|none }}&nbsp;
-{{ controller.run ('social/facebook/like', $data)|none }}
-{{ controller.run ('social/twitter/tweet', $data)|none }}
-{{ controller.run ('social/google/plusone', $data)|none }}
+{% if social_buttons['facebook'] %}
+	{{ controller.run ('social/facebook/like', $data)|none }}
+{% end %}
+{% if social_buttons['twitter'] %}
+	{{ controller.run ('social/twitter/tweet', $data)|none }}
+{% end %}
+{% if social_buttons['google'] %}
+	{{ controller.run ('social/google/plusone', $data)|none }}
+{% end %}
 </div>
 </div>
Files elefant-1.3.1-beta/apps/blog/views/rss.html and elefant-1.3.2-beta/apps/blog/views/rss.html are identical
Files elefant-1.3.1-beta/apps/blog/views/rssviewer.html and elefant-1.3.2-beta/apps/blog/views/rssviewer.html are identical
Files elefant-1.3.1-beta/apps/blog/views/tag.html and elefant-1.3.2-beta/apps/blog/views/tag.html are identical
Files elefant-1.3.1-beta/apps/blog/views/tags.html and elefant-1.3.2-beta/apps/blog/views/tags.html are identical
diff -urBNs elefant-1.3.1-beta/apps/cli/handlers/backup.php elefant-1.3.2-beta/apps/cli/handlers/backup.php
--- elefant-1.3.1-beta/apps/cli/handlers/backup.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/handlers/backup.php	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,52 @@
+<?php
+
+/**
+ * Create a backup of the site and database as a tarball
+ * and move it to the specified folder.
+ */
+
+if (! $this->cli) {
+	die ('Must be run from the command line.');
+}
+
+$page->layout = false;
+
+if (! isset ($_SERVER['argv'][2])) {
+	echo "Usage: elefant backup <path>\n";
+	die;
+}
+
+$path = $_SERVER['argv'][2];
+
+if (! is_dir ($path)) {
+	echo "** Error: Specified path is not a folder.\n";
+	die;
+}
+if (! is_writeable ($path)) {
+	echo "** Error: Specified folder is not writeable.\n";
+	die;
+}
+
+// add trailing slash
+$path = (preg_match ('/\/$/', $path)) ? $path : $path . '/';
+
+date_default_timezone_set ('GMT');
+$ts = gmdate ('Y-m-d-H-i-s');
+
+if (! @is_dir ('.backups')) {
+	mkdir ('.backups');
+	file_put_contents ('.backups/.htaccess', "Order allow,deny\nDeny from all\n");
+}
+mkdir ('.backups/backup-' . $ts);
+exec ('./elefant export-db .backups/backup-' . $ts . '/dump.sql');
+copy ('.htaccess', '.backups/backup-' . $ts . '/.htaccess');
+exec ('cp -R * .backups/backup-' . $ts . '/');
+chdir ('.backups');
+exec ('tar -cf backup-' . $ts . '.tar backup-' . $ts);
+exec ('gzip backup-' . $ts . '.tar');
+chdir ('..');
+exec ('mv .backups/backup-' . $ts . '.tar.gz ' . $path);
+exec ('rm -Rf .backups/backup-' . $ts);
+
+
+?>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/handlers/build-app.php elefant-1.3.2-beta/apps/cli/handlers/build-app.php
--- elefant-1.3.1-beta/apps/cli/handlers/build-app.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/handlers/build-app.php	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,57 @@
+<?php
+
+/**
+ * This command builds the scaffolding for a new
+ * app in the apps folder. This includes the basic
+ * directory structure as well as some sample
+ * files (config, handlers, views).
+ */
+
+if (! $this->cli) {
+	die ('Must be run from the command line.');
+}
+
+$page->layout = false;
+
+if (! isset ($_SERVER['argv'][2])) {
+	echo "Usage: elefant build-app <appname>\n";
+	die;
+}
+
+$appname = $_SERVER['argv'][2];
+$data = array (
+	'appname' => $appname,
+	'open_tag' => '<?php',
+	'close_tag' => '?>'
+);
+
+mkdir ('apps/' . $appname . '/conf', 0755, true);
+mkdir ('apps/' . $appname . '/forms', 0755, true);
+mkdir ('apps/' . $appname . '/handlers', 0755, true);
+mkdir ('apps/' . $appname . '/lib', 0755, true);
+mkdir ('apps/' . $appname . '/models', 0755, true);
+mkdir ('apps/' . $appname . '/views', 0755, true);
+
+file_put_contents (
+	'apps/' . $appname . '/handlers/index.php',
+	$tpl->render ('cli/build-app/index_handler', $data)
+);
+
+file_put_contents (
+	'apps/' . $appname . '/handlers/admin.php',
+	$tpl->render ('cli/build-app/admin_handler', $data)
+);
+
+file_put_contents (
+	'apps/' . $appname . '/views/index.html',
+	$tpl->render ('cli/build-app/index_view', $data)
+);
+
+file_put_contents (
+	'apps/' . $appname . '/conf/config.php',
+	$tpl->render ('cli/build-app/config', $data)
+);
+
+printf ("App created in apps/%s/\n", $appname);
+
+?>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/handlers/crud-app.php elefant-1.3.2-beta/apps/cli/handlers/crud-app.php
--- elefant-1.3.1-beta/apps/cli/handlers/crud-app.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/handlers/crud-app.php	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,143 @@
+<?php
+
+/**
+ * This command builds the CRUD outline for a new
+ * app in the apps folder. This includes the basic
+ * directory structure as well as a model definition,
+ * database schema files, and basic admin handlers
+ * for Create, Read, Update, and Delete functions.
+ */
+
+if (! $this->cli) {
+	die ('Must be run from the command line.');
+}
+
+$page->layout = false;
+
+if (! isset ($_SERVER['argv'][2])) {
+	echo "Usage: elefant crud-app <modelname> <fieldlist>\n";
+	die;
+}
+
+if (! isset ($_SERVER['argv'][3])) {
+	echo "Usage: elefant crud-app <modelname> <fieldlist>\n";
+	die;
+}
+
+$name = strtolower ($_SERVER['argv'][2]);
+
+// get plural name
+$ar = new ActiveResource;
+$plural = $ar->pluralize ($name);
+unset ($ar);
+
+// build list of fields
+$fields = array ();
+if ($_SERVER['argv'][3] !== 'id') {
+	$fields[] = 'id';
+}
+for ($i = 3; $i < count ($_SERVER['argv']); $i++) {
+	$fields[] = $_SERVER['argv'][$i];
+}
+
+$data = array (
+	'appname' => $name,
+	'plural' => $plural,
+	'fields' => $fields,
+	'open_tag' => '<?php',
+	'close_tag' => '?>',
+	'backslash' => '\\'
+);
+
+mkdir ('apps/' . $plural . '/conf', 0755, true);
+mkdir ('apps/' . $plural . '/forms', 0755, true);
+mkdir ('apps/' . $plural . '/handlers', 0755, true);
+mkdir ('apps/' . $plural . '/lib', 0755, true);
+mkdir ('apps/' . $plural . '/models', 0755, true);
+mkdir ('apps/' . $plural . '/views', 0755, true);
+
+require_once ('apps/cli/lib/CRUDHelpers.php');
+
+file_put_contents (
+	'apps/' . $plural . '/conf/config.php',
+	$tpl->render ('cli/crud-app/config', $data)
+);
+
+file_put_contents (
+	'apps/' . $plural . '/conf/install_mysql.sql',
+	$tpl->render ('cli/crud-app/install_mysql', $data)
+);
+
+file_put_contents (
+	'apps/' . $plural . '/conf/install_pgsql.sql',
+	$tpl->render ('cli/crud-app/install_pgsql', $data)
+);
+
+file_put_contents (
+	'apps/' . $plural . '/conf/install_sqlite.sql',
+	$tpl->render ('cli/crud-app/install_sqlite', $data)
+);
+
+file_put_contents (
+	'apps/' . $plural . '/forms/add.php',
+	$tpl->render ('cli/crud-app/add_form', $data)
+);
+
+file_put_contents (
+	'apps/' . $plural . '/forms/edit.php',
+	$tpl->render ('cli/crud-app/edit_form', $data)
+);
+
+file_put_contents (
+	'apps/' . $plural . '/models/' . ucfirst ($name) . '.php',
+	$tpl->render ('cli/crud-app/model', $data)
+);
+
+file_put_contents (
+	'apps/' . $plural . '/handlers/admin.php',
+	$tpl->render ('cli/crud-app/admin_handler', $data)
+);
+
+file_put_contents (
+	'apps/' . $plural . '/handlers/index.php',
+	$tpl->render ('cli/crud-app/index_handler', $data)
+);
+
+file_put_contents (
+	'apps/' . $plural . '/handlers/add.php',
+	$tpl->render ('cli/crud-app/add_handler', $data)
+);
+
+file_put_contents (
+	'apps/' . $plural . '/handlers/edit.php',
+	$tpl->render ('cli/crud-app/edit_handler', $data)
+);
+
+file_put_contents (
+	'apps/' . $plural . '/handlers/delete.php',
+	$tpl->render ('cli/crud-app/delete_handler', $data)
+);
+
+file_put_contents (
+	'apps/' . $plural . '/views/index.html',
+	$tpl->render ('cli/crud-app/index_view', $data)
+);
+
+file_put_contents (
+	'apps/' . $plural . '/views/add.html',
+	$tpl->render ('cli/crud-app/add_view', $data)
+);
+
+file_put_contents (
+	'apps/' . $plural . '/views/edit.html',
+	$tpl->render ('cli/crud-app/edit_view', $data)
+);
+
+file_put_contents (
+	'apps/' . $plural . '/views/admin.html',
+	$tpl->render ('cli/crud-app/admin_view', $data)
+);
+
+printf ("App created in apps/%s/\n", $plural);
+
+?>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/handlers/encrypt-password.php elefant-1.3.2-beta/apps/cli/handlers/encrypt-password.php
--- elefant-1.3.1-beta/apps/cli/handlers/encrypt-password.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/handlers/encrypt-password.php	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,21 @@
+<?php
+
+/**
+ * Encrypts the specified password in a compatible format
+ * for storage in the Elefant user table.
+ */
+
+if (! $this->cli) {
+	die ('Must be run from the command line.');
+}
+
+$page->layout = false;
+
+if (! isset ($_SERVER['argv'][2])) {
+	echo "Usage: elefant encrypt-password <password>\n";
+	return;
+}
+
+echo User::encrypt_pass ($_SERVER['argv'][2]) . "\n";
+
+?>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/handlers/export-db.php elefant-1.3.2-beta/apps/cli/handlers/export-db.php
--- elefant-1.3.1-beta/apps/cli/handlers/export-db.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/handlers/export-db.php	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,95 @@
+<?php
+
+/**
+ * This command exports a backup of the database into
+ * the specified file using the database's associated
+ * command line export utility. Note that the utility
+ * must be in your path for this to work.
+ */
+
+if (! $this->cli) {
+	die ('Must be run from the command line.');
+}
+
+$page->layout = false;
+
+$conf = parse_ini_file ('conf/config.php', true);
+switch ($conf['Database']['master']['driver']) {
+	case 'sqlite':
+		if (isset ($_SERVER['argv'][2])) {
+			exec ('sqlite3 ' . $conf['Database']['master']['file'] . ' .dump > ' . $_SERVER['argv'][2]);
+		} else {
+			passthru ('sqlite3 ' . $conf['Database']['master']['file'] . ' .dump');
+		}
+		break;
+
+	case 'mysql':
+		// get port number
+		list ($host, $port) = (strpos ($conf['Database']['master']['host'], ':') !== false)
+			? explode (':', $conf['Database']['master']['host'])
+			: array ($conf['Database']['master']['host'], 3306);
+
+		if (isset ($_SERVER['argv'][2])) {
+			exec (sprintf (
+				'mysqldump --password=%s -u %s -h %s -P %d %s > %s',
+				 escapeshellcmd ($conf['Database']['master']['pass']),
+				 $conf['Database']['master']['user'],
+				 $host,
+				 $port,
+				 $conf['Database']['master']['name'],
+				 $_SERVER['argv'][2]
+			));
+		} else {
+			passthru (sprintf (
+				'mysqldump --password=%s -u %s -h %s -P %d %s',
+				 escapeshellcmd ($conf['Database']['master']['pass']),
+				 $conf['Database']['master']['user'],
+				 $host,
+				 $port,
+				 $conf['Database']['master']['name']
+			));
+		}
+		break;
+
+	case 'pgsql':
+		// get port number
+		list ($host, $port) = (strpos ($conf['Database']['master']['host'], ':') !== false)
+			? explode (':', $conf['Database']['master']['host'])
+			: array ($conf['Database']['master']['host'], 3306);
+
+		file_put_contents ('conf/.pgpass', sprintf (
+			'%s:%d:%s:%s:%s',
+			$host,
+			$port,
+			$conf['Database']['master']['name'],
+			$conf['Database']['master']['user'],
+			$conf['Database']['master']['pass']
+		));
+		chmod ('conf/.pgpass', 0600);
+		if (isset ($_SERVER['argv'][2])) {
+			exec (sprintf (
+				'export PGPASSFILE=conf/.pgpass; pg_dump -U %s -h %s -p %d %s > %s; export PGPASSFILE=~/.pgpass',
+				 $conf['Database']['master']['user'],
+				 $host,
+				 $port,
+				 $conf['Database']['master']['name'],
+				 $_SERVER['argv'][2]
+			));
+		} else {
+			passthru (sprintf (
+				'export PGPASSFILE=conf/.pgpass; pg_dump -U %s -h %s -p %d %s; export PGPASSFILE=~/.pgpass',
+				 $conf['Database']['master']['user'],
+				 $host,
+				 $port,
+				 $conf['Database']['master']['name']
+			));
+		}
+		unlink ('conf/.pgpass');
+		break;
+
+	default:
+		echo "** Error: Unable to determine database driver from site config.\n";
+		break;
+}
+
+?>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/handlers/generate-password.php elefant-1.3.2-beta/apps/cli/handlers/generate-password.php
--- elefant-1.3.1-beta/apps/cli/handlers/generate-password.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/handlers/generate-password.php	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,29 @@
+<?php
+
+/**
+ * Generates a random password of the specified length
+ * (default is 8 characters), using random lower- and
+ * upper-case letters, numbers, and symbols.
+ */
+
+if (! $this->cli) {
+	die ('Must be run from the command line.');
+}
+
+$page->layout = false;
+
+require_once 'apps/cli/lib/Functions.php';
+
+if (isset ($_SERVER['argv'][2])) {
+	if (! is_numeric ($_SERVER['argv'][2])) {
+		echo "Usage: elefant generate-password <length|8>\n";
+		die;
+	}
+	$length = $_SERVER['argv'][2];
+} else {
+	$length = 8;
+}
+
+echo generate_password ($length) . "\n";
+
+?>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/handlers/import-db.php elefant-1.3.2-beta/apps/cli/handlers/import-db.php
--- elefant-1.3.1-beta/apps/cli/handlers/import-db.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/handlers/import-db.php	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,62 @@
+<?php
+
+/**
+ * This command imports a schema file into the database.
+ */
+
+if (! $this->cli) {
+	die ('Must be run from the command line.');
+}
+
+$page->layout = false;
+
+if (! isset ($_SERVER['argv'][2])) {
+	echo "Usage: elefant import-db <file>\n";
+	die;
+}
+
+$file = $_SERVER['argv'][2];
+if (! file_exists ($file)) {
+	echo "** Error: File not found: $file\n";
+	die;
+}
+
+$conf = parse_ini_file ('conf/config.php', true);
+date_default_timezone_set ($conf['General']['timezone']);// connect to the database
+
+$connected = false;
+foreach (array_keys ($conf['Database']) as $key) {
+	if ($key == 'master') {
+		$conf['Database'][$key]['master'] = true;
+		if (! DB::open ($conf['Database'][$key])) {
+			echo "** Error: Could not connect to the database. Please check the\n";
+			echo "          settings in conf/config.php and try again.\n";
+			echo "\n";
+			echo "          " . DB::error () . "\n";
+			return;
+		}
+		$connected = true;
+		break;
+	}
+}
+if (! $connected) {
+	echo "** Error: Could not find a master database. Please check the\n";
+	echo "          settings in conf/config.php and try again.\n";
+	return;
+}
+
+// import the database schema
+$sqldata = sql_split (file_get_contents ($file));
+
+DB::beginTransaction ();
+foreach ($sqldata as $sql) {
+	if (! DB::execute ($sql)) {
+		echo '** Error: ' . DB::error () . "\n";
+		DB::rollback ();
+		return;
+	}
+}
+DB::commit ();
+echo count ($sqldata) . " commands executed.\n";
+
+?>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/handlers/index.php elefant-1.3.2-beta/apps/cli/handlers/index.php
--- elefant-1.3.1-beta/apps/cli/handlers/index.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/handlers/index.php	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,66 @@
+<?php
+
+/**
+ * Handles the default help output for the CLI tool.
+ */
+
+if (! $this->cli) {
+	die ('Must be run from the command line.');
+}
+
+$page->layout = false;
+
+if ($_SERVER['argv'][1] !== 'cli/index' && $_SERVER['argv'][1] !== 'cli/help') {
+	list ($app, $handler) = explode ('/', $_SERVER['argv'][1]);
+	printf ("** Error: Unknown option: %s\n", $handler);
+	return;
+}
+
+$help = <<<HELP
+
+== Elefant framework command line utility ==
+
+Usage:
+
+  $ cd /path/to/my/site
+  $ elefant COMMAND
+
+Commands:
+
+  install                          Run the command line installer
+  update                           Check for and apply Elefant updates
+  backup <path>                    Save a backup of the site and db
+  export-db <file>                 Export the db to a file or STDOUT
+  import-db <file>                 Import a schema file into the db
+  build-app <appname>              Build the scaffolding for an app
+  crud-app <modelname> <fieldlist> Build the scaffolding for a CRUD app
+  generate-password <length(8)>    Generate a random password
+  encrypt-password <password>      Encrypt a password for the db
+  version                          Output the Elefant version number
+  help                             Print this help output
+
+
+HELP;
+
+// Extend command list with those from apps/*/conf/cli.php
+$files = glob ('apps/*/conf/cli.php');
+$commands = array ();
+foreach ($files as $file) {
+	$parsed = parse_ini_file ($file);
+	if (! $parsed || ! isset ($parsed['commands'])) {
+		continue;
+	}
+	$commands = array_merge ($commands, $parsed['commands']);
+}
+
+if (count ($commands) > 0) {
+	$help .= "Extended commands:\n\n";
+	foreach ($commands as $cmd => $desc) {
+		$help .= sprintf ("  %-32s %s\n", $cmd, $desc);
+	}
+	$help .= "\n";
+}
+
+echo $help;
+
+?>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/handlers/install.php elefant-1.3.2-beta/apps/cli/handlers/install.php
--- elefant-1.3.1-beta/apps/cli/handlers/install.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/handlers/install.php	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,95 @@
+<?php
+
+/**
+ * This is the command line install routine.
+ * Its job is to create the database schema
+ * based on the settings in conf/config.php,
+ * and to create an initial admin user account.
+ * It will output the password generated for
+ * that account at the end, and mark itself
+ * as done so as to prevent it or the web
+ * installer from being run a second time.
+ */
+
+if (! $this->cli) {
+	die ('Must be run from the command line.');
+}
+
+$page->layout = false;
+
+if (@file_exists ('conf/installed')) {
+	echo "** Error: Installer has already been run.\n";
+	return;
+}
+
+$conf = parse_ini_file ('conf/config.php', true);
+
+// set the necessary folder permissions
+system ('chmod -R 777 cache conf css files lang layouts');
+system ('chmod 777 apps');
+
+// connect to the database
+$connected = false;
+foreach (array_keys ($conf['Database']) as $key) {
+	if ($key == 'master') {
+		$conf['Database'][$key]['master'] = true;
+		if (! DB::open ($conf['Database'][$key])) {
+			echo "** Error: Could not connect to the database. Please check the\n";
+			echo "          settings in conf/config.php and try again.\n";
+			echo "\n";
+			echo "          " . DB::error () . "\n";
+			return;
+		}
+		$connected = true;
+		break;
+	}
+}
+if (! $connected) {
+	echo "** Error: Could not find a master database. Please check the\n";
+	echo "          settings in conf/config.php and try again.\n";
+	return;
+}
+
+// import the database schema
+$sqldata = sql_split (file_get_contents ('conf/install_' . $conf['Database']['master']['driver'] . '.sql'));
+
+DB::beginTransaction ();
+
+foreach ($sqldata as $sql) {
+	if (! DB::execute ($sql)) {
+		echo '** Error: ' . DB::error () . "\n";
+		DB::rollback ();
+	}
+}
+
+// change the admin user's password
+$pass = generate_password (8);
+$date = gmdate ('Y-m-d H:i:s');
+if (! DB::execute (
+	"update `user` set `email` = ?, `password` = ? where `id` = 1",
+	$conf['General']['email_from'],
+	encrypt_password ($pass)
+)) {
+	echo 'Error: ' . DB::error () . "\n";
+	DB::rollback ();
+}
+
+DB::commit ();
+
+// respond with the root password
+echo "Database created. Your initial admin account is:\n";
+echo 'Username: ' . $conf['General']['email_from'] . "\n";
+echo 'Password: ' . $pass . "\n";
+
+// create versions entries for initial content
+$wp = new Webpage ('index');
+Versions::add ($wp);
+$b = new Block ('members');
+Versions::add ($b);
+
+// disable the installer
+@umask (0000);
+@touch ('conf/installed');
+echo "Done.\n";
+
+?>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/handlers/update.php elefant-1.3.2-beta/apps/cli/handlers/update.php
--- elefant-1.3.1-beta/apps/cli/handlers/update.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/handlers/update.php	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,77 @@
+<?php
+
+/**
+ * This command checks for and applies updates
+ * to the Elefant CMS software. It should be
+ * used only after `./conf/elefant backup` has
+ * been run, as it will apply the updates to
+ * the current site files via the Unix patch
+ * command and `./conf/elefant import-db`.
+ */
+
+if (! $this->cli) {
+	die ('Must be run from the command line.');
+}
+
+$page->layout = false;
+
+echo "Not implemented yet.\n";
+return;
+
+// get the major/minor version
+$major_minor = preg_replace ('/\.[0-9]+$/', '', ELEFANT_VERSION);
+
+// fetch the latest version from the server
+$res = json_decode (
+	file_get_contents (
+		'http://www.elefantcms.com/updates/check.php?v=' . $major_minor
+	)
+);
+
+// are we already up to date?
+if ($res->latest <= ELEFANT_VERSION) {
+	echo "Already up-to-date.\n";
+	return;
+}
+
+// new version ready
+$latest = $res->latest;
+echo "New version: {$latest}\n";
+
+// make sure conf/updates exists
+if (! file_exists ('conf/updates')) {
+	mkdir ('conf/updates');
+}
+
+// check for and download new patch files
+$res = json_decode (file_get_contents ('http://www.elefantcms.com/updates/patches.php'));
+
+foreach ($res->patches as $patch_file) {
+	$base = basename ($patch_file);
+	if (! file_exists ('conf/updates/' . $base)) {
+		echo "Fetching new patch: {$base}\n";
+		file_put_contents (
+			'conf/updates/' . $base,
+			file_get_contents ($patch_file)
+		);
+		// TODO: MD5 checks from 3rd party repo
+	}
+}
+
+foreach ($res->scripts as $script_file) {
+	$base = basename ($script_file);
+	if (! file_exists ('conf/updates/' . $base)) {
+		echo "Fetching new db update: {$base}\n";
+		file_put_contents (
+			'conf/updates/' . $base,
+			file_get_contents ($script_file)
+		);
+		// TODO: MD5 checks from 3rd party repo
+	}
+}
+
+// TODO:
+// 1. determine which patches/db updates need to be run
+// 2. test and apply the patches and db updates in sequence
+
+?>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/handlers/version.php elefant-1.3.2-beta/apps/cli/handlers/version.php
--- elefant-1.3.1-beta/apps/cli/handlers/version.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/handlers/version.php	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,15 @@
+<?php
+
+/**
+ * Output the Elefant version number.
+ */
+
+if (! $this->cli) {
+	die ('Must be run from the command line.');
+}
+
+$page->layout = false;
+
+echo ELEFANT_VERSION . "\n";
+
+?>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/lib/CRUDHelpers.php elefant-1.3.2-beta/apps/cli/lib/CRUDHelpers.php
--- elefant-1.3.1-beta/apps/cli/lib/CRUDHelpers.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/lib/CRUDHelpers.php	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,41 @@
+<?php
+
+/**
+ * Make the field headers for the admin view.
+ */
+function make_fields_header ($fields) {
+	$out = '';
+	$limit = count ($fields) > 3 ? 3 : count ($fields);
+	if ($limit === 1) {
+		$width = 84;
+	} elseif ($limit === 2) {
+		$width = 42;
+	} else {
+		$width = 28;
+	}
+	for ($i = 0; $i < $limit; $i++) {
+		$out .= sprintf (
+			"\t\t<th width=\"%d%%\">{\" %s \"}</th>\n",
+			$width,
+			ucfirst ($fields[$i])
+		);
+	}
+	return $out;
+}
+
+/**
+ * Make the field rows for the admin view.
+ */
+function make_fields_row ($fields) {
+	$out = '';
+	$limit = count ($fields) > 3 ? 3 : count ($fields);
+	for ($i = 0; $i < $limit; $i++) {
+		$out .= sprintf (
+			"\t\t<td>{{ loop_value->%s }}</td>\n",
+			$fields[$i]
+		);
+	}
+	return $out;
+}
+
+?>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/lib/Functions.php elefant-1.3.2-beta/apps/cli/lib/Functions.php
--- elefant-1.3.1-beta/apps/cli/lib/Functions.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/lib/Functions.php	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,17 @@
+<?php
+
+/**
+ * Takes a length and returns a random string of characters of that
+ * length for use in passwords. String may contain any number, lower
+ * or uppercase letters, or common symbols.
+ */
+function generate_password ($length) {
+	$list = '123467890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_-+=~:;|<>[]{}?"\'';
+	$pass = '';
+	while (strlen ($pass) < $length) {
+		$pass .= substr ($list, mt_rand (0, strlen ($list)), 1);
+	}
+	return $pass;
+}
+
+?>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/views/build-app/admin_handler.html elefant-1.3.2-beta/apps/cli/views/build-app/admin_handler.html
--- elefant-1.3.1-beta/apps/cli/views/build-app/admin_handler.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/views/build-app/admin_handler.html	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,9 @@
+{{open_tag|none}}
+
+
+$this->require_admin ();
+
+$page->layout = 'admin';
+$page->title = '{{appname|ucfirst}} admin';
+
+{{close_tag|none}}
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/views/build-app/config.html elefant-1.3.2-beta/apps/cli/views/build-app/config.html
--- elefant-1.3.1-beta/apps/cli/views/build-app/config.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/views/build-app/config.html	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,9 @@
+; {{open_tag|none}} /*
+
+[Admin]
+
+handler = {{appname}}/admin
+name = {{appname|ucfirst}}
+
+
+; */ {{close_tag|none}}
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/views/build-app/index_handler.html elefant-1.3.2-beta/apps/cli/views/build-app/index_handler.html
--- elefant-1.3.1-beta/apps/cli/views/build-app/index_handler.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/views/build-app/index_handler.html	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,7 @@
+{{open_tag|none}}
+
+
+$page->title = '{{appname|ucfirst}} home';
+echo $tpl->render ('{{appname}}/index', array ());
+
+{{close_tag|none}}
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/views/build-app/index_view.html elefant-1.3.2-beta/apps/cli/views/build-app/index_view.html
--- elefant-1.3.1-beta/apps/cli/views/build-app/index_view.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/views/build-app/index_view.html	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1 @@
+<p>\{{ body|none }}</p>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/views/crud-app/add_form.html elefant-1.3.2-beta/apps/cli/views/crud-app/add_form.html
--- elefant-1.3.1-beta/apps/cli/views/crud-app/add_form.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/views/crud-app/add_form.html	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,10 @@
+; {{open_tag|none}} /*
+
+{% for field in fields %}
+{% if field !== 'id' %}
+[{{field}}]
+not empty = 1
+
+{% end %}
+{% end %}
+; */ {{close_tag|none}}
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/views/crud-app/add_handler.html elefant-1.3.2-beta/apps/cli/views/crud-app/add_handler.html
--- elefant-1.3.1-beta/apps/cli/views/crud-app/add_handler.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/views/crud-app/add_handler.html	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,34 @@
+{{open_tag|none}}
+
+
+$this->require_admin ();
+
+$page->layout = 'admin';
+$page->title = __ ('Add {{appname|ucfirst}}');
+
+$form = new Form ('post', $this);
+
+echo $form->handle (function ($form) {
+	// Create and save a new {{appname}} 
+	${{appname}} = new {{plural}}{{backslash}}{{appname|ucfirst}} (array (
+{% for key, field in fields %}
+		'{{field}}' => $_POST['{{field}}']{% if $data->key < count ($data->fields) - 1 %},{% end %} 
+{% end %}
+	));
+	${{appname}}->put ();
+
+	if (${{appname}}->error) {
+		// Failed to save
+		$form->controller->add_notification (__ ('Unable to save {{appname}}.'));
+		return false;
+	}
+
+	// Save a version of the {{appname}} 
+	Versions::add (${{appname}});
+
+	// Notify the user and redirect on success
+	$form->controller->add_notification (__ ('{{appname|ucfirst}} added.'));
+	$form->controller->redirect ('/{{plural}}/admin');
+});
+
+{{close_tag|none}}
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/views/crud-app/add_view.html elefant-1.3.2-beta/apps/cli/views/crud-app/add_view.html
--- elefant-1.3.1-beta/apps/cli/views/crud-app/add_view.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/views/crud-app/add_view.html	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,14 @@
+<form method="post" id="\{{ _form }}">
+
+{% for key, field in fields %}
+<p>
+	\{"{{field|ucfirst}}"}:<br />
+	<input type="text" name="{{field}}" value="\{{ {{field}}|quotes }}" />
+	<span class="notice" id="{{field}}-notice">\{"Please enter a {{field}}."}</span>
+</p>
+
+{% end %}
+
+<p><input type="submit" value="\{"Add {{appname|ucfirst}}"}" /></p>
+
+</form>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/views/crud-app/admin_handler.html elefant-1.3.2-beta/apps/cli/views/crud-app/admin_handler.html
--- elefant-1.3.1-beta/apps/cli/views/crud-app/admin_handler.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/views/crud-app/admin_handler.html	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,30 @@
+{{open_tag|none}}
+
+
+$this->require_admin ();
+
+$page->layout = 'admin';
+$page->title = __ ('{{plural|ucfirst}}');
+
+// Calculate the offset
+$limit = 20;
+$num = isset ($this->params[0]) ? $this->params[0] : 1;
+$offset = ($num - 1) * $limit;
+
+// Fetch the items and total items
+$items = {{plural}}{{backslash}}{{appname|ucfirst}}::query ()->fetch ($limit, $offset);
+$total = {{plural}}{{backslash}}{{appname|ucfirst}}::query ()->count ();
+
+// Pass our data to the view template
+echo $tpl->render (
+	'{{plural}}/admin',
+	array (
+		'limit' => $limit,
+		'total' => $total,
+		'items' => $items,
+		'count' => count ($items),
+		'url' => '/{{plural}}/admin/%d'
+	)
+);
+
+{{close_tag|none}}
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/views/crud-app/admin_view.html elefant-1.3.2-beta/apps/cli/views/crud-app/admin_view.html
--- elefant-1.3.1-beta/apps/cli/views/crud-app/admin_view.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/views/crud-app/admin_view.html	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,23 @@
+<p><a href="/{{plural}}/add">{"Add {{appname|ucfirst}}"}</a></p>
+
+<p>
+<table width="100%">
+	<tr>
+{{ fields|make_fields_header (array_slice (%s, 1)) }}
+		<th width="16%">&nbsp;</th>
+	</tr>
+\{% foreach items %}
+	<tr>
+{{ fields|make_fields_row (array_slice (%s, 1)) }}
+		<td>
+			<a	href="/{{plural}}/edit?id=\{{ loop_value->id }}">\{"Edit"}</a> |
+			<a	href="/{{plural}}/delete"
+				data-id="\{{ loop_value->id }}"
+				onclick="$.confirm_and_post (this, '\{"Are you sure you want to delete this {{appname}}?"}')">\{"Delete"}</a>
+		</td>
+	</tr>
+\{% end %}
+</table>
+</p>
+
+\{! navigation/pager?style=text&url=[url]&total=[total]&count=[count]&limit=[limit] !}
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/views/crud-app/config.html elefant-1.3.2-beta/apps/cli/views/crud-app/config.html
--- elefant-1.3.1-beta/apps/cli/views/crud-app/config.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/views/crud-app/config.html	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,9 @@
+; {{open_tag|none}} /*
+
+[Admin]
+
+handler = {{plural}}/admin
+name = {{plural|ucfirst}}
+
+
+; */ {{close_tag|none}}
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/views/crud-app/delete_handler.html elefant-1.3.2-beta/apps/cli/views/crud-app/delete_handler.html
--- elefant-1.3.1-beta/apps/cli/views/crud-app/delete_handler.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/views/crud-app/delete_handler.html	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,21 @@
+{{open_tag|none}}
+
+
+$this->require_admin ();
+
+if ($_SERVER['REQUEST_METHOD'] !== 'POST') {
+	$this->redirect ('/{{plural}}/admin');
+}
+
+${{appname}} = new {{plural}}{{backslash}}{{appname|ucfirst}};
+${{appname}}->remove ($_POST['id']);
+
+if (${{appname}}->error) {
+	$this->add_notification (__ ('Unable to delete {{appname}}.'));
+	$this->redirect ('/{{plural}}/admin');
+}
+
+$this->add_notification (__ ('{{appname|ucfirst}} deleted.'));
+$this->redirect ('/{{plural}}/admin');
+
+{{close_tag|none}}
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/views/crud-app/edit_form.html elefant-1.3.2-beta/apps/cli/views/crud-app/edit_form.html
--- elefant-1.3.1-beta/apps/cli/views/crud-app/edit_form.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/views/crud-app/edit_form.html	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,10 @@
+; {{open_tag|none}} /*
+
+{% for field in fields %}
+{% if field !== 'id' %}
+[{{field}}]
+not empty = 1
+
+{% end %}
+{% end %}
+; */ {{close_tag|none}}
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/views/crud-app/edit_handler.html elefant-1.3.2-beta/apps/cli/views/crud-app/edit_handler.html
--- elefant-1.3.1-beta/apps/cli/views/crud-app/edit_handler.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/views/crud-app/edit_handler.html	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,35 @@
+{{open_tag|none}}
+
+
+$this->require_admin ();
+
+$page->layout = 'admin';
+$page->title = __ ('Edit {{appname|ucfirst}}');
+
+$form = new Form ('post', $this);
+
+$form->data = new {{plural}}{{backslash}}{{appname|ucfirst}} ($_GET['id']);
+
+echo $form->handle (function ($form) {
+	// Update the {{appname}} 
+	${{appname}} = $form->data;
+{% for key, field in fields %}
+	${{appname}}->{{field}} = $_POST['{{field}}'];
+{% end %}
+	${{appname}}->put ();
+
+	if (${{appname}}->error) {
+		// Failed to save
+		$form->controller->add_notification (__ ('Unable to save {{appname}}.'));
+		return false;
+	}
+
+	// Save a version of the {{appname}} 
+	Versions::add (${{appname}});
+
+	// Notify the user and redirect on success
+	$form->controller->add_notification (__ ('{{appname|ucfirst}} saved.'));
+	$form->controller->redirect ('/{{plural}}/admin');
+});
+
+{{close_tag|none}}
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/views/crud-app/edit_view.html elefant-1.3.2-beta/apps/cli/views/crud-app/edit_view.html
--- elefant-1.3.1-beta/apps/cli/views/crud-app/edit_view.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/views/crud-app/edit_view.html	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,14 @@
+<form method="post" id="\{{ _form }}">
+
+{% for key, field in fields %}
+<p>
+	\{"{{field|ucfirst}}"}:<br />
+	<input type="text" name="{{field}}" value="\{{ {{field}}|quotes }}" />
+	<span class="notice" id="{{field}}-notice">\{"Please enter a {{field}}."}</span>
+</p>
+
+{% end %}
+
+<p><input type="submit" value="\{"Save {{appname|ucfirst}}"}" /></p>
+
+</form>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/views/crud-app/index_handler.html elefant-1.3.2-beta/apps/cli/views/crud-app/index_handler.html
--- elefant-1.3.1-beta/apps/cli/views/crud-app/index_handler.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/views/crud-app/index_handler.html	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,7 @@
+{{open_tag|none}}
+
+
+$page->title = __ ('{{plural|ucfirst}} home');
+echo $tpl->render ('{{plural}}/index', array ());
+
+{{close_tag|none}}
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/views/crud-app/index_view.html elefant-1.3.2-beta/apps/cli/views/crud-app/index_view.html
--- elefant-1.3.1-beta/apps/cli/views/crud-app/index_view.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/views/crud-app/index_view.html	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1 @@
+<p>\{{ body|none }}</p>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/views/crud-app/install_mysql.html elefant-1.3.2-beta/apps/cli/views/crud-app/install_mysql.html
--- elefant-1.3.1-beta/apps/cli/views/crud-app/install_mysql.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/views/crud-app/install_mysql.html	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,9 @@
+create table {{plural}} (
+{% for key, field in fields %}
+{% if field === 'id' %}
+	{{field}} int not null auto_increment primary key{% if $data->key < count ($data->fields) - 1 %},{% end %} 
+{% else %}
+	{{field}} char(48) not null{% if $data->key < count ($data->fields) - 1 %},{% end %} 
+{% end %}
+{% end %}
+);
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/views/crud-app/install_pgsql.html elefant-1.3.2-beta/apps/cli/views/crud-app/install_pgsql.html
--- elefant-1.3.1-beta/apps/cli/views/crud-app/install_pgsql.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/views/crud-app/install_pgsql.html	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,11 @@
+create sequence {{plural}}_id_seq;
+
+create table {{plural}} (
+{% for key, field in fields %}
+{% if field === 'id' %}
+	{{field}} integer not null default nextval('{{plural}}_id_seq') primary key{% if $data->key < count ($data->fields) - 1 %},{% end %} 
+{% else %}
+	{{field}} char(48) not null{% if $data->key < count ($data->fields) - 1 %},{% end %} 
+{% end %}
+{% end %}
+);
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/views/crud-app/install_sqlite.html elefant-1.3.2-beta/apps/cli/views/crud-app/install_sqlite.html
--- elefant-1.3.1-beta/apps/cli/views/crud-app/install_sqlite.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/views/crud-app/install_sqlite.html	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,9 @@
+create table {{plural}} (
+{% for key, field in fields %}
+{% if field === 'id' %}
+	{{field}} integer primary key{% if $data->key < count ($data->fields) - 1 %},{% end %} 
+{% else %}
+	{{field}} char(48) not null{% if $data->key < count ($data->fields) - 1 %},{% end %} 
+{% end %}
+{% end %}
+);
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/cli/views/crud-app/model.html elefant-1.3.2-beta/apps/cli/views/crud-app/model.html
--- elefant-1.3.1-beta/apps/cli/views/crud-app/model.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/cli/views/crud-app/model.html	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,10 @@
+{{open_tag|none}}
+
+
+namespace {{plural}};
+
+class {{appname|ucfirst}} extends \Model {
+	public $table = '{{plural}}';
+}
+
+{{close_tag|none}}
\ No newline at end of file
Files elefant-1.3.1-beta/apps/designer/conf/config.php and elefant-1.3.2-beta/apps/designer/conf/config.php are identical
Files elefant-1.3.1-beta/apps/designer/css/add_layout.css and elefant-1.3.2-beta/apps/designer/css/add_layout.css are identical
Files elefant-1.3.1-beta/apps/designer/css/add_stylesheet.css and elefant-1.3.2-beta/apps/designer/css/add_stylesheet.css are identical
Files elefant-1.3.1-beta/apps/designer/css/edit_layout.css and elefant-1.3.2-beta/apps/designer/css/edit_layout.css are identical
Files elefant-1.3.1-beta/apps/designer/css/edit_stylesheet.css and elefant-1.3.2-beta/apps/designer/css/edit_stylesheet.css are identical
Files elefant-1.3.1-beta/apps/designer/forms/addlayout.php and elefant-1.3.2-beta/apps/designer/forms/addlayout.php are identical
Files elefant-1.3.1-beta/apps/designer/forms/addstylesheet.php and elefant-1.3.2-beta/apps/designer/forms/addstylesheet.php are identical
Files elefant-1.3.1-beta/apps/designer/forms/editlayout.php and elefant-1.3.2-beta/apps/designer/forms/editlayout.php are identical
Files elefant-1.3.1-beta/apps/designer/forms/editstylesheet.php and elefant-1.3.2-beta/apps/designer/forms/editstylesheet.php are identical
Files elefant-1.3.1-beta/apps/designer/forms/installer.php and elefant-1.3.2-beta/apps/designer/forms/installer.php are identical
diff -urBNs elefant-1.3.1-beta/apps/designer/handlers/add/layout.php elefant-1.3.2-beta/apps/designer/handlers/add/layout.php
--- elefant-1.3.1-beta/apps/designer/handlers/add/layout.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/designer/handlers/add/layout.php	2012-09-13 09:15:24.000000000 -0500
@@ -15,7 +15,7 @@
 if ($f->submit ()) {
 	if (@file_put_contents ('layouts/' . $_POST['name'] . '.html', $_POST['body'])) {
 		$this->add_notification (i18n_get ('Layout added.'));
-		@chmod ('layouts/' . $_POST['name'] . '.html', 0777);
+		@chmod ('layouts/' . $_POST['name'] . '.html', 0666);
 		$this->redirect ('/designer');
 	}
 	$page->title = i18n_get ('Saving Layout Failed');
diff -urBNs elefant-1.3.1-beta/apps/designer/handlers/add/stylesheet.php elefant-1.3.2-beta/apps/designer/handlers/add/stylesheet.php
--- elefant-1.3.1-beta/apps/designer/handlers/add/stylesheet.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/designer/handlers/add/stylesheet.php	2012-09-13 09:15:24.000000000 -0500
@@ -15,7 +15,7 @@
 if ($f->submit ()) {
 	if (@file_put_contents ('css/' . $_POST['name'] . '.css', $_POST['body'])) {
 		$this->add_notification (i18n_get ('Stylesheet added.'));
-		@chmod ('layouts/' . $_POST['name'] . '.html', 0777);
+		@chmod ('layouts/' . $_POST['name'] . '.html', 0666);
 		$this->redirect ('/designer');
 	}
 	$page->title = i18n_get ('Saving Stylesheet Failed');
diff -urBNs elefant-1.3.1-beta/apps/designer/handlers/bgsave.php elefant-1.3.2-beta/apps/designer/handlers/bgsave.php
--- elefant-1.3.1-beta/apps/designer/handlers/bgsave.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/designer/handlers/bgsave.php	2012-09-13 09:15:24.000000000 -0500
@@ -24,7 +24,9 @@
 if (! @file_put_contents ($_GET['file'], $_POST['body'])) {
 	$error = 'Saving file failed';
 } else {
-	@chmod ($_GET['file'], 0777);
+	try {
+		@chmod ($_GET['file'], 0666);
+	} catch (Exception $e) {}
 }
 
 $res = new StdClass;
diff -urBNs elefant-1.3.1-beta/apps/designer/handlers/csspreview.php elefant-1.3.2-beta/apps/designer/handlers/csspreview.php
--- elefant-1.3.1-beta/apps/designer/handlers/csspreview.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/designer/handlers/csspreview.php	2012-09-13 09:15:24.000000000 -0500
@@ -8,33 +8,38 @@
 
 $page->title = i18n_get ('Page title');
 $page->preview = true;
+$page->layout = false;
 
 if ($_SERVER['REQUEST_METHOD'] == 'GET') {
 	if (! empty ($_GET['layout'])) {
-		if (file_exists ('layouts/' . $_GET['layout'] . '.html')) {
-			$page->layout = file_get_contents ('layouts/' . $_GET['layout'] . '.html');
-		} elseif (file_exists ('layouts/' . $_GET['layout'] . '/' . $_GET['layout'] . '.html')) {
-			$page->layout = file_get_contents ('layouts/' . $_GET['layout'] . '/' . $_GET['layout'] . '.html');
-		} else {
-			$page->layout = file_get_contents ('layouts/default.html');
+		if (strpos ($_GET['layout'], '..') === false) {
+			if (file_exists ('layouts/' . $_GET['layout'] . '.html')) {
+				$page->layout = file_get_contents ('layouts/' . $_GET['layout'] . '.html');
+			} elseif (file_exists ('layouts/' . $_GET['layout'] . '/' . $_GET['layout'] . '.html')) {
+				$page->layout = file_get_contents ('layouts/' . $_GET['layout'] . '/' . $_GET['layout'] . '.html');
+			}
 		}
-	} else {
-		$page->layout = file_get_contents ('layouts/default.html');
 	}
-	$page->layout = str_replace ('</head>', '<style>' . file_get_contents ($_GET['css']) . '</style></head>', $page->layout);
+	if ($_GET['css'] && preg_match ('/^(layouts|css)\/[a-z0-9\/_-]+\.css$/i', $_GET['css'])) {
+		$page->layout = str_replace ('</head>', '<style>' . file_get_contents ($_GET['css']) . '</style></head>', $page->layout);
+	}
 } else {
 	if (! empty ($_POST['layout'])) {
-		if (file_exists ('layouts/' . $_POST['layout'] . '.html')) {
-			$page->layout = file_get_contents ('layouts/' . $_POST['layout'] . '.html');
-		} elseif (file_exists ('layouts/' . $_POST['layout'] . '/' . $_POST['layout'] . '.html')) {
-			$page->layout = file_get_contents ('layouts/' . $_POST['layout'] . '/' . $_POST['layout'] . '.html');
-		} else {
-			$page->layout = file_get_contents ('layouts/default.html');
+		if (strpos ($_POST['layout'], '..') === false) {
+			if (file_exists ('layouts/' . $_POST['layout'] . '.html')) {
+				$page->layout = file_get_contents ('layouts/' . $_POST['layout'] . '.html');
+			} elseif (file_exists ('layouts/' . $_POST['layout'] . '/' . $_POST['layout'] . '.html')) {
+				$page->layout = file_get_contents ('layouts/' . $_POST['layout'] . '/' . $_POST['layout'] . '.html');
+			}
 		}
-	} else {
-		$page->layout = file_get_contents ('layouts/default.html');
 	}
-	$page->layout = str_replace ('</head>', '<style>' . $_POST['css'] . '</style></head>', $page->layout);
+	if ($_POST['css']) {
+		$page->layout = str_replace ('</head>', '<style>' . $_POST['css'] . '</style></head>', $page->layout);
+	}	
+}
+
+if ($page->layout === false) {
+	$page->layout = file_get_contents ('layouts/default.html');
 }
 
 echo '<p>' . i18n_get ('This is a preview of how your layout will look.') . '</p>';
Files elefant-1.3.1-beta/apps/designer/handlers/delete.php and elefant-1.3.2-beta/apps/designer/handlers/delete.php are identical
diff -urBNs elefant-1.3.1-beta/apps/designer/handlers/edit/layout.php elefant-1.3.2-beta/apps/designer/handlers/edit/layout.php
--- elefant-1.3.1-beta/apps/designer/handlers/edit/layout.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/designer/handlers/edit/layout.php	2012-09-13 09:15:24.000000000 -0500
@@ -10,7 +10,7 @@
 	$this->redirect ('/admin');
 }
 
-if (! preg_match ('/^layouts\/[a-z0-9\/_-]+\.html$/i', $_GET['file'])) {
+if (! preg_match ('/^(layouts|layouts\/[a-z0-9_-]+)\/[a-z0-9_-]+\.html$/i', $_GET['file'])) {
 	$this->redirect ('/designer');
 }
 
@@ -28,7 +28,9 @@
 if ($f->submit ()) {
 	if (@file_put_contents ($_GET['file'], $_POST['body'])) {
 		$this->add_notification (i18n_get ('Layout saved.'));
-		@chmod ($_GET['file'], 0777);
+		try {
+			@chmod ($_GET['file'], 0666);
+		} catch (Exception $e) {}
 		$lock->remove ();
 		$this->redirect ('/designer');
 	}
@@ -45,6 +47,7 @@
 $o->failed = $f->failed;
 $o = $f->merge_values ($o);
 $page->add_script ('/apps/designer/css/edit_layout.css');
+$page->add_script ('/apps/designer/js/jquery.bindWithDelay.js');
 echo $tpl->render ('designer/edit/layout', $o);
 
 ?>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/designer/handlers/edit/stylesheet.php elefant-1.3.2-beta/apps/designer/handlers/edit/stylesheet.php
--- elefant-1.3.1-beta/apps/designer/handlers/edit/stylesheet.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/designer/handlers/edit/stylesheet.php	2012-09-13 09:15:24.000000000 -0500
@@ -10,7 +10,7 @@
 	$this->redirect ('/admin');
 }
 
-if (! preg_match ('/^(css|layouts\/[a-z0-9_-]+)\/[a-z0-9\._-]+\.css$/i', $_GET['file'])) {
+if (! preg_match ('/^(css|layouts|layouts\/[a-z0-9_-]+)\/[a-z0-9_-]+\.css$/i', $_GET['file'])) {
 	$this->redirect ('/designer');
 }
 
@@ -28,7 +28,9 @@
 if ($f->submit ()) {
 	if (@file_put_contents ($_GET['file'], $_POST['body'])) {
 		$this->add_notification (i18n_get ('Stylesheet saved.'));
-		@chmod ($_GET['file'], 0777);
+		try {
+			@chmod ($_GET['file'], 0666);
+		} catch (Exception $e) {}
 		$lock->remove ();
 		$this->redirect ('/designer');
 	}
@@ -42,16 +44,25 @@
 $o->file = $_GET['file'];
 $o->body = @file_get_contents ($_GET['file']);
 $o->layouts = array ();
-foreach (glob ('layouts/*.html') as $layout) {
-	$o->layouts[] = basename ($layout, '.html');
+
+$files = glob ('layouts/*.html');
+if ($files) {
+	foreach ($files as $layout) {
+		$o->layouts[] = basename ($layout, '.html');
+	}
 }
-foreach (glob ('layouts/*/*.html') as $layout) {
-	$o->layouts[] = basename ($layout, '.html');
+
+$files = glob ('layouts/*/*.html');
+if ($files) {
+	foreach ($files as $layout) {
+		$o->layouts[] = basename ($layout, '.html');
+	}
 }
 
 $o->failed = $f->failed;
 $o = $f->merge_values ($o);
 $page->add_script ('/apps/designer/css/edit_stylesheet.css');
+$page->add_script ('/apps/designer/js/jquery.bindWithDelay.js');
 echo $tpl->render ('designer/edit/stylesheet', $o);
 
 ?>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/designer/handlers/index.php elefant-1.3.2-beta/apps/designer/handlers/index.php
--- elefant-1.3.1-beta/apps/designer/handlers/index.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/designer/handlers/index.php	2012-09-13 09:15:24.000000000 -0500
@@ -20,25 +20,31 @@
 	'locks' => array ()
 );
 
-foreach ($out['layouts2'] as $name) {
-	$out['layouts'][] = $name;
+if ($out['layouts2']) {
+  foreach ($out['layouts2'] as $name) {
+	  $out['layouts'][] = $name;
+  }
 }
 
-foreach ($out['stylesheets2'] as $name) {
-	$out['stylesheets'][] = $name;
+if ($out['stylesheets2']) {
+  foreach ($out['stylesheets2'] as $name) {
+	  $out['stylesheets'][] = $name;
+  }
 }
 
-foreach ($out['layouts'] as $name) {
-	$out['locks'][$name] = $lock->exists ('Designer', $name);
+if ($out['layouts']) {
+  foreach ($out['layouts'] as $name) {
+	  $out['locks'][$name] = $lock->exists ('Designer', $name);
+  }
 }
 
-foreach ($out['stylesheets'] as $name) {
-	$out['locks'][$name] = $lock->exists ('Designer', $name);
+if ($out['stylesheets']) {
+  foreach ($out['stylesheets'] as $name) {
+	  $out['locks'][$name] = $lock->exists ('Designer', $name);
+  }
 }
 
-function basename_html ($f) {
-	return basename ($f, '.html');
-}
+require_once ('apps/designer/lib/Functions.php');
 
 $page->title = i18n_get ('Designer');
 echo $tpl->render ('designer/index', $out);
Files elefant-1.3.1-beta/apps/designer/handlers/installer.php and elefant-1.3.2-beta/apps/designer/handlers/installer.php are identical
Files elefant-1.3.1-beta/apps/designer/handlers/makedefault.php and elefant-1.3.2-beta/apps/designer/handlers/makedefault.php are identical
diff -urBNs elefant-1.3.1-beta/apps/designer/handlers/preview.php elefant-1.3.2-beta/apps/designer/handlers/preview.php
--- elefant-1.3.1-beta/apps/designer/handlers/preview.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/designer/handlers/preview.php	2012-09-13 09:15:24.000000000 -0500
@@ -10,10 +10,12 @@
 $page->preview = true;
 
 if ($_SERVER['REQUEST_METHOD'] == 'GET') {
+	$page->layout = '<h1>{{title}}</h1>{{ body|none }}';
 	if (! empty ($_GET['layout'])) {
-		$page->layout = file_get_contents ($_GET['layout']);
-	} else {
-		$page->layout = '<h1>{{title}}</h1>{{ body|none }}';
+		if (preg_match('/^layouts\/[a-z0-9\/_-]+\.html$/i', $_GET['layout']) &&
+			file_exists($_GET['layout']) ) {
+			$page->layout = file_get_contents ($_GET['layout']);
+		}
 	}
 } else {
 	$page->layout = $_POST['layout'];
Files elefant-1.3.1-beta/apps/designer/js/codemirror/LICENSE and elefant-1.3.2-beta/apps/designer/js/codemirror/LICENSE are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/README.md and elefant-1.3.2-beta/apps/designer/js/codemirror/README.md are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/compress.html and elefant-1.3.2-beta/apps/designer/js/codemirror/compress.html are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/css/baboon.png and elefant-1.3.2-beta/apps/designer/js/codemirror/css/baboon.png are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/css/baboon_vector.svg and elefant-1.3.2-beta/apps/designer/js/codemirror/css/baboon_vector.svg are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/css/docs.css and elefant-1.3.2-beta/apps/designer/js/codemirror/css/docs.css are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/demo/activeline.html and elefant-1.3.2-beta/apps/designer/js/codemirror/demo/activeline.html are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/demo/complete.html and elefant-1.3.2-beta/apps/designer/js/codemirror/demo/complete.html are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/demo/complete.js and elefant-1.3.2-beta/apps/designer/js/codemirror/demo/complete.js are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/demo/marker.html and elefant-1.3.2-beta/apps/designer/js/codemirror/demo/marker.html are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/demo/mustache.html and elefant-1.3.2-beta/apps/designer/js/codemirror/demo/mustache.html are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/demo/resize.html and elefant-1.3.2-beta/apps/designer/js/codemirror/demo/resize.html are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/demo/runmode.html and elefant-1.3.2-beta/apps/designer/js/codemirror/demo/runmode.html are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/demo/search.html and elefant-1.3.2-beta/apps/designer/js/codemirror/demo/search.html are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/demo/theme.html and elefant-1.3.2-beta/apps/designer/js/codemirror/demo/theme.html are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/index.html and elefant-1.3.2-beta/apps/designer/js/codemirror/index.html are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/internals.html and elefant-1.3.2-beta/apps/designer/js/codemirror/internals.html are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/lib/codemirror.css and elefant-1.3.2-beta/apps/designer/js/codemirror/lib/codemirror.css are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/lib/codemirror.js and elefant-1.3.2-beta/apps/designer/js/codemirror/lib/codemirror.js are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/lib/overlay.js and elefant-1.3.2-beta/apps/designer/js/codemirror/lib/overlay.js are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/lib/runmode.js and elefant-1.3.2-beta/apps/designer/js/codemirror/lib/runmode.js are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/manual.html and elefant-1.3.2-beta/apps/designer/js/codemirror/manual.html are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/clike/clike.css and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/clike/clike.css are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/clike/clike.js and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/clike/clike.js are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/clike/index.html and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/clike/index.html are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/css/css.js and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/css/css.js are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/css/index.html and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/css/index.html are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/diff/diff.css and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/diff/diff.css are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/diff/diff.js and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/diff/diff.js are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/diff/index.html and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/diff/index.html are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/haskell/haskell.js and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/haskell/haskell.js are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/haskell/index.html and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/haskell/index.html are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/htmlmixed/htmlmixed.js and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/htmlmixed/htmlmixed.js are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/htmlmixed/index.html and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/htmlmixed/index.html are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/javascript/index.html and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/javascript/index.html are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/javascript/javascript.js and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/javascript/javascript.js are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/lua/index.html and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/lua/index.html are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/lua/lua.js and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/lua/lua.js are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/php/index.html and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/php/index.html are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/php/php.js and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/php/php.js are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/plsql/index.html and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/plsql/index.html are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/plsql/plsql.js and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/plsql/plsql.js are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/python/LICENSE.txt and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/python/LICENSE.txt are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/python/index.html and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/python/index.html are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/python/python.js and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/python/python.js are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/rst/index.html and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/rst/index.html are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/rst/rst.css and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/rst/rst.css are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/rst/rst.js and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/rst/rst.js are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/smalltalk/index.html and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/smalltalk/index.html are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/smalltalk/smalltalk.js and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/smalltalk/smalltalk.js are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/stex/index.html and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/stex/index.html are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/stex/stex.js and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/stex/stex.js are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/xml/index.html and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/xml/index.html are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/mode/xml/xml.js and elefant-1.3.2-beta/apps/designer/js/codemirror/mode/xml/xml.js are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/oldrelease.html and elefant-1.3.2-beta/apps/designer/js/codemirror/oldrelease.html are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/test/index.html and elefant-1.3.2-beta/apps/designer/js/codemirror/test/index.html are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/test/test.js and elefant-1.3.2-beta/apps/designer/js/codemirror/test/test.js are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/theme/default.css and elefant-1.3.2-beta/apps/designer/js/codemirror/theme/default.css are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/theme/elegant.css and elefant-1.3.2-beta/apps/designer/js/codemirror/theme/elegant.css are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/theme/neat.css and elefant-1.3.2-beta/apps/designer/js/codemirror/theme/neat.css are identical
Files elefant-1.3.1-beta/apps/designer/js/codemirror/theme/night.css and elefant-1.3.2-beta/apps/designer/js/codemirror/theme/night.css are identical
diff -urBNs elefant-1.3.1-beta/apps/designer/js/jquery.bindWithDelay.js elefant-1.3.2-beta/apps/designer/js/jquery.bindWithDelay.js
--- elefant-1.3.1-beta/apps/designer/js/jquery.bindWithDelay.js	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/apps/designer/js/jquery.bindWithDelay.js	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,56 @@
+/* 
+bindWithDelay jQuery plugin
+Author: Brian Grinstead
+MIT license: http://www.opensource.org/licenses/mit-license.php
+
+http://github.com/bgrins/bindWithDelay
+http://briangrinstead.com/files/bindWithDelay
+
+Usage: 
+	See http://api.jquery.com/bind/
+	.bindWithDelay( eventType, [ eventData ], handler(eventObject), timeout, throttle )
+
+Examples:
+	$("#foo").bindWithDelay("click", function(e) { }, 100);
+	$(window).bindWithDelay("resize", { optional: "eventData" }, callback, 1000);
+	$(window).bindWithDelay("resize", callback, 1000, true);
+*/
+
+(function($) {
+$.fn.bindWithDelay = function( type, data, fn, timeout, throttle ) {
+	
+	if ( $.isFunction( data ) ) {
+		throttle = timeout;
+		timeout = fn;
+		fn = data;
+		data = undefined;
+	}
+
+	// Allow delayed function to be removed with fn in unbind function
+	fn.guid = fn.guid || ($.guid && $.guid++);
+	
+	// Bind each separately so that each element has its own delay
+	return this.each(function() {
+        
+        var wait = null;
+        
+        function cb() {
+            var e = $.extend(true, { }, arguments[0]);
+            var ctx = this;
+            var throttler = function() {
+            	wait = null;
+            	fn.apply(ctx, [e]);
+            };
+            
+            if (!throttle) { clearTimeout(wait); wait = null; }
+            if (!wait) { wait = setTimeout(throttler, timeout); }
+        }
+        
+        cb.guid = fn.guid;
+        
+        $(this).bind(type, data, cb);
+	});
+	
+	
+}
+})(jQuery);
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/designer/lib/Functions.php elefant-1.3.2-beta/apps/designer/lib/Functions.php
--- elefant-1.3.1-beta/apps/designer/lib/Functions.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/designer/lib/Functions.php	2012-09-13 09:15:24.000000000 -0500
@@ -1,6 +1,20 @@
 <?php
 
 /**
+ * Fetches the short name of the layout template.
+ */
+function basename_html ($f) {
+	$name = basename ($f, '.html');
+	$parts = explode ('/', $f);
+	array_pop ($parts);
+	$folder = array_pop ($parts);
+	if ($folder === 'layouts' || $folder === $name) {
+		return $name;
+	}
+	return $folder . '/' . $name;
+}
+
+/**
  * Parse a Github URL and return an array with the username and repository.
  * Returns false on failure.
  */
@@ -16,6 +30,10 @@
 	return false;
 }
 
+/**
+ * Checks a URL to see if it's a zip file, accounting for GitHub's
+ * zipball URLs that don't end in .zip.
+ */
 function github_is_zip ($url) {
 	if (preg_match ('/^https?:\/\/.*\.zip$/i', $url)) {
 		return true;
Files elefant-1.3.1-beta/apps/designer/lib/GithubFetcher.php and elefant-1.3.2-beta/apps/designer/lib/GithubFetcher.php are identical
Files elefant-1.3.1-beta/apps/designer/lib/GithubInstaller.php and elefant-1.3.2-beta/apps/designer/lib/GithubInstaller.php are identical
Files elefant-1.3.1-beta/apps/designer/lib/Installer.php and elefant-1.3.2-beta/apps/designer/lib/Installer.php are identical
Files elefant-1.3.1-beta/apps/designer/lib/PclZip.php and elefant-1.3.2-beta/apps/designer/lib/PclZip.php are identical
diff -urBNs elefant-1.3.1-beta/apps/designer/lib/ZipInstaller.php elefant-1.3.2-beta/apps/designer/lib/ZipInstaller.php
--- elefant-1.3.1-beta/apps/designer/lib/ZipInstaller.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/designer/lib/ZipInstaller.php	2012-09-13 09:15:24.000000000 -0500
@@ -73,7 +73,9 @@
 	 * Remove all files and keep the cache folder clean.
 	 */
 	public static function clean () {
-		rmdir_recursive ('cache/zip');
+		if (file_exists ('cache/zip')) {
+			rmdir_recursive ('cache/zip');
+		}
 	}
 
 	/**
@@ -83,7 +85,7 @@
 		$path = parse_url ($url, PHP_URL_PATH);
 		if (strpos ($path, '/zipball/') !== false) {
 			// Fix zip file links from Github
-			$path = array_shift (explode ('/zipball/', $path)) . '.zip';
+			$path = current (explode ('/zipball/', $path)) . '.zip';
 		}
 		$base = basename ($path);
 		$tmp = 'cache/zip/' . $base;
Files elefant-1.3.1-beta/apps/designer/lib/Zipper.php and elefant-1.3.2-beta/apps/designer/lib/Zipper.php are identical
Files elefant-1.3.1-beta/apps/designer/tests/GithubFetcherTest.php and elefant-1.3.2-beta/apps/designer/tests/GithubFetcherTest.php are identical
Files elefant-1.3.1-beta/apps/designer/tests/ZipperTest.php and elefant-1.3.2-beta/apps/designer/tests/ZipperTest.php are identical
Files elefant-1.3.1-beta/apps/designer/views/add/layout.html and elefant-1.3.2-beta/apps/designer/views/add/layout.html are identical
Files elefant-1.3.1-beta/apps/designer/views/add/stylesheet.html and elefant-1.3.2-beta/apps/designer/views/add/stylesheet.html are identical
diff -urBNs elefant-1.3.1-beta/apps/designer/views/edit/layout.html elefant-1.3.2-beta/apps/designer/views/edit/layout.html
--- elefant-1.3.1-beta/apps/designer/views/edit/layout.html	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/designer/views/edit/layout.html	2012-09-13 09:15:24.000000000 -0500
@@ -86,7 +86,7 @@
 	});
 
 	filemanager_last_preview = _codemirror.getValue ();
-	filemanager_interval = setInterval (function () {
+	$('.CodeMirror').bindWithDelay ('keyup', function () {
 		var layout = _codemirror.getValue ();
 		if (layout != filemanager_last_preview) {
 			filemanager_last_preview = layout;
@@ -94,6 +94,6 @@
 				document.getElementById ('preview').contentDocument.body.innerHTML = res;
 			});
 		}
-	}, 2000);
+	}, 500);
 });
 </script>
diff -urBNs elefant-1.3.1-beta/apps/designer/views/edit/stylesheet.html elefant-1.3.2-beta/apps/designer/views/edit/stylesheet.html
--- elefant-1.3.1-beta/apps/designer/views/edit/stylesheet.html	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/designer/views/edit/stylesheet.html	2012-09-13 09:15:24.000000000 -0500
@@ -15,7 +15,7 @@
 	<option value="{{ loop_value }}"{% if loop_value == 'default' %} selected{% end %}>{{ loop_value }}</option>
 {% end %}
 </select><br />
-<iframe src="/designer/csspreview?layout=default" id="preview" frameborder="0" width="1022" height="300" style="border: 1px solid #ccc"></iframe></p>
+<iframe src="/designer/csspreview?layout=default&css={{ file }}" id="preview" frameborder="0" width="1022" height="300" style="border: 1px solid #ccc"></iframe></p>
 </form>
 
 <link rel="stylesheet" type="text/css" href="/apps/designer/js/codemirror/lib/codemirror.css" />
@@ -85,16 +85,18 @@
 	});
 
 	filemanager_last_preview = _codemirror.getValue ();
-	filemanager_interval = setInterval (function () {
+	filemanager_last_preview_layout = $('#layout').val ();
+	$('.CodeMirror').bindWithDelay ('keyup', function () {
 		var css = _codemirror.getValue (),
 			layout = $('#layout').val ();
 
-		if (css != filemanager_last_preview) {
-			filemanager_last_preview = layout;
+		if (css != filemanager_last_preview || layout != filemanager_last_preview_layout) {
+			filemanager_last_preview = css;
+			filemanager_last_preview_layout = layout;
 			$.post ('/designer/csspreview', {layout: layout, css: css}, function (res) {
 				document.getElementById ('preview').contentDocument.body.innerHTML = res;
 			});
 		}
-	}, 2000);
+	}, 500);
 });
 </script>
Files elefant-1.3.1-beta/apps/designer/views/index.html and elefant-1.3.2-beta/apps/designer/views/index.html are identical
Files elefant-1.3.1-beta/apps/designer/views/installed.html and elefant-1.3.2-beta/apps/designer/views/installed.html are identical
diff -urBNs elefant-1.3.1-beta/apps/designer/views/installer.html elefant-1.3.2-beta/apps/designer/views/installer.html
--- elefant-1.3.1-beta/apps/designer/views/installer.html	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/designer/views/installer.html	2012-09-13 09:15:24.000000000 -0500
@@ -3,11 +3,16 @@
 
 <p><strong><em>{"Important: Only install apps or themes from trusted sources."}</em></strong></p>
 
+{% if ! extension_loaded ('curl') %}
+<p class="visible-notice">{"Note: Installing from links has been disabled because the PHP cURL extension is missing."}</p>
+{% else %}
+
 <p>{"Link to a zip file or Github repository"} (ex: <tt>https://github.com/user/project.git</tt>):<br />
 <input type="text" size="40" name="github" value="{{ github|quotes }}" />
 <span class="notice" id="github-notice">{" The link appears to be invalid. "}</span></p>
 
 <p>- {"or"} -</p>
+{% end %}
 
 <p>{"Upload a zip file"}:<br />
 <input type="file" name="zipfile" />
Files elefant-1.3.1-beta/apps/filemanager/conf/config.php and elefant-1.3.2-beta/apps/filemanager/conf/config.php are identical
Files elefant-1.3.1-beta/apps/filemanager/conf/embed.php and elefant-1.3.2-beta/apps/filemanager/conf/embed.php are identical
Files elefant-1.3.1-beta/apps/filemanager/css/current.png and elefant-1.3.2-beta/apps/filemanager/css/current.png are identical
Files elefant-1.3.1-beta/apps/filemanager/css/gallery.css and elefant-1.3.2-beta/apps/filemanager/css/gallery.css are identical
Files elefant-1.3.1-beta/apps/filemanager/css/gallery_embedded.css and elefant-1.3.2-beta/apps/filemanager/css/gallery_embedded.css are identical
Files elefant-1.3.1-beta/apps/filemanager/css/mediaelement/background.png and elefant-1.3.2-beta/apps/filemanager/css/mediaelement/background.png are identical
Files elefant-1.3.1-beta/apps/filemanager/css/mediaelement/bigplay.png and elefant-1.3.2-beta/apps/filemanager/css/mediaelement/bigplay.png are identical
Files elefant-1.3.1-beta/apps/filemanager/css/mediaelement/controls.png and elefant-1.3.2-beta/apps/filemanager/css/mediaelement/controls.png are identical
Files elefant-1.3.1-beta/apps/filemanager/css/mediaelement/loading.gif and elefant-1.3.2-beta/apps/filemanager/css/mediaelement/loading.gif are identical
Files elefant-1.3.1-beta/apps/filemanager/css/mediaelement/mediaelementplayer.css and elefant-1.3.2-beta/apps/filemanager/css/mediaelement/mediaelementplayer.css are identical
Files elefant-1.3.1-beta/apps/filemanager/css/notcurrent.png and elefant-1.3.2-beta/apps/filemanager/css/notcurrent.png are identical
diff -urBNs elefant-1.3.1-beta/apps/filemanager/handlers/api.php elefant-1.3.2-beta/apps/filemanager/handlers/api.php
--- elefant-1.3.1-beta/apps/filemanager/handlers/api.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/filemanager/handlers/api.php	2012-09-13 09:15:24.000000000 -0500
@@ -5,6 +5,6 @@
  */
 
 $this->require_admin ();
-$this->restful (new FileManager ());
+$this->restful (new FileManager ($this));
 
 ?>
\ No newline at end of file
Files elefant-1.3.1-beta/apps/filemanager/handlers/audio.php and elefant-1.3.2-beta/apps/filemanager/handlers/audio.php are identical
Files elefant-1.3.1-beta/apps/filemanager/handlers/embed.php and elefant-1.3.2-beta/apps/filemanager/handlers/embed.php are identical
diff -urBNs elefant-1.3.1-beta/apps/filemanager/handlers/gallery.php elefant-1.3.2-beta/apps/filemanager/handlers/gallery.php
--- elefant-1.3.1-beta/apps/filemanager/handlers/gallery.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/filemanager/handlers/gallery.php	2012-09-13 09:15:24.000000000 -0500
@@ -66,9 +66,9 @@
 	$template,
 	array (
 		'files' => $list,
-		'gallery' => str_replace (array ('/', '.'), array ('-', '-'), $path),
+		'gallery' => str_replace (array ('/', '.', ' '), array ('-', '-', '-'), $path),
 		'desc' => $data['desc']
 	)
 );
 
-?>
\ No newline at end of file
+?>
Files elefant-1.3.1-beta/apps/filemanager/handlers/index.php and elefant-1.3.2-beta/apps/filemanager/handlers/index.php are identical
Files elefant-1.3.1-beta/apps/filemanager/handlers/mediaelement.php and elefant-1.3.2-beta/apps/filemanager/handlers/mediaelement.php are identical
diff -urBNs elefant-1.3.1-beta/apps/filemanager/handlers/multi.php elefant-1.3.2-beta/apps/filemanager/handlers/multi.php
--- elefant-1.3.1-beta/apps/filemanager/handlers/multi.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/filemanager/handlers/multi.php	2012-09-13 09:15:24.000000000 -0500
@@ -43,7 +43,10 @@
 	}
 	// File saved
 
-	chmod ($root . $_GET['path'] . '/' . $_FILES['Filedata']['name'], 0777);
+	chmod ($root . $_GET['path'] . '/' . $_FILES['Filedata']['name'], 0666);
+	$this->hook ('filemanager/add', array (
+		'file' => $_POST['path'] . '/' . $_FILES['Filedata']['name']
+	));
 	echo '1';
 	return;
 }
Files elefant-1.3.1-beta/apps/filemanager/handlers/properties.php and elefant-1.3.2-beta/apps/filemanager/handlers/properties.php are identical
Files elefant-1.3.1-beta/apps/filemanager/handlers/slideshow.php and elefant-1.3.2-beta/apps/filemanager/handlers/slideshow.php are identical
Files elefant-1.3.1-beta/apps/filemanager/handlers/swf.php and elefant-1.3.2-beta/apps/filemanager/handlers/swf.php are identical
Files elefant-1.3.1-beta/apps/filemanager/handlers/upgrade.php and elefant-1.3.2-beta/apps/filemanager/handlers/upgrade.php are identical
diff -urBNs elefant-1.3.1-beta/apps/filemanager/handlers/upload.php elefant-1.3.2-beta/apps/filemanager/handlers/upload.php
--- elefant-1.3.1-beta/apps/filemanager/handlers/upload.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/filemanager/handlers/upload.php	2012-09-13 09:15:24.000000000 -0500
@@ -16,26 +16,65 @@
 	$page->title = i18n_get ('Invalid Path');
 	echo '<p><a href="/filemanager">' . i18n_get ('Back') . '</a></p>';
 	return;
-} elseif ($_FILES['file']['error'] > 0) {
-	$page->title = i18n_get ('An Error Occurred');
-	echo '<p>' . i18n_get ('Error message') . ': ' . $_FILES['file']['error'] . '</p>';
-	echo '<p><a href="/filemanager">' . i18n_get ('Back') . '</a></p>';
-	return;
-} elseif (@file_exists ($root . $_POST['path'] . '/' . $_FILES['file']['name'])) {
-	$page->title = i18n_get ('File Already Exists');
-	echo '<p>' . i18n_get ('A file by that name already exists.') . '</p>';
-	echo '<p><a href="/filemanager">' . i18n_get ('Back') . '</a></p>';
-	return;
-} elseif (! @move_uploaded_file ($_FILES['file']['tmp_name'], $root . $_POST['path'] . '/' . $_FILES['file']['name'])) {
+}
+
+if (! isset ($_FILES['file'])) {
 	$page->title = i18n_get ('An Error Occurred');
-	echo '<p>' . i18n_get ('Unable to save the file.') . '</p>';
+	echo '<p>' . i18n_get ('No file uploaded or file too large.') . '</p>';
 	echo '<p><a href="/filemanager">' . i18n_get ('Back') . '</a></p>';
 	return;
 }
 
-@chmod ($root . $_POST['path'] . '/' . $_FILES['file']['name'], 0777);
+foreach ($_FILES['file']['error'] as $error) {
+	if ($error > 0) {
+		$errors = array (
+			1 => i18n_get ('File size is too large.'),
+			2 => i18n_get ('File size is too large.'),
+			3 => i18n_get ('The file was only partially uploaded.'),
+			4 => i18n_get ('No file was uploaded.'),
+			6 => i18n_get ('Missing a temporary folder, check your PHP setup.'),
+			7 => i18n_get ('Failed to write the file to disk.'),
+			8 => i18n_get ('A PHP extension stopped the file upload.')
+		);
+		$page->title = i18n_get ('An Error Occurred');
+		echo '<p>' . i18n_get ('Error message') . ': ' . $errors[$error] . '</p>';
+		echo '<p><a href="/filemanager">' . i18n_get ('Back') . '</a></p>';
+		return;
+	}
+}
+
+for ($i = 0; $i < count ($_FILES['file']['name']); $i++) {
+	if (@file_exists ($root . $_POST['path'] . '/' . $_FILES['file']['name'][$i])) {
+		$page->title = i18n_get ('File Already Exists') . ': ' . $_FILES['file']['name'][$i];
+		echo '<p>' . i18n_get ('A file by that name already exists.') . '</p>';
+		echo '<p><a href="/filemanager">' . i18n_get ('Back') . '</a></p>';
+		return;
+	}
+}
 
-$this->add_notification (i18n_get ('File saved.'));
+$count = 0;
+$errors = array ();
+for ($i = 0; $i < count ($_FILES['file']['name']); $i++) {
+	if (@move_uploaded_file ($_FILES['file']['tmp_name'][$i], $root . $_POST['path'] . '/' . $_FILES['file']['name'][$i])) {
+		$count++;
+		@chmod ($root . $_POST['path'] . '/' . $_FILES['file']['name'][$i], 0666);
+		$this->hook ('filemanager/add', array (
+			'file' => $_POST['path'] . '/' . $_FILES['file']['name']
+		));
+	} else {
+		$errors[] = $_FILES['file']['name'][$i];
+	}
+}
+
+if (count ($_FILES['file']) > 1) {
+	if (count ($_FILES['file']['name']) === $count) {
+		$this->add_notification (i18n_getf ('%d files saved.', $count));
+	} else {
+		$this->add_notification (i18n_getf ('%d file saved. Unable to save files: %s', $count, join (', ', $errors)));
+	}
+} else {
+	$this->add_notification (i18n_get ('File saved.'));
+}
 $this->redirect ('/filemanager?path=' . $_POST['path']);
 
 ?>
\ No newline at end of file
Files elefant-1.3.1-beta/apps/filemanager/handlers/video.php and elefant-1.3.2-beta/apps/filemanager/handlers/video.php are identical
Files elefant-1.3.1-beta/apps/filemanager/js/expressInstall.swf and elefant-1.3.2-beta/apps/filemanager/js/expressInstall.swf are identical
Files elefant-1.3.1-beta/apps/filemanager/js/fancybox/blank.gif and elefant-1.3.2-beta/apps/filemanager/js/fancybox/blank.gif are identical
Files elefant-1.3.1-beta/apps/filemanager/js/fancybox/fancy_close.png and elefant-1.3.2-beta/apps/filemanager/js/fancybox/fancy_close.png are identical
Files elefant-1.3.1-beta/apps/filemanager/js/fancybox/fancy_loading.png and elefant-1.3.2-beta/apps/filemanager/js/fancybox/fancy_loading.png are identical
Files elefant-1.3.1-beta/apps/filemanager/js/fancybox/fancy_nav_left.png and elefant-1.3.2-beta/apps/filemanager/js/fancybox/fancy_nav_left.png are identical
Files elefant-1.3.1-beta/apps/filemanager/js/fancybox/fancy_nav_right.png and elefant-1.3.2-beta/apps/filemanager/js/fancybox/fancy_nav_right.png are identical
Files elefant-1.3.1-beta/apps/filemanager/js/fancybox/fancy_shadow_e.png and elefant-1.3.2-beta/apps/filemanager/js/fancybox/fancy_shadow_e.png are identical
Files elefant-1.3.1-beta/apps/filemanager/js/fancybox/fancy_shadow_n.png and elefant-1.3.2-beta/apps/filemanager/js/fancybox/fancy_shadow_n.png are identical
Files elefant-1.3.1-beta/apps/filemanager/js/fancybox/fancy_shadow_ne.png and elefant-1.3.2-beta/apps/filemanager/js/fancybox/fancy_shadow_ne.png are identical
Files elefant-1.3.1-beta/apps/filemanager/js/fancybox/fancy_shadow_nw.png and elefant-1.3.2-beta/apps/filemanager/js/fancybox/fancy_shadow_nw.png are identical
Files elefant-1.3.1-beta/apps/filemanager/js/fancybox/fancy_shadow_s.png and elefant-1.3.2-beta/apps/filemanager/js/fancybox/fancy_shadow_s.png are identical
Files elefant-1.3.1-beta/apps/filemanager/js/fancybox/fancy_shadow_se.png and elefant-1.3.2-beta/apps/filemanager/js/fancybox/fancy_shadow_se.png are identical
Files elefant-1.3.1-beta/apps/filemanager/js/fancybox/fancy_shadow_sw.png and elefant-1.3.2-beta/apps/filemanager/js/fancybox/fancy_shadow_sw.png are identical
Files elefant-1.3.1-beta/apps/filemanager/js/fancybox/fancy_shadow_w.png and elefant-1.3.2-beta/apps/filemanager/js/fancybox/fancy_shadow_w.png are identical
Files elefant-1.3.1-beta/apps/filemanager/js/fancybox/fancy_title_left.png and elefant-1.3.2-beta/apps/filemanager/js/fancybox/fancy_title_left.png are identical
Files elefant-1.3.1-beta/apps/filemanager/js/fancybox/fancy_title_main.png and elefant-1.3.2-beta/apps/filemanager/js/fancybox/fancy_title_main.png are identical
Files elefant-1.3.1-beta/apps/filemanager/js/fancybox/fancy_title_over.png and elefant-1.3.2-beta/apps/filemanager/js/fancybox/fancy_title_over.png are identical
Files elefant-1.3.1-beta/apps/filemanager/js/fancybox/fancy_title_right.png and elefant-1.3.2-beta/apps/filemanager/js/fancybox/fancy_title_right.png are identical
Files elefant-1.3.1-beta/apps/filemanager/js/fancybox/fancybox-x.png and elefant-1.3.2-beta/apps/filemanager/js/fancybox/fancybox-x.png are identical
Files elefant-1.3.1-beta/apps/filemanager/js/fancybox/fancybox-y.png and elefant-1.3.2-beta/apps/filemanager/js/fancybox/fancybox-y.png are identical
Files elefant-1.3.1-beta/apps/filemanager/js/fancybox/fancybox.png and elefant-1.3.2-beta/apps/filemanager/js/fancybox/fancybox.png are identical
Files elefant-1.3.1-beta/apps/filemanager/js/fancybox/jquery.easing-1.3.pack.js and elefant-1.3.2-beta/apps/filemanager/js/fancybox/jquery.easing-1.3.pack.js are identical
Files elefant-1.3.1-beta/apps/filemanager/js/fancybox/jquery.fancybox-1.3.4.css and elefant-1.3.2-beta/apps/filemanager/js/fancybox/jquery.fancybox-1.3.4.css are identical
Files elefant-1.3.1-beta/apps/filemanager/js/fancybox/jquery.fancybox-1.3.4.js and elefant-1.3.2-beta/apps/filemanager/js/fancybox/jquery.fancybox-1.3.4.js are identical
Files elefant-1.3.1-beta/apps/filemanager/js/fancybox/jquery.fancybox-1.3.4.pack.js and elefant-1.3.2-beta/apps/filemanager/js/fancybox/jquery.fancybox-1.3.4.pack.js are identical
Files elefant-1.3.1-beta/apps/filemanager/js/fancybox/jquery.mousewheel-3.0.4.pack.js and elefant-1.3.2-beta/apps/filemanager/js/fancybox/jquery.mousewheel-3.0.4.pack.js are identical
Files elefant-1.3.1-beta/apps/filemanager/js/flashmediaelement.swf and elefant-1.3.2-beta/apps/filemanager/js/flashmediaelement.swf are identical
Files elefant-1.3.1-beta/apps/filemanager/js/jquery.cycle.all.min.js and elefant-1.3.2-beta/apps/filemanager/js/jquery.cycle.all.min.js are identical
diff -urBNs elefant-1.3.1-beta/apps/filemanager/js/jquery.filemanager.js elefant-1.3.2-beta/apps/filemanager/js/jquery.filemanager.js
--- elefant-1.3.1-beta/apps/filemanager/js/jquery.filemanager.js	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/filemanager/js/jquery.filemanager.js	2012-09-13 09:15:24.000000000 -0500
@@ -9,10 +9,11 @@
 			};
 			
 			var options = $.extend (defaults, options);
+			var dir_length= 120;
 			
 			switch (cmd) {
 				case 'mkdir':
-					var name = prompt ('New folder name:', '');
+					var name = downcode ( prompt ('New folder name:', ''), dir_length );
 					if (name) {
 						$.get (options.root + cmd + '/' + options.file + '/' + name, function (res) {
 							if (res.success) {
@@ -25,7 +26,7 @@
 					}
 					break;
 				case 'mv':
-					var name = prompt ('Rename:', options.name);
+					var name = downcode ( prompt ('Rename:', options.name), dir_length);
 					if (name) {
 						$.get (options.root + cmd + '/' + options.file + '?rename=' + name, function (res) {
 							if (res.success) {
Files elefant-1.3.1-beta/apps/filemanager/js/jquery.tmpl.beta1.min.js and elefant-1.3.2-beta/apps/filemanager/js/jquery.tmpl.beta1.min.js are identical
Files elefant-1.3.1-beta/apps/filemanager/js/mediaelement-and-player.min.js and elefant-1.3.2-beta/apps/filemanager/js/mediaelement-and-player.min.js are identical
Files elefant-1.3.1-beta/apps/filemanager/js/swfobject.js and elefant-1.3.2-beta/apps/filemanager/js/swfobject.js are identical
Files elefant-1.3.1-beta/apps/filemanager/js/uploadify/cancel.png and elefant-1.3.2-beta/apps/filemanager/js/uploadify/cancel.png are identical
Files elefant-1.3.1-beta/apps/filemanager/js/uploadify/jquery.uploadify.v2.1.4.min.js and elefant-1.3.2-beta/apps/filemanager/js/uploadify/jquery.uploadify.v2.1.4.min.js are identical
Files elefant-1.3.1-beta/apps/filemanager/js/uploadify/rollover.png and elefant-1.3.2-beta/apps/filemanager/js/uploadify/rollover.png are identical
Files elefant-1.3.1-beta/apps/filemanager/js/uploadify/swfobject.js and elefant-1.3.2-beta/apps/filemanager/js/uploadify/swfobject.js are identical
Files elefant-1.3.1-beta/apps/filemanager/js/uploadify/uploadify.css and elefant-1.3.2-beta/apps/filemanager/js/uploadify/uploadify.css are identical
Files elefant-1.3.1-beta/apps/filemanager/js/uploadify/uploadify.swf and elefant-1.3.2-beta/apps/filemanager/js/uploadify/uploadify.swf are identical
diff -urBNs elefant-1.3.1-beta/apps/filemanager/lib/FileManager.php elefant-1.3.2-beta/apps/filemanager/lib/FileManager.php
--- elefant-1.3.1-beta/apps/filemanager/lib/FileManager.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/filemanager/lib/FileManager.php	2012-09-13 09:15:24.000000000 -0500
@@ -45,9 +45,15 @@
 	public static $error;
 
 	/**
+	 * The controller object for the current request.
+	 */
+	public $controller;
+
+	/**
 	 * Constructor sets $root.
 	 */
-	public function __construct () {
+	public function __construct ($controller) {
+		$this->controller = $controller;
 		$this->root = getcwd () . $this->webroot;
 	}
 
@@ -101,6 +107,9 @@
 			return $this->error (i18n_get ('Unable to delete') . ' ' . $file);
 		}
 		FileManager::prop_delete ($file);
+		$this->controller->hook ('filemanager/delete', array (
+			'file' => $file
+		));
 		return array ('msg' => i18n_get ('File deleted.'), 'data' => $file);
 	}
 
@@ -134,6 +143,10 @@
 					return $this->error (i18n_get ('Unable to rename') . ' ' . $file);
 				}
 				FileManager::prop_rename ($file, $new);
+				$this->controller->hook ('filemanager/rename', array (
+					'file' => $file,
+					'renamed' => $new
+				));
 				return array ('msg' => i18n_get ('File renamed.'), 'data' => $new);
 			}
 		}
@@ -294,25 +307,12 @@
 		}
 		if (is_array ($file)) {
 			// get as a list
-			$db = DB::get_connection (1);
-			if ($db->getAttribute (PDO::ATTR_DRIVER_NAME) === 'mysql') {
-				return DB::pairs (
-					'select file, value from filemanager_prop where file in() and prop = ?',
-					$file,
-					$prop
-				);
-			}
-			$sql = 'select file, value from filemanager_prop where (';
-			$params = array ();
-			$join = '';
-			foreach ($file as $f) {
-				$sql .= $join . 'file = ?';
-				$params[] = $f;
-				$join = ' or ';
-			}
-			$sql .= ') and prop = ?';
-			$params[] = $prop;
-			return DB::pairs ($sql, $params);
+			$qmarks = array_fill (0, count ($file), '?');
+			$file[] = $prop;
+			return DB::pairs (
+				'select file, value from filemanager_prop where file in(' . join (', ', $qmarks) . ') and prop = ?',
+				$file
+			);
 		}
 		// get a single value
 		return DB::shift (
@@ -364,4 +364,4 @@
 	}
 }
 
-?>
\ No newline at end of file
+?>
Files elefant-1.3.1-beta/apps/filemanager/lib/Functions.php and elefant-1.3.2-beta/apps/filemanager/lib/Functions.php are identical
Files elefant-1.3.1-beta/apps/filemanager/views/audio.html and elefant-1.3.2-beta/apps/filemanager/views/audio.html are identical
Files elefant-1.3.1-beta/apps/filemanager/views/gallery/embedded.html and elefant-1.3.2-beta/apps/filemanager/views/gallery/embedded.html are identical
Files elefant-1.3.1-beta/apps/filemanager/views/gallery.html and elefant-1.3.2-beta/apps/filemanager/views/gallery.html are identical
diff -urBNs elefant-1.3.1-beta/apps/filemanager/views/index.html elefant-1.3.2-beta/apps/filemanager/views/index.html
--- elefant-1.3.1-beta/apps/filemanager/views/index.html	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/filemanager/views/index.html	2012-09-13 09:15:24.000000000 -0500
@@ -1,6 +1,7 @@
 {! admin/util/dates !}
 {! admin/util/modal !}
 
+<script type="text/javascript" src="/js/urlify.js"></script>
 <script type="text/javascript" src="/apps/filemanager/js/jquery.tmpl.beta1.min.js"></script>
 <script type="text/javascript" src="/apps/filemanager/js/jquery.filemanager.js"></script>
 <script type="text/x-jquery-tmpl" id="tpl_dir">
@@ -50,7 +51,7 @@
 	<input type="hidden" name="path" value="{{ path }}" />
 	<a href="#" onclick="return $.filemanager ('mkdir', {file: '{{ path }}'})">{"New folder"}</a>
 	&nbsp;|&nbsp;
-	{"New file"} ({"max"} {{ ini_get ('upload_max_filesize')}}B): <input type="file" name="file" /> <input type="submit" value="{"Upload"}" onclick="if (this.form.elements.file.value == '') { alert ('Please select a file to upload.'); return false; } this.value = 'Uploading...'; this.disabled = true; this.form.submit ()" />
+	{"New file"} ({"max"} {{ ini_get ('upload_max_filesize')}}B): <input type="file" name="file[]" multiple="multiple" /> <input type="submit" value="{"Upload"}" onclick="if (this.form.elements.file.value == '') { alert ('Please select a file to upload.'); return false; } this.value = 'Uploading...'; this.disabled = true; this.form.submit ()" />
 	&nbsp;|&nbsp;
 	<a href="/filemanager/multi?path=/{{ path }}">{"Multi-file uploader"}</a>
 	</form>
Files elefant-1.3.1-beta/apps/filemanager/views/mediaelement.html and elefant-1.3.2-beta/apps/filemanager/views/mediaelement.html are identical
Files elefant-1.3.1-beta/apps/filemanager/views/multi.html and elefant-1.3.2-beta/apps/filemanager/views/multi.html are identical
Files elefant-1.3.1-beta/apps/filemanager/views/properties.html and elefant-1.3.2-beta/apps/filemanager/views/properties.html are identical
diff -urBNs elefant-1.3.1-beta/apps/filemanager/views/slideshow.html elefant-1.3.2-beta/apps/filemanager/views/slideshow.html
--- elefant-1.3.1-beta/apps/filemanager/views/slideshow.html	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/filemanager/views/slideshow.html	2012-09-13 09:15:24.000000000 -0500
@@ -37,4 +37,4 @@
 {% end %}
 </div>
 <div id="slideshow-nav"></div>
-<br clear="both" />
+<br style="clear: both" />
Files elefant-1.3.1-beta/apps/filemanager/views/swf.html and elefant-1.3.2-beta/apps/filemanager/views/swf.html are identical
Files elefant-1.3.1-beta/apps/filemanager/views/video.html and elefant-1.3.2-beta/apps/filemanager/views/video.html are identical
Files elefant-1.3.1-beta/apps/navigation/conf/config.php and elefant-1.3.2-beta/apps/navigation/conf/config.php are identical
Files elefant-1.3.1-beta/apps/navigation/conf/embed.php and elefant-1.3.2-beta/apps/navigation/conf/embed.php are identical
Files elefant-1.3.1-beta/apps/navigation/handlers/admin.php and elefant-1.3.2-beta/apps/navigation/handlers/admin.php are identical
Files elefant-1.3.1-beta/apps/navigation/handlers/api.php and elefant-1.3.2-beta/apps/navigation/handlers/api.php are identical
Files elefant-1.3.1-beta/apps/navigation/handlers/breadcrumb.php and elefant-1.3.2-beta/apps/navigation/handlers/breadcrumb.php are identical
Files elefant-1.3.1-beta/apps/navigation/handlers/contextual.php and elefant-1.3.2-beta/apps/navigation/handlers/contextual.php are identical
Files elefant-1.3.1-beta/apps/navigation/handlers/hook/delete.php and elefant-1.3.2-beta/apps/navigation/handlers/hook/delete.php are identical
Files elefant-1.3.1-beta/apps/navigation/handlers/hook/edit.php and elefant-1.3.2-beta/apps/navigation/handlers/hook/edit.php are identical
Files elefant-1.3.1-beta/apps/navigation/handlers/index.php and elefant-1.3.2-beta/apps/navigation/handlers/index.php are identical
Files elefant-1.3.1-beta/apps/navigation/handlers/json.php and elefant-1.3.2-beta/apps/navigation/handlers/json.php are identical
Files elefant-1.3.1-beta/apps/navigation/handlers/map.php and elefant-1.3.2-beta/apps/navigation/handlers/map.php are identical
diff -urBNs elefant-1.3.1-beta/apps/navigation/handlers/pager.php elefant-1.3.2-beta/apps/navigation/handlers/pager.php
--- elefant-1.3.1-beta/apps/navigation/handlers/pager.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/navigation/handlers/pager.php	2012-09-13 09:15:24.000000000 -0500
@@ -37,13 +37,19 @@
  *
  *     << 1 2 3 4 >>
  *
+ *     {! navigation/pager?style=results&url=[url]&total=[total]&count=[count]&limit=[limit] !}
+ *
+ * Will show:
+ *
+ *     1 to 20 of 32 results:
+ *
  * All elements can be styled with CSS classes.
  */
 
 $o = new StdClass;
 
 // the pager template to display
-$styles = array ('text', 'numbers');
+$styles = array ('text', 'numbers', 'results');
 if (! isset ($data['style']) || ! in_array ($data['style'], $styles)) {
 	$data['style'] = 'text';
 }
@@ -51,7 +57,7 @@
 $o->limit = $data['limit']; // number of results per set
 $o->total = $data['total']; // total number of results
 $o->count = $data['count']; // count of results in this set
-$o->url = $data['url']; // the url format for building pager links
+$o->url = str_replace ('&amp;', '&', $data['url']); // the url format for building pager links
 
 // the page number from the current url, or zero
 $url = str_replace ('%d', '([0-9]+)', preg_quote ($o->url));
@@ -78,6 +84,22 @@
 	$o->links[$i] = sprintf ($o->url, $i);
 }
 
+if ($data['style'] === 'results') {
+	if ($o->total == 0) {
+		echo __ ('No results.');
+	} elseif ($o->total == 1) {
+		echo __ ('1 result:');
+	} else {
+		echo __ (
+			'%d to %d of %d results:',
+			($o->offset + 1),
+			$o->last,
+			$o->total
+		);
+	}
+	return;
+}
+
 echo $tpl->render ('navigation/pager/' . $data['style'], $o);
 
 ?>
\ No newline at end of file
Files elefant-1.3.1-beta/apps/navigation/handlers/section.php and elefant-1.3.2-beta/apps/navigation/handlers/section.php are identical
diff -urBNs elefant-1.3.1-beta/apps/navigation/handlers/top.php elefant-1.3.2-beta/apps/navigation/handlers/top.php
--- elefant-1.3.1-beta/apps/navigation/handlers/top.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/navigation/handlers/top.php	2012-09-13 09:15:24.000000000 -0500
@@ -6,7 +6,7 @@
  * `<li>` element for custom styling.
  */
 
-$res = $memcache->get ('_navigation_top');
+$res = $cache->get ('_navigation_top');
 if ($res) {
 	echo str_replace (
 		sprintf ('<li><a href="/%s">', $page->id),
@@ -24,7 +24,7 @@
 }
 $out .= '</ul>';
 
-$memcache->set ('_navigation_top', $out);
+$cache->set ('_navigation_top', $out);
 
 echo str_replace (
 	sprintf ('<li><a href="/%s">', $page->id),
@@ -32,4 +32,4 @@
 	$out
 );
 
-?>
\ No newline at end of file
+?>
Files elefant-1.3.1-beta/apps/navigation/js/jquery.jstree.js and elefant-1.3.2-beta/apps/navigation/js/jquery.jstree.js are identical
Files elefant-1.3.1-beta/apps/navigation/js/themes/apple/bg.jpg and elefant-1.3.2-beta/apps/navigation/js/themes/apple/bg.jpg are identical
Files elefant-1.3.1-beta/apps/navigation/js/themes/apple/d.png and elefant-1.3.2-beta/apps/navigation/js/themes/apple/d.png are identical
Files elefant-1.3.1-beta/apps/navigation/js/themes/apple/dot_for_ie.gif and elefant-1.3.2-beta/apps/navigation/js/themes/apple/dot_for_ie.gif are identical
Files elefant-1.3.1-beta/apps/navigation/js/themes/apple/style.css and elefant-1.3.2-beta/apps/navigation/js/themes/apple/style.css are identical
Files elefant-1.3.1-beta/apps/navigation/js/themes/apple/throbber.gif and elefant-1.3.2-beta/apps/navigation/js/themes/apple/throbber.gif are identical
Files elefant-1.3.1-beta/apps/navigation/js/themes/classic/d.gif and elefant-1.3.2-beta/apps/navigation/js/themes/classic/d.gif are identical
Files elefant-1.3.1-beta/apps/navigation/js/themes/classic/d.png and elefant-1.3.2-beta/apps/navigation/js/themes/classic/d.png are identical
Files elefant-1.3.1-beta/apps/navigation/js/themes/classic/dot_for_ie.gif and elefant-1.3.2-beta/apps/navigation/js/themes/classic/dot_for_ie.gif are identical
Files elefant-1.3.1-beta/apps/navigation/js/themes/classic/style.css and elefant-1.3.2-beta/apps/navigation/js/themes/classic/style.css are identical
Files elefant-1.3.1-beta/apps/navigation/js/themes/classic/throbber.gif and elefant-1.3.2-beta/apps/navigation/js/themes/classic/throbber.gif are identical
Files elefant-1.3.1-beta/apps/navigation/js/themes/default/d.gif and elefant-1.3.2-beta/apps/navigation/js/themes/default/d.gif are identical
Files elefant-1.3.1-beta/apps/navigation/js/themes/default/d.png and elefant-1.3.2-beta/apps/navigation/js/themes/default/d.png are identical
Files elefant-1.3.1-beta/apps/navigation/js/themes/default/style.css and elefant-1.3.2-beta/apps/navigation/js/themes/default/style.css are identical
Files elefant-1.3.1-beta/apps/navigation/js/themes/default/throbber.gif and elefant-1.3.2-beta/apps/navigation/js/themes/default/throbber.gif are identical
Files elefant-1.3.1-beta/apps/navigation/js/themes/default-rtl/d.gif and elefant-1.3.2-beta/apps/navigation/js/themes/default-rtl/d.gif are identical
Files elefant-1.3.1-beta/apps/navigation/js/themes/default-rtl/d.png and elefant-1.3.2-beta/apps/navigation/js/themes/default-rtl/d.png are identical
Files elefant-1.3.1-beta/apps/navigation/js/themes/default-rtl/dots.gif and elefant-1.3.2-beta/apps/navigation/js/themes/default-rtl/dots.gif are identical
Files elefant-1.3.1-beta/apps/navigation/js/themes/default-rtl/style.css and elefant-1.3.2-beta/apps/navigation/js/themes/default-rtl/style.css are identical
Files elefant-1.3.1-beta/apps/navigation/js/themes/default-rtl/throbber.gif and elefant-1.3.2-beta/apps/navigation/js/themes/default-rtl/throbber.gif are identical
diff -urBNs elefant-1.3.1-beta/apps/navigation/lib/Functions.php elefant-1.3.2-beta/apps/navigation/lib/Functions.php
--- elefant-1.3.1-beta/apps/navigation/lib/Functions.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/navigation/lib/Functions.php	2012-09-13 09:15:24.000000000 -0500
@@ -37,12 +37,12 @@
 }
 
 /**
- * Clears all memcache keys for the navigation app.
+ * Clears all cache keys for the navigation app.
  */
 function navigation_clear_cache () {
-	global $memcache;
-	$memcache->delete ('_navigation_top');
-	$memcache->delete ('navigation_map');
+	global $cache;
+	$cache->delete ('_navigation_top');
+	$cache->delete ('navigation_map');
 }
 
 /**
@@ -65,4 +65,4 @@
 	return $pages;
 }
 
-?>
\ No newline at end of file
+?>
Files elefant-1.3.1-beta/apps/navigation/lib/Navigation.php and elefant-1.3.2-beta/apps/navigation/lib/Navigation.php are identical
Files elefant-1.3.1-beta/apps/navigation/pix/trash.png and elefant-1.3.2-beta/apps/navigation/pix/trash.png are identical
Files elefant-1.3.1-beta/apps/navigation/views/admin.html and elefant-1.3.2-beta/apps/navigation/views/admin.html are identical
diff -urBNs elefant-1.3.1-beta/apps/navigation/views/pager/numbers.html elefant-1.3.2-beta/apps/navigation/views/pager/numbers.html
--- elefant-1.3.1-beta/apps/navigation/views/pager/numbers.html	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/navigation/views/pager/numbers.html	2012-09-13 09:15:24.000000000 -0500
@@ -1,14 +1,14 @@
 <div class="pager">
 	<div class="pager-numbers">
-		<span class="pager-number pager-first"><a href="{{ first_link }}">&laquo;</a></span>
+		<span class="pager-number pager-first"><a href="{{ first_link|none }}">&laquo;</a></span>
 {% foreach links %}
 	{% if loop_index === $data->num %}
 		<span class="pager-number pager-current">{{ loop_index }}</span>
 	{% else %}
-		<span class="pager-number"><a href="{{ loop_value }}">{{ loop_index }}</a></span>
+		<span class="pager-number"><a href="{{ loop_value|none }}">{{ loop_index }}</a></span>
 	{% end %}
 {% end %}
-		<span class="pager-number pager-last"><a href="{{ last_link }}">&raquo;</a></span>
+		<span class="pager-number pager-last"><a href="{{ last_link|none }}">&raquo;</a></span>
 	</div>
 
 	<br clear="both" />
diff -urBNs elefant-1.3.1-beta/apps/navigation/views/pager/text.html elefant-1.3.2-beta/apps/navigation/views/pager/text.html
--- elefant-1.3.1-beta/apps/navigation/views/pager/text.html	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/navigation/views/pager/text.html	2012-09-13 09:15:24.000000000 -0500
@@ -1,11 +1,11 @@
 <div class="pager">
 	<div class="pager-text">
 {% if num > 1 %}
-		<span class="pager-previous"><a href="{{ prev_link }}">&laquo; {" Newer results "}</a></span>
+		<span class="pager-previous"><a href="{{ prev_link|none }}">&laquo; {" Newer results "}</a></span>
 {% end %}
 
 {% if more %}
-		<span class="pager-next"><a href="{{ next_link }}">{" Older results "} &raquo;</a></span>
+		<span class="pager-next"><a href="{{ next_link|none }}">{" Older results "} &raquo;</a></span>
 {% end %}
 	</div>
 
Files elefant-1.3.1-beta/apps/social/conf/config.php and elefant-1.3.2-beta/apps/social/conf/config.php are identical
Files elefant-1.3.1-beta/apps/social/conf/embed.php and elefant-1.3.2-beta/apps/social/conf/embed.php are identical
Files elefant-1.3.1-beta/apps/social/handlers/facebook/commentcount.php and elefant-1.3.2-beta/apps/social/handlers/facebook/commentcount.php are identical
Files elefant-1.3.1-beta/apps/social/handlers/facebook/comments.php and elefant-1.3.2-beta/apps/social/handlers/facebook/comments.php are identical
Files elefant-1.3.1-beta/apps/social/handlers/facebook/init.php and elefant-1.3.2-beta/apps/social/handlers/facebook/init.php are identical
Files elefant-1.3.1-beta/apps/social/handlers/facebook/like-box.php and elefant-1.3.2-beta/apps/social/handlers/facebook/like-box.php are identical
Files elefant-1.3.1-beta/apps/social/handlers/facebook/like.php and elefant-1.3.2-beta/apps/social/handlers/facebook/like.php are identical
Files elefant-1.3.1-beta/apps/social/handlers/google/init.php and elefant-1.3.2-beta/apps/social/handlers/google/init.php are identical
Files elefant-1.3.1-beta/apps/social/handlers/google/maps.php and elefant-1.3.2-beta/apps/social/handlers/google/maps.php are identical
Files elefant-1.3.1-beta/apps/social/handlers/google/plusone.php and elefant-1.3.2-beta/apps/social/handlers/google/plusone.php are identical
Files elefant-1.3.1-beta/apps/social/handlers/index.php and elefant-1.3.2-beta/apps/social/handlers/index.php are identical
Files elefant-1.3.1-beta/apps/social/handlers/twitter/feed.php and elefant-1.3.2-beta/apps/social/handlers/twitter/feed.php are identical
Files elefant-1.3.1-beta/apps/social/handlers/twitter/follow.php and elefant-1.3.2-beta/apps/social/handlers/twitter/follow.php are identical
Files elefant-1.3.1-beta/apps/social/handlers/twitter/init.php and elefant-1.3.2-beta/apps/social/handlers/twitter/init.php are identical
Files elefant-1.3.1-beta/apps/social/handlers/twitter/tweet.php and elefant-1.3.2-beta/apps/social/handlers/twitter/tweet.php are identical
Files elefant-1.3.1-beta/apps/social/handlers/video/vimeo.php and elefant-1.3.2-beta/apps/social/handlers/video/vimeo.php are identical
Files elefant-1.3.1-beta/apps/social/handlers/video/youtube.php and elefant-1.3.2-beta/apps/social/handlers/video/youtube.php are identical
Files elefant-1.3.1-beta/apps/social/lib/Functions.php and elefant-1.3.2-beta/apps/social/lib/Functions.php are identical
Files elefant-1.3.1-beta/apps/social/views/facebook/commentcount.html and elefant-1.3.2-beta/apps/social/views/facebook/commentcount.html are identical
Files elefant-1.3.1-beta/apps/social/views/facebook/comments.html and elefant-1.3.2-beta/apps/social/views/facebook/comments.html are identical
Files elefant-1.3.1-beta/apps/social/views/facebook/init.html and elefant-1.3.2-beta/apps/social/views/facebook/init.html are identical
Files elefant-1.3.1-beta/apps/social/views/facebook/like-box.html and elefant-1.3.2-beta/apps/social/views/facebook/like-box.html are identical
Files elefant-1.3.1-beta/apps/social/views/facebook/like.html and elefant-1.3.2-beta/apps/social/views/facebook/like.html are identical
Files elefant-1.3.1-beta/apps/social/views/google/init.html and elefant-1.3.2-beta/apps/social/views/google/init.html are identical
Files elefant-1.3.1-beta/apps/social/views/google/maps.html and elefant-1.3.2-beta/apps/social/views/google/maps.html are identical
Files elefant-1.3.1-beta/apps/social/views/google/plusone.html and elefant-1.3.2-beta/apps/social/views/google/plusone.html are identical
Files elefant-1.3.1-beta/apps/social/views/index.html and elefant-1.3.2-beta/apps/social/views/index.html are identical
Files elefant-1.3.1-beta/apps/social/views/twitter/feed.html and elefant-1.3.2-beta/apps/social/views/twitter/feed.html are identical
Files elefant-1.3.1-beta/apps/social/views/twitter/follow.html and elefant-1.3.2-beta/apps/social/views/twitter/follow.html are identical
Files elefant-1.3.1-beta/apps/social/views/twitter/init.html and elefant-1.3.2-beta/apps/social/views/twitter/init.html are identical
Files elefant-1.3.1-beta/apps/social/views/twitter/tweet.html and elefant-1.3.2-beta/apps/social/views/twitter/tweet.html are identical
Files elefant-1.3.1-beta/apps/social/views/video/vimeo.html and elefant-1.3.2-beta/apps/social/views/video/vimeo.html are identical
Files elefant-1.3.1-beta/apps/social/views/video/youtube.html and elefant-1.3.2-beta/apps/social/views/video/youtube.html are identical
Files elefant-1.3.1-beta/apps/translator/conf/config.php and elefant-1.3.2-beta/apps/translator/conf/config.php are identical
diff -urBNs elefant-1.3.1-beta/apps/translator/forms/add.php elefant-1.3.2-beta/apps/translator/forms/add.php
--- elefant-1.3.1-beta/apps/translator/forms/add.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/translator/forms/add.php	2012-09-13 09:15:24.000000000 -0500
@@ -14,4 +14,16 @@
 not empty = 1
 default = UTF-8
 
+[date_format]
+
+default = "mmmm d, yyyy"
+
+[short_format]
+
+default = "mmm d"
+
+[time_format]
+
+default = "h:MMa"
+
 ; */ ?>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/translator/forms/settings.php elefant-1.3.2-beta/apps/translator/forms/settings.php
--- elefant-1.3.1-beta/apps/translator/forms/settings.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/translator/forms/settings.php	2012-09-13 09:15:24.000000000 -0500
@@ -11,6 +11,5 @@
 [charset]
 
 not empty = 1
-default = UTF-8
 
 ; */ ?>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/apps/translator/handlers/add.php elefant-1.3.2-beta/apps/translator/handlers/add.php
--- elefant-1.3.1-beta/apps/translator/handlers/add.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/translator/handlers/add.php	2012-09-13 09:15:24.000000000 -0500
@@ -35,7 +35,10 @@
 		'locale' => $_POST['locale'],
 		'charset' => $_POST['charset'],
 		'fallback' => $_POST['fallback'],
-		'default' => 'Off'
+		'default' => 'Off',
+		'date_format' => $_POST['date_format'],
+		'short_format' => $_POST['short_format'],
+		'time_format' => $_POST['time_format']
 	);
 
 	uasort ($i18n->languages, 'translator_sort_languages');
Files elefant-1.3.1-beta/apps/translator/handlers/api.php and elefant-1.3.2-beta/apps/translator/handlers/api.php are identical
diff -urBNs elefant-1.3.1-beta/apps/translator/handlers/build.php elefant-1.3.2-beta/apps/translator/handlers/build.php
--- elefant-1.3.1-beta/apps/translator/handlers/build.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/translator/handlers/build.php	2012-09-13 09:15:24.000000000 -0500
@@ -61,8 +61,8 @@
 			}
 		} else {
 			// parse for i18n_getf?() syntax
-			preg_match_all ('/i18n_getf? ?\([\'"](.*?)[\'"]\)/', $data, $matches);
-			foreach ($matches[1] as $str) {
+			preg_match_all ('/(i18n_getf?|__) ?\([\'"](.*?)[\'"]\)/', $data, $matches);
+			foreach ($matches[2] as $str) {
 				$str = stripslashes ($str);
 				if (! isset ($list[$str])) {
 					$list[$str] = array (
@@ -76,7 +76,7 @@
 }
 asort ($list);
 file_put_contents ('lang/_index.php', serialize ($list));
-chmod ('lang/_index.php', 0777);
+chmod ('lang/_index.php', 0666);
 
 $page->title = i18n_get ('Indexing completed');
 
Files elefant-1.3.1-beta/apps/translator/handlers/delete.php and elefant-1.3.2-beta/apps/translator/handlers/delete.php are identical
diff -urBNs elefant-1.3.1-beta/apps/translator/handlers/edit.php elefant-1.3.2-beta/apps/translator/handlers/edit.php
--- elefant-1.3.1-beta/apps/translator/handlers/edit.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/translator/handlers/edit.php	2012-09-13 09:15:24.000000000 -0500
@@ -18,6 +18,11 @@
 
 $lang = $this->params[0];
 
+$empty = (isset ($_GET['empty']) && $_GET['empty'] == 1) ? true : false;
+if (! $empty) {
+	$_GET['empty'] = '';
+}
+
 $info = $i18n->languages[$lang];
 
 $page->title = i18n_get ('Editing language') . ': ' . $info['name'];
@@ -37,7 +42,8 @@
 		'name' => $info['name'],
 		'lang' => $lang,
 		'sources' => $sources,
-		'contains' => $_GET['contains']
+		'contains' => $_GET['contains'],
+		'empty' => $empty
 	));
 } elseif (isset ($_GET['source']) && ! empty ($_GET['source'])) {
 	$items = Translator::get_by_source ($all, $_GET['source']);
@@ -50,7 +56,8 @@
 		'name' => $info['name'],
 		'lang' => $lang,
 		'sources' => $sources,
-		'source' => $_GET['source']
+		'source' => $_GET['source'],
+		'empty' => $empty
 	));
 } else {
 	$num = isset ($this->params[1]) ? $this->params[1] : 1;
@@ -58,20 +65,32 @@
 	$limit = 40;
 	$offset = ($num - 1) * $limit;
 
-	$items = array_slice ($all, $offset, $limit);
-
-	$tr = new Translator;
-	$items = $tr->translations ($lang, $items);
+	if ($empty) {
+		$tr = new Translator;
+		$all = $tr->translations ($lang, $all);
+		foreach ($all as $k => $v) {
+			if ($v['trans'] !== '') {
+				unset ($all[$k]);
+			}
+		}
+		$items = array_slice ($all, $offset, $limit);
+	} else {
+		$items = array_slice ($all, $offset, $limit);
+
+		$tr = new Translator;
+		$items = $tr->translations ($lang, $items);
+	}
 
 	echo $tpl->render ('translator/edit', array (
 		'limit' => $limit,
 		'total' => count ($all),
 		'items' => $items,
 		'count' => count ($items),
-		'url' => '/translator/edit/' . $lang . '/%d',
+		'url' => '/translator/edit/' . $lang . '/%d?empty=' . $_GET['empty'],
 		'name' => $info['name'],
 		'lang' => $lang,
-		'sources' => $sources
+		'sources' => $sources,
+		'empty' => $empty
 	));
 }
 
Files elefant-1.3.1-beta/apps/translator/handlers/index.php and elefant-1.3.2-beta/apps/translator/handlers/index.php are identical
Files elefant-1.3.1-beta/apps/translator/handlers/makedefault.php and elefant-1.3.2-beta/apps/translator/handlers/makedefault.php are identical
diff -urBNs elefant-1.3.1-beta/apps/translator/handlers/settings.php elefant-1.3.2-beta/apps/translator/handlers/settings.php
--- elefant-1.3.1-beta/apps/translator/handlers/settings.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/translator/handlers/settings.php	2012-09-13 09:15:24.000000000 -0500
@@ -57,6 +57,9 @@
 	$i18n->languages[$lang]['locale'] = $_POST['locale'];
 	$i18n->languages[$lang]['charset'] = $_POST['charset'];
 	$i18n->languages[$lang]['fallback'] = $_POST['fallback'];
+	$i18n->languages[$lang]['date_format'] = $_POST['date_format'];
+	$i18n->languages[$lang]['short_format'] = $_POST['short_format'];
+	$i18n->languages[$lang]['time_format'] = $_POST['time_format'];
 
 	uasort ($i18n->languages, 'translator_sort_languages');
 
diff -urBNs elefant-1.3.1-beta/apps/translator/lib/Functions.php elefant-1.3.2-beta/apps/translator/lib/Functions.php
--- elefant-1.3.1-beta/apps/translator/lib/Functions.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/translator/lib/Functions.php	2012-09-13 09:15:24.000000000 -0500
@@ -33,7 +33,7 @@
  * from a translatable string.
  */
 function translator_field_id ($text) {
-	return preg_replace ('/[^a-z0-9_-]+/', '-', strtolower ($text));
+	return URLify::filter ($text);
 }
 
 /**
diff -urBNs elefant-1.3.1-beta/apps/translator/lib/Translator.php elefant-1.3.2-beta/apps/translator/lib/Translator.php
--- elefant-1.3.1-beta/apps/translator/lib/Translator.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/translator/lib/Translator.php	2012-09-13 09:15:24.000000000 -0500
@@ -85,7 +85,7 @@
 		if (! file_put_contents ('lang/' . $lang . '.php', $out)) {
 			return false;
 		}
-		chmod ('lang/' . $lang . '.php', 0777);
+		chmod ('lang/' . $lang . '.php', 0666);
 		return true;
 	}
 
diff -urBNs elefant-1.3.1-beta/apps/translator/views/add.html elefant-1.3.2-beta/apps/translator/views/add.html
--- elefant-1.3.1-beta/apps/translator/views/add.html	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/translator/views/add.html	2012-09-13 09:15:24.000000000 -0500
@@ -1,14 +1,46 @@
+{! admin/util/dates !}
+
 <form method="post" id="{{ _form }}">
 
+<div class="date-reference">
+<p><strong>{"Date formatting reference"}:</strong></p>
+
+<code><pre>
+<span class="cd">yy     </span><span class="ex">12         </span><span class="su">{"Year in two digit form"}</span>
+<span class="cd">yyyy   </span><span class="ex">2012       </span><span class="su">{"Year in full"}</span>
+<span class="cd">m      </span><span class="ex">9          </span><span class="su">{"Month in numeric form"}</span>
+<span class="cd">mm     </span><span class="ex">09         </span><span class="su">{"Month in numeric form, zero-padded"}</span>
+<span class="cd">mmm    </span><span class="ex">Sep        </span><span class="su">{"Month name, abbreviated"}</span>
+<span class="cd">mmmm   </span><span class="ex">September  </span><span class="su">{"Month name"}</span>
+<span class="cd">d      </span><span class="ex">3          </span><span class="su">{"Date"}</span>
+<span class="cd">dd     </span><span class="ex">03         </span><span class="su">{"Date, zero-padded"}</span>
+<span class="cd">ddd    </span><span class="ex">Mon        </span><span class="su">{"Day of the week, abbreviated"}</span>
+<span class="cd">dddd   </span><span class="ex">Monday     </span><span class="su">{"Day of the week"}</span>
+<span class="cd">o      </span><span class="ex">1st        </span><span class="su">{"Date in ordinal form"}</span>
+<span class="cd">h      </span><span class="ex">6          </span><span class="su">{"Hours in 12-hour time"}</span>
+<span class="cd">hh     </span><span class="ex">06         </span><span class="su">{"Hours in 12-hour time, zero-padded"}</span>
+<span class="cd">H      </span><span class="ex">18         </span><span class="su">{"Hours in 24-hour time"}</span>
+<span class="cd">HH     </span><span class="ex">06         </span><span class="su">{"Hours in 24-hour time, zero-padded"}</span>
+<span class="cd">M      </span><span class="ex">4          </span><span class="su">{"Minutes"}</span>
+<span class="cd">MM     </span><span class="ex">04         </span><span class="su">{"Minutes, zero-padded"}</span>
+<span class="cd">s      </span><span class="ex">7          </span><span class="su">{"Seconds"}</span>
+<span class="cd">ss     </span><span class="ex">07         </span><span class="su">{"Seconds, zero-padded"}</span>
+<span class="cd">S      </span><span class="ex">7.000      </span><span class="su">{"Seconds with milliseconds"}</span>
+<span class="cd">SS     </span><span class="ex">07.000     </span><span class="su">{"Seconds, zero-padded, with milliseconds"}</span>
+<span class="cd">a      </span><span class="ex">AM         </span><span class="su">{"Period"}</span>
+<span class="cd">Z      </span><span class="ex">+02:00     </span><span class="su">{"Time zone offset"}</span>
+</pre></code>
+</div>
+
 <p>{"Language"}:<br />
 <input type="text" size="30" name="name" value="{{ name|quotes }}" />
 <span class="notice" id="name-notice">{"Please enter the name of the language."}</span></p>
 
-<p>{"Language code"} (ex: `en`, `fr`, `es`):<br />
+<p>{"Language code"} (ex: <a href="http://en.wikipedia.org/wiki/List_of_ISO_639-1_codes" target="_blank">en, fr, es</a>):<br />
 <input type="text" size="15" name="code" value="{{ code|quotes }}" />
 <span class="notice" id="code-notice">{"Please enter the language code."}</span></p>
 
-<p>{"Locale"} ({"optional"}, ex: `us`, `ca`, 'gb`):<br />
+<p>{"Locale"} ({"optional"}, ex: <a href="http://en.wikipedia.org/wiki/ISO_3166-1" target="_blank">us, ca, gb</a>):<br />
 <input type="text" size="15" name="locale" value="{{ locale|quotes }}" /></p>
 
 <p>{"Character set"}:<br />
@@ -24,6 +56,21 @@
 </select>
 </p>
 
+<p>{"Local date format"}:<br />
+<input type="text" name="date_format" id="date-format" value="{{ date_format|quotes }}" />
+<span class="ex"><time class="date-preview" datetime="{{date ('Y')}}-09-21T16:32:47+00:00"></time></span>
+</p>
+
+<p>{"Short date format"}:<br />
+<input type="text" name="short_format" id="short-format" value="{{ short_format|quotes }}" />
+<span class="ex"><time class="short-preview" datetime="{{date ('Y')}}-09-21T16:32:47+00:00"></time></span>
+</p>
+
+<p>{"Local time format"}:<br />
+<input type="text" name="time_format" id="time-format" value="{{ time_format|quotes }}" />
+<span class="ex"><time class="time-preview" datetime="{{date ('Y')}}-09-21T22:32:47+00:00"></time></span>
+</p>
+
 <p>
 	<input type="submit" value="{"Add"}" />
 	&nbsp;
@@ -31,3 +78,46 @@
 </p>
 
 </form>
+
+<style>
+.date-reference {
+	float: right;
+	border: 1px solid #ddd;
+	background: #fff;
+	padding: 5px 7px 0px 7px;
+	-webkit-border-radius: 3px;
+	-moz-border-radius: 3px;
+	border-radius: 3px;
+}
+.cd { color: teal; }
+.ex { font-style: italic; color: #777; }
+.su { color: #b84; }
+</style>
+
+<script>
+$(function () {
+	function dates_preview (field, id, default_value) {
+		if (field.value === '') {
+			$('time.' + id).localize (default_value);
+		} else {
+			$('time.' + id).localize (field.value);
+		}
+	}
+
+	dates_preview ($('#date-format')[0], 'date-preview', 'mmmm d, yyyy');
+	dates_preview ($('#short-format')[0], 'short-preview', 'mmm d');
+	dates_preview ($('#time-format')[0], 'time-preview', 'h:MMa');
+
+	$('#date-format').keyup (function () {
+		dates_preview (this, 'date-preview', 'mmmm d, yyyy');
+	});
+
+	$('#short-format').keyup (function () {
+		dates_preview (this, 'short-preview', 'mmm d');
+	});
+
+	$('#time-format').keyup (function () {
+		dates_preview (this, 'time-preview', 'h:MMa');
+	});
+});
+</script>
diff -urBNs elefant-1.3.1-beta/apps/translator/views/edit.html elefant-1.3.2-beta/apps/translator/views/edit.html
--- elefant-1.3.1-beta/apps/translator/views/edit.html	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/translator/views/edit.html	2012-09-13 09:15:24.000000000 -0500
@@ -1,5 +1,5 @@
 <form style="display: inline" method="GET" action="/translator/edit/{{ lang }}">
-<div style="float: right">
+<div style="float: right; margin-top: -5px">
 <select name="source" onchange="this.form.elements['contains'].value = ''; this.form.submit ()">
 	<option value="">- {"Limit to source file"} -</option>
 {% foreach sources %}
@@ -18,7 +18,16 @@
 <table width="100%">
 	<tr>
 		<th width="48%">{"Original text"}</th>
-		<th width="52%">{{ name }}</th>
+		<th width="52%">
+			<span style="float: right">
+				{% if empty %}
+					<a href="/translator/edit/{{ lang }}">{"Show all fields"}</a>
+				{% else %}
+					<a href="/translator/edit/{{ lang }}?empty=1">{"Show empty fields"}</a>
+				{% end %}
+			</span>
+			{{ name }}
+		</th>
 	</tr>
 {% foreach items %}
 	<tr id="tr-{{ loop_index|translator_field_id }}">
diff -urBNs elefant-1.3.1-beta/apps/translator/views/edit_search.html elefant-1.3.2-beta/apps/translator/views/edit_search.html
--- elefant-1.3.1-beta/apps/translator/views/edit_search.html	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/translator/views/edit_search.html	2012-09-13 09:15:24.000000000 -0500
@@ -1,5 +1,5 @@
 <form style="display: inline" method="GET" action="/translator/edit/{{ lang }}">
-<div style="float: right">
+<div style="float: right; margin-top: -5px">
 <select name="source" onchange="this.form.elements['contains'].value = ''; this.form.submit ()">
 	<option value="">- {"Limit to source file"} -</option>
 {% foreach sources %}
@@ -19,23 +19,34 @@
 <table width="100%">
 	<tr>
 		<th width="48%">{"Original text"}</th>
-		<th width="52%">{{ name }}</th>
+		<th width="52%">
+			<span style="float: right">
+				{% if empty %}
+					<a href="/translator/edit/{{ lang }}?contains={{ contains|urlencode }}">{"Show all fields"}</a>
+				{% else %}
+					<a href="/translator/edit/{{ lang }}?contains={{ contains|urlencode }}&empty=1">{"Show empty fields"}</a>
+				{% end %}
+			</span>
+			{{ name }}
+		</th>
 	</tr>
 {% foreach items %}
-	<tr id="tr-{{ loop_index|translator_field_id }}">
-		<td class="original" title="{"Source"}: {{ loop_value[src] }}">{{ loop_index }}</td>
-		<td class="translate">
-			<textarea
-				rows="1" style="float:left; width: 85%; height: 100%"
-				data-orig="{{ loop_index }}"
-				data-id="{{ loop_index|translator_field_id }}"
-				id="textarea-{{ loop_index|translator_field_id }}"
-				onblur="$.save_element (this)"
-				{% if empty ($data->loop_value[trans]) %} class="empty"{% end %}
-			>{{ loop_value[trans] }}</textarea>
-			<span id="saving-{{ loop_index|translator_field_id }}" class="notice" style="float: left; margin-left: 7px">{"Saving..."}</span>
-		</td>
-	</tr>
+	{% if empty === false || $data->loop_value['trans'] === '' %}
+		<tr id="tr-{{ loop_index|translator_field_id }}">
+			<td class="original" title="{"Source"}: {{ loop_value[src] }}">{{ loop_index }}</td>
+			<td class="translate">
+				<textarea
+					rows="1" style="float:left; width: 85%; height: 100%"
+					data-orig="{{ loop_index }}"
+					data-id="{{ loop_index|translator_field_id }}"
+					id="textarea-{{ loop_index|translator_field_id }}"
+					onblur="$.save_element (this)"
+					{% if empty ($data->loop_value[trans]) %} class="empty"{% end %}
+				>{{ loop_value[trans] }}</textarea>
+				<span id="saving-{{ loop_index|translator_field_id }}" class="notice" style="float: left; margin-left: 7px">{"Saving..."}</span>
+			</td>
+		</tr>
+	{% end %}
 {% end %}
 </table>
 </p>
diff -urBNs elefant-1.3.1-beta/apps/translator/views/edit_source.html elefant-1.3.2-beta/apps/translator/views/edit_source.html
--- elefant-1.3.1-beta/apps/translator/views/edit_source.html	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/translator/views/edit_source.html	2012-09-13 09:15:24.000000000 -0500
@@ -1,5 +1,5 @@
 <form style="display: inline" method="GET" action="/translator/edit/{{ lang }}">
-<div style="float: right">
+<div style="float: right; margin-top: -5px">
 <select name="source" onchange="this.form.elements['contains'].value = ''; this.form.submit ()">
 	<option value="">- {"Limit to source file"} -</option>
 {% foreach sources %}
@@ -19,23 +19,34 @@
 <table width="100%">
 	<tr>
 		<th width="48%">{"Original text"}</th>
-		<th width="52%">{{ name }}</th>
+		<th width="52%">
+			<span style="float: right">
+				{% if empty %}
+					<a href="/translator/edit/{{ lang }}?source={{ source|urlencode }}">{"Show all fields"}</a>
+				{% else %}
+					<a href="/translator/edit/{{ lang }}?source={{ source|urlencode }}&empty=1">{"Show empty fields"}</a>
+				{% end %}
+			</span>
+			{{ name }}
+		</th>
 	</tr>
 {% foreach items %}
-	<tr id="tr-{{ loop_index|translator_field_id }}">
-		<td class="original" title="{"Source"}: {{ loop_value[src] }}">{{ loop_index }}</td>
-		<td class="translate">
-			<textarea
-				rows="1" style="float:left; width: 85%; height: 100%"
-				data-orig="{{ loop_index }}"
-				data-id="{{ loop_index|translator_field_id }}"
-				id="textarea-{{ loop_index|translator_field_id }}"
-				onblur="$.save_element (this)"
-				{% if empty ($data->loop_value[trans]) %} class="empty"{% end %}
-			>{{ loop_value[trans] }}</textarea>
-			<span id="saving-{{ loop_index|translator_field_id }}" class="notice" style="float: left; margin-left: 7px">{"Saving..."}</span>
-		</td>
-	</tr>
+	{% if empty === false || $data->loop_value['trans'] === '' %}
+		<tr id="tr-{{ loop_index|translator_field_id }}">
+			<td class="original" title="{"Source"}: {{ loop_value[src] }}">{{ loop_index }}</td>
+			<td class="translate">
+				<textarea
+					rows="1" style="float:left; width: 85%; height: 100%"
+					data-orig="{{ loop_index }}"
+					data-id="{{ loop_index|translator_field_id }}"
+					id="textarea-{{ loop_index|translator_field_id }}"
+					onblur="$.save_element (this)"
+					{% if empty ($data->loop_value[trans]) %} class="empty"{% end %}
+				>{{ loop_value[trans] }}</textarea>
+				<span id="saving-{{ loop_index|translator_field_id }}" class="notice" style="float: left; margin-left: 7px">{"Saving..."}</span>
+			</td>
+		</tr>
+	{% end %}
 {% end %}
 </table>
 </p>
Files elefant-1.3.1-beta/apps/translator/views/index.html and elefant-1.3.2-beta/apps/translator/views/index.html are identical
diff -urBNs elefant-1.3.1-beta/apps/translator/views/settings.html elefant-1.3.2-beta/apps/translator/views/settings.html
--- elefant-1.3.1-beta/apps/translator/views/settings.html	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/translator/views/settings.html	2012-09-13 09:15:24.000000000 -0500
@@ -1,16 +1,48 @@
+{! admin/util/dates !}
+
 <form method="post" id="{{ _form }}">
 
 <p class="notice" id="dupe-notice">{"The language code entered already exists."}</p>
 
+<div class="date-reference">
+<p><strong>{"Date formatting reference"}:</strong></p>
+
+<code><pre>
+<span class="cd">yy     </span><span class="ex">12         </span><span class="su">{"Year in two digit form"}</span>
+<span class="cd">yyyy   </span><span class="ex">2012       </span><span class="su">{"Year in full"}</span>
+<span class="cd">m      </span><span class="ex">9          </span><span class="su">{"Month in numeric form"}</span>
+<span class="cd">mm     </span><span class="ex">09         </span><span class="su">{"Month in numeric form, zero-padded"}</span>
+<span class="cd">mmm    </span><span class="ex">Sep        </span><span class="su">{"Month name, abbreviated"}</span>
+<span class="cd">mmmm   </span><span class="ex">September  </span><span class="su">{"Month name"}</span>
+<span class="cd">d      </span><span class="ex">3          </span><span class="su">{"Date"}</span>
+<span class="cd">dd     </span><span class="ex">03         </span><span class="su">{"Date, zero-padded"}</span>
+<span class="cd">ddd    </span><span class="ex">Mon        </span><span class="su">{"Day of the week, abbreviated"}</span>
+<span class="cd">dddd   </span><span class="ex">Monday     </span><span class="su">{"Day of the week"}</span>
+<span class="cd">o      </span><span class="ex">1st        </span><span class="su">{"Date in ordinal form"}</span>
+<span class="cd">h      </span><span class="ex">6          </span><span class="su">{"Hours in 12-hour time"}</span>
+<span class="cd">hh     </span><span class="ex">06         </span><span class="su">{"Hours in 12-hour time, zero-padded"}</span>
+<span class="cd">H      </span><span class="ex">18         </span><span class="su">{"Hours in 24-hour time"}</span>
+<span class="cd">HH     </span><span class="ex">06         </span><span class="su">{"Hours in 24-hour time, zero-padded"}</span>
+<span class="cd">M      </span><span class="ex">4          </span><span class="su">{"Minutes"}</span>
+<span class="cd">MM     </span><span class="ex">04         </span><span class="su">{"Minutes, zero-padded"}</span>
+<span class="cd">s      </span><span class="ex">7          </span><span class="su">{"Seconds"}</span>
+<span class="cd">ss     </span><span class="ex">07         </span><span class="su">{"Seconds, zero-padded"}</span>
+<span class="cd">S      </span><span class="ex">7.000      </span><span class="su">{"Seconds with milliseconds"}</span>
+<span class="cd">SS     </span><span class="ex">07.000     </span><span class="su">{"Seconds, zero-padded, with milliseconds"}</span>
+<span class="cd">a      </span><span class="ex">AM         </span><span class="su">{"Period"}</span>
+<span class="cd">Z      </span><span class="ex">+02:00     </span><span class="su">{"Time zone offset"}</span>
+</pre></code>
+</div>
+
 <p>{"Language"}:<br />
 <input type="text" size="30" name="name" value="{{ name|quotes }}" />
 <span class="notice" id="name-notice">{"Please enter the name of the language."}</span></p>
 
-<p>{"Language code"} (ex: `en`, `fr`, `es`):<br />
+<p>{"Language code"} (ex: <a href="http://en.wikipedia.org/wiki/List_of_ISO_639-1_codes" target="_blank">en, fr, es</a>):<br />
 <input type="text" size="15" name="code" value="{{ code|quotes }}" />
 <span class="notice" id="code-notice">{"Please enter the language code."}</span></p>
 
-<p>{"Locale"} ({"optional"}, ex: `us`, `ca`, 'gb`):<br />
+<p>{"Locale"} ({"optional"}, ex: <a href="http://en.wikipedia.org/wiki/ISO_3166-1" target="_blank">us, ca, gb</a>):<br />
 <input type="text" size="15" name="locale" value="{{ locale|quotes }}" /></p>
 
 <p>{"Character set"}:<br />
@@ -28,6 +60,21 @@
 </select>
 </p>
 
+<p>{"Local date format"}:<br />
+<input type="text" name="date_format" id="date-format" value="{{ date_format|quotes }}" />
+<span class="ex"><time class="date-preview" datetime="{{date ('Y')}}-09-21T16:32:47+00:00"></time></span>
+</p>
+
+<p>{"Short date format"}:<br />
+<input type="text" name="short_format" id="short-format" value="{{ short_format|quotes }}" />
+<span class="ex"><time class="short-preview" datetime="{{date ('Y')}}-09-21T16:32:47+00:00"></time></span>
+</p>
+
+<p>{"Local time format"}:<br />
+<input type="text" name="time_format" id="time-format" value="{{ time_format|quotes }}" />
+<span class="ex"><time class="time-preview" datetime="{{date ('Y')}}-09-21T22:32:47+00:00"></time></span>
+</p>
+
 <p>
 	<input type="submit" value="{"Save"}" />
 	&nbsp;
@@ -35,3 +82,46 @@
 </p>
 
 </form>
+
+<style>
+.date-reference {
+	float: right;
+	border: 1px solid #ddd;
+	background: #fff;
+	padding: 5px 7px 0px 7px;
+	-webkit-border-radius: 3px;
+	-moz-border-radius: 3px;
+	border-radius: 3px;
+}
+.cd { color: teal; }
+.ex { font-style: italic; color: #777; }
+.su { color: #b84; }
+</style>
+
+<script>
+$(function () {
+	function dates_preview (field, id, default_value) {
+		if (field.value === '') {
+			$('time.' + id).localize (default_value);
+		} else {
+			$('time.' + id).localize (field.value);
+		}
+	}
+
+	dates_preview ($('#date-format')[0], 'date-preview', 'mmmm d, yyyy');
+	dates_preview ($('#short-format')[0], 'short-preview', 'mmm d');
+	dates_preview ($('#time-format')[0], 'time-preview', 'h:MMa');
+
+	$('#date-format').keyup (function () {
+		dates_preview (this, 'date-preview', 'mmmm d, yyyy');
+	});
+
+	$('#short-format').keyup (function () {
+		dates_preview (this, 'short-preview', 'mmm d');
+	});
+
+	$('#time-format').keyup (function () {
+		dates_preview (this, 'time-preview', 'h:MMa');
+	});
+});
+</script>
Files elefant-1.3.1-beta/apps/user/conf/config.php and elefant-1.3.2-beta/apps/user/conf/config.php are identical
Files elefant-1.3.1-beta/apps/user/conf/embed.php and elefant-1.3.2-beta/apps/user/conf/embed.php are identical
Files elefant-1.3.1-beta/apps/user/forms/add.php and elefant-1.3.2-beta/apps/user/forms/add.php are identical
Files elefant-1.3.1-beta/apps/user/forms/edit.php and elefant-1.3.2-beta/apps/user/forms/edit.php are identical
Files elefant-1.3.1-beta/apps/user/forms/login/newuser.php and elefant-1.3.2-beta/apps/user/forms/login/newuser.php are identical
Files elefant-1.3.1-beta/apps/user/forms/newpass.php and elefant-1.3.2-beta/apps/user/forms/newpass.php are identical
Files elefant-1.3.1-beta/apps/user/forms/recover.php and elefant-1.3.2-beta/apps/user/forms/recover.php are identical
Files elefant-1.3.1-beta/apps/user/forms/signup.php and elefant-1.3.2-beta/apps/user/forms/signup.php are identical
Files elefant-1.3.1-beta/apps/user/forms/update.php and elefant-1.3.2-beta/apps/user/forms/update.php are identical
Files elefant-1.3.1-beta/apps/user/handlers/add.php and elefant-1.3.2-beta/apps/user/handlers/add.php are identical
diff -urBNs elefant-1.3.1-beta/apps/user/handlers/admin.php elefant-1.3.2-beta/apps/user/handlers/admin.php
--- elefant-1.3.1-beta/apps/user/handlers/admin.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/user/handlers/admin.php	2012-09-13 09:15:24.000000000 -0500
@@ -6,26 +6,24 @@
 
 $page->layout = 'admin';
 
-if (! User::require_admin ()) {
-	$this->redirect ('/admin');
-}
+$this->require_admin ();
 
 $limit = 20;
-$_GET['offset'] = (isset ($_GET['offset'])) ? $_GET['offset'] : 0;
+$num = isset ($_GET['offset']) ? $_GET['offset'] : 1;
+$offset = ($num - 1) * $limit;
 
 $users = User::query ('id, name, email, type')
 	->order ('name asc')
-	->fetch_orig ($limit, $_GET['offset']);
+	->fetch_orig ($limit, $offset);
 $count = User::query ()->count ();
 
 $page->title = i18n_get ('Users');
 echo $tpl->render ('user/admin', array (
+	'limit' => $limit,
+	'total' => $count,
 	'users' => $users,
-	'count' => $count,
-	'offset' => $_GET['offset'],
-	'more' => ($count > $_GET['offset'] + $limit) ? true : false,
-	'prev' => $_GET['offset'] - $limit,
-	'next' => $_GET['offset'] + $limit
+	'count' => count ($users),
+	'url' => '/user/admin?offset=%d'
 ));
 
 ?>
\ No newline at end of file
Files elefant-1.3.1-beta/apps/user/handlers/delete.php and elefant-1.3.2-beta/apps/user/handlers/delete.php are identical
diff -urBNs elefant-1.3.1-beta/apps/user/handlers/edit.php elefant-1.3.2-beta/apps/user/handlers/edit.php
--- elefant-1.3.1-beta/apps/user/handlers/edit.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/user/handlers/edit.php	2012-09-13 09:15:24.000000000 -0500
@@ -17,6 +17,7 @@
 if ($f->submit ()) {
 	$u->name = $_POST['name'];
 	$u->email = $_POST['email'];
+	$u->type = $_POST['type'];
 	if (! empty ($_POST['password'])) {
 		$u->password = User::encrypt_pass ($_POST['password']);
 	}
Files elefant-1.3.1-beta/apps/user/handlers/index.php and elefant-1.3.2-beta/apps/user/handlers/index.php are identical
Files elefant-1.3.1-beta/apps/user/handlers/login/facebook.php and elefant-1.3.2-beta/apps/user/handlers/login/facebook.php are identical
Files elefant-1.3.1-beta/apps/user/handlers/login/google.php and elefant-1.3.2-beta/apps/user/handlers/login/google.php are identical
Files elefant-1.3.1-beta/apps/user/handlers/login/newuser.php and elefant-1.3.2-beta/apps/user/handlers/login/newuser.php are identical
Files elefant-1.3.1-beta/apps/user/handlers/login/openid.php and elefant-1.3.2-beta/apps/user/handlers/login/openid.php are identical
Files elefant-1.3.1-beta/apps/user/handlers/login/twitter.php and elefant-1.3.2-beta/apps/user/handlers/login/twitter.php are identical
diff -urBNs elefant-1.3.1-beta/apps/user/handlers/login.php elefant-1.3.2-beta/apps/user/handlers/login.php
--- elefant-1.3.1-beta/apps/user/handlers/login.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/user/handlers/login.php	2012-09-13 09:15:24.000000000 -0500
@@ -29,7 +29,7 @@
 	}
 }
 
-if (! Form::verify_value ($_POST['redirect'], 'header')) {
+if (! Validator::validate ($_POST['redirect'], 'header')) {
 	$_POST['redirect'] = '/user';
 }
 
diff -urBNs elefant-1.3.1-beta/apps/user/handlers/logout.php elefant-1.3.2-beta/apps/user/handlers/logout.php
--- elefant-1.3.1-beta/apps/user/handlers/logout.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/user/handlers/logout.php	2012-09-13 09:15:24.000000000 -0500
@@ -18,6 +18,10 @@
 	$_GET['redirect'] = $appconf['User']['logout_redirect'];
 }
 
+if (! Validator::validate ($_GET['redirect'], 'header')) {
+	$_GET['redirect'] = '/';
+}
+
 Lock::clear ();
 echo User::logout ($_GET['redirect']);
 
Files elefant-1.3.1-beta/apps/user/handlers/newpass.php and elefant-1.3.2-beta/apps/user/handlers/newpass.php are identical
Files elefant-1.3.1-beta/apps/user/handlers/recover.php and elefant-1.3.2-beta/apps/user/handlers/recover.php are identical
Files elefant-1.3.1-beta/apps/user/handlers/sidebar.php and elefant-1.3.2-beta/apps/user/handlers/sidebar.php are identical
Files elefant-1.3.1-beta/apps/user/handlers/signup.php and elefant-1.3.2-beta/apps/user/handlers/signup.php are identical
Files elefant-1.3.1-beta/apps/user/handlers/too-many-attempts.php and elefant-1.3.2-beta/apps/user/handlers/too-many-attempts.php are identical
Files elefant-1.3.1-beta/apps/user/handlers/update.php and elefant-1.3.2-beta/apps/user/handlers/update.php are identical
Files elefant-1.3.1-beta/apps/user/handlers/upgrade.php and elefant-1.3.2-beta/apps/user/handlers/upgrade.php are identical
Files elefant-1.3.1-beta/apps/user/handlers/verify.php and elefant-1.3.2-beta/apps/user/handlers/verify.php are identical
Files elefant-1.3.1-beta/apps/user/lib/Auth/Basic.php and elefant-1.3.2-beta/apps/user/lib/Auth/Basic.php are identical
diff -urBNs elefant-1.3.1-beta/apps/user/lib/Auth/HMAC.php elefant-1.3.2-beta/apps/user/lib/Auth/HMAC.php
--- elefant-1.3.1-beta/apps/user/lib/Auth/HMAC.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/user/lib/Auth/HMAC.php	2012-09-13 09:15:24.000000000 -0500
@@ -4,17 +4,17 @@
  * Elefant CMS - http://www.elefantcms.com/
  *
  * Copyright (c) 2011 Johnny Broadway
- * 
+ *
  * Permission is hereby granted, free of charge, to any person obtaining a copy
  * of this software and associated documentation files (the "Software"), to deal
  * in the Software without restriction, including without limitation the rights
  * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  * copies of the Software, and to permit persons to whom the Software is
  * furnished to do so, subject to the following conditions:
- * 
+ *
  * The above copyright notice and this permission notice shall be included in
  * all copies or substantial portions of the Software.
- * 
+ *
  * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
@@ -33,28 +33,28 @@
  * Usage:
  *
  *   <?php
- *   
+ *
  *   $this->require_auth (user\Auth\HMAC::init (
  *     $this,     // Controller
- *     $memcache, // Memcache
+ *     $cache, // Memcache
  *     3600       // Timeout
  *   ));
- *   
+ *
  *   // User has been authorized via HMAC
  *   $this->restful (new MyRestfulClass ());
- *   
+ *
  *   ?>
  */
 class HMAC {
 	/**
 	 * A copy of the controller object required by `init()`.
 	 */
-	public static $controller = null;
+	public static $controller = NULL;
 
 	/**
-	 * A copy of the memcache object required by `init()`.
+	 * A copy of the cache object required by `init()`.
 	 */
-	public static $memcache = null;
+	public static $cache = NULL;
 
 	/**
 	 * A timeout length for caching private API keys, set vai `init()`.
@@ -66,9 +66,9 @@
 	 * Returns an array with the verifier and request method callbacks
 	 * that will be passed to `simple_auth()`.
 	 */
-	public static function init ($controller, $memcache, $timeout = 3600) {
+	public static function init ($controller, $cache, $timeout = 3600) {
 		self::$controller = $controller;
-		self::$memcache = $memcache;
+		self::$cache = $cache;
 		self::$timeout = $timeout;
 
 		return array (
@@ -82,31 +82,31 @@
 	 * Tokens and secret keys are stored in the `api` table.
 	 */
 	public static function verifier ($token, $hmac, $data) {
-		$api_key = self::$memcache->get ('_api_key_' . $token);
+		$api_key = self::$cache->get ('_api_key_' . $token);
 
 		if (! $api_key) {
 			// API key not yet cached
 			$api = new \Api ($token);
 			if ($api->error) {
-				return false;
+				return FALSE;
 			}
 			$api_key = $api->api_key;
 
 			// Cache the API key
-			$res = self::$memcache->replace ('_api_key_' . $token, $api_key, 0, self::$timeout);
-			if ($res === false) {
-				self::$memcache->set ('_api_key_' . $token, $api_key, 0, self::$timeout);
+			$res = self::$cache->replace ('_api_key_' . $token, $api_key, 0, self::$timeout);
+			if ($res === FALSE) {
+				self::$cache->set ('_api_key_' . $token, $api_key, 0, self::$timeout);
 			}
 		}
 
 		// Compare our hash calculation with the one given
 		if (hash_hmac ('sha256', $data, $api_key) !== $hmac) {
-			return false;
+			return FALSE;
 		}
 
 		// They have the private key, create the user
 		$user = new \User ($api->user_id);
-		return true;
+		return TRUE;
 	}
 
 	/**
@@ -148,8 +148,8 @@
 			exit;
 		}
 
-		return true;
+		return TRUE;
 	}
 }
 
-?>
\ No newline at end of file
+?>
Files elefant-1.3.1-beta/apps/user/lib/LightOpenID.php and elefant-1.3.2-beta/apps/user/lib/LightOpenID.php are identical
Files elefant-1.3.1-beta/apps/user/lib/tmhOAuth.php and elefant-1.3.2-beta/apps/user/lib/tmhOAuth.php are identical
Files elefant-1.3.1-beta/apps/user/lib/tmhUtilities.php and elefant-1.3.2-beta/apps/user/lib/tmhUtilities.php are identical
diff -urBNs elefant-1.3.1-beta/apps/user/models/User.php elefant-1.3.2-beta/apps/user/models/User.php
--- elefant-1.3.1-beta/apps/user/models/User.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/user/models/User.php	2012-09-13 09:15:24.000000000 -0500
@@ -4,17 +4,17 @@
  * Elefant CMS - http://www.elefantcms.com/
  *
  * Copyright (c) 2011 Johnny Broadway
- * 
+ *
  * Permission is hereby granted, free of charge, to any person obtaining a copy
  * of this software and associated documentation files (the "Software"), to deal
  * in the Software without restriction, including without limitation the rights
  * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  * copies of the Software, and to permit persons to whom the Software is
  * furnished to do so, subject to the following conditions:
- * 
+ *
  * The above copyright notice and this permission notice shall be included in
  * all copies or substantial portions of the Software.
- * 
+ *
  * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
@@ -31,8 +31,9 @@
  * the first call to any validation method will initialize the `$user`
  * property to contain the static User object.
  *
- * Note that this class extends Model, so all of the Model methods are
- * available for querying the user list, and for user management, as well.
+ * Note that this class extends [[ExtendedModel]], so all of the [[ExtendedModel]]
+ * and [[Model]] methods are available for querying the user list, and for user
+ * management, as well.
  *
  * Fields:
  *
@@ -49,38 +50,42 @@
  *
  * Basic usage of additional methods:
  *
- *   // Send unauth users to myapp/login view
- *   if (! User::require_login ()) {
- *     $page->title = i18n_get ('Members');
- *     echo $this->run ('user/login');
- *     return;
- *   }
- *
- *   // Check if a user is valid at any point
- *   if (! User::is_valid ()) {
- *     // Not allowed
- *   }
- *
- *   // Check the user's type
- *   if (User::is ('member')) {
- *     // Access granted
- *   }
- *
- *   // Get the name value
- *   $name = User::val ('name');
- *
- *   // Get the actual user object
- *   info (User::$user);
- *
- *   // Update and save a user's name
- *   User::val ('name', 'Bob Diggity');
- *   User::save ();
+ *     <?php
+ *
+ *     // Send unauth users to myapp/login view
+ *     if (! User::require_login ()) {
+ *         $page->title = i18n_get ('Members');
+ *         echo $this->run ('user/login');
+ *         return;
+ *     }
+ *
+ *     // Check if a user is valid at any point
+ *     if (! User::is_valid ()) {
+ *         // Not allowed
+ *     }
+ *
+ *     // Check the user's type
+ *     if (User::is ('member')) {
+ *         // Access granted
+ *     }
+ *
+ *     // Get the name value
+ *     $name = User::val ('name');
+ *
+ *     // Get the actual user object
+ *     info (User::$user);
+ *
+ *     // Update and save a user's name
+ *     User::val ('name', 'Bob Diggity');
+ *     User::save ();
+ *
+ *     // Encrypt a password
+ *     $encrypted = User::encrypt_pass ($password);
  *
- *   // Encrypt a password
- *   $encrypted = User::encrypt_pass ($password);
+ *     // Log out and send them home
+ *     User::logout ('/');
  *
- *   // Log out and send them home
- *   User::logout ('/');
+ *     ?>
  */
 class User extends ExtendedModel {
 	/**
@@ -91,12 +96,12 @@
 	/**
 	 * This is the static User object for the current user.
 	 */
-	public static $user = false;
+	public static $user = FALSE;
 
 	/**
 	 * Access control list for `access()` method.
 	 */
-	public static $acl = false;
+	public static $acl = FALSE;
 
 	/**
 	 * Generates a random salt and encrypts a password using MD5.
@@ -131,19 +136,20 @@
 		);
 
 		// Check if they've exceeded their login attempt limit
-		global $memcache, $controller;
-		$appconf = parse_ini_file ('apps/user/conf/config.php', true);
-		$attempts = $memcache->get ('_user_login_attempts_' . session_id ());
+		global $cache, $controller;
+		$appconf = parse_ini_file ('apps/user/conf/config.php', TRUE);
+		$attempts = $cache->get ('_user_login_attempts_' . session_id ());
 		if (! $attempts) {
 			$attempts = 0;
 		}
 		if ($attempts > $appconf['User']['login_attempt_limit']) {
-			$called[$user] = false;
+			$called[$user] = FALSE;
 			$controller->redirect ('/user/too-many-attempts');
 		}
 
 		if ($u && crypt ($pass, $u->password) == $u->password) {
-			self::$user = new User ((array) $u, false);
+			$class = get_called_class ();
+			self::$user = new $class ((array) $u, FALSE);
 			self::$user->session_id = md5 (uniqid (mt_rand (), 1));
 			self::$user->expires = gmdate ('Y-m-d H:i:s', time () + 2592000); // 1 month
 			$try = 0;
@@ -151,34 +157,34 @@
 				self::$user->session_id = md5 (uniqid (mt_rand (), 1));
 				$try++;
 				if ($try == 5) {
-					$called[$user] = false;
-					return false;
+					$called[$user] = FALSE;
+					return FALSE;
 				}
 			}
 			$_SESSION['session_id'] = self::$user->session_id;
 
 			// Save the user agent so we can verify it against future sessions,
 			// and remove the login attempts cache item
-			$memcache->add ('_user_session_agent_' . $_SESSION['session_id'], $_SERVER['HTTP_USER_AGENT'], 0, time () + 2592000);
-			$memcache->delete ('_user_login_attempts_' . session_id ());
+			$cache->add ('_user_session_agent_' . $_SESSION['session_id'], $_SERVER['HTTP_USER_AGENT'], 0, time () + 2592000);
+			$cache->delete ('_user_login_attempts_' . session_id ());
 
-			$called[$user] = true;
-			return true;
+			$called[$user] = TRUE;
+			return TRUE;
 		}
 
 		// Increment the number of attempts they've made
 		$attempts++;
-		if (! $memcache->add ('_user_login_attempts_' . session_id (), $attempts, 0, $appconf['User']['block_attempts_for'])) {
-			$memcache->replace ('_user_login_attempts_' . session_id (), $attempts, 0, $appconf['User']['block_attempts_for']);
+		if (! $cache->add ('_user_login_attempts_' . session_id (), $attempts, 0, $appconf['User']['block_attempts_for'])) {
+			$cache->replace ('_user_login_attempts_' . session_id (), $attempts, 0, $appconf['User']['block_attempts_for']);
 		}
 
-		$called[$user] = false;
-		return false;
+		$called[$user] = FALSE;
+		return FALSE;
 	}
 
 	/**
-	 * A custom handler for simple_auth(). Note: Calls session_start()
-	 * for you, and creates the global $user object if a session is
+	 * A custom handler for `simple_auth()`. Note: Calls `session_start()`
+	 * for you, and creates the global `$user` object if a session is
 	 * valid, since we have the data already.
 	 */
 	public static function method ($callback) {
@@ -196,52 +202,63 @@
 			);
 			if ($u) {
 				// Verify user agent as a last step (make hijacking harder)
-				global $memcache;
-				$ua = $memcache->get ('_user_session_agent_' . $_SESSION['session_id']);
+				global $cache;
+				$ua = $cache->get ('_user_session_agent_' . $_SESSION['session_id']);
 				if ($ua && $ua !== $_SERVER['HTTP_USER_AGENT']) {
-					return false;
+					return FALSE;
 				}
 
-				self::$user = new User ((array) $u, false);
-				return true;
+				$class = get_called_class ();
+				self::$user = new $class ((array) $u, FALSE);
+				return TRUE;
 			}
 		}
-		return false;
+		return FALSE;
 	}
 
 	/**
 	 * Simplifies authorization down to:
 	 *
-	 *   if (! User::require_login ()) {
-	 *     // unauthorized
-	 *   }
+	 *     <?php
+	 *
+	 *     if (! User::require_login ()) {
+	 *         // unauthorized
+	 *     }
+	 *
+	 *     ?>
 	 */
 	public static function require_login () {
-		return simple_auth (array ('User', 'verifier'), array ('User', 'method'));
+		$class = get_called_class ();
+		return simple_auth (array ($class, 'verifier'), array ($class, 'method'));
 	}
 
 	/**
 	 * Simplifies authorization for admins down to:
 	 *
-	 *   if (! User::require_admin ()) {
-	 *     // unauthorized
-	 *   }
+	 *     <?php
+	 *
+	 *     if (! User::require_admin ()) {
+	 *         // unauthorized
+	 *     }
+	 *
+	 *     ?>
 	 */
 	public static function require_admin () {
 		if (is_object (self::$user)) {
 			if (self::$user->session_id == $_SESSION['session_id']) {
 				if (self::$user->type == 'admin') {
-					return true;
+					return TRUE;
 				}
-				return false;
+				return FALSE;
 			}
 		} else {
-			$res = simple_auth (array ('User', 'verifier'), array ('User', 'method'));
+			$class = get_called_class ();
+			$res = simple_auth (array ($class, 'verifier'), array ($class, 'method'));
 			if ($res && self::$user->type == 'admin') {
-				return true;
+				return TRUE;
 			}
 		}
-		return false;
+		return FALSE;
 	}
 
 	/**
@@ -249,9 +266,9 @@
 	 */
 	public static function is_valid () {
 		if (is_object (self::$user) && self::$user->session_id == $_SESSION['session_id']) {
-			return true;
+			return TRUE;
 		}
-		return User::require_login ();
+		return self::require_login ();
 	}
 
 	/**
@@ -265,9 +282,11 @@
 	 * Loads the access control list for the `access()` method.
 	 */
 	private static function load_acl () {
-		if (self::$acl === false) {
-			$appconf = parse_ini_file ('apps/user/conf/config.php', true);
+		if (self::$acl === FALSE) {
+			$appconf = parse_ini_file ('apps/user/conf/config.php', TRUE);
 			self::$acl = $appconf['Access'];
+			// make the default access levels translatable
+			i18n_get ('Public'); i18n_get ('Member'); i18n_get ('Private');
 		}
 	}
 
@@ -279,19 +298,19 @@
 		self::load_acl ();
 
 		if (! isset (self::$acl[$access])) {
-			return false;
+			return FALSE;
 		}
 
 		if (self::$acl[$access] === 'all') {
-			return true;
+			return TRUE;
 		}
 
-		if (self::$acl[$access] === 'login' && User::is_valid ()) {
-			return true;
+		if (self::$acl[$access] === 'login' && self::is_valid ()) {
+			return TRUE;
 		}
 
-		if (self::$acl[$access] === 'admin' && User::is ('admin')) {
-			return true;
+		if (self::$acl[$access] === 'admin' && self::is ('admin')) {
+			return TRUE;
 		}
 
 		if (strpos (self::$acl[$access], 'type:') === 0) {
@@ -300,11 +319,11 @@
 			$type = self::$acl[$access];
 		}
 
-		if (User::is ($type)) {
-			return true;
+		if (self::is ($type)) {
+			return TRUE;
 		}
 
-		return false;
+		return FALSE;
 	}
 
 	/**
@@ -318,8 +337,8 @@
 	/**
 	 * Get or set a specific field's value.
 	 */
-	public static function val ($key, $val = null) {
-		if ($val !== null) {
+	public static function val ($key, $val = NULL) {
+		if ($val !== NULL) {
 			self::$user->{$key} = $val;
 		}
 		return self::$user->{$key};
@@ -335,15 +354,15 @@
 	/**
 	 * Log out and optionally redirect to the specified URL.
 	 */
-	public static function logout ($redirect_to = false) {
-		if (self::$user === false) {
-			User::require_login ();
+	public static function logout ($redirect_to = FALSE) {
+		if (self::$user === FALSE) {
+			self::require_login ();
 		}
 		if (! empty (self::$user->session_id)) {
 			self::$user->expires = gmdate ('Y-m-d H:i:s', time () - 100000);
 			self::$user->put ();
 		}
-		$_SESSION['session_id'] = null;
+		$_SESSION['session_id'] = NULL;
 		if ($redirect_to) {
 			global $controller;
 			$controller->redirect ($redirect_to);
@@ -351,4 +370,4 @@
 	}
 }
 
-?>
\ No newline at end of file
+?>
Files elefant-1.3.1-beta/apps/user/models/User_OpenID.php and elefant-1.3.2-beta/apps/user/models/User_OpenID.php are identical
Files elefant-1.3.1-beta/apps/user/pix/facebook.png and elefant-1.3.2-beta/apps/user/pix/facebook.png are identical
Files elefant-1.3.1-beta/apps/user/pix/google.png and elefant-1.3.2-beta/apps/user/pix/google.png are identical
Files elefant-1.3.1-beta/apps/user/pix/openid.png and elefant-1.3.2-beta/apps/user/pix/openid.png are identical
Files elefant-1.3.1-beta/apps/user/pix/twitter.png and elefant-1.3.2-beta/apps/user/pix/twitter.png are identical
Files elefant-1.3.1-beta/apps/user/views/add.html and elefant-1.3.2-beta/apps/user/views/add.html are identical
diff -urBNs elefant-1.3.1-beta/apps/user/views/admin.html elefant-1.3.2-beta/apps/user/views/admin.html
--- elefant-1.3.1-beta/apps/user/views/admin.html	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/apps/user/views/admin.html	2012-09-13 09:15:24.000000000 -0500
@@ -1,7 +1,13 @@
 <p><a href="/user/add">{"Add User"}</a></p>
 
-{% if offset > 0 %}
-<p class="previous"><a href="/user/admin?offset={{ prev }}">&laquo; {"Previous"}</a></p>
+<p style="float: left">
+{! navigation/pager?style=results&url=[url]&total=[total]&count=[count]&limit=[limit] !}
+</p>
+
+{% if total > $data->limit %}
+<div style="float: right">
+{! navigation/pager?style=numbers&url=[url]&total=[total]&count=[count]&limit=[limit] !}
+</div>
 {% end %}
 
 <p>
@@ -23,6 +29,6 @@
 </table>
 </p>
 
-{% if more %}
-<p class="next"><a href="/user/admin?offset={{ next }}">{"Next"} &raquo;</a></p>
+{% if total > $data->limit %}
+{! navigation/pager?style=numbers&url=[url]&total=[total]&count=[count]&limit=[limit] !}
 {% end %}
Files elefant-1.3.1-beta/apps/user/views/edit.html and elefant-1.3.2-beta/apps/user/views/edit.html are identical
Files elefant-1.3.1-beta/apps/user/views/email/recover.html and elefant-1.3.2-beta/apps/user/views/email/recover.html are identical
Files elefant-1.3.1-beta/apps/user/views/email/verification.html and elefant-1.3.2-beta/apps/user/views/email/verification.html are identical
Files elefant-1.3.1-beta/apps/user/views/index.html and elefant-1.3.2-beta/apps/user/views/index.html are identical
Files elefant-1.3.1-beta/apps/user/views/login/newuser.html and elefant-1.3.2-beta/apps/user/views/login/newuser.html are identical
Files elefant-1.3.1-beta/apps/user/views/login/openid.html and elefant-1.3.2-beta/apps/user/views/login/openid.html are identical
Files elefant-1.3.1-beta/apps/user/views/login.html and elefant-1.3.2-beta/apps/user/views/login.html are identical
Files elefant-1.3.1-beta/apps/user/views/newpass.html and elefant-1.3.2-beta/apps/user/views/newpass.html are identical
Files elefant-1.3.1-beta/apps/user/views/recover.html and elefant-1.3.2-beta/apps/user/views/recover.html are identical
Files elefant-1.3.1-beta/apps/user/views/sidebar.html and elefant-1.3.2-beta/apps/user/views/sidebar.html are identical
Files elefant-1.3.1-beta/apps/user/views/signup.html and elefant-1.3.2-beta/apps/user/views/signup.html are identical
Files elefant-1.3.1-beta/apps/user/views/update.html and elefant-1.3.2-beta/apps/user/views/update.html are identical
Files elefant-1.3.1-beta/cache/.htaccess and elefant-1.3.2-beta/cache/.htaccess are identical
Files elefant-1.3.1-beta/conf/.htaccess and elefant-1.3.2-beta/conf/.htaccess are identical
diff -urBNs elefant-1.3.1-beta/conf/config.php elefant-1.3.2-beta/conf/config.php
--- elefant-1.3.1-beta/conf/config.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/conf/config.php	2012-09-13 09:15:24.000000000 -0500
@@ -85,8 +85,8 @@
 
 [Cache]
 
-; Configure your memcache server list. This will be available in
-; your handlers via the $memcache object. If blank, or memcache
+; Configure your cache server list. This will be available in
+; your handlers via the $cache object. If blank, or cache
 ; is unavailable, it will emulate Memcache via the lib/Cache
 ; object, storing the cache in the `conf/datastore` folder.
 ; Alternately add `backend = redis` to use Redis as the cache
@@ -141,4 +141,4 @@
 ;transport[type] = file
 ;transport[folder] = cache/mailer
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-1.3.1-beta/conf/elefant elefant-1.3.2-beta/conf/elefant
--- elefant-1.3.1-beta/conf/elefant	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/conf/elefant	1969-12-31 18:00:00.000000000 -0600
@@ -1,412 +0,0 @@
-#!/usr/bin/env php
-<?php
-
-/**
- * Elefant CMS - http://www.elefantcms.com/
- *
- * Copyright (c) 2011 Johnny Broadway
- * 
- * Permission is hereby granted, free of charge, to any person obtaining a copy
- * of this software and associated documentation files (the "Software"), to deal
- * in the Software without restriction, including without limitation the rights
- * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
- * copies of the Software, and to permit persons to whom the Software is
- * furnished to do so, subject to the following conditions:
- * 
- * The above copyright notice and this permission notice shall be included in
- * all copies or substantial portions of the Software.
- * 
- * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
- * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
- * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
- * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
- * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
- * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
- * THE SOFTWARE.
- */
-
-/**
- * This is the Elefant command line utility. It can run the Elefant
- * install routines, create the scaffolding for new apps or the index
- * for new translation files, or encrypt a password for you.
- *
- * Usage:
- *
- *     $ cd /path/to/my/site
- *     $ elefant COMMAND
- */
-
-ini_set ('error_reporting', 247);
-
-$help = <<<HELP
-
-== Elefant framework command line utility ==
-
-Usage:
-
-  $ cd /path/to/my/site
-  $ elefant COMMAND
-
-Commands:
-
-  install                          Run the command line installer
-  backup <path>                    Save a backup of the site and db
-  export-db <file>                 Export the db to a file or STDOUT
-  build-app <appname>              Build the scaffolding for an app
-  generate-password <length(8)>    Generate a random password
-  encrypt-password <password>      Encrypt a password for the db
-
-
-HELP;
-
-if (! @file_exists ('conf/config.php')) {
-	echo "** Error: Must be run from the root of an Elefant website.\n";
-	die;
-}
-
-/**
- * Takes a plain text password and return the encrypted version.
- */
-function encrypt_password ($plain) {
-	$base = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
-	$salt = '$2a$07$';
-	for ($i = 0; $i < 22; $i++) {
-		$salt .= $base[rand (0, 61)];
-	}
-	return crypt ($plain, $salt . '$');
-}
-
-/**
- * Takes a length and returns a random string of characters of that
- * length for use in passwords. String may contain any number, lower
- * or uppercase letters, or common symbols.
- */
-function generate_password ($length) {
-	$list = '123467890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_-+=~:;|<>[]{}?"\'';
-	$pass = '';
-	while (strlen ($pass) < $length) {
-		$pass .= substr ($list, mt_rand (0, strlen ($list)), 1);
-	}
-	return $pass;
-}
-
-if (count ($argv) > 1) {
-	switch ($argv[1]) {
-
-
-
-		/**
-		 * This is the command line install routine.
-		 * Its job is to create the database schema
-		 * based on the settings in conf/config.php,
-		 * and to create an initial admin user account.
-		 * It will output the password generated for
-		 * that account at the end, and mark itself
-		 * as done so as to prevent it or the web
-		 * installer from being run a second time.
-		 */
-		case 'install':
-			if (@file_exists ('conf/installed')) {
-				echo "** Error: Installer has already been run.\n";
-				die;
-			}
-			
-			require_once ('lib/Functions.php');
-			require_once ('lib/Form.php');
-			require_once ('lib/DB.php');
-			require_once ('lib/Model.php');
-			require_once ('lib/ExtendedModel.php');
-			require_once ('apps/admin/models/Webpage.php');
-			require_once ('apps/admin/models/Versions.php');
-			require_once ('apps/user/models/User.php');
-			require_once ('apps/blocks/models/Block.php');
-			
-			$conf = parse_ini_file ('conf/config.php', true);
-			date_default_timezone_set ($conf['General']['timezone']);
-			
-			// set the necessary folder permissions
-			system ('chmod -R 777 cache conf css files lang layouts');
-			system ('chmod 777 apps');
-			
-			// connect to the database
-			$connected = false;
-			foreach (array_keys ($conf['Database']) as $key) {
-				if ($key == 'master') {
-					$conf['Database'][$key]['master'] = true;
-					if (! DB::open ($conf['Database'][$key])) {
-						echo "** Error: Could not connect to the database. Please check the\n";
-						echo "          settings in conf/config.php and try again.\n";
-						echo "\n";
-						echo "          " . DB::error () . "\n";
-						die;
-					}
-					$connected = true;
-					break;
-				}
-			}
-			if (! $connected) {
-				echo "** Error: Could not find a master database. Please check the\n";
-				echo "          settings in conf/config.php and try again.\n";
-				die;
-			}
-			
-			// import the database schema
-			$sqldata = sql_split (file_get_contents ('conf/install_' . $conf['Database']['master']['driver'] . '.sql'));
-			
-			foreach ($sqldata as $sql) {
-				if (! DB::execute ($sql)) {
-					echo 'Error: ' . DB::error () . "\n";
-					DB::execute ('rollback');
-				}
-			}
-			
-			// change the admin user's password
-			$pass = generate_password (8);
-			$date = gmdate ('Y-m-d H:i:s');
-			if (! DB::execute (
-				"update `user` set `email` = ?, `password` = ? where `id` = 1",
-				$conf['General']['email_from'],
-				encrypt_password ($pass)
-			)) {
-				echo 'Error: ' . DB::error () . "\n";
-			}
-			
-			// respond with the root password
-			echo "Database created. Your initial admin account is:\n";
-			echo 'Username: ' . $conf['General']['email_from'] . "\n";
-			echo 'Password: ' . $pass . "\n";
-			
-			// create versions entries for initial content
-			$wp = new Webpage ('index');
-			Versions::add ($wp);
-			$b = new Block ('members');
-			Versions::add ($b);
-			
-			// disable the installer
-			@umask (0000);
-			@touch ('conf/installed');
-			echo "Done.\n";
-			break;
-
-
-
-		/**
-		 * This command builds the scaffolding for a new
-		 * app in the apps folder. This includes the basic
-		 * directory structure as well as some sample
-		 * files (config, handlers, views).
-		 */
-		case 'build-app':
-			if (! isset ($argv[2])) {
-				echo "Usage: elefant build-app <appname>\n";
-				die;
-			}
-
-			mkdir ('apps/' . $argv[2] . '/conf', 0755, true);
-			mkdir ('apps/' . $argv[2] . '/forms', 0755, true);
-			mkdir ('apps/' . $argv[2] . '/handlers', 0755, true);
-			mkdir ('apps/' . $argv[2] . '/lib', 0755, true);
-			mkdir ('apps/' . $argv[2] . '/models', 0755, true);
-			mkdir ('apps/' . $argv[2] . '/views', 0755, true);
-			
-			file_put_contents ('apps/' . $argv[2] . '/handlers/index.php', sprintf (
-				"<?php\n\n\$page->title = '%s home';\necho \$tpl->render ('%s/index', array ());\n\n?>",
-				ucfirst ($argv[2]),
-				$argv[2]
-			));
-			file_put_contents ('apps/' . $argv[2] . '/handlers/admin.php', sprintf (
-				"<?php\n\n\$this->require_admin ();\n\n\$page->layout = 'admin';\n\$page->title = '%s admin';\n\n?>",
-				ucfirst ($argv[2])
-			));
-			file_put_contents ('apps/' . $argv[2] . '/views/index.html', '<p>{{ body|none }}</p>');
-			file_put_contents ('apps/' . $argv[2] . '/conf/config.php', sprintf (
-				"; <?php /*\n\n[Admin]\n\nhandler = %s/admin\nname = %s\n\n; */ ?>",
-				$argv[2],
-				ucfirst ($argv[2])
-			));
-			
-			printf ("App created in apps/%s/\n", $argv[2]);
-			break;
-
-
-
-		/**
-		 * This command exports a backup of the database into
-		 * the specified file using the database's associated
-		 * command line export utility. Note that the utility
-		 * must be in your path for this to work.
-		 */
-		case 'export-db':
-			$conf = parse_ini_file ('conf/config.php', true);
-			switch ($conf['Database']['master']['driver']) {
-				case 'sqlite':
-					if (isset ($argv[2])) {
-						exec ('sqlite3 ' . $conf['Database']['master']['file'] . ' .dump > ' . $argv[2]);
-					} else {
-						passthru ('sqlite3 ' . $conf['Database']['master']['file'] . ' .dump');
-					}
-					break;
-
-				case 'mysql':
-					// get port number
-					list ($host, $port) = (strpos ($conf['Database']['master']['host'], ':') !== false)
-						? explode (':', $conf['Database']['master']['host'])
-						: array ($conf['Database']['master']['host'], 3306);
-
-					if (isset ($argv[2])) {
-						exec (sprintf (
-							'mysqldump --password=%s -u %s -h %s -P %d %s > %s',
-							 escapeshellcmd ($conf['Database']['master']['pass']),
-							 $conf['Database']['master']['user'],
-							 $host,
-							 $port,
-							 $conf['Database']['master']['name'],
-							 $argv[2]
-						));
-					} else {
-						passthru (sprintf (
-							'mysqldump --password=%s -u %s -h %s -P %d %s',
-							 escapeshellcmd ($conf['Database']['master']['pass']),
-							 $conf['Database']['master']['user'],
-							 $host,
-							 $port,
-							 $conf['Database']['master']['name']
-						));
-					}
-					break;
-
-				case 'pgsql':
-					// get port number
-					list ($host, $port) = (strpos ($conf['Database']['master']['host'], ':') !== false)
-						? explode (':', $conf['Database']['master']['host'])
-						: array ($conf['Database']['master']['host'], 3306);
-
-					file_put_contents ('conf/.pgpass', sprintf (
-						'%s:%d:%s:%s:%s',
-						$host,
-						$port,
-						$conf['Database']['master']['name'],
-						$conf['Database']['master']['user'],
-						$conf['Database']['master']['pass']
-					));
-					chmod ('conf/.pgpass', 0600);
-					if (isset ($argv[2])) {
-						exec (sprintf (
-							'export PGPASSFILE=conf/.pgpass; pg_dump -U %s -h %s -p %d %s > %s; export PGPASSFILE=~/.pgpass',
-							 $conf['Database']['master']['user'],
-							 $host,
-							 $port,
-							 $conf['Database']['master']['name'],
-							 $argv[2]
-						));
-					} else {
-						passthru (sprintf (
-							'export PGPASSFILE=conf/.pgpass; pg_dump -U %s -h %s -p %d %s; export PGPASSFILE=~/.pgpass',
-							 $conf['Database']['master']['user'],
-							 $host,
-							 $port,
-							 $conf['Database']['master']['name']
-						));
-					}
-					unlink ('conf/.pgpass');
-					break;
-
-				default:
-					echo "** Error: Unable to determine database driver from site config.\n";
-					die;
-					break;
-			}
-			break;
-
-
-
-		/**
-		 * Create a backup of the site and database as a tarball
-		 * and move it to the specified folder.
-		 */
-		case 'backup':
-			if (! isset ($argv[2])) {
-				echo "Usage: elefant backup <path>\n";
-				die;
-			}
-			if (! @is_dir ($argv[2])) {
-				echo "** Error: Specified path is not a folder.\n";
-				die;
-			}
-			if (! @is_writeable ($argv[2])) {
-				echo "** Error: Specified folder is not writeable.\n";
-				die;
-			}
-
-			// add trailing slash
-			$path = (preg_match ('/\/$/', $argv[2])) ? $argv[2] : $argv[2] . '/';
-
-			date_default_timezone_set ('GMT');
-			$ts = gmdate ('Y-m-d-H-i-s');
-
-			if (! @is_dir ('.backups')) {
-				mkdir ('.backups');
-				file_put_contents ('.backups/.htaccess', "Order allow,deny\nDeny from all\n");
-			}
-			mkdir ('.backups/backup-' . $ts);
-			exec ('./conf/elefant backup-db .backups/backup-' . $ts . '/db.sql');
-			copy ('.htaccess', '.backups/backup-' . $ts . '/.htaccess');
-			exec ('cp -R * .backups/backup-' . $ts . '/');
-			chdir ('.backups');
-			exec ('tar -cf backup-' . $ts . '.tar backup-' . $ts);
-			exec ('gzip backup-' . $ts . '.tar');
-			chdir ('..');
-			exec ('mv .backups/backup-' . $ts . '.tar.gz ' . $path);
-			exec ('rm -Rf .backups/backup-' . $ts);
-			break;
-
-
-
-		/**
-		 * Encrypts the specified password in a compatible format
-		 * for storage in the Elefant user table.
-		 */
-		case 'encrypt-password':
-			if (! isset ($argv[2])) {
-				echo "Usage: elefant encrypt-password <password>\n";
-				die;
-			}
-			echo encrypt_password ($argv[2]) . "\n";
-			break;
-
-
-
-		/**
-		 * Generates a random password of the specified length
-		 * (default is 8 characters), using random lower- and
-		 * upper-case letters, numbers, and symbols.
-		 */
-		case 'generate-password':
-			if (isset ($argv[2])) {
-				if (! is_numeric ($argv[2])) {
-					echo "Usage: elefant generate-password <length|8>\n";
-					die;
-				}
-				$length = $argv[2];
-			} else {
-				$length = 8;
-			}
-			echo generate_password ($length) . "\n";
-			break;
-
-
-
-		/**
-		 * Unknown command error handler.
-		 */
-		default:
-			echo "** Error: Unknown option: ${argv[1]}\n";
-			die;
-			break;
-	}
-
-} else {
-	echo $help;
-}
-
-?>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/conf/install_mysql.sql elefant-1.3.2-beta/conf/install_mysql.sql
--- elefant-1.3.1-beta/conf/install_mysql.sql	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/conf/install_mysql.sql	2012-09-13 09:15:24.000000000 -0500
@@ -11,9 +11,9 @@
 	keywords text,
 	body text,
 	index (access)
-);
+) default charset=utf8;
 
-insert into webpage (id, title, menu_title, window_title, access, layout, description, keywords, body) values ('index', 'Welcome to Elefant', 'Home', '', 'public', 'index', '', '', '<table><tbody><tr><td><h3>Congratulations!</h3>You have successfully installed Elefant, the refreshingly simple new PHP web framework and CMS.</td><td><h3>Getting Started</h3>To log in as an administrator and edit pages, write a blog post, or upload files, go to <a href="/admin">/admin</a>.</td><td><h3>Developers</h3>Documentation, source code and issue tracking can be found at <a href="http://github.com/jbroadway/elefant">github.com/jbroadway/elefant</a></td></tr></tbody></table>');
+insert into webpage (id, title, menu_title, window_title, access, layout, description, keywords, body) values ('index', 'Welcome to Elefant', 'Home', '', 'public', 'default', '', '', '<table><tbody><tr><td><h3>Congratulations!</h3>You have successfully installed Elefant, the refreshingly simple new PHP web framework and CMS.</td><td><h3>Getting Started</h3>To log in as an administrator and edit pages, write a blog post, or upload files, go to <a href="/admin">/admin</a>.</td><td><h3>Developers</h3>Documentation, source code and issue tracking can be found at <a href="http://github.com/jbroadway/elefant">github.com/jbroadway/elefant</a></td></tr></tbody></table>');
 
 create table block (
 	id char(72) not null primary key,
@@ -22,7 +22,7 @@
 	access enum('public','member','private') not null default 'public',
 	show_title enum('yes','no') not null default 'yes',
 	index (access)
-);
+) default charset=utf8;
 
 insert into block (id, title, access, body, show_title) values ('members', 'Members', 'public', '{! user/sidebar !}', 'no');
 
@@ -39,14 +39,14 @@
 	userdata text not null,
 	index(email, password),
 	index(session_id)
-);
+) default charset=utf8;
 
 insert into user (id, email, password, session_id, expires, name, type, signed_up, updated, userdata) values (1, 'you@example.com', '$2a$07$1QeR9mu2doQxY0uBcpFlrOIfDxq0BwpR8FsImCgWvAL4Fz9jDByxi', null, now(), 'Admin User', 'admin', now(), now(), '[]');
 
 create table user_openid (
-	token char(128) primary key,
+	token char(200) primary key,
 	user_id int not null
-);
+) default charset=utf8;
 
 create table versions (
 	id int not null auto_increment primary key,
@@ -57,7 +57,7 @@
 	serialized text not null,
 	index (class, pkey, ts),
 	index (user, ts)
-);
+) default charset=utf8;
 
 create table api (
 	token char(35) not null primary key,
@@ -65,7 +65,7 @@
 	user_id int not null,
 	index (token, api_key),
 	index (user_id)
-);
+) default charset=utf8;
 
 create table blog_post (
 	id int not null auto_increment primary key,
@@ -78,17 +78,17 @@
 	extra text not null,
 	index (ts),
 	index (ts, published)
-);
+) default charset=utf8;
 
 create table blog_tag (
 	id char(24) not null primary key
-);
+) default charset=utf8;
 
 create table blog_post_tag (
 	tag_id char(24) not null,
 	post_id int not null,
 	primary key (tag_id, post_id)
-);
+) default charset=utf8;
 
 create table `lock` (
 	id int not null auto_increment primary key,
@@ -100,19 +100,19 @@
 	modified datetime not null,
 	index (user),
 	index (resource, resource_id, expires)
-);
+) default charset=utf8;
 
 create table filemanager_prop (
 	file char(128) not null primary key,
 	prop char(32) not null,
 	value char(255) not null,
 	index (prop)
-);
+) default charset=utf8;
 
 create table apps (
 	name char(48) not null primary key,
 	version char(16) not null
-);
+) default charset=utf8;
 
 insert into apps (name, version) values ('blog', '1.1.3-stable');
 insert into apps (name, version) values ('user', '1.1.3-stable');
diff -urBNs elefant-1.3.1-beta/conf/install_pgsql.sql elefant-1.3.2-beta/conf/install_pgsql.sql
--- elefant-1.3.1-beta/conf/install_pgsql.sql	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/conf/install_pgsql.sql	2012-09-13 09:15:24.000000000 -0500
@@ -15,7 +15,7 @@
 
 create index webpage_access on webpage (access);
 
-insert into webpage (id, title, menu_title, window_title, access, layout, description, keywords, body) values ('index', 'Welcome to Elefant', 'Home', '', 'public', 'index', '', '', '<table><tbody><tr><td><h3>Congratulations!</h3>You have successfully installed Elefant, the refreshingly simple new PHP web framework and CMS.</td><td><h3>Getting Started</h3>To log in as an administrator and edit pages, write a blog post, or upload files, go to <a href="/admin">/admin</a>.</td><td><h3>Developers</h3>Documentation, source code and issue tracking can be found at <a href="http://github.com/jbroadway/elefant">github.com/jbroadway/elefant</a></td></tr></tbody></table>');
+insert into webpage (id, title, menu_title, window_title, access, layout, description, keywords, body) values ('index', 'Welcome to Elefant', 'Home', '', 'public', 'default', '', '', '<table><tbody><tr><td><h3>Congratulations!</h3>You have successfully installed Elefant, the refreshingly simple new PHP web framework and CMS.</td><td><h3>Getting Started</h3>To log in as an administrator and edit pages, write a blog post, or upload files, go to <a href="/admin">/admin</a>.</td><td><h3>Developers</h3>Documentation, source code and issue tracking can be found at <a href="http://github.com/jbroadway/elefant">github.com/jbroadway/elefant</a></td></tr></tbody></table>');
 
 
 create table block (
@@ -53,7 +53,7 @@
 insert into "user" (id, email, password, session_id, expires, name, type, signed_up, updated, userdata) values (1, 'you@example.com', '$2a$07$1QeR9mu2doQxY0uBcpFlrOIfDxq0BwpR8FsImCgWvAL4Fz9jDByxi', null, now(), 'Admin User', 'admin', now(), now(), '[]');
 
 create table user_openid (
-	token varchar(128) primary key,
+	token varchar(200) primary key,
 	user_id integer not null
 );
 
diff -urBNs elefant-1.3.1-beta/conf/install_sqlite.sql elefant-1.3.2-beta/conf/install_sqlite.sql
--- elefant-1.3.1-beta/conf/install_sqlite.sql	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/conf/install_sqlite.sql	2012-09-13 09:15:24.000000000 -0500
@@ -14,7 +14,7 @@
 
 create index webpage_access on webpage (access);
 
-insert into webpage (id, title, menu_title, window_title, access, layout, description, keywords, body) values ('index', 'Welcome to Elefant', 'Home', '', 'public', 'index', '', '', '<table><tbody><tr><td><h3>Congratulations!</h3>You have successfully installed Elefant, the refreshingly simple new PHP web framework and CMS.</td><td><h3>Getting Started</h3>To log in as an administrator and edit pages, write a blog post, or upload files, go to <a href="/admin">/admin</a>.</td><td><h3>Developers</h3>Documentation, source code and issue tracking can be found at <a href="http://github.com/jbroadway/elefant">github.com/jbroadway/elefant</a></td></tr></tbody></table>');
+insert into webpage (id, title, menu_title, window_title, access, layout, description, keywords, body) values ('index', 'Welcome to Elefant', 'Home', '', 'public', 'default', '', '', '<table><tbody><tr><td><h3>Congratulations!</h3>You have successfully installed Elefant, the refreshingly simple new PHP web framework and CMS.</td><td><h3>Getting Started</h3>To log in as an administrator and edit pages, write a blog post, or upload files, go to <a href="/admin">/admin</a>.</td><td><h3>Developers</h3>Documentation, source code and issue tracking can be found at <a href="http://github.com/jbroadway/elefant">github.com/jbroadway/elefant</a></td></tr></tbody></table>');
 
 create table block (
 	id char(72) not null primary key,
@@ -47,7 +47,7 @@
 insert into user (id, email, password, session_id, expires, name, type, signed_up, updated, userdata) values (1, 'you@example.com', '$2a$07$1QeR9mu2doQxY0uBcpFlrOIfDxq0BwpR8FsImCgWvAL4Fz9jDByxi', null, (DATETIME('now')), 'Admin User', 'admin', (DATETIME('now')), (DATETIME('now')), '[]');
 
 create table user_openid (
-	token char(128) primary key,
+	token char(200) primary key,
 	user_id int not null
 );
 
Files elefant-1.3.1-beta/conf/navigation.json and elefant-1.3.2-beta/conf/navigation.json are identical
Files elefant-1.3.1-beta/conf/package.xml and elefant-1.3.2-beta/conf/package.xml are identical
Files elefant-1.3.1-beta/conf/product.php and elefant-1.3.2-beta/conf/product.php are identical
Files elefant-1.3.1-beta/conf/site.db and elefant-1.3.2-beta/conf/site.db are identical
diff -urBNs elefant-1.3.1-beta/conf/version.php elefant-1.3.2-beta/conf/version.php
--- elefant-1.3.1-beta/conf/version.php	2012-05-01 08:27:32.000000000 -0500
+++ elefant-1.3.2-beta/conf/version.php	2012-09-13 09:15:24.000000000 -0500
@@ -1 +1 @@
-<?php define ('ELEFANT_VERSION', '1.3.1'); ?>
\ No newline at end of file
+<?php define ('ELEFANT_VERSION', '1.3.2'); ?>
\ No newline at end of file
Files elefant-1.3.1-beta/css/960.css and elefant-1.3.2-beta/css/960.css are identical
Files elefant-1.3.1-beta/css/files/ajax-loader.gif and elefant-1.3.2-beta/css/files/ajax-loader.gif are identical
Files elefant-1.3.1-beta/css/files/icon.png and elefant-1.3.2-beta/css/files/icon.png are identical
Files elefant-1.3.1-beta/css/files/images/application.png and elefant-1.3.2-beta/css/files/images/application.png are identical
Files elefant-1.3.1-beta/css/files/images/code.png and elefant-1.3.2-beta/css/files/images/code.png are identical
Files elefant-1.3.1-beta/css/files/images/css.png and elefant-1.3.2-beta/css/files/images/css.png are identical
Files elefant-1.3.1-beta/css/files/images/db.png and elefant-1.3.2-beta/css/files/images/db.png are identical
Files elefant-1.3.1-beta/css/files/images/directory.png and elefant-1.3.2-beta/css/files/images/directory.png are identical
Files elefant-1.3.1-beta/css/files/images/doc.png and elefant-1.3.2-beta/css/files/images/doc.png are identical
Files elefant-1.3.1-beta/css/files/images/file.png and elefant-1.3.2-beta/css/files/images/file.png are identical
Files elefant-1.3.1-beta/css/files/images/film.png and elefant-1.3.2-beta/css/files/images/film.png are identical
Files elefant-1.3.1-beta/css/files/images/flash.png and elefant-1.3.2-beta/css/files/images/flash.png are identical
Files elefant-1.3.1-beta/css/files/images/folder_open.png and elefant-1.3.2-beta/css/files/images/folder_open.png are identical
Files elefant-1.3.1-beta/css/files/images/html.png and elefant-1.3.2-beta/css/files/images/html.png are identical
Files elefant-1.3.1-beta/css/files/images/java.png and elefant-1.3.2-beta/css/files/images/java.png are identical
Files elefant-1.3.1-beta/css/files/images/linux.png and elefant-1.3.2-beta/css/files/images/linux.png are identical
Files elefant-1.3.1-beta/css/files/images/mkdir.png and elefant-1.3.2-beta/css/files/images/mkdir.png are identical
Files elefant-1.3.1-beta/css/files/images/music.png and elefant-1.3.2-beta/css/files/images/music.png are identical
Files elefant-1.3.1-beta/css/files/images/pdf.png and elefant-1.3.2-beta/css/files/images/pdf.png are identical
Files elefant-1.3.1-beta/css/files/images/php.png and elefant-1.3.2-beta/css/files/images/php.png are identical
Files elefant-1.3.1-beta/css/files/images/picture.png and elefant-1.3.2-beta/css/files/images/picture.png are identical
Files elefant-1.3.1-beta/css/files/images/ppt.png and elefant-1.3.2-beta/css/files/images/ppt.png are identical
Files elefant-1.3.1-beta/css/files/images/prev-directory.png and elefant-1.3.2-beta/css/files/images/prev-directory.png are identical
Files elefant-1.3.1-beta/css/files/images/psd.png and elefant-1.3.2-beta/css/files/images/psd.png are identical
Files elefant-1.3.1-beta/css/files/images/remove.png and elefant-1.3.2-beta/css/files/images/remove.png are identical
Files elefant-1.3.1-beta/css/files/images/rename.png and elefant-1.3.2-beta/css/files/images/rename.png are identical
Files elefant-1.3.1-beta/css/files/images/ruby.png and elefant-1.3.2-beta/css/files/images/ruby.png are identical
Files elefant-1.3.1-beta/css/files/images/script.png and elefant-1.3.2-beta/css/files/images/script.png are identical
Files elefant-1.3.1-beta/css/files/images/txt.png and elefant-1.3.2-beta/css/files/images/txt.png are identical
Files elefant-1.3.1-beta/css/files/images/upload.png and elefant-1.3.2-beta/css/files/images/upload.png are identical
Files elefant-1.3.1-beta/css/files/images/xls.png and elefant-1.3.2-beta/css/files/images/xls.png are identical
Files elefant-1.3.1-beta/css/files/images/zip.png and elefant-1.3.2-beta/css/files/images/zip.png are identical
Files elefant-1.3.1-beta/css/files/spacer.gif and elefant-1.3.2-beta/css/files/spacer.gif are identical
Files elefant-1.3.1-beta/css/files/wysiwyg.fileManager.css and elefant-1.3.2-beta/css/files/wysiwyg.fileManager.css are identical
Files elefant-1.3.1-beta/css/mobile.css and elefant-1.3.2-beta/css/mobile.css are identical
Files elefant-1.3.1-beta/css/reset.css and elefant-1.3.2-beta/css/reset.css are identical
Files elefant-1.3.1-beta/css/style.css and elefant-1.3.2-beta/css/style.css are identical
Files elefant-1.3.1-beta/css/text.css and elefant-1.3.2-beta/css/text.css are identical
Files elefant-1.3.1-beta/css/wysiwyg/default.css and elefant-1.3.2-beta/css/wysiwyg/default.css are identical
Files elefant-1.3.1-beta/css/wysiwyg/jquery.wysiwyg.bg.png and elefant-1.3.2-beta/css/wysiwyg/jquery.wysiwyg.bg.png are identical
Files elefant-1.3.1-beta/css/wysiwyg/jquery.wysiwyg.css and elefant-1.3.2-beta/css/wysiwyg/jquery.wysiwyg.css are identical
Files elefant-1.3.1-beta/css/wysiwyg/jquery.wysiwyg.gif and elefant-1.3.2-beta/css/wysiwyg/jquery.wysiwyg.gif are identical
Files elefant-1.3.1-beta/css/wysiwyg/jquery.wysiwyg.no-alpha.gif and elefant-1.3.2-beta/css/wysiwyg/jquery.wysiwyg.no-alpha.gif are identical
diff -urBNs elefant-1.3.1-beta/elefant elefant-1.3.2-beta/elefant
--- elefant-1.3.1-beta/elefant	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/elefant	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,83 @@
+#!/usr/bin/env php
+<?php
+
+/**
+ * Elefant CMS - http://www.elefantcms.com/
+ *
+ * Copyright (c) 2011 Johnny Broadway
+ * 
+ * Permission is hereby granted, free of charge, to any person obtaining a copy
+ * of this software and associated documentation files (the "Software"), to deal
+ * in the Software without restriction, including without limitation the rights
+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+ * copies of the Software, and to permit persons to whom the Software is
+ * furnished to do so, subject to the following conditions:
+ * 
+ * The above copyright notice and this permission notice shall be included in
+ * all copies or substantial portions of the Software.
+ * 
+ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+ * THE SOFTWARE.
+ */
+
+/**
+ * This is the Elefant command line utility. It can run the Elefant
+ * install routines, create the scaffolding for new apps or the index
+ * for new translation files, or encrypt a password for you.
+ *
+ * Usage:
+ *
+ *     $ cd /path/to/my/site
+ *     $ elefant COMMAND
+ */
+
+// Prevent non-CLI access
+if (! defined ('STDIN')) {
+	echo "** Error: Must be run from the command line.\n";
+	die;
+}
+
+// Make sure we're in an Elefant site root
+if (! file_exists ('conf/config.php')) {
+	echo "** Error: Must be run from the root of an Elefant website.\n";
+	die;
+}
+
+ini_set ('error_reporting', 247);
+
+// Remove the script name
+array_shift ($argv);
+
+if (count ($argv) === 0) {
+	// No command, use default handler
+	$handler = 'cli/index';
+} else {
+	$handler = array_shift ($argv);
+	if (strpos ($handler, '/') === false) {
+		// Built-in command
+		$handler = 'cli/' . $handler;
+	} else {
+		// Extended command, verify it's valid first
+		list ($app, $tmp) = explode ('/', $handler, 2);
+		if (! file_exists ('apps/' . $app . '/conf/cli.php')) {
+			printf ("** Error: Unknown option: %s\n", $handler);
+			return;
+		}
+
+		$parsed = parse_ini_file ('apps/' . $app . '/conf/cli.php');
+		if (! in_array ($handler, array_keys ($parsed['commands']))) {
+			printf ("** Error: Unknown option: %s\n", $handler);
+			return;
+		}
+	}
+}
+
+// Run the command through Elefant's CLI handling
+system ('php index.php ' . $handler . ' ' . join (' ', $argv));
+
+?>
\ No newline at end of file
Files elefant-1.3.1-beta/favicon.ico and elefant-1.3.2-beta/favicon.ico are identical
Files elefant-1.3.1-beta/files/.htaccess and elefant-1.3.2-beta/files/.htaccess are identical
Files elefant-1.3.1-beta/files/design/bg.png and elefant-1.3.2-beta/files/design/bg.png are identical
Files elefant-1.3.1-beta/files/homepage/photo1.jpg and elefant-1.3.2-beta/files/homepage/photo1.jpg are identical
Files elefant-1.3.1-beta/files/homepage/photo2.jpg and elefant-1.3.2-beta/files/homepage/photo2.jpg are identical
Files elefant-1.3.1-beta/files/homepage/photo3.jpg and elefant-1.3.2-beta/files/homepage/photo3.jpg are identical
Files elefant-1.3.1-beta/files/homepage/photo4.jpg and elefant-1.3.2-beta/files/homepage/photo4.jpg are identical
diff -urBNs elefant-1.3.1-beta/index.php elefant-1.3.2-beta/index.php
--- elefant-1.3.1-beta/index.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/index.php	2012-09-13 09:15:24.000000000 -0500
@@ -4,17 +4,17 @@
  * Elefant CMS - http://www.elefantcms.com/
  *
  * Copyright (c) 2011 Johnny Broadway
- * 
+ *
  * Permission is hereby granted, free of charge, to any person obtaining a copy
  * of this software and associated documentation files (the "Software"), to deal
  * in the Software without restriction, including without limitation the rights
  * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  * copies of the Software, and to permit persons to whom the Software is
  * furnished to do so, subject to the following conditions:
- * 
+ *
  * The above copyright notice and this permission notice shall be included in
  * all copies or substantial portions of the Software.
- * 
+ *
  * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
@@ -92,6 +92,7 @@
 require ('lib/I18n.php');
 require ('lib/Controller.php');
 require ('lib/Template.php');
+require ('lib/View.php');
 
 /**
  * If we're on the command line, set the request to use
@@ -111,6 +112,7 @@
 $page = new Page;
 $controller = new Controller (conf ('Hooks'));
 $tpl = new Template (conf ('General', 'charset'), $controller);
+View::init ($tpl);
 
 /**
  * Check for a bootstrap.php file in the root of the site
@@ -126,8 +128,8 @@
  * consistent cache API (based on Memcache) so we can always
  * include caching in our handlers and in the front controller.
  */
-if (! isset ($memcache) || ! is_object ($memcache)) {
-	$memcache = Cache::init (conf ('Cache'));
+if (! isset ($cache) || ! is_object ($cache)) {
+	$cache = Cache::init (conf ('Cache'));
 }
 
 /**
@@ -151,4 +153,4 @@
 }
 echo $out;
 
-?>
\ No newline at end of file
+?>
Files elefant-1.3.1-beta/install/cache/.htaccess and elefant-1.3.2-beta/install/cache/.htaccess are identical
Files elefant-1.3.1-beta/install/css/style.css and elefant-1.3.2-beta/install/css/style.css are identical
Files elefant-1.3.1-beta/install/css/title.png and elefant-1.3.2-beta/install/css/title.png are identical
diff -urBNs elefant-1.3.1-beta/install/index.php elefant-1.3.2-beta/install/index.php
--- elefant-1.3.1-beta/install/index.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/install/index.php	2012-09-13 09:15:24.000000000 -0500
@@ -155,6 +155,7 @@
 				if (! $data['error']) {
 					$conf = file_get_contents ('../conf/config.php');
 					// good to replace database settings
+					$_POST['pass'] = str_replace ('"', '\"', $_POST['pass']);
 					$dbinfo = $tpl->render ('dbinfo', $_POST);
 					$conf = preg_replace ('/\[Database\].*\[Mongo\]/s', $dbinfo, $conf);
 					if (! file_put_contents ('../conf/config.php', $conf)) {
@@ -180,8 +181,8 @@
 		if ($_SERVER['REQUEST_METHOD'] == 'POST') {
 			// got the settings, save them
 			$conf = file_get_contents ('../conf/config.php');
-			$conf = preg_replace ('/site_name = .*/', 'site_name = "' . $_POST['site_name'] . '"', $conf);
-			$conf = preg_replace ('/email_from = .*/', 'email_from = "' . $_POST['email_from'] . '"', $conf);
+			$conf = preg_replace ('/site_name = .*/', 'site_name = "' . $_POST['site_name'] . '"', $conf, 1);
+			$conf = preg_replace ('/email_from = .*/', 'email_from = "' . $_POST['email_from'] . '"', $conf, 1);
 			if (! file_put_contents ('../conf/config.php', $conf)) {
 				$data['error'] = i18n_get ('Failed to write to conf/config.php');
 			} else {
Files elefant-1.3.1-beta/install/layouts/database.html and elefant-1.3.2-beta/install/layouts/database.html are identical
diff -urBNs elefant-1.3.1-beta/install/layouts/dbinfo.html elefant-1.3.2-beta/install/layouts/dbinfo.html
--- elefant-1.3.1-beta/install/layouts/dbinfo.html	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/install/layouts/dbinfo.html	2012-09-13 09:15:24.000000000 -0500
@@ -13,7 +13,7 @@
 
 master[user] = {{ user }}
 
-master[pass] = "{{ pass }}"
+master[pass] = "{{ pass|none }}"
 {% end %}
 
 [Mongo]
\ No newline at end of file
Files elefant-1.3.1-beta/install/layouts/finished.html and elefant-1.3.2-beta/install/layouts/finished.html are identical
Files elefant-1.3.1-beta/install/layouts/introduction.html and elefant-1.3.2-beta/install/layouts/introduction.html are identical
Files elefant-1.3.1-beta/install/layouts/license.html and elefant-1.3.2-beta/install/layouts/license.html are identical
Files elefant-1.3.1-beta/install/layouts/requirements.html and elefant-1.3.2-beta/install/layouts/requirements.html are identical
Files elefant-1.3.1-beta/install/layouts/settings.html and elefant-1.3.2-beta/install/layouts/settings.html are identical
Files elefant-1.3.1-beta/js/jquery-1.7.1.min.js and elefant-1.3.2-beta/js/jquery-1.7.1.min.js are identical
Files elefant-1.3.1-beta/js/jquery-ui/images/ui-bg_flat_0_aaaaaa_40x100.png and elefant-1.3.2-beta/js/jquery-ui/images/ui-bg_flat_0_aaaaaa_40x100.png are identical
Files elefant-1.3.1-beta/js/jquery-ui/images/ui-bg_flat_75_ffffff_40x100.png and elefant-1.3.2-beta/js/jquery-ui/images/ui-bg_flat_75_ffffff_40x100.png are identical
Files elefant-1.3.1-beta/js/jquery-ui/images/ui-bg_glass_55_fbf9ee_1x400.png and elefant-1.3.2-beta/js/jquery-ui/images/ui-bg_glass_55_fbf9ee_1x400.png are identical
Files elefant-1.3.1-beta/js/jquery-ui/images/ui-bg_glass_65_ffffff_1x400.png and elefant-1.3.2-beta/js/jquery-ui/images/ui-bg_glass_65_ffffff_1x400.png are identical
Files elefant-1.3.1-beta/js/jquery-ui/images/ui-bg_glass_75_dadada_1x400.png and elefant-1.3.2-beta/js/jquery-ui/images/ui-bg_glass_75_dadada_1x400.png are identical
Files elefant-1.3.1-beta/js/jquery-ui/images/ui-bg_glass_75_e6e6e6_1x400.png and elefant-1.3.2-beta/js/jquery-ui/images/ui-bg_glass_75_e6e6e6_1x400.png are identical
Files elefant-1.3.1-beta/js/jquery-ui/images/ui-bg_glass_95_fef1ec_1x400.png and elefant-1.3.2-beta/js/jquery-ui/images/ui-bg_glass_95_fef1ec_1x400.png are identical
Files elefant-1.3.1-beta/js/jquery-ui/images/ui-bg_highlight-soft_75_cccccc_1x100.png and elefant-1.3.2-beta/js/jquery-ui/images/ui-bg_highlight-soft_75_cccccc_1x100.png are identical
Files elefant-1.3.1-beta/js/jquery-ui/images/ui-icons_222222_256x240.png and elefant-1.3.2-beta/js/jquery-ui/images/ui-icons_222222_256x240.png are identical
Files elefant-1.3.1-beta/js/jquery-ui/images/ui-icons_454545_256x240.png and elefant-1.3.2-beta/js/jquery-ui/images/ui-icons_454545_256x240.png are identical
Files elefant-1.3.1-beta/js/jquery-ui/images/ui-icons_888888_256x240.png and elefant-1.3.2-beta/js/jquery-ui/images/ui-icons_888888_256x240.png are identical
Files elefant-1.3.1-beta/js/jquery-ui/jquery-ui.css and elefant-1.3.2-beta/js/jquery-ui/jquery-ui.css are identical
Files elefant-1.3.1-beta/js/jquery-ui/jquery-ui.min.js and elefant-1.3.2-beta/js/jquery-ui/jquery-ui.min.js are identical
Files elefant-1.3.1-beta/js/jquery.autosave.js and elefant-1.3.2-beta/js/jquery.autosave.js are identical
Files elefant-1.3.1-beta/js/jquery.bgsave.js and elefant-1.3.2-beta/js/jquery.bgsave.js are identical
Files elefant-1.3.1-beta/js/jquery.cookie.js and elefant-1.3.2-beta/js/jquery.cookie.js are identical
Files elefant-1.3.1-beta/js/jquery.localize.min.js and elefant-1.3.2-beta/js/jquery.localize.min.js are identical
Files elefant-1.3.1-beta/js/jquery.password_strength.js and elefant-1.3.2-beta/js/jquery.password_strength.js are identical
Files elefant-1.3.1-beta/js/jquery.quickpager.js and elefant-1.3.2-beta/js/jquery.quickpager.js are identical
Files elefant-1.3.1-beta/js/jquery.verify_values.js and elefant-1.3.2-beta/js/jquery.verify_values.js are identical
Files elefant-1.3.1-beta/js/json2.js and elefant-1.3.2-beta/js/json2.js are identical
Files elefant-1.3.1-beta/js/jstorage.js and elefant-1.3.2-beta/js/jstorage.js are identical
diff -urBNs elefant-1.3.1-beta/js/urlify.js elefant-1.3.2-beta/js/urlify.js
--- elefant-1.3.1-beta/js/urlify.js	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/js/urlify.js	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,139 @@
+var LATIN_MAP = {
+    'À': 'A', 'Á': 'A', 'Â': 'A', 'Ã': 'A', 'Ä': 'A', 'Å': 'A', 'Æ': 'AE', 'Ç':
+    'C', 'È': 'E', 'É': 'E', 'Ê': 'E', 'Ë': 'E', 'Ì': 'I', 'Í': 'I', 'Î': 'I',
+    'Ï': 'I', 'Ð': 'D', 'Ñ': 'N', 'Ò': 'O', 'Ó': 'O', 'Ô': 'O', 'Õ': 'O', 'Ö':
+    'O', 'Ő': 'O', 'Ø': 'O', 'Ù': 'U', 'Ú': 'U', 'Û': 'U', 'Ü': 'U', 'Ű': 'U',
+    'Ý': 'Y', 'Þ': 'TH', 'ß': 'ss', 'à':'a', 'á':'a', 'â': 'a', 'ã': 'a', 'ä':
+    'a', 'å': 'a', 'æ': 'ae', 'ç': 'c', 'è': 'e', 'é': 'e', 'ê': 'e', 'ë': 'e',
+    'ì': 'i', 'í': 'i', 'î': 'i', 'ï': 'i', 'ð': 'd', 'ñ': 'n', 'ò': 'o', 'ó':
+    'o', 'ô': 'o', 'õ': 'o', 'ö': 'o', 'ő': 'o', 'ø': 'o', 'ù': 'u', 'ú': 'u',
+    'û': 'u', 'ü': 'u', 'ű': 'u', 'ý': 'y', 'þ': 'th', 'ÿ': 'y'
+}
+var LATIN_SYMBOLS_MAP = {
+    '©':'(c)'
+}
+var GREEK_MAP = {
+    'α':'a', 'β':'b', 'γ':'g', 'δ':'d', 'ε':'e', 'ζ':'z', 'η':'h', 'θ':'8',
+    'ι':'i', 'κ':'k', 'λ':'l', 'μ':'m', 'ν':'n', 'ξ':'3', 'ο':'o', 'π':'p',
+    'ρ':'r', 'σ':'s', 'τ':'t', 'υ':'y', 'φ':'f', 'χ':'x', 'ψ':'ps', 'ω':'w',
+    'ά':'a', 'έ':'e', 'ί':'i', 'ό':'o', 'ύ':'y', 'ή':'h', 'ώ':'w', 'ς':'s',
+    'ϊ':'i', 'ΰ':'y', 'ϋ':'y', 'ΐ':'i',
+    'Α':'A', 'Β':'B', 'Γ':'G', 'Δ':'D', 'Ε':'E', 'Ζ':'Z', 'Η':'H', 'Θ':'8',
+    'Ι':'I', 'Κ':'K', 'Λ':'L', 'Μ':'M', 'Ν':'N', 'Ξ':'3', 'Ο':'O', 'Π':'P',
+    'Ρ':'R', 'Σ':'S', 'Τ':'T', 'Υ':'Y', 'Φ':'F', 'Χ':'X', 'Ψ':'PS', 'Ω':'W',
+    'Ά':'A', 'Έ':'E', 'Ί':'I', 'Ό':'O', 'Ύ':'Y', 'Ή':'H', 'Ώ':'W', 'Ϊ':'I',
+    'Ϋ':'Y'
+}
+var TURKISH_MAP = {
+    'ş':'s', 'Ş':'S', 'ı':'i', 'İ':'I', 'ç':'c', 'Ç':'C', 'ü':'u', 'Ü':'U',
+    'ö':'o', 'Ö':'O', 'ğ':'g', 'Ğ':'G'
+}
+var RUSSIAN_MAP = {
+    'а':'a', 'б':'b', 'в':'v', 'г':'g', 'д':'d', 'е':'e', 'ё':'yo', 'ж':'zh',
+    'з':'z', 'и':'i', 'й':'j', 'к':'k', 'л':'l', 'м':'m', 'н':'n', 'о':'o',
+    'п':'p', 'р':'r', 'с':'s', 'т':'t', 'у':'u', 'ф':'f', 'х':'h', 'ц':'c',
+    'ч':'ch', 'ш':'sh', 'щ':'sh', 'ъ':'', 'ы':'y', 'ь':'', 'э':'e', 'ю':'yu',
+    'я':'ya',
+    'А':'A', 'Б':'B', 'В':'V', 'Г':'G', 'Д':'D', 'Е':'E', 'Ё':'Yo', 'Ж':'Zh',
+    'З':'Z', 'И':'I', 'Й':'J', 'К':'K', 'Л':'L', 'М':'M', 'Н':'N', 'О':'O',
+    'П':'P', 'Р':'R', 'С':'S', 'Т':'T', 'У':'U', 'Ф':'F', 'Х':'H', 'Ц':'C',
+    'Ч':'Ch', 'Ш':'Sh', 'Щ':'Sh', 'Ъ':'', 'Ы':'Y', 'Ь':'', 'Э':'E', 'Ю':'Yu',
+    'Я':'Ya'
+}
+var UKRAINIAN_MAP = {
+    'Є':'Ye', 'І':'I', 'Ї':'Yi', 'Ґ':'G', 'є':'ye', 'і':'i', 'ї':'yi', 'ґ':'g'
+}
+var CZECH_MAP = {
+    'č':'c', 'ď':'d', 'ě':'e', 'ň': 'n', 'ř':'r', 'š':'s', 'ť':'t', 'ů':'u',
+    'ž':'z', 'Č':'C', 'Ď':'D', 'Ě':'E', 'Ň': 'N', 'Ř':'R', 'Š':'S', 'Ť':'T',
+    'Ů':'U', 'Ž':'Z'
+}
+
+var POLISH_MAP = {
+    'ą':'a', 'ć':'c', 'ę':'e', 'ł':'l', 'ń':'n', 'ó':'o', 'ś':'s', 'ź':'z',
+    'ż':'z', 'Ą':'A', 'Ć':'C', 'Ę':'e', 'Ł':'L', 'Ń':'N', 'Ó':'o', 'Ś':'S',
+    'Ź':'Z', 'Ż':'Z'
+}
+
+var LATVIAN_MAP = {
+    'ā':'a', 'č':'c', 'ē':'e', 'ģ':'g', 'ī':'i', 'ķ':'k', 'ļ':'l', 'ņ':'n',
+    'š':'s', 'ū':'u', 'ž':'z', 'Ā':'A', 'Č':'C', 'Ē':'E', 'Ģ':'G', 'Ī':'i',
+    'Ķ':'k', 'Ļ':'L', 'Ņ':'N', 'Š':'S', 'Ū':'u', 'Ž':'Z'
+}
+
+var ALL_DOWNCODE_MAPS=new Array()
+ALL_DOWNCODE_MAPS[0]=LATIN_MAP
+ALL_DOWNCODE_MAPS[1]=LATIN_SYMBOLS_MAP
+ALL_DOWNCODE_MAPS[2]=GREEK_MAP
+ALL_DOWNCODE_MAPS[3]=TURKISH_MAP
+ALL_DOWNCODE_MAPS[4]=RUSSIAN_MAP
+ALL_DOWNCODE_MAPS[5]=UKRAINIAN_MAP
+ALL_DOWNCODE_MAPS[6]=CZECH_MAP
+ALL_DOWNCODE_MAPS[7]=POLISH_MAP
+ALL_DOWNCODE_MAPS[8]=LATVIAN_MAP
+
+var Downcoder = new Object();
+Downcoder.Initialize = function()
+{
+    if (Downcoder.map) // already made
+        return ;
+    Downcoder.map ={}
+    Downcoder.chars = '' ;
+    for(var i in ALL_DOWNCODE_MAPS)
+    {
+        var lookup = ALL_DOWNCODE_MAPS[i]
+        for (var c in lookup)
+        {
+            Downcoder.map[c] = lookup[c] ;
+            Downcoder.chars += c ;
+        }
+     }
+    Downcoder.regex = new RegExp('[' + Downcoder.chars + ']|[^' + Downcoder.chars + ']+','g') ;
+}
+
+downcode= function( slug )
+{
+    Downcoder.Initialize() ;
+    var downcoded =""
+    var pieces = slug.match(Downcoder.regex);
+    if(pieces)
+    {
+        for (var i = 0 ; i < pieces.length ; i++)
+        {
+            if (pieces[i].length == 1)
+            {
+                var mapped = Downcoder.map[pieces[i]] ;
+                if (mapped != null)
+                {
+                    downcoded+=mapped;
+                    continue ;
+                }
+            }
+            downcoded+=pieces[i];
+        }
+    }
+    else
+    {
+        downcoded = slug;
+    }
+    return downcoded;
+}
+
+
+function URLify(s, num_chars) {
+    // changes, e.g., "Petty theft" to "petty_theft"
+    // remove all these words from the string before urlifying
+    s = downcode(s);
+    removelist = ["a", "an", "as", "at", "before", "but", "by", "for", "from",
+                  "is", "in", "into", "like", "of", "off", "on", "onto", "per",
+                  "since", "than", "the", "this", "that", "to", "up", "via",
+                  "with"];
+    r = new RegExp('\\b(' + removelist.join('|') + ')\\b', 'gi');
+    s = s.replace(r, '');
+    // if downcode doesn't hit, the char will be stripped here
+    s = s.replace(/[^-\w\s]/g, '');  // remove unneeded chars
+    s = s.replace(/^\s+|\s+$/g, ''); // trim leading/trailing spaces
+    s = s.replace(/[-\s]+/g, '-');   // convert spaces to hyphens
+    s = s.toLowerCase();             // convert to lowercase
+    return s.substring(0, num_chars);// trim to first num_chars chars
+}
Files elefant-1.3.1-beta/js/wysiwyg/controls/wysiwyg.image.js and elefant-1.3.2-beta/js/wysiwyg/controls/wysiwyg.image.js are identical
Files elefant-1.3.1-beta/js/wysiwyg/controls/wysiwyg.image2.js and elefant-1.3.2-beta/js/wysiwyg/controls/wysiwyg.image2.js are identical
Files elefant-1.3.1-beta/js/wysiwyg/controls/wysiwyg.link.js and elefant-1.3.2-beta/js/wysiwyg/controls/wysiwyg.link.js are identical
Files elefant-1.3.1-beta/js/wysiwyg/controls/wysiwyg.link2.js and elefant-1.3.2-beta/js/wysiwyg/controls/wysiwyg.link2.js are identical
Files elefant-1.3.1-beta/js/wysiwyg/controls/wysiwyg.table.js and elefant-1.3.2-beta/js/wysiwyg/controls/wysiwyg.table.js are identical
Files elefant-1.3.1-beta/js/wysiwyg/i18n/lang.cs.js and elefant-1.3.2-beta/js/wysiwyg/i18n/lang.cs.js are identical
Files elefant-1.3.1-beta/js/wysiwyg/i18n/lang.de.js and elefant-1.3.2-beta/js/wysiwyg/i18n/lang.de.js are identical
Files elefant-1.3.1-beta/js/wysiwyg/i18n/lang.en.js and elefant-1.3.2-beta/js/wysiwyg/i18n/lang.en.js are identical
Files elefant-1.3.1-beta/js/wysiwyg/i18n/lang.es.js and elefant-1.3.2-beta/js/wysiwyg/i18n/lang.es.js are identical
Files elefant-1.3.1-beta/js/wysiwyg/i18n/lang.fr.js and elefant-1.3.2-beta/js/wysiwyg/i18n/lang.fr.js are identical
Files elefant-1.3.1-beta/js/wysiwyg/i18n/lang.he.js and elefant-1.3.2-beta/js/wysiwyg/i18n/lang.he.js are identical
Files elefant-1.3.1-beta/js/wysiwyg/i18n/lang.hr.js and elefant-1.3.2-beta/js/wysiwyg/i18n/lang.hr.js are identical
Files elefant-1.3.1-beta/js/wysiwyg/i18n/lang.it.js and elefant-1.3.2-beta/js/wysiwyg/i18n/lang.it.js are identical
Files elefant-1.3.1-beta/js/wysiwyg/i18n/lang.ja.js and elefant-1.3.2-beta/js/wysiwyg/i18n/lang.ja.js are identical
Files elefant-1.3.1-beta/js/wysiwyg/i18n/lang.nl.js and elefant-1.3.2-beta/js/wysiwyg/i18n/lang.nl.js are identical
Files elefant-1.3.1-beta/js/wysiwyg/i18n/lang.pl.js and elefant-1.3.2-beta/js/wysiwyg/i18n/lang.pl.js are identical
Files elefant-1.3.1-beta/js/wysiwyg/i18n/lang.pt_br.js and elefant-1.3.2-beta/js/wysiwyg/i18n/lang.pt_br.js are identical
Files elefant-1.3.1-beta/js/wysiwyg/i18n/lang.ru.js and elefant-1.3.2-beta/js/wysiwyg/i18n/lang.ru.js are identical
Files elefant-1.3.1-beta/js/wysiwyg/i18n/lang.se.js and elefant-1.3.2-beta/js/wysiwyg/i18n/lang.se.js are identical
Files elefant-1.3.1-beta/js/wysiwyg/i18n/lang.sl.js and elefant-1.3.2-beta/js/wysiwyg/i18n/lang.sl.js are identical
Files elefant-1.3.1-beta/js/wysiwyg/i18n/lang.zh-cn.js and elefant-1.3.2-beta/js/wysiwyg/i18n/lang.zh-cn.js are identical
Files elefant-1.3.1-beta/js/wysiwyg/jquery.wysiwyg.js and elefant-1.3.2-beta/js/wysiwyg/jquery.wysiwyg.js are identical
Files elefant-1.3.1-beta/js/wysiwyg/plugins/wysiwyg.embed.js and elefant-1.3.2-beta/js/wysiwyg/plugins/wysiwyg.embed.js are identical
Files elefant-1.3.1-beta/js/wysiwyg/plugins/wysiwyg.fileManager.js and elefant-1.3.2-beta/js/wysiwyg/plugins/wysiwyg.fileManager.js are identical
Files elefant-1.3.1-beta/js/wysiwyg/plugins/wysiwyg.fullscreen.js and elefant-1.3.2-beta/js/wysiwyg/plugins/wysiwyg.fullscreen.js are identical
Files elefant-1.3.1-beta/js/wysiwyg/plugins/wysiwyg.i18n.js and elefant-1.3.2-beta/js/wysiwyg/plugins/wysiwyg.i18n.js are identical
diff -urBNs elefant-1.3.1-beta/lang/cs.php elefant-1.3.2-beta/lang/cs.php
--- elefant-1.3.1-beta/lang/cs.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/lang/cs.php	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,515 @@
+<?php
+
+$this->lang_hash['cs'] = array (
+	'You must select a date/time.' => ' Musíte vyplnit datum/čas.',
+	'- select -' => '- vybrat -',
+	'Alphabetical' => 'Abecedně',
+	'Admin' => 'Admin',
+	'Folder' => 'Adresář',
+	'Unable to create folder' => 'Adresář nelze vytvořit',
+	'Folder renamed.' => 'Adresář přejmenován.',
+	'Folder created.' => 'Adresář vytvořen.',
+	'Unable to delete folders' => 'Adresáře nelze vymazat',
+	'Blog Posts' => 'Aktuality',
+	'Current' => 'Aktuální',
+	'Current version' => 'Aktuální verze',
+	'Yes' => 'Ano',
+	'An app by this name is already installed.' => 'Aplikace s tímto názvem již existuje.',
+	'Could not unzip the file.' => 'Archiv nelze rozbalit.',
+	'Author' => 'Autor',
+	'Blog post added.' => 'Blogový příspěvek přidán.',
+	'Blog post saved.' => 'Blogový příspěvek uložen.',
+	'Blog post deleted.' => 'Blogový příspěvek vymazán.',
+	'Blocks' => 'Bloky',
+	'Powered by' => 'Běží na',
+	'Error' => 'Chyba',
+	'Verification failed: Repository or website required.' => 'Chyba ověření: Musíte vyplnit repozitář nebo web.',
+	'Verification failed: No configuration file found.' => 'Chyba ověření: Nebyl nalezen konfigurační soubor.',
+	'Verification failed: No folder specified' => 'Chyba ověření: Nebyl specifikován adresář.',
+	'Verification failed: No name specified' => 'Chyba ověření: Nebyl specifikován název.',
+	'Verification failed: No type specified.' => 'Chyba ověření: Nebyl specifikován typ.',
+	'Verification failed: No version specified.' => 'Chyba ověření: Nebyla specifikována verze.',
+	'Verification failed: Invalid configuration file.' => 'Chyba ověření: Neplatný konfigurační soubor.',
+	'Verification failed: Invalid folder name.' => 'Chyba ověření: Neplatný název adresáře.',
+	'Verification failed: Invalid type.' => 'Chyba ověření: Neplatný typ.',
+	'Error importing file' => 'Chyba při importu souboru',
+	'File upload failed' => 'Chyba při odesílání souboru',
+	'Failed to retrieve the file at the specified link.' => 'Chyba při stažení souboru.',
+	'File save failed' => 'Chyba při ukládání souboru',
+	'Saving Stylesheet Failed' => 'Chyba při ukládání souboru stylů',
+	'Saving Layout Failed' => 'Chyba při ukládání šablony',
+	'Failed to save...' => 'Chyba při ukládání...',
+	'Error uploading file.' => 'Chyba při uploadu souboru.',
+	'Connection Error' => 'Chyba připojení',
+	'Incorrect email or password, please try again.' => 'Chybný email nebo heslo, zkuste to prosím znovu...',
+	'Error message' => 'Chybová zpráva',
+	'Error Message' => 'Chybová zpráva',
+	'Missing property name' => 'Chybějící hodnota vlastnosti',
+	'Copyright' => 'Copyright',
+	'Next' => 'Další',
+	'Other pages' => 'Další stánky',
+	'Other versions' => 'Další verze',
+	'Database' => 'Databáze',
+	'Database Connection' => 'Databázové připojení',
+	'Database tables created and settings saved.' => 'Databázové tabulky úspěšně vytvořeny, nastavení uloženo.',
+	'Date' => 'Datum',
+	'Date/Time' => 'Datum a čas',
+	'Finished' => 'Dokončeno',
+	'Finish importing' => 'Dokončit import',
+	'Home' => 'Domů',
+	'Temporary' => 'Dočasné',
+	'Dynamic Objects' => 'Dynamické objekty',
+	'Length' => 'Délka',
+	'Thanks for using Elefant!' => 'Děkujeme, že používáte Elefant!',
+	'Important: Only install apps or themes from trusted sources.' => 'Důležité: Instalujte pouze témata a aplikace z důvěryhodných zdrojů.',
+	'Private' => 'Důvěrné',
+	'Admin Email' => 'E-mail administrátora',
+	'Elefant' => 'Elefant',
+	'Elefant homepage' => 'Elefant homepage',
+	'Elefant Installer' => 'Elefant instalátor',
+	'Email' => 'Email',
+	'Email address' => 'Emailová adresa',
+	'Export' => 'Export',
+	'Wordpress export file' => 'Export souboru Wordpress',
+	'Blogger export file' => 'Export souboru pro službu Blogger',
+	'Fallback' => 'Fallback',
+	'Photos by' => 'Fotografie od',
+	'Github installation failed' => 'Github instalace selhala',
+	'Password does not match.' => 'Hesla se neshodují.',
+	'Password' => 'Heslo',
+	'Admin Password' => 'Heslo administrátora',
+	'Password updated' => 'Heslo aktualizováno',
+	'Version history' => 'Historie verzí',
+	'You\'re done!' => 'Hotovo!',
+	'Done.' => 'Hotovo.',
+	'Multi-file uploader' => 'Hromadné odeslání',
+	'ID' => 'ID',
+	'Block ID' => 'ID bloku',
+	'Your ID must be a lowercase alphanumeric value and can\'t already exist. It must also not share the name of an app.' => 'ID musí být unikátní řetězec, povolena jsou jen malá písmena a nesmí se shodovat s názvem žádné aplikace.',
+	'Your ID must be a lowercase alphanumeric value and can\'t already exist.' => 'ID musí být unikátní řetězec, povolena jsou jen malá písmena.',
+	'Page ID' => 'ID stránky',
+	'Mark imported posts as published?' => 'Ihned publikovat importované příspěvky?',
+	'Wordpress importer' => 'Import souboru Wordpress',
+	'CSV Importer' => 'Import z CSV souboru',
+	'Blogger importer' => 'Import ze služby Blogger',
+	'Import as...' => 'Importovat jako...',
+	'Import Posts' => 'Importovat články',
+	'Indexing completed' => 'Indexování dokončeno',
+	'Info' => 'Informace',
+	'Table Info' => 'Informace o tabulce',
+	'Zip file installation failed' => 'Instalace ZIP souboru selhala',
+	'The installation process has been completed. Here are some links you may want to bookmark:' => 'Instalace byla dokončena. Zde můžete pokračovat:',
+	'Install completed' => 'Instalace dokončena',
+	'Install' => 'Instalovat',
+	'Install App/Theme' => 'Instalovat aplikaci/téma',
+	'Install another' => 'Instalovat další',
+	'Installer' => 'Instalátor',
+	'This installer will guide you through the process of installing and configuring your new website.' => 'Instalátor Vás provede instalací a nastavením Vašeho nového webu.',
+	'Language updated.' => 'Jazyk aktualizován.',
+	'Language added.' => 'Jazyk přidán.',
+	'Language deleted.' => 'Jazyk vymazán.',
+	'Go' => 'Jdi',
+	'Name' => 'Jméno',
+	'Click \'Next\' to continue.' => 'Klikněte na \'Další\' pro pokračování',
+	'Click \'Next\' to continue whenever you\'re ready. Thanks for using Elefant!' => 'Klikněte na \'Další\' pro pokračování. Děkujeme, že používáte Elefant!',
+	'Click to restore.' => 'Klikněte pro obnovení.',
+	'Click to update photo' => 'Klikněte pro změnu fotografie',
+	'Click here for instructions on configuring virtual hosts for development.' => 'Klikněte zde pro instrukce k nastavení virtuálních serverů ve vývojovém prostředí.',
+	'Click here to restore.' => 'Klikněte zde pro obnovení.',
+	'Click here for more information and translations of the MIT license.' => 'Klikněte zde pro podrobnosti a překlad MIT licence.',
+	'Key' => 'Klíč',
+	'Keywords (comma-separated)' => 'Klíčová slova (oddělená čárkou)',
+	'Configuration file not found.' => 'Konfigurační soubor nenalezen.',
+	'Which columns should be imported?' => 'Které sloupce chcete importovat?',
+	'Code' => 'Kód',
+	'Language code' => 'Kód jazyka',
+	'License' => 'Licence',
+	'Admin login' => 'Přihlášení správce',
+	'The MIT License' => 'MIT licence',
+	'Navigation' => 'Menu',
+	'Your password must be at least 6 characters.' => 'Minimální délka hesla je 6 znaků.',
+	'You must enter your name.' => 'Musíte vyplnit Vaše jméno.',
+	'You must enter an author.' => 'Musíte vyplnit autora.',
+	'You must enter an email address.' => 'Musíte vyplnit emailovou adresu.',
+	'You must enter a password.' => 'Musíte vyplnit heslo.',
+	'You must enter a name.' => 'Musíte vyplnit jméno.',
+	'You must enter body content.' => 'Musíte vyplnit obsah.',
+	'You must enter a valid email, or email not found.' => 'Musíte vyplnit platnou emailovou adresu.',
+	'You must enter a valid email, or your email may already be registered.' => 'Musíte vyplnit platnou emailovou adresu. Není tento email již registrován?',
+	'You must enter a block title.' => 'Musíte vyplnit titulek bloku.',
+	'You must enter a page title.' => 'Musíte vyplnit titulek stránky.',
+	'You must enter a title.' => 'Musíte vyplnit titulek.',
+	'An email has been sent with a link to reset your password.' => 'Na e-mail Vám byly zaslány instrukce pro reset hesla.',
+	'PHP PDO extension is missing.' => 'Na serveru chybí PDO rozšíření PHP.',
+	'Apache mod_rewrite extension must be installed.' => 'Na serveru musí být zapnutý mod_rewrite.',
+	'Please upload a zip file.' => 'Nahrajte prosím ZIP archiv.',
+	'Unable to parse the uploaded file.' => 'Nahraný soubor nelze zpracovat.',
+	'Upload' => 'Nahrát',
+	'Upload a zip file' => 'Nahrát ZIP archiv',
+	'Upload the CSV file' => 'Nahrát soubor CSV',
+	'Auto-saved data found.' => 'Nalezena neuložená data',
+	'An Error Occurred' => 'Nastala chyba',
+	'Settings' => 'Nastavení',
+	'Auto-post options' => 'Nastavení automatické publikace',
+	'Settings saved and admin user created.' => 'Nastavení bylo uloženo, admin uživatel vytvořen.',
+	'Language settings' => 'Nastavení jazyk',
+	'Site Settings' => 'Nastavení webu',
+	'Choose a password' => 'Nastavit heslo',
+	'Choose a new password' => 'Nastavit nové heslo',
+	'Make default' => 'Budiž výchozí',
+	'Our Organization' => 'Naše organizace',
+	'No' => 'Ne',
+	'Not found' => 'Nebylo nalezeno',
+	'No name specified' => 'Nebylo specifikováno jméno',
+	'Latest Posts' => 'Nejnovější příspěvky',
+	'Newest first' => 'Nejprve nejnovější',
+	'Oldest first' => 'Nejprve nejstarší',
+	'Not a member?' => 'Nejste členem?',
+	'Unable to rename' => 'Nelze přejmenovat',
+	'Unable to delete' => 'Nelze vymazat',
+	'Failed to write to conf/config.php' => 'Nelze zapisovat do souboru conf/config.php',
+	'Unable to write to apps folder.' => 'Nemohu zapisovat do adresáře apps.',
+	'Unable to write to cache folder.' => 'Nemohu zapisovat do adresáře cache.',
+	'Unable to write to layouts folder.' => 'Nemohu zapisovat do adresáře layouts.',
+	'Unable to fetch configuration file.' => 'Nemohu získat konfigurační soubor.',
+	'Unable to fetch file' => 'Nemohu získat soubor',
+	'No audio playback capabilities' => 'Není podpora přehrávání audia',
+	'No video playback capabilities' => 'Není podpora přehrávání videa',
+	'Invalid Path' => 'Neplatná cesta',
+	'Invalid location' => 'Neplatná umístění',
+	'Invalid name' => 'Neplatné jméno',
+	'Invalid Verifier' => 'Neplatné ověření',
+	'Invalid directory' => 'Neplatný adresář',
+	'Invalid or expired recovery link' => 'Neplatný nebo expirovaný odkaz k obnově',
+	'Invalid folder name' => 'Neplatný název adresáře',
+	'Invalid file name' => 'Neplatný název souboru',
+	'False' => 'Nepravda',
+	'Unknown error' => 'Neznámá chyba',
+	'Nobody' => 'Nikdo',
+	'Normal strength' => 'Normální síla',
+	'New page' => 'Nová stránka',
+	'New Layout' => 'Nová šablona',
+	'New password' => 'Nové heslo',
+	'New folder' => 'Nový adresář',
+	'New Post' => 'Nový příspěvek',
+	'New file' => 'Nový soubor',
+	'New Stylesheet' => 'Nový soubor stylů',
+	'New User' => 'Nový uživatel',
+	'Newer items' => 'Novější položky',
+	'Newer posts' => 'Novější příspěvky',
+	'Newer results' => 'Novější výsledky',
+	'Null' => 'Null',
+	'Preview' => 'Náhled',
+	'Preview with layout' => 'Náhled se šablonou',
+	'Tools' => 'Nástroje',
+	'Alternate menu title' => 'Název v menu',
+	'Site Name' => 'Název webu',
+	'Password recovery' => 'Obnova hesla',
+	'Restore' => 'Obnovit',
+	'Body' => 'Obsah',
+	'Content' => 'Obsah',
+	'Contains text...' => 'Obsahuje text...',
+	'Submit' => 'Odeslat',
+	'Send verification' => 'Odeslat ověření',
+	'Log out' => 'Odhlásit',
+	'Link to a zip file or Github repository' => 'Odkaz na ZIP archiv nebo Github repozitář',
+	'The link appears to be invalid.' => 'Odkaz není platný.',
+	'Limit to source file' => 'Omezit zdrojový soubor',
+	'Are you sure you want to cancel and lose any changes?' => 'Opravdu chcete nenávratně zrušit provedené změny?',
+	'Are you sure you want to delete this block?' => 'Opravdu chcete vymazat tento blok?',
+	'Are you sure you want to delete this language?' => 'Opravdu chcete vymazat tento jazyk?',
+	'Are you sure you want to delete this post?' => 'Opravdu chcete vymazat tento článek?',
+	'Are you sure you want to delete this user?' => 'Opravdu chcete vymazat tohoto uživatele?',
+	'Are you sure you want to delete this page?' => 'Opravdu chcete vymazat tuto stránku?',
+	'Are you sure you want to delete the current page?' => 'Opravdu chcete vymazat zobrazenou stránku?',
+	'Are you sure you want to delete the current block?' => 'Opravdu chcete vymazat zobrazený blok?',
+	'Are you sure you want to cancel?' => 'Opravdu zrušit?',
+	'Are you sure you want to permanently delete this stylesheet file?' => 'Opravdu chcete nenávratně smazat tento soubor se styly?',
+	'Are you sure you want to permanently erase this table?' => 'Opravdu chcete nenávratně smazat tuto tabulku?',
+	'Are you sure you want to permanently delete this layout file?' => 'Opravdu chcete nenávratně smazat tuto šablonu?',
+	'Please correct the problem and try again.' => 'Opravte prosím problém a zkuste to znovu.',
+	'Driver' => 'Ovladač',
+	'Verify Password' => 'Ověřit heslo',
+	'Verify password' => 'Ověřit heslo',
+	'Verify new password' => 'Ověřit nové heslo',
+	'Check that your permissions are correct and try again.' => 'Ověřte, zda máte dostatečná oprávnění, a zkuste to znovu.',
+	'Permanent (best for SEO)' => 'Pernamentní (kód 301, dobré pro SEO)',
+	'Continue' => 'Pokračovat',
+	'Extra' => 'Pokročilé',
+	'Extra Options' => 'Pokročilé nastavení',
+	'Field' => 'Pole',
+	'Auto-incrementing field' => 'Pole s automatickým číslováním',
+	'Item Updated' => 'Položka aktualizována',
+	'Item Added' => 'Položka přidána',
+	'Item Deleted' => 'Položka vymazána',
+	'Description' => 'Popis',
+	'Compare to current' => 'Porovnat s aktuálním stavem',
+	'Comparing' => 'Porovnání',
+	'Port' => 'Port',
+	'Last changed' => 'Poslední změna',
+	'Last modified' => 'Poslední úprava',
+	'Last Modified' => 'Poslední úprava',
+	'Note: Pages that are not publicly visible will not be listed here.' => 'Poznámka: Neveřejné stránky zde nebudou zobrazeny.',
+	'Count' => 'Počet',
+	'Requirements' => 'Požadavky',
+	'The page you requested could not be found.' => 'Požadovaná stránka nebyla nalezena.',
+	'True' => 'Pravda',
+	'Please log in to continue.' => 'Pro pokračování se prosím přihlašte.',
+	'Browse' => 'Procházet',
+	'Profile Updated' => 'Profil aktualizován',
+	'Please wait, this may take a minute...' => 'Prosím čekejte, může to chvilku trvat...',
+	'Please confirm your email address' => 'Prosím, potvrďte svou emailovou adresu',
+	'Published' => 'Publikováno',
+	'Drop' => 'Pustit',
+	'Previous' => 'Předchozí',
+	'Introduction' => 'Představení',
+	'Rename' => 'Přejmenovat',
+	'Language' => 'Překlad',
+	'Languages' => 'Překlady',
+	'Too many login attempts' => 'Překročen limit neplatných pokusů o přihlášení',
+	'Translated' => 'Přeloženo',
+	'Drag and drop pages to organize your navigation.' => 'Přetažením položek nastavte strukturu menu.',
+	'Drag these pages to the site tree to include them in your navigation.' => 'Přetažením položky zařadíte do menu.',
+	'Drag pages here to remove them from the tree.' => 'Přetažením sem položky odstraníte z menu.',
+	'If you have any trouble during the install process, please visit the Elefant project at the following link to report it, and we\'ll do our best to help.' => 'Při problémech s instalací neváhejte navštívit homepage projektu, kde Vám rádi poradíme.',
+	'Add' => 'Přidat',
+	'Add Block' => 'Přidat blok',
+	'Add language' => 'Přidat jazyk',
+	'Add Item' => 'Přidat položku',
+	'Add Page' => 'Přidat stránku',
+	'Add User' => 'Přidat uživatele',
+	'Add Blog Post' => 'Přidat článek',
+	'Sign in with' => 'Přihlásit přes',
+	'Sign in' => 'Přihlášení',
+	'Connect & Create Schema' => 'Připojit a vytvořit schéma',
+	'Connect &amp; Create Schema' => 'Připojit a vytvořit schéma',
+	'Too weak' => 'Příliš snadné',
+	'Access' => 'Přístup',
+	'Original text' => 'Původní text',
+	'Elefant\'s CMS was designed to run a complete website, and needs to be installed in the root of a site to function correctly. Please move Elefant to the root folder to continue, or use a sub-domain of your site to install it under.' => 'Redakční systém Elefant musí být pro správný běh nainstalován v hlavním adresáři (rootu) webu. Prosím přesuňte instalaci do rootu webu, nebo pro instalaci použijte subdoménu.',
+	'Sign Up' => 'Registrace',
+	'Sign up here' => 'Registrace zde',
+	'Reset Password' => 'Reset hesla',
+	'Rebuild index' => 'Resetovat index',
+	'Rebuilding index' => 'Resetuji index',
+	'SQL Shell' => 'SQL konzole',
+	'Server' => 'Server',
+	'One or more server requirements failed' => 'Server nesplňuje minimální požadavky',
+	'Server requirements have been verified.' => 'Server splňuje požadavky pro běh.',
+	'Strong password' => 'Silné heslo',
+	'Weak password' => 'Slabé heslo',
+	'Column' => 'Sloupec',
+	'File already exists' => 'Soubor již existuje',
+	'File Already Exists' => 'Soubor již existuje',
+	'File not found' => 'Soubor nebyl nalezen',
+	'Unable to save the file.' => 'Soubor nelze uložit',
+	'Unable to Delete File' => 'Soubor nelze vymazat',
+	'File renamed.' => 'Soubor přejmenován.',
+	'A file by that name already exists.' => 'Soubor s tímto jménem již existuje.',
+	'Stylesheet' => 'Soubor stylů',
+	'Stylesheet added.' => 'Soubor stylů přidán.',
+	'Stylesheet saved.' => 'Soubor stylů uložen.',
+	'File saved.' => 'Soubor uložen.',
+	'File deleted.' => 'Soubor vymazán.',
+	'File:' => 'Soubor:',
+	'Files' => 'Soubory',
+	'Assets will recompile on the next page load.' => 'Soubory se překompilují při dalším načtení stránky.',
+	'Stylesheets' => 'Soubory stylů',
+	'Cached files' => 'Soubory z cache',
+	'I Agree' => 'Souhlasím',
+	'File Manager' => 'Správce souborů',
+	'Execute' => 'Spustit',
+	'Older items' => 'Starší položky',
+	'Older posts' => 'Starší příspěvky',
+	'Older results' => 'Starší výsledky',
+	'Site tree' => 'Struktura webu',
+	'Page not found' => 'Stránka nebyla nalezena',
+	'Page saved.' => 'Stránka uložena.',
+	'Page deleted.' => 'Stránka vymazána',
+	'Page created.' => 'Stránka vytvořena',
+	'Hmm, we can\'t seem to find the page you wanted at the moment.' => 'Stránku se nepodařilo zobrazit',
+	'All Pages' => 'Stránky',
+	'Light' => 'Světlý',
+	'Table' => 'Tabulka',
+	'Table Dropped' => 'Tabulka odstraněna',
+	'Tags' => 'Tagy',
+	'Tags (comma-separated)' => 'Tagy (odděleno čárkou)',
+	'This page forwards visitors to the following link' => 'Tato stránka přesměruje návštěvníky na',
+	'The following theme has been installed:' => 'Tato témata byla nainstalována:',
+	'Folder already exists' => 'Tento adresář již existuje',
+	'The language code entered already exists.' => 'Tento kód jazyka již existuje.',
+	'This object is already being edited by' => 'Tento objekt již upravuje uživatel',
+	'Testing Requirements' => 'Testuji požadavky',
+	'Title' => 'Titulek',
+	'Block title' => 'Titulek bloku',
+	'Page title' => 'Titulek stránky',
+	'Alternate window title' => 'Titulek stránky',
+	'Dark' => 'Tmavý',
+	'This is a preview of how your layout will look.' => 'Toto je ukázka, jak bude šablona vypadat.',
+	'Type' => 'Typ',
+	'User type' => 'Typ uživatele',
+	'The following app has been installed:' => 'Tyto aplikace byly nainstalovány:',
+	'A theme by this name is already installed.' => 'Téma s tímto názvem je už nainstalováno.',
+	'Saving...' => 'Ukládám...',
+	'Saved!' => 'Uloženo!',
+	'Save' => 'Uložit',
+	'Save &amp; Keep Editing' => 'Uložit a pokračovat v úpravách',
+	'Save Block' => 'Uložit blok',
+	'Save Settings' => 'Uložit nastavení',
+	'Save Item' => 'Uložit položku',
+	'Save Blog Post' => 'Uložit příspěvek',
+	'Save Stylesheet' => 'Uložit soubor stylů',
+	'Save Page' => 'Uložit stránku',
+	'Save User' => 'Uložit uživatele',
+	'Save Layout' => 'Uložit šablonu',
+	'Upgrade completed' => 'Upgrade dokončen',
+	'Upgrading Blog App' => 'Upgraduji aplikaci Blog',
+	'Upgrading Files App' => 'Upgraduji aplikaci Soubory',
+	'Upgrading User App' => 'Upgraduji aplikaci Uživatelé',
+	'Uploaded CSV file not found.' => 'Uploadované CSV nebylo nalezeno.',
+	'Edit' => 'Upravit',
+	'Edit Block' => 'Upravit blok',
+	'Edit Profile' => 'Upravit profil',
+	'Update Profile' => 'Upravit profil',
+	'Edit page' => 'Upravit stránku',
+	'Edit Page' => 'Upravit stránku',
+	'Edit Stylesheet' => 'Upravit styly',
+	'Edit User' => 'Upravit uživatele',
+	'Edit Blog Post' => 'Upravit zápisek',
+	'Edit Layout' => 'Upravit šablonu',
+	'User added.' => 'Uživatel přidán.',
+	'User saved.' => 'Uživatel uložen.',
+	'User deleted.' => 'Uživatel vymazán.',
+	'Username' => 'Uživatelské jméno',
+	'Users' => 'Uživatelé',
+	'SQLite users can simply click \'Connect & Create Schema\'. MySQL users please select your driver and enter your server details to continue.' => 'Uživatelé SQLite nemusí nic vyplňovat. U MySQL je třeba vybrat ovladač a vypsat údaje pro připojení.',
+	'SQLite users can simply click \'Connect &amp; Create Schema\'. MySQL users please select your driver and enter your server details to continue.' => 'Uživatelé SQLite nemusí nic vyplňovat. U MySQL je třeba vybrat ovladač a vypsat údaje pro připojení.',
+	'Your ID must be a lowercase alphanumeric value. It must also not share the name of an app.' => 'V ID jsou povolena jen malá písmena a nesmí se shodovat s názvem žádné aplikace.',
+	'Your ID must be a lowercase alphanumeric value.' => 'V ID jsou povolena jen malá písmena.',
+	'.htaccess file is missing from the site root. Please save the following file to your server:' => 'V adresáři webu chybí soubor .htaccess, následující soubor prosím nahrajte na server:',
+	'Auto-saved data found for this form.' => 'V databázi byla nalezena neuložená data z tohoto formuláře.',
+	'Your Name' => 'Vaše jméno',
+	'Your name' => 'Vaše jméno',
+	'Your name must be alphanumeric and not a duplicate of an existing layout.' => 'Ve jménu jsou povolena jen písmena a číslice a nesmí se shodovat s názvem existující šablony.',
+	'Your name must be alphanumeric and not a duplicate of an existing stylesheet.' => 'Ve jménu jsou povolena jen písmena a číslice a nesmí se shodovat s názvem existujícího souboru stylů.',
+	'File Size' => 'Velikost souboru',
+	'File size' => 'Velikost souboru',
+	'File size (pre-gzip)' => 'Velikost souboru (před kompresí)',
+	'Very strong password' => 'Velmi silné heslo',
+	'Versions' => 'Verze',
+	'PHP version must be 5.3+' => 'Verze PHP musí být 5.3 a vyšší.',
+	'Versions of' => 'Verze z',
+	'Public' => 'Veřejné',
+	'Properties' => 'Vlastnosti',
+	'Properties saved.' => 'Vlastnosti uloženy.',
+	'Embedded' => 'Vložené',
+	'Insert tag' => 'Vložit tag',
+	'Choose an importer' => 'Vyberte druh importu',
+	'Please enter the language code.' => 'Vyberte prosím kód jazyka.',
+	'Please enter the name of the language.' => 'Vyberte prosím název jazyka.',
+	'Please enter the character set.' => 'Vyberte prosím znakovou sadu.',
+	'The layout you entered doesn\'t exist.' => 'Vybraná šablona neexistuje.',
+	'Generated on' => 'Vygenerováno',
+	'Check your host for instructions on setting up sub-domains in production.' => 'Vyhledejte instrukce k nastavení subdomén v produkčním prostředí.',
+	'Delete' => 'Vymazat',
+	'Delete Block' => 'Vymazat blok',
+	'Delete Page' => 'Vymazat stránku',
+	'It looks like you\'re trying to install Elefant into a sub-folder.' => 'Vypadá to, že chcete instalovat Elefant do podadresáře.',
+	'Please enter a name for your stylesheet.' => 'Vyplňte prosím název souboru se styly.',
+	'Please enter a name for your layout.' => 'Vyplňte prosím název šablony.',
+	'Please enter a link or upload a file.' => 'Vyplňte prosím odkaz nebo nahrajte soubor.',
+	'Create Stylesheet' => 'Vytvořit soubor stylů',
+	'Create Layout' => 'Vytvořit šablonu',
+	'Building index' => 'Vytvářím index',
+	'Clear' => 'Vyčistit',
+	'Admin access required.' => 'Vyžadován administrátorský přístup.',
+	'Authorization required.' => 'Vyžadována autorizace.',
+	'Login required' => 'Vyžadováno přihlášení',
+	'Designer' => 'Vzhled',
+	'Your website' => 'Váš web',
+	'Welcome to the Elefant CMS installer.' => 'Vítá Vás instalátor redakčního systému Elefant.',
+	'Default' => 'Výchozí',
+	'Default language updated.' => 'Výchozí jazyk aktualizován.',
+	'Default layout updated.' => 'Výchozí šablona aktualizována.',
+	'All pages' => 'Všechny stránky',
+	'All tags' => 'Všechny tagy',
+	'Website' => 'Web',
+	'Zip file was invalid or could not be installed.' => 'ZIP soubor byl poškozen a nemohl být nainstalován',
+	'Your password doesn\'t match.' => 'Zadaná hesla nejsou stejná.',
+	'Forgot your password?' => 'Zapomněli jste heslo?',
+	'Source' => 'Zdroj',
+	'Check your inbox' => 'Zkontrolujte svoji poštu',
+	'Please try again later.' => 'Zkuste to prosím znovu.',
+	'Try Again' => 'Zkuste to znovu',
+	'Change password' => 'Změnit heslo',
+	'Changed on' => 'Změněno',
+	'Charset' => 'Znak',
+	'Character set' => 'Znaková sada',
+	'Visit your new website' => 'Zobrazit Váš nový web',
+	'View current' => 'Zobrazit aktuální',
+	'View profile' => 'Zobrazit profil',
+	'Display title' => 'Zobrazit titulek',
+	'Show versions' => 'Zobrazit verze',
+	'Visit your website.' => 'Zobrazit web.',
+	'Back' => 'Zpět',
+	'Back to posts' => 'Zpět na příspěvky',
+	'Cancel' => 'Zrušit',
+	'Choose a password for your new account.' => 'Zvolte heslo pro Váš nový účet.',
+	'by' => 'autor',
+	'apps folder is not writeable. Please run:</p><p><tt>chmod 775 apps</tt>' => 'do adresáře apps nelze zapisovat. Prosím spusťte:</p><p><tt>chmod 775 apps</tt>',
+	'cache folder is not writeable. Please run:</p><p><tt>chmod -R 775 cache conf css files lang layouts</tt>' => 'do adresáře cache nelze zapisovat. Prosím spusťte tento příkaz:</p><p><tt>chmod -R 775 cache conf css files lang layouts</tt>',
+	'cache folder is not writeable. Please run:</p><p><tt>chmod -R 777 cache conf css files install layouts</tt>' => 'do adresáře cache nelze zapisovat. Spusťte prosím tento příkaz:</p><p><tt>chmod -R 777 cache conf css files install layouts</tt>',
+	'conf folder is not writeable. Please run:</p><p><tt>chmod -R 777 cache conf css files install layouts</tt>' => 'do adresáře conf nelze zapisovat. Spusťte prosím tento příkaz:</p><p><tt>chmod -R 777 cache conf css files install layouts</tt>',
+	'conf folder is not writeable. Please run:</p><p><tt>chmod -R 775 cache conf css files lang layouts</tt>' => 'do adresáře conf nelze zapisovat. Spusťte prosím tento příkaz:</p><p><tt>chmod -R 775 cache conf css files lang layouts</tt>',
+	'css folder is not writeable. Please run:</p><p><tt>chmod -R 777 cache conf css files install layouts</tt>' => 'do adresáře css nelze zapisovat. Spusťte prosím tento příkaz:</p><p><tt>chmod -R 777 cache conf css files install layouts</tt>',
+	'css folder is not writeable. Please run:</p><p><tt>chmod -R 775 cache conf css files lang layouts</tt>' => 'do adresáře css nelze zapisovat. Spusťte prosím tento příkaz:</p><p><tt>chmod -R 775 cache conf css files lang layouts</tt>',
+	'files folder is not writeable. Please run:</p><p><tt>chmod -R 777 cache conf css files install layouts</tt>' => 'do adresáře files nelze zapisovat. Spusťte prosím tento příkaz:</p><p><tt>chmod -R 777 cache conf css files install layouts</tt>',
+	'files folder is not writeable. Please run:</p><p><tt>chmod -R 775 cache conf css files lang layouts</tt>' => 'do adresáře files nelze zapisovat. Spusťte prosím tento příkaz:</p><p><tt>chmod -R 775 cache conf css files lang layouts</tt>',
+	'install folder is not writeable. Please run:</p><p><tt>chmod -R 777 cache conf css files install layouts</tt>' => 'do adresáře install nelze zapisovat. Spusťte prosím tento příkaz:</p><p><tt>chmod -R 777 cache conf css files install layouts</tt>',
+	'lang folder is not writeable. Please run:</p><p><tt>chmod -R 775 cache conf css files lang layouts</tt>' => 'do adresáře lang nelze zapisovat. Spusťte prosím tento příkaz:</p><p><tt>chmod -R 775 cache conf css files lang layouts</tt>',
+	'layouts folder is not writeable. Please run:</p><p><tt>chmod -R 777 cache conf css files install layouts</tt>' => 'do adresáře layouts nelze zapisovat. Spusťte prosím tento příkaz:</p><p><tt>chmod -R 777 cache conf css files install layouts</tt>',
+	'layouts folder is not writeable. Please run:</p><p><tt>chmod -R 775 cache conf css files lang layouts</tt>' => 'do adresáře layouts nelze zapisovat. Spusťte prosím tento příkaz:</p><p><tt>chmod -R 775 cache conf css files lang layouts</tt>',
+	'click to install' => 'klikněte pro instalaci',
+	'click to upgrade' => 'klikněte pro upgrade',
+	'comments' => 'komentáře',
+	'Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec' => 'led úno bře dub kvě čer čec srp zář říj lis pro',
+	'January February March April May June July August September October November December' => 'leden únor březen duben květen červen červenec srpen září říjen listopad prosinec',
+	'max' => 'maximálně',
+	'or' => 'nebo',
+	'official blog' => 'oficiální blog',
+	'optional' => 'volitelné',
+	'results' => 'výsledky',
+	'Editing Item' => 'Úprava položky',
+	'Editing language' => 'Úprava překladu',
+	'Done editing' => 'Úpravy dokončeny',
+	'Editing Locked' => 'Úpravy jsou uzamčeny',
+	'Account Verified' => 'Účet byl ověřen',
+	'Member' => 'Člen',
+	'Members' => 'Členové',
+	'Layout' => 'Šablona',
+	'Layout added.' => 'Šablona přidána.',
+	'Page layout' => 'Šablona stránky',
+	'Layout saved.' => 'Šablona uložena.',
+	'Layouts' => 'Šablony',
+	'No posts yet... :(' => 'Žádné příspěvky',
+	'None' => 'Žádný',
+	'All Events' => 'Všechny události',
+	'When' => 'Kdy',
+	'Where' => 'Kde',
+	'Contact' => 'Kontakt',
+	'show map' => 'zobrazit mapu',
+	'Events' => 'Kalendář',
+	'Event title' => 'Název události',
+	'Add Event' => 'Přidat událost',
+	'Date' => 'Datum',
+	'Ends' => 'Konec',
+	'Time' => 'Čas',
+	'Details' => 'Podrobnosti',
+	'Address' => 'Adresa',
+	'City' => 'Město',
+	'Contact' => 'Kontakt',
+	'Phone' => 'Telefon',
+	'Save event' => 'Uložit událost',
+	'Edit Event' => 'Upravit událost'
+);
+?>
\ No newline at end of file
Files elefant-1.3.1-beta/lang/en.php and elefant-1.3.2-beta/lang/en.php are identical
Files elefant-1.3.1-beta/lang/fr.php and elefant-1.3.2-beta/lang/fr.php are identical
Files elefant-1.3.1-beta/lang/ja.php and elefant-1.3.2-beta/lang/ja.php are identical
diff -urBNs elefant-1.3.1-beta/lang/languages.php elefant-1.3.2-beta/lang/languages.php
--- elefant-1.3.1-beta/lang/languages.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/lang/languages.php	2012-09-13 09:15:24.000000000 -0500
@@ -1,47 +1,83 @@
-; <?php /*
-
-[en]
-
-name                    = English
-code                    = en
-locale                  = Off
-charset                 = UTF-8
-fallback                = Off
-default                 = On
-
-[fr]
-
-name                    = "Français"
-code                    = fr
-locale                  = Off
-charset                 = UTF-8
-fallback                = Off
-default                 = Off
-
-[ja]
-
-name                    = "日本語"
-code                    = ja
-locale                  = Off
-charset                 = UTF-8
-fallback                = Off
-default                 = Off
-
-[nl]
-
-name                    = Nederlands
-code                    = nl
-charset                 = UTF-8
-fallback                = Off
-default                 = Off
-
-[zh]
-
-name                    = "简体中文"
-code                    = zh
-locale                  = Off
-charset                 = UTF-8
-fallback                = Off
-default                 = Off
-
+; <?php /*
+
+[en]
+
+name                    = English
+code                    = en
+locale                  = Off
+charset                 = UTF-8
+fallback                = Off
+default                 = On
+
+[fr]
+
+name                    = "Français"
+code                    = fr
+locale                  = Off
+charset                 = UTF-8
+fallback                = Off
+default                 = Off
+
+[nl]
+
+name                    = Nederlands
+code                    = nl
+charset                 = UTF-8
+fallback                = Off
+default                 = Off
+
+[cs]
+
+name                    = "Česky"
+code                    = cs
+charset                 = UTF-8
+fallback                = Off
+default                 = Off
+locale                  = Off
+date_format             = d.mmmm yyyy
+short_format            = dd.mm.yyyy
+time_format             = "HH:MM"
+
+[ru]
+
+name                    = "Русский"
+code                    = ru
+locale                  = Off
+charset                 = UTF-8
+fallback                = Off
+default                 = Off
+date_format             = dd mmmm yyyy
+short_format            = dd mmm
+time_format             = "HH:MM"
+
+[uk]
+
+name                    = "Українська"
+code                    = uk
+locale                  = Off
+charset                 = UTF-8
+fallback                = Off
+default                 = Off
+date_format             = dd mmmm yyyy
+short_format            = dd mmm
+time_format             = "HH:mm"
+
+[ja]
+
+name                    = "日本語"
+code                    = ja
+locale                  = Off
+charset                 = UTF-8
+fallback                = Off
+default                 = Off
+
+[zh]
+
+name                    = "简体中文"
+code                    = zh
+locale                  = Off
+charset                 = UTF-8
+fallback                = Off
+default                 = Off
+
 ; */ ?>
\ No newline at end of file
Files elefant-1.3.1-beta/lang/new_lang.php and elefant-1.3.2-beta/lang/new_lang.php are identical
Files elefant-1.3.1-beta/lang/nl.php and elefant-1.3.2-beta/lang/nl.php are identical
diff -urBNs elefant-1.3.1-beta/lang/ru.php elefant-1.3.2-beta/lang/ru.php
--- elefant-1.3.1-beta/lang/ru.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/lang/ru.php	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,7 @@
+<?php
+
+$this->lang_hash['ru'] = array (
+	'Nobody' => '(никто)',	'Auto-saved data found for this form.' => 'Авто-сохраненные данные найдены для этой формы.',	'Author' => 'Автор',	'Email address' => 'Адрес электронной почты',	'Alternate menu title' => 'Альтернативное название меню',	'Alternate window title' => 'Альтернативное название окна',	'Drag these pages to the site tree to include them in your navigation.' => 'Берите эти страницы мышкой чтобы включить их в дерево сайта.',	'Blocks' => 'Блоки',	'Drag pages here to remove them from the tree.' => 'Бросте страницу сюда чтобы удалить из дерева.',	'Alphabetical' => 'В алфавитном порядке',	'Your password must be at least 6 characters.' => 'Ваш пароль должен быть не короче 6 символов.',	'Your password doesn\'t match.' => 'Ваш пароль не совпал.',	'Your name' => 'Ваше имя',	'Website' => 'Вебсайт',	'Versions' => 'Версии',	'Versions of' => 'Версии',	'Sign in' => 'Войти',	'Restore' => 'Востановить',	'Reset Password' => 'Востановить пароль',	'Password recovery' => 'Востановление пароля',	'Temporary' => 'Временный',	'All Pages' => 'Все страницы',	'Sign in with' => 'Вход с',	'You must enter an email address.' => 'Вы должны ввести адрес электронной почты.',	'You must enter a page title.' => 'Вы должны ввести заголовое страницы.',	'You must enter a name.' => 'Вы должны ввести имя.',	'You must enter your name.' => 'Вы должны ввести имя.',	'You must enter body content.' => 'Вы должны ввести контент страницы.',	'You must enter a block title.' => 'Вы должны ввести название блока.',	'You must enter a password.' => 'Вы должны ввести пароль.',	'You must enter a valid email, or email not found.' => 'Вы должны ввести рабочий адрес или адрес не найден.',	'You must enter a valid email, or your email may already be registered.' => 'Вы должны ввести рабочий адрес или адрес уже зарегистрирован.',	'Are you sure you want to cancel and lose any changes?' => 'Вы уверенны что хотите прервать и потерять изменения?',	'Are you sure you want to delete this block?' => 'Вы уверенны что хотите удалить этот блок?',	'Are you sure you want to delete the current page?' => 'Вы уверенны, что хотите удалить текущую страницу?',	'Are you sure you want to delete this page?' => 'Вы уверены что хотите удалить эту страницу?',	'Are you sure you want to delete the current block?' => 'Вы хотите удалить текущий блок?',	'Are you sure you want to delete this user?' => 'Вы хотите удалить этого пользователя?',	'Are you sure you want to delete this language?' => 'Вы хртите удалить язык?',	'Choose a new password' => 'Выберите новый пароль',	'Choose a password' => 'Выберите пароль',	'Choose a password for your new account.' => 'Выберите пароль для нового пользователя.',	'Log out' => 'Выход',	'Yes' => 'Да',	'Date' => 'Дата',	'Site tree' => 'Дерево вебсайта',	'Page layout' => 'Дизайн страницы',	'The layout you entered doesn\'t exist.' => 'Дизайн страницы не найден.',	'Dynamic Objects' => 'Динамические объекты',	'Add' => 'Добавить',	'Add Block' => 'Добавить блок',	'Add User' => 'Добавить пользователя',	'Add Page' => 'Добавить страницу',	'Add language' => 'Добавить язык',	'Extra Options' => 'Дополнительные опции',	'Access' => 'Доступ',	'Other versions' => 'Другие версии',	'Other pages' => 'Другие страницы',	'Forgot your password?' => 'Забыли пароль?',	'Page title' => 'Заголовок страницы',	'Upload' => 'Загрузить',	'Done editing' => 'Закончить редактирование',	'The page you requested could not be found.' => 'Запрашиваемая страница не найдена',	'ID' => 'Идентификатор',	'Block ID' => 'Идентификатор блока',	'Your ID must be a lowercase alphanumeric value and can\'t already exist.' => 'Идентификатор блока должен быть введен малыми буквами латыницы и не должен уже использоваться.',	'Your ID must be a lowercase alphanumeric value.' => 'Идентификатор блока должен быть введен малыми буквами латыницы.',	'Page ID' => 'Идентификатор страницы',	'Your ID must be a lowercase alphanumeric value and can\'t already exist. It must also not share the name of an app.' => 'Идентификатор страницы должен быть введен малыми буквами латыницы и не должен уже использоваться. Также он не должен совпадать с именем аппликации.',	'Your ID must be a lowercase alphanumeric value. It must also not share the name of an app.' => 'Идентификатор страницы должен быть введен малыми буквами латыницы. Также он не должен совпадать с именем аппликации.',	'Changed on' => 'Изменено',	'Name' => 'Имя',	'No name specified' => 'Имя не указано',	'Building index' => 'Индексация',	'Indexing completed' => 'Индексация закончена',	'Tools' => 'Инструменты',	'Go' => 'Искать',	'Source' => 'Источник',	'Keywords (comma-separated)' => 'Ключевые слова (разделенные запятой)',	'Code' => 'Код',	'Language code' => 'Код языка',	'Body' => 'Контент',	'File Manager' => 'Менежер файлов',	'Navigation' => 'Навигация',	'Click here to restore.' => 'Нажмите тут чтобы востановить.',	'Click to update photo' => 'Нажмите чтобы обновить фото',	'Back' => 'Назад',	'Title' => 'Название',	'Block title' => 'Название блока',	'Settings' => 'Настройки',	'Language settings' => 'Настройки языка',	'Home' => 'Начальная страница',	'Not a member?' => 'Не зарегистрированы?',	'Not found' => 'Не найден',	'Unable to rename' => 'Невожможно переименовать',	'Unable to create folder' => 'Невозможно создать папку',	'Unable to save the file.' => 'Невозможно сохранить файл.',	'Unable to delete' => 'Невозможно удалить',	'Unable to delete folders' => 'Невозможно удалить папку',	'Unknown error' => 'Неизвестная ошибка',	'Invalid directory' => 'Неправильна директория',	'Invalid location' => 'Неправильная локация',	'Invalid name' => 'Неправильное имя',	'Invalid folder name' => 'Неправильное имя папки',	'Invalid file name' => 'Неправильное имя файла',	'Invalid or expired recovery link' => 'Неправильный или прослоченый линк для востановления пароля',	'Incorrect email or password, please try again.' => 'Неправильный почтовый адрес или пароль. Попробуйте еще раз.',	'Invalid Path' => 'Неправильный путь',	'No' => 'Нет',	'No audio playback capabilities' => 'Нет возможности воспроизвести аудио-файл',	'No video playback capabilities' => 'Нет возможности воспроизвести видео-файл.',	'No file uploaded or file too large.' => 'Нет файла для загрузки или файл очень большой.',	'No file was uploaded.' => 'Никакой файл не был загружен.',	'New folder' => 'Новая папка',	'Newest first' => 'Новее сначала',	'New password' => 'Новый пароль',	'New User' => 'Новый пользователь',	'New file' => 'Новый файл',	'Change password' => 'Обновить пароль',	'Update Profile' => 'Обновить профиль',	'Upgrade completed' => 'Обновление завершено',	'Limit to source file' => 'Ограничить источником',	'Description' => 'Описание',	'Original text' => 'Оригинальный текст',	'Cancel' => 'Отмена',	'Submit' => 'Отправить',	'Too many login attempts' => 'Очень много попыток входа',	'Clear' => 'Очистить',	'Folder' => 'Папка',	'Folder renamed.' => 'Папка переименована.',	'Folder created.' => 'Папка создана.',	'Password' => 'Пароль',	'Password updated' => 'Пароль обновлен',	'Translated' => 'Переведено',	'Rename' => 'Переименовать',	'Rebuilding index' => 'Переиндексация',	'Rebuild index' => 'Переиндексировать',	'Please log in to continue.' => 'Пожалуйста войдите для продолжения.',	'Please confirm your email address' => 'Пожалуйста подтвердите ваш электронный адрес',	'Please try again later.' => 'Пожалуйста, попробуйте попозже.',	'Show versions' => 'Показать версии',	'Show all fields' => 'Показать все поля',	'Show empty fields' => 'Показать пустые поля',	'Display title' => 'Показывать название',	'Field' => 'Поле',	'Users' => 'Пользователи',	'User added.' => 'Пользователь добавлен.',	'User saved.' => 'Пользователь сохранен.',	'User deleted.' => 'Пользователь удален.',	'Send verification' => 'Послать верификацию',	'Last changed' => 'Последнее изменение',	'Last modified' => 'Последнее изменение',	'View current' => 'Посмотреть текущую',	'Oldest first' => 'Постарше сначала',	'Permanent (best for SEO)' => 'Постоянный',	'Email' => 'Почтовый адрес',	'Private' => 'Приватно',	'Note: Pages that are not publicly visible will not be listed here.' => 'Примечание: Отображены только страницы доступные публично.',	'Verify new password' => 'Проверить новый пароль',	'Verify password' => 'Проверить пароль',	'Check your inbox' => 'Проверьте Ваш почтовый ящик',	'Continue' => 'Продолжить',	'An Error Occurred' => 'Произошла ошибка',	'Missing property name' => 'Пропущено имя свойства',	'Browse' => 'Просмотр',	'Preview' => 'Просмотр',	'Visit your website.' => 'Просмотреть Ваш вебсайт.',	'View profile' => 'Просотреть профиль',	'Profile Updated' => 'Профиль обновлен',	'Public' => 'Публично',	'File size' => 'Размер файла',	'Sign Up' => 'Регистрация',	'Sign up here' => 'Регистрация здесь',	'Account Verified' => 'Регистрация проверена',	'Editing Locked' => 'Редактирование блокировано',	'Edit' => 'Редактировать',	'Edit Block' => 'Редактировать блок',	'Edit User' => 'Редактировать пользователя',	'Edit Profile' => 'Редактировать профиль',	'Edit Page' => 'Редактировать страницу',	'Editing language' => 'Редактировать язык',	'Drag and drop pages to organize your navigation.' => 'Реорганизуйте навигацию мышкой.',	'File upload failed' => 'Сбой загрузки файла',	'Failed to write the file to disk.' => 'Сбой при записи файла на диск.',	'Failed to save...' => 'Сбой при сохранении...',	'File save failed' => 'Сбой сохранения файла',	'Properties' => 'Свойства',	'Properties saved.' => 'Свойства сохранены.',	'Done.' => 'Сделано.',	'Make default' => 'Сделать по умолчанию',	'Contains text...' => 'Содержит текст....',	'Error message' => 'Сообщение ошибки',	'Error Message' => 'Сообщение ошибки',	'An email has been sent with a link to reset your password.' => 'Сообщение с линком для востановления пароля было послано.',	'Saving...' => 'Сохранение....',	'Saved!' => 'Сохранено!',	'Save' => 'Сохранить',	'Save Block' => 'Сохранить блок',	'Save &amp; Keep Editing' => 'Сохранить и продолжить редактировать',	'Save User' => 'Сохранить пользователя',	'Save Page' => 'Сохранить страницу',	'Comparing' => 'Сравнение',	'Compare to current' => 'Стравнить с текущей',	'Page not found' => 'Страница не найдена',	'Page created.' => 'Страница создана.',	'Page saved.' => 'Страница сохранена.',	'Page deleted.' => 'Страница удалена.',	'Current' => 'Текущая',	'Current version' => 'Текущая версия',	'Type' => 'Тип',	'User type' => 'Тип пользователя',	'Authorization required.' => 'Требуется авторизация.',	'Login required' => 'Требуется вход',	'Admin access required.' => 'Требуется доспуп администратора.',	'Delete' => 'Удалить',	'Delete Block' => 'Удалить блок',	'Delete Page' => 'Удалить страницу',	'Language deleted.' => 'Удалить язык.',	'Hmm, we can\'t seem to find the page you wanted at the moment.' => 'Ух... куда же вас занесло....',	'Member' => 'Участник',	'Members' => 'Участники',	'File already exists' => 'Файд уже существует',	'The file was only partially uploaded.' => 'Файл был загружен частично.',	'File not found' => 'Файл не найден',	'File size is too large.' => 'Файл очень большой.',	'File renamed.' => 'Файл переименован.',	'A file by that name already exists.' => 'Файл с таким именем уже существует.',	'File saved.' => 'Файл сохранен.',	'File deleted.' => 'Файл удален.',	'Folder already exists' => 'Файл уже существует',	'File Already Exists' => 'Файл уже существует',	'Files' => 'Файлы',	'This page forwards visitors to the following link' => 'Эта страница перенаправляет визиторов по ссылке',	'The language code entered already exists.' => 'Этот код языка уже существует.',	'This object is already being edited by' => 'Этот объект редактируется',	'Language' => 'Язык',	'Language added.' => 'Язык добавлен.',	'Language updated.' => 'Язык обновлен.',	'Default language updated.' => 'Язык по умолчанию обновлен.',	'Languages' => 'Языки',	'or' => 'или',	'click to install' => 'нажмите для инсталляции',	'click to upgrade' => 'нажмите для обновления',	'optional' => 'опционально'
+);
+
+?>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/lang/uk.php elefant-1.3.2-beta/lang/uk.php
--- elefant-1.3.1-beta/lang/uk.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/lang/uk.php	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,7 @@
+<?php
+
+$this->lang_hash['uk'] = array (
+	'Nobody' => '(ніхто)',	'Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec' => '01 02 03 04 05 06 07 08 09 10 11 12',	'Rebuilding index' => 'Іде переіндексування',	'Block ID' => 'Ідентифікатор блоку',	'Page ID' => 'Ідентифікатор сторінкт',	'Name' => 'Імя',	'No name specified' => 'Імя не задано',	'Indexing completed' => 'Індексацію закінчено',	'Tools' => 'Інструменти',	'Other versions' => 'Інші версії',	'Other pages' => 'Інші сторінки',	'Auto-saved data found for this form.' => 'Авто-збереженні данні знайдено для цієї форми.',	'Author' => 'Автор',	'Alternate window title' => 'Альтернативний заголовок вікна',	'Alternate menu title' => 'Альтернативний заголовок меню',	'Blocks' => 'Блоки',	'Please enter the language code.' => 'Будь-ласка введіть код мови.',	'Please enter the name of the language.' => 'Будь-ласка ввеліть назву мови.',	'Please try again later.' => 'Будь-ласка повторіть пізніше.',	'Please confirm your email address' => 'Будь-ласка підтвердіть вашу поштову адресу',	'Please log in to continue.' => 'Будь-ласка, увійдіть для продовження.',	'Alphabetical' => 'В алфавітному порядку',	'Your ID must be a lowercase alphanumeric value and can\'t already exist.' => 'Ваш ідентифікатор повинен буди введено латиницею (малими літерами) та не повинен існувати.',	'Your ID must be a lowercase alphanumeric value.' => 'Ваш ідентифікатор повинен буди введено латиницею (малими літерами) та не повинен існувати.',	'Your ID must be a lowercase alphanumeric value and can\'t already exist. It must also not share the name of an app.' => 'Ваш ідентифікатор повинен буди введено латиницею (малими літерами) та не повинен існувати. Також не повинен співпадати з іменем аплікації.',	'Your ID must be a lowercase alphanumeric value. It must also not share the name of an app.' => 'Ваш ідентифікатор повинен буди введено латиницею (малими літерами). Також не повинен співпадати з іменем аплікації.',	'Your name' => 'Ваше імя',	'The layout you entered doesn\'t exist.' => 'Введена розмітка сторінки не існує',	'Website' => 'Вебсайт',	'Versions' => 'Версії',	'Versions of' => 'Версії',	'Are you sure you want to delete the current block?' => 'Ви впевнені що хочете видалити поточний блок?',	'Are you sure you want to delete the current page?' => 'Ви впевнені що хочете видалити поточну сторінку?',	'Are you sure you want to delete this block?' => 'Ви впевнені що хочете видалити цей блок?',	'Are you sure you want to delete this user?' => 'Ви впевнені що хочете видалити цього користувача?',	'Are you sure you want to delete this language?' => 'Ви впевнені що хочете видалити цю мову?',	'Are you sure you want to delete this page?' => 'Ви впевнені що хочете видалити цю сторінку?',	'Are you sure you want to cancel and lose any changes?' => 'Ви впевнені що хочете відмінити операцію (зроблені зміни не будуть збережені)?',	'Are you sure you want to cancel?' => 'Ви впевнені що хочете відмінити операцію?',	'You must enter a page title.' => 'Ви повинні ввести заголовок сторінки.',	'You must enter body content.' => 'Ви повинні ввести контент сторінки.',	'You must enter a block title.' => 'Ви повинні ввести назву блоку.',	'You must enter a password.' => 'Ви повинні ввести пароль.',	'You must enter an email address.' => 'Ви повинні ввести поштову адресу.',	'You must enter a valid email, or your email may already be registered.' => 'Ви повинні ввести робочу поштову адресу або така адреса уже зареєстрована.',	'You must enter a valid email, or email not found.' => 'Ви повинні ввести робочу поштову адресу або такої адреси не знайдено.',	'You must enter your name.' => 'Ви повинні ввести імя.',	'You must enter a name.' => 'Ви повинні ввести імя.',	'Choose a new password' => 'Виберіть новий пароль',	'Choose a password for your new account.' => 'Виберіть пароль',	'Choose a password' => 'Виберіть пароль',	'Delete' => 'Видалити',	'Delete Block' => 'Видалити блок',	'Delete Page' => 'Видалити сторінку',	'Log out' => 'Вийти',	'Admin access required.' => 'Вимагаються права адміністратора.',	'Authorization required.' => 'Вимагається авторизація.',	'Properties' => 'Властивості',	'Properties saved.' => 'Властивості збережено.',	'Visit your website.' => 'Відвідайте Ваш вебсайт.',	'Cancel' => 'Відмінити',	'Restore' => 'Відновити',	'Reset Password' => 'Відновити пароль',	'Password recovery' => 'Відновлення пароля',	'Submit' => 'Відіслати',	'Date' => 'Дата',	'Day of the week' => 'День тижня',	'Site tree' => 'Дерево вебсайту',	'Source' => 'Джерело',	'Dynamic Objects' => 'Динамічні обєкти',	'Add' => 'Добавити',	'Add Block' => 'Добавити блок',	'Add User' => 'Добавити користувача',	'Add language' => 'Добавити мову',	'Add Page' => 'Добавити сторінку',	'Extra Options' => 'Додаткові опції',	'Access' => 'Доступ',	'An email has been sent with a link to reset your password.' => 'Електронне повідомлення з посиланням для відновлення паролю відправлено!',	'Too many login attempts' => 'Забагато спроб входу',	'Forgot your password?' => 'Забули пароль?',	'Upload' => 'Завантажити',	'Title' => 'Заголовок',	'Page title' => 'Заголовок сторінки',	'Sign in with' => 'Зайти з',	'Done editing' => 'Закінчити редагування',	'Sign Up' => 'Зареєструйтеся',	'Sign up here' => 'Зареєструйтися тут',	'Drag these pages to the site tree to include them in your navigation.' => 'Захопіть ці сторінки щоби включити їх в навігацію по сайту.',	'Drag and drop pages to organize your navigation.' => 'Захопіть і вставте сторінку мишкою, щоби організувати навігацію',	'Save' => 'Зберегти',	'Save Block' => 'Зберегти блок',	'Save User' => 'Зберегти користувача',	'Save Page' => 'Зберегти сторінку',	'Save &amp; Keep Editing' => 'Зберегти та продовжити редагування',	'Saved!' => 'Збережено!',	'Saving...' => 'Зберігання...',	'Change password' => 'Зміна пароля',	'Changed on' => 'Змінено',	'Make default' => 'Зробити по замовчуванню',	'Done.' => 'Зроблено.',	'Keywords (comma-separated)' => 'Ключові слова (розділенні комою)',	'Code' => 'Код',	'Language code' => 'Код мови',	'Body' => 'Контент',	'User deleted.' => 'Користувача видалено.',	'User added.' => 'Користувача додано.',	'User saved.' => 'Користувача збережено.',	'Users' => 'Користувачі',	'File Manager' => 'Менеджер файлів',	'Language' => 'Мова',	'Languages' => 'Мови',	'Language deleted.' => 'Мову видалено.',	'Language added.' => 'Мову додано.',	'Language updated.' => 'Мову обновлено.',	'Default language updated.' => 'Мову по замовчуванню обновленно.',	'Last modified' => 'Модифіковано',	'Contains text...' => 'Містить текст...',	'Navigation' => 'Навігація',	'Back' => 'Назад',	'Block title' => 'Назва блоку',	'Month name' => 'Назва місяця',	'Settings' => 'Настройки',	'Click to update photo' => 'Натисніть для обновлення фото',	'Click here to restore.' => 'Натисніть тут для відновдлення.',	'Home' => 'Начальная страница',	'Not found' => 'Не знайдено',	'Not a member?' => 'Не учасник?',	'Unknown error' => 'Невідома помилка',	'No file uploaded or file too large.' => 'Немає файлу для завантаження або файл занадто великий.',	'Unable to delete' => 'Неможливо видалити',	'Unable to delete folders' => 'Неможливо видалити папку',	'Unable to save the file.' => 'Неможливо зберегти файл.',	'Unable to rename' => 'Неможливо перейменувати',	'No audio playback capabilities' => 'Неможливо програти аудіо-файл',	'No video playback capabilities' => 'Неможливо програти відео-файл',	'Unable to create folder' => 'Неможливо створити папку',	'Login required' => 'Необхідно увійти',	'Invalid directory' => 'Неправильна директорія',	'Invalid location' => 'Неправильна локація',	'Incorrect email or password, please try again.' => 'Неправильна поштова адреса чи пароль. Будь-ласка повторіть.',	'Invalid or expired recovery link' => 'Неправильне або просрочене посилання для відновлення',	'Invalid name' => 'Неправильне імя',	'Invalid folder name' => 'Неправильне імя папки',	'Invalid file name' => 'Неправильне імя файлу',	'Invalid Path' => 'Неправильний шлях',	'New folder' => 'Нова папка',	'New User' => 'Новий користувач',	'New password' => 'Новий пароль',	'New file' => 'Новий файл',	'Newest first' => 'Новіші спочатку',	'No' => 'Ні',	'No file was uploaded.' => 'Ніякого файлу не завантажено.',	'Update Profile' => 'Обновити профіль',	'Upgrade completed' => 'Обновлення завершено',	'Hmm, we can\'t seem to find the page you wanted at the moment.' => 'Ой... ми ще не добавили таку сторінку ;)',	'Description' => 'Опис',	'Last changed' => 'Остання зміна',	'Clear' => 'Очистити',	'Folder' => 'Папка',	'Folder already exists' => 'Папка уже існує',	'Folder renamed.' => 'Папку перейменовано.',	'Folder created.' => 'Папку створено.',	'Password' => 'Пароль',	'Password updated' => 'Пароль обновлено',	'Your password doesn\'t match.' => 'Паролі не співпадають.',	'Verify new password' => 'Перевірити новий пароль',	'Verify password' => 'Перевірити пароль',	'Check your inbox' => 'Перевірте вашу поштову скриньку.',	'Preview' => 'Перегляд',	'Browse' => 'Перегляд',	'View current' => 'Переглянути поточний',	'View profile' => 'Перегянути профіль',	'Rename' => 'Перейминувати',	'Translated' => 'Перекладено',	'Drag pages here to remove them from the tree.' => 'Перемістіть сторінку сюди щоби видалити з дерева.',	'Rebuild index' => 'Переіндексувати',	'Building index' => 'Побудова індексу',	'Show versions' => 'Показати версії',	'Display title' => 'Показати заголовок',	'Show empty fields' => 'Показати пусті поля',	'Show all fields' => 'Показати усі поля',	'Field' => 'Поле',	'Error message' => 'Помилка',	'Error Message' => 'Помилка',	'File upload failed' => 'Помилка при завантаженні файлу',	'Failed to write the file to disk.' => 'Помилка при записі файлу на диск.',	'Failed to save...' => 'Помилка при записі...',	'File save failed' => 'Помилка при збереженні файлу',	'Comparing' => 'Порівняння',	'Compare to current' => 'Порівняти з поточним',	'Send verification' => 'Послати верифікацію',	'Permanent (best for SEO)' => 'Постійно (краще для SEO)',	'Current' => 'Поточна',	'Current version' => 'Поточна версія',	'Email' => 'Поштова адреса',	'Email address' => 'Поштова адреса',	'Go' => 'Пошук',	'Private' => 'Приватно',	'Note: Pages that are not publicly visible will not be listed here.' => 'Примітка: Сторінки, що не відмічені як публічні, тут не перечисленні.',	'Continue' => 'Продовжити',	'Missing property name' => 'Пропущено імя властивості',	'Profile Updated' => 'Профіль обновлено',	'Public' => 'Публічно',	'Editing Locked' => 'Редагування блоковано',	'Edit' => 'Редагувати',	'Edit Block' => 'Редагувати блок',	'Edit User' => 'Редагувати користувача',	'Editing language' => 'Редагувати мову',	'Edit Profile' => 'Редагувати профайл',	'Edit Page' => 'Редагувати сторінку',	'Account Verified' => 'Реєстрацію перевірено',	'File size' => 'Розмір файлу',	'Page layout' => 'Розмітка сторінки',	'An Error Occurred' => 'Сталася помилка',	'Oldest first' => 'Старші спочатку',	'Page saved.' => 'Сторінку збережено.',	'Page not found' => 'Сторінку не знайдено',	'The page you requested could not be found.' => 'Сторінку не знайдено',	'Page created.' => 'Сторінку створено',	'Page deleted.' => 'Строрінку видалено.',	'January February March April May June July August September October November December' => 'Січень Лютий Березень Квітень Травень Червень Липень Серпень Вересень Жовтень Листопад Грудень',	'Yes' => 'Так',	'Temporary' => 'Тимчасово',	'Type' => 'Тип',	'User type' => 'Тип користувача',	'Sign in' => 'Увійти',	'All Pages' => 'Усі сторінки',	'Member' => 'Учасник',	'Members' => 'Учасники',	'File Already Exists' => 'Файл Уже Існує',	'File deleted.' => 'Файл видалено.',	'A file by that name already exists.' => 'Файл з таким іменем уже існує.',	'The file was only partially uploaded.' => 'Файл завантажено частково.',	'File size is too large.' => 'Файл занадто великий.',	'File saved.' => 'Файл збережено.',	'File not found' => 'Файл не знайдено',	'File renamed.' => 'Файл перейменовано.',	'File already exists' => 'Файл уже існує',	'Files' => 'Файли',	'This object is already being edited by' => 'Цей обєкт редагується',	'This page forwards visitors to the following link' => 'Ця сторінка переправляє візіторів по наступному лінку',	'Time zone offset' => 'Часова зона',	'or' => 'або',	'click to install' => 'натиснути для встановлення',	'click to upgrade' => 'натиснути для обновдення',	'optional' => 'опціонально'
+);
+
+?>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/lang/zh.php elefant-1.3.2-beta/lang/zh.php
--- elefant-1.3.1-beta/lang/zh.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/lang/zh.php	2012-09-13 09:15:24.000000000 -0500
@@ -1,30 +1,45 @@
 <?php
 
 $this->lang_hash['zh'] = array (
+	'- select -' => '选择',
+	'.htaccess file is missing from the site root. Please save the following file to your server:' => '.htaccess文件不存在（应该在网站根目录）。',
 	'A file by that name already exists.' => '此文件名已经存在',
+	'A theme by this name is already installed.' => '同名主题已经安装。',
 	'Access' => '权限',
 	'Account Verified' => '用户验证成功',
-	'Add' => '添加',
 	'Add Block' => '添加区块',
 	'Add Blog Post' => '添加博客文章',
 	'Add Item' => '添加节点',
+	'Add language' => '添加新的语言',
 	'Add Page' => '添加页面',
 	'Add User' => '添加用户',
+	'Add' => '添加',
+	'Admin access required.' => '需要管理员权限。',
+	'Admin Email' => '管理员电子邮件',
+	'Admin login' => '管理员登录',
+	'Admin Password' => '管理员密码',
 	'Admin' => '管理员',
 	'All Pages' => '所有页面',
 	'All tags' => '所有标签',
+	'Alphabetical' => '按字母顺序',
 	'Alternate menu title' => '调整菜单标题',
 	'Alternate window title' => '调整窗口标题',
-	'An Error Occurred' => '出现一个错误',
+	'An app by this name is already installed.' => '同名模块已经存在。',
 	'An email has been sent with a link to reset your password.' => '系统已经给你发送了一封邮件，点里面链接可以重置密码',
+	'An Error Occurred' => '出现一个错误',
+	'Apache mod_rewrite extension must be installed.' => 'Apache的mod_rewrite扩展必须安装。',
+	'apps folder is not writeable. Please run:</p><p><tt>chmod 775 apps</tt>' => 'apps文件夹不能执行写操作。请运行：</p><p><tt>chmod 775 apps</tt>',
 	'Are you sure you want to cancel and lose any changes?' => '你确定要取消？这样将丢失所有的修改。',
+	'Are you sure you want to cancel?' => '你确定要取消吗？',
 	'Are you sure you want to delete the current block?' => '你确定要删除当前区块？',
 	'Are you sure you want to delete the current page?' => '你确定要删除当前页面？',
 	'Are you sure you want to delete this block?' => '你确定要删除这个区块？',
+	'Are you sure you want to delete this language?' => '你确定你要删除这个语言文件？',
+	'Are you sure you want to delete this page?' => '你确定你要删除这个页面？',
 	'Are you sure you want to delete this post?' => '你确定要删除这个文章？',
 	'Are you sure you want to delete this user?' => '你确定要删除这个用户？',
 	'Are you sure you want to permanently delete this layout file?' => '你确定要永久删除这个布局文件？',
-	'Are you sure you want to permanently delete this stylesheet file?' => '你确定要永久删除这个CSS文件？',
+	'Are you sure you want to permanently delete this stylesheet file?' => '你确定要永久删除这个样式？',
 	'Are you sure you want to permanently erase this table?' => '你确定要永久清除这个数据表数据？',
 	'Assets will recompile on the next page load.' => 'Assets将在下次页面加载的时候重新编译',
 	'Author' => '作者',
@@ -32,203 +47,415 @@
 	'Auto-incrementing field' => '自增加字段',
 	'Auto-post options' => '自动文章选项',
 	'Auto-saved data found for this form.' => '发现此表单自动保存的数据。',
-	'Back' => '后退',
+	'Auto-saved data found.' => '找到自动保存数据。',
 	'Back to posts' => '回到文章列表',
+	'Back' => '后退',
 	'Block ID' => '区块ID',
 	'Block title' => '区块标题',
 	'Blocks' => '区块',
-	'Blog Posts' => '博客文章',
 	'Blog post added.' => '文章添加成功。',
 	'Blog post deleted.' => '文章删除成功',
 	'Blog post saved.' => '文章已经保存。',
+	'Blog Posts' => '博客文章',
+	'Blogger export file' => '博客导出文件',
+	'Blogger importer' => '博客导入',
 	'Body' => '正文',
+	'Browse' => '浏览',
+	'Building index' => '建立索引',
+	'by' => 'by',
+	'cache folder is not writeable. Please run:</p><p><tt>chmod -R 775 cache conf css files lang layouts</tt>' => 'cache文件夹不可写。请运行：</p><p><tt>chmod -R 775 cache conf css files lang layouts</tt>',
 	'Cached files' => '缓存文件',
 	'Cancel' => '取消',
 	'Change password' => '修改密码',
 	'Changed on' => 'Changed on',
+	'Character set' => 'Character set',
+	'Charset' => '编码',
 	'Check that your permissions are correct and try again.' => '确定你有权限操作后再试。',
+	'Check your host for instructions on setting up sub-domains in production.' => '咨询你的服务提供商如何在产品中使用子域名。',
 	'Check your inbox' => 'Check your inbox	',
 	'Choose a new password' => '输入新密码',
+	'Choose a password for your new account.' => '输入新账户密码',
 	'Choose a password' => '输入密码',
+	'Choose an importer' => '选择导入方式',
+	'Clear' => '清空',
+	'Click \'Next\' to continue whenever you\'re ready. Thanks for using Elefant!' => '准备好以后请点击“下一步”。谢谢使用Elefant！',
+	'Click \'Next\' to continue.' => '点击“下一步”',
+	'Click here for instructions on configuring virtual hosts for development.' => '虚拟主机配置方法请点击这里。',
+	'Click here for more information and translations of the MIT license.' => '更多信息和MIT协议的翻译请点击这里。',
 	'Click here to restore.' => '点此恢复。',
+	'click to install' => '点击安装',
+	'Click to restore.' => '点此恢复。',
 	'Click to update photo' => '点此更新图片',
+	'click to upgrade' => '点击升级',
+	'Code' => '代码',
 	'Column' => '列',
-	'Compare to current' => '和当前比较',
+	'comments' => '评论',
+	'Compare to current' => '和当前版本比较',
 	'Comparing' => '比较',
+	'conf folder is not writeable. Please run:</p><p><tt>chmod -R 775 cache conf css files lang layouts</tt>' => 'conf文件夹不可写。请运行：</p><p><tt>chmod -R 775 cache conf css files lang layouts</tt>',
+	'Configuration file not found.' => '配置文件没有找到。',
+	'Connect & Create Schema' => '建立数据库',
+	'Connection Error' => '数据库连接错误',
+	'Contains text...' => '包含文字。。。',
+	'Content' => '内容',
 	'Continue' => '继续',
+	'Copyright' => 'Copyright',
+	'Could not unzip the file.' => '文件不能解压缩。',
 	'Count' => '计数',
-	'Current' => '当前',
+	'Create Layout' => '建立新布局',
+	'Create Stylesheet' => '建立新样式',
+	'css folder is not writeable. Please run:</p><p><tt>chmod -R 775 cache conf css files lang layouts</tt>' => 'css文件夹不可写。请运行：</p><p><tt>chmod -R 775 cache conf css files lang layouts</tt>',
+	'CSV Importer' => 'CSV导入',
 	'Current version' => '当前版本',
+	'Current' => '当前',
+	'Database Connection' => '数据库连接',
+	'Database tables created and settings saved.' => '数据库表成功建立，设置已经保存。',
+	'Database' => '数据库',
 	'Date' => '日期',
 	'Date/Time' => '日期/时间',
-	'Default' => '默认',
+	'Default language updated.' => '默认语言已经更新。',
 	'Default layout updated.' => '默认布局文件已经更新。',
-	'Delete' => '删除',
+	'Default' => '默认',
 	'Delete Block' => '删除区块',
 	'Delete Page' => '删除页面',
+	'Delete' => '删除',
 	'Description' => '描述',
 	'Designer' => '设计',
 	'Display title' => '显示标题',
+	'Done editing' => '修改完成',
+	'Done.' => '完成。',
 	'Drag and drop pages to organize your navigation.' => '拖拽页面构建菜单。',
-	'Drag these pages to the site tree to include them in your navigation.' => '拖拽页面到左边的树',
+	'Drag pages here to remove them from the tree.' => '从导航中删除页面请拖拽页面到这里。',
+	'Drag these pages to the site tree to include them in your navigation.' => '在导航中建立拖拽页面到左边的树',
+	'Driver' => '驱动',
 	'Drop' => '放',
 	'Dynamic Objects' => '动态对象',
-	'Edit' => '修改',
-	'Edit Block' => '修改区块',
-	'Edit Blog Post' => '修改博客文章',
-	'Edit Page' => '修改页面',
-	'Edit Profile' => '修改用户配置',
-	'Edit User' => '修改用户',
+	'Edit Block' => '编辑区块',
+	'Edit Blog Post' => '编辑博客文章',
+	'Edit Layout' => '编辑布局',
 	'Edit page' => '修改页面',
+	'Edit Page' => '编辑页面',
+	'Edit Profile' => '编辑用户配置',
+	'Edit Stylesheet' => '编辑样式',
+	'Edit User' => '编辑用户',
+	'Edit' => '编辑',
 	'Editing Item' => '正在修改节点',
+	'Editing language' => '编辑语言',
 	'Editing Locked' => '锁定',
-	'Email' => '电子邮件',
+	'Elefant homepage' => 'Elefant官方首页',
+	'Elefant Installer' => 'Elefant安装',
+	'Elefant' => 'Elefant',
+	'Elefant\'s CMS was designed to run a complete website, and needs to be installed in the root of a site to function correctly. Please move Elefant to the root folder to continue, or use a sub-domain of your site to install it under.' => 'Elefant CMS考虑到运行一个完整的网站，需要安装到网站的根目录。请移动Elefant到根目录再继续，或者使用子域名。',
 	'Email address' => '电子邮件地址',
-	'Error' => '错误',
-	'Error Message' => '错误信息',
+	'Email' => '电子邮件',
+	'Embedded' => '嵌入',
+	'Error importing file' => '导入文件出错',
 	'Error message' => '错误信息',
+	'Error Message' => '错误信息',
+	'Error uploading file.' => '上传文件出错',
+	'Error' => '错误',
 	'Execute' => '执行',
 	'Export' => '导出',
-	'Extra' => '附加',
 	'Extra Options' => '附加选项',
+	'Extra' => '附加',
+	'Failed to retrieve the file at the specified link.' => '通过指定链接获得文件失败。',
+	'Failed to save...' => '保存失败。。。',
+	'Failed to write to conf/config.php' => '不能对conf/config.php执行写操作',
+	'Fallback' => '替补语言',
 	'Field' => '字段',
+	'File already exists' => '文件已经存在',
 	'File Already Exists' => '文件已经存在',
-	'File Manager' => '文件管理器',
-	'File Size' => '文件大小',
 	'File deleted.' => '文件删除成功。',
+	'File Manager' => '文件管理器',
 	'File not found' => '文件未找到',
 	'File renamed.' => '文件重命名成功。',
+	'File save failed' => '文件保存失败',
 	'File saved.' => '文件保存成功。',
-	'File size' => '文件大小',
 	'File size (pre-gzip)' => '文件大小（经过gzip压缩）',
+	'File size' => '文件大小',
+	'File Size' => '文件大小',
+	'File upload failed' => '文件上传失败',
+	'File:' => '文件：',
+	'files folder is not writeable. Please run:</p><p><tt>chmod -R 775 cache conf css files lang layouts</tt>' => 'files文件夹不可写。请运行：</p><p><tt>chmod -R 775 cache conf css files lang layouts</tt>',
 	'Files' => '文件',
+	'Finish importing' => '结束导入。',
+	'Finished' => '结束',
 	'Folder already exists' => '文件夹已经存在',
 	'Folder created.' => '文件夹创建成功。',
 	'Folder renamed.' => '文件夹重命名成功。',
+	'Folder' => '文件夹',
 	'Forgot your password?' => '忘记密码？',
 	'Generated on' => 'Generated on',
+	'Github installation failed' => 'Github安装失败',
+	'Go' => '搜索',
 	'Hmm, we can\'t seem to find the page you wanted at the moment.' => '呃，没有发现你要访问的页面。',
+	'Home' => '首页',
+	'I Agree' => '我同意',
 	'ID' => 'ID',
+	'If you have any trouble during the install process, please visit the Elefant project at the following link to report it, and we\'ll do our best to help.' => '如果安装时遇到问题，请访问elefant网址反映。我们将尽力帮助你。',
+	'Import as...' => '导入',
+	'Import Posts' => '导入文章',
+	'Important: Only install apps or themes from trusted sources.' => '注意：只从信任的来源安装模块或者主题。',
 	'Incorrect email or password, please try again.' => '电子邮件或者密码不正确。请重试。',
+	'Indexing completed' => '索引创建结束',
 	'Info' => '信息',
-	'Invalid Path' => '无效的路径',
-	'Invalid Verifier' => '无效的验证',
+	'Insert tag' => '插入标签',
+	'Install another' => '安装另外的',
+	'Install App/Theme' => '安装模块/主题',
+	'Install completed' => '安装成功',
+	'Install' => '安装',
+	'Installer' => '安装器',
+	'Introduction' => '说明',
+	'Invalid directory' => '无效的文件夹',
 	'Invalid file name' => '无效的文件名称',
 	'Invalid folder name' => '无效的文件夹名称',
 	'Invalid location' => '无效的位置',
+	'Invalid name' => '无效的名字',
 	'Invalid or expired recovery link' => '无效或者过期的恢复链接',
+	'Invalid Path' => '无效的路径',
+	'Invalid Verifier' => '无效的验证',
+	'It looks like you\'re trying to install Elefant into a sub-folder.' => '看起来你正在安装Elefant到子目录。',
 	'Item Added' => '节点添加成功',
 	'Item Deleted' => '节点删除成功',
 	'Item Updated' => '节点更新成功',
+	'Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec' => '一月 二月 三月 四月 五月 六月 七月 八月 九月 十月 十一月 十二月',
+	'January February March April May June July August September October November December' => '一月 二月 三月 四月 五月 六月 七月 八月 九月 十月 十一月 十二月',
 	'Key' => 'Key',
 	'Keywords (comma-separated)' => '关键词（用逗号隔开）',
-	'Last Modified' => '上次修改',
+	'lang folder is not writeable. Please run:</p><p><tt>chmod -R 775 cache conf css files lang layouts</tt>' => 'lang文件夹不可写。请运行：</p><p><tt>chmod -R 775 cache conf css files lang layouts</tt>',
+	'Language added.' => '新语言添加成功',
+	'Language code' => '语言代码',
+	'Language deleted.' => '语言文件删除成功。',
+	'Language settings' => '语言设置',
+	'Language updated.' => '语言更新成功。',
+	'Language' => '语言',
+	'Languages' => '语言文件列表',
 	'Last changed' => '上次改变',
 	'Last modified' => '上次修改',
+	'Last Modified' => '上次修改',
 	'Latest Posts' => '最新的文章',
+	'Layout added.' => '布局文件添加成功。',
+	'Layout saved.' => '布局文件保存成功。',
 	'Layout' => '布局',
-	'Layouts' => '布局',
+	'layouts folder is not writeable. Please run:</p><p><tt>chmod -R 775 cache conf css files lang layouts</tt>' => 'layouts文件夹不可写。请运行：</p><p><tt>chmod -R 775 cache conf css files lang layouts</tt>',
+	'Layouts' => '布局列表',
 	'Length' => '长度',
+	'License' => '授权',
+	'Lightbox' => 'Lightbox',
+	'Limit to source file' => '指定文件',
+	'Link to a zip file or Github repository' => '链接到zip文件或者Github库',
+	'Locale' => '语言环境',
 	'Log out' => '退出登录',
 	'Login required' => '需要登录',
 	'Make default' => '设置成默认',
+	'Mark imported posts as published?' => '设置导入的文章“已发布”？',
+	'max' => '最大',
 	'Member' => '注册用户',
 	'Members' => '注册用户',
+	'Missing property name' => '缺少属性名',
+	'Multi-file uploader' => '多文件上传',
 	'Name' => '姓名',
 	'Navigation' => '导航',
-	'New Layout' => '新建布局文件',
-	'New Post' => '新建博客文章',
-	'New Stylesheet' => '新建CSS文件',
 	'New file' => '新的文件',
 	'New folder' => '新的文件夹',
+	'New Layout' => '新建布局文件',
 	'New page' => '新的页面',
 	'New password' => '新的密码',
+	'New Post' => '新建博客文章',
+	'New Stylesheet' => '新建样式',
+	'New User' => '新建用户',
 	'Newer items' => '较新的节点',
 	'Newer posts' => '较新的文章',
+	'Newer results' => '较新的结果',
+	'Newest first' => '最新的',
 	'Next' => '下一个',
 	'No audio playback capabilities' => '不能播放声音',
+	'No name specified' => '没有指定名称',
 	'No posts yet... :(' => '暂无文章。',
 	'No video playback capabilities' => '不能播放视频',
+	'No' => '不',
 	'Nobody' => '没有人',
+	'None' => '没有',
+	'Normal strength' => '普通强度',
 	'Not a member?' => '还没注册？',
+	'Not found' => '没有发现',
 	'Note: Pages that are not publicly visible will not be listed here.' => '注意：没有公开访问权限的页面将在这里列出。',
 	'Null' => '没有',
+	'official blog' => '官方博客',
 	'Older items' => '以前的节点',
 	'Older posts' => '以前的文章',
+	'Older results' => '较早的结果',
+	'Oldest first' => '最早的',
+	'One or more server requirements failed' => '服务器不符合安装要求',
+	'optional' => '可选',
+	'or' => '或者',
+	'Original text' => '原文字',
 	'Other pages' => '以前的页面',
 	'Other versions' => '其他版本',
 	'Our Organization' => '导航',
-	'Page ID' => '页面ID',
 	'Page created.' => '页面创建成功。',
 	'Page deleted.' => '页面删除成功。',
+	'Page ID' => '页面ID',
 	'Page layout' => '页面布局',
 	'Page not found' => '页面未发现',
 	'Page saved.' => '页面保存成功。',
 	'Page title' => '页面标题',
-	'Password' => '密码',
+	'Password does not match.' => '密码不符合。',
 	'Password recovery' => '恢复密码',
 	'Password updated' => '密码更新成功',
+	'Password' => '密码',
+	'Permanent (best for SEO)' => '固定网址（有利于SEO）',
 	'Photos by' => '图片',
+	'PHP PDO extension is missing.' => 'PHP的PDO扩展没有安装。',
+	'PHP version must be 5.3+' => 'PHP版本必须5.3+',
 	'Please confirm your email address' => '请确认你的电子邮件地址。',
+	'Please correct the problem and try again.' => '请解决问题再试。',
+	'Please enter a link or upload a file.' => '请输入一个网址或上传一个文件。',
+	'Please enter a name for your layout.' => '请输入布局文件名称。',
+	'Please enter a name for your stylesheet.' => '请输入样式名称。',
+	'Please enter the character set.' => '请输入编码设置。',
+	'Please enter the language code.' => '请输入语言代码。',
+	'Please enter the name of the language.' => '请输入语言名称。',
 	'Please log in to continue.' => '请登录。',
 	'Please try again later.' => '请稍候再次尝试。',
+	'Please upload a zip file.' => '请上传zip格式文件。',
+	'Please wait, this may take a minute...' => '请等待，可能需要一分钟。',
+	'Port' => '端口',
 	'Powered by' => '作者：',
+	'Preview with layout' => '布局预览',
 	'Preview' => '预览',
 	'Previous' => '前一个',
 	'Private' => '私有的',
 	'Profile Updated' => '配置更新成功',
+	'Properties saved.' => '属性保存成功。',
+	'Properties' => '属性',
 	'Public' => '公开的',
 	'Published' => '发表的',
+	'Rebuild index' => '重建索引',
+	'Rebuilding index' => '正在重建索引',
 	'Rename' => '重命名',
+	'Requirements' => '需求',
 	'Reset Password' => '重置密码',
 	'Restore' => '恢复',
-	'SQL Shell' => 'SQL Shell',
+	'results' => '结果',
 	'Save &amp; Keep Editing' => '保存并继续编辑',
 	'Save Block' => '保存区块',
 	'Save Blog Post' => '保存博客文章',
 	'Save Item' => '保存节点',
+	'Save Layout' => '保存布局文件',
 	'Save Page' => '保存页面',
+	'Save Settings' => '保存设置',
+	'Save Stylesheet' => '保存样式',
 	'Save User' => '保存用户',
+	'Save' => '保存',
+	'Saved!' => '已保存！',
+	'Saving Layout Failed' => '保存布局文件失败',
+	'Saving Stylesheet Failed' => '保存样式失败',
+	'Saving...' => '保存中...',
 	'Send verification' => '发送验证',
+	'Server requirements have been verified.' => '服务器需求验证通过。',
+	'Server' => '服务器',
+	'Settings saved and admin user created.' => '设置保存成功，管理员用户已经创建。',
+	'Settings' => '设置',
 	'Show versions' => '显示历史版本',
-	'Sign Up' => '注册',
-	'Sign in' => '登录',
 	'Sign in with' => '第三方登录',
+	'Sign in' => '登录',
 	'Sign up here' => '这里注册',
+	'Sign Up' => '注册',
+	'Site Name' => '网站名称',
+	'Site Settings' => '网站设置',
 	'Site tree' => '网站导航',
-	'Stylesheet' => 'CSS文件',
-	'Stylesheets' => 'CSS文件',
-	'Table' => '表',
+	'Source' => '原',
+	'SQL Shell' => 'SQL Shell',
+	'SQLite users can simply click \'Connect & Create Schema\'. MySQL users please select your driver and enter your server details to continue.' => 'SQLite用户点击"Connect & Create Schema"。MySQL用户请选择你的驱动并完成设置。',
+	'Strong password' => '强密码',
+	'Stylesheet added.' => '新样式添加成功。',
+	'Stylesheet saved.' => '新样式保存成功。',
+	'Stylesheet' => '样式',
+	'Stylesheets' => '样式文件',
+	'Submit' => '提交',
 	'Table Dropped' => '删除表成功',
 	'Table Info' => '表信息',
-	'Tags' => '标签',
+	'Table' => '表',
 	'Tags (comma-separated)' => '标签（用逗号隔开）',
+	'Tags' => '标签',
+	'Temporary' => '临时',
+	'Testing Requirements' => '测试需求',
+	'Thanks for using Elefant!' => '谢谢使用Elefant',
+	'The following app has been installed:' => '下列模块已经安装：',
+	'The following theme has been installed:' => '下列主题已经安装：',
+	'The installation process has been completed. Here are some links you may want to bookmark:' => '安装流程结束。这里几个链接也许你感兴趣：',
+	'The language code entered already exists.' => '输入的语言代码已经存在。',
 	'The layout you entered doesn\'t exist.' => '你输入的布局文件不存在。',
+	'The link appears to be invalid.' => '链接无效。',
+	'The MIT License' => 'Mit协议',
+	'The page you requested could not be found.' => '你要访问的页面不存在。',
+	'This installer will guide you through the process of installing and configuring your new website.' => '此安装向导将指引你完成安装和配置网站信息。',
 	'This is a preview of how your layout will look.' => '这里是页面预览。',
 	'This object is already being edited by' => '这个对象正在被编辑：',
 	'This page forwards visitors to the following link' => '即将跳转到',
 	'Title' => '标题',
+	'Too many login attempts' => '尝试登录次数过多。',
+	'Too weak' => '太弱',
+	'Tools' => '工具',
+	'Translated' => '翻译',
+	'Try Again' => '再试',
 	'Type' => '种类',
-	'Unable to Delete File' => '不能删除文件',
 	'Unable to create folder' => '不能创建文件夹',
-	'Unable to delete' => '不能删除',
+	'Unable to Delete File' => '不能删除文件',
 	'Unable to delete folders' => '不能删除文件夹',
+	'Unable to delete' => '不能删除',
+	'Unable to fetch configuration file.' => '不能获得配置文件。',
+	'Unable to fetch file' => '不能获得文件',
+	'Unable to parse the uploaded file.' => '不能处理提交的文件。',
 	'Unable to rename' => '不能重命名',
-	'Unable to save the file.' => '不能保存文件',
+	'Unable to save the file.' => '不能保存文件。',
+	'Unable to write to apps folder.' => 'apps文件夹不能执行写操作。',
+	'Unable to write to cache folder.' => 'cache文件夹不能写。',
+	'Unable to write to layouts folder.' => 'layout文件夹不能写。',
+	'Unknown error' => '未知错误',
 	'Update Profile' => '更新配置',
+	'Upgrade completed' => '升级完成',
+	'Upgrading Blog App' => '正在升级博客模块',
+	'Upgrading Files App' => '正在升级文件管理器模块',
+	'Upgrading User App' => '正在升级用户模块',
+	'Upload a zip file' => '上传zip文件',
+	'Upload the CSV file' => '上传CSV文件',
 	'Upload' => '上传',
+	'Uploaded CSV file not found.' => '上传的CSV文件没有找到。',
 	'User added.' => '新建用户成功。',
 	'User deleted.' => '用户删除成功。',
 	'User saved.' => '用户已经保存。',
 	'User type' => '用户种类',
-	'Users' => '用户',
+	'Username' => '用户名',
+	'Users' => '用户列表',
+	'Verification failed: Invalid configuration file.' => '验证失败：无效的配置文件。',
+	'Verification failed: Invalid folder name.' => '验证失败：无效的文件夹名。',
+	'Verification failed: Invalid type.' => '验证失败：无效的类别。',
+	'Verification failed: No configuration file found.' => '验证失败：没有找到配置文件。',
+	'Verification failed: No folder specified' => '验证失败：没有指定文件夹。',
+	'Verification failed: No name specified' => '验证失败：没有指定名称。',
+	'Verification failed: No type specified.' => '验证失败：没有指定类别。',
+	'Verification failed: No version specified.' => '验证失败：没有指定版本。',
+	'Verification failed: Repository or website required.' => '验证失败：需要有库或者网站',
 	'Verify new password' => '验证新密码',
 	'Verify password' => '验证密码',
+	'Verify Password' => '验证密码',
 	'Version history' => '历史版本',
-	'Versions' => '历史版本',
 	'Versions of' => '历史版本：',
+	'Versions' => '历史版本',
+	'Very strong password' => '强密码',
+	'View current' => '显示当前版本',
 	'View profile' => '查看配置',
+	'Visit your new website' => '访问你的新网站',
 	'Visit your website.' => '访问网站首页',
+	'Weak password' => '弱密码',
+	'Website' => '网站',
+	'Welcome to the Elefant CMS installer.' => '欢迎来到ElefantCMS安装向导。',
+	'Which columns should be imported?' => '你想导入哪些列？',
+	'Wordpress export file' => 'Wordpress导出文件',
+	'Wordpress importer' => 'Wordpress导入器',
+	'Yes' => '确定',
 	'You must enter a block title.' => '你必须输入一个区块标题。',
 	'You must enter a name.' => '你必须输入一个姓名。',
 	'You must enter a page title.' => '你必须输入一个页面标题。',
@@ -241,18 +468,20 @@
 	'You must enter body content.' => '你必须输入正文。',
 	'You must enter your name.' => '你必须输入你的名字。',
 	'You must select a date/time.' => '你必须选择一个时间。',
+	'You\'re done!' => '你完成了！',
+	'Your ID must be a lowercase alphanumeric value and can\'t already exist. It must also not share the name of an app.' => '你的ID必须由小写的字母数字组成而且不能已经存在，或者和一个模块重名。',
 	'Your ID must be a lowercase alphanumeric value and can\'t already exist.' => '你的ID必须由小写的字母数字组成而且不能已经存在。',
-	'Your ID must be a lowercase alphanumeric value and can\'t already exist. It must also not share the name of an app.' => '你的ID必须由小写的字母数字组成而且不能已经存在，或者和一个app重名。',
+	'Your ID must be a lowercase alphanumeric value. It must also not share the name of an app.' => '你的ID必须由小写的字母数字组成而且不能已经存在，或者和一个模块重名。',
 	'Your ID must be a lowercase alphanumeric value.' => '你的ID必须由小写的字母数字组成。',
-	'Your ID must be a lowercase alphanumeric value. It must also not share the name of an app.' => '你的ID必须由小写的字母数字组成而且不能已经存在，或者和一个app重名。',
+	'Your name must be alphanumeric and not a duplicate of an existing layout.' => '你的名字必须由字母数字组成而且不能和已有的布局文件名重复。',
+	'Your name must be alphanumeric and not a duplicate of an existing stylesheet.' => '你的名字必须由字母数字组成而且不能和已有的样式文件名重复。',
 	'Your name' => '你的名字',
+	'Your Name' => '你的名字',
 	'Your password doesn\'t match.' => '你的密码不正确',
 	'Your password must be at least 6 characters.' => '你的密码至少需要6个字符。',
-	'by' => 'by',
-	'comments' => '评论',
-	'max' => '最大',
-	'official blog' => '官方博客',
-	'results' => '结果'
+	'Your website' => '你的网站',
+	'Zip file installation failed' => 'zip文件安装失败',
+	'Zip file was invalid or could not be installed.' => 'zip文件无效或者不能安装。'
 );
 
 ?>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/layouts/admin.html elefant-1.3.2-beta/layouts/admin.html
--- elefant-1.3.1-beta/layouts/admin.html	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/layouts/admin.html	2012-09-13 09:15:24.000000000 -0500
@@ -2,7 +2,7 @@
 <html>
 <head>
 	<title>{{ Product::name() }} - {{ window_title|none }}</title>
-	<meta http-equiv="content-type" content="text/html; charset={{ i18n.charset }}" />
+	<meta charset="{{ i18n.charset }}" />
 	<link rel="stylesheet" type="text/css" href="/apps/admin/css/reset.css" />
 	<link rel="stylesheet" type="text/css" href="/apps/admin/css/text.css" />
 	<link rel="stylesheet" type="text/css" href="/apps/admin/css/960.css" />
diff -urBNs elefant-1.3.1-beta/layouts/default.html elefant-1.3.2-beta/layouts/default.html
--- elefant-1.3.1-beta/layouts/default.html	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/layouts/default.html	2012-09-13 09:15:24.000000000 -0500
@@ -2,7 +2,7 @@
 <html>
 <head>
 	<title>{{ conf('General', 'site_name') }} - {{ window_title|none }}</title>
-	<meta http-equiv="content-type" content="text/html; charset={{ i18n.charset }}" />
+	<meta charset="{{ i18n.charset }}" />
 	{% if detect('mobile') %}
 		<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0" />
 		<link rel="stylesheet" type="text/css" href="/css/mobile.css" />
@@ -26,6 +26,16 @@
 		</div>
 	</div>
 	<div class="clear"></div>
+{% if id === 'index' %}
+	<div id="body" class="grid_12 index-body">
+
+{! filemanager/slideshow?path=homepage !}
+
+{% if title != '' %}<h2>{{ title|none }}</h2>{% end %}
+{{ body|none }}
+
+	</div>
+{% else %}
 	<div id="body" class="grid_8">
 
 {% if title != '' %}<h2>{{ title|none }}</h2>{% end %}
@@ -35,13 +45,15 @@
 	<div id="sidebar" class="grid_4">
 {! blocks/members !}
 	</div>
+{% end %}
 	<div class="clear"></div>
 	<div id="footer" class="grid_12">
 		<div class="grid_6 alpha menu">
 			{! navigation/top !}
 		</div>
 		<div class="grid_6 omega powered">
-			{"Powered by"} <a href="http://www.elefantcms.com/">Elefant CMS</a>
+			{"Powered by"} <a href="http://www.elefantcms.com/">Elefant CMS</a><br />
+			{"Photos by"} <a href="http://www.rachaelhosein.com/">Rachael Hosein</a>
 		</div>
 	</div>
 	<div class="clear"></div>
diff -urBNs elefant-1.3.1-beta/layouts/index.html elefant-1.3.2-beta/layouts/index.html
--- elefant-1.3.1-beta/layouts/index.html	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/layouts/index.html	1969-12-31 18:00:00.000000000 -0600
@@ -1,51 +0,0 @@
-<!DOCTYPE html>
-<html>
-<head>
-	<title>{{ conf('General', 'site_name') }} - {{ window_title|none }}</title>
-	<meta http-equiv="content-type" content="text/html; charset={{ i18n.charset }}" />
-	{% if detect('mobile') %}
-		<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0" />
-		<link rel="stylesheet" type="text/css" href="/css/mobile.css" />
-	{% else %}
-		<link rel="stylesheet" type="text/css" href="/css/reset.css" />
-		<link rel="stylesheet" type="text/css" href="/css/text.css" />
-		<link rel="stylesheet" type="text/css" href="/css/960.css" />
-		<link rel="stylesheet" type="text/css" href="/css/style.css" />
-	{% end %}
-	{! admin/head !}
-	{{ head|none }}
-</head>
-<body>
-<div id="wrapper" class="container_12">
-	<div id="head" class="grid_12">
-		<div class="grid_6 alpha">
-			<h1>{{ conf('General', 'site_name') }}</h1>
-		</div>
-		<div class="grid_6 omega menu">
-			{! navigation/top !}
-		</div>
-	</div>
-	<div class="clear"></div>
-	<div id="body" class="grid_12 index-body">
-
-{! filemanager/slideshow?path=homepage !}
-
-{% if title != '' %}<h2>{{ title|none }}</h2>{% end %}
-{{ body|none }}
-
-	</div>
-	<div class="clear"></div>
-	<div id="footer" class="grid_12">
-		<div class="grid_6 alpha menu">
-			{! navigation/top !}
-		</div>
-		<div class="grid_6 omega powered">
-			{"Powered by"} <a href="http://www.elefantcms.com/">Elefant CMS</a><br />
-			{"Photos by"} <a href="http://www.rachaelhosein.com/">Rachael Hosein</a>
-		</div>
-	</div>
-	<div class="clear"></div>
-</div>
-{{ tail|none }}
-</body>
-</html>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/lib/Acl.php elefant-1.3.2-beta/lib/Acl.php
--- elefant-1.3.1-beta/lib/Acl.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/lib/Acl.php	2012-09-13 09:15:24.000000000 -0500
@@ -30,40 +30,40 @@
  *
  * Usage:
  *
- *   <?php
- *   
- *   // Default usage
- *   $acl = new Acl ();
- *   
- *   if (! $acl->allowed ('resource')) {
- *     // Keep the current user out
- *   }
- *   
- *   // Use an alternate user
- *   $user = new User ($user_id);
- *   
- *   if (! $acl->allowed ('resource', $user)) {
- *     // Keep the user out
- *   }
- *   
- *   ?>
+ *     <?php
+ *     
+ *     // Default usage
+ *     $acl = new Acl ();
+ *     
+ *     if (! $acl->allowed ('resource')) {
+ *         // Keep the current user out
+ *     }
+ *     
+ *     // Use an alternate user
+ *     $user = new User ($user_id);
+ *     
+ *     if (! $acl->allowed ('resource', $user)) {
+ *         // Keep the user out
+ *     }
+ *     
+ *     ?>
  *
  * The format of the INI file is as follows:
  *
- *   [admin]
- *   
- *   default = On
- *   
- *   [editor]
- *   
- *   default = On
- *   user/admin = Off
- *   myapp = Off
- *   
- *   [member]
- *   
- *   default = Off
- *   user = On
+ *     [admin]
+ *     
+ *     default = On
+ *     
+ *     [editor]
+ *     
+ *     default = On
+ *     user/admin = Off
+ *     myapp = Off
+ *     
+ *     [member]
+ *     
+ *     default = Off
+ *     user = On
  *
  * The default lines change whether you should allow or deny by default for a
  * given role. The naming convention `user/admin` signifies a feature within an
diff -urBNs elefant-1.3.1-beta/lib/AppTest.php elefant-1.3.2-beta/lib/AppTest.php
--- elefant-1.3.1-beta/lib/AppTest.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/lib/AppTest.php	2012-09-13 09:15:24.000000000 -0500
@@ -4,17 +4,17 @@
  * Elefant CMS - http://www.elefantcms.com/
  *
  * Copyright (c) 2011 Johnny Broadway
- * 
+ *
  * Permission is hereby granted, free of charge, to any person obtaining a copy
  * of this software and associated documentation files (the "Software"), to deal
  * in the Software without restriction, including without limitation the rights
  * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  * copies of the Software, and to permit persons to whom the Software is
  * furnished to do so, subject to the following conditions:
- * 
+ *
  * The above copyright notice and this permission notice shall be included in
  * all copies or substantial portions of the Software.
- * 
+ *
  * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
@@ -25,9 +25,9 @@
  */
 
 /**
- * Extends PHPUnit to test Elefant handlers. Creates the necessary
- * environment that a handler expects. Note that you will have to set up
- * any `$_GET` or `$_POST` values that your handlers expect.
+ * Extends PHPUnit to provide testing capabilities for handlers. Creates
+ * the necessary environment that a handler expects. Note that you will
+ * have to set up any `$_GET` or `$_POST` values that your handlers expect.
  *
  * Also includes the following convenience functions:
  *
@@ -39,41 +39,41 @@
  *
  * Usage:
  *
- *   <?php
- *   
- *   require_once ('lib/Autoloader.php');
- *   
- *   class MyappAppTest extends AppTest {
- *     public function test_myhandler () {
- *       // Perform a handler request and test its output
- *       $res = $this->get ('myapp/myhandler', array ('one' => 'two');
- *       $this->assertContains ('Expected output', $res);
- *     }
+ *     <?php
  *
- *     public function test_admin () {
- *       // This should redirect to /admin
- *       $res = $this->get ('myapp/admin');
- *       $this->assertContains ('headers already sent', $res);
- *       
- *       // Become the admin and try again
- *       $this->userAdmin ();
- *       $res = $this->get ('myapp/admin');
- *       $this->assertContains ('My admin output', $res);
- *       
- *       // Become anonymous user again
- *       $this->userAnon ();
- *       
- *       // Continue...
+ *     require_once ('lib/Autoloader.php');
+ *
+ *     class MyappAppTest extends AppTest {
+ *         public function test_myhandler () {
+ *             // Perform a handler request and test its output
+ *             $res = $this->get ('myapp/myhandler', array ('one' => 'two');
+ *             $this->assertContains ('Expected output', $res);
+ *         }
+ *
+ *         public function test_admin () {
+ *             // This should redirect to /admin
+ *             $res = $this->get ('myapp/admin');
+ *             $this->assertContains ('headers already sent', $res);
+ *
+ *             // Become the admin and try again
+ *             $this->userAdmin ();
+ *             $res = $this->get ('myapp/admin');
+ *             $this->assertContains ('My admin output', $res);
+ *
+ *             // Become anonymous user again
+ *             $this->userAnon ();
+ *
+ *             // Continue...
+ *         }
  *     }
- *   }
- *   
- *   ?>
+ *
+ *     ?>
  */
 class AppTest extends PHPUnit_Framework_TestCase {
 	/**
 	 * Prevent these from being reset between tests.
 	 */
-	protected $backupGlobalsBlacklist = array ('i18n', 'memcache', 'page', 'tpl');
+	protected $backupGlobalsBlacklist = array ('i18n', 'cache', 'page', 'tpl');
 
 	/**
 	 * The Controller object.
@@ -98,11 +98,11 @@
 	 * Make the current user anonymous.
 	 */
 	public function userAnon () {
-		User::$user = false;
+		User::$user = FALSE;
 	}
 
 	/**
-	 * Alias for Controller's `run()` method.
+	 * Alias for [[Controller]]'s `run()` method.
 	 */
 	public function get ($uri, $data = array ()) {
 		try {
@@ -113,7 +113,7 @@
 	}
 
 	/**
-	 * Initializes the $i18n, $memcache, $page, and $tpl objects
+	 * Initializes the `$i18n`, `$cache`, `$page`, and `$tpl` objects
 	 * for use with the controller in testing handlers.
 	 */
 	public static function setUpBeforeClass () {
@@ -124,10 +124,10 @@
 		$_SERVER['HTTP_ACCEPT_LANGUAGE'] = 'en';
 		$_SERVER['REQUEST_URI'] = '/';
 
-		global $conf, $i18n, $memcache, $page, $tpl;
+		global $conf, $i18n, $cache, $page, $tpl;
 
 		// Set up the database connection to be in memory
-		$conf = parse_ini_file ('conf/config.php', true);
+		$conf = parse_ini_file ('conf/config.php', TRUE);
 		$conf['Database'] = array (
 			'master' => array (
 				'driver' => 'sqlite',
@@ -163,18 +163,18 @@
 		$page = new Page;
 		self::$c = new Controller ();
 		$tpl = new Template ('utf-8', self::$c);
-		$memcache = Cache::init (array ());
+		$cache = Cache::init (array ());
 	}
 
 	/**
-	 * Unset the $i18n, $memcache, $page, and $tpl objects upon
+	 * Unset the `$i18n`, `$cache`, `$page`, and `$tpl` objects upon
 	 * completion.
 	 */
 	public static function tearDownAfterClass () {
 		error_reporting (E_ALL);
-		global $i18n, $memcache, $page, $tpl;
+		global $i18n, $cache, $page, $tpl;
 		unset ($i18n);
-		unset ($memcache);
+		unset ($cache);
 		unset ($page);
 		unset ($tpl);
 
@@ -183,9 +183,9 @@
 		}
 
 		if (isset (User::$user)) {
-			User::$user = false;
+			User::$user = FALSE;
 		}
 	}
 }
 
-?>
\ No newline at end of file
+?>
Files elefant-1.3.1-beta/lib/Autoloader.php and elefant-1.3.2-beta/lib/Autoloader.php are identical
diff -urBNs elefant-1.3.1-beta/lib/Cache.php elefant-1.3.2-beta/lib/Cache.php
--- elefant-1.3.1-beta/lib/Cache.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/lib/Cache.php	2012-09-13 09:15:24.000000000 -0500
@@ -52,20 +52,20 @@
 
 	/**
 	 * Initialize the correct cache based on the global configuration
-	 * and return the cache object (lib/MemcacheExt, lib/MemcacheRedis,
-	 * or lib/Cache).
+	 * and return the cache object (lib/MemcacheExt, lib/MemcacheAPC,
+	 * lib/MemcacheRedis, or lib/Cache).
 	 */
 	public static function init ($conf) {
 		$server = isset ($conf['server']) ? $conf['server'] : false;
 		$dir = isset ($conf['location']) ? $conf['location'] : 'cache/datastore';
 		$backend = isset ($conf['backend']) ? $conf['backend'] : 'memcache';
 
-		if ($server) {
+		if ($backend === 'apc' && extension_loaded ('apc')) {
+			return new MemcacheAPC ();
+		} elseif ($server) {
 			// Determine the backend
 			if ($backend === 'redis' && extension_loaded ('redis')) {
 				$cache = new MemcacheRedis ();
-			} elseif ($backend === 'apc' && extension_loaded ('apc')) {
-				return new MemcacheAPC ();
 			} elseif (extension_loaded ('memcache')) {
 				$cache = new MemcacheExt ();
 			} else {
@@ -98,7 +98,7 @@
 	 */
 	private function _set_timeout ($key, $timeout) {
 		if (file_put_contents ($this->dir . '/.' . md5 ($key), $timeout)) {
-			chmod ($this->dir . '/.' . md5 ($key), 0777);
+			chmod ($this->dir . '/.' . md5 ($key), 0666);
 			return true;
 		}
 		return false;
@@ -163,7 +163,7 @@
 		if (! file_put_contents ($this->dir . '/' . md5 ($key), $val)) {
 			return false;
 		}
-		chmod ($this->dir . '/' . md5 ($key), 0777);
+		chmod ($this->dir . '/' . md5 ($key), 0666);
 		if ($timeout) {
 			$this->_set_timeout ($key, $timeout);
 		}
@@ -180,7 +180,7 @@
 		if (! file_put_contents ($this->dir . '/' . md5 ($key), $val)) {
 			return false;
 		}
-		chmod ($this->dir . '/' . md5 ($key), 0777);
+		chmod ($this->dir . '/' . md5 ($key), 0666);
 		if ($timeout) {
 			$this->_set_timeout ($key, $timeout);
 		}
@@ -197,7 +197,7 @@
 		if (! file_put_contents ($this->dir . '/' . md5 ($key), $val)) {
 			return false;
 		}
-		chmod ($this->dir . '/' . md5 ($key), 0777);
+		chmod ($this->dir . '/' . md5 ($key), 0666);
 		if ($timeout) {
 			$this->_set_timeout ($key, $timeout);
 		}
@@ -217,7 +217,7 @@
 		if (! file_put_contents ($this->dir . '/' . md5 ($key), $val)) {
 			return false;
 		}
-		chmod ($this->dir . '/' . md5 ($key), 0777);
+		chmod ($this->dir . '/' . md5 ($key), 0666);
 		return $val;
 	}
 
@@ -234,7 +234,7 @@
 		if (! file_put_contents ($this->dir . '/' . md5 ($key), $val)) {
 			return false;
 		}
-		chmod ($this->dir . '/' . md5 ($key), 0777);
+		chmod ($this->dir . '/' . md5 ($key), 0666);
 		return $val;
 	}
 
diff -urBNs elefant-1.3.1-beta/lib/Controller.php elefant-1.3.2-beta/lib/Controller.php
--- elefant-1.3.1-beta/lib/Controller.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/lib/Controller.php	2012-09-13 09:15:24.000000000 -0500
@@ -4,17 +4,17 @@
  * Elefant CMS - http://www.elefantcms.com/
  *
  * Copyright (c) 2011 Johnny Broadway
- * 
+ *
  * Permission is hereby granted, free of charge, to any person obtaining a copy
  * of this software and associated documentation files (the "Software"), to deal
  * in the Software without restriction, including without limitation the rights
  * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  * copies of the Software, and to permit persons to whom the Software is
  * furnished to do so, subject to the following conditions:
- * 
+ *
  * The above copyright notice and this permission notice shall be included in
  * all copies or substantial portions of the Software.
- * 
+ *
  * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
@@ -25,9 +25,10 @@
  */
 
 /**
- * Basic routing controller. Maps `$_SERVER['REQUEST_URI']` to files in
- * a `apps/{appname}/handlers/` folder, defaulting to
- * `conf ('General', 'default_handler')` if no others match.
+ * Controller provides the request marshalling to Elefant handlers.
+ * It evaluates `$_SERVER['REQUEST_URI']` against files in
+ * a `apps/{appname}/handlers/` folder, defaulting to the handler
+ * specified in `conf ('General', 'default_handler')` if no others match.
  *
  * Matching is done by reducing the URL folder-by-folder until a file
  * matches. Here are some examples:
@@ -49,16 +50,24 @@
  * The controller simply returns the matching URL so you can include
  * it via the following code:
  *
+ *     <?php
+ *
  *     $handler = $controller->route ($_SERVER['REQUEST_URI']);
  *     ob_start ();
  *     require_once ($handler);
  *     $page->body = ob_get_clean ();
  *
+ *     ?>
+ *
  * Or more simply (but in practice the same):
  *
+ *     <?php
+ *
  *     $handler = $controller->route ($_SERVER['REQUEST_URI']);
  *     $page->body = $controller->handle ($handler);
  *
+ *     ?>
+ *
  * In this way, there is less scaffolding code for individual controllers,
  * they can simply begin executing just like an ordinary PHP script, and
  * the output is simply echoed like an ordinary PHP script too.
@@ -69,49 +78,69 @@
  *
  * To use named parameters, you simply say:
  *
+ *     <?php
+ *
  *     list ($id, $title) = $this->params;
  *
+ *     ?>
+ *
  * You can also call one handler from within another and get its results
  * like this:
  *
+ *     <?php
+ *
  *     $res = $this->run ('/user/123');
  *
+ *     ?>
+ *
  * Sometimes you might want to pass values to another handler for internal
  * processing, which you can do like this:
  *
+ *     <?php
+ *
  *     $res = $this->run ('/user/123', array ('foo' => 'bar'));
  *
+ *     ?>
+ *
  * You can then access the array via:
  *
+ *     <?php
+ *
  *     echo $this->data['foo'];
  *
+ *     ?>
+ *
  * In addition to running one handler from another, you can configure
  * hooks with one or more handlers to be run for you when you trigger
  * the hook. This is a 3-step process:
  *
- * 1. Add your hook and its handler to `conf/config.php`:
+ * 1\. Add your hook and its handler to `conf/config.php`:
  *
  *     myapp/somehandler[] = otherapp/handler
  *
- * 2. In `myapp/somehandler`, add the hook call and pass it some data:
+ * 2\. In `myapp/somehandler`, add the hook call and pass it some data:
+ *
+ *     <?php
  *
  *     $this->hook ('myapp/somehandler', array('id' => 123));
  *
- * 3. In `otherapp/handler`, verify the request and do something
+ *     ?>
+ *
+ * 3\. In `otherapp/handler`, verify the request and do something
  * interesting with the id:
  *
  *     <?php
- *     
+ *
  *     if (! $this->internal) {
  *         die ('Cannot call me from a browser.');
  *     }
- *     
+ *
  *     if (! Form::verify_value ($this->data['id'], 'type', 'numeric')) {
  *         die ('Invalid id value');
  *     }
- *     
+ *
  *     // do something with $this->data['id']
- *     
+ *
  *     ?>
  */
 class Controller {
@@ -119,12 +148,12 @@
 	 * Extra parameters from the end of the URL.
 	 */
 	public $params = array ();
-	
+
 	/**
 	 * Whether the request originated internally or externally.
 	 */
 	public $internal = true;
-	
+
 	/**
 	 * Data sent from another handler to the current one.
 	 */
@@ -172,12 +201,12 @@
 	 * When a handler is loaded, if there is a `conf/config.php` for that
 	 * app, its contents will be loaded into `$appconf['appname']` once
 	 * the first time it is called, and accessible thereafter by any
-	 * handler in that app directly via $appconf.
+	 * handler in that app directly via `$appconf`.
 	 */
 	public static $appconf = array ();
 
 	/**
-	 * This will be set the first time chunked() is called, so the controller
+	 * This will be set the first time `chunked()` is called, so the controller
 	 * knows it's already started sending the response with
 	 * `Transfer-Encoding: chunked`.
 	 */
@@ -191,17 +220,25 @@
 	 *
 	 * Usage:
 	 *
+	 *     <?php
+	 *
 	 *     // cache indefinitely
 	 *     $this->cache = true;
 	 *
 	 *     // cache for 5 minutes
 	 *     $this->cache = 300;
 	 *
+	 *     ?>
+	 *
 	 * To clear a cached handler before its time, which you would have to
 	 * do from a separate handler since the original won't be called while
 	 * cached, you can use:
 	 *
-	 *     $memcache->delete ('myapp_handler');
+	 *     <?php
+	 *
+	 *     $cache->delete ('myapp_handler');
+	 *
+	 *     ?>
 	 */
 	public $cache = false;
 
@@ -219,7 +256,7 @@
 	 * Run an internal request from one handler to another.
 	 */
 	public function run ($uri, $data = array ()) {
-		$c = new Controller;
+		$c = new Controller (conf ('Hooks'));
 		$handler = $c->route ($uri);
 
 		if (! isset (self::$called[$uri])) {
@@ -235,12 +272,20 @@
 	 * Trigger the default error handler. Note that you must echo the
 	 * output from your handler before returning, for example:
 	 *
+	 *     <?php
+	 *
 	 *     echo $this->error ();
 	 *     return;
 	 *
+	 *     ?>
+	 *
 	 * Not like this:
 	 *
+	 *     <?php
+	 *
 	 *     return $this->error ();
+	 *
+	 *     ?>
 	 */
 	public function error ($code = 404, $title = 'Page not found', $message = '') {
 		// Erase any existing output up to this point
@@ -274,11 +319,19 @@
 	 * than the number of parameters. Handy for using named parameters
 	 * via:
 	 *
+	 *     <?php
+	 *
 	 *     extract ($this->params ('id', 'title'));
 	 *
+	 *     ?>
+	 *
 	 * Note that you can also achieve the same thing via:
 	 *
+	 *     <?php
+	 *
 	 *     list ($id, $title) = $this->params;
+	 *
+	 *     ?>
 	 */
 	public function params () {
 		$keys = func_get_args ();
@@ -289,28 +342,27 @@
 	 * Execute the request handler. $internal determines whether the
 	 * request originated internally from another handler or template,
 	 * or externally from a browser request.
-	 *
-	 * Note: We use three globals here. This may raise some flags in
-	 * you as a developer, but hear me out. These are global singletons
-	 * that the front controller creates for us, and I want to be able
-	 * to use them in handlers directly without first instantiating them,
-	 * through a `::getInstance()` call or otherwise. I know it's bad
-	 * form in general, but this is *by design* to save typing in handlers
-	 * and happens for these three objects only.
-	 *
-	 * I also could have simply added them as properties of `$this`, but
-	 * that would add typing too (e.g., `$this->view->render` vs
-	 * `$tpl->render`). I'm opting for conciseness. And as it is, I'm
-	 * deliberately making an ordinary script act like a controller, minus
-	 * the class wrapping it. It's a stylistic decision, and if it's not
-	 * your cup of tea, that's cool. It is mine, however :)
 	 */
 	public function handle ($handler, $internal = true, $data = array ()) {
-		global $page, $tpl, $memcache;
-		
+		// Note: We use three globals here. This may raise some flags in
+		// you as a developer, but hear me out. These are global singletons
+		// that the front controller creates for us, and I want to be able
+		// to use them in handlers directly without first instantiating them,
+		// through a `::getInstance()` call or otherwise. I know it's bad
+		// form in general, but this is *by design* to save typing in handlers
+		// and happens for these three objects only.
+		//
+		// I also could have simply added them as properties of `$this`, but
+		// that would add typing too (e.g., `$this->view->render` vs
+		// `$tpl->render`). I'm opting for conciseness. And as it is, I'm
+		// deliberately making an ordinary script act like a controller, minus
+		// the class wrapping it. It's a stylistic decision, and if it's not
+		// your cup of tea, that's cool. It is mine, however :)
+		global $page, $tpl, $cache;
+
 		// Check for a cached copy of this handler's output
 		$cache_uri = '_c_' . str_replace ('/', '_', $this->uri);
-		$out = $memcache->get ($cache_uri);
+		$out = $cache->get ($cache_uri);
 		if ($out) {
 			return $out;
 		}
@@ -323,12 +375,26 @@
 		// Load the app's configuration settings if available
 		if (! isset (self::$appconf[$this->app])) {
 			try {
+				// First load the default configuration
 				self::$appconf[$this->app] = file_exists ('apps/' . $this->app . '/conf/config.php')
-					? parse_ini_file ('apps/' . $this->app . '/conf/config.php', true)
+					? parse_ini_file ('apps/' . $this->app . '/conf/config.php', TRUE)
 					: array ();
 			} catch (Exception $e) {
+				// Catch and set to empty
 				self::$appconf[$this->app] = array ();
 			}
+
+			try {
+				// Now check for a custom configuration
+				self::$appconf[$this->app] = file_exists ('conf/app.' . $this->app . '.' . ELEFANT_ENV . '.php')
+					? array_replace_recursive (
+						self::$appconf[$this->app],
+						parse_ini_file ('conf/app.' . $this->app . '.' . ELEFANT_ENV . '.php', true)
+					  )
+					: self::$appconf[$this->app];
+			} catch (Exception $e) {
+				// Do nothing because self::$appconf[$this->app] is already set
+			}
 		}
 		$appconf = self::$appconf[$this->app];
 
@@ -340,15 +406,15 @@
 		// If this is a chunked request, flush and exit
 		if ($this->chunked) {
 			$this->flush ($out);
-			$this->flush (null);
+			$this->flush (NULL);
 		}
 
 		// If the handler is cacheable, cache the results before returning
-		if ($this->cache !== false) {
+		if ($this->cache !== FALSE) {
 			$timeout = is_numeric ($this->cache) ? $this->cache : 0;
-			$res = $memcache->replace ($cache_uri, $out, 0, $timeout);
-			if ($res === false) {
-				$memcache->set ($cache_uri, $out, 0, $timeout);
+			$res = $cache->replace ($cache_uri, $out, 0, $timeout);
+			if ($res === FALSE) {
+				$cache->set ($cache_uri, $out, 0, $timeout);
 			}
 		}
 		return $out;
@@ -385,7 +451,7 @@
 
 		// Determine the handler by cascading through potential file names
 		// until one matches.
-		list ($app, $handler) = preg_split ('/\//', $uri, 2);
+		list ($app, $handler) = explode ('/', $uri, 2);
 		$route = 'apps/' . $app . '/handlers/' . $handler . '.php';
 		while (! file_exists ($route)) {
 			$route = preg_replace ('/\/([^\/]*)\.php$/e', '$this->add_param (\'\\1\')', $route);
@@ -437,10 +503,46 @@
 	}
 
 	/**
+	 * Turn a relative URL into an absolute URL. If the `$base` is false,
+	 * it will use the HTTP_HOST to construct a base for you.
+	 */
+	public function absolutize ($url, $base = false) {
+		if (strpos ($url, '://') !== false) {
+			// already contains scheme
+			return $url;
+		}
+
+		if (strpos ($url, '//') === 0) {
+			// scheme relative, add scheme
+			return $this->is_https ()
+				? 'https:' . $url
+				: 'http:' . $url;
+		}
+
+		if ($base === false) {
+			// construct the base from HTTP_HOST
+			$base = $this->is_https ()
+				? 'https://' . $_SERVER['HTTP_HOST']
+				: 'http://' . $_SERVER['HTTP_HOST'];
+		}
+
+		if (strpos ($url, '/') === 0) {
+			// absolute to the site root
+			return $base . $url;
+		}
+
+		// relative, so assume the base contains enough of
+		// a path prefix
+		return (substr ($base, -1) === '/')
+			? $base . $url
+			: $base . '/' . $url;
+	}
+
+	/**
 	 * Redirect the current request and exit.
 	 */
 	public function redirect ($url, $exit = true) {
-		header ('Location: ' . $url);
+		header ('Location: ' . $this->absolutize ($url));
 		if ($exit) {
 			$this->quit ();
 		}
@@ -525,7 +627,15 @@
 		// Call the method with the extra URL parameters.
 		$params = $this->params;
 		array_shift ($params);
-		$res = call_user_func_array (array ($obj, $method), $params);
+		try {
+			$res = call_user_func_array (array ($obj, $method), $params);
+		} catch (ErrorException $e) {
+			$msg = $e->getMessage ();
+			if (strpos ($msg, 'Missing argument') === 0) {
+				return $obj->error ('Missing required argument');
+			}
+			return $obj->error ('Unexpected error occurred');
+		}
 
 		// If an error hasn't been output already, encode the response.
 		if ($res !== null) {
@@ -538,7 +648,7 @@
 	 * the current buffer to the client. Call this each time you want the
 	 * script to send the next chunk of data to the client.
 	 *
-	 * Note that this will cause render() to call `flush(null)` at the end,
+	 * Note that this will cause `render()` to call `flush(null)` at the end,
 	 * which will not return your output to be included in a page layout.
 	 * It will also flush and exit prior to setting a controller-level
 	 * cache of your output.
@@ -668,4 +778,4 @@
 	}
 }
 
-?>
\ No newline at end of file
+?>
diff -urBNs elefant-1.3.1-beta/lib/DB.php elefant-1.3.2-beta/lib/DB.php
--- elefant-1.3.1-beta/lib/DB.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/lib/DB.php	2012-09-13 09:15:24.000000000 -0500
@@ -25,22 +25,24 @@
  */
 
 /**
- * This is a database abstraction layer that provides two things:
+ * DB is a database abstraction layer and connection manager. It provides two things:
  *
  * 1. A flexible connection manager with lazy loading and master/slave awareness.
  * 2. A set of convenience methods that operate transparently on the PDO connection(s).
  *
  * The connection manager lazy loads the connections on the first call to
- * DB::get_connection(), so requests that don't need a database connection
+ * `DB::get_connection()`, so requests that don't need a database connection
  * don't suffer the extra overhead. It is also master/slave aware, with write
  * requests going to the master and reads being directed to a random connection.
  *
  * Note: This is a simple database abstraction layer. For more advanced modelling
- * see `lib/Mode.php` which provides a more complete abstraction and a way of
+ * see [[Model]] which provides a more complete abstraction and a way of
  * organizing your application logic.
  *
  * Usage:
  *
+ *     <?php
+ *     
  *     if (! DB::open (array (
  *         'driver' => 'sqlite', 'file' => 'conf/site.db'
  *     ))) {
@@ -63,6 +65,8 @@
  *     $fieldname = DB::shift (
  *         'select fieldname from sometable where id = ?', $id
  *     );
+ *     
+ *     ?>
  *
  * Values inserted use proper prepared statements and bound parameters to prevent
  * SQL injection.
@@ -95,7 +99,7 @@
 
 	/**
 	 * Open a database connection and add it to the pool. Accepts
-	 * an array of connection info taken from the global conf().
+	 * an array of connection info taken from the global `conf()`.
 	 */
 	public static function open ($conf) {
 		if (! self::$connections) {
@@ -209,7 +213,7 @@
 	}
 	
 	/**
-	 * Normalize use of escape characters (`) to the database
+	 * Normalize use of escape characters (<code>`</code>) to the database
 	 * that's currently in use.
 	 */
 	public static function normalize_sql ($db, $sql) {
@@ -275,6 +279,21 @@
 			return false;
 		}
 	}
+
+	/**
+	 * Execute a query and return the PDO statement object
+	 * so you can minimize memory usage.
+	 */
+	public static function query () {
+		try {
+			list ($stmt, $args) = self::prepare (func_get_args ());
+			$stmt->execute ($args);
+			return $stmt;
+		} catch (Exception $e) {
+			self::$error = $e->getMessage ();
+			return false;
+		}
+	}
 	
 	/**
 	 * Fetch a single object.
@@ -371,6 +390,30 @@
 	public static function last_args () {
 		return self::$last_args;
 	}
+
+	/**
+	 * Begin a database transaction.
+	 */
+	public static function beginTransaction () {
+		$db = self::get_connection (1);
+		return $db->beginTransaction ();
+	}
+
+	/**
+	 * Commit a database transaction.
+	 */
+	public static function commit () {
+		$db = self::get_connection (1);
+		return $db->commit ();
+	}
+
+	/**
+	 * Rollback a database transaction.
+	 */
+	public static function rollback () {
+		$db = self::get_connection (1);
+		return $db->rollback ();
+	}
 }
 
 /**
diff -urBNs elefant-1.3.1-beta/lib/Debugger.php elefant-1.3.2-beta/lib/Debugger.php
--- elefant-1.3.1-beta/lib/Debugger.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/lib/Debugger.php	2012-09-13 09:15:24.000000000 -0500
@@ -31,10 +31,14 @@
  *
  * Usage:
  *
+ *     <?php
+ *     
  *     if (conf ('General', 'debug')) {
  *         require_once ('lib/Debugger.php');
  *         Debugger::start ();
  *     }
+ *     
+ *     ?>
  */
 class Debugger {
 	/**
diff -urBNs elefant-1.3.1-beta/lib/ExtendedModel.php elefant-1.3.2-beta/lib/ExtendedModel.php
--- elefant-1.3.1-beta/lib/ExtendedModel.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/lib/ExtendedModel.php	2012-09-13 09:15:24.000000000 -0500
@@ -25,7 +25,7 @@
  */
 
 /**
- * ExtendedModel extends Model to include the ability to add arbitrary values
+ * ExtendedModel extends [[Model]] to include the ability to add arbitrary values
  * to a single field that will be JSON encoded in storage and transparently
  * decoded in use. This allows you to extend your Model data with any number
  * of additional values without needing to change your schema.
@@ -37,81 +37,82 @@
  *
  * Usage:
  *
- * 1. By specifying allowed extended fields in `$verify`
+ * 1\. By specifying allowed extended fields in `$verify`
  *
- *   <?php
- *   
- *   class Foo extends ExtendedModel {
- *     // store extended data in a field named extradata
- *     public $_extended_field = 'extradata';
- *     
- *     public $verify = array (
- *       // regular field validations, followed by extended fields:
- *       'favorite_food' => array (
- *         'extended' => 1 // mark as extended
- *       ),
- *       'favorite_color' => array (
- *         'extended' => 1, // can also have validation rules:
- *         'regex' => '/^(red|green|blue|yellow|orange|purple|pink|brown)$/i'
- *     );
- *   }
- *   
- *   // fetch an item
- *   $foo = new Foo (1);
- *   
- *   // since we've defined the extended fields, we can access them directly
- *   $foo->favorite_food = 'pizza';
- *
- *   // this will fail to save because the validation fails
- *   $foo->favorite_color = 'black';
- *   if (! $foo->put ()) {
- *     echo $foo->error;
- *   }
- *   
- *   ?>
+ *     <?php
+ *     
+ *     class Foo extends ExtendedModel {
+ *         // store extended data in a field named extradata
+ *         public $_extended_field = 'extradata';
+ *     
+ *         public $verify = array (
+ *             // regular field validations, followed by extended fields:
+ *             'favorite_food' => array (
+ *                 'extended' => 1 // mark as extended
+ *             ),
+ *             'favorite_color' => array (
+ *                 'extended' => 1, // can also have validation rules:
+ *                 'regex' => '/^(red|green|blue|yellow|orange|purple|pink|brown)$/i'
+ *             )
+ *         );
+ *     }
+ *     
+ *     // fetch an item
+ *     $foo = new Foo (1);
+ *     
+ *     // since we've defined the extended fields, we can access them directly
+ *     $foo->favorite_food = 'pizza';
+ *    
+ *     // this will fail to save because the validation fails
+ *     $foo->favorite_color = 'black';
+ *     if (! $foo->put ()) {
+ *         echo $foo->error;
+ *     }
+ *     
+ *     ?>
  *
- * 2. By accessing the extradata field directly (will automatically serialize
+ * 2\. By accessing the extradata field directly (will automatically serialize
  * and unserialize for you), or through the `ext()` method:
  *
- *   <?php
- *   
- *   class Foo extends ExtendedModel {
- *     // store extended data in a field named extradata
- *     public $_extended_field = 'extradata';
- *   }
- *   
- *   // fetch an item
- *   $foo = new Foo (1);
- *   
- *   // get its extradata field
- *   $extra = $foo->extradata;
- *
- *   // or
- *   $extra = $foo->ext ();
- *
- *   // add some fields to it
- *   $extra['favorite_food'] = 'pizza';
- *   $extra['favorite_color'] = 'green';
- *
- *   // or
- *   $foo->ext ('favorite_food', 'pizza');
- *   $foo->ext ('favorite_color', 'green');
- *
- *   // set it and save it
- *   $foo->extradata = $extra;
- *   $foo->put ();
- *
- *   // next time we retrieve the item
- *   // our data will be there
- *   $foo = new Foo (1);
- *   $extra = $foo->extra;
- *   echo $extra['favorite_food'];
- *
- *   // or
- *   $foo = new Foo (1);
- *   echo $foo->ext ('favorite_food');
- *   
- *   ?>
+ *     <?php
+ *     
+ *     class Foo extends ExtendedModel {
+ *         // store extended data in a field named extradata
+ *         public $_extended_field = 'extradata';
+ *     }
+ *     
+ *     // fetch an item
+ *     $foo = new Foo (1);
+ *     
+ *     // get its extradata field
+ *     $extra = $foo->extradata;
+ *     
+ *     // or
+ *     $extra = $foo->ext ();
+ *     
+ *     // add some fields to it
+ *     $extra['favorite_food'] = 'pizza';
+ *     $extra['favorite_color'] = 'green';
+ *     
+ *     // or
+ *     $foo->ext ('favorite_food', 'pizza');
+ *     $foo->ext ('favorite_color', 'green');
+ *     
+ *     // set it and save it
+ *     $foo->extradata = $extra;
+ *     $foo->put ();
+ *     
+ *     // next time we retrieve the item
+ *     // our data will be there
+ *     $foo = new Foo (1);
+ *     $extra = $foo->extra;
+ *     echo $extra['favorite_food'];
+ *     
+ *     // or
+ *     $foo = new Foo (1);
+ *     echo $foo->ext ('favorite_food');
+ *      
+ *     ?>
  */
 class ExtendedModel extends Model {
 	/**
@@ -150,8 +151,7 @@
 	 * Need to verify extended fields, so we override the put() method.
 	 */
 	public function put () {
-		$f = new Form;
-		$failed = $f->verify_values ($this->ext (), $this->_extended_verify);
+		$failed = Validator::validate_list ($this->ext (), $this->_extended_verify);
 		if (! empty ($failed)) {
 			$this->error = 'Validation failed for extended fields: ' . join (', ', $failed);
 			return false;
diff -urBNs elefant-1.3.1-beta/lib/Form.php elefant-1.3.2-beta/lib/Form.php
--- elefant-1.3.1-beta/lib/Form.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/lib/Form.php	2012-09-13 09:15:24.000000000 -0500
@@ -25,7 +25,7 @@
  */
 
 /**
- * This is a simple form handling class. Provides validation of the form
+ * Form is an elegant form handling class. It provides validation of the form
  * referrer, request method, cross-site request forgery (CSRF) prevention,
  * and numerous convenience functions for validating form submissions and
  * input data. Also integrates with the `/js/jquery.verify_values.js`
@@ -171,11 +171,15 @@
 	 *
 	 * Usage:
 	 *
+	 *     <?php
+	 *     
 	 *     $f = new Form (); // defaults and no Controller or rules set
 	 *     $f = new Form ('post'); // POST requests but no Controller or rules
 	 *     $f = new Form ('post', $this); // POST and Controller set
 	 *     $f = new Form ('post', 'myapp/rules'); // POST and rules set
 	 *     $f = new Form ('post', 'myapp/rules, $this); // Everything set
+	 *     
+	 *     ?>
 	 *
 	 * Note that if the rules are not set but the Controller is passed,
 	 * the rules file will be assumed to match the appname/handlername of
@@ -183,7 +187,11 @@
 	 * well. This is the most handy scenario, since if you match your
 	 * rules file, handler, and view names, you can simply say:
 	 *
+	 *     <?php
+	 *     
 	 *     $f = new Form ('post', $this);
+	 *     
+	 *     ?>
 	 *
 	 * And it will set everything up correctly based on `$this->uri` in the
 	 * Controller.
@@ -204,7 +212,7 @@
 		// Fetch any form validation rules
 		if (! empty ($form_rules)) {
 			if (! file_exists ($form_rules)) {
-				list ($app, $form) = explode ('/', $form_rules);
+				list ($app, $form) = explode ('/', $form_rules, 2);
 				$form_rules = 'apps/' . $app . '/forms/' . $form . '.php';
 			}
 			if (file_exists ($form_rules)) {
@@ -432,273 +440,17 @@
 	}
 
 	/**
-	 * Verifies the specified value, useful for input validation.
-	 * Pass the value, a type of validation, and a validator.
-	 * Types include:
-	 *
-	 * - `skip_if_empty` - a special verifier that tells `verify_values()` to skip
-	 *                   validation on the field if it's been left blank.
-	 * - `file` - a special verifier that tells `verify_values()` to check if it's
-	 *          a valid uploaded file.
-	 * - `filetype` - a special verifier that tells `verify_values()` to check if the
-	 *              file name contains one of a list of comma-separated extensions.
-	 * - `regex` - calls `preg_match($validator, $value)`
-	 * - `type` - calls `is_$validator($value)`
-	 * - `callback` - calls `call_user_func($validator, $value)`
-	 * - `email` - a valid email address
-	 * - `url` - a valid url
-	 * - `range` - number within a range e.g., `123-456`
-	 * - `length` - string of length, $verifier examples: `6, 6+, 6-12, 12-`
-	 * - `gt` - greater than
-	 * - `gte` - greater than or equal to
-	 * - `lt` - less than
-	 * - `lte` - less than or equal to
-	 * - `empty` - value is empty
-	 * - `not empty` - value is not empty
-	 * - `contains` - `stristr($value, $validator)`
-	 * - `equals` - equality test
-	 * - `date` - date value (`YYYY-MM-DD`)
-	 * - `time` - time value (`HH:MM:SS`)
-	 * - `datetime` - date and time value (`YYYY-MM-DD HH:MM:SS`)
-	 * - `header` - verifies there are no newlines so spammers can't pass headers to `mail()`
-	 * - `unique` - verifies it's unique to a table and column in the database,
-	 *            `$verifier` should be `'table_name.column_name'`
-	 * - `exists` - verifies that a file exists in the specified directory,
-	 *            `$verifier` should be a directory path with no trailing /,
-	 *            or optionally a file path with `%s` in it for the form value.
-	 * - `matches` - Matches another variable, e.g., `"$_POST['name']"`, must be a
-	 *             global or superglobal.
-	 *
-	 * Functions must accept only the value of the variable and return
-	 * a boolean value.
-	 *
-	 * You can also specify 'not' in front of any rule to check for its
-	 * opposite, for example "not empty".
-	 *
-	 * For array elements (e.g., `<input name="name[]" />`), you can also specify
-	 * 'each' in front of any rule and the rule will be applied to each element
-	 * of the array instead of the array itself. Note that the 'each' must come
-	 * before 'not', for example "each email" would make sure each is a valid
-	 * email address, and "each not empty" would make sure each is not empty.
+	 * Alias of `Validator::validate()`.
 	 */
 	public static function verify_value ($value, $type, $validator = false) {
-		if ($type === 'default') {
-			return true;
-		}
-		if (preg_match ('/^each (.+)$/i', $type, $regs)) {
-			if (! is_array ($value)) {
-				// can't specify each on non-array value
-				return false;
-			}
-			foreach ($value as $val) {
-				if (! Form::verify_value ($val, $regs[1], $validator)) {
-					return false;
-				}
-			}
-			return true;
-		}
-		if (preg_match ('/^not (.+)$/i', $type, $regs)) {
-			return ! Form::verify_value ($value, $regs[1], $validator);
-		}
-		switch ($type) {
-			case 'matches':
-				if (preg_match ('/\$(_[a-z]+|GLOBALS)\[[\'"]?([a-z0-9_-]+)[\'"]?\]/i', $validator, $regs)) {
-					// Can't dynamically reference superglobals, so instead...
-					switch ($regs[1]) {
-						case '_POST':
-							return ($value === $_POST[$regs[2]]);
-						case '_GET':
-							return ($value === $_GET[$regs[2]]);
-						case '_REQUEST':
-							return ($value === $_REQUEST[$regs[2]]);
-						case '_SERVER':
-							return ($value === $_SERVER[$regs[2]]);
-						case '_FILES':
-							return ($value === $_FILES[$regs[2]]);
-						case '_COOKIE':
-							return ($value === $_COOKIE[$regs[2]]);
-						case '_SESSION':
-							return ($value === $_SESSION[$regs[2]]);
-						case '_ENV':
-							return ($value === $_ENV[$regs[2]]);
-						case 'GLOBALS':
-							return ($value === $GLOBALS[$regs[2]]);
-					}
-				}
-				return false;
-
-			case 'regex':
-				return (bool) preg_match ($validator, $value);
-
-			case 'type':
-				return call_user_func ('is_' . $validator, $value);
-
-			case 'callback':
-				return call_user_func ($validator, $value);
-
-			case 'range':
-				list ($min, $max) = explode ('-', $validator);
-				return (($min <= $value) && ($value <= $max));
-
-			case 'empty':
-				return empty ($value);
-
-			case 'length':
-				if (preg_match ('/^([0-9]+)([+-]?)([0-9]*)$/', $validator, $regs)) {
-					if (! empty ($regs[3])) {
-						if (strlen ($value) < $regs[1] || strlen ($value) > $regs[3]) {
-							return false;
-						}
-					} elseif ($regs[2] === '+' && strlen ($value) < $regs[1]) {
-						return false;
-					} elseif ($regs[2] === '-' && strlen ($value) > $regs[1]) {
-						return false;
-					} elseif (empty ($regs[2]) && strlen ($value) != $regs[1]) {
-						return false;
-					}
-				}
-				return true;
-
-			case 'contains':
-				return (bool) stristr ($value, $validator);
-
-			case 'equals':
-				return ($value == $validator);
-
-			case 'gt':
-				return ($value > $validator);
-
-			case 'gte':
-				return ($value >= $validator);
-
-			case 'lt':
-				return ($value < $validator);
-
-			case 'lte':
-				return ($value <= $validator);
-
-			case 'email':
-				if (! filter_var ($value, FILTER_VALIDATE_EMAIL)) {
-					return false;
-				}
-
-				// also verify that the domain isn't just 'localhost'
-				// which would allow garbage in
-				list ($one, $two) = explode ('@', $value);
-				if (strpos ($two, '.') === false) {
-					return false;
-				}
-				return true;
-
-			case 'url':
-				if (! filter_var ($value, FILTER_VALIDATE_URL)) {
-					return false;
-				}
-				if (strpos ($value, '.') === false) {
-					return false;
-				}
-				return true;
-
-			case 'header':
-				return ! (bool) preg_match ('/[\r\n]/s', $value);
-
-			case 'date':
-				return (bool) preg_match ('/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/', $value);
-
-			case 'time':
-				return (bool) preg_match ('/^[0-9]{2}:[0-9]{2}:[0-9]{2}$/', $value);
-
-			case 'datetime':
-				return (bool) preg_match ('/^[0-9]{4}-[0-9]{2}-[0-9]{2} [0-9]{2}:[0-9]{2}:[0-9]{2}$/', $value);
-
-			case 'unique':
-				list ($table, $column) = preg_split ('/[\.:\/]/', $validator);
-				$res = DB::shift ('select ' . $column . ' from ' . $table . ' where ' . $column . ' = ?', $value);
-				if ($res == $value) {
-					return false;
-				}
-				return true;
-
-			case 'exists':
-				if (strpos ($validator, '%s') !== false) {
-					return file_exists (sprintf ($validator, $value));
-				}
-				return file_exists ($validator . '/' . $value);
-		}
-		// If tests fail, be safe and fail by default
-		return false;
+		return Validator::validate ($value, $type, $validator);
 	}
 	
 	/**
-	 * Validate a list of values, such as `$_GET` or `$_POST` data against
-	 * a list of validation rules. If the rules are a string, it will
-	 * look for a file and parse it using `parse_ini_file()` for the rules.
-	 * The format is as follows:
-	 *
-	 *     [field1]
-	 *     email = 1
-	 *     
-	 *     [field2]
-	 *     type = string
-	 *     regex = "/^[a-z]+$/i"
-	 *     
-	 *     [field3]
-	 *     skip_if_empty = 1
-	 *     unique = "table.column"
-	 *
-	 * Returns an array of failed fields. If the array is empty, everything
-	 * passed.
+	 * Alias of `Validator::validate_list()`.
 	 */
 	public function verify_values ($values, $validations = array ()) {
-		if (is_string ($validations) && file_exists ($validations)) {
-			$validations = parse_ini_file ($validations, true);
-		}
-		$failed = array ();
-		foreach ($validations as $name => $validators) {
-			foreach ($validators as $type => $validator) {
-				if ($type === 'file') {
-					if (! is_uploaded_file ($_FILES[$name]['tmp_name'])) {
-						$failed[] = $name;
-						break;
-					} else {
-						continue;
-					}
-				}
-				if ($type === 'filetype') {
-					$extensions = preg_split ('/, ?', trim (strtolower ($validator)));
-					if ($extensions === false) {
-						$extensions = array ($validator);
-					}
-					$extension = strtolower (pathinfo ($_FILES[$name]['name'], PATHINFO_EXTENSION));
-					if (! in_array ($extension, $extensions)) {
-						$failed[] = $name;
-						break;
-					} else {
-						continue;
-					}
-				}
-				if ($type === 'skip_if_empty') {
-					if (is_array ($values[$name])) {
-						foreach ($values[$name] as $k => $v) {
-							if (empty ($v)) {
-								// Unset empty array values so they're not checked against the other rules
-								unset ($values[$name][$k]);
-							}
-						}
-						continue;
-					} elseif (empty ($values[$name]) && (! isset ($_FILES[$name]) || $_FILES[$name]['error'] === 4)) {
-						break;
-					} else {
-						continue;
-					}
-				}
-				if (! isset ($values[$name]) || ! Form::verify_value ($values[$name], $type, $validator)) {
-					$failed[] = $name;
-					break;
-				}
-			}
-		}
-		return $failed;
+		return Validator::validate_list ($values, $validations);
 	}
 }
 
Files elefant-1.3.1-beta/lib/Functions.php and elefant-1.3.2-beta/lib/Functions.php are identical
diff -urBNs elefant-1.3.1-beta/lib/I18n.php elefant-1.3.2-beta/lib/I18n.php
--- elefant-1.3.1-beta/lib/I18n.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/lib/I18n.php	2012-09-13 09:15:24.000000000 -0500
@@ -73,6 +73,21 @@
 	public $fullname = '';
 
 	/**
+	 * The full date format to send to jQuery.localize.
+	 */
+	public $date_format = 'mmmm d, yyyy';
+
+	/**
+	 * The short date format to send to jQuery.localize.
+	 */
+	public $short_format = 'mmm d';
+
+	/**
+	 * The time format to send to jQuery.localize.
+	 */
+	public $time_format = 'h:MMa';
+
+	/**
 	 * Contains fallback text replacements.
 	 */
 	public $fallbacks = array ();
@@ -147,6 +162,9 @@
 		$this->language = $this->negotiate ();
 		$this->charset = $this->languages[$this->language]['charset'];
 		$this->fullname = $this->languages[$this->language]['name'];
+		$this->date_format = isset ($this->languages[$this->language]['date_format']) ? $this->languages[$this->language]['date_format'] : 'mmmm d, yyyy';
+		$this->short_format = isset ($this->languages[$this->language]['short_format']) ? $this->languages[$this->language]['short_format'] : 'mmm d';
+		$this->time_format = isset ($this->languages[$this->language]['time_format']) ? $this->languages[$this->language]['time_format'] : 'h:MMa';
 		$this->setLocale ();
 		$this->getIndex ();
 
@@ -289,6 +307,7 @@
 					}
 
 					if (isset ($cn)) {
+						$cn = strtolower ($cn);
 						if (isset ($accepted[$lang]) && is_array ($accepted[$lang])) {
 							$accepted[$lang][] = $cn;
 						} else {
@@ -308,7 +327,7 @@
 
 			foreach ($accepted as $lang => $cnlist) {
 				foreach ($cnlist as $cn) {
-					if (! empty ($cn)) {
+					if (! empty ($cn) && $cn !== $lang) {
 						$name = strtolower ($lang . '_' . $cn);
 					} else {
 						$name = strtolower ($lang);
@@ -427,18 +446,31 @@
 }
 
 /**
- * Helper function available globablly. Alias of `I18n::get()`.
+ * Helper function available globally. Alias of `I18n::get()`.
  */
 function i18n_get ($original = '') {
 	return $GLOBALS['i18n']->get ($original);
 }
 
 /**
- * Helper function available globablly. Alias of `I18n::getf()`.
+ * Helper function available globally. Alias of `I18n::getf()`.
  */
 function i18n_getf () {
 	$args = func_get_args ();
 	return call_user_func_array (array ($GLOBALS['i18n'], 'getf'), $args);
 }
 
+/**
+ * Helper function available globally. Alias of either `I18n::get()`
+ * and `I18n::getf()` depending on whether it's called with one
+ * parameter or several.
+ */
+function __ ($original = '') {
+	if (func_num_args () === 1) {
+		return $GLOBALS['i18n']->get ($original);
+	}
+	$args = func_get_args ();
+	return call_user_func_array (array ($GLOBALS['i18n'], 'getf'), $args);
+}
+
 ?>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/lib/Ini.php elefant-1.3.2-beta/lib/Ini.php
--- elefant-1.3.1-beta/lib/Ini.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/lib/Ini.php	2012-09-13 09:15:24.000000000 -0500
@@ -6,23 +6,23 @@
  *
  * Usage:
  *
- *   <?php
- *   
- *   // Parsing files or strings
- *   $data = Ini::parse ('ini_filename_or_string', true);
- *   
- *   // Write a data structure into an INI-formatted string
- *   $ini = Ini::write ($data);
- *   
- *   // Write a data structure to an INI-formatted file
- *   $res = Ini::write ($data, 'filename.ini');
- *   
- *   ?>
+ *     <?php
+ *     
+ *     // Parsing files or strings
+ *     $data = Ini::parse ('ini_filename_or_string', true);
+ *     
+ *     // Write a data structure into an INI-formatted string
+ *     $ini = Ini::write ($data);
+ *     
+ *     // Write a data structure to an INI-formatted file
+ *     $res = Ini::write ($data, 'filename.ini');
+ *     
+ *     ?>
  */
 class Ini {
 	/**
 	 * Parses an INI-formatted string or file. Just an alias
-	 * for parse_ini_file/parse_ini_string that's here for
+	 * for `parse_ini_file`/`parse_ini_string` that's here for
 	 * completeness and consistency.
 	 */
 	public static function parse ($string, $sections = false, $scanner_mode = INI_SCANNER_NORMAL) {
@@ -36,10 +36,16 @@
 	 * Write a data structure to an INI-formatted string or file.
 	 * Adds "secure" comments to the start and end of the data so
 	 * you can hide your INI data in files using a .php extension.
+	 * If a `$header` is provided, it will add that as a comment to
+	 * the top of the file.
 	 */
-	public static function write ($data, $file = false) {
+	public static function write ($data, $file = false, $header = false) {
 		$out = "; <?php /*\n";
 
+		if ($header !== false) {
+			$out .= ";\n; $header\n;\n";
+		}
+
 		$write_value = function ($value) {
 			if (is_bool ($value)) {
 				return ($value) ? 'On' : 'Off';
@@ -48,7 +54,7 @@
 			} elseif ($value === '1') {
 				return 'On';
 			} elseif (preg_match ('/[^a-z0-9\/\.@<> _-]/i', $value)) {
-				return '"' . $value . '"';
+				return '"' . str_replace ('"', '\"', $value) . '"';
 			}
 			return $value;
 		};
diff -urBNs elefant-1.3.1-beta/lib/Mailer.php elefant-1.3.2-beta/lib/Mailer.php
--- elefant-1.3.1-beta/lib/Mailer.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/lib/Mailer.php	2012-09-13 09:15:24.000000000 -0500
@@ -32,65 +32,65 @@
 require_once ('Zend/Mime/Part.php');
 
 /**
- * This is a wrapper class around Zend_Mail that configures it based
- * on Elefant's global mailer settings.
+ * Mailer is a wrapper around Zend_Mail configured from Elefant's global
+ * mail settings.
  *
  * Usage:
  *
- *   <?php
- *   
- *   // Using Mailer::send() as a wrapper:
- *   $mail = Mailer::send (array (
- *     'to'          => array ('user@example.com', 'Joe User'),
- *     'from'        => array ('me@widgets.com', 'Alternate Sender'),
- *     'cc'          => array ('me@widgets.com', 'CC This Guy'),
- *     'bcc'         => array ('me@widgets.com', 'BCC This Guy'),
- *     'reply_to'    => array ('me@widgets.com', 'Reply to This Guy'),
- *     'subject'     => 'Subject line',
- *     'text'        => 'This is a plain text message.',
- *     'html'        => 'This is an <b>html</b> message.',
- *     'attachments' => array (
- *       'File data...',
- *       // or
- *       new Zend_Mime_Part ('File data...')
- *     )
- *   );
- *   
- *   // Using the Zend_Mail object directly:
- *   $mail = Mailer::getInstance ();
- *   $mail->setBodyText ('This is an email message.');
- *   $mail->setSubject ('Subject line');
- *   $mail->addTo ('user@example.com', 'Joe User');
- *   // Etc.
- *   $mail->send ();
- *   
- *   ?>
+ *     <?php
+ *     
+ *     // Using Mailer::send() as a wrapper:
+ *     $mail = Mailer::send (array (
+ *         'to'          => array ('user@example.com', 'Joe User'),
+ *         'from'        => array ('me@widgets.com', 'Alternate Sender'),
+ *         'cc'          => array ('me@widgets.com', 'CC This Guy'),
+ *         'bcc'         => array ('me@widgets.com', 'BCC This Guy'),
+ *         'reply_to'    => array ('me@widgets.com', 'Reply to This Guy'),
+ *         'subject'     => 'Subject line',
+ *         'text'        => 'This is a plain text message.',
+ *         'html'        => 'This is an <b>html</b> message.',
+ *         'attachments' => array (
+ *             'File data...',
+ *             // or
+ *             new Zend_Mime_Part ('File data...')
+ *         )
+ *     );
+ *     
+ *     // Using the Zend_Mail object directly:
+ *     $mail = Mailer::getInstance ();
+ *     $mail->setBodyText ('This is an email message.');
+ *     $mail->setSubject ('Subject line');
+ *     $mail->addTo ('user@example.com', 'Joe User');
+ *     // Etc.
+ *     $mail->send ();
+ *     
+ *     ?>
  */
 class Mailer {
 	/**
-	 * The parsed configurations from the [Mailer] section of the
+	 * The parsed configurations from the `[Mailer]` section of the
 	 * global configuration.
 	 */
 	private static $config = null;
 
 	/**
-	 * Zend_Mail object.
+	 * `Zend_Mail` object.
 	 */
 	private static $mailer = null;
 
 	/**
-	 * Zend_Mail_Transport object.
+	 * `Zend_Mail_Transport` object.
 	 */
 	private static $transport = null;
 
 	/**
-	 * If getInstance() fails, this will contain the error message.
+	 * If `getInstance()` fails, this will contain the error message.
 	 */
 	public static $error = false;
 
 	/**
-	 * Configures and fetches a singleton instance of Zend_Mail.
-	 * Also clears settings from previous use onthe Zend_Mail object
+	 * Configures and fetches a singleton instance of `Zend_Mail`.
+	 * Also clears settings from previous use onthe `Zend_Mail` object
 	 * unless you call `getInstance(false)`.
 	 */
 	public static function getInstance ($clear = true) {
@@ -162,9 +162,9 @@
 
 	/**
 	 * Send a single message to a recipient. Handy for one-off messages.
-	 * Returns the Zend_Mail object after calling `send()`, unless false
+	 * Returns the `Zend_Mail` object after calling `send()`, unless false
 	 * is passed as the second parameter, in which case `send()` is not
-	 * called and the Zend_Mail object is returned immediately.
+	 * called and the `Zend_Mail` object is returned immediately.
 	 */
 	public static function send ($msg, $send = true) {
 		$mailer = self::getInstance ();
Files elefant-1.3.1-beta/lib/MemcacheAPC.php and elefant-1.3.2-beta/lib/MemcacheAPC.php are identical
diff -urBNs elefant-1.3.1-beta/lib/MemcacheExt.php elefant-1.3.2-beta/lib/MemcacheExt.php
--- elefant-1.3.1-beta/lib/MemcacheExt.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/lib/MemcacheExt.php	2012-09-13 09:15:24.000000000 -0500
@@ -31,12 +31,19 @@
  *
  * Based on Zane Ashby's idea posted here:
  *
- * http://demonastery.org/72/tiny-memcached-wrapper/
+ * [http://demonastery.org/72/tiny-memcached-wrapper/](http://demonastery.org/72/tiny-memcached-wrapper/)
  */
 class MemcacheExt extends Memcache {
 	/**
 	 * Takes a callback function that generates the value 
 	 * if it's not found in the cache.
+	 *
+	 * - `$key` - Cache key
+	 * - `$timeout` - Seconds to cache for
+	 * - `$function` - Callback function to generate cache data
+	 *
+	 * Returns the data from cache, or from the callback and caches the results
+	 * for the next call.
 	 */
 	public function cache ($key, $timeout, $function) {
 		if (($val = $this->get ($key)) === false) {
diff -urBNs elefant-1.3.1-beta/lib/MemcacheRedis.php elefant-1.3.2-beta/lib/MemcacheRedis.php
--- elefant-1.3.1-beta/lib/MemcacheRedis.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/lib/MemcacheRedis.php	2012-09-13 09:15:24.000000000 -0500
@@ -25,8 +25,10 @@
  */
 
 /**
- * Provides a Memcache-compatible wrapper for the Redis PHP extension, available
- * at https://github.com/nicolasff/phpredis
+ * Provides a Memcache-compatible wrapper for the Redis PHP extension. For more
+ * info, see:
+ *
+ * https://github.com/nicolasff/phpredis
  *
  * This allows you to use Redis as a drop-in replacement for Memcache as a cache
  * store in Elefant.
@@ -92,7 +94,8 @@
 		if (self::$redis->exists ($key)) {
 			return false;
 		}
-		$this->setnx ($key, $value, $flag, $expire);
+		return $this->set ($key, $value, $flag, $expire);
+		//self::$redis->setnx ($key, $value, $flag, $expire);
 	}
 
 	/**
diff -urBNs elefant-1.3.1-beta/lib/Model.php elefant-1.3.2-beta/lib/Model.php
--- elefant-1.3.1-beta/lib/Model.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/lib/Model.php	2012-09-13 09:15:24.000000000 -0500
@@ -34,6 +34,8 @@
  *
  * Usage:
  *
+ *     <?php
+ *     
  *     class MyTable extends Model {
  *         function get_all_by_x () {
  *             return MyTable::query ()
@@ -64,9 +66,13 @@
  *     foreach ($res as $row) {
  *         $row->remove ();
  *     }
+ *     
+ *     ?>
  *
  * Also supports validation of values via:
  *
+ *     <?php
+ *     
  *     class MyTable extends Model {
  *         var $verify = array (
  *             'email' => array (
@@ -78,14 +84,20 @@
  *             )
  *         );
  *     }
+ *     
+ *     ?>
  *
  * Or specified as an INI file:
  *
+ *     <?php
+ *     
  *     class MyTable extends Model {
  *         var $verify = 'apps/myapp/forms/mytable.php';
  *     }
+ *     
+ *     ?>
  *
- * See Form::verify_values for more info on validation rules
+ * See `Form::verify_values` for more info on validation rules
  * and file formats.
  */
 class Model {
@@ -351,8 +363,10 @@
 	 * specified INI file if $verify is a string matching a file name.
 	 */
 	public function put () {
-		$f = new Form;
-		$failed = $f->verify_values ($this->data, $this->verify);
+		$failed = (count ($this->verify) > 0)
+			? Validator::validate_list ($this->data, $this->verify)
+			: array ();
+
 		if (! empty ($failed)) {
 			$this->failed = $failed;
 			$this->error = 'Validation failed for: ' . join (', ', $failed);
@@ -471,6 +485,10 @@
 	 *   ->order ('another_field asc') // alternate usage
 	 */
 	public function order ($by, $order = false) {
+		if (is_array ($by)) {
+			list ($by, $order) = $by;
+		}
+
 		$sep = empty ($this->query_order) ? ' ' : ', ';
 		if (! $order) {
 			$this->query_order .= $sep . $by;
@@ -805,6 +823,28 @@
 		}
 		return DB::execute ('commit');
 	}
+
+	/**
+	 * Fetch the next incremental value for the specified field.
+	 * If no field name is specified, it will use the primary key
+	 * field by default.
+	 */
+	public function next ($field = false) {
+		if ($field === false) {
+			$field = $this->key;
+		}
+		
+		$res = DB::shift (
+			'select (' . Model::backticks ($field) . ' + 1)' .
+			' from ' . Model::backticks ($this->table) .
+			' order by ' . Model::backticks ($field) . ' desc' .
+			' limit 1'
+		);
+		if (! $res) {
+			return 1;
+		}
+		return $res;
+	}
 }
 
 ?>
\ No newline at end of file
Files elefant-1.3.1-beta/lib/MongoManager.php and elefant-1.3.2-beta/lib/MongoManager.php are identical
diff -urBNs elefant-1.3.1-beta/lib/MongoModel.php elefant-1.3.2-beta/lib/MongoModel.php
--- elefant-1.3.1-beta/lib/MongoModel.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/lib/MongoModel.php	2012-09-13 09:15:24.000000000 -0500
@@ -35,6 +35,8 @@
  *
  * Usage:
  *
+ *     <?php
+ *     
  *     class MyTable extends MongoModel {
  *         function get_all_by_x () {
  *             return MyTable::query ()
@@ -65,9 +67,13 @@
  *     foreach ($res as $row) {
  *         $row->remove ();
  *     }
+ *     
+ *     ?>
  *
  * Also supports validation of values via:
  *
+ *     <?php
+ *     
  *     class MyTable extends MongoModel {
  *         var $verify = array (
  *             'email' => array (
@@ -79,14 +85,20 @@
  *             )
  *         );
  *     }
+ *     
+ *     ?>
  *
  * Or specified as an INI file:
  *
+ *     <?php
+ *     
  *     class MyTable extends MongoModel {
  *         var $verify = 'apps/myapp/forms/myrules.php';
  *     }
+ *     
+ *     ?>
  *
- * See Form::verify_values for more info on validation rules
+ * See `Form::verify_values` for more info on validation rules
  * and file formats.
  *
  * Differences from Model objects:
@@ -292,8 +304,7 @@
 	 * specified INI file if $verify is a string matching a file name.
 	 */
 	public function put() {
-		$f = new Form;
-		$failed = $f->verify_values ($this->data, $this->verify);
+		$failed = Validator::validate_list ($this->data, $this->verify);
 		if (! empty ($failed)) {
 			$this->failed = $failed;
 			$this->error = 'Validation failed for: ' . join (', ', $failed);
@@ -420,11 +431,15 @@
 	 *
 	 * Query:
 	 *
+	 *     <?php
+	 *     
 	 *     $res = MyModel::query ()->group (
 	 *         array ('category' => 1),                               // keys
 	 *         array ('items' => array ()),                           // initial
 	 *         'function (obj, prev) { prev.items.push (obj.name); }' // reduce
 	 *     );
+	 *     
+	 *     ?>
 	 *
 	 * Results:
 	 *
diff -urBNs elefant-1.3.1-beta/lib/Page.php elefant-1.3.2-beta/lib/Page.php
--- elefant-1.3.1-beta/lib/Page.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/lib/Page.php	2012-09-13 09:15:24.000000000 -0500
@@ -32,7 +32,11 @@
  * The layout property sets which template should be used to
  * render the design of the page, unless you specify:
  *
+ *     <?php
+ *     
  *     $page->layout = false;
+ *     
+ *     ?>
  *
  * This will skip the layout and simply return the page body
  * to the user.
diff -urBNs elefant-1.3.1-beta/lib/Product.php elefant-1.3.2-beta/lib/Product.php
--- elefant-1.3.1-beta/lib/Product.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/lib/Product.php	2012-09-13 09:15:24.000000000 -0500
@@ -1,6 +1,7 @@
 <?php
 
 /**
+ * Provides the abstracted product info for white-labelling the CMS.
  * This class parses and returns values from `conf/product.php` which makes it easy
  * to rebrand the CMS interface with your own name, logo, website link,
  * and stylesheet.
diff -urBNs elefant-1.3.1-beta/lib/Restful.php elefant-1.3.2-beta/lib/Restful.php
--- elefant-1.3.1-beta/lib/Restful.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/lib/Restful.php	2012-09-13 09:15:24.000000000 -0500
@@ -25,14 +25,15 @@
  */
 
 /**
- * A class that can be extended and passed to `Controller::restful()`
+ * Restful is a base class for implementing REST APIs. Restful is
+ * meant to be extended and passed to `Controller::restful()`
  * to create RESTful request handlers. Works with GET, POST, PUT, and
  * DELETE request methods, as well as the `X-HTTP-Method-Override`
  * header if your server can't handle PUT and DELETE requests.
  *
  * Usage:
  *
- * 1. Create a Restful-based class and save it to
+ * 1\. Create a Restful-based class and save it to
  * the file `apps/myapp/lib/API.php`:
  *
  *     <?php
@@ -55,11 +56,17 @@
  *             return $this->error ('Error message');
  *         }
  *     }
+ *     
+ *     ?>
  *
- * 2. Create a handler and assign your class as its
+ * 2\. Create a handler and assign your class as its
  * restful handler in the file `apps/myapp/handlers/api.php`:
  *
- *     <?php $this->restful (new myapp\API); ?>
+ *     <?php
+ *     
+ *     $this->restful (new myapp\API);
+ *     
+ *     ?>
  *
  * Responses come in the following form, depending on success
  * or failure:
diff -urBNs elefant-1.3.1-beta/lib/Template.php elefant-1.3.2-beta/lib/Template.php
--- elefant-1.3.1-beta/lib/Template.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/lib/Template.php	2012-09-13 09:15:24.000000000 -0500
@@ -25,13 +25,13 @@
  */
 
 /**
- * Basic template renderer. Looks for templates via the pattern
- * `apps/{app}/views/{file}.html` where the template is passed as
- * `'app/file'`. Failing that, it looks for `layouts/{file}.html`
- * and finally `layouts/default.html`. It then creates a PHP version
- * of the template  and caches it to `cache/{app}-{template}.php`,
- * so the cache folder must be writeable. Auto-refreshes cached
- * versions when the originals change.
+ * Template is a template compiler and rendering engine. It looks
+ * for templates via the pattern `apps/{app}/views/{file}.html`
+ * where the template is passed as `'app/file'`. Failing that, it
+ * looks for `layouts/{file}.html` and finally `layouts/default.html`.
+ * It then creates a PHP version of the template  and caches it to
+ * `cache/{app}-{template}.php`, so the cache folder must be writeable.
+ * Auto-refreshes cached versions when the originals change.
  *
  * As a result, templates can include any PHP, along with tags of
  * the form:
@@ -49,17 +49,24 @@
  *     {% end %}
  *
  * Note the use of loop_index and loop_value, which are defined for
- * you inside foreach loops by the template engine.
+ * you inside foreach loops by the template engine, or you can specify
+ * your own key and value names:
  *
- * You can also test for more complex conditions, but make sure the
- * value being tested for is not preceeded by anything. For example,
- * no false checks via `{% if !some_val %}`, instead use:
+ *     {% for pages as key, page %}
+ *         {{ key }} - {{ page }}
+ *     {% end %}
  *
- *     {% if some_val == false %}
- *         {{ some_val }}
+ * You can also test for more complex conditions, for example:
+ *
+ *     {% if ! some_val %}
+ *         No value.
+ *     {% end %}
+ *
+ *     {% if some_val == 'some value' %}
+ *         Value: {{ some_val }}
  *     {% end %}
  *
- * Note that `'endif'` and `'endforeach'` are valid as well as `'end'`,
+ * Note that `endif` and `endforeach` are valid as well as `end`,
  * if you prefer, for the sake of clarity.
  *
  * Here's one more example of how to loop through an array of arrays:
@@ -94,7 +101,11 @@
  *
  * To call a template, use:
  *
+ *     <?php
+ *     
  *     echo $tpl->render ('base', array ('foo' => 'bar'));
+ *     
+ *     ?>
  *
  * Note that arrays passed to templates are converted to objects,
  * and objects are left as-is.
@@ -165,6 +176,8 @@
  *
  *     {{ body|strtoupper|strtolower }}
  *
+ * This evaluates to:
+ *
  *     <?php echo strtolower (strtoupper ($data->body)); ?>
  *
  * You can also set additional parameters to a filter as follows:
@@ -194,12 +207,37 @@
 	public $cache_folder = 'cache';
 
 	/**
-	 * The controller object used to run includes.
+	 * The layouts location.
+	 */
+	public $layouts_folder = 'layouts';
+	
+	/**
+	 * The app view locations.
+	 */
+	public $view_folders = 'apps/%s/views/%s';
+	
+	/**
+	 * Default layout filename.
+	 */
+	public $default_layout = 'default';
+	
+	/**
+	 * File extension.
+	 */
+	public $file_extension = 'html';
+
+	/**
+	 * The controller object used to run includes. The controller can be
+	 * any object that satisfies the following interface:
+	 *
+	 *     interface AbstractController {
+	 *         public function run ($uri, $data = array ());
+	 *     }
 	 */
 	public $controller = null;
 
 	/**
-	 * Constructor method sets the charset and receives a Controller object.
+	 * Constructor method sets the charset and receives a controller object.
 	 */
 	public function __construct ($charset = 'UTF-8', $controller = false) {
 		$this->charset = $charset;
@@ -226,19 +264,19 @@
 		// `layouts/default.html`
 		if (strstr ($template, '/')) {
 			list ($app, $view) = preg_split ('/\//', $template, 2);
-			$file = 'apps/' . $app . '/views/' . $view . '.html';
+			$file = sprintf ($this->view_folders, $app, $view . '.' . $this->file_extension);
 			if (! file_exists ($file)) {
-				$file = 'layouts/' . $app . '/' . $view . '.html';
+				$file = $this->layouts_folder . '/' . $app . '/' . $view . '.' . $this->file_extension;
 				if (! file_exists ($file)) {
-					die ('Template not found: ' . $template);
+					throw new RuntimeException ('Template not found: ' . $template);
 				}
 			}
-		} elseif (file_exists ('layouts/' . $template . '.html')) {
-			$file = 'layouts/' . $template . '.html';
-		} elseif (file_exists ('layouts/' . $template . '/' . $template . '.html')) {
-			$file = 'layouts/' . $template . '/' . $template . '.html';
+		} elseif (file_exists ($this->layouts_folder . '/' . $template . '.' . $this->file_extension)) {
+			$file = $this->layouts_folder . '/' . $template . '.' . $this->file_extension;
+		} elseif (file_exists ($this->layouts_folder . '/' . $template . '/' . $template . '.' . $this->file_extension)) {
+			$file = $this->layouts_folder . '/' . $template . '/' . $template . '.' . $this->file_extension;
 		} else {
-			$file = 'layouts/default.html';
+			$file = $this->layouts_folder . '/' . $this->default_layout . '.' . $this->file_extension;
 		}
 
 		// The cache file is named based on the original
@@ -249,7 +287,7 @@
 			$out = file_get_contents ($file);
 			$out = $this->parse_template ($out);
 			if (! file_put_contents ($cache, $out)) {
-				die ('Failed to generate cached template: ' . $cache);
+				throw new RuntimeException ('Failed to generate cached template: ' . $cache);
 			}
 		}
 		
@@ -272,7 +310,7 @@
 		$cache_file = $this->cache_folder . '/_preview_' . md5 ($template) . '.php';
 		$out = $this->parse_template ($template);
 		if (! file_put_contents ($cache_file, $out)) {
-			die ('Failed to generate cached template: ' . $cache_file);
+			throw new RuntimeException ('Failed to generate cached template: ' . $cache_file);
 		}
 
 		// Include the temp file, then delete it, and return the output
@@ -290,15 +328,32 @@
 	 * code, eliminating the possibility of exposing a security hole.
 	 */
 	public function parse_template ($val) {
-		$val = str_replace ('\\{{', '#EOBRACE#', $val);
-		$val = str_replace ('\\}}', '#ECBRACE#', $val);
+		$val = str_replace (
+			array (
+				'\\{{', '\\}}', '\\{%', '\\%}', '\\{"', '\\"}', '\\{\'', '\\\'}',
+				'\\{!', '\\!}', '\\{#', '\\#}'
+			),
+			array (
+				'#EOBRACE#', '#ECBRACE#', '#EOBLOCK#', '#ECBLOCK#', '#EOQUOTE#', '#ECQUOTE#',
+				'#EOQUOTE#', '#ECQUOTE#', '#EOINCLUDE#', '#ECINCLUDE#', '#EOHARDCODE#',
+				'#ECHARDCODE#'
+			),
+			$val
+		);
 		$val = preg_replace ('/\{\{ ?(.*?) ?\}\}/e', '$this->replace_vars (\'\\1\')', $val);
 		$val = preg_replace ('/\{[\'"] ?(.*?) ?[\'"]\}/e', '$this->replace_strings (\'\\1\')', $val);
 		$val = preg_replace ('/\{\% ?(.*?) ?\%\}/e', '$this->replace_blocks (\'\\1\')', $val);
-		$val = preg_replace ('/\{\! ?(.*?) ?\!\}/e', '$this->replace_includes (\'\\1\')', $val);
-		$val = preg_replace ('/\{# ?(.*?) ?#\}/e', '$this->hard_codes (\'\\1\')', $val);
-		$val = str_replace ('#EOBRACE#', '{{', $val);
-		$val = str_replace ('#ECBRACE#', '}}', $val);
+		$val = preg_replace ('/\{\! ?(.*?) ?\!\}/es', '$this->replace_includes (\'\\1\')', $val);
+		$val = preg_replace ('/\{# ?(.*?) ?#\}/es', '$this->hard_codes (\'\\1\')', $val);
+		$val = str_replace (
+			array (
+				'#EOBRACE#', '#ECBRACE#', '#EOBLOCK#', '#ECBLOCK#', '#EOQUOTE#', '#ECQUOTE#',
+				'#EOINCLUDE#', '#ECINCLUDE#', '#EOHARDCODE#', '#ECHARDCODE#'),
+			array (
+				'{{', '}}', '{%', '%}', '{"', '"}', '{!', '!}', '{#', '#}'
+			),
+			$val
+		);
 		return $val;
 	}
 
@@ -370,6 +425,9 @@
 	 * this: `{! app/handler?param=[varname] !}`
 	 */
 	public function replace_includes ($val) {
+		// remove spaces
+		$val = preg_replace ('/[\t\n ]+(\?|\&)/', '\1', trim ($val));
+
 		$url = parse_url ($val);
 		if (isset ($url['query'])) {
 			parse_str (html_entity_decode ($url['query'], ENT_COMPAT, 'UTF-8'), $data);
@@ -412,6 +470,9 @@
 	 * here like you can with the dynamic `{! app/handler !}` calls.
 	 */
 	public function hard_codes ($val) {
+		// remove spaces
+		$val = preg_replace ('/[\t\n ]+(\?|\&)/', '\1', trim ($val));
+
 		$url = parse_url ($val);
 		if (isset ($url['query'])) {
 			parse_str (html_entity_decode ($url['query'], ENT_COMPAT, 'UTF-8'), $data);
@@ -427,6 +488,9 @@
 	 * style tags.
 	 */
 	public function run_includes ($val) {
+		// remove spaces
+		$val = preg_replace ('/[\t\n ]+(\?|\&)/', '\1', trim ($val));
+
 		$parts = preg_split ('/(\{\! ?.*? ?\!\})/e', $val, -1, PREG_SPLIT_DELIM_CAPTURE);
 		$out = '';
 		foreach ($parts as $part) {
@@ -509,19 +573,32 @@
 	 *     {% foreach some_list %}
 	 *     {% endforeach %}
 	 *
+	 *     {% foreach some_list as key, item %}
+	 *     {% endforeach %}
+	 *
+	 *     {% for some_list %}
+	 *     {% endfor %}
+	 *
+	 *     {% for some_list as item %}
+	 *     {% endfor %}
+	 *
 	 *     {% if statement %}
 	 *     {% elseif statement %}
 	 *     {% else %}
 	 *     {% endif %}
 	 *
-	 * You can also use `{% end %}` as an alias for both `{% endforeach %}`
-	 * or `{% endif %}`.
+	 * Note: `for` and `endfor` are aliases of `foreach` and `endforeach`.
+	 * You can also use `{% end %}` as an alias for `{% endforeach %}`,
+	 * `{% endfor %}` or `{% endif %}`.
 	 *
-	 * The current loop index is available via `{{ loop_index }}` and
-	 * the current loop value is available via `{{ loop_value }}`.
+	 * If an `as` clause isn't specified, the current loop index is available
+	 * via `{{ loop_index }}~ and the current loop value is available via `{{ loop_value }}`.
+	 *
+	 * If an `as` clause is specified without a key, the current loop index is available
+	 * via `{{ loop_index }}`.
 	 */
 	public function replace_blocks ($val) {
-		if ($val === 'end' || $val === 'endif' || $val === 'endforeach') {
+		if ($val === 'end' || $val === 'endif' || $val === 'endforeach' || $val === 'endfor') {
 			return '<?php } ?>';
 		}
 		
@@ -536,6 +613,17 @@
 			return '<?php echo $this->render (\'' . $extra . '\', $data); ?>';
 		}
 
+		if (($block === 'if' || $block === 'elseif') && strpos (ltrim ($extra), '!') === 0) {
+			$not = '! ';
+			$extra = ltrim ($extra, '! ');
+		} else {
+			$not = '';
+		}
+
+		if (($block === 'foreach' || $block === 'for') && strpos ($extra, ' in ') !== false) {
+			$extra = preg_replace ('/^(.*) in (.*)$/', '\2 as \1', $extra);
+		}
+
 		if (strstr ($extra, '$_')) {
 			if (strstr ($val, '.')) {
 				$extra = preg_replace ('/\.([a-zA-Z0-9_]+)/', '[\'\1\']', $extra, 1);
@@ -545,16 +633,26 @@
 		} elseif (! strstr ($extra, '::') && ! strstr ($extra, '(')) {
 			$extra = '$data->' . $extra;
 		}
-		if ($block === 'foreach') {
+		if ($block === 'foreach' || $block === 'for') {
+			if (strpos ($extra, ' as ') !== false) {
+				if (strpos ($extra, ', ') === false) {
+					return '<?php foreach (' . str_replace (' as ', ' as $data->loop_index => $data->', $extra) . ') { ?>';
+				}
+				return '<?php foreach (' . str_replace (
+					array (' as ', ', '),
+					array (' as $data->', ' => $data->'),
+					$extra
+				) . ') { ?>';
+			}
 			return '<?php foreach (' . $extra . ' as $data->loop_index => $data->loop_value) { ?>';
 		} elseif ($block === 'if') {
-			return '<?php if (' . $extra . ') { ?>';
+			return '<?php if (' . $not . $extra . ') { ?>';
 		} elseif ($block === 'elseif') {
-			return '<?php } elseif (' . $extra . ') { ?>';
+			return '<?php } elseif (' . $not . $extra . ') { ?>';
 		} elseif ($block === 'else') {
 			return '<?php } else { ?>';
 		}
-		die ('Invalid template block: ' . $val);
+		throw new LogicException ('Invalid template block: ' . $val);
 	}
 }
 
diff -urBNs elefant-1.3.1-beta/lib/Validator.php elefant-1.3.2-beta/lib/Validator.php
--- elefant-1.3.1-beta/lib/Validator.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/lib/Validator.php	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,323 @@
+<?php
+
+/**
+ * Elefant CMS - http://www.elefantcms.com/
+ *
+ * Copyright (c) 2011 Johnny Broadway
+ * 
+ * Permission is hereby granted, free of charge, to any person obtaining a copy
+ * of this software and associated documentation files (the "Software"), to deal
+ * in the Software without restriction, including without limitation the rights
+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+ * copies of the Software, and to permit persons to whom the Software is
+ * furnished to do so, subject to the following conditions:
+ * 
+ * The above copyright notice and this permission notice shall be included in
+ * all copies or substantial portions of the Software.
+ * 
+ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+ * THE SOFTWARE.
+ */
+
+/**
+ * Provides flexible input validation for form and model input. Also see
+ * the `Form` class for examples on implementing matching client-side
+ * validation through Elefant's `jquery.verify_values.js` jQuery plugin.
+ *
+ * Usage:
+ *
+ *     <?php
+ *     
+ *     // single value
+ *     if (! Validator::validate ($_POST['email'], 'email')) {
+ *         // failed
+ *     }
+ *
+ *     // list of values
+ *     $failed = Validator::validate_list (
+ *         $_POST,
+ *         'apps/myapp/forms/myform.php'
+ *     );
+ *
+ *     if (count ($failed) > 0) {
+ *         // failed
+ *     }
+ */
+class Validator {
+	/**
+	 * Verifies the specified value, useful for input validation.
+	 * Pass the value, a type of validation, and a validator.
+	 * Types include:
+	 *
+	 * - `skip_if_empty` - a special verifier that tells `validate_list()` to skip
+	 *                   validation on the field if it's been left blank.
+	 * - `file` - a special verifier that tells `validate_list()` to check if it's
+	 *          a valid uploaded file.
+	 * - `filetype` - a special verifier that tells `validate_list()` to check if the
+	 *              file name contains one of a list of comma-separated extensions.
+	 * - `regex` - calls `preg_match($validator, $value)`
+	 * - `type` - calls `is_$validator($value)`
+	 * - `callback` - calls `call_user_func($validator, $value)`
+	 * - `email` - a valid email address
+	 * - `url` - a valid url
+	 * - `range` - number within a range e.g., `123-456`
+	 * - `length` - string of length, $verifier examples: `6, 6+, 6-12, 12-`
+	 * - `gt` - greater than
+	 * - `gte` - greater than or equal to
+	 * - `lt` - less than
+	 * - `lte` - less than or equal to
+	 * - `empty` - value is empty
+	 * - `not empty` - value is not empty
+	 * - `contains` - `stristr($value, $validator)`
+	 * - `equals` - equality test
+	 * - `date` - date value (`YYYY-MM-DD`)
+	 * - `time` - time value (`HH:MM:SS`)
+	 * - `datetime` - date and time value (`YYYY-MM-DD HH:MM:SS`)
+	 * - `header` - verifies there are no newlines so spammers can't pass headers to `mail()`
+	 * - `unique` - verifies it's unique to a table and column in the database,
+	 *            `$verifier` should be `'table_name.column_name'`
+	 * - `exists` - verifies that a file exists in the specified directory,
+	 *            `$verifier` should be a directory path with no trailing /,
+	 *            or optionally a file path with `%s` in it for the form value.
+	 * - `matches` - Matches another variable, e.g., `"$_POST['name']"`, must be a
+	 *             global or superglobal.
+	 *
+	 * Functions must accept only the value of the variable and return
+	 * a boolean value.
+	 *
+	 * You can also specify 'not' in front of any rule to check for its
+	 * opposite, for example "not empty".
+	 *
+	 * For array elements (e.g., `<input name="name[]" />`), you can also specify
+	 * 'each' in front of any rule and the rule will be applied to each element
+	 * of the array instead of the array itself. Note that the 'each' must come
+	 * before 'not', for example "each email" would make sure each is a valid
+	 * email address, and "each not empty" would make sure each is not empty.
+	 */
+	public static function validate ($value, $type, $validator = false) {
+		if ($type === 'default') {
+			return true;
+		}
+		if (preg_match ('/^each (.+)$/i', $type, $regs)) {
+			if (! is_array ($value)) {
+				// can't specify each on non-array value
+				return false;
+			}
+			foreach ($value as $val) {
+				if (! Validator::validate ($val, $regs[1], $validator)) {
+					return false;
+				}
+			}
+			return true;
+		}
+		if (preg_match ('/^not (.+)$/i', $type, $regs)) {
+			return ! Validator::validate ($value, $regs[1], $validator);
+		}
+		switch ($type) {
+			case 'matches':
+				if (preg_match ('/\$(_[a-z]+|GLOBALS)\[[\'"]?([a-z0-9_-]+)[\'"]?\]/i', $validator, $regs)) {
+					// Can't dynamically reference superglobals, so instead...
+					switch ($regs[1]) {
+						case '_POST':
+							return ($value === $_POST[$regs[2]]);
+						case '_GET':
+							return ($value === $_GET[$regs[2]]);
+						case '_REQUEST':
+							return ($value === $_REQUEST[$regs[2]]);
+						case '_SERVER':
+							return ($value === $_SERVER[$regs[2]]);
+						case '_FILES':
+							return ($value === $_FILES[$regs[2]]);
+						case '_COOKIE':
+							return ($value === $_COOKIE[$regs[2]]);
+						case '_SESSION':
+							return ($value === $_SESSION[$regs[2]]);
+						case '_ENV':
+							return ($value === $_ENV[$regs[2]]);
+						case 'GLOBALS':
+							return ($value === $GLOBALS[$regs[2]]);
+					}
+				}
+				return false;
+
+			case 'regex':
+				return (bool) preg_match ($validator, $value);
+
+			case 'type':
+				return call_user_func ('is_' . $validator, $value);
+
+			case 'callback':
+				return call_user_func ($validator, $value);
+
+			case 'range':
+				list ($min, $max) = explode ('-', $validator);
+				return (($min <= $value) && ($value <= $max));
+
+			case 'empty':
+				return empty ($value);
+
+			case 'length':
+				if (preg_match ('/^([0-9]+)([+-]?)([0-9]*)$/', $validator, $regs)) {
+					if (! empty ($regs[3])) {
+						if (strlen ($value) < $regs[1] || strlen ($value) > $regs[3]) {
+							return false;
+						}
+					} elseif ($regs[2] === '+' && strlen ($value) < $regs[1]) {
+						return false;
+					} elseif ($regs[2] === '-' && strlen ($value) > $regs[1]) {
+						return false;
+					} elseif (empty ($regs[2]) && strlen ($value) != $regs[1]) {
+						return false;
+					}
+				}
+				return true;
+
+			case 'contains':
+				return (bool) stristr ($value, $validator);
+
+			case 'equals':
+				return ($value == $validator);
+
+			case 'gt':
+				return ($value > $validator);
+
+			case 'gte':
+				return ($value >= $validator);
+
+			case 'lt':
+				return ($value < $validator);
+
+			case 'lte':
+				return ($value <= $validator);
+
+			case 'email':
+				if (! filter_var ($value, FILTER_VALIDATE_EMAIL)) {
+					return false;
+				}
+
+				// also verify that the domain isn't just 'localhost'
+				// which would allow garbage in
+				list ($one, $two) = explode ('@', $value);
+				if (strpos ($two, '.') === false) {
+					return false;
+				}
+				return true;
+
+			case 'url':
+				if (! filter_var ($value, FILTER_VALIDATE_URL)) {
+					return false;
+				}
+				if (strpos ($value, '.') === false) {
+					return false;
+				}
+				return true;
+
+			case 'header':
+				return ! (bool) preg_match ('/[\r\n]/s', $value);
+
+			case 'date':
+				return (bool) preg_match ('/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/', $value);
+
+			case 'time':
+				return (bool) preg_match ('/^[0-9]{2}:[0-9]{2}:[0-9]{2}$/', $value);
+
+			case 'datetime':
+				return (bool) preg_match ('/^[0-9]{4}-[0-9]{2}-[0-9]{2} [0-9]{2}:[0-9]{2}:[0-9]{2}$/', $value);
+
+			case 'unique':
+				list ($table, $column) = preg_split ('/[\.:\/]/', $validator);
+				$res = DB::shift ('select ' . $column . ' from ' . $table . ' where ' . $column . ' = ?', $value);
+				if ($res == $value) {
+					return false;
+				}
+				return true;
+
+			case 'exists':
+				if (strpos ($validator, '%s') !== false) {
+					return file_exists (sprintf ($validator, $value));
+				}
+				return file_exists ($validator . '/' . $value);
+		}
+		// If tests fail, be safe and fail by default
+		return false;
+	}
+	
+	/**
+	 * Validate a list of values, such as `$_GET` or `$_POST` data against
+	 * a list of validation rules. If the rules are a string, it will
+	 * look for a file and parse it using `parse_ini_file()` for the rules.
+	 * The format is as follows:
+	 *
+	 *     [field1]
+	 *     email = 1
+	 *     
+	 *     [field2]
+	 *     type = string
+	 *     regex = "/^[a-z]+$/i"
+	 *     
+	 *     [field3]
+	 *     skip_if_empty = 1
+	 *     unique = "table.column"
+	 *
+	 * Returns an array of failed fields. If the array is empty, everything
+	 * passed.
+	 */
+	public static function validate_list ($values, $validations = array ()) {
+		if (is_string ($validations) && file_exists ($validations)) {
+			$validations = parse_ini_file ($validations, true);
+		}
+		$failed = array ();
+		foreach ($validations as $name => $validators) {
+			foreach ($validators as $type => $validator) {
+				if ($type === 'file') {
+					if (! is_uploaded_file ($_FILES[$name]['tmp_name'])) {
+						$failed[] = $name;
+						break;
+					} else {
+						continue;
+					}
+				}
+				if ($type === 'filetype') {
+					$extensions = preg_split ('/, ?', trim (strtolower ($validator)));
+					if ($extensions === false) {
+						$extensions = array ($validator);
+					}
+					$extension = strtolower (pathinfo ($_FILES[$name]['name'], PATHINFO_EXTENSION));
+					if (! in_array ($extension, $extensions)) {
+						$failed[] = $name;
+						break;
+					} else {
+						continue;
+					}
+				}
+				if ($type === 'skip_if_empty') {
+					if (is_array ($values[$name])) {
+						foreach ($values[$name] as $k => $v) {
+							if (empty ($v)) {
+								// Unset empty array values so they're not checked against the other rules
+								unset ($values[$name][$k]);
+							}
+						}
+						continue;
+					} elseif (empty ($values[$name]) && (! isset ($_FILES[$name]) || $_FILES[$name]['error'] === 4)) {
+						break;
+					} else {
+						continue;
+					}
+				}
+				if (! isset ($values[$name]) || ! Validator::validate ($values[$name], $type, $validator)) {
+					$failed[] = $name;
+					break;
+				}
+			}
+		}
+		return $failed;
+	}
+}
+
+?>
\ No newline at end of file
diff -urBNs elefant-1.3.1-beta/lib/View.php elefant-1.3.2-beta/lib/View.php
--- elefant-1.3.1-beta/lib/View.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/lib/View.php	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,152 @@
+<?php
+
+/**
+ * Elefant CMS - http://www.elefantcms.com/
+ *
+ * Copyright (c) 2011 Johnny Broadway
+ * 
+ * Permission is hereby granted, free of charge, to any person obtaining a copy
+ * of this software and associated documentation files (the "Software"), to deal
+ * in the Software without restriction, including without limitation the rights
+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+ * copies of the Software, and to permit persons to whom the Software is
+ * furnished to do so, subject to the following conditions:
+ * 
+ * The above copyright notice and this permission notice shall be included in
+ * all copies or substantial portions of the Software.
+ * 
+ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+ * THE SOFTWARE.
+ */
+
+/**
+ * View provides a facility for calling functions or templates and returning
+ * their data, for the purpose of separating presentational logic from
+ * handlers.
+ *
+ * Usage:
+ *
+ *     <?php
+ *     
+ *     // render a view template
+ *     echo View::render ('myapp/hello', array ('name' => 'Joe'));
+ *     
+ *     // set parameters first
+ *     View::set ('name', 'Jack');
+ *     echo View::render ('myapp/hello');
+ *     
+ *     // set a list of parameters first
+ *     View::set (array (
+ *         'name' => 'Jill',
+ *         'age' => 28
+ *     ));
+ *     
+ *     // render a view function
+ *     echo View::render (function ($params) {
+ *         return sprintf ('<p>%s</p>', join (', ', $params));
+ *     });
+ *     
+ *     // render a template from within a view function
+ *     echo View::render (function ($params) {
+ *         return View::render ('myapp/hello', $params);
+ *     });
+ *     
+ *     // pass $page to your view function
+ *     echo View::render (function ($params) use ($page) {
+ *         return sprintf ('<p>Layout: %s</p>', $page->layout);
+ *     });
+ *     
+ *     ?>
+ *
+ * Assuming `myapp/hello` contains `<p>Hello {{name}}</p>`, then the above
+ * will output:
+ *
+ *     <p>Hello Joe</p>
+ *     <p>Hello Jack</p>
+ *     <p>Jill, 28</p>
+ *     <p>Hello Jill</p>
+ *     <p>Layout: default</p>
+ *
+ * Note: To pass the controller to a view function, here's how you do it:
+ *
+ *     <?php
+ *     
+ *     // reassign the controller, since
+ *     // we can't pass $this to use()
+ *     $c = $this;
+ *     
+ *     echo View::render (function ($params) use ($c) {
+ *         if (! $c->is_https ()) {
+ *             $c->force_https ();
+ *         }
+ *         // continue with rendering...
+ *     });
+ *     
+ *     ?>
+ */
+class View {
+	/**
+	 * The template renderer.
+	 */
+	public static $tpl;
+
+	/**
+	 * Parameters passed to the next `render()` that were assigned
+	 * via `set()`.
+	 */
+	public static $params = array ();
+
+	/**
+	 * Sets the template renderer. The renderer can be any object
+	 * that satisfies the following interface:
+	 *
+	 *     interface AbstractTemplateRenderer {
+	 *         public function render ($template, $data = array ());
+	 *     }
+	 */
+	public static function init ($tpl) {
+		self::$tpl = $tpl;
+	}
+
+	/**
+	 * Set a parameter or list of parameters. Accepts a key/value
+	 * pair, or a single array or object.
+	 */
+	public static function set ($name, $value = null) {
+		if ($value === null) {
+			self::$params = $name;
+		} else {
+			self::$params[$name] = $value;
+		}
+	}
+
+	/**
+	 * Renders a view. Accepts either a function and its parameters, or a
+	 * template path and the data to pass to it.
+	 */
+	public static function render ($view, $params = null) {
+		// determine the parameters
+		if (func_num_args () > 2) {
+			$params = func_get_args ();
+			array_shift ($params);
+		} elseif ($params === null) {
+			$params = self::$params;
+		}
+
+		// reset params for the next call
+		self::$params = array ();
+
+		// render and return the response
+		if (is_callable ($view)) {
+			return $view ($params);
+		}
+		return self::$tpl->render ($view, $params);
+	}
+}
+
+?>
\ No newline at end of file
Files elefant-1.3.1-beta/lib/vendor/.htaccess and elefant-1.3.2-beta/lib/vendor/.htaccess are identical
diff -urBNs elefant-1.3.1-beta/lib/vendor/ActiveResource.php elefant-1.3.2-beta/lib/vendor/ActiveResource.php
--- elefant-1.3.1-beta/lib/vendor/ActiveResource.php	2012-05-01 08:27:02.000000000 -0500
+++ elefant-1.3.2-beta/lib/vendor/ActiveResource.php	2012-09-13 09:15:24.000000000 -0500
@@ -158,15 +158,16 @@
 		$this->_data = $data;
 		// Allow class-defined element name or use class name if not defined
 		$this->element_name = $this->element_name ? $this->element_name : strtolower (get_class ($this));
-		$this->element_name_plural = $this->pluralize ($this->element_name);
 
 		// Detect for namespaces, and take just the class name
-		if (stripos($this->element_name, '\\'))
-		{
-			$classItems = explode('\\', $this->element_name);
-			$this->element_name = end($classItems);
+		if (stripos ($this->element_name, '\\')) {
+			$classItems = explode ('\\', $this->element_name);
+			$this->element_name = end ($classItems);
 		}
 
+		// Get the plural name after removing namespaces
+		$this->element_name_plural = $this->pluralize ($this->element_name);
+
 		// If configuration file (`config.ini.php`) exists use it (overwrite class properties/attribute values).
 		$config_file_path = dirname (__FILE__) . '/' . 'config.ini.php';
 		if (file_exists ($config_file_path)) {
Files elefant-1.3.1-beta/lib/vendor/Analog/Analog.php and elefant-1.3.2-beta/lib/vendor/Analog/Analog.php are identical
Files elefant-1.3.1-beta/lib/vendor/Analog/Handler/Amon.php and elefant-1.3.2-beta/lib/vendor/Analog/Handler/Amon.php are identical
Files elefant-1.3.1-beta/lib/vendor/Analog/Handler/Buffer/Destructor.php and elefant-1.3.2-beta/lib/vendor/Analog/Handler/Buffer/Destructor.php are identical
Files elefant-1.3.1-beta/lib/vendor/Analog/Handler/Buffer.php and elefant-1.3.2-beta/lib/vendor/Analog/Handler/Buffer.php are identical
Files elefant-1.3.1-beta/lib/vendor/Analog/Handler/File.php and elefant-1.3.2-beta/lib/vendor/Analog/Handler/File.php are identical
Files elefant-1.3.1-beta/lib/vendor/Analog/Handler/FirePHP.php and elefant-1.3.2-beta/lib/vendor/Analog/Handler/FirePHP.php are identical
Files elefant-1.3.1-beta/lib/vendor/Analog/Handler/LevelBuffer.php and elefant-1.3.2-beta/lib/vendor/Analog/Handler/LevelBuffer.php are identical
Files elefant-1.3.1-beta/lib/vendor/Analog/Handler/Mail.php and elefant-1.3.2-beta/lib/vendor/Analog/Handler/Mail.php are identical
Files elefant-1.3.1-beta/lib/vendor/Analog/Handler/Mongo.php and elefant-1.3.2-beta/lib/vendor/Analog/Handler/Mongo.php are identical
Files elefant-1.3.1-beta/lib/vendor/Analog/Handler/Multi.php and elefant-1.3.2-beta/lib/vendor/Analog/Handler/Multi.php are identical
Files elefant-1.3.1-beta/lib/vendor/Analog/Handler/Null.php and elefant-1.3.2-beta/lib/vendor/Analog/Handler/Null.php are identical
Files elefant-1.3.1-beta/lib/vendor/Analog/Handler/Post.php and elefant-1.3.2-beta/lib/vendor/Analog/Handler/Post.php are identical
Files elefant-1.3.1-beta/lib/vendor/Analog/Handler/Stderr.php and elefant-1.3.2-beta/lib/vendor/Analog/Handler/Stderr.php are identical
Files elefant-1.3.1-beta/lib/vendor/Analog/Handler/Syslog.php and elefant-1.3.2-beta/lib/vendor/Analog/Handler/Syslog.php are identical
Files elefant-1.3.1-beta/lib/vendor/Analog/Handler/Variable.php and elefant-1.3.2-beta/lib/vendor/Analog/Handler/Variable.php are identical
Files elefant-1.3.1-beta/lib/vendor/Analog.php and elefant-1.3.2-beta/lib/vendor/Analog.php are identical
Files elefant-1.3.1-beta/lib/vendor/Bench.php and elefant-1.3.2-beta/lib/vendor/Bench.php are identical
Files elefant-1.3.1-beta/lib/vendor/Pimple.php and elefant-1.3.2-beta/lib/vendor/Pimple.php are identical
diff -urBNs elefant-1.3.1-beta/lib/vendor/URLify.php elefant-1.3.2-beta/lib/vendor/URLify.php
--- elefant-1.3.1-beta/lib/vendor/URLify.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/lib/vendor/URLify.php	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,188 @@
+<?php
+
+/**
+ * A PHP port of URLify.js from the Django project
+ * (https://github.com/django/django/blob/master/django/contrib/admin/static/admin/js/urlify.js).
+ * Handles symbols from Latin languages, Greek, Turkish, Russian, Ukrainian,
+ * Czech, Polish, and Latvian. Symbols it cannot transliterate
+ * it will simply omit.
+ *
+ * Usage:
+ *
+ *     echo URLify::filter (' J\'étudie le français ');
+ *     // "jetudie-le-francais"
+ *     
+ *     echo URLify::filter ('Lo siento, no hablo español.');
+ *     // "lo-siento-no-hablo-espanol"
+ */
+class URLify {
+	public static $maps = array (
+		'latin_map' => array (
+			'À' => 'A', 'Á' => 'A', 'Â' => 'A', 'Ã' => 'A', 'Ä' => 'A', 'Å' => 'A', 'Æ' => 'AE', 'Ç' =>
+			'C', 'È' => 'E', 'É' => 'E', 'Ê' => 'E', 'Ë' => 'E', 'Ì' => 'I', 'Í' => 'I', 'Î' => 'I',
+			'Ï' => 'I', 'Ð' => 'D', 'Ñ' => 'N', 'Ò' => 'O', 'Ó' => 'O', 'Ô' => 'O', 'Õ' => 'O', 'Ö' =>
+			'O', 'Ő' => 'O', 'Ø' => 'O', 'Ù' => 'U', 'Ú' => 'U', 'Û' => 'U', 'Ü' => 'U', 'Ű' => 'U',
+			'Ý' => 'Y', 'Þ' => 'TH', 'ß' => 'ss', 'à' => 'a', 'á' => 'a', 'â' => 'a', 'ã' => 'a', 'ä' =>
+			'a', 'å' => 'a', 'æ' => 'ae', 'ç' => 'c', 'è' => 'e', 'é' => 'e', 'ê' => 'e', 'ë' => 'e',
+			'ì' => 'i', 'í' => 'i', 'î' => 'i', 'ï' => 'i', 'ð' => 'd', 'ñ' => 'n', 'ò' => 'o', 'ó' =>
+			'o', 'ô' => 'o', 'õ' => 'o', 'ö' => 'o', 'ő' => 'o', 'ø' => 'o', 'ù' => 'u', 'ú' => 'u',
+			'û' => 'u', 'ü' => 'u', 'ű' => 'u', 'ý' => 'y', 'þ' => 'th', 'ÿ' => 'y'
+		),
+		'latin_symbols_map' => array (
+			'©' => '(c)'
+		),
+		'greek_map' => array (
+			'α' => 'a', 'β' => 'b', 'γ' => 'g', 'δ' => 'd', 'ε' => 'e', 'ζ' => 'z', 'η' => 'h', 'θ' => '8',
+			'ι' => 'i', 'κ' => 'k', 'λ' => 'l', 'μ' => 'm', 'ν' => 'n', 'ξ' => '3', 'ο' => 'o', 'π' => 'p',
+			'ρ' => 'r', 'σ' => 's', 'τ' => 't', 'υ' => 'y', 'φ' => 'f', 'χ' => 'x', 'ψ' => 'ps', 'ω' => 'w',
+			'ά' => 'a', 'έ' => 'e', 'ί' => 'i', 'ό' => 'o', 'ύ' => 'y', 'ή' => 'h', 'ώ' => 'w', 'ς' => 's',
+			'ϊ' => 'i', 'ΰ' => 'y', 'ϋ' => 'y', 'ΐ' => 'i',
+			'Α' => 'A', 'Β' => 'B', 'Γ' => 'G', 'Δ' => 'D', 'Ε' => 'E', 'Ζ' => 'Z', 'Η' => 'H', 'Θ' => '8',
+			'Ι' => 'I', 'Κ' => 'K', 'Λ' => 'L', 'Μ' => 'M', 'Ν' => 'N', 'Ξ' => '3', 'Ο' => 'O', 'Π' => 'P',
+			'Ρ' => 'R', 'Σ' => 'S', 'Τ' => 'T', 'Υ' => 'Y', 'Φ' => 'F', 'Χ' => 'X', 'Ψ' => 'PS', 'Ω' => 'W',
+			'Ά' => 'A', 'Έ' => 'E', 'Ί' => 'I', 'Ό' => 'O', 'Ύ' => 'Y', 'Ή' => 'H', 'Ώ' => 'W', 'Ϊ' => 'I',
+			'Ϋ' => 'Y'
+		),
+		'turkish_map' => array (
+			'ş' => 's', 'Ş' => 'S', 'ı' => 'i', 'İ' => 'I', 'ç' => 'c', 'Ç' => 'C', 'ü' => 'u', 'Ü' => 'U',
+			'ö' => 'o', 'Ö' => 'O', 'ğ' => 'g', 'Ğ' => 'G'
+		),
+		'russian_map' => array (
+			'а' => 'a', 'б' => 'b', 'в' => 'v', 'г' => 'g', 'д' => 'd', 'е' => 'e', 'ё' => 'yo', 'ж' => 'zh',
+			'з' => 'z', 'и' => 'i', 'й' => 'j', 'к' => 'k', 'л' => 'l', 'м' => 'm', 'н' => 'n', 'о' => 'o',
+			'п' => 'p', 'р' => 'r', 'с' => 's', 'т' => 't', 'у' => 'u', 'ф' => 'f', 'х' => 'h', 'ц' => 'c',
+			'ч' => 'ch', 'ш' => 'sh', 'щ' => 'sh', 'ъ' => '', 'ы' => 'y', 'ь' => '', 'э' => 'e', 'ю' => 'yu',
+			'я' => 'ya',
+			'А' => 'A', 'Б' => 'B', 'В' => 'V', 'Г' => 'G', 'Д' => 'D', 'Е' => 'E', 'Ё' => 'Yo', 'Ж' => 'Zh',
+			'З' => 'Z', 'И' => 'I', 'Й' => 'J', 'К' => 'K', 'Л' => 'L', 'М' => 'M', 'Н' => 'N', 'О' => 'O',
+			'П' => 'P', 'Р' => 'R', 'С' => 'S', 'Т' => 'T', 'У' => 'U', 'Ф' => 'F', 'Х' => 'H', 'Ц' => 'C',
+			'Ч' => 'Ch', 'Ш' => 'Sh', 'Щ' => 'Sh', 'Ъ' => '', 'Ы' => 'Y', 'Ь' => '', 'Э' => 'E', 'Ю' => 'Yu',
+			'Я' => 'Ya'
+		),
+		'ukrainian_map' => array (
+			'Є' => 'Ye', 'І' => 'I', 'Ї' => 'Yi', 'Ґ' => 'G', 'є' => 'ye', 'і' => 'i', 'ї' => 'yi', 'ґ' => 'g'
+		),
+		'czech_map' => array (
+			'č' => 'c', 'ď' => 'd', 'ě' => 'e', 'ň' => 'n', 'ř' => 'r', 'š' => 's', 'ť' => 't', 'ů' => 'u',
+			'ž' => 'z', 'Č' => 'C', 'Ď' => 'D', 'Ě' => 'E', 'Ň' => 'N', 'Ř' => 'R', 'Š' => 'S', 'Ť' => 'T',
+			'Ů' => 'U', 'Ž' => 'Z'
+		),
+		'polish_map' => array (
+			'ą' => 'a', 'ć' => 'c', 'ę' => 'e', 'ł' => 'l', 'ń' => 'n', 'ó' => 'o', 'ś' => 's', 'ź' => 'z',
+			'ż' => 'z', 'Ą' => 'A', 'Ć' => 'C', 'Ę' => 'e', 'Ł' => 'L', 'Ń' => 'N', 'Ó' => 'o', 'Ś' => 'S',
+			'Ź' => 'Z', 'Ż' => 'Z'
+		),
+		'latvian_map' => array (
+			'ā' => 'a', 'č' => 'c', 'ē' => 'e', 'ģ' => 'g', 'ī' => 'i', 'ķ' => 'k', 'ļ' => 'l', 'ņ' => 'n',
+			'š' => 's', 'ū' => 'u', 'ž' => 'z', 'Ā' => 'A', 'Č' => 'C', 'Ē' => 'E', 'Ģ' => 'G', 'Ī' => 'i',
+			'Ķ' => 'k', 'Ļ' => 'L', 'Ņ' => 'N', 'Š' => 'S', 'Ū' => 'u', 'Ž' => 'Z'
+		)
+	);
+
+	/**
+	 * List of words to remove from URLs.
+	 */
+	public static $remove_list = array (
+		'a', 'an', 'as', 'at', 'before', 'but', 'by', 'for', 'from',
+		'is', 'in', 'into', 'like', 'of', 'off', 'on', 'onto', 'per',
+		'since', 'than', 'the', 'this', 'that', 'to', 'up', 'via',
+		'with'
+	);
+
+	/**
+	 * The character map.
+	 */
+	private static $map = array ();
+
+	/**
+	 * The character list as a string.
+	 */
+	private static $chars = '';
+
+	/**
+	 * The character list as a regular expression.
+	 */
+	private static $regex = '';
+
+	/**
+	 * Initializes the character map.
+	 */
+	private static function init () {
+		if (count (self::$map) > 0) {
+			return;
+		}
+
+		foreach (self::$maps as $map) {
+			foreach ($map as $orig => $conv) {
+				self::$map[$orig] = $conv;
+				self::$chars .= $orig;
+			}
+		}
+
+		self::$regex = '/[' . self::$chars . ']/u';
+	}
+
+	/**
+	 * Add new characters to the list. `$map` should be a hash.
+	 */
+	public static function add_chars ($map) {
+		if (! is_array ($map)) {
+			throw new LogicException ('$map must be an associative array.');
+		}
+		self::$maps[] = $map;
+		self::$map = array ();
+		self::$chars = '';
+	}
+
+	/**
+	 * Append words to the remove list. Accepts either single words
+	 * or an array of words.
+	 */
+	public static function remove_words ($words) {
+		$words = is_array ($words) ? $words : array ($words);
+		self::$remove_list = array_merge (self::$remove_list, $words);
+	}
+
+	/**
+	 * Transliterates characters to their ASCII equivalents.
+	 */
+	public static function downcode ($text) {
+		self::init ();
+
+		if (preg_match_all (self::$regex, $text, $matches)) {
+			for ($i = 0; $i < count ($matches[0]); $i++) {
+				$char = $matches[0][$i];
+				if (isset (self::$map[$char])) {
+					$text = str_replace ($char, self::$map[$char], $text);
+				}
+			}
+		}
+		return $text;
+	}
+
+	/**
+	 * Filters a string, e.g., "Petty theft" to "petty-theft"
+	 */
+	public static function filter ($text, $length = 60) {
+		$text = self::downcode ($text);
+
+		// remove all these words from the string before urlifying
+		$text = preg_replace ('/\b(' . join ('|', self::$remove_list) . ')\b/i', '', $text);
+
+		// if downcode doesn't hit, the char will be stripped here
+		$text = preg_replace ('/[^-\w\s]/', '', $text);		// remove unneeded chars
+		$text = preg_replace ('/^\s+|\s+$/', '', $text);	// trim leading/trailing spaces
+		$text = preg_replace ('/[-\s]+/', '-', $text);		// convert spaces to hyphens
+		$text = strtolower ($text);							// convert to lowercase						
+		return trim (substr ($text, 0, $length), '-');	// trim to first $length chars
+	}
+
+	/**
+	 * Alias of `URLify::downcode()`.
+	 */
+	public static function transliterate ($text) {
+		return self::downcode ($text);
+	}
+}
+
+?>
\ No newline at end of file
Files elefant-1.3.1-beta/lib/vendor/Zend/Exception.php and elefant-1.3.2-beta/lib/vendor/Zend/Exception.php are identical
diff -urBNs elefant-1.3.1-beta/lib/vendor/Zend/Loader.php elefant-1.3.2-beta/lib/vendor/Zend/Loader.php
--- elefant-1.3.1-beta/lib/vendor/Zend/Loader.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/lib/vendor/Zend/Loader.php	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,329 @@
+<?php
+/**
+ * Zend Framework
+ *
+ * LICENSE
+ *
+ * This source file is subject to the new BSD license that is bundled
+ * with this package in the file LICENSE.txt.
+ * It is also available through the world-wide-web at this URL:
+ * http://framework.zend.com/license/new-bsd
+ * If you did not receive a copy of the license and are unable to
+ * obtain it through the world-wide-web, please send an email
+ * to license@zend.com so we can send you a copy immediately.
+ *
+ * @category   Zend
+ * @package    Zend_Loader
+ * @copyright  Copyright (c) 2005-2012 Zend Technologies USA Inc. (http://www.zend.com)
+ * @license    http://framework.zend.com/license/new-bsd     New BSD License
+ * @version    $Id: Loader.php 24594 2012-01-05 21:27:01Z matthew $
+ */
+
+/**
+ * Static methods for loading classes and files.
+ *
+ * @category   Zend
+ * @package    Zend_Loader
+ * @copyright  Copyright (c) 2005-2012 Zend Technologies USA Inc. (http://www.zend.com)
+ * @license    http://framework.zend.com/license/new-bsd     New BSD License
+ */
+class Zend_Loader
+{
+    /**
+     * Loads a class from a PHP file.  The filename must be formatted
+     * as "$class.php".
+     *
+     * If $dirs is a string or an array, it will search the directories
+     * in the order supplied, and attempt to load the first matching file.
+     *
+     * If $dirs is null, it will split the class name at underscores to
+     * generate a path hierarchy (e.g., "Zend_Example_Class" will map
+     * to "Zend/Example/Class.php").
+     *
+     * If the file was not found in the $dirs, or if no $dirs were specified,
+     * it will attempt to load it from PHP's include_path.
+     *
+     * @param string $class      - The full class name of a Zend component.
+     * @param string|array $dirs - OPTIONAL Either a path or an array of paths
+     *                             to search.
+     * @return void
+     * @throws Zend_Exception
+     */
+    public static function loadClass($class, $dirs = null)
+    {
+        if (class_exists($class, false) || interface_exists($class, false)) {
+            return;
+        }
+
+        if ((null !== $dirs) && !is_string($dirs) && !is_array($dirs)) {
+            require_once 'Zend/Exception.php';
+            throw new Zend_Exception('Directory argument must be a string or an array');
+        }
+
+        // Autodiscover the path from the class name
+        // Implementation is PHP namespace-aware, and based on
+        // Framework Interop Group reference implementation:
+        // http://groups.google.com/group/php-standards/web/psr-0-final-proposal
+        $className = ltrim($class, '\\');
+        $file      = '';
+        $namespace = '';
+        if ($lastNsPos = strripos($className, '\\')) {
+            $namespace = substr($className, 0, $lastNsPos);
+            $className = substr($className, $lastNsPos + 1);
+            $file      = str_replace('\\', DIRECTORY_SEPARATOR, $namespace) . DIRECTORY_SEPARATOR;
+        }
+        $file .= str_replace('_', DIRECTORY_SEPARATOR, $className) . '.php';
+
+        if (!empty($dirs)) {
+            // use the autodiscovered path
+            $dirPath = dirname($file);
+            if (is_string($dirs)) {
+                $dirs = explode(PATH_SEPARATOR, $dirs);
+            }
+            foreach ($dirs as $key => $dir) {
+                if ($dir == '.') {
+                    $dirs[$key] = $dirPath;
+                } else {
+                    $dir = rtrim($dir, '\\/');
+                    $dirs[$key] = $dir . DIRECTORY_SEPARATOR . $dirPath;
+                }
+            }
+            $file = basename($file);
+            self::loadFile($file, $dirs, true);
+        } else {
+            self::loadFile($file, null, true);
+        }
+
+        if (!class_exists($class, false) && !interface_exists($class, false)) {
+            require_once 'Zend/Exception.php';
+            throw new Zend_Exception("File \"$file\" does not exist or class \"$class\" was not found in the file");
+        }
+    }
+
+    /**
+     * Loads a PHP file.  This is a wrapper for PHP's include() function.
+     *
+     * $filename must be the complete filename, including any
+     * extension such as ".php".  Note that a security check is performed that
+     * does not permit extended characters in the filename.  This method is
+     * intended for loading Zend Framework files.
+     *
+     * If $dirs is a string or an array, it will search the directories
+     * in the order supplied, and attempt to load the first matching file.
+     *
+     * If the file was not found in the $dirs, or if no $dirs were specified,
+     * it will attempt to load it from PHP's include_path.
+     *
+     * If $once is TRUE, it will use include_once() instead of include().
+     *
+     * @param  string        $filename
+     * @param  string|array  $dirs - OPTIONAL either a path or array of paths
+     *                       to search.
+     * @param  boolean       $once
+     * @return boolean
+     * @throws Zend_Exception
+     */
+    public static function loadFile($filename, $dirs = null, $once = false)
+    {
+        self::_securityCheck($filename);
+
+        /**
+         * Search in provided directories, as well as include_path
+         */
+        $incPath = false;
+        if (!empty($dirs) && (is_array($dirs) || is_string($dirs))) {
+            if (is_array($dirs)) {
+                $dirs = implode(PATH_SEPARATOR, $dirs);
+            }
+            $incPath = get_include_path();
+            set_include_path($dirs . PATH_SEPARATOR . $incPath);
+        }
+
+        /**
+         * Try finding for the plain filename in the include_path.
+         */
+        if ($once) {
+            include_once $filename;
+        } else {
+            include $filename;
+        }
+
+        /**
+         * If searching in directories, reset include_path
+         */
+        if ($incPath) {
+            set_include_path($incPath);
+        }
+
+        return true;
+    }
+
+    /**
+     * Returns TRUE if the $filename is readable, or FALSE otherwise.
+     * This function uses the PHP include_path, where PHP's is_readable()
+     * does not.
+     *
+     * Note from ZF-2900:
+     * If you use custom error handler, please check whether return value
+     *  from error_reporting() is zero or not.
+     * At mark of fopen() can not suppress warning if the handler is used.
+     *
+     * @param string   $filename
+     * @return boolean
+     */
+    public static function isReadable($filename)
+    {
+        if (is_readable($filename)) {
+            // Return early if the filename is readable without needing the
+            // include_path
+            return true;
+        }
+
+        if (strtoupper(substr(PHP_OS, 0, 3)) == 'WIN'
+            && preg_match('/^[a-z]:/i', $filename)
+        ) {
+            // If on windows, and path provided is clearly an absolute path,
+            // return false immediately
+            return false;
+        }
+
+        foreach (self::explodeIncludePath() as $path) {
+            if ($path == '.') {
+                if (is_readable($filename)) {
+                    return true;
+                }
+                continue;
+            }
+            $file = $path . '/' . $filename;
+            if (is_readable($file)) {
+                return true;
+            }
+        }
+        return false;
+    }
+
+    /**
+     * Explode an include path into an array
+     *
+     * If no path provided, uses current include_path. Works around issues that
+     * occur when the path includes stream schemas.
+     *
+     * @param  string|null $path
+     * @return array
+     */
+    public static function explodeIncludePath($path = null)
+    {
+        if (null === $path) {
+            $path = get_include_path();
+        }
+
+        if (PATH_SEPARATOR == ':') {
+            // On *nix systems, include_paths which include paths with a stream
+            // schema cannot be safely explode'd, so we have to be a bit more
+            // intelligent in the approach.
+            $paths = preg_split('#:(?!//)#', $path);
+        } else {
+            $paths = explode(PATH_SEPARATOR, $path);
+        }
+        return $paths;
+    }
+
+    /**
+     * spl_autoload() suitable implementation for supporting class autoloading.
+     *
+     * Attach to spl_autoload() using the following:
+     * <code>
+     * spl_autoload_register(array('Zend_Loader', 'autoload'));
+     * </code>
+     *
+     * @deprecated Since 1.8.0
+     * @param  string $class
+     * @return string|false Class name on success; false on failure
+     */
+    public static function autoload($class)
+    {
+        trigger_error(__CLASS__ . '::' . __METHOD__ . ' is deprecated as of 1.8.0 and will be removed with 2.0.0; use Zend_Loader_Autoloader instead', E_USER_NOTICE);
+        try {
+            @self::loadClass($class);
+            return $class;
+        } catch (Exception $e) {
+            return false;
+        }
+    }
+
+    /**
+     * Register {@link autoload()} with spl_autoload()
+     *
+     * @deprecated Since 1.8.0
+     * @param string $class (optional)
+     * @param boolean $enabled (optional)
+     * @return void
+     * @throws Zend_Exception if spl_autoload() is not found
+     * or if the specified class does not have an autoload() method.
+     */
+    public static function registerAutoload($class = 'Zend_Loader', $enabled = true)
+    {
+        trigger_error(__CLASS__ . '::' . __METHOD__ . ' is deprecated as of 1.8.0 and will be removed with 2.0.0; use Zend_Loader_Autoloader instead', E_USER_NOTICE);
+        require_once 'Zend/Loader/Autoloader.php';
+        $autoloader = Zend_Loader_Autoloader::getInstance();
+        $autoloader->setFallbackAutoloader(true);
+
+        if ('Zend_Loader' != $class) {
+            self::loadClass($class);
+            $methods = get_class_methods($class);
+            if (!in_array('autoload', (array) $methods)) {
+                require_once 'Zend/Exception.php';
+                throw new Zend_Exception("The class \"$class\" does not have an autoload() method");
+            }
+
+            $callback = array($class, 'autoload');
+
+            if ($enabled) {
+                $autoloader->pushAutoloader($callback);
+            } else {
+                $autoloader->removeAutoloader($callback);
+            }
+        }
+    }
+
+    /**
+     * Ensure that filename does not contain exploits
+     *
+     * @param  string $filename
+     * @return void
+     * @throws Zend_Exception
+     */
+    protected static function _securityCheck($filename)
+    {
+        /**
+         * Security check
+         */
+        if (preg_match('/[^a-z0-9\\/\\\\_.:-]/i', $filename)) {
+            require_once 'Zend/Exception.php';
+            throw new Zend_Exception('Security check: Illegal character in filename');
+        }
+    }
+
+    /**
+     * Attempt to include() the file.
+     *
+     * include() is not prefixed with the @ operator because if
+     * the file is loaded and contains a parse error, execution
+     * will halt silently and this is difficult to debug.
+     *
+     * Always set display_errors = Off on production servers!
+     *
+     * @param  string  $filespec
+     * @param  boolean $once
+     * @return boolean
+     * @deprecated Since 1.5.0; use loadFile() instead
+     */
+    protected static function _includeFile($filespec, $once = false)
+    {
+        if ($once) {
+            return include_once $filespec;
+        } else {
+            return include $filespec ;
+        }
+    }
+}
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Exception.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Exception.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Message/File.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Message/File.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Message/Interface.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Message/Interface.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Message.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Message.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Part/File.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Part/File.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Part/Interface.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Part/Interface.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Part.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Part.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Protocol/Abstract.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Protocol/Abstract.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Protocol/Exception.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Protocol/Exception.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Protocol/Imap.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Protocol/Imap.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Protocol/Pop3.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Protocol/Pop3.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Protocol/Smtp/Auth/Crammd5.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Protocol/Smtp/Auth/Crammd5.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Protocol/Smtp/Auth/Login.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Protocol/Smtp/Auth/Login.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Protocol/Smtp/Auth/Plain.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Protocol/Smtp/Auth/Plain.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Protocol/Smtp.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Protocol/Smtp.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Storage/Abstract.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Storage/Abstract.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Storage/Exception.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Storage/Exception.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Storage/Folder/Interface.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Storage/Folder/Interface.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Storage/Folder/Maildir.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Storage/Folder/Maildir.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Storage/Folder/Mbox.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Storage/Folder/Mbox.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Storage/Folder.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Storage/Folder.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Storage/Imap.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Storage/Imap.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Storage/Maildir.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Storage/Maildir.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Storage/Mbox.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Storage/Mbox.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Storage/Pop3.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Storage/Pop3.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Storage/Writable/Interface.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Storage/Writable/Interface.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Storage/Writable/Maildir.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Storage/Writable/Maildir.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Storage.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Storage.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Transport/Abstract.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Transport/Abstract.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Transport/Exception.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Transport/Exception.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Transport/File.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Transport/File.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Transport/Sendmail.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Transport/Sendmail.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail/Transport/Smtp.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail/Transport/Smtp.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mail.php and elefant-1.3.2-beta/lib/vendor/Zend/Mail.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mime/Decode.php and elefant-1.3.2-beta/lib/vendor/Zend/Mime/Decode.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mime/Exception.php and elefant-1.3.2-beta/lib/vendor/Zend/Mime/Exception.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mime/Message.php and elefant-1.3.2-beta/lib/vendor/Zend/Mime/Message.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mime/Part.php and elefant-1.3.2-beta/lib/vendor/Zend/Mime/Part.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Mime.php and elefant-1.3.2-beta/lib/vendor/Zend/Mime.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Registry.php and elefant-1.3.2-beta/lib/vendor/Zend/Registry.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Abstract.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Abstract.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Alnum.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Alnum.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Alpha.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Alpha.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Barcode/AdapterAbstract.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Barcode/AdapterAbstract.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Barcode/AdapterInterface.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Barcode/AdapterInterface.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Barcode/Code25.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Barcode/Code25.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Barcode/Code25interleaved.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Barcode/Code25interleaved.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Barcode/Code39.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Barcode/Code39.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Barcode/Code39ext.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Barcode/Code39ext.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Barcode/Code93.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Barcode/Code93.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Barcode/Code93ext.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Barcode/Code93ext.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Barcode/Ean12.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Barcode/Ean12.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Barcode/Ean13.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Barcode/Ean13.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Barcode/Ean14.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Barcode/Ean14.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Barcode/Ean18.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Barcode/Ean18.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Barcode/Ean2.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Barcode/Ean2.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Barcode/Ean5.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Barcode/Ean5.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Barcode/Ean8.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Barcode/Ean8.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Barcode/Gtin12.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Barcode/Gtin12.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Barcode/Gtin13.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Barcode/Gtin13.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Barcode/Gtin14.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Barcode/Gtin14.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Barcode/Identcode.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Barcode/Identcode.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Barcode/Intelligentmail.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Barcode/Intelligentmail.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Barcode/Issn.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Barcode/Issn.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Barcode/Itf14.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Barcode/Itf14.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Barcode/Leitcode.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Barcode/Leitcode.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Barcode/Planet.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Barcode/Planet.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Barcode/Postnet.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Barcode/Postnet.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Barcode/Royalmail.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Barcode/Royalmail.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Barcode/Sscc.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Barcode/Sscc.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Barcode/Upca.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Barcode/Upca.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Barcode/Upce.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Barcode/Upce.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Barcode.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Barcode.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Between.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Between.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Callback.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Callback.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Ccnum.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Ccnum.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/CreditCard.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/CreditCard.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Date.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Date.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Db/Abstract.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Db/Abstract.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Db/NoRecordExists.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Db/NoRecordExists.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Db/RecordExists.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Db/RecordExists.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Digits.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Digits.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/EmailAddress.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/EmailAddress.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Exception.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Exception.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/File/Count.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/File/Count.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/File/Crc32.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/File/Crc32.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/File/ExcludeExtension.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/File/ExcludeExtension.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/File/ExcludeMimeType.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/File/ExcludeMimeType.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/File/Exists.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/File/Exists.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/File/Extension.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/File/Extension.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/File/FilesSize.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/File/FilesSize.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/File/Hash.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/File/Hash.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/File/ImageSize.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/File/ImageSize.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/File/IsCompressed.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/File/IsCompressed.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/File/IsImage.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/File/IsImage.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/File/Md5.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/File/Md5.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/File/MimeType.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/File/MimeType.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/File/NotExists.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/File/NotExists.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/File/Sha1.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/File/Sha1.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/File/Size.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/File/Size.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/File/Upload.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/File/Upload.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/File/WordCount.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/File/WordCount.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Float.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Float.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/GreaterThan.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/GreaterThan.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Hex.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Hex.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Hostname/Biz.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Hostname/Biz.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Hostname/Cn.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Hostname/Cn.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Hostname/Com.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Hostname/Com.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Hostname/Jp.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Hostname/Jp.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Hostname.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Hostname.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Iban.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Iban.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Identical.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Identical.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/InArray.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/InArray.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Int.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Int.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Interface.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Interface.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Ip.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Ip.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Isbn.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Isbn.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/LessThan.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/LessThan.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/NotEmpty.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/NotEmpty.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/PostCode.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/PostCode.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Regex.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Regex.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Sitemap/Changefreq.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Sitemap/Changefreq.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Sitemap/Lastmod.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Sitemap/Lastmod.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Sitemap/Loc.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Sitemap/Loc.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/Sitemap/Priority.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/Sitemap/Priority.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate/StringLength.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate/StringLength.php are identical
Files elefant-1.3.1-beta/lib/vendor/Zend/Validate.php and elefant-1.3.2-beta/lib/vendor/Zend/Validate.php are identical
Files elefant-1.3.1-beta/nginx.conf and elefant-1.3.2-beta/nginx.conf are identical
diff -urBNs elefant-1.3.1-beta/robots.txt elefant-1.3.2-beta/robots.txt
--- elefant-1.3.1-beta/robots.txt	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/robots.txt	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,33 @@
+#
+# robots.txt
+#
+# This file is to prevent the crawling and indexing of certain parts
+# of your site by web crawlers and spiders run by sites like Yahoo!
+# and Google. By telling these "robots" where not to go on your site,
+# you save bandwidth and server resources.
+#
+# For more information about the robots.txt standard, see:
+# http://www.robotstxt.org/wc/robots.html
+#
+# For syntax checking, see:
+# http://www.sxw.org.uk/computing/robots/check.html
+
+User-agent: *
+Crawl-delay: 10
+# Directories
+Disallow: /apps/
+Disallow: /cache/
+Disallow: /conf/
+Disallow: /css/
+Disallow: /files/
+Disallow: /js/
+Disallow: /layouts/
+Disallow: /lib/
+Disallow: /tests/
+# Files
+Disallow: /LICENSE
+Disallow: /README.md
+Disallow: /elefant
+# Apps Paths
+Disallow: /admin/
+Disallow: /user/
Files elefant-1.3.1-beta/tests/.htaccess and elefant-1.3.2-beta/tests/.htaccess are identical
Files elefant-1.3.1-beta/tests/AclTest.php and elefant-1.3.2-beta/tests/AclTest.php are identical
Files elefant-1.3.1-beta/tests/ActiveResourceTest.php and elefant-1.3.2-beta/tests/ActiveResourceTest.php are identical
Files elefant-1.3.1-beta/tests/AdminAppTest.php and elefant-1.3.2-beta/tests/AdminAppTest.php are identical
Files elefant-1.3.1-beta/tests/AdminFunctionsTest.php and elefant-1.3.2-beta/tests/AdminFunctionsTest.php are identical
Files elefant-1.3.1-beta/tests/AnalogTest.php and elefant-1.3.2-beta/tests/AnalogTest.php are identical
Files elefant-1.3.1-beta/tests/BlogAppTest.php and elefant-1.3.2-beta/tests/BlogAppTest.php are identical
Files elefant-1.3.1-beta/tests/CacheTest.php and elefant-1.3.2-beta/tests/CacheTest.php are identical
diff -urBNs elefant-1.3.1-beta/tests/ControllerTest.php elefant-1.3.2-beta/tests/ControllerTest.php
--- elefant-1.3.1-beta/tests/ControllerTest.php	2012-05-01 08:27:03.000000000 -0500
+++ elefant-1.3.2-beta/tests/ControllerTest.php	2012-09-13 09:15:24.000000000 -0500
@@ -48,6 +48,17 @@
 		$_SERVER['HTTPS'] = 'on';
 		$this->assertTrue ($this->c->is_https ());
 	}
+
+	function test_absolutize () {
+		$_SERVER['HTTP_HOST'] = 'www.example.com';
+		$this->assertEquals ('http://www.example.com/page', $this->c->absolutize ('/page'));
+		$this->assertEquals ('http://www.example.com/page', $this->c->absolutize ('//www.example.com/page'));
+		$this->assertEquals ('http://www.example.com/page', $this->c->absolutize ('http://www.example.com/page'));
+		$this->assertEquals ('http://www.example.com/page', $this->c->absolutize ('page'));
+		$this->assertEquals ('http://www.example.com/page', $this->c->absolutize ('page', 'http://www.example.com/'));
+		$this->assertEquals ('http://www.example.com/sub/page', $this->c->absolutize ('page', 'http://www.example.com/sub'));
+		$this->assertEquals ('http://www.example.com/sub/page', $this->c->absolutize ('page', 'http://www.example.com/sub/'));
+	}
 }
 
 ?>
\ No newline at end of file
Files elefant-1.3.1-beta/tests/CsvParserTest.php and elefant-1.3.2-beta/tests/CsvParserTest.php are identical
diff -urBNs elefant-1.3.1-beta/tests/DBTest.php elefant-1.3.2-beta/tests/DBTest.php
--- elefant-1.3.1-beta/tests/DBTest.php	2012-05-01 08:27:03.000000000 -0500
+++ elefant-1.3.2-beta/tests/DBTest.php	2012-09-13 09:15:24.000000000 -0500
@@ -95,6 +95,26 @@
 		$cmp = array ('one' => 'joe', 'two' => 'sam');
 		$this->assertEquals ($res, $cmp);
 	}
+
+	function test_transactions () {
+		$this->assertEquals (true, DB::execute ('create table transaction_test (id integer, name char(32))'));
+		$this->assertEquals (0, DB::shift ('select count(*) from transaction_test'));
+
+		$this->assertEquals (true, DB::beginTransaction ());
+		$this->assertEquals (true, DB::execute ('insert into transaction_test (name) values ("Joe")'));
+		$this->assertEquals (true, DB::execute ('insert into transaction_test (name) values ("Ron")'));
+		$this->assertEquals (true, DB::rollback ());
+
+		$this->assertEquals (0, DB::shift ('select count(*) from transaction_test'));
+
+		$this->assertEquals (true, DB::beginTransaction ());
+		$this->assertEquals (true, DB::execute ('insert into transaction_test (name) values ("Joe")'));
+		$this->assertEquals (true, DB::execute ('insert into transaction_test (name) values ("Ron")'));
+		$this->assertEquals (true, DB::execute ('insert into transaction_test (name) values ("Sue")'));
+		$this->assertEquals (true, DB::commit ());
+		
+		$this->assertEquals (3, DB::shift ('select count(*) from transaction_test'));
+	}
 }
 
 ?>
\ No newline at end of file
Files elefant-1.3.1-beta/tests/DiffTest.php and elefant-1.3.2-beta/tests/DiffTest.php are identical
Files elefant-1.3.1-beta/tests/ExtendedModelTest.php and elefant-1.3.2-beta/tests/ExtendedModelTest.php are identical
diff -urBNs elefant-1.3.1-beta/tests/FormTest.php elefant-1.3.2-beta/tests/FormTest.php
--- elefant-1.3.1-beta/tests/FormTest.php	2012-05-01 08:27:03.000000000 -0500
+++ elefant-1.3.2-beta/tests/FormTest.php	2012-09-13 09:15:24.000000000 -0500
@@ -3,133 +3,6 @@
 require_once ('lib/Autoloader.php');
 
 class FormTest extends PHPUnit_Framework_TestCase {
-	protected $backupGlobalsBlacklist = array ('user');
-
-	static function setUpBeforeClass () {
-		DB::open (array ('master' => true, 'driver' => 'sqlite', 'file' => ':memory:'));
-	}
-
-	function test_verify_value () {
-		$this->assertTrue (Form::verify_value ('1234', 'regex', '/^[0-9]+$/'));
-		$this->assertFalse (Form::verify_value ('adsf', 'regex', '/^[0-9]+$/'));
-		$this->assertTrue (Form::verify_value ('123', 'type', 'numeric'));
-		$this->assertFalse (Form::verify_value ('asdf', 'type', 'numeric'));
-		$this->assertTrue (Form::verify_value ('123', 'callback', function ($value) { return true; }));
-		$this->assertFalse (Form::verify_value ('123', 'callback', function ($value) { return false; }));
-		$this->assertFalse (Form::verify_value ('asdf', 'length', 2));
-		$this->assertFalse (Form::verify_value ('asdf', 'length', '5+'));
-		$this->assertTrue (Form::verify_value ('asdf', 'length', '5-'));
-		$this->assertFalse (Form::verify_value ('asdf', 'length', '6-8'));
-		$this->assertTrue (Form::verify_value ('asdf', 'length', '2-6'));
-		$this->assertTrue (Form::verify_value (5, 'range', '1-10'));
-		$this->assertFalse (Form::verify_value (15, 'range', '1-10'));
-		$this->assertTrue (Form::verify_value ('', 'empty'));
-		$this->assertFalse (Form::verify_value ('asdf', 'empty'));
-		$this->assertTrue (Form::verify_value ('foo@bar.com', 'email'));
-		$this->assertFalse (Form::verify_value ('@foo@bar.com', 'email'));
-		$this->assertFalse (Form::verify_value ('foo@bar', 'email'));
-		$this->assertTrue (Form::verify_value ('foo+spam@foo.bar.org', 'email'));
-		$this->assertTrue (Form::verify_value ("asdf", 'header'));
-		$this->assertFalse (Form::verify_value ("asdf\nasdf", 'header'));
-		$this->assertTrue (Form::verify_value ('2010-01-01', 'date'));
-		$this->assertFalse (Form::verify_value ('2010-01-010', 'date'));
-		$this->assertTrue (Form::verify_value ('2010-01-01 00:01:01', 'datetime'));
-		$this->assertFalse (Form::verify_value ('2010-01-01-00:01:01', 'datetime'));
-		$this->assertTrue (Form::verify_value ('00:01:01', 'time'));
-		$this->assertFalse (Form::verify_value ('000101', 'time'));
-		$this->assertTrue (Form::verify_value ('Template.php', 'exists', 'lib'));
-		$this->assertFalse (Form::verify_value ('ASDF.php', 'exists', 'lib'));
-		$this->assertTrue (Form::verify_value ('default', 'exists', 'layouts/%s.html'));
-		$this->assertTrue (Form::verify_value ('foobar', 'contains', 'foo'));
-		$this->assertFalse (Form::verify_value ('foobar', 'contains', 'asdf'));
-		$this->assertTrue (Form::verify_value ('asdf', 'equals', 'asdf'));
-		$this->assertFalse (Form::verify_value ('foobar', 'equals', 'asdf'));
-		$this->assertTrue (Form::verify_value ('asdf', 'unique', 'user.email'));
-		DB::execute ('create table test ( email char(48) )');
-		DB::execute ('insert into test (email) values (?)', 'foo.bar@gmail.com');
-		$this->assertTrue (Form::verify_value ('bar.foo@gmail.com', 'unique', 'test.email'));
-		$this->assertFalse (Form::verify_value ('foo.bar@gmail.com', 'unique', 'test.email'));
-		$this->assertTrue (Form::verify_value (5, 'lt', 10));
-		$this->assertFalse (Form::verify_value (50, 'lt', 10));
-		$this->assertTrue (Form::verify_value (10, 'lte', 10));
-		$this->assertFalse (Form::verify_value (50, 'lte', 10));
-		$this->assertTrue (Form::verify_value (50, 'gt', 10));
-		$this->assertFalse (Form::verify_value (5, 'gt', 10));
-		$this->assertTrue (Form::verify_value (10, 'gte', 10));
-		$this->assertFalse (Form::verify_value (5, 'gte', 10));
-		$_POST['test'] = 'foo';
-		$this->assertTrue (Form::verify_value ('foo', 'matches', '$_POST["test"]'));
-		$this->assertFalse (Form::verify_value ('bar', 'matches', '$_POST["test"]'));
-		$this->assertFalse (Form::verify_value ('foo', 'not matches', '$_POST["test"]'));
-		$this->assertTrue (Form::verify_value ('bar', 'not matches', '$_POST["test"]'));
-		$this->assertTrue (Form::verify_value ('http://foo.com/bar', 'url'));
-		$this->assertFalse (Form::verify_value ('foobar', 'url'));
-		$this->assertFalse (Form::verify_value ('http:/fooobar', 'url'));
-
-		// test array validation
-		$valid_emails = array (
-			'joe@example.com',
-			'sue@example.com'
-		);
-		$invalid_emails = array (
-			'joe.example dot com',
-			'sue@localhost'
-		);
-		$this->assertTrue (Form::verify_value ($valid_emails, 'each email', 1));
-		$this->assertFalse (Form::verify_value ($invalid_emails, 'each email', 1));
-		$names = array ('Joe', 'Sue');
-		$empty = array ('', '');
-		$this->assertTrue (Form::verify_value ($names, 'each not empty', 1));
-		$this->assertFalse (Form::verify_value ($empty, 'each not empty', 1));
-	}
-
-	function test_verify_values () {
-		$values = array (
-			'foo' => 'bar',
-			'asdf' => 'qwerty'
-		);
-		$validations = array (
-			'foo' => array (
-				'not empty' => 1
-			),
-			'asdf' => array (
-				'empty' => 1
-			)
-		);
-		$f = new Form;
-		$this->assertEquals (array ('asdf'), $f->verify_values ($values, $validations));
-
-		$validations = array (
-			'foo' => array (
-				'skip_if_empty' => 1,
-				'contains' => 'asdf'
-			)
-		);
-		$values = array (
-			'foo' => '',
-			'asdf' => 'qwerty'
-		);
-		$this->assertEquals (array (), $f->verify_values ($values, $validations));
-		$values['foo'] = 'foobar';
-		$this->assertEquals (array ('foo'), $f->verify_values ($values, $validations));
-		$values['foo'] = 'asdf';
-		$this->assertEquals (array (), $f->verify_values ($values, $validations));
-
-		$validations = array (
-			'foo' => array (
-				'type' => 'array',
-				'skip_if_empty' => 1,
-				'each contains' => 'asdf'
-			)
-		);
-		$values = array ('foo' => 'asdf'); // Not an array
-		$this->assertEquals (array ('foo'), $f->verify_values ($values, $validations));
-		$values = array ('foo' => array ('bar', '')); // Contains should fail
-		$this->assertEquals (array ('foo'), $f->verify_values ($values, $validations));
-		$values = array ('foo' => array ('', '')); // All empty should pass
-		$this->assertEquals (array (), $f->verify_values ($values, $validations));
-	}
-
 	function test_merge_values () {
 		$_POST['foo'] = 'bar';
 		$obj = new StdClass;
Files elefant-1.3.1-beta/tests/FunctionsTest.php and elefant-1.3.2-beta/tests/FunctionsTest.php are identical
diff -urBNs elefant-1.3.1-beta/tests/I18nTest.php elefant-1.3.2-beta/tests/I18nTest.php
--- elefant-1.3.1-beta/tests/I18nTest.php	2012-05-01 08:27:03.000000000 -0500
+++ elefant-1.3.2-beta/tests/I18nTest.php	2012-09-13 09:15:24.000000000 -0500
@@ -40,6 +40,20 @@
 		$this->assertEquals (i18n_getf ('Hello %s', 'world'), 'Bonjour world');
 	}
 
+	function test_underscore () {
+		global $i18n;
+
+		$i18n->lang_hash['en'] = array (
+			'Hello' => 'Bonjour',
+		);
+		$this->assertEquals (__ ('Hello'), 'Bonjour');
+
+		$i18n->lang_hash['en'] = array (
+			'Hello %s' => 'Bonjour %s'
+		);
+		$this->assertEquals (__ ('Hello %s', 'world'), 'Bonjour world');
+	}
+
 	function test_negotiation_methods () {
 		$_SERVER['HTTP_HOST'] = 'en.example.com';
 		$i18n = new I18n ('lang', array ('negotiation_method' => 'subdomain'));
@@ -55,6 +69,21 @@
 		$i18n = new I18n ('lang', array ('negotiation_method' => 'http'));
 
 		$this->assertEquals ($i18n->language, 'en');
+
+		// it-IT should still match it
+		$i18n->languages = array ('it' => 1, 'en' => 1);
+		$_SERVER['HTTP_ACCEPT_LANGUAGE'] = 'it-IT';
+		$this->assertEquals ('it', $i18n->negotiate ('http'));
+
+		// should match fr_ca
+		$i18n->languages = array ('fr_ca' => 1, 'fr' => 1, 'en' => 1);
+		$_SERVER['HTTP_ACCEPT_LANGUAGE'] = 'fr-CA';
+		$this->assertEquals ('fr_ca', $i18n->negotiate ('http'));
+
+		// should match fr
+		$i18n->languages = array ('fr_ca' => 1, 'fr' => 1, 'en' => 1);
+		$_SERVER['HTTP_ACCEPT_LANGUAGE'] = 'fr';
+		$this->assertEquals ('fr', $i18n->negotiate ('http'));
 	}
 
 	function test_cascade () {
diff -urBNs elefant-1.3.1-beta/tests/IniTest.php elefant-1.3.2-beta/tests/IniTest.php
--- elefant-1.3.1-beta/tests/IniTest.php	2012-05-01 08:27:03.000000000 -0500
+++ elefant-1.3.2-beta/tests/IniTest.php	2012-09-13 09:15:24.000000000 -0500
@@ -30,6 +30,12 @@
 		$ini = "; <?php /*\n\n[Section]\n\none                     = \"http://www.foo.com/\"\ntwo                     = Off\n\n; */ ?>";
 		$this->assertEquals ($ini, Ini::write ($data));
 	}
+
+	function test_write_with_header () {
+		$data = array ('one' => 'two', 'three' => 'four');
+		$ini = "; <?php /*\n;\n; Header test.\n;\n\none                     = two\nthree                   = four\n\n; */ ?>";
+		$this->assertEquals ($ini, Ini::write ($data, false, 'Header test.'));
+	}
 }
 
 ?>
\ No newline at end of file
Files elefant-1.3.1-beta/tests/LockTest.php and elefant-1.3.2-beta/tests/LockTest.php are identical
diff -urBNs elefant-1.3.1-beta/tests/ModelTest.php elefant-1.3.2-beta/tests/ModelTest.php
--- elefant-1.3.1-beta/tests/ModelTest.php	2012-05-01 08:27:03.000000000 -0500
+++ elefant-1.3.2-beta/tests/ModelTest.php	2012-09-13 09:15:24.000000000 -0500
@@ -58,6 +58,11 @@
 	);
 }
 
+class NextTest extends Model {
+	public $table = 'next_test';
+	public $key = 'fieldname';
+}
+
 class ModelTest extends PHPUnit_Framework_TestCase {
 	protected static $q;
 
@@ -110,6 +115,9 @@
 		insert into book_author (book, author) values (1, 2);
 		insert into book_author (book, author) values (2, 1);
 		insert into book_author (book, author) values (2, 2);
+		create table next_test (
+			fieldname int not null
+		);
 		");
 		foreach ($sql as $query) {
 			DB::execute ($query);
@@ -336,6 +344,19 @@
 		$this->assertEquals (4, Foo::query ()->count ());
 	}
 
+	function test_next () {
+		$nt = new NextTest;
+
+		$this->assertEquals (1, $nt->next ());
+		$this->assertEquals (1, $nt->next ('fieldname'));
+
+		$nt->fieldname = 5;
+		$nt->put ();
+
+		$this->assertEquals (6, $nt->next ());
+		$this->assertEquals (6, $nt->next ('fieldname'));
+	}
+
 	function test_references () {
 		// basic references (belongs_to)		
 		$f = new Foo (array ('id' => 1, 'name' => 'Joe'));
Files elefant-1.3.1-beta/tests/MongoModelTest.php and elefant-1.3.2-beta/tests/MongoModelTest.php are identical
Files elefant-1.3.1-beta/tests/NavigationTest.php and elefant-1.3.2-beta/tests/NavigationTest.php are identical
Files elefant-1.3.1-beta/tests/PageTest.php and elefant-1.3.2-beta/tests/PageTest.php are identical
Files elefant-1.3.1-beta/tests/RestfulTest.php and elefant-1.3.2-beta/tests/RestfulTest.php are identical
diff -urBNs elefant-1.3.1-beta/tests/TemplateTest.php elefant-1.3.2-beta/tests/TemplateTest.php
--- elefant-1.3.1-beta/tests/TemplateTest.php	2012-05-01 08:27:03.000000000 -0500
+++ elefant-1.3.2-beta/tests/TemplateTest.php	2012-09-13 09:15:24.000000000 -0500
@@ -30,13 +30,27 @@
 
 		$this->assertEquals ($t->replace_blocks ('end'), '<?php } ?>');
 		$this->assertEquals ($t->replace_blocks ('endif'), '<?php } ?>');
+		$this->assertEquals ($t->replace_blocks ('endfor'), '<?php } ?>');
 		$this->assertEquals ($t->replace_blocks ('endforeach'), '<?php } ?>');
 		$this->assertEquals ($t->replace_blocks ('else'), '<?php } else { ?>');
 		$this->assertEquals ($t->replace_blocks ('if foo'), '<?php if ($data->foo) { ?>');
+		$this->assertEquals ($t->replace_blocks ('if !foo'), '<?php if (! $data->foo) { ?>');
+		$this->assertEquals ($t->replace_blocks ('if ! foo'), '<?php if (! $data->foo) { ?>');
 		$this->assertEquals ($t->replace_blocks ('if foo.bar'), '<?php if ($GLOBALS[\'foo\']->bar) { ?>');
 		$this->assertEquals ($t->replace_blocks ('if $_POST.value'), '<?php if ($_POST[\'value\']) { ?>');
 		$this->assertEquals ($t->replace_blocks ('elseif foo'), '<?php } elseif ($data->foo) { ?>');
+		$this->assertEquals ($t->replace_blocks ('elseif !foo'), '<?php } elseif (! $data->foo) { ?>');
+		$this->assertEquals ($t->replace_blocks ('elseif ! foo'), '<?php } elseif (! $data->foo) { ?>');
 		$this->assertEquals ($t->replace_blocks ('foreach foo'), '<?php foreach ($data->foo as $data->loop_index => $data->loop_value) { ?>');
+		$this->assertEquals ($t->replace_blocks ('foreach foo as bar'), '<?php foreach ($data->foo as $data->loop_index => $data->bar) { ?>');
+		$this->assertEquals ($t->replace_blocks ('foreach foo as _k, _v'), '<?php foreach ($data->foo as $data->_k => $data->_v) { ?>');
+		$this->assertEquals ($t->replace_blocks ('foreach bar in foo'), '<?php foreach ($data->foo as $data->loop_index => $data->bar) { ?>');
+		$this->assertEquals ($t->replace_blocks ('foreach foo as _k, _v'), '<?php foreach ($data->foo as $data->_k => $data->_v) { ?>');
+		$this->assertEquals ($t->replace_blocks ('for foo'), '<?php foreach ($data->foo as $data->loop_index => $data->loop_value) { ?>');
+		$this->assertEquals ($t->replace_blocks ('for foo as bar'), '<?php foreach ($data->foo as $data->loop_index => $data->bar) { ?>');
+		$this->assertEquals ($t->replace_blocks ('for foo as _k, _v'), '<?php foreach ($data->foo as $data->_k => $data->_v) { ?>');
+		$this->assertEquals ($t->replace_blocks ('for bar in foo'), '<?php foreach ($data->foo as $data->loop_index => $data->bar) { ?>');
+		$this->assertEquals ($t->replace_blocks ('for _k, _v in foo'), '<?php foreach ($data->foo as $data->_k => $data->_v) { ?>');
 		$this->assertEquals ($t->replace_blocks ('inc foo'), '<?php echo $this->render (\'foo\', $data); ?>');
 	}
 
@@ -74,6 +88,31 @@
 			'one {{ two }} three',
 			$t->parse_template ('one \\{{ two \\}} three')
 		);
+
+		$this->assertEquals (
+			'one {" two "} three',
+			$t->parse_template ('one \\{" two \\"} three')
+		);
+
+		$this->assertEquals (
+			'one {" two "} three',
+			$t->parse_template ('one \\{\' two \\\'} three')
+		);
+
+		$this->assertEquals (
+			'one {% two %} three',
+			$t->parse_template ('one \\{% two \\%} three')
+		);
+
+		$this->assertEquals (
+			'one {! two !} three',
+			$t->parse_template ('one \\{! two \\!} three')
+		);
+
+		$this->assertEquals (
+			'one {# two #} three',
+			$t->parse_template ('one \\{# two \\#} three')
+		);
 	}
 }
 
diff -urBNs elefant-1.3.1-beta/tests/URLifyTest.php elefant-1.3.2-beta/tests/URLifyTest.php
--- elefant-1.3.1-beta/tests/URLifyTest.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/tests/URLifyTest.php	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,34 @@
+<?php
+
+require_once ('lib/Autoloader.php');
+
+class URLifyTest extends PHPUnit_Framework_TestCase {
+	function test_downcode () {
+		$this->assertEquals ('  J\'etudie le francais  ', URLify::downcode ('  J\'étudie le français  '));
+		$this->assertEquals ('Lo siento, no hablo espanol.', URLify::downcode ('Lo siento, no hablo español.'));
+		$this->assertEquals ('F3PWS', URLify::downcode ('ΦΞΠΏΣ'));
+	}
+
+	function test_filter () {
+		$this->assertEquals ('jetudie-le-francais', URLify::filter ('  J\'étudie le français  '));
+		$this->assertEquals ('lo-siento-no-hablo-espanol', URLify::filter ('Lo siento, no hablo español.'));
+		$this->assertEquals ('f3pws', URLify::filter ('ΦΞΠΏΣ'));
+	}
+
+	function test_add_chars () {
+		$this->assertEquals ('¿ ® ¼ ¼ ¾ ¶', URLify::downcode ('¿ ® ¼ ¼ ¾ ¶'));
+		URLify::add_chars (array (
+			'¿' => '?', '®' => '(r)', '¼' => '1/4',
+			'¼' => '1/2', '¾' => '3/4', '¶' => 'P'
+		));
+		$this->assertEquals ('? (r) 1/2 1/2 3/4 P', URLify::downcode ('¿ ® ¼ ¼ ¾ ¶'));
+	}
+
+	function test_remove_words () {
+		$this->assertEquals ('foo-bar', URLify::filter ('foo bar'));
+		URLify::remove_words (array ('foo', 'bar'));
+		$this->assertEquals ('', URLify::filter ('foo bar'));
+	}
+}
+
+?>
\ No newline at end of file
Files elefant-1.3.1-beta/tests/UserTest.php and elefant-1.3.2-beta/tests/UserTest.php are identical
diff -urBNs elefant-1.3.1-beta/tests/ValidatorTest.php elefant-1.3.2-beta/tests/ValidatorTest.php
--- elefant-1.3.1-beta/tests/ValidatorTest.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/tests/ValidatorTest.php	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,133 @@
+<?php
+
+require_once ('lib/Autoloader.php');
+
+class ValidatorTest extends PHPUnit_Framework_TestCase {
+	protected $backupGlobalsBlacklist = array ('user');
+
+	static function setUpBeforeClass () {
+		DB::open (array ('master' => true, 'driver' => 'sqlite', 'file' => ':memory:'));
+	}
+
+	function test_validate () {
+		$this->assertTrue (Validator::validate ('1234', 'regex', '/^[0-9]+$/'));
+		$this->assertFalse (Validator::validate ('adsf', 'regex', '/^[0-9]+$/'));
+		$this->assertTrue (Validator::validate ('123', 'type', 'numeric'));
+		$this->assertFalse (Validator::validate ('asdf', 'type', 'numeric'));
+		$this->assertTrue (Validator::validate ('123', 'callback', function ($value) { return true; }));
+		$this->assertFalse (Validator::validate ('123', 'callback', function ($value) { return false; }));
+		$this->assertFalse (Validator::validate ('asdf', 'length', 2));
+		$this->assertFalse (Validator::validate ('asdf', 'length', '5+'));
+		$this->assertTrue (Validator::validate ('asdf', 'length', '5-'));
+		$this->assertFalse (Validator::validate ('asdf', 'length', '6-8'));
+		$this->assertTrue (Validator::validate ('asdf', 'length', '2-6'));
+		$this->assertTrue (Validator::validate (5, 'range', '1-10'));
+		$this->assertFalse (Validator::validate (15, 'range', '1-10'));
+		$this->assertTrue (Validator::validate ('', 'empty'));
+		$this->assertFalse (Validator::validate ('asdf', 'empty'));
+		$this->assertTrue (Validator::validate ('foo@bar.com', 'email'));
+		$this->assertFalse (Validator::validate ('@foo@bar.com', 'email'));
+		$this->assertFalse (Validator::validate ('foo@bar', 'email'));
+		$this->assertTrue (Validator::validate ('foo+spam@foo.bar.org', 'email'));
+		$this->assertTrue (Validator::validate ("asdf", 'header'));
+		$this->assertFalse (Validator::validate ("asdf\nasdf", 'header'));
+		$this->assertTrue (Validator::validate ('2010-01-01', 'date'));
+		$this->assertFalse (Validator::validate ('2010-01-010', 'date'));
+		$this->assertTrue (Validator::validate ('2010-01-01 00:01:01', 'datetime'));
+		$this->assertFalse (Validator::validate ('2010-01-01-00:01:01', 'datetime'));
+		$this->assertTrue (Validator::validate ('00:01:01', 'time'));
+		$this->assertFalse (Validator::validate ('000101', 'time'));
+		$this->assertTrue (Validator::validate ('Template.php', 'exists', 'lib'));
+		$this->assertFalse (Validator::validate ('ASDF.php', 'exists', 'lib'));
+		$this->assertTrue (Validator::validate ('default', 'exists', 'layouts/%s.html'));
+		$this->assertTrue (Validator::validate ('foobar', 'contains', 'foo'));
+		$this->assertFalse (Validator::validate ('foobar', 'contains', 'asdf'));
+		$this->assertTrue (Validator::validate ('asdf', 'equals', 'asdf'));
+		$this->assertFalse (Validator::validate ('foobar', 'equals', 'asdf'));
+		$this->assertTrue (Validator::validate ('asdf', 'unique', 'user.email'));
+		DB::execute ('create table test ( email char(48) )');
+		DB::execute ('insert into test (email) values (?)', 'foo.bar@gmail.com');
+		$this->assertTrue (Validator::validate ('bar.foo@gmail.com', 'unique', 'test.email'));
+		$this->assertFalse (Validator::validate ('foo.bar@gmail.com', 'unique', 'test.email'));
+		$this->assertTrue (Validator::validate (5, 'lt', 10));
+		$this->assertFalse (Validator::validate (50, 'lt', 10));
+		$this->assertTrue (Validator::validate (10, 'lte', 10));
+		$this->assertFalse (Validator::validate (50, 'lte', 10));
+		$this->assertTrue (Validator::validate (50, 'gt', 10));
+		$this->assertFalse (Validator::validate (5, 'gt', 10));
+		$this->assertTrue (Validator::validate (10, 'gte', 10));
+		$this->assertFalse (Validator::validate (5, 'gte', 10));
+		$_POST['test'] = 'foo';
+		$this->assertTrue (Validator::validate ('foo', 'matches', '$_POST["test"]'));
+		$this->assertFalse (Validator::validate ('bar', 'matches', '$_POST["test"]'));
+		$this->assertFalse (Validator::validate ('foo', 'not matches', '$_POST["test"]'));
+		$this->assertTrue (Validator::validate ('bar', 'not matches', '$_POST["test"]'));
+		$this->assertTrue (Validator::validate ('http://foo.com/bar', 'url'));
+		$this->assertFalse (Validator::validate ('foobar', 'url'));
+		$this->assertFalse (Validator::validate ('http:/fooobar', 'url'));
+
+		// test array validation
+		$valid_emails = array (
+			'joe@example.com',
+			'sue@example.com'
+		);
+		$invalid_emails = array (
+			'joe.example dot com',
+			'sue@localhost'
+		);
+		$this->assertTrue (Validator::validate ($valid_emails, 'each email', 1));
+		$this->assertFalse (Validator::validate ($invalid_emails, 'each email', 1));
+		$names = array ('Joe', 'Sue');
+		$empty = array ('', '');
+		$this->assertTrue (Validator::validate ($names, 'each not empty', 1));
+		$this->assertFalse (Validator::validate ($empty, 'each not empty', 1));
+	}
+
+	function test_validate_list () {
+		$values = array (
+			'foo' => 'bar',
+			'asdf' => 'qwerty'
+		);
+		$validations = array (
+			'foo' => array (
+				'not empty' => 1
+			),
+			'asdf' => array (
+				'empty' => 1
+			)
+		);
+		$this->assertEquals (array ('asdf'), Validator::validate_list ($values, $validations));
+
+		$validations = array (
+			'foo' => array (
+				'skip_if_empty' => 1,
+				'contains' => 'asdf'
+			)
+		);
+		$values = array (
+			'foo' => '',
+			'asdf' => 'qwerty'
+		);
+		$this->assertEquals (array (), Validator::validate_list ($values, $validations));
+		$values['foo'] = 'foobar';
+		$this->assertEquals (array ('foo'), Validator::validate_list ($values, $validations));
+		$values['foo'] = 'asdf';
+		$this->assertEquals (array (), Validator::validate_list ($values, $validations));
+
+		$validations = array (
+			'foo' => array (
+				'type' => 'array',
+				'skip_if_empty' => 1,
+				'each contains' => 'asdf'
+			)
+		);
+		$values = array ('foo' => 'asdf'); // Not an array
+		$this->assertEquals (array ('foo'), Validator::validate_list ($values, $validations));
+		$values = array ('foo' => array ('bar', '')); // Contains should fail
+		$this->assertEquals (array ('foo'), Validator::validate_list ($values, $validations));
+		$values = array ('foo' => array ('', '')); // All empty should pass
+		$this->assertEquals (array (), Validator::validate_list ($values, $validations));
+	}
+}
+
+?>
\ No newline at end of file
Files elefant-1.3.1-beta/tests/VersionsTest.php and elefant-1.3.2-beta/tests/VersionsTest.php are identical
diff -urBNs elefant-1.3.1-beta/tests/ViewTest.php elefant-1.3.2-beta/tests/ViewTest.php
--- elefant-1.3.1-beta/tests/ViewTest.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-1.3.2-beta/tests/ViewTest.php	2012-09-13 09:15:24.000000000 -0500
@@ -0,0 +1,59 @@
+<?php
+
+require_once ('lib/Autoloader.php');
+
+class TemplateMock {
+	public function render ($template, $data = array ()) {
+		$data = is_object ($data) ? $data : (object) $data;
+		return sprintf ('<p>Hello %s</p>', $data->name);
+	}
+}
+
+class ViewTest extends PHPUnit_Framework_TestCase {
+	function test_init () {
+		$tpl = new Template ('UTF-8');
+		View::init ($tpl);
+		$this->assertEquals ($tpl, View::$tpl);
+	}
+	
+	function test_set () {
+		$tpl = new Template ('UTF-8');
+		View::init ($tpl);
+		
+		View::set ('name', 'Joe');
+		$this->assertEquals (array ('name' => 'Joe'), View::$params);
+		
+		$params = array (
+			'name' => 'Jill',
+			'age' => 28
+		);
+		View::set ($params);
+		$this->assertEquals ($params, View::$params);
+	}
+	
+	function test_render () {
+		$params = array (
+			'name' => 'Jill',
+			'age' => 28
+		);
+		
+		$this->assertEquals (
+			'Jill, 28',
+			View::render (function ($params) {
+				return join (', ', $params);
+			})
+		);
+		
+		$this->assertEquals (array (), View::$params);
+
+		$tpl = new TemplateMock;
+		View::init ($tpl);
+
+		$this->assertEquals (
+			'<p>Hello Jill</p>',
+			View::render ('myapp/hello', $params)
+		);
+	}
+}
+
+?>
\ No newline at end of file
Files elefant-1.3.1-beta/tests/zombie/admin-login-failure.coffee and elefant-1.3.2-beta/tests/zombie/admin-login-failure.coffee are identical
Files elefant-1.3.1-beta/tests/zombie/admin-login-failure.js and elefant-1.3.2-beta/tests/zombie/admin-login-failure.js are identical
Files elefant-1.3.1-beta/tests/zombie/admin-login-success.coffee and elefant-1.3.2-beta/tests/zombie/admin-login-success.coffee are identical
Files elefant-1.3.1-beta/tests/zombie/admin-login-success.js and elefant-1.3.2-beta/tests/zombie/admin-login-success.js are identical
Files elefant-1.3.1-beta/tests/zombie/homepage.coffee and elefant-1.3.2-beta/tests/zombie/homepage.coffee are identical
Files elefant-1.3.1-beta/tests/zombie/homepage.js and elefant-1.3.2-beta/tests/zombie/homepage.js are identical
