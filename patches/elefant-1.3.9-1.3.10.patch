Files elefant-elefant_1_3_9_beta/.gitattributes and elefant-elefant_1_3_10_beta/.gitattributes are identical
Files elefant-elefant_1_3_9_beta/.gitignore and elefant-elefant_1_3_10_beta/.gitignore are identical
Files elefant-elefant_1_3_9_beta/.htaccess and elefant-elefant_1_3_10_beta/.htaccess are identical
diff -urBNs elefant-elefant_1_3_9_beta/.travis.yml elefant-elefant_1_3_10_beta/.travis.yml
--- elefant-elefant_1_3_9_beta/.travis.yml	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/.travis.yml	2014-12-03 23:59:25.000000000 -0600
@@ -3,6 +3,7 @@
   - 5.3
   - 5.4
   - 5.5
+  - 5.6
   - hhvm
 services: mongodb
 script: phpunit
Files elefant-elefant_1_3_9_beta/LICENSE and elefant-elefant_1_3_10_beta/LICENSE are identical
Files elefant-elefant_1_3_9_beta/README.md and elefant-elefant_1_3_10_beta/README.md are identical
Files elefant-elefant_1_3_9_beta/apps/.htaccess and elefant-elefant_1_3_10_beta/apps/.htaccess are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/conf/acl.php elefant-elefant_1_3_10_beta/apps/admin/conf/acl.php
--- elefant-elefant_1_3_9_beta/apps/admin/conf/acl.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/conf/acl.php	2014-12-03 23:59:25.000000000 -0600
@@ -2,9 +2,10 @@
 
 admin = "Basic admin access"
 admin/versions = "Restore content from past versions"
+admin/pages = "Modify web pages"
 admin/add = "Create new content"
-admin/edit = "Modify page content"
+admin/edit = "Update existing content"
 admin/delete = "Delete content"
 settings = "Modify site settings"
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/conf/config.php elefant-elefant_1_3_10_beta/apps/admin/conf/config.php
--- elefant-elefant_1_3_9_beta/apps/admin/conf/config.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/conf/config.php	2014-12-03 23:59:25.000000000 -0600
@@ -6,6 +6,9 @@
 ; successfully logging in via the /admin URL.
 login_redirect = "/"
 
+; Whether to show "All Pages" in the tools menu.
+show_all_pages = On
+
 [Scripts]
 
 ; The place to load jQuery from, either 'local', 'google' which uses
@@ -17,5 +20,6 @@
 handler = admin/versions
 name = Versions
 sitemap = "Webpage::sitemap"
+search = "Webpage::search"
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/conf/embed.php elefant-elefant_1_3_10_beta/apps/admin/conf/embed.php
--- elefant-elefant_1_3_9_beta/apps/admin/conf/embed.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/conf/embed.php	2014-12-03 23:59:25.000000000 -0600
@@ -45,4 +45,4 @@
 id[require] = "apps/admin/lib/Functions.php"
 id[filter] = admin_embed_filter
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/conf/update/1.3.10_users_mysql.sql elefant-elefant_1_3_10_beta/apps/admin/conf/update/1.3.10_users_mysql.sql
--- elefant-elefant_1_3_9_beta/apps/admin/conf/update/1.3.10_users_mysql.sql	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/conf/update/1.3.10_users_mysql.sql	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,30 @@
+alter table #prefix#user add column phone char(32) not null default '';
+alter table #prefix#user add column address char(48) not null default '';
+alter table #prefix#user add column address2 char(48) not null default '';
+alter table #prefix#user add column city char(48) not null default '';
+alter table #prefix#user add column state char(3) not null default '';
+alter table #prefix#user add column country char(3) not null default '';
+alter table #prefix#user add column zip char(16) not null default '';
+alter table #prefix#user add column title char(48) not null default '';
+alter table #prefix#user add column company char(48) not null default '';
+alter table #prefix#user add column photo char(128) not null default '';
+alter table #prefix#user add column about text not null;
+alter table #prefix#user add column website char(128) not null default '';
+
+create table #prefix#user_links (
+	id int not null auto_increment primary key,
+	user_id int not null,
+	service char(32) not null default '',
+	handle char(72) not null,
+	index (user_id, service)
+);
+
+create table #prefix#user_notes (
+	id int not null auto_increment primary key,
+	user_id int not null,
+	ts datetime not null,
+	made_by int not null,
+	note text not null,
+	index (user_id, ts),
+	index (made_by, ts)
+);
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/conf/update/1.3.10_users_pgsql.sql elefant-elefant_1_3_10_beta/apps/admin/conf/update/1.3.10_users_pgsql.sql
--- elefant-elefant_1_3_9_beta/apps/admin/conf/update/1.3.10_users_pgsql.sql	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/conf/update/1.3.10_users_pgsql.sql	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,36 @@
+alter table #prefix#user add column phone char(32) not null default '';
+alter table #prefix#user add column address char(48) not null default '';
+alter table #prefix#user add column address2 char(48) not null default '';
+alter table #prefix#user add column city char(48) not null default '';
+alter table #prefix#user add column state char(3) not null default '';
+alter table #prefix#user add column country char(3) not null default '';
+alter table #prefix#user add column zip char(16) not null default '';
+alter table #prefix#user add column title char(48) not null default '';
+alter table #prefix#user add column company char(48) not null default '';
+alter table #prefix#user add column photo char(128) not null default '';
+alter table #prefix#user add column about text not null default '';
+alter table #prefix#user add column website char(128) not null default '';
+
+create sequence #prefix#user_links_seq;
+
+create table #prefix#user_links (
+	id integer not null default nextval('#prefix#user_links_seq') primary key,
+	user_id int not null,
+	service char(32) not null default '',
+	handle char(72) not null
+);
+
+create index #prefix#user_links_user on #prefix#user_links (user_id, service);
+
+create sequence #prefix#user_notes_seq;
+
+create table #prefix#user_notes (
+	id integer not null default nextval('#prefix#user_notes_seq') primary key,
+	user_id int not null,
+	ts timestamp not null,
+	made_by int not null,
+	note text not null
+);
+
+create index #prefix#user_notes_user on #prefix#user_notes (user_id, ts);
+create index #prefix#user_notes_made_by on #prefix#user_notes (made_by, ts);
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/conf/update/1.3.10_users_sqlite.sql elefant-elefant_1_3_10_beta/apps/admin/conf/update/1.3.10_users_sqlite.sql
--- elefant-elefant_1_3_9_beta/apps/admin/conf/update/1.3.10_users_sqlite.sql	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/conf/update/1.3.10_users_sqlite.sql	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,32 @@
+alter table #prefix#user add column phone char(32) not null default '';
+alter table #prefix#user add column address char(48) not null default '';
+alter table #prefix#user add column address2 char(48) not null default '';
+alter table #prefix#user add column city char(48) not null default '';
+alter table #prefix#user add column state char(3) not null default '';
+alter table #prefix#user add column country char(3) not null default '';
+alter table #prefix#user add column zip char(16) not null default '';
+alter table #prefix#user add column title char(48) not null default '';
+alter table #prefix#user add column company char(48) not null default '';
+alter table #prefix#user add column photo char(128) not null default '';
+alter table #prefix#user add column about text not null default '';
+alter table #prefix#user add column website char(128) not null default '';
+
+create table #prefix#user_links (
+	id integer primary key,
+	user_id int not null,
+	service char(32) not null default '',
+	handle char(72) not null
+);
+
+create index #prefix#user_links_user on #prefix#user_links (user_id, service);
+
+create table #prefix#user_notes (
+	id integer primary key,
+	user_id int not null,
+	ts datetime not null,
+	made_by int not null,
+	note text not null
+);
+
+create index #prefix#user_notes_user on #prefix#user_notes (user_id, ts);
+create index #prefix#user_notes_made_by on #prefix#user_notes (made_by, ts);
Files elefant-elefant_1_3_9_beta/apps/admin/conf/update/extended_fields_mysql.sql and elefant-elefant_1_3_10_beta/apps/admin/conf/update/extended_fields_mysql.sql are identical
Files elefant-elefant_1_3_9_beta/apps/admin/conf/update/extended_fields_pgsql.sql and elefant-elefant_1_3_10_beta/apps/admin/conf/update/extended_fields_pgsql.sql are identical
Files elefant-elefant_1_3_9_beta/apps/admin/conf/update/extended_fields_sqlite.sql and elefant-elefant_1_3_10_beta/apps/admin/conf/update/extended_fields_sqlite.sql are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/960.css and elefant-elefant_1_3_10_beta/apps/admin/css/960.css are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/admin/add.png and elefant-elefant_1_3_10_beta/apps/admin/css/admin/add.png are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/admin/arrow-down.png and elefant-elefant_1_3_10_beta/apps/admin/css/admin/arrow-down.png are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/admin/arrow-right.png and elefant-elefant_1_3_10_beta/apps/admin/css/admin/arrow-right.png are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/admin/blank.png and elefant-elefant_1_3_10_beta/apps/admin/css/admin/blank.png are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/admin/delete.png and elefant-elefant_1_3_10_beta/apps/admin/css/admin/delete.png are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/admin/drag_drop_up_down.png and elefant-elefant_1_3_10_beta/apps/admin/css/admin/drag_drop_up_down.png are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/admin/dynamic-icon.png and elefant-elefant_1_3_10_beta/apps/admin/css/admin/dynamic-icon.png are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/admin/edit.png and elefant-elefant_1_3_10_beta/apps/admin/css/admin/edit.png are identical
Binary files elefant-elefant_1_3_9_beta/apps/admin/css/admin/editable-photo.png and elefant-elefant_1_3_10_beta/apps/admin/css/admin/editable-photo.png differ
Files elefant-elefant_1_3_9_beta/apps/admin/css/admin/editable-sprite-dark.png and elefant-elefant_1_3_10_beta/apps/admin/css/admin/editable-sprite-dark.png are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/admin/editable-sprite-violett.png and elefant-elefant_1_3_10_beta/apps/admin/css/admin/editable-sprite-violett.png are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/admin/editable-sprite.png and elefant-elefant_1_3_10_beta/apps/admin/css/admin/editable-sprite.png are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/admin/elefant_logo.png and elefant-elefant_1_3_10_beta/apps/admin/css/admin/elefant_logo.png are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/admin/elefant_logo_login.png and elefant-elefant_1_3_10_beta/apps/admin/css/admin/elefant_logo_login.png are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/admin/file.png and elefant-elefant_1_3_10_beta/apps/admin/css/admin/file.png are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/admin/folder.png and elefant-elefant_1_3_10_beta/apps/admin/css/admin/folder.png are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/admin/lock.png and elefant-elefant_1_3_10_beta/apps/admin/css/admin/lock.png are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/admin/pipe.png and elefant-elefant_1_3_10_beta/apps/admin/css/admin/pipe.png are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/admin/spacer.png and elefant-elefant_1_3_10_beta/apps/admin/css/admin/spacer.png are identical
Binary files elefant-elefant_1_3_9_beta/apps/admin/css/admin/tools-arrow-hover.png and elefant-elefant_1_3_10_beta/apps/admin/css/admin/tools-arrow-hover.png differ
Binary files elefant-elefant_1_3_9_beta/apps/admin/css/admin/tools-arrow.png and elefant-elefant_1_3_10_beta/apps/admin/css/admin/tools-arrow.png differ
Files elefant-elefant_1_3_9_beta/apps/admin/css/admin/tooltip-top.png and elefant-elefant_1_3_10_beta/apps/admin/css/admin/tooltip-top.png are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/admin/undo-icon.png and elefant-elefant_1_3_10_beta/apps/admin/css/admin/undo-icon.png are identical
Binary files elefant-elefant_1_3_9_beta/apps/admin/css/admin/user_profile.png and elefant-elefant_1_3_10_beta/apps/admin/css/admin/user_profile.png differ
Files elefant-elefant_1_3_9_beta/apps/admin/css/admin/versions.png and elefant-elefant_1_3_10_beta/apps/admin/css/admin/versions.png are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/css/admin.css elefant-elefant_1_3_10_beta/apps/admin/css/admin.css
--- elefant-elefant_1_3_9_beta/apps/admin/css/admin.css	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/css/admin.css	2014-12-03 23:59:25.000000000 -0600
@@ -6,6 +6,7 @@
 
 a {
 	color: #93278f;
+	text-decoration: none;
 }
 
 a:hover {
@@ -21,29 +22,81 @@
 	border-bottom: 1px solid #ccc;
 }
 
+/**
+ * Table styles
+ */
+
 table {
 	empty-cells: show;
 }
 
-table tr:hover {
-	background: #eee;
-}
+	table tr:hover {
+		background: #eee;
+	}
 
-table tr th {
-	padding: 5px 7px 5px 7px;
-	border-bottom: 1px solid #666;
-	font-weight: bold;
-	background: #f5f5f5;
-}
+		table tr th {
+			padding: 5px 7px 5px 7px;
+			border-bottom: 1px solid #666;
+			font-weight: bold;
+			background: #f5f5f5;
+		}
 
-table tr th a {
-	font-weight: normal;
-}
+		table tr th select,
+		table tr th select:focus,
+		table tr th select:active {
+			-webkit-appearance: none;
+			-moz-appearance: none;
+			appearance: none;
+			border: 0;
+			padding-left: 16px;
+			background-color: transparent;
+			background-image: url(/apps/admin/css/admin/arrow-down.png);
+			background-position: 0% 40%;
+			background-repeat: no-repeat;
+			font-weight: inherit;
+			font-size: inherit;
+			color: inherit;
+			outline: none;
+		}
+		
+		table tr th select:hover {
+			cursor: pointer;
+			font-weight: inherit;
+			font-family: inherit;
+			font-size: inherit;
+		}
 
-table tr td {
-	padding: 5px 7px 5px 7px;
-	border-bottom: 1px solid #ccc;
-}
+		table tr th a {
+			font-weight: normal;
+		}
+
+		table tr td {
+			padding: 5px 7px 5px 7px;
+			border-bottom: 1px solid #ccc;
+		}
+
+			td.title {
+				font-weight: bold;
+			}
+
+			td.info {
+				color: #666;
+				font-size: 0.9em;
+			}
+
+			td.edit {
+				text-align: right;
+			}
+		
+		table tr th:first-child,
+		table tr td:first-child {
+			padding-left: 0;
+		}
+		
+		table tr th:last-child,
+		table tr td:last-child {
+			padding-right: 0;
+		}
 
 tt {
 	color: #000;
@@ -239,6 +292,10 @@
 	white-space: nowrap;
 }
 
+/**
+ * Form inputs
+ */
+
 input[type=text], input[type=password], input[type=email], textarea {
 	font-size: 12px;
 	border: 1px solid #999;
@@ -247,13 +304,19 @@
     -moz-border-radius: 2px;
     padding: 2px 4px;
     text-shadow: 0 1px 0 #fff;
+    outline: none;
+}
+
+input[type=file] {
+	outline: none;
 }
 
 input[disabled] {
 	background: #eee;
+	outline: none;
 }
 
-input[type=submit], .dynamic-embed-object-back {
+input[type=submit], button, .dynamic-embed-object-back {
     font-size: 12px;
 	border: 1px solid #ddd;
     background: #e5e5e5;
@@ -264,19 +327,24 @@
     -webkit-border-radius: 4px;
     -moz-border-radius: 4px;
     color: #555;
-    padding: 5px 10px;
+    padding: 3px 10px;
     text-shadow: 0 1px 0 #fff;
-    margin-bottom: 16px;
+    outline: none;
 }
 
-input[type=submit]:hover, .dynamic-embed-object-back:hover {
+input[type=submit]:hover, button:hover, .dynamic-embed-object-back:hover {
 	color: #333;
 	border: 1px solid #999;
     -moz-box-shadow: 0 2px 0 rgba(0, 0, 0, 0.2);
     -webkit-box-shadow:0 2px 5px rgba(0, 0, 0, 0.2);
     box-shadow: 0 1px 2px rgba(0, 0, 0, 0.15);
+    cursor: pointer;
 }
 
+/**
+ * Dynamic Objects menu
+ */
+
 .dynamic-embed-object-list {
 	padding: 0px;
 	margin: 0px;
@@ -434,6 +502,10 @@
 	padding-top: 50px;
 }
 
+/**
+ * Navigation
+ */
+
 .nav {
 	text-align: right;
 }
@@ -453,6 +525,10 @@
 		padding-top: 2px;
 	}
 
+/**
+ * Header and footer
+ */
+
 #head {
 	border-top: 3px solid #111;
 	padding-bottom: 0px;
@@ -486,11 +562,12 @@
 	padding-top: 5px;
 	margin-top: 25px;
 	padding-bottom: 15px;
+	text-align: right;
 }
 
-	.copyright {
-		text-align: right;
-	}
+/**
+ * Responsiveness
+ */
 
 @media screen and (max-width: 480px) {
 	body, th, td {
Files elefant-elefant_1_3_9_beta/apps/admin/css/datewidget.css and elefant-elefant_1_3_10_beta/apps/admin/css/datewidget.css are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/debugger.css and elefant-elefant_1_3_10_beta/apps/admin/css/debugger.css are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/dynamicobjects.css and elefant-elefant_1_3_10_beta/apps/admin/css/dynamicobjects.css are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/css/editable.css elefant-elefant_1_3_10_beta/apps/admin/css/editable.css
--- elefant-elefant_1_3_9_beta/apps/admin/css/editable.css	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/css/editable.css	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,38 @@
+.editable-text,
+.editable-textarea,
+.editable-select {
+	overflow: hidden;
+	box-sizing: border-box;
+	-moz-box-sizing: border-box;
+	-webkit-box-sizing: border-box;
+	border: 1px solid rgba(0,0,0,0);
+	padding: 2px;
+}
+
+.editable-text:hover,
+.editable-textarea:hover,
+.editable-select:hover {
+	border: 1px dashed #ddd;
+	cursor: pointer;
+}
+
+.editable input,
+.editable textarea,
+.editable select {
+	font-size: inherit;
+	font-weight: inherit;
+	background: inherit;
+	border: 0px;
+	outline: none;
+}
+
+/*
+.editable-btn-save {
+}
+
+.editable-btn-delete {
+}
+
+.editable-btn-cancel {
+}
+*/
\ No newline at end of file
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/css/font-awesome.css and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/css/font-awesome.css are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/css/font-awesome.min.css and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/css/font-awesome.min.css are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/font/FontAwesome.otf and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/font/FontAwesome.otf are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/font/fontawesome-webfont.eot and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/font/fontawesome-webfont.eot are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/font/fontawesome-webfont.svg and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/font/fontawesome-webfont.svg are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/font/fontawesome-webfont.ttf and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/font/fontawesome-webfont.ttf are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/font/fontawesome-webfont.woff and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/font/fontawesome-webfont.woff are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/fonts/FontAwesome.otf and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/fonts/FontAwesome.otf are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/fonts/fontawesome-webfont.eot and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/fonts/fontawesome-webfont.eot are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/fonts/fontawesome-webfont.svg and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/fonts/fontawesome-webfont.svg are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/fonts/fontawesome-webfont.ttf and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/fonts/fontawesome-webfont.ttf are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/fonts/fontawesome-webfont.woff and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/fonts/fontawesome-webfont.woff are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/less/bordered-pulled.less and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/less/bordered-pulled.less are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/less/core.less and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/less/core.less are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/less/fixed-width.less and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/less/fixed-width.less are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/less/font-awesome.less and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/less/font-awesome.less are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/less/icons.less and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/less/icons.less are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/less/larger.less and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/less/larger.less are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/less/list.less and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/less/list.less are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/less/mixins.less and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/less/mixins.less are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/less/path.less and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/less/path.less are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/less/rotated-flipped.less and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/less/rotated-flipped.less are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/less/spinning.less and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/less/spinning.less are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/less/stacked.less and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/less/stacked.less are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/less/variables.less and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/less/variables.less are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/scss/_bordered-pulled.scss and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/scss/_bordered-pulled.scss are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/scss/_core.scss and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/scss/_core.scss are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/scss/_fixed-width.scss and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/scss/_fixed-width.scss are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/scss/_icons.scss and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/scss/_icons.scss are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/scss/_larger.scss and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/scss/_larger.scss are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/scss/_list.scss and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/scss/_list.scss are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/scss/_mixins.scss and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/scss/_mixins.scss are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/scss/_path.scss and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/scss/_path.scss are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/scss/_rotated-flipped.scss and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/scss/_rotated-flipped.scss are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/scss/_spinning.scss and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/scss/_spinning.scss are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/scss/_stacked.scss and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/scss/_stacked.scss are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/scss/_variables.scss and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/scss/_variables.scss are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/font-awesome/scss/font-awesome.scss and elefant-elefant_1_3_10_beta/apps/admin/css/font-awesome/scss/font-awesome.scss are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/icon-conditionalforward.png and elefant-elefant_1_3_10_beta/apps/admin/css/icon-conditionalforward.png are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/icon-html.png and elefant-elefant_1_3_10_beta/apps/admin/css/icon-html.png are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/jquery.jgrowl.css and elefant-elefant_1_3_10_beta/apps/admin/css/jquery.jgrowl.css are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/jquery.notifier.css and elefant-elefant_1_3_10_beta/apps/admin/css/jquery.notifier.css are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/css/minimal-grid.css elefant-elefant_1_3_10_beta/apps/admin/css/minimal-grid.css
--- elefant-elefant_1_3_9_beta/apps/admin/css/minimal-grid.css	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/css/minimal-grid.css	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,136 @@
+/**
+ * A minimal responsive grid system for Elefant's apps.
+ *
+ * Usage:
+ *
+ *     <div class="e-row">
+ *         <div class="e-col-75">
+ *             <h1>Body</h1>
+ *         </div>
+ *         <div class="e-col-25">
+ *             <h2>Sidebar</h2>
+ *         </div>
+ *     </div>
+ *
+ * Classes:
+ *
+ *     .e-row            A centered row of 992px that scales via media queries
+ *     .e-row-variable   A row of variable width
+ *     .e-row-equal      A variable width row of equal height columns
+ *     .e-no-padding     Removes padding on an element
+ *     .e-col-10         A column of 10%
+ *     .e-col-20         A column of 20%
+ *     .e-col-25         A column of 25%
+ *     .e-col-30         A column of 30%
+ *     .e-col-33         A column of 33%
+ *     .e-col-40         A column of 40%
+ *     .e-col-50         A column of 50%
+ *     .e-col-60         A column of 60%
+ *     .e-col-66         A column of 66%
+ *     .e-col-70         A column of 70%
+ *     .e-col-75         A column of 75%
+ *     .e-col-80         A column of 80%
+ *     .e-col-90         A column of 90%
+ *     .e-col-100        A column of 100%
+ *
+ * Note that .e-row-equal does not wrap columns in IE10 and under. This is
+ * fine for equal height columns in pre-defined rows, but won't work for
+ * arbitrary numbers of columns. However, it will wrap and collapse correctly
+ * on mobile and tablet devices, and works correctly for all single-row uses.
+ */
+
+[class^='e-'], [class^='e-']:after, [class^='e-']:before {
+	margin: 0;
+	padding: 0;
+	outline: 0;
+	-webkit-box-sizing: border-box;
+	-moz-box-sizing: border-box;
+	box-sizing: border-box;
+	border-collapse: collapse;
+}
+
+/* equal height columns */
+.e-row-equal {
+	display: -webkit-box;
+	display: -moz-box;
+	display: -ms-flexbox;
+	display: -webkit-flex;
+	display: flex;
+	-webkit-flex-wrap: wrap;
+	-moz-flex-wrap: wrap;
+	flex-wrap: wrap;
+}
+
+/* attribute selector */
+[class^='e-col-'] {
+	float: left;
+	padding: 10px;
+}
+
+/* clearfix */
+.e-row:after, .e-row-variable:after {
+	content: "";
+	display: table;
+	table-layout: fixed;
+	clear: both;
+}
+
+/* widths */
+.e-col-100 { width: 100%; }
+.e-col-90  { width: 90%; }
+.e-col-80  { width: 80%; }
+.e-col-75  { width: 75%; }
+.e-col-70  { width: 70%; }
+.e-col-66  { width: 66.66%; }
+.e-col-60  { width: 60%; }
+.e-col-50  { width: 50%; }
+.e-col-40  { width: 40%; }
+.e-col-33  { width: 33.33%; }
+.e-col-30  { width: 30%; }
+.e-col-25  { width: 25%; }
+.e-col-20  { width: 20%; }
+.e-col-10  { width: 10%; }
+.e-col-5   { width: 5%; }
+
+/* remove padding */
+.e-no-padding { padding: 0; }
+
+/* desktop */
+@media (min-width: 992px) {
+	.e-row {
+		width: 992px;
+		margin: 0px auto 0px auto;
+	}
+}
+
+@media (max-width: 991px) {
+	.e-row { width: 100%; }
+}
+
+/* tablets */
+@media (max-width: 768px) {
+	.e-col-10, .e-col-20, .e-col-25, .e-col-30, .e-col-33, .e-col-40, .e-col-50, .e-col-66, .e-col-75 {
+		width: 50%;
+		max-width 50%;
+	}
+	
+	.e-col-60, .e-col-70, .e-col-80, .e-col-90, .e-col-100 {
+		width: 100%;
+	}
+	
+	.e-col-5 {
+		display: none;
+	}
+}
+
+/* mobile */
+@media (max-width: 480px) {
+	.e-col-10, .e-col-20, .e-col-25, .e-col-30, .e-col-33, .e-col-40, .e-col-50,
+	.e-col-60, .e-col-66, .e-col-70, .e-col-75, .e-col-80, .e-col-90, .e-col-100 {
+		width: 100%;
+	}
+	
+	.e-col-5 {
+		display: none;
+	}
+}
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/css/minimal-grid.html elefant-elefant_1_3_10_beta/apps/admin/css/minimal-grid.html
--- elefant-elefant_1_3_9_beta/apps/admin/css/minimal-grid.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/css/minimal-grid.html	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,101 @@
+<!DOCTYPE html>
+<html>
+<head>
+	<link rel="stylesheet" href="/apps/admin/css/minimal-grid.css" />
+	<style>
+	body {
+		font-family: Helvetica, Arial, sans-serif;
+	}
+	.e-row, .e-row-variable {
+		margin-bottom: 20px;
+	}
+	div>div {
+		border: 1px solid #000;
+		background-color: #ace;
+	}
+	</style>
+</head>
+<body>
+
+<h3>e-row grid</h3>
+
+<div class="e-row">
+	<div class="e-col-25">25%</div>
+	<div class="e-col-50">50%</div>
+	<div class="e-col-25">25%</div>
+</div>
+
+<div class="e-row">
+	<div class="e-col-10">10%</div>
+	<div class="e-col-20">20%</div>
+	<div class="e-col-30">30%</div>
+	<div class="e-col-40">40%</div>
+</div>
+
+<div class="e-row">
+	<div class="e-col-33">33%</div>
+	<div class="e-col-66">66%</div>
+</div>
+
+<h3>e-row-variable grid</h3>
+
+<div class="e-row-variable">
+	<div class="e-col-25">25%</div>
+	<div class="e-col-50">50%</div>
+	<div class="e-col-25">25%</div>
+</div>
+
+<div class="e-row-variable">
+	<div class="e-col-10">10%</div>
+	<div class="e-col-20">20%</div>
+	<div class="e-col-30">30%</div>
+	<div class="e-col-40">40%</div>
+</div>
+
+<div class="e-row-variable">
+	<div class="e-col-33">33%</div>
+	<div class="e-col-66">66%</div>
+</div>
+
+<h3>equal height</h3>
+
+<div class="e-row-equal">
+	<div class="e-col-25">25%<br />...</div>
+	<div class="e-col-50">50%<br />...<br />...</div>
+	<div class="e-col-25">25%</div>
+</div>
+
+<h3>padding vs .e-no-padding</h3>
+
+<div class="e-row">
+	<div class="e-col-33">33%</div>
+	<div class="e-col-33">33%</div>
+	<div class="e-col-33">33%</div>
+</div>
+
+<div class="e-row">
+	<div class="e-col-33 e-no-padding">33%</div>
+	<div class="e-col-33 e-no-padding">33%</div>
+	<div class="e-col-33 e-no-padding">33%</div>
+</div>
+
+<h3>overflowing grid</h3>
+
+<div class="e-row">
+	<div class="e-col-25">25%</div>
+	<div class="e-col-25">25%</div>
+	<div class="e-col-25">25%</div>
+	<div class="e-col-25">25%</div>
+	<div class="e-col-25">25%</div>
+	<div class="e-col-25">25%</div>
+	<div class="e-col-25">25%</div>
+	<div class="e-col-25">25%</div>
+	<div class="e-col-25">25%</div>
+	<div class="e-col-25">25%</div>
+	<div class="e-col-25">25%</div>
+	<div class="e-col-25">25%</div>
+</div>
+</div>
+
+</body>
+</html>
Files elefant-elefant_1_3_9_beta/apps/admin/css/modal.css and elefant-elefant_1_3_10_beta/apps/admin/css/modal.css are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/reset.css and elefant-elefant_1_3_10_beta/apps/admin/css/reset.css are identical
Files elefant-elefant_1_3_9_beta/apps/admin/css/text.css and elefant-elefant_1_3_10_beta/apps/admin/css/text.css are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/css/top-bar.css elefant-elefant_1_3_10_beta/apps/admin/css/top-bar.css
--- elefant-elefant_1_3_9_beta/apps/admin/css/top-bar.css	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/css/top-bar.css	2014-12-03 23:59:25.000000000 -0600
@@ -3,6 +3,9 @@
 }
 
 #admin-bar {
+	-webkit-box-sizing: content-box;
+	-moz-box-sizing: content-box;
+	box-sizing: content-box;
 	position: absolute;
 	top: 0;
 	left: 0;
@@ -19,6 +22,7 @@
 	font-weight: bold;
 	font-family: Helvetica, Arial, sans-serif !important;
 	text-align: left;
+	line-height: 21px;
 
 	background: #eeeeee; /* Old browsers */
 	background: -moz-linear-gradient(top,  #eeeeee 0%, #dddddd 100%); /* FF3.6+ */
@@ -33,6 +37,12 @@
 	box-shadow: 0px 1px 2px rgba(0,0,0,.5);
 }
 
+	#admin-bar * {
+		-webkit-box-sizing: content-box;
+		-moz-box-sizing: content-box;
+		box-sizing: content-box;
+	}
+
 	#admin-bar img {
 		margin-top: 0px;
 		border: 0px none;
@@ -55,34 +65,20 @@
 		font-weight: normal;
 		color: #222;
 		position: relative;
+		
+		background-image: url(/apps/admin/css/admin/tools-arrow.png);
+		background-repeat: no-repeat;
+		background-position: 85% 50%;
 	}
 
 		#admin-links>span:hover {
 			color: #93278f;
-
-			background: #dddddd; /* Old browsers */
-			background: -moz-linear-gradient(top,  #dddddd 0%, #cccccc 100%); /* FF3.6+ */
-			background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#dddddd), color-stop(100%,#cccccc)); /* Chrome,Safari4+ */
-			background: -webkit-linear-gradient(top,  #dddddd 0%,#cccccc 100%); /* Chrome10+,Safari5.1+ */
-			background: -o-linear-gradient(top,  #dddddd 0%,#cccccc 100%); /* Opera 11.10+ */
-			background: -ms-linear-gradient(top,  #dddddd 0%,#cccccc 100%); /* IE10+ */
-			background: linear-gradient(to bottom,  #dddddd 0%,#cccccc 100%); /* W3C */
-
+			background-color: #dddddd;
+			background-image: url(/apps/admin/css/admin/tools-arrow-hover.png);
+			background-repeat: no-repeat;
+			background-position: 85% 50%;
 			text-decoration: none;
-		}
-
-		#admin-tools>strong {
-			font-weight: normal;
-			border: 1px solid #444;
-			-webkit-border-radius: 12px;
-			-moz-border-radius: 12px;
-			border-radius: 12px;
-			padding: 0px 3px 0px 3px;
-		}
-
-		#admin-tools:hover>strong {
-			background: #ccc;
-			border: 1px solid #93278f;
+			cursor: pointer;
 		}
 
 	#admin-links a {
@@ -98,15 +94,7 @@
 
 		#admin-links a:hover, #admin-links a:focus {
 			color: #93278f;
-
-			background: #dddddd; /* Old browsers */
-			background: -moz-linear-gradient(top,  #dddddd 0%, #cccccc 100%); /* FF3.6+ */
-			background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#dddddd), color-stop(100%,#cccccc)); /* Chrome,Safari4+ */
-			background: -webkit-linear-gradient(top,  #dddddd 0%,#cccccc 100%); /* Chrome10+,Safari5.1+ */
-			background: -o-linear-gradient(top,  #dddddd 0%,#cccccc 100%); /* Opera 11.10+ */
-			background: -ms-linear-gradient(top,  #dddddd 0%,#cccccc 100%); /* IE10+ */
-			background: linear-gradient(to bottom,  #dddddd 0%,#cccccc 100%); /* W3C */
-
+			background-color: #dddddd;
 			text-decoration: none;
 			outline: 0;
 		}
@@ -173,6 +161,78 @@
 		color: #93278f;
 		outline: 0;
 	}
+	
+	#admin-tools-arrow {
+		color: #93278f;
+		font-size: 12px;
+		font-weight: normal;
+		text-decoration: none;
+		text-align: center;
+		display: block;
+		width: 100px;
+		height: 30px;
+		margin: auto;
+		margin-top: -48px;
+		z-index: 100001;
+		cursor: pointer;
+		
+		background-image: url(/apps/admin/css/admin/tools-arrow.png);
+		background-repeat: no-repeat;
+		background-position: 50% 50%;
+	}
+	
+	#admin-tools-list.admin-tools-custom {
+		position: absolute;
+		top: 35px;
+		left: 0;
+		width: 100%;
+		color: #222;
+		/*
+		background: #ddd;
+		background: rgba(235,235,235,.95);
+		*/
+		padding: 15px 10px 12px 15px;
+		background: rgba(170,170,170,0.95);
+		background: -moz-linear-gradient(top, rgba(170,170,170,0.95) 0%, rgba(219,219,219,0.95) 3%, rgba(221,221,221,0.95) 100%);
+		background: -webkit-gradient(left top, left bottom, color-stop(0%, rgba(170,170,170,0.95)), color-stop(3%, rgba(219,219,219,0.95)), color-stop(100%, rgba(221,221,221,0.95)));
+		background: -webkit-linear-gradient(top, rgba(170,170,170,0.95) 0%, rgba(219,219,219,0.95) 3%, rgba(221,221,221,0.95) 100%);
+		background: -o-linear-gradient(top, rgba(170,170,170,0.95) 0%, rgba(219,219,219,0.95) 3%, rgba(221,221,221,0.95) 100%);
+		background: -ms-linear-gradient(top, rgba(170,170,170,0.95) 0%, rgba(219,219,219,0.95) 3%, rgba(221,221,221,0.95) 100%);
+		background: linear-gradient(to bottom, rgba(170,170,170,0.95) 0%, rgba(219,219,219,0.95) 3%, rgba(221,221,221,0.95) 100%);
+		filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#aaaaaa', endColorstr='#dddddd', GradientType=0 );
+	}
+	
+		.admin-tools-section {
+			float: left;
+			width: 19%;
+		}
+		
+		h3.admin-tools-section-header {
+			font-family: Helvetica, Arial, sans-serif;
+			font-size: 21px;
+			line-height: 21px;
+			font-weight: normal;
+			margin-bottom: 0;
+		}
+		
+		.admin-tools-section ul.admin-tools-list {
+			margin-left: 0;
+			padding-left: 0;
+		}
+	
+		.admin-tools-section li {
+			list-style-type: none;
+		}
+		
+		#admin-tools-list .admin-tools-section li a,
+		#admin-tools-list .admin-tools-section li a:focus,
+		#admin-tools-list .admin-tools-section li a:hover {
+			background: inherit;
+			border-bottom: 0;
+			padding-left: 0;
+			height: 24px;
+			width: 100%;
+		}
 
 	#admin-update-available {
 		color: #93278f;
@@ -191,8 +251,31 @@
 		color: #B347AF;
 	}
 
+		#admin-tools-list .admin-tools-section li a.not-installed, #admin-tools-list .admin-tools-section li a.needs-upgrade {
+			color: #93278f;
+			font-weight: bold;
+		}
+
+		#admin-tools-list .admin-tools-section li a.not-installed:hover, #admin-tools-list .admin-tools-section li a.needs-upgrade:hover,
+		#admin-tools-list .admin-tools-section li a.not-installed:focus, #admin-tools-list .admin-tools-section li a.needs-upgrade:focus {
+			color: #B347AF;
+			font-weight: bold;
+		}
+
+#preview-bar,
+p.admin-options {
+	display: block;
+	line-height: 21px;
+	font-size: 13px;
+	font-family: Helvetica, Arial, sans-serif;
+	font-weight: normal;
+}
+
 #preview-bar a,
 p.admin-options {
+	-webkit-box-sizing: content-box;
+	-moz-box-sizing: content-box;
+	box-sizing: content-box;
 	display: inline-block;
 	margin: 0;
 	padding: 0;
@@ -202,6 +285,9 @@
 
 #preview-bar a,
 p.admin-options a {
+	-webkit-box-sizing: content-box;
+	-moz-box-sizing: content-box;
+	box-sizing: content-box;
 	display: inline-block;
 	position: relative;
 	margin: 0;
@@ -227,7 +313,7 @@
 	padding: 0;
 }
 
-#preview-bar a:hover{
+#preview-bar a:hover {
     background-image: url(/apps/admin/css/admin/editable-sprite-violett.png);
 }
 
@@ -303,15 +389,15 @@
 .is-preview #admin-bar,
 .is-preview .admin-options,
 .is-admin #admin-links .admin-tools-show-preview {
-    display: none;
+    display: none !important;
 }
 
 .is-admin #admin-links #admin-tools-website {
-    display:block;
+    display: block !important;
 }
 
 .is-preview #preview-bar {
-    display: block;
+    display: block !important;
     position: fixed;
     top: 0;
     left: 0;
@@ -340,6 +426,9 @@
 }
 
 .is-preview #preview-bar a:hover:after {
+	-webkit-box-sizing: content-box;
+	-moz-box-sizing: content-box;
+	box-sizing: content-box;
 	content: attr(data-title);
 	position: absolute;
 	left: 26px;
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/forms/add.php elefant-elefant_1_3_10_beta/apps/admin/forms/add.php
--- elefant-elefant_1_3_9_beta/apps/admin/forms/add.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/forms/add.php	2014-12-03 23:59:25.000000000 -0600
@@ -14,10 +14,10 @@
 [layout]
 
 skip_if_empty = 1
-callback = admin_layout_exists
+callback = "admin\Layout::exists"
 
 [body]
 
 not empty = 1
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/forms/edit.php elefant-elefant_1_3_10_beta/apps/admin/forms/edit.php
--- elefant-elefant_1_3_9_beta/apps/admin/forms/edit.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/forms/edit.php	2014-12-03 23:59:25.000000000 -0600
@@ -13,10 +13,10 @@
 [layout]
 
 skip_if_empty = 1
-callback = admin_layout_exists
+callback = "admin\Layout::exists"
 
 [body]
 
 not empty = 1
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/add.php elefant-elefant_1_3_10_beta/apps/admin/handlers/add.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/add.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/add.php	2014-12-03 23:59:25.000000000 -0600
@@ -6,9 +6,7 @@
 
 $page->layout = 'admin';
 
-$this->require_acl ('admin', 'admin/edit', 'admin/add');
-
-require_once ('apps/admin/lib/Functions.php');
+$this->require_acl ('admin', 'admin/pages', 'admin/add');
 
 $f = new Form ('post', 'admin/add');
 $f->verify_csrf = false;
@@ -28,7 +26,6 @@
 	$pg = new Page;
 	$pg->layout = 'default';
 	$pg->weight = '0';
-	$pg->layouts = admin_get_layouts ();
 	$pg->failed = $f->failed;
 	$pg = $f->merge_values ($pg);
 	$page->title = __ ('Add Page');
@@ -36,5 +33,3 @@
 	echo $tpl->render ('admin/add/head', $pg);
 	echo $tpl->render ('admin/add', $pg);
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/bgsave.php elefant-elefant_1_3_10_beta/apps/admin/handlers/bgsave.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/bgsave.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/bgsave.php	2014-12-03 23:59:25.000000000 -0600
@@ -48,5 +48,3 @@
 }
 
 echo json_encode ($res);
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/cancel.php elefant-elefant_1_3_10_beta/apps/admin/handlers/cancel.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/cancel.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/cancel.php	2014-12-03 23:59:25.000000000 -0600
@@ -15,5 +15,3 @@
 $lock->remove ();
 
 $this->redirect ($_GET['return']);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/compare.php elefant-elefant_1_3_10_beta/apps/admin/handlers/compare.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/compare.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/compare.php	2014-12-03 23:59:25.000000000 -0600
@@ -24,14 +24,20 @@
 }
 $diff = Versions::diff ($old, $cur);
 $data = array ();
-foreach ((array) $cur->orig () as $key => $value) {
+$cur_orig = (array) $cur->orig ();
+$old_orig = (array) $old->orig ();
+foreach ($cur_orig as $key => $value) {
 	$data[$key] = array (
 		'cur' => $value,
-		'old' => $old->{$key},
+		'old' => $old_orig[$key],
 		'diff' => (in_array ($key, $diff)) ? true : false
 	);
 }
 
+if (is_subclass_of ($cur, 'ExtendedModel')) {
+	unset ($data[$cur->_extended_field]);
+}
+
 $page->title = __ ('Comparing') . ' ' . $ver->class . ' / ' . $ver->pkey;
 
 echo $tpl->render ('admin/compare', array (
@@ -40,5 +46,3 @@
 	'pkey' => $ver->pkey,
 	'ts' => $ver->ts
 ));
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/conditionalforward.php elefant-elefant_1_3_10_beta/apps/admin/handlers/conditionalforward.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/conditionalforward.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/conditionalforward.php	2014-12-03 23:59:25.000000000 -0600
@@ -23,5 +23,3 @@
 if (User::is ($user_type)) {
 	$this->redirect ($url);
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/delete.php elefant-elefant_1_3_10_beta/apps/admin/handlers/delete.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/delete.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/delete.php	2014-12-03 23:59:25.000000000 -0600
@@ -4,7 +4,7 @@
  * Deletes a web page.
  */
 
-$this->require_acl ('admin', 'admin/delete');
+$this->require_acl ('admin', 'admin/pages', 'admin/delete');
 
 $page->layout = 'admin';
 
@@ -33,5 +33,3 @@
 $this->add_notification (__ ('Page deleted.'));
 $this->hook ('admin/delete', $_POST);
 $this->redirect ( isset ($_POST['admin']) ? '/admin/pages' : '/' );
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/edit.php elefant-elefant_1_3_10_beta/apps/admin/handlers/edit.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/edit.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/edit.php	2014-12-03 23:59:25.000000000 -0600
@@ -6,7 +6,7 @@
 
 $page->layout = 'admin';
 
-$this->require_acl ('admin', 'admin/edit');
+$this->require_acl ('admin', 'admin/pages', 'admin/edit');
 
 $lock = new Lock ('Webpage', $_GET['page']);
 if ($lock->exists ()) {
@@ -17,8 +17,6 @@
 	$lock->add ();
 }
 
-require_once ('apps/admin/lib/Functions.php');
-
 $wp = new Webpage ($_GET['page']);
 
 $f = new Form ('post', 'admin/edit');
@@ -47,7 +45,6 @@
 	$page->title = __ ('An Error Occurred');
 	echo __ ('Error Message') . ': ' . $wp->error;
 } else {
-	$wp->layouts = admin_get_layouts ();
 	$wp->failed = $f->failed;
 	$wp = $f->merge_values ($wp);
 	$page->title = __ ('Edit Page') . ': ' . $wp->title;
@@ -55,5 +52,3 @@
 	echo $tpl->render ('admin/edit/head', $wp);
 	echo $tpl->render ('admin/edit', $wp);
 }
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/editable.php elefant-elefant_1_3_10_beta/apps/admin/handlers/editable.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/editable.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/editable.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,16 @@
+<?php
+
+/**
+ * Use this handler to position the page edit buttons in
+ * a specific place in your templates, instead of simply
+ * at the top of the page body. Also useful in case your
+ * template omits the `{{body|none}}` tag altegether, but
+ * you still want to make the page editable for its other
+ * properties.
+ *
+ * Usage:
+ *
+ *     {! admin/editable?id=[id] !}
+ */
+
+echo $tpl->render ('admin/editable', $this->data);
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/embed/filters.php elefant-elefant_1_3_10_beta/apps/admin/handlers/embed/filters.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/embed/filters.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/embed/filters.php	2014-12-03 23:59:25.000000000 -0600
@@ -39,10 +39,10 @@
 		if (isset ($rules[$_POST['handler']][$key]['require'])) {
 			require_once ($rules[$_POST['handler']][$key]['require']);
 		}
-		$out[$key] = $rules[$_POST['handler']][$key]['filter'] ($value, $reverse);
+		if (is_callable ($rules[$_POST['handler']][$key]['filter'])) {
+			$out[$key] = call_user_func ($rules[$_POST['handler']][$key]['filter'], $value, $reverse);
+		}
 	}
 }
 
 echo json_encode ((object) array ('success' => true, 'data' => $out));
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/embed.php elefant-elefant_1_3_10_beta/apps/admin/handlers/embed.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/embed.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/embed.php	2014-12-03 23:59:25.000000000 -0600
@@ -60,5 +60,3 @@
 usort ($embeds, 'admin_embed_sort');
 
 echo json_encode ($embeds);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/error.php elefant-elefant_1_3_10_beta/apps/admin/handlers/error.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/error.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/error.php	2014-12-03 23:59:25.000000000 -0600
@@ -20,5 +20,3 @@
 if (! empty ($this->data['message'])) {
 	echo $this->data['message'];
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/extended/api.php elefant-elefant_1_3_10_beta/apps/admin/handlers/extended/api.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/extended/api.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/extended/api.php	2014-12-03 23:59:25.000000000 -0600
@@ -3,5 +3,3 @@
 $this->require_admin ();
 
 $this->restful (new ExtendedAPI ());
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/extended.php elefant-elefant_1_3_10_beta/apps/admin/handlers/extended.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/extended.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/extended.php	2014-12-03 23:59:25.000000000 -0600
@@ -59,5 +59,3 @@
 }
 
 echo $tpl->render ('admin/extended', $data);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/forward.php elefant-elefant_1_3_10_beta/apps/admin/handlers/forward.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/forward.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/forward.php	2014-12-03 23:59:25.000000000 -0600
@@ -26,5 +26,3 @@
 	$this->permenent_redirect ($url);
 }
 $this->redirect ($url);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/head/links.php elefant-elefant_1_3_10_beta/apps/admin/handlers/head/links.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/head/links.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/head/links.php	2014-12-03 23:59:25.000000000 -0600
@@ -6,121 +6,29 @@
  * exposes them.
  */
 
-function admin_head_links_sort ($a, $b) {
-	if ($a['name'] == $b['name']) {
-		return 0;
-	}
-	return ($a['name'] < $b['name']) ? -1 : 1;
-}
-
-function admin_is_compatible ($appconf) {
-        if (isset ($appconf['Admin']['platforms'])) {
-                $device_list = explode (',', $appconf['Admin']['platforms']);
-                foreach ($device_list as $device) {
-                        if (detect (trim ($device))) {
-                                return true;
-                        }
-                }
-        } else {
-                // No Admin/platforms conf entry so assume app is compatible
-                return true;
-        }
-        return false;
-}
-
 $page->layout = false;
+header ('Content-Type: application/json');
 
 if (! User::require_admin ()) {
 	return;
 }
 
-$tools = array ('admin/pages' => array ('handler' => 'admin/pages', 'name' => __ ('All Pages'), 'class' => false));
-
-$ver = $this->installed ('elefant', ELEFANT_VERSION);
-if ($ver === true) {
-	$tools = array (
-		'admin/pages' => array (
-			'handler' => 'admin/pages',
-			'name' => __ ('All Pages'),
-			'class' => false
-		)
-	);
+$custom_tools = admin\Toolbar::custom_tools ($this);
+if ($custom_tools === false) {
+	$tools = admin\Toolbar::parse_apps ($this);
 } else {
-	$tools = array (
-		'admin/upgrade' => array (
-			'handler' => 'admin/upgrade',
-			'name' => __ (' Click to upgrade'),
-			'class' => 'needs-upgrade'
-		),
-		'admin/pages' => array (
-			'handler' => 'admin/pages',
-			'name' => __ ('All Pages')
-		)
-	);
+	$tools = $custom_tools;
+	$custom_tools = true;
 }
 
-$res = glob ('apps/*/conf/config.php');
-$apps = DB::pairs ('select * from #prefix#apps');
-foreach ($res as $file) {
-	$app = preg_replace ('/^apps\/(.*)\/conf\/config\.php$/i', '\1', $file);
-
-	if (! User::require_acl ($app)) {
-		// Can't access this app
-		continue;
-	}
-
-	$appconf = parse_ini_file ($file, true);
-
-	if (! admin_is_compatible ($appconf)) {
-        // App not compatible with this platform
-        continue;
-    }
-
-	if (isset ($appconf['Admin']['handler'])) {
-		if (! preg_match ('/\/(admin|index)$/', $appconf['Admin']['handler']) && ! User::require_acl ($appconf['Admin']['handler'])) {
-			// A non /admin or /index handler should get an additional
-			// access check (e.g., admin/versions).
-			continue;
-		}
-
-		if (isset ($appconf['Admin']['install'])) {
-			$ver = $this->installed ($app, $appconf['Admin']['version']);
-
-			if ($ver === true) {
-				// installed
-				$tools[$appconf['Admin']['handler']] = $appconf['Admin'];
-				$tools[$appconf['Admin']['handler']]['class'] = false;
-			} elseif ($ver === false) {
-				// not installed
-				$appconf['Admin']['name'] .= ' (' . __ ('click to install') . ')';
-				$tools[$appconf['Admin']['install']] = $appconf['Admin'];
-				$tools[$appconf['Admin']['install']]['class'] = 'not-installed';
-			} else {
-				// needs upgrade
-				$appconf['Admin']['name'] .= ' (' . __ ('click to upgrade') . ')';
-				$tools[$appconf['Admin']['upgrade']] = $appconf['Admin'];
-				$tools[$appconf['Admin']['upgrade']]['class'] = 'needs-upgrade';
-			}
-		} else {
-			// no installer, as you were
-			$tools[$appconf['Admin']['handler']] = $appconf['Admin'];
-			$tools[$appconf['Admin']['handler']]['class'] = false;
-		}
-	}
-}
-uasort ($tools, 'admin_head_links_sort');
-
 $out = array (
 	'name' => Product::name (),
 	'logo' => Product::logo_toolbar (),
 	'links' => $tpl->render ('admin/head/links', array (
 		'user' => User::val ('name'),
-		'tools' => $tools
+		'tools' => $tools,
+		'custom' => $custom_tools
 	))
 );
 
-$page->layout = false;
-header ('Content-Type: application/json');
 echo json_encode ($out);
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/head.php elefant-elefant_1_3_10_beta/apps/admin/handlers/head.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/head.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/head.php	2014-12-03 23:59:25.000000000 -0600
@@ -21,6 +21,7 @@
 
 	$page->add_script ("<script>$(function(){\$.elefant_version='" . ELEFANT_VERSION . "';});</script>\n");
 	$page->add_script ("<script>$(function(){\$.elefant_updates=" . (int) conf ('General', 'check_for_updates') . ";});</script>\n");
+	$page->add_script ("<script>$(function(){\$.elefant_custom=" . (int) file_exists ('conf/tools.php') . ";});</script>\n");
 	$page->add_script ('/apps/admin/js/modal.js');
 	$page->add_script ('/apps/admin/js/jquery.jgrowl.min.js');
 	$page->add_script ('/apps/admin/js/jquery.triggers.js');
@@ -31,5 +32,3 @@
 		'Keyboard shortcuts'
 	));
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/html.php elefant-elefant_1_3_10_beta/apps/admin/handlers/html.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/html.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/html.php	2014-12-03 23:59:25.000000000 -0600
@@ -10,5 +10,3 @@
 require_once ('apps/admin/lib/Functions.php');
 
 echo admin_embed_lookup ($data['id']);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/index.php elefant-elefant_1_3_10_beta/apps/admin/handlers/index.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/index.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/index.php	2014-12-03 23:59:25.000000000 -0600
@@ -7,6 +7,7 @@
  * the admin toolbar and edit buttons.
  */
 
+$page->id = 'admin';
 $page->layout = 'admin';
 
 if (isset ($_GET['redirect'])) {
@@ -37,5 +38,3 @@
 }
 
 $this->redirect ($_POST['redirect']);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/page.php elefant-elefant_1_3_10_beta/apps/admin/handlers/page.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/page.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/page.php	2014-12-03 23:59:25.000000000 -0600
@@ -36,10 +36,10 @@
 	}
 
 	// show admin edit buttons
-	if (User::require_acl ('admin', 'admin/edit')) {
+	if (User::require_acl ('admin', 'admin/pages', 'admin/edit')) {
 		$lock = new Lock ('Webpage', $id);
 		$page->locked = $lock->exists ();
-		echo $tpl->render ('admin/editable', $page);
+		echo $this->run ('admin/editable', $page);
 	}
 
 	// output the page body
@@ -85,10 +85,10 @@
 $page->extra = (object) $wp->extra;
 
 // show admin edit buttons
-if (User::require_acl ('admin', 'admin/edit')) {
+if (User::require_acl ('admin', 'admin/pages', 'admin/edit')) {
 	$lock = new Lock ('Webpage', $id);
 	$page->locked = $lock->exists ();
-	echo $tpl->render ('admin/editable', $page);
+	echo $this->run ('admin/editable', $page);
 }
 
 // execute any embedded includes
@@ -102,5 +102,3 @@
 
 // output the page body
 echo $out;
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/pages.php elefant-elefant_1_3_10_beta/apps/admin/handlers/pages.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/pages.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/pages.php	2014-12-03 23:59:25.000000000 -0600
@@ -4,21 +4,31 @@
  * Show a list of all pages for admins.
  */
 
-$this->require_admin ();
+$this->require_acl ('admin', 'admin/pages');
 
 $page->layout = 'admin';
-$page->title = __ ('All Pages');
+$page->title = __ ('Web Pages');
 
 $limit = 20;
 $num = isset ($_GET['offset']) ? $_GET['offset'] : 1;
 $offset = ($num - 1) * $limit;
+$q = isset ($_GET['q']) ? $_GET['q'] : ''; // search query
+$q_fields = array ('id', 'title', 'menu_title', 'window_title', 'access', 'keywords', 'description', 'body');
+$q_exact = array ('id', 'title', 'access');
+$url = ! empty ($q)
+	? '/admin/pages?q=' . urlencode ($q) . '&offset=%d'
+	: '/admin/pages?offset=%d';
 
 $lock = new Lock ();
 
 $pages = Webpage::query ('id, title, access')
+	->where_search ($q, $q_fields, $q_exact)
 	->order ('title asc')
 	->fetch_orig ($limit, $offset);
-$count = Webpage::query ()->count ();
+
+$count = Webpage::query ()
+	->where_search ($q, $q_fields, $q_exact)
+	->count ();
 
 foreach ($pages as $k => $p) {
 	$pages[$k]->locked = $lock->exists ('Webpage', $p->id);
@@ -29,7 +39,6 @@
 	'total' => $count,
 	'pages' => $pages,
 	'count' => count ($pages),
-	'url' => '/admin/pages?offset=%d'
+	'url' => $url,
+	'q' => $q
 ));
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/preview.php elefant-elefant_1_3_10_beta/apps/admin/handlers/preview.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/preview.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/preview.php	2014-12-03 23:59:25.000000000 -0600
@@ -19,5 +19,3 @@
 $page->head = '';
 
 echo $tpl->run_includes ($_POST['body']);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/restore.php elefant-elefant_1_3_10_beta/apps/admin/handlers/restore.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/restore.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/restore.php	2014-12-03 23:59:25.000000000 -0600
@@ -38,5 +38,3 @@
 	$this->redirect ('/' . $obj->id);
 }
 $this->redirect ('/');
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/upgrade.php elefant-elefant_1_3_10_beta/apps/admin/handlers/upgrade.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/upgrade.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/upgrade.php	2014-12-03 23:59:25.000000000 -0600
@@ -25,7 +25,22 @@
 	DB::commit ();
 }
 
-if (ELEFANT_VERSION === '1.3.6') { // Fix filemanager_prop primary key
+if (ELEFANT_VERSION === '1.3.10') { // Add extra user fields, social links, and notes
+	DB::beginTransaction ();
+	
+	$db = DB::get_connection (1);
+	$dbtype = $db->getAttribute (PDO::ATTR_DRIVER_NAME);
+	$sqldata = sql_split (file_get_contents ('apps/admin/conf/update/1.3.10_users_' . $dbtype . '.sql'));
+	
+	foreach ($sqldata as $sql) {
+		if (! DB::execute ($sql)) {
+			DB::rollback ();
+			printf ('<p>Error: %s</p>', DB::error ());
+			return;
+		}
+	}
+	DB::commit ();
+} elseif (ELEFANT_VERSION === '1.3.6') { // Fix filemanager_prop primary key
 	DB::beginTransaction ();
 
 	$db = DB::get_connection (1);
@@ -112,5 +127,3 @@
 printf ('<p><a href="/">%s</a></p>', __ ('Done.'));
 
 $this->mark_installed ('elefant', ELEFANT_VERSION);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/util/codemirror.php elefant-elefant_1_3_10_beta/apps/admin/handlers/util/codemirror.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/util/codemirror.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/util/codemirror.php	2014-12-03 23:59:25.000000000 -0600
@@ -80,5 +80,3 @@
 if ($data['field_id']) {
 	$page->add_script ($tpl->render ('admin/util/codemirror', $data));
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/util/dates.php elefant-elefant_1_3_10_beta/apps/admin/handlers/util/dates.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/util/dates.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/util/dates.php	2014-12-03 23:59:25.000000000 -0600
@@ -25,6 +25,8 @@
  *     January 3, 2012
  *     5:30PM
  *     April 16, 2012 - 11:13AM
+ *
+ * See the I18n class for a list of available filter methods.
  */
 
 $abbr_months = explode (
@@ -37,20 +39,35 @@
 	__ ('January February March April May June July August September October November December')
 );
 
+$abbr_days = explode (
+	' ',
+	__ ('Sun Mon Tue Wed Thu Fri Sat')
+);
+
+$full_days = explode (
+	' ',
+	__ ('Sunday Monday Tuesday Wednesday Thursday Friday Saturday')
+);
+
 $page->add_script ('/js/jquery.localize.min.js');
 $page->add_script ('<script>
 $(function () {
 	$.localize_dates = function () {
 		$.localize.fullMonths = ' . json_encode ($full_months) . ';
 		$.localize.abbrMonths = ' . json_encode ($abbr_months) . ';
+		$.localize.abbrDays = ' . json_encode ($abbr_days) . ';
+		$.localize.fullDays = ' . json_encode ($full_days) . ';
 		$(\'time.datetime\').localize(\'' . $i18n->date_format . ' - ' . $i18n->time_format . '\');
 		$(\'time.shortdatetime\').localize(\'' . $i18n->short_format . ' - ' . $i18n->time_format . '\');
 		$(\'time.date\').localize(\'' . $i18n->date_format . '\');
 		$(\'time.shortdate\').localize(\'' . $i18n->short_format . '\');
+		$(\'time.shortdate\').localize(\'' . $i18n->short_format . ', ' . $i18n->year_format . '\');
 		$(\'time.time\').localize(\'' . $i18n->time_format . '\');
+		$(\'time.shortdaydate\').localize(\'' . $i18n->short_day_date_format . '\');
+		$(\'time.shortdaydatetime\').localize(\'' . $i18n->short_day_date_format . ' - ' . $i18n->time_format . '\');
+		$(\'time.daydate\').localize(\'' . $i18n->day_date_format . '\');
+		$(\'time.daydatetime\').localize(\'' . $i18n->day_date_format . ' - ' . $i18n->time_format . '\');
 	};
 	$.localize_dates ();
 });
 </script>');
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/util/datewidget.php elefant-elefant_1_3_10_beta/apps/admin/handlers/util/datewidget.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/util/datewidget.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/util/datewidget.php	2014-12-03 23:59:25.000000000 -0600
@@ -1,8 +1,8 @@
 <?php
 
 /**
- * Call this to turn text inputs with a class="date" or
- * class="datetime" into date and date/time selectors.
+ * Call this to turn text inputs with a class="datewidget-date" or
+ * class="datewidget-datetime" into date and date/time selectors.
  *
  * In PHP code, call it like this:
  *
@@ -13,8 +13,8 @@
  *     {! admin/util/datewidget !}
  */
 
+$page->add_style ('/js/jquery-ui/jquery-ui.css');
 $page->add_style ('/apps/admin/css/datewidget.css');
+$page->add_script ('/js/jquery-ui/jquery-ui.min.js');
 $page->add_script ('/apps/blog/js/jquery.timepicker.js');
 $page->add_script ('/apps/admin/js/datewidget.js');
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/util/dynamicobjects.php elefant-elefant_1_3_10_beta/apps/admin/handlers/util/dynamicobjects.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/util/dynamicobjects.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/util/dynamicobjects.php	2014-12-03 23:59:25.000000000 -0600
@@ -49,5 +49,3 @@
 		'Back'
 	)
 );
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/util/editable.php elefant-elefant_1_3_10_beta/apps/admin/handlers/util/editable.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/util/editable.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/util/editable.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,114 @@
+<?php
+
+/**
+ * Helper to make things inline editable.
+ *
+ * ## Usage:
+ *
+ * 1\. Load this handler either in your handler:
+ *
+ *     $this->run (
+ *         'admin/util/editable',
+ *         array (
+ *             'url' => '/myapp/editable'
+ *         )
+ *     );
+ *
+ * Or anywhere in your view:
+ *
+ *     {! admin/util/editable?url=/myapp/editable !}
+ *
+ * 2\. Mark your editable areas in your view template via:
+ *
+ *     <h2 class="editable-text" id="{{id}}">{{name}}</h2>
+ *
+ *     <p class="editable-textarea" id="{{id}}"
+ *         data-property="description">{{description}}</h2>
+ *
+ *     <!-- select with options, note the single-quotes -->
+ *     <p class="editable-select" id="{{id}}"
+ *         data-options='{{options|json_encode}}'>{{value}}</p>
+ *     
+ *     <!-- add a delete button -->
+ *     <h2 class="editable-text" id="2"
+ *         data-property="title"
+ *         data-url="/myapp/category/edit"
+ *         data-delete="/myapp/category/delete">Category Title</h2>
+ *
+ * Valid classes for editable elements currently include:
+ *
+ * - .editable-text
+ * - .editable-textarea
+ * - .editable-select
+ *
+ * The plugin reads the following properties of the HTML element as the edit options:
+ *
+ * - `id` - The ID of the object to be updated
+ * - `data-property` - The name of the property to be updated
+ * - `data-url` - Overrides the default URL to POST updates to for this element
+ * - `data-delete` - An alternate URL to POST deletes to (and includes a 'Delete' button)
+ * - `data-options` - A JSON-encoded object containing the available select options
+ *
+ * `id` is the only required property. `data-options` is required for select options.
+ *
+ * ## Server-side handling
+ *
+ * The URL that handles saving the value will receive the following
+ * parameters:
+ *
+ * - `id` - The ID of the object to be updated
+ * - `property` - The name of the property to be updated (if set via `data-property`)
+ * - `value` - The new property value
+ * - `type` - The type of input (text, textarea, select)
+ * - `label` - For select inputs, this is the label of the selected value
+ *
+ * The handler should respond with the escaped `value` parameter, except for
+ * select inputs which should return the escaped `label` parameter. For example:
+ *
+ *     <?php
+ *     
+ *     $page->layout = false;
+ *     
+ *     $obj = myapp\MyModel ($_POST['id']);
+ *     $obj->{$_POST['name']} = $_POST['value'];
+ *     $obj->put ();
+ *     
+ *     if ($_POST['type'] === 'select') {
+ *         echo Template::sanitize ($_POST['label']);
+ *         return;
+ *     }
+ *     echo Template::sanitize ($_POST['value']);
+ *     
+ *     ?>
+ *
+ * To send an error message, use the following code:
+ *
+ *     $this->add_notification (__ ('Unable to save changes.'));
+ *     echo $this->error (500, 'Error message');
+ *     return;
+ *
+ * To add a notification upon successful requests, you can also use the
+ * Controller's `add_notification()` method:
+ *
+ *     $this->add_notification (__ ('Changes saved.'));
+ *     echo Template::sanitize ($_POST['value']);
+ */
+
+$page->add_style ('/apps/admin/css/editable.css');
+$page->add_script ('/apps/admin/js/jquery.autogrow.min.js');
+$page->add_script ('/apps/admin/js/jquery.jeditable.min.js');
+$page->add_script ('/apps/admin/js/jquery.jeditable.autogrow.js');
+$page->add_script ('/apps/admin/js/editable.js');
+$page->add_script ('/apps/admin/js/jquery.jeditable.deletable.js');
+if (isset ($data['url'])) {
+	$page->add_script ('<script>var editable_default_url = \'' . $data['url'] . '\';</script>');
+}
+$page->add_script (I18n::export (
+	'Saving...',
+	'Cancel',
+	'Save',
+	'Delete',
+	'Click to edit',
+	'Unable to save changes.',
+	'Are you sure you want to delete this item?'
+));
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/util/extended.php elefant-elefant_1_3_10_beta/apps/admin/handlers/util/extended.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/util/extended.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/util/extended.php	2014-12-03 23:59:25.000000000 -0600
@@ -12,7 +12,7 @@
  *
  * For update forms, pass the extended field values as well:
  *
- *     {! admin/util/extended?extends=blog\Post&name=Blog+Posts&values=[extra|none] !}
+ *     {! admin/util/extended?extends=blog\Post&name=Blog+Posts&values=[extra|none]&id=[id] !}
  *
  * 2. For update forms, call this in the form handler function,
  * before calling `$post->put ()`:
@@ -43,6 +43,7 @@
 $data['fields'] = ExtendedFields::for_class ($class);
 $data['modal'] = (isset ($data['modal']) && $data['modal'] !== 'false') ? true : false;
 $data['open'] = false;
+$data['id'] = isset ($data['id']) ? $data['id'] : false;
 
 $load_assets = false;
 
@@ -63,7 +64,11 @@
 				$settings = $fields[$field->type];
 				if ($settings['type'] === 'select') {
 					$data['fields'][$k]->type = 'select';
-					$data['fields'][$k]->options = call_user_func ($settings['callback']);
+					$data['fields'][$k]->options = call_user_func (
+						$settings['callback'],
+						$class,
+						$data['id']
+					);
 				}
 			}
 		}
@@ -79,5 +84,3 @@
 
 	echo $tpl->render ('admin/util/extended', $data);
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/util/fontawesome.php elefant-elefant_1_3_10_beta/apps/admin/handlers/util/fontawesome.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/util/fontawesome.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/util/fontawesome.php	2014-12-03 23:59:25.000000000 -0600
@@ -18,5 +18,3 @@
  */
 
 $page->add_style ('/apps/admin/css/font-awesome/css/font-awesome.min.css');
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/util/minimal-grid.php elefant-elefant_1_3_10_beta/apps/admin/handlers/util/minimal-grid.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/util/minimal-grid.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/util/minimal-grid.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,20 @@
+<?php
+
+/**
+ * Includes a minimal responsive grid for layout out an app's
+ * output, e.g., cards or tiles, for consistent display across
+ * websites.
+ *
+ * In PHP code, call it like this:
+ *
+ *     $this->run ('admin/util/minimal-grid');
+ *
+ * In a view template, call it like this:
+ *
+ *     {! admin/util/minimal-grid !}
+ *
+ * See the file apps/admin/css/minimal-grid.html for usage
+ * examples.
+ */
+
+$page->add_script ('/apps/admin/css/minimal-grid.css');
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/util/modal.php elefant-elefant_1_3_10_beta/apps/admin/handlers/util/modal.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/util/modal.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/util/modal.php	2014-12-03 23:59:25.000000000 -0600
@@ -32,5 +32,3 @@
 
 $page->add_script ('/apps/admin/js/modal.js');
 $page->add_style ('/apps/admin/css/modal.css');
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/util/notifier.php elefant-elefant_1_3_10_beta/apps/admin/handlers/util/notifier.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/util/notifier.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/util/notifier.php	2014-12-03 23:59:25.000000000 -0600
@@ -23,5 +23,3 @@
 $page->add_script ('/js/jquery.cookie.js');
 $page->add_script ('/apps/admin/js/jquery.jgrowl.min.js');
 $page->add_script ('/apps/admin/js/jquery.notifier.js');
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/util/redactor.php elefant-elefant_1_3_10_beta/apps/admin/handlers/util/redactor.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/util/redactor.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/util/redactor.php	2014-12-03 23:59:25.000000000 -0600
@@ -24,5 +24,3 @@
 $page->add_style ('/apps/admin/js/redactor/custom.css');
 
 $page->add_script ('/apps/admin/js/redactor/redactor.min.js');
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/util/search.php elefant-elefant_1_3_10_beta/apps/admin/handlers/util/search.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/util/search.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/util/search.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,39 @@
+<?php
+
+/**
+ * For use in conjunction with `Model::where_search()` and
+ * adding terms and exact matches to a search box on an
+ * admin screen.
+ *
+ * Usage:
+ *
+ *     {! admin/util/search !}
+ *
+ *     <script>
+ *     $(function () {
+ *         $.search_init ({
+ *             form: '#search-form',     // form selector
+ *             query: '#search-query',   // query field selector
+ *             links: '.search-for',     // selector to modify search via links
+ *             options: '.search-option' // selector to modify search via select boxes
+ *         });
+ *     });
+ *     </script>
+ *
+ *     <form method="get" id="search-form">
+ *         <input type="text" name="q" id="search-query" />
+ *         <button>{"Search"}</button>
+ *     </form>
+ *
+ *     <a href="#" class="search-for" data-search="Foo">Foo</a>
+ *
+ *     <a href="#"
+ *        class="search-for"
+ *        data-search="company:&quot;Example Inc.&quot;">Example Inc.</a>
+ *
+ *     <select class="search-option" data-prefix="field">
+ *         ...options for field:"value" searches...
+ *     </select>
+ */
+
+$page->add_script ('/apps/admin/js/jquery.search.js');
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/util/wysiwyg.php elefant-elefant_1_3_10_beta/apps/admin/handlers/util/wysiwyg.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/util/wysiwyg.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/util/wysiwyg.php	2014-12-03 23:59:25.000000000 -0600
@@ -66,5 +66,3 @@
 	? (($data['field_id'] === '0' || empty ($data['field_id'])) ? false : $data['field_id'])
 	: 'webpage-body';
 $page->add_script ($tpl->render ('admin/util/wysiwyg', $data));
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/validator.php elefant-elefant_1_3_10_beta/apps/admin/handlers/validator.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/validator.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/validator.php	2014-12-03 23:59:25.000000000 -0600
@@ -32,5 +32,3 @@
 $page->layout = false;
 header ('Content-Type: application/json');
 echo json_encode ($rules);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/versions.php elefant-elefant_1_3_10_beta/apps/admin/handlers/versions.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/versions.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/versions.php	2014-12-03 23:59:25.000000000 -0600
@@ -60,5 +60,3 @@
 	'url' => sprintf ('/admin/versions?type=%s&id=%s&offset=%%d', $_GET['type'], $_GET['id']),
 	'deleted' => $deleted
 ));
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/handlers/wysiwyg/links.php elefant-elefant_1_3_10_beta/apps/admin/handlers/wysiwyg/links.php
--- elefant-elefant_1_3_9_beta/apps/admin/handlers/wysiwyg/links.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/handlers/wysiwyg/links.php	2014-12-03 23:59:25.000000000 -0600
@@ -27,5 +27,3 @@
 usort ($out, 'admin_links_sort');
 
 echo json_encode ($out);
-
-?>
\ No newline at end of file
Files elefant-elefant_1_3_9_beta/apps/admin/js/datewidget.js and elefant-elefant_1_3_10_beta/apps/admin/js/datewidget.js are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/js/editable.js elefant-elefant_1_3_10_beta/apps/admin/js/editable.js
--- elefant-elefant_1_3_9_beta/apps/admin/js/editable.js	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/js/editable.js	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,121 @@
+/**
+ * Makes elements with an .editable-* class name editable
+ * directly in the page (inline editing). Valid classes
+ * include:
+ *
+ * - .editable-text
+ * - .editable-textarea
+ * - .editable-select
+ *
+ * Usage:
+ *
+ *     <h2 class="editable-text" id="2"
+ *         data-property="title"
+ *         data-url="/myapp/save_editable">Edit This Header</h2>
+ *     
+ *     <p class="editable-textarea" id="{{id}}">{{description}}</h2>
+ *     
+ *     <p class="editable-select" id="{{id}}"
+ *         data-name="category"
+ *         data-options='{{categories|json_encode}}'
+ *         >{{categories[$data->category]}}</p>
+ *     
+ *     <!-- add a delete button -->
+ *     <h2 class="editable-text" id="2"
+ *         data-property="title"
+ *         data-url="/myapp/category/edit"
+ *         data-delete="/myapp/category/delete">Category Title</h2>
+ */
+$(function () {
+	var opts = {
+		indicator: $.i18n ('Saving...'),
+		tooltip: $.i18n ('Click to edit'),
+		cancel: $.i18n ('Cancel'),
+		submit: $.i18n ('Save'),
+		type: 'text',
+		style: 'inherit',
+		cssclass: 'editable',
+		submitdata: {},
+		onerror: function (settings, original, xhr) {
+			original.reset ();
+		}
+	};
+
+	var opts_by_type = {
+		text: {
+			type: 'text',
+			submitdata: {type: 'text'}
+		},
+		textarea: {
+			type: 'autogrow',
+			submitdata: {type: 'textarea'}
+		},
+		select: {
+			type: 'select',
+			submitdata: {type: 'select'}
+		}
+	};
+	
+	function parse_type_from_class (el) {
+		for (var i in opts_by_type) {
+			if (el.hasClass ('editable-' + i)) {
+				return i;
+			}
+		}
+		return 'text';
+	}
+
+	$('.editable-text,.editable-textarea,.editable-select').each (function () {
+		var $this = $(this),
+
+			type = parse_type_from_class ($this),
+
+			del = $this.data ('delete'),
+			
+			prop = $this.data ('property'),
+
+			url = $this.data ('url')
+				? $this.data ('url')
+				: editable_default_url,
+
+			id = $this.attr ('id'),
+
+			custom_opts = opts_by_type[type],
+			
+			final_opts = $.extend (true, {}, opts, custom_opts);
+
+		if (typeof del !== 'undefined') {
+			final_opts.del = $.i18n ('Delete');
+			final_opts._delete_url = del;
+		}
+
+		if (typeof prop !== 'undefined') {
+			final_opts.submitdata.property = prop;
+		} else {
+			delete final_opts.submitdata.property;
+		}
+
+		final_opts._url = url;
+		final_opts._id = id;
+		
+		if (type === 'select') {
+			final_opts.data = $this.data ('options');
+			final_opts.submitdata = function (value, settings) {
+				var sel = $this.find ('select');
+
+				var submitdata = {
+					type: 'select',
+					label: sel[0].options[sel[0].selectedIndex].text
+				};
+				
+				if (typeof prop !== 'undefined') {
+					submitdata.property = prop;
+				}
+				
+				return submitdata;
+			};
+		}
+		
+		$this.editable (url, final_opts);
+	});
+});
Files elefant-elefant_1_3_9_beta/apps/admin/js/extended.js and elefant-elefant_1_3_10_beta/apps/admin/js/extended.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/handlebars-1.0.rc.1.js and elefant-elefant_1_3_10_beta/apps/admin/js/handlebars-1.0.rc.1.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/jquery-ui.min.js and elefant-elefant_1_3_10_beta/apps/admin/js/jquery-ui.min.js are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/js/jquery.autogrow.min.js elefant-elefant_1_3_10_beta/apps/admin/js/jquery.autogrow.min.js
--- elefant-elefant_1_3_9_beta/apps/admin/js/jquery.autogrow.min.js	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/js/jquery.autogrow.min.js	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,18 @@
+/*
+autogrow.js - Copyright (C) 2014, Jason Edelman <edelman.jason@gmail.com>
+
+Permission is hereby granted, free of charge, to any person obtaining a copy of this software and 
+associated documentation files (the "Software"), to deal in the Software without restriction, including 
+without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
+sell copies of the Software, and to permit persons to whom the Software is furnished to 
+do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT
+LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL 
+THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF 
+CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER 
+DEALINGS IN THE SOFTWARE.
+*/
+;(function(e){e.fn.autogrow=function(t){function s(n){var r=e(this),i=r.innerHeight(),s=this.scrollHeight,o=r.data("autogrow-start-height")||0,u;if(i<s){this.scrollTop=0;t.animate?r.stop().animate({height:s},t.speed):r.innerHeight(s)}else if(!n||n.which==8||n.which==46||n.ctrlKey&&n.which==88){if(i>o){u=r.clone().addClass(t.cloneClass).css({position:"absolute",zIndex:-10,height:""}).val(r.val());r.after(u);do{s=u[0].scrollHeight-1;u.innerHeight(s)}while(s===u[0].scrollHeight);s++;u.remove();r.focus();s<o&&(s=o);i>s&&t.animate?r.stop().animate({height:s},t.speed):r.innerHeight(s)}else{r.innerHeight(o)}}}var n=e(this).css({overflow:"hidden",resize:"none"}),r=n.selector,i={context:e(document),animate:true,speed:200,fixMinHeight:true,cloneClass:"autogrowclone",onInitialize:false};t=e.isPlainObject(t)?t:{context:t?t:e(document)};t=e.extend({},i,t);n.each(function(n,r){var i,o;r=e(r);if(r.is(":visible")||parseInt(r.css("height"),10)>0){i=parseInt(r.css("height"),10)||r.innerHeight()}else{o=r.clone().addClass(t.cloneClass).val(r.val()).css({position:"absolute",visibility:"hidden",display:"block"});e("body").append(o);i=o.innerHeight();o.remove()}if(t.fixMinHeight){r.data("autogrow-start-height",i)}r.css("height",i);if(t.onInitialize&&r.length){s.call(r[0])}});t.context.on("keyup paste",r,s);return n}})(jQuery);
\ No newline at end of file
Files elefant-elefant_1_3_9_beta/apps/admin/js/jquery.crud_api.js and elefant-elefant_1_3_10_beta/apps/admin/js/jquery.crud_api.js are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/js/jquery.dynamicobjects.js elefant-elefant_1_3_10_beta/apps/admin/js/jquery.dynamicobjects.js
--- elefant-elefant_1_3_9_beta/apps/admin/js/jquery.dynamicobjects.js	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/js/jquery.dynamicobjects.js	2014-12-03 23:59:25.000000000 -0600
@@ -199,6 +199,8 @@
 						} else {
 							html += '</p>';
 						}
+					} else if (obj.fields[i].type == 'hidden') {
+						html += '<input type="hidden" name="' + obj.fields[i].name + '" value="' + obj.fields[i].initial + '" />';
 					} else if (obj.fields[i].type == 'file') {
 						html += '<p><label for="' + obj.fields[i].name + '" >' + obj.fields[i].label + '</label>';
 						html += '<input type="text" class="wysiwyg-file-input" name="' + obj.fields[i].name + '" id="' + obj.fields[i].name + '" value="' + obj.fields[i].initial + '" />';
@@ -348,7 +350,9 @@
 										var data = {};
 										data[k] = current.data[k];
 										$.post ('/admin/embed/filters', {handler: current.handler, data: data, reverse: 'yes'}, function (res) {
-											$(f.elements[k]).val (res.data[k]);
+											for (var _k in res.data) {
+												$(f.elements[_k]).val (res.data[_k]);
+											}
 										});
 									} else {
 										$(f.elements[k]).val (current.data[k]);
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/js/jquery.jeditable.autogrow.js elefant-elefant_1_3_10_beta/apps/admin/js/jquery.jeditable.autogrow.js
--- elefant-elefant_1_3_9_beta/apps/admin/js/jquery.jeditable.autogrow.js	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/js/jquery.jeditable.autogrow.js	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,38 @@
+/*
+ * Autogrow textarea for Jeditable
+ *
+ * Copyright (c) 2008 Mika Tuupola
+ *
+ * Licensed under the MIT license:
+ *   http://www.opensource.org/licenses/mit-license.php
+ * 
+ * Depends on Autogrow jQuery plugin by Chrys Bader:
+ *   http://www.aclevercookie.com/facebook-like-auto-growing-textarea/
+ *
+ * Project home:
+ *   http://www.appelsiini.net/projects/jeditable
+ *
+ * Revision: $Id$
+ *
+ */
+ 
+$.editable.addInputType('autogrow', {
+    element : function(settings, original) {
+        var textarea = $('<textarea />');
+        if (settings.rows) {
+            textarea.attr('rows', settings.rows);
+        } else {
+            textarea.height(settings.height);
+        }
+        if (settings.cols) {
+            textarea.attr('cols', settings.cols);
+        } else {
+            textarea.width(settings.width);
+        }
+        $(this).append(textarea);
+        return(textarea);
+    },
+    plugin : function(settings, original) {
+        $('textarea', this).autogrow(settings.autogrow);
+    }
+});
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/js/jquery.jeditable.deletable.js elefant-elefant_1_3_10_beta/apps/admin/js/jquery.jeditable.deletable.js
--- elefant-elefant_1_3_9_beta/apps/admin/js/jquery.jeditable.deletable.js	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/js/jquery.jeditable.deletable.js	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,36 @@
+$.editable.types.defaults.buttons = function (settings, original) {
+	var $this = $(this);
+
+	if (settings.submit) {
+		var submit = jQuery('<button type="submit">');
+		submit.addClass('editable-btn-save');
+		submit.text(settings.submit);
+		$this.append(submit);
+	}
+
+	if (settings.del) {
+		var del = jQuery('<button>');
+		del.addClass('editable-btn-delete');
+		del.text(settings.del);
+		del.data ('id', settings._id);
+		del.attr ('href', settings._delete_url);
+		$(this).append(del);
+
+		$(del).click(function(e) {
+			e.preventDefault ();
+			$.confirm_and_post (this, $.i18n ('Are you sure you want to delete this item?'));
+		});
+	}
+
+	if (settings.cancel) {
+		var cancel = jQuery('<button type="button">');
+		cancel.addClass('editable-btn-cancel');
+		cancel.text(settings.cancel);
+		$(this).append(cancel);
+
+		$(cancel).click(function() {
+			$(original).html(original.revert);
+			original.editing = false;
+		});
+	}
+};
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/js/jquery.jeditable.min.js elefant-elefant_1_3_10_beta/apps/admin/js/jquery.jeditable.min.js
--- elefant-elefant_1_3_9_beta/apps/admin/js/jquery.jeditable.min.js	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/js/jquery.jeditable.min.js	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,38 @@
+
+(function($){$.fn.editable=function(target,options){if('disable'==target){$(this).data('disabled.editable',true);return;}
+if('enable'==target){$(this).data('disabled.editable',false);return;}
+if('destroy'==target){$(this).unbind($(this).data('event.editable')).removeData('disabled.editable').removeData('event.editable');return;}
+var settings=$.extend({},$.fn.editable.defaults,{target:target},options);var plugin=$.editable.types[settings.type].plugin||function(){};var submit=$.editable.types[settings.type].submit||function(){};var buttons=$.editable.types[settings.type].buttons||$.editable.types['defaults'].buttons;var content=$.editable.types[settings.type].content||$.editable.types['defaults'].content;var element=$.editable.types[settings.type].element||$.editable.types['defaults'].element;var reset=$.editable.types[settings.type].reset||$.editable.types['defaults'].reset;var callback=settings.callback||function(){};var onedit=settings.onedit||function(){};var onsubmit=settings.onsubmit||function(){};var onreset=settings.onreset||function(){};var onerror=settings.onerror||reset;if(settings.tooltip){$(this).attr('title',settings.tooltip);}
+settings.autowidth='auto'==settings.width;settings.autoheight='auto'==settings.height;return this.each(function(){var self=this;var savedwidth=$(self).width();var savedheight=$(self).height();$(this).data('event.editable',settings.event);if(!$.trim($(this).html())){$(this).html(settings.placeholder);}
+$(this).bind(settings.event,function(e){if(true===$(this).data('disabled.editable')){return;}
+if(self.editing){return;}
+if(false===onedit.apply(this,[settings,self])){return;}
+e.preventDefault();e.stopPropagation();if(settings.tooltip){$(self).removeAttr('title');}
+if(0==$(self).width()){settings.width=savedwidth;settings.height=savedheight;}else{if(settings.width!='none'){settings.width=settings.autowidth?$(self).width():settings.width;}
+if(settings.height!='none'){settings.height=settings.autoheight?$(self).height():settings.height;}}
+if($(this).html().toLowerCase().replace(/(;|")/g,'')==settings.placeholder.toLowerCase().replace(/(;|")/g,'')){$(this).html('');}
+self.editing=true;self.revert=$(self).html();$(self).html('');var form=$('<form />');if(settings.cssclass){if('inherit'==settings.cssclass){form.attr('class',$(self).attr('class'));}else{form.attr('class',settings.cssclass);}}
+if(settings.style){if('inherit'==settings.style){form.attr('style',$(self).attr('style'));form.css('display',$(self).css('display'));}else{form.attr('style',settings.style);}}
+var input=element.apply(form,[settings,self]);var input_content;if(settings.loadurl){var t=setTimeout(function(){input.disabled=true;content.apply(form,[settings.loadtext,settings,self]);},100);var loaddata={};loaddata[settings.id]=self.id;if($.isFunction(settings.loaddata)){$.extend(loaddata,settings.loaddata.apply(self,[self.revert,settings]));}else{$.extend(loaddata,settings.loaddata);}
+$.ajax({type:settings.loadtype,url:settings.loadurl,data:loaddata,async:false,success:function(result){window.clearTimeout(t);input_content=result;input.disabled=false;}});}else if(settings.data){input_content=settings.data;if($.isFunction(settings.data)){input_content=settings.data.apply(self,[self.revert,settings]);}}else{input_content=self.revert;}
+content.apply(form,[input_content,settings,self]);input.attr('name',settings.name);buttons.apply(form,[settings,self]);$(self).append(form);plugin.apply(form,[settings,self]);$(':input:visible:enabled:first',form).focus();if(settings.select){input.select();}
+input.keydown(function(e){if(e.keyCode==27){e.preventDefault();reset.apply(form,[settings,self]);}});var t;if('cancel'==settings.onblur){input.blur(function(e){t=setTimeout(function(){reset.apply(form,[settings,self]);},500);});}else if('submit'==settings.onblur){input.blur(function(e){t=setTimeout(function(){form.submit();},200);});}else if($.isFunction(settings.onblur)){input.blur(function(e){settings.onblur.apply(self,[input.val(),settings]);});}else{input.blur(function(e){});}
+form.submit(function(e){if(t){clearTimeout(t);}
+e.preventDefault();if(false!==onsubmit.apply(form,[settings,self])){if(false!==submit.apply(form,[settings,self])){if($.isFunction(settings.target)){var str=settings.target.apply(self,[input.val(),settings]);$(self).html(str);self.editing=false;callback.apply(self,[self.innerHTML,settings]);if(!$.trim($(self).html())){$(self).html(settings.placeholder);}}else{var submitdata={};submitdata[settings.name]=input.val();submitdata[settings.id]=self.id;if($.isFunction(settings.submitdata)){$.extend(submitdata,settings.submitdata.apply(self,[self.revert,settings]));}else{$.extend(submitdata,settings.submitdata);}
+if('PUT'==settings.method){submitdata['_method']='put';}
+$(self).html(settings.indicator);var ajaxoptions={type:'POST',data:submitdata,dataType:'html',url:settings.target,success:function(result,status){if(ajaxoptions.dataType=='html'){$(self).html(result);}
+self.editing=false;callback.apply(self,[result,settings]);if(!$.trim($(self).html())){$(self).html(settings.placeholder);}},error:function(xhr,status,error){onerror.apply(form,[settings,self,xhr]);}};$.extend(ajaxoptions,settings.ajaxoptions);$.ajax(ajaxoptions);}}}
+$(self).attr('title',settings.tooltip);return false;});});this.reset=function(form){if(this.editing){if(false!==onreset.apply(form,[settings,self])){$(self).html(self.revert);self.editing=false;if(!$.trim($(self).html())){$(self).html(settings.placeholder);}
+if(settings.tooltip){$(self).attr('title',settings.tooltip);}}}};});};$.editable={types:{defaults:{element:function(settings,original){var input=$('<input type="hidden"></input>');$(this).append(input);return(input);},content:function(string,settings,original){$(':input:first',this).val(string);},reset:function(settings,original){original.reset(this);},buttons:function(settings,original){var form=this;if(settings.submit){if(settings.submit.match(/>$/)){var submit=$(settings.submit).click(function(){if(submit.attr("type")!="submit"){form.submit();}});}else{var submit=$('<button type="submit" />');submit.html(settings.submit);}
+$(this).append(submit);}
+if(settings.cancel){if(settings.cancel.match(/>$/)){var cancel=$(settings.cancel);}else{var cancel=$('<button type="cancel" />');cancel.html(settings.cancel);}
+$(this).append(cancel);$(cancel).click(function(event){if($.isFunction($.editable.types[settings.type].reset)){var reset=$.editable.types[settings.type].reset;}else{var reset=$.editable.types['defaults'].reset;}
+reset.apply(form,[settings,original]);return false;});}}},text:{element:function(settings,original){var input=$('<input />');if(settings.width!='none'){input.width(settings.width);}
+if(settings.height!='none'){input.height(settings.height);}
+input.attr('autocomplete','off');$(this).append(input);return(input);}},textarea:{element:function(settings,original){var textarea=$('<textarea />');if(settings.rows){textarea.attr('rows',settings.rows);}else if(settings.height!="none"){textarea.height(settings.height);}
+if(settings.cols){textarea.attr('cols',settings.cols);}else if(settings.width!="none"){textarea.width(settings.width);}
+$(this).append(textarea);return(textarea);}},select:{element:function(settings,original){var select=$('<select />');$(this).append(select);return(select);},content:function(data,settings,original){if(String==data.constructor){eval('var json = '+data);}else{var json=data;}
+for(var key in json){if(!json.hasOwnProperty(key)){continue;}
+if('selected'==key){continue;}
+var option=$('<option />').val(key).append(json[key]);$('select',this).append(option);}
+$('select',this).children().each(function(){if($(this).val()==json['selected']||$(this).text()==$.trim(original.revert)){$(this).attr('selected','selected');}});}}},addInputType:function(name,input){$.editable.types[name]=input;}};$.fn.editable.defaults={name:'value',id:'id',type:'text',width:'auto',height:'auto',event:'click.editable',onblur:'cancel',loadtype:'GET',loadtext:'Loading...',placeholder:'Click to edit',loaddata:{},submitdata:{},ajaxoptions:{}};})(jQuery);
\ No newline at end of file
Files elefant-elefant_1_3_9_beta/apps/admin/js/jquery.jgrowl.min.js and elefant-elefant_1_3_10_beta/apps/admin/js/jquery.jgrowl.min.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/jquery.notifier.js and elefant-elefant_1_3_10_beta/apps/admin/js/jquery.notifier.js are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/js/jquery.search.js elefant-elefant_1_3_10_beta/apps/admin/js/jquery.search.js
--- elefant-elefant_1_3_9_beta/apps/admin/js/jquery.search.js	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/js/jquery.search.js	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,98 @@
+/**
+ * See `admin/util/search` helper.
+ *
+ * Usage:
+ *
+ *     $.search_init ({
+ *         form: '#search-form',     // form selector
+ *         query: '#search-query',   // query field selector
+ *         links: '.search-for',     // selector to modify search via links
+ *         options: '.search-option' // selector to modify search via select boxes
+ *     });
+ *
+ *     // add to query and submit
+ *     $.search_for ('some value');
+ */
+(function ($) {
+	var opts = {
+			form: '#search-form',
+			query: '#search-query',
+			links: '.search-for',
+			options: '.search-option'
+		},
+		$form = null,
+		$query = null;
+
+	if (!String.prototype.trim) {
+		String.prototype.trim = function () {
+			return this.replace (/^\s+|\s+$/g, '');
+		};
+	}
+	
+	$.search_init = function (settings) {
+		opts = $.extend (opts, settings);
+
+		$form = $(opts.form);
+		$query = $(opts.query);
+
+		$(opts.links).click (function (e) {
+			e.preventDefault ();
+			
+			var search = $(this).data ('search');
+			
+			$.search_for (search);
+		});
+		
+		$(opts.options).each (function () {
+			var $this = $(this),
+				prefix = $this.data ('prefix'),
+				regex = new RegExp (prefix + ':("[a-z0-9\'\. _-]+"|[a-z0-9\'\._-]+)', 'i'),
+				q = $query.val (),
+				match = regex.exec (q);
+
+			if (match != null) {
+				$this.val (match[1].replace (/(^")|("$)/g, ''));
+			}
+		});
+		
+		$(opts.options).change (function (e) {
+			e.preventDefault ();
+			
+			var $this = $(this),
+				prefix = $this.data ('prefix'),
+				val = $this.find (':selected').val ();
+
+			if (val === '' || val.match (/^[a-z0-9\'\._-]+$/i)) {
+				$.search_for (prefix + ':' + val);
+			} else {
+				$.search_for (prefix + ':"' + val + '"');
+			}
+		});
+	};
+	
+	$.search_for = function (search) {
+		var prefix = search.match (':') ? search.split (':')[0] : false,
+			remove_prefix = (search === prefix + ':') ? true : false,
+			regex = new RegExp (prefix + ':("[a-z0-9\'\. _-]+"|[a-z0-9\'\._-]+)', 'i'),
+			q = $query.val ();
+
+		if (q.length === 0) {
+			$query.val (search.trim ()); // first term added
+		} else if (! remove_prefix && q.match (search)) {
+			return; // already matches
+		} else if (prefix) { // searching for exact match
+			if (q.match (prefix + ':')) {
+				// remove 'prefix:' searches from the query
+				search = (remove_prefix) ? '' : search;
+
+				$query.val (q.replace (regex, search).trim ());
+			} else {
+				$query.val ((q + ' ' + search).trim ());
+			}
+		} else {
+			$query.val ((q + ' ' + search).trim ());
+		}
+		
+		$form.submit ();
+	};
+})(jQuery);
Files elefant-elefant_1_3_9_beta/apps/admin/js/jquery.simplemodal.1.4.2.min.js and elefant-elefant_1_3_10_beta/apps/admin/js/jquery.simplemodal.1.4.2.min.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/jquery.triggers.js and elefant-elefant_1_3_10_beta/apps/admin/js/jquery.triggers.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/modal.js and elefant-elefant_1_3_10_beta/apps/admin/js/modal.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/custom.css and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/custom.css are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/ar.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/ar.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/az.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/az.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/ba.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/ba.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/bg.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/bg.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/by.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/by.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/ca.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/ca.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/cs.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/cs.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/da.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/da.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/de.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/de.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/el.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/el.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/eo.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/eo.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/es.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/es.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/es_ar.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/es_ar.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/fa.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/fa.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/fi.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/fi.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/fr.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/fr.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/he.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/he.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/hr.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/hr.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/hu.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/hu.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/id.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/id.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/it.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/it.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/ja.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/ja.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/ko.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/ko.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/lt.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/lt.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/lv.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/lv.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/mk.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/mk.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/nl.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/nl.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/no_nb.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/no_nb.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/pl.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/pl.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/pt_br.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/pt_br.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/pt_pt.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/pt_pt.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/ro.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/ro.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/ru.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/ru.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/sk.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/sk.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/sl.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/sl.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/sq.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/sq.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/sr_cir.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/sr_cir.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/sr_lat.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/sr_lat.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/sv.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/sv.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/th.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/th.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/tr.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/tr.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/ua.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/ua.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/vi.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/vi.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/zh_cn.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/zh_cn.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/lang/zh_tw.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/lang/zh_tw.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/plugins/dynamic.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/plugins/dynamic.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/plugins/filebrowser.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/plugins/filebrowser.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/plugins/fontfamily.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/plugins/fontfamily.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/plugins/fontsize.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/plugins/fontsize.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/plugins/fullscreen.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/plugins/fullscreen.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/plugins/imagebrowser.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/plugins/imagebrowser.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/plugins/links.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/plugins/links.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/plugins/textdirection.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/plugins/textdirection.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/redactor-iframe.css and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/redactor-iframe.css are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/redactor.css and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/redactor.css are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/redactor.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/redactor.js are identical
Files elefant-elefant_1_3_9_beta/apps/admin/js/redactor/redactor.min.js and elefant-elefant_1_3_10_beta/apps/admin/js/redactor/redactor.min.js are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/js/top-bar.js elefant-elefant_1_3_10_beta/apps/admin/js/top-bar.js
--- elefant-elefant_1_3_9_beta/apps/admin/js/top-bar.js	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/js/top-bar.js	2014-12-03 23:59:25.000000000 -0600
@@ -155,7 +155,24 @@
  * response handler.
  */
 function elefant_update_response (res) {
-	if (res.latest > $.elefant_version) {
+	var _old = $.elefant_version.split ('.'),
+		_new = res.latest.split ('.'),
+		is_new = false;
+
+	for (var i = 0; i < _old.length; i++) {
+		var _o = parseInt (_old[i]),
+			_n = parseInt (_new[i]);
+
+		if (_o === _n) {
+			continue;
+		} else if (_o < _n) {
+			is_new = true;
+			break;
+		}
+		break;
+	}
+
+	if (is_new) {
 		$('#admin-bar>a').append ('<a href="http://www.elefantcms.com/download" target="_blank" id="admin-update-available">Update Available: ' + res.latest + '</a>');
 	}
 }
@@ -171,49 +188,104 @@
 		$('#admin-links').append (res.links);
 	
 		// show/hide tools menu
-		var admin_tools = $('#admin-tools'),
-			admin_tools_list = $('#admin-tools-list');
+		if ($.elefant_custom) {
+			// custom tools menu
+			var admin_tools = $('#admin-bar'),
+				admin_tools_list = $('#admin-tools-list');
 
-		function toggle_tools_open () {
-			admin_tools_list.stop ().css ('height', 'auto').slideDown ('fast');
-		}
+			$('#admin-bar>a').after ('<span id="admin-tools-arrow"></span>');
 
-		function toggle_tools_close () {
-			admin_tools_list.stop ().slideUp ('slow');
-		}
+			function toggle_custom_tools_open () {
+				admin_tools_list.stop ().css ('height', 'auto').slideDown ('fast');
+			}
+
+			function toggle_custom_tools_close () {
+				admin_tools_list.stop ().slideUp ('slow');
+			}
 
-		function toggle_tools (e) {
-			e.preventDefault ();
+			function toggle_custom_tools (e) {
+				e.preventDefault ();
 
-			// fix for clicks on tools menu links
-			if ($(e.target).attr ('id') !== 'admin-tools') {
-				window.location.href = $(e.target).attr ('href');
+				// fix for clicks on tools menu links
+				if ($(e.target).attr ('id') !== 'admin-bar' && $(e.target).attr ('id') !== 'admin-tools-arrow') {
+					window.location.href = $(e.target).attr ('href');
+					return false;
+				}
+
+				if (admin_tools_list.is (':visible')) {
+					admin_tools_list.stop ().slideUp ('fast');
+				} else {
+					admin_tools_list.stop ().css ('height', 'auto').slideDown ('fast');
+					$('#admin-tools-list a')[0].focus ();
+				}
+			
 				return false;
 			}
 
-			if (admin_tools_list.is (':visible')) {
-				admin_tools_list.stop ().slideUp ('fast');
+			if (navigator.pointerEnabled) {
+				$('#admin-tools-arrow').on ('pointerdown', toggle_custom_tools);
+			} else if (navigator.msPointerEnabled) {
+				$('#admin-tools-arrow').on ('MSPointerDown', toggle_custom_tools);
 			} else {
-				admin_tools_list.stop ().css ('height', 'auto').slideDown ('fast');
-				$('#admin-tools-list a')[0].focus ();
+				admin_tools.hover (
+					function () {},
+					toggle_custom_tools_close
+				);
+
+				$('#admin-tools-arrow').hover (
+					toggle_custom_tools_open,
+					function () {}
+				).on ('touchdown click', toggle_custom_tools);
 			}
-		}
 
-		if (navigator.pointerEnabled) {
-			admin_tools.on ('pointerdown', toggle_tools);
-		} else if (navigator.msPointerEnabled) {
-			admin_tools.on ('MSPointerDown', toggle_tools);
 		} else {
-			admin_tools.hover (
-				toggle_tools_open,
-				toggle_tools_close
-			);
+			// default tools menu
+			var admin_tools = $('#admin-tools'),
+				admin_tools_list = $('#admin-tools-list');
 
-			admin_tools.on ('touchdown click', toggle_tools);
-		}
+			function toggle_tools_open () {
+				admin_tools_list.stop ().css ('height', 'auto').slideDown ('fast');
+			}
+
+			function toggle_tools_close () {
+				admin_tools_list.stop ().slideUp ('slow');
+			}
+
+			function toggle_tools (e) {
+				e.preventDefault ();
+
+				// fix for clicks on tools menu links
+				if ($(e.target).attr ('id') !== 'admin-tools') {
+					window.location.href = $(e.target).attr ('href');
+					return false;
+				}
+
+				if (admin_tools_list.is (':visible')) {
+					admin_tools_list.stop ().slideUp ('fast');
+				} else {
+					admin_tools_list.stop ().css ('height', 'auto').slideDown ('fast');
+					$('#admin-tools-list a')[0].focus ();
+				}
+			
+				return false;
+			}
+
+			if (navigator.pointerEnabled) {
+				admin_tools.on ('pointerdown', toggle_tools);
+			} else if (navigator.msPointerEnabled) {
+				admin_tools.on ('MSPointerDown', toggle_tools);
+			} else {
+				admin_tools.hover (
+					toggle_tools_open,
+					toggle_tools_close
+				);
 
-		// hide the tools menu on hover of non-tools menu toolbar links
-		$('#admin-links a').not('#admin-tools-list a').bind("mouseover", toggle_tools_close);
+				admin_tools.on ('touchdown click', toggle_tools);
+			}
+
+			// hide the tools menu on hover of non-tools menu toolbar links
+			$('#admin-links a').not('#admin-tools-list a').bind("mouseover", toggle_tools_close);
+		}
 
 		// website link should open to the last non-admin page visited
 		var last_page = $('body').data ('admin-last-page');
@@ -320,7 +392,9 @@
 	}
 
 	// focus on the first form input on load
-	try {
-		$('input, textarea').eq (0).focus ();
-	} catch (e) {}
+	if (typeof elefant_focus_input !== 'undefined') {
+		try {
+			$('input, textarea').eq (0).focus ();
+		} catch (e) {}
+	}
 });
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/lib/Diff.php elefant-elefant_1_3_10_beta/apps/admin/lib/Diff.php
--- elefant-elefant_1_3_9_beta/apps/admin/lib/Diff.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/lib/Diff.php	2014-12-03 23:59:25.000000000 -0600
@@ -137,5 +137,3 @@
 		return $out;
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/lib/ExtendedAPI.php elefant-elefant_1_3_10_beta/apps/admin/lib/ExtendedAPI.php
--- elefant-elefant_1_3_9_beta/apps/admin/lib/ExtendedAPI.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/lib/ExtendedAPI.php	2014-12-03 23:59:25.000000000 -0600
@@ -136,5 +136,3 @@
 		return true;
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/lib/Functions.php elefant-elefant_1_3_10_beta/apps/admin/lib/Functions.php
--- elefant-elefant_1_3_9_beta/apps/admin/lib/Functions.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/lib/Functions.php	2014-12-03 23:59:25.000000000 -0600
@@ -34,38 +34,21 @@
 
 /**
  * Get a list of installed layouts/themes.
+ * Alias of `array_keys(admin\Layout::options())`,
+ * for backward compatibility.
  */
 function admin_get_layouts () {
-	$layouts = array ();
-	$sources = array (
-		'layouts/*.html',
-		'layouts/*/*.html'
-	);
-	foreach ($sources as $source) {
-		$files = glob ($source);
-		if ($files) {
-			foreach ($files as $file) {
-				if (preg_match ('/\/([^\/]+)\/([^\/]+)\.html$/', $file, $regs)) {
-					if ($regs[1] === $regs[2]) {
-						$layouts[] = $regs[1];
-					} else {
-						$layouts[] = $regs[1] . '/' . $regs[2];
-					}
-				} elseif (preg_match ('/\/([^\/]+)\.html$/', $file, $regs)) {
-					$layouts[] = $regs[1];
-				}
-			}
-		}
-	}
-	sort ($layouts);
-	return $layouts;
+	$layouts = admin\Layout::options ();
+	return array_keys ($layouts);
 }
 
 /**
  * Check whether a layout exists.
+ * Alias of `admin\Layout::exists()`,
+ * for backward compatibility.
  */
 function admin_layout_exists ($name) {
-	return (file_exists ('layouts/' . $name . '.html') || file_exists ('layouts/' . $name . '/' . $name . '.html'));
+	return admin\Layout::exists ($name);
 }
 
 /**
@@ -98,5 +81,3 @@
 	}
 	return $out;
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/lib/Layout.php elefant-elefant_1_3_10_beta/apps/admin/lib/Layout.php
--- elefant-elefant_1_3_9_beta/apps/admin/lib/Layout.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/lib/Layout.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,102 @@
+<?php
+
+namespace admin;
+
+/**
+ * Layout-related methods.
+ */
+class Layout {
+	public static $layouts = null;
+
+	public static $sources = array (
+		'layouts/*.html',
+		'layouts/*/*.html'
+	);
+
+	/**
+	 * Get a list of installed layouts/themes.
+	 */
+	public static function all () {
+		if (self::$layouts !== null) {
+			return self::$layouts;
+		}
+
+		foreach (self::$sources as $source) {
+			$files = glob ($source);
+			if ($files) {
+				foreach ($files as $file) {
+					if (preg_match ('/\/([^\/]+)\/([^\/]+)\.html$/', $file, $regs)) {
+						if ($regs[1] === $regs[2]) {
+							self::$layouts[] = $regs[1];
+						} else {
+							self::$layouts[] = $regs[1] . '/' . $regs[2];
+						}
+					} elseif (preg_match ('/\/([^\/]+)\.html$/', $file, $regs)) {
+						self::$layouts[] = $regs[1];
+					}
+				}
+			}
+		}
+		sort (self::$layouts);
+		return self::$layouts;
+	}
+
+	/**
+	 * Get the name of a theme from its elefant.json file,
+	 * or default to `ucfirst()` of its folder name.
+	 */
+	public static function theme_name ($theme = false) {
+		$theme = $theme ? $theme : conf ('General', 'default_layout');
+		
+		if (file_exists ('layouts/' . $theme . '/elefant.json')) {
+			$info = json_decode (file_get_contents ('layouts/' . $theme . '/elefant.json'));
+			if (isset ($info->name)) {
+				return $info->name;
+			}
+		}
+		return ucfirst ($theme);
+	}
+
+	/**
+	 * Get a list of layout options and their names. Useful for
+	 * layout selection in forms.
+	 */
+	public static function options () {
+		$layout = conf ('General', 'default_layout');
+		
+		if ($layout === 'default') {
+			$layouts = self::all ();
+			$out = array ();
+			foreach ($layouts as $layout) {
+				$out[$layout] = ucfirst ($layout);
+			}
+			return $out;
+		}
+
+		if (file_exists ('layouts/' . $layout . '/elefant.json')) {
+			$info = json_decode (file_get_contents ('layouts/' . $layout . '/elefant.json'));
+			if (isset ($info->layouts) && is_object ($info->layouts)) {
+				return array_merge (array ('default' => __ ('Default')), (array) $info->layouts);
+			}
+		}
+
+		$files = glob ('layouts/' . $layout . '/*.html');
+		$layouts = array ('default' => __ ('Default'));
+		if ($files) {
+			foreach ($files as $file) {
+				$name = basename ($file, '.html');
+				if ($name !== $layout) {
+					$layouts[$layout . '/' . $name] = ucfirst ($name);
+				}
+			}
+		}
+		return $layouts;
+	}
+
+	/**
+	 * Check whether a layout exists.
+	 */
+	public static function exists ($name) {
+		return (file_exists ('layouts/' . $name . '.html') || file_exists ('layouts/' . $name . '/' . $name . '.html'));
+	}
+}
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/lib/Lock.php elefant-elefant_1_3_10_beta/apps/admin/lib/Lock.php
--- elefant-elefant_1_3_9_beta/apps/admin/lib/Lock.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/lib/Lock.php	2014-12-03 23:59:25.000000000 -0600
@@ -194,5 +194,3 @@
 		return DB::execute ('delete from `#prefix#lock`');
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/lib/Notifier.php elefant-elefant_1_3_10_beta/apps/admin/lib/Notifier.php
--- elefant-elefant_1_3_9_beta/apps/admin/lib/Notifier.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/lib/Notifier.php	2014-12-03 23:59:25.000000000 -0600
@@ -22,5 +22,3 @@
 		return setcookie (self::$cookie_name, $msg, 0, '/');
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/lib/Toolbar.php elefant-elefant_1_3_10_beta/apps/admin/lib/Toolbar.php
--- elefant-elefant_1_3_9_beta/apps/admin/lib/Toolbar.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/lib/Toolbar.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,340 @@
+<?php
+
+namespace admin;
+
+use \Appconf;
+use \DB;
+use \User;
+
+/**
+ * Fetches apps for the Elefant toolbar.
+ */
+class Toolbar {
+	public static $custom_tools_file = 'conf/tools.php';
+	public static $custom_tools = null;
+
+	public static $tools = null;
+
+	public static $installed_apps = null;
+
+	/**
+	 * Callback to sort links by their `name` key.
+	 */
+	public static function link_sort ($a, $b) {
+		if ($a['name'] == $b['name']) {
+			return 0;
+		}
+		return ($a['name'] < $b['name']) ? -1 : 1;
+	}
+
+	/**
+	 * Check if an app is compatible with the current user's platform.
+	 */
+	public static function is_compatible ($appconf) {
+		if (isset ($appconf['Admin']['platforms'])) {
+                $device_list = explode (',', $appconf['Admin']['platforms']);
+                foreach ($device_list as $device) {
+                        if (detect (trim ($device))) {
+                                return true;
+                        }
+                }
+        } else {
+                // No Admin/platforms conf entry so assume app is compatible
+                return true;
+        }
+        return false;
+	}
+
+	public static function custom_tools ($controller) {
+		if (self::$custom_tools !== null) {
+			return self::$custom_tools;
+		}
+
+		if (! file_exists (self::$custom_tools_file)) {
+			self::$custom_tools = false;
+			return self::$custom_tools;
+		}
+
+		self::$custom_tools = parse_ini_file (self::$custom_tools_file, true);
+		$add_extras_under = false;
+		$first_column = false;
+		$original_tools = array ();
+
+		if (self::$custom_tools !== false) {
+			foreach (self::$custom_tools as $column => $tools) {
+				if ($first_column === false) {
+					$first_column = $column;
+				}
+
+				foreach ($tools as $handler => $name) {
+					if ($handler === '*') {
+						$add_extras_under = $column;
+						unset (self::$custom_tools[$column][$handler]);
+						continue;
+					}
+
+					$original_tools[] = $handler;
+		
+					if ($handler === 'admin/pages' && ! Appconf::admin ('General', 'show_all_pages')) {
+						unset (self::$custom_tools[$column][$handler]);
+						continue;
+					}
+					
+					$app = substr ($handler, 0, strpos ($handler, '/'));
+
+					// for app/admin and app/index handlers, verify acl on app alone
+					// for app/custom-name handlers, verify acl on both app and handler
+					if (
+							(preg_match ('/^' . preg_quote ($app, '/') . '\/(admin|index)$/', $handler)
+								&&
+							User::require_acl ($app))
+						||
+							User::require_acl ($app, $handler)
+					) {
+						// Ok
+					} else {
+						// Can't access this app
+						unset (self::$custom_tools[$column][$handler]);
+						continue;
+					}
+
+					$appconf = Appconf::get ($app);
+
+					if (! self::is_compatible ($appconf)) {
+						// App not compatible with this platform
+						unset (self::$custom_tools[$column][$handler]);
+						continue;
+					}
+
+					if (isset ($appconf['Admin']['install'])) {
+						$ver = $controller->installed ($app, $appconf['Admin']['version']);
+
+						if ($ver === true) {
+							// installed
+							self::$custom_tools[$column][$handler] = array (
+								'handler' => $handler,
+								'name' => __ ($name),
+								'class' => false
+							);
+						} elseif ($ver === false) {
+							// not installed
+							$name = __ ($name) . ' (' . __ ('click to install') . ')';
+							unset (self::$custom_tools[$column][$handler]);
+							self::$custom_tools[$column][$handler] = array (
+								'handler' => $appconf['Admin']['install'],
+								'name' => $name,
+								'class' => 'needs-upgrade'
+							);
+						} else {
+							// needs upgrade
+							$name = __ ($name) . ' (' . __ ('click to upgrade') . ')';
+							self::$custom_tools[$column][$handler] = array (
+								'handler' => $appconf['Admin']['upgrade'],
+								'name' => $name,
+								'class' => 'needs-upgrade'
+							);
+						}
+					} else {
+						// no installer, as you were
+						self::$custom_tools[$column][$handler] = array (
+							'handler' => $handler,
+							'name' => __ ($name),
+							'class' => false
+						);
+					}
+				}
+			}
+		}
+		
+		// check if we need to add an upgrade link
+		$ver = $controller->installed ('elefant', ELEFANT_VERSION);
+		if ($ver !== true) {
+			self::$custom_tools[$first_column]['admin/upgrade'] = array (
+				'handler' => 'admin/upgrade',
+				'name' => ' ' . __ ('Click to upgrade'),
+				'class' => 'needs-upgrade'
+			);
+		}
+		
+		// check if we need to add additional apps
+		if ($add_extras_under !== false) {
+			// parse each and determine whether to add it to the list
+			$extras = array ();
+			$res = glob ('apps/*/conf/config.php');
+			foreach ($res as $file) {
+				$app = preg_replace ('/^apps\/(.*)\/conf\/config\.php$/i', '\1', $file);
+
+				if (! User::require_acl ($app)) {
+					// Can't access this app
+					continue;
+				}
+
+				$appconf = Appconf::get ($app);
+
+				if (! self::is_compatible ($appconf)) {
+					// App not compatible with this platform
+					continue;
+				}
+				
+				if (isset ($appconf['Admin']['handler'])) {
+					if (in_array ($appconf['Admin']['handler'], $original_tools)) {
+						continue;
+					}
+
+					if (! preg_match ('/\/(admin|index)$/', $appconf['Admin']['handler']) && ! User::require_acl ($appconf['Admin']['handler'])) {
+						// A non /admin or /index handler should get an additional
+						// access check (e.g., admin/versions).
+						continue;
+					}
+				
+					if (isset ($appconf['Admin']['install'])) {
+						$ver = $controller->installed ($app, $appconf['Admin']['version']);
+
+						if ($ver === true) {
+							// installed
+							$extras[$appconf['Admin']['handler']] = array (
+								'handler' => $appconf['Admin']['handler'],
+								'name' => $appconf['Admin']['name'],
+								'class' => false
+							);
+						} elseif ($ver === false) {
+							// not installed
+							$appconf['Admin']['name'] .= ' (' . __ ('click to install') . ')';
+							$extras[$appconf['Admin']['install']] = array (
+								'handler' => $appconf['Admin']['install'],
+								'name' => $appconf['Admin']['name'],
+								'class' => 'needs-upgrade'
+							);
+						} else {
+							// needs upgrade
+							$appconf['Admin']['name'] .= ' (' . __ ('click to upgrade') . ')';
+							$extras[$appconf['Admin']['upgrade']] = array (
+								'handler' => $appconf['Admin']['upgrade'],
+								'name' => $appconf['Admin']['name'],
+								'class' => 'needs-upgrade'
+							);
+						}
+					} else {
+						// no installer, as you were
+						$extras[$appconf['Admin']['handler']] = array (
+							'handler' => $appconf['Admin']['handler'],
+							'name' => $appconf['Admin']['name'],
+							'class' => false
+						);
+					}
+				}
+			}
+
+			uasort ($extras, 'admin\Toolbar::link_sort');
+			$count = 0;
+			foreach ($extras as $handler => $extra) {
+				if ($count >= 14) {
+					self::$custom_tools['&nbsp;'][$handler] = $extra;
+				} elseif ($count >= 7) {
+					self::$custom_tools['&nbsp;&nbsp;'][$handler] = $extra;
+				} else {
+					self::$custom_tools[$add_extras_under][$handler] = $extra;
+				}
+				$count++;
+			}
+		}
+
+		foreach (self::$custom_tools as $section => $tools) {
+			if (count ($tools) === 0) {
+				unset (self::$custom_tools[$section]);
+			}
+		}
+		
+		return self::$custom_tools;
+	}
+	
+	/**
+	 * Parse the apps for a list of tools.
+	 */
+	public static function parse_apps ($controller) {
+		if (self::$tools !== null) {
+			return self::$tools;
+		}
+
+		$ver = $controller->installed ('elefant', ELEFANT_VERSION);
+		if ($ver === true) {
+			self::$tools = array (
+				'admin/pages' => array (
+					'handler' => 'admin/pages',
+					'name' => ' ' . __ ('Web Pages'),
+					'class' => false
+				)
+			);
+		} else {
+			self::$tools = array (
+				'admin/upgrade' => array (
+					'handler' => 'admin/upgrade',
+					'name' => ' ' . __ ('Click to upgrade'),
+					'class' => 'needs-upgrade'
+				),
+				'admin/pages' => array (
+					'handler' => 'admin/pages',
+					'name' => ' ' . __ ('Web Pages')
+				)
+			);
+		}
+		
+		if (! Appconf::admin ('General', 'show_all_pages') || ! User::require_acl ('admin/pages')) {
+			unset (self::$tools['admin/pages']);
+		}
+
+		// parse each app to determine whether to add it to the list
+		$res = glob ('apps/*/conf/config.php');
+		foreach ($res as $file) {
+			$app = preg_replace ('/^apps\/(.*)\/conf\/config\.php$/i', '\1', $file);
+
+			if (! User::require_acl ($app)) {
+				// Can't access this app
+				continue;
+			}
+			
+			$appconf = Appconf::get ($app);
+
+			if (! self::is_compatible ($appconf)) {
+				// App not compatible with this platform
+				continue;
+			}
+
+			if (isset ($appconf['Admin']['handler'])) {
+				if (! preg_match ('/\/(admin|index)$/', $appconf['Admin']['handler']) && ! User::require_acl ($appconf['Admin']['handler'])) {
+					// A non /admin or /index handler should get an additional
+					// access check (e.g., admin/versions).
+					continue;
+				}
+				
+				if (isset ($appconf['Admin']['install'])) {
+					$ver = $controller->installed ($app, $appconf['Admin']['version']);
+
+					if ($ver === true) {
+						// installed
+						self::$tools[$appconf['Admin']['handler']] = $appconf['Admin'];
+						self::$tools[$appconf['Admin']['handler']]['class'] = false;
+					} elseif ($ver === false) {
+						// not installed
+						$appconf['Admin']['name'] .= ' (' . __ ('click to install') . ')';
+						self::$tools[$appconf['Admin']['install']] = $appconf['Admin'];
+						self::$tools[$appconf['Admin']['install']]['class'] = 'not-installed';
+					} else {
+						// needs upgrade
+						$appconf['Admin']['name'] .= ' (' . __ ('click to upgrade') . ')';
+						self::$tools[$appconf['Admin']['upgrade']] = $appconf['Admin'];
+						self::$tools[$appconf['Admin']['upgrade']]['class'] = 'needs-upgrade';
+					}
+				} else {
+					// no installer, as you were
+					self::$tools[$appconf['Admin']['handler']] = $appconf['Admin'];
+					self::$tools[$appconf['Admin']['handler']]['class'] = false;
+				}
+			}
+		}
+		
+		uasort (self::$tools, 'admin\Toolbar::link_sort');
+
+		return self::$tools;
+	}
+}
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/models/ExtendedFields.php elefant-elefant_1_3_10_beta/apps/admin/models/ExtendedFields.php
--- elefant-elefant_1_3_9_beta/apps/admin/models/ExtendedFields.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/models/ExtendedFields.php	2014-12-03 23:59:25.000000000 -0600
@@ -60,5 +60,3 @@
 			->count ();
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/models/Versions.php elefant-elefant_1_3_10_beta/apps/admin/models/Versions.php
--- elefant-elefant_1_3_9_beta/apps/admin/models/Versions.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/models/Versions.php	2014-12-03 23:59:25.000000000 -0600
@@ -130,12 +130,16 @@
 	 */
 	public static function history ($obj, $limit = 10, $offset = 0) {
 		if ($limit === true) {
+			// return a count instead of the results
 			if (is_string ($obj)) {
+				// return for a class type
 				return count (Versions::query ()
 					->where ('class', $obj)
 					->group ('pkey')
 					->fetch_field ('pkey'));
 			}
+
+			// return for an individual object
 			return count (Versions::query ()
 				->where ('class', get_class ($obj))
 				->where ('pkey', $obj->{$obj->key})
@@ -141,13 +145,24 @@
 				->where ('pkey', $obj->{$obj->key})
 				->fetch_field ('pkey'));
 		}
+
 		if (is_string ($obj)) {
-			return Versions::query ()
-				->where ('class', $obj)
-				->order ('ts desc')
-				->group ('pkey')
-				->fetch_orig ($limit, $offset);
+			// return for a class type
+			if (! is_numeric ($limit)) return array ();
+			if (! is_numeric ($offset)) return array ();
+			return DB::fetch (
+				'select * from `#prefix#versions` 
+				 where `id` in
+				 	(select max(`id`) from `#prefix#versions`
+				 	 where `class` = ?
+				 	 group by `pkey`)
+				 order by `ts` desc
+				 limit ' . $limit . ' offset ' . $offset,
+				$obj
+			);
 		}
+
+		// return for an individual object
 		return Versions::query ()
 			->where ('class', get_class ($obj))
 			->where ('pkey', $obj->{$obj->key})
@@ -172,13 +187,23 @@
 			$v = new Versions;
 			$obj2 = $v->restore ($obj2);
 		}
+		
+		// are there extended fields?
+		$ext = is_subclass_of ($obj2, 'ExtendedModel') ? $obj2->_extended_field : false;
 
 		$changed = array ();
-		foreach ($obj1->data as $key => $value) {
-			if ($value !== $obj2->data[$key]) {
+		$obj1_orig = (array) $obj1->orig ();
+		$obj2_orig = (array) $obj2->orig ();
+		foreach ($obj1_orig as $key => $value) {
+			if ($ext === $key) {
+				// skip extended field
+				continue;
+			}
+			if ($value !== $obj2_orig[$key]) {
 				$changed[] = $key;
 			}
 		}
+		
 		return $changed;
 	}
 
@@ -191,5 +216,3 @@
 		);
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/models/Webpage.php elefant-elefant_1_3_10_beta/apps/admin/models/Webpage.php
--- elefant-elefant_1_3_9_beta/apps/admin/models/Webpage.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/models/Webpage.php	2014-12-03 23:59:25.000000000 -0600
@@ -85,6 +85,28 @@
 		}
 		return $urls;
 	}
-}
 
-?>
\ No newline at end of file
+	/**
+	 * Generate a list of pages for the search app,
+	 * and add them directly via `Search::add()`.
+	 */
+	public static function search () {
+		$pages = self::query ()
+			->where ('access', 'public')
+			->fetch_orig ();
+		
+		foreach ($pages as $i => $page) {
+			if (! Search::add (
+				$page->id,
+				array (
+					'title' => $page->title,
+					'text' => $page->body,
+					'url' => Link::href ($page->id)
+				)
+			)) {
+				return array (false, $i);
+			}
+		}
+		return array (true, count ($pages));
+	}
+}
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/views/add/head.html elefant-elefant_1_3_10_beta/apps/admin/views/add/head.html
--- elefant-elefant_1_3_9_beta/apps/admin/views/add/head.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/views/add/head.html	2014-12-03 23:59:25.000000000 -0600
@@ -49,7 +49,7 @@
 	var t = f.target,
 		a = f.action;
 
-	f.target = '_blank';
+	f.target = 'elefant-preview';
 	f.action = '/admin/preview';
 	f.submit ();
 
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/views/add.html elefant-elefant_1_3_10_beta/apps/admin/views/add.html
--- elefant-elefant_1_3_9_beta/apps/admin/views/add.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/views/add.html	2014-12-03 23:59:25.000000000 -0600
@@ -14,8 +14,8 @@
 <div id="extra-options">
 <p>{"Page layout"}:<br />
 <select name="layout">
-{% foreach layouts %}
-	<option value="{{ loop_value }}"{% if loop_value == $data->layout %} selected{% end %}>{{ loop_value|ucfirst }}</option>
+{% foreach admin\Layout::options() as _layout, _name %}
+	<option value="{{ _layout }}"{% if _layout == $data->layout %} selected{% end %}>{{ _name }}</option>
 {% end %}
 </select></p>
 <p>{"Access"}:<br />
Files elefant-elefant_1_3_9_beta/apps/admin/views/base.html and elefant-elefant_1_3_10_beta/apps/admin/views/base.html are identical
Files elefant-elefant_1_3_9_beta/apps/admin/views/compare.html and elefant-elefant_1_3_10_beta/apps/admin/views/compare.html are identical
Files elefant-elefant_1_3_9_beta/apps/admin/views/default-validation.html and elefant-elefant_1_3_10_beta/apps/admin/views/default-validation.html are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/views/edit/head.html elefant-elefant_1_3_10_beta/apps/admin/views/edit/head.html
--- elefant-elefant_1_3_9_beta/apps/admin/views/edit/head.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/views/edit/head.html	2014-12-03 23:59:25.000000000 -0600
@@ -57,7 +57,7 @@
 	var t = f.target,
 		a = f.action;
 
-	f.target = '_blank';
+	f.target = 'elefant-preview';
 	f.action = '/admin/preview';
 	f.submit ();
 
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/views/edit.html elefant-elefant_1_3_10_beta/apps/admin/views/edit.html
--- elefant-elefant_1_3_9_beta/apps/admin/views/edit.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/views/edit.html	2014-12-03 23:59:25.000000000 -0600
@@ -14,8 +14,8 @@
 <div id="extra-options">
 <p>{"Page layout"}:<br />
 <select name="layout">
-{% foreach layouts %}
-	<option value="{{ loop_value }}"{% if loop_value == $data->layout %} selected{% end %}>{{ loop_value|ucfirst }}</option>
+{% foreach admin\Layout::options() as _layout, _name %}
+	<option value="{{ _layout }}"{% if _layout == $data->layout %} selected{% end %}>{{ _name }}</option>
 {% end %}
 </select></p>
 <p>{"Access"}:<br />
@@ -30,7 +30,7 @@
 <p>{"Description"}:<br /><textarea name="description" cols="60" rows="4">{{ description }}</textarea></p>
 <p>{"Keywords (comma-separated)"}:<br /><textarea name="keywords" cols="60" rows="4">{{ keywords }}</textarea></p>
 </div>
-{! admin/util/extended?extends=Webpage&name=Pages&values=[extra|none] !}
+{! admin/util/extended?extends=Webpage&name=Pages&values=[extra|none]&id=[id] !}
 <p>
 	<input type="submit" value="{"Save Page"}" class="autosave-clear" />&nbsp;
 	<input type="submit" value="{"Save &amp; Keep Editing"}" id="bgsave" />&nbsp;
Files elefant-elefant_1_3_9_beta/apps/admin/views/editable.html and elefant-elefant_1_3_10_beta/apps/admin/views/editable.html are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/views/extended.html elefant-elefant_1_3_10_beta/apps/admin/views/extended.html
--- elefant-elefant_1_3_9_beta/apps/admin/views/extended.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/views/extended.html	2014-12-03 23:59:25.000000000 -0600
@@ -86,13 +86,13 @@
 		extends: {{extends||json_encode}},
 		fields: {{fields|json_encode}},
 		strings: {
-			confirm_delete: '{"Are you sure you want to delete this field?"}',
-			label_empty: '{"You must enter a field name."}',
-			options_empty: '{"You must enter options for a select field."}',
-			field_added: '{"Field added."}',
-			field_updated: '{"Field updated."}',
-			field_delete: '{"Field deleted."}',
-			order_updated: '{"Field order has been updated."}'
+			confirm_delete: "{"Are you sure you want to delete this field?"}",
+			label_empty: "{"You must enter a field name."}",
+			options_empty: "{"You must enter options for a select field."}",
+			field_added: "{"Field added."}",
+			field_updated: "{"Field updated."}",
+			field_delete: "{"Field deleted."}",
+			order_updated: "{"Field order has been updated."}"
 		},
 		custom: {{custom|json_encode}}
 	});
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/views/head/links.html elefant-elefant_1_3_10_beta/apps/admin/views/head/links.html
--- elefant-elefant_1_3_9_beta/apps/admin/views/head/links.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/views/head/links.html	2014-12-03 23:59:25.000000000 -0600
@@ -1,11 +1,30 @@
-<a href="#preview" class="admin-tools-show-preview" data-trigger="p" data-trigger-label="{"Toggle preview mode"}">{"Preview"}</a>
-<a href="/" id="admin-tools-website" data-trigger="w" data-trigger-label="{"Go to website"}">{"Website"}</a>
-<span id="admin-tools" data-trigger="t" data-trigger-label="{"Toggle tools menu"}">{"Tools"} <strong>&or;</strong>
-<ul id="admin-tools-list">
-{% foreach tools %}
-    <li><a href="/{{ loop_index }}"{% if loop_value['class'] %}class="{{ loop_value['class'] }}"{% end %}>{{ loop_value['name']|i18n_get }}</a></li>
+{% if ! custom %}
+	<a href="#preview" class="admin-tools-show-preview" data-trigger="p" data-trigger-label="{"Toggle preview mode"}">{"Preview"}</a>
+	<a href="/" id="admin-tools-website" data-trigger="w" data-trigger-label="{"Go to website"}">{"Website"}</a>
+	<span id="admin-tools" data-trigger="t" data-trigger-label="{"Toggle tools menu"}">{"Tools"} &nbsp; &nbsp;
+	<ul id="admin-tools-list">
+	{% foreach tools %}
+		<li><a href="/{{ loop_index }}"{% if loop_value['class'] %}class="{{ loop_value['class'] }}"{% end %}>{{ loop_value['name']|i18n_get }}</a></li>
+	{% end %}
+	</ul>
+	</span>
+	<a href="/user" id="admin-tools-user" data-trigger="u" data-trigger-label="{"Go to user profile"}">{{ user }}</a>
+	<a href="/user/logout" id="admin-tools-logout" data-trigger="q" data-trigger-label="{"Log out"}">{"Log out"}</a>
+{% else %}
+	<a href="#preview" class="admin-tools-show-preview" data-trigger="p" data-trigger-label="{"Toggle preview mode"}">{"Preview"}</a>
+	<a href="/" id="admin-tools-website" data-trigger="w" data-trigger-label="{"Go to website"}">{"Website"}</a>
+	<div id="admin-tools-list" class="admin-tools-custom">
+	{% foreach tools as section, _tools %}
+		<div class="admin-tools-section">
+		<h3 class="admin-tools-section-header">{{section|__}}</h3>
+		<ul class="admin-tools-list">
+		{% foreach _tools as _tool %}
+			<li><a href="/{{ _tool['handler'] }}"{% if _tool['class'] %}class="{{ _tool['class'] }}"{% end %}>{{ _tool['name']|__ }}</a></li>
+		{% end %}
+		</ul>
+		</div>
+	{% end %}
+	</div>
+	<a href="/user" id="admin-tools-user" data-trigger="u" data-trigger-label="{"Go to user profile"}">{{ user }}</a>
+	<a href="/user/logout" id="admin-tools-logout" data-trigger="q" data-trigger-label="{"Log out"}">{"Log out"}</a>
 {% end %}
-</ul>
-</span>
-<a href="/user" data-trigger="u" data-trigger-label="{"Go to user profile"}">{{ user }}</a>
-<a href="/user/logout" data-trigger="q" data-trigger-label="{"Log out"}">{"Log out"}</a>
Files elefant-elefant_1_3_9_beta/apps/admin/views/index.html and elefant-elefant_1_3_10_beta/apps/admin/views/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/admin/views/locked.html and elefant-elefant_1_3_10_beta/apps/admin/views/locked.html are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/admin/views/pages.html elefant-elefant_1_3_10_beta/apps/admin/views/pages.html
--- elefant-elefant_1_3_9_beta/apps/admin/views/pages.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/admin/views/pages.html	2014-12-03 23:59:25.000000000 -0600
@@ -1,37 +1,60 @@
-{% if User::require_acl ('admin/edit', 'admin/add') %}
-<p>
+{! admin/util/minimal-grid !}
+{! admin/util/search !}
+
+<div class="e-row-variable" style="margin-bottom: 20px">
+	<div class="e-col-50 e-no-padding">
+	{% if User::require_acl ('admin/edit', 'admin/add') %}
 	<a href="/admin/add">{"Add Page"}</a>
-	{% if User::require_acl ('settings') %}
-	&nbsp;|&nbsp;
-	<a href="/admin/extended?extends=Webpage&name=Pages">{"Custom Fields"}</a>
+		{% if User::require_acl ('settings') %}
+		&nbsp;|&nbsp;
+		<a href="/admin/extended?extends=Webpage&name=Pages">{"Custom Fields"}</a>
+		{% end %}
 	{% end %}
-</p>
-{% end %}
-
-<p style="float: left">
-{! navigation/pager?style=results&url=[url]&total=[total]&count=[count]&limit=[limit] !}
-</p>
+	</div>
+	<div class="e-col-50 e-no-padding" style="text-align: right">
+		<form method="get" id="search-form">
+			<input type="text" name="q" id="search-query" size="40" value="{{q|quotes}}" />
+			<button>{"Search"}</button>
+			{% if q != '' %}
+			<button onclick="window.location.href = '/admin/pages'; return false">{"Clear"}</button>
+			{% end %}
+		</form>
+	</div>
+</div>
 
-{% if total > $data->limit %}
-<div style="float: right">
-{! navigation/pager?style=numbers&url=[url]&total=[total]&count=[count]&limit=[limit] !}
+<div class="e-row-variable">
+	<div class="e-col-50 e-no-padding">
+		{! navigation/pager?style=results&url=[url]&total=[total]&count=[count]&limit=[limit] !}
+	</div>
+	<div class="e-col-50 e-no-padding" style="text-align: right">
+		{% if total > $data->limit %}
+		{! navigation/pager?style=numbers&url=[url]&total=[total]&count=[count]&limit=[limit] !}
+		{% end %}
+	</div>
 </div>
-{% end %}
 
-<p>
 <table width="100%">
 	<tr>
 		<th width="38%">{"ID"}</th>
 		<th width="38%">{"Title"}</th>
-		<th width="12%">{"Access"}</th>
+		<th width="12%">
+			<select class="search-option" data-prefix="access">
+				<option value="">{"Access"}</option>
+				{% foreach User::access_list () as _access, _name %}
+				<option value="{{_access}}">{{_name}}</option>
+				{% end %}
+			</select>
+		</th>
 		<th width="12%">&nbsp;</th>
 	</tr>
 {% foreach pages %}
 	<tr>
 		<td><a href="{{ loop_value->id|Link::href }}" target="_blank">{{ loop_value->id }}</a></td>
 		<td>{{ loop_value->title }}</td>
-		<td>{{ loop_value->access|ucfirst }}</td>
-		<td style="text-align: right">
+		<td>
+			<a href="#" class="search-for" data-search="access:{{ loop_value->access}}">{{ loop_value->access|ucfirst }}</a>
+		</td>
+		<td class="edit">
 			{% if loop_value->locked %}
 			{"Editing Locked"}
 			{% else %}
@@ -47,8 +70,18 @@
 	</tr>
 {% end %}
 </table>
-</p>
 
 {% if total > $data->limit %}
 {! navigation/pager?style=numbers&url=[url]&total=[total]&count=[count]&limit=[limit] !}
 {% end %}
+
+<script>
+$(function () {
+	$.search_init ({
+		form: '#search-form',
+		query: '#search-query',
+		links: '.search-for',
+		options: '.search-option'
+	});
+});
+</script>
Files elefant-elefant_1_3_9_beta/apps/admin/views/util/codemirror.html and elefant-elefant_1_3_10_beta/apps/admin/views/util/codemirror.html are identical
Files elefant-elefant_1_3_9_beta/apps/admin/views/util/extended.html and elefant-elefant_1_3_10_beta/apps/admin/views/util/extended.html are identical
Files elefant-elefant_1_3_9_beta/apps/admin/views/util/wysiwyg.html and elefant-elefant_1_3_10_beta/apps/admin/views/util/wysiwyg.html are identical
Files elefant-elefant_1_3_9_beta/apps/admin/views/versions.html and elefant-elefant_1_3_10_beta/apps/admin/views/versions.html are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/api/conf/config.php elefant-elefant_1_3_10_beta/apps/api/conf/config.php
--- elefant-elefant_1_3_9_beta/apps/api/conf/config.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/api/conf/config.php	2014-12-03 23:59:25.000000000 -0600
@@ -9,4 +9,4 @@
 page = "Webpage"
 post = "blog\Post" ; Note the namespace usage here
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/api/handlers/index.php elefant-elefant_1_3_10_beta/apps/api/handlers/index.php
--- elefant-elefant_1_3_9_beta/apps/api/handlers/index.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/api/handlers/index.php	2014-12-03 23:59:25.000000000 -0600
@@ -5,5 +5,3 @@
  */
 
 $this->redirect ('/api/' . $appconf['Api']['current_version']);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/api/handlers/v1.php elefant-elefant_1_3_10_beta/apps/api/handlers/v1.php
--- elefant-elefant_1_3_9_beta/apps/api/handlers/v1.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/api/handlers/v1.php	2014-12-03 23:59:25.000000000 -0600
@@ -219,5 +219,3 @@
 }
 
 echo json_encode ($res);
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/api/models/Api.php elefant-elefant_1_3_10_beta/apps/api/models/Api.php
--- elefant-elefant_1_3_9_beta/apps/api/models/Api.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/api/models/Api.php	2014-12-03 23:59:25.000000000 -0600
@@ -78,5 +78,3 @@
 		return array ($a->token, $a->api_key);
 	}
 }
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/blocks/conf/acl.php elefant-elefant_1_3_10_beta/apps/blocks/conf/acl.php
--- elefant-elefant_1_3_9_beta/apps/blocks/conf/acl.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blocks/conf/acl.php	2014-12-03 23:59:25.000000000 -0600
@@ -2,4 +2,4 @@
 
 blocks = "Modify content blocks"
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/blocks/conf/config.php elefant-elefant_1_3_10_beta/apps/blocks/conf/config.php
--- elefant-elefant_1_3_9_beta/apps/blocks/conf/config.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blocks/conf/config.php	2014-12-03 23:59:25.000000000 -0600
@@ -5,4 +5,4 @@
 handler = blocks/admin
 name = Blocks
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/blocks/forms/add.php elefant-elefant_1_3_10_beta/apps/blocks/forms/add.php
--- elefant-elefant_1_3_9_beta/apps/blocks/forms/add.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blocks/forms/add.php	2014-12-03 23:59:25.000000000 -0600
@@ -14,4 +14,4 @@
 
 not empty = 1
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/blocks/forms/edit.php elefant-elefant_1_3_10_beta/apps/blocks/forms/edit.php
--- elefant-elefant_1_3_9_beta/apps/blocks/forms/edit.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blocks/forms/edit.php	2014-12-03 23:59:25.000000000 -0600
@@ -13,4 +13,4 @@
 
 not empty = 1
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/blocks/handlers/add.php elefant-elefant_1_3_10_beta/apps/blocks/handlers/add.php
--- elefant-elefant_1_3_9_beta/apps/blocks/handlers/add.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blocks/handlers/add.php	2014-12-03 23:59:25.000000000 -0600
@@ -37,5 +37,3 @@
 	echo $tpl->render ('blocks/add/head', $b);
 	echo $tpl->render ('blocks/add', $b);
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blocks/handlers/admin.php elefant-elefant_1_3_10_beta/apps/blocks/handlers/admin.php
--- elefant-elefant_1_3_9_beta/apps/blocks/handlers/admin.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blocks/handlers/admin.php	2014-12-03 23:59:25.000000000 -0600
@@ -31,5 +31,3 @@
 	'count' => count ($blocks),
 	'url' => '/blocks/admin?offset=%d'
 ));
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blocks/handlers/bgsave.php elefant-elefant_1_3_10_beta/apps/blocks/handlers/bgsave.php
--- elefant-elefant_1_3_9_beta/apps/blocks/handlers/bgsave.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blocks/handlers/bgsave.php	2014-12-03 23:59:25.000000000 -0600
@@ -47,5 +47,3 @@
 }
 
 echo json_encode ($res);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blocks/handlers/delete.php elefant-elefant_1_3_10_beta/apps/blocks/handlers/delete.php
--- elefant-elefant_1_3_9_beta/apps/blocks/handlers/delete.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blocks/handlers/delete.php	2014-12-03 23:59:25.000000000 -0600
@@ -37,5 +37,3 @@
 } else {
 	$this->redirect ($_POST['return']);
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blocks/handlers/edit.php elefant-elefant_1_3_10_beta/apps/blocks/handlers/edit.php
--- elefant-elefant_1_3_9_beta/apps/blocks/handlers/edit.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blocks/handlers/edit.php	2014-12-03 23:59:25.000000000 -0600
@@ -49,5 +49,3 @@
 	echo $tpl->render ('blocks/edit/head', $b);
 	echo $tpl->render ('blocks/edit', $b);
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blocks/handlers/group.php elefant-elefant_1_3_10_beta/apps/blocks/handlers/group.php
--- elefant-elefant_1_3_9_beta/apps/blocks/handlers/group.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blocks/handlers/group.php	2014-12-03 23:59:25.000000000 -0600
@@ -45,6 +45,30 @@
  *
  * In this way, blocks can easily be styled collectively or individually,
  * making them a powerful way to build site content.
+ *
+ * You can also specify a `units` parameter, which specifies the width of
+ * each `div` as a `unit-%d` class, for example:
+ *
+ *     {! blocks/group
+ *        ?id[]=sidebar-promo
+ *        &id[]=sidebar-support
+ *        &units=75,25 !}
+ *
+ * This will output:
+ *
+ *     <div class="block unit-75" id="block-sidebar-promo">
+ *         <h2>Block title</h2>
+ *         <p>Block contents...</p>
+ *     </div>
+ *     <div class="block unit-25" id="block-sidebar-support">
+ *         <h2>Block title</h2>
+ *         <p>Block contents...</p>
+ *     </div>
+ *
+ * These can be styled and used to implement grid-based and responsive
+ * layouts. Here is a very basic example grid system implementation:
+ *
+ * https://gist.github.com/jbroadway/5d027fddfadabb56aff0
  */
 
 $ids = (count ($this->params) > 0) ? $this->params : (isset ($data['id']) ? $data['id'] : array ());
@@ -52,8 +76,18 @@
 	$ids = array ($ids);
 }
 
+if (count ($ids) === 0) {
+	return;
+}
+
 $level = (isset ($data['level']) && preg_match ('/^h[1-6]$/', $data['level'])) ? $data['level'] : 'h3';
 $divs = isset ($data['divs']) ? true : false;
+if (isset ($data['units'])) {
+	$units = explode (',', $data['units']);
+	$divs = true;
+} else {
+	$units = 'auto';
+}
 
 $qs = array ();
 foreach ($ids as $id) {
@@ -71,11 +105,32 @@
 	$list[$block->id] = $block;
 }
 
-foreach ($ids as $id) {
+$total = count ($blocks);
+if ($units === 'auto' || $total !== count ($units)) {
+	if ($total === 2) {
+		$units = array (66, 33);
+	} elseif ($total > 0) {
+		$units = array ();
+		$w = floor (100 / $total);
+		for ($k = 0; $k < $total; $k++) {
+			$units[$k] = $w;
+		}
+	}
+}
+
+foreach ($ids as $k => $id) {
 	if (! isset ($list[$id])) {
+		if ($divs) {
+			printf ('<div class="block block-missing" id="block-%s">' . PHP_EOL, $units[$k], $b->id);
+		}
+
 		if (User::require_acl ('admin', 'admin/edit', 'blocks')) {
 			echo $tpl->render ('blocks/editable', (object) array ('id' => $id, 'locked' => false)) . PHP_EOL;
 		}
+
+		if ($divs) {
+			echo '</div>' . PHP_EOL;
+		}
 		continue;
 	}
 
@@ -92,7 +147,7 @@
 	}
 
 	if ($divs) {
-		printf ('<div class="block" id="block-%s">' . PHP_EOL, $b->id);
+		printf ('<div class="block unit-%d" id="block-%s">' . PHP_EOL, $units[$k], $b->id);
 	}
 
 	if ($b->show_title == 'yes') {
@@ -111,5 +166,3 @@
 		echo '</div>' . PHP_EOL;
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blocks/handlers/index.php elefant-elefant_1_3_10_beta/apps/blocks/handlers/index.php
--- elefant-elefant_1_3_9_beta/apps/blocks/handlers/index.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blocks/handlers/index.php	2014-12-03 23:59:25.000000000 -0600
@@ -84,5 +84,3 @@
 }
 
 echo $tpl->run_includes ($b->body);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blocks/models/Block.php elefant-elefant_1_3_10_beta/apps/blocks/models/Block.php
--- elefant-elefant_1_3_9_beta/apps/blocks/models/Block.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blocks/models/Block.php	2014-12-03 23:59:25.000000000 -0600
@@ -41,5 +41,3 @@
 	 */
 	public $table = '#prefix#block';
 }
-
-?>
\ No newline at end of file
Files elefant-elefant_1_3_9_beta/apps/blocks/views/add/head.html and elefant-elefant_1_3_10_beta/apps/blocks/views/add/head.html are identical
Files elefant-elefant_1_3_9_beta/apps/blocks/views/add.html and elefant-elefant_1_3_10_beta/apps/blocks/views/add.html are identical
Files elefant-elefant_1_3_9_beta/apps/blocks/views/admin.html and elefant-elefant_1_3_10_beta/apps/blocks/views/admin.html are identical
Files elefant-elefant_1_3_9_beta/apps/blocks/views/edit/head.html and elefant-elefant_1_3_10_beta/apps/blocks/views/edit/head.html are identical
Files elefant-elefant_1_3_9_beta/apps/blocks/views/edit.html and elefant-elefant_1_3_10_beta/apps/blocks/views/edit.html are identical
Files elefant-elefant_1_3_9_beta/apps/blocks/views/editable.html and elefant-elefant_1_3_10_beta/apps/blocks/views/editable.html are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/conf/acl.php elefant-elefant_1_3_10_beta/apps/blog/conf/acl.php
--- elefant-elefant_1_3_9_beta/apps/blog/conf/acl.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/conf/acl.php	2014-12-03 23:59:25.000000000 -0600
@@ -2,4 +2,4 @@
 
 blog = "Post to the blog"
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/conf/cli.php elefant-elefant_1_3_10_beta/apps/blog/conf/cli.php
--- elefant-elefant_1_3_9_beta/apps/blog/conf/cli.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/conf/cli.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,5 @@
+; <?php /*
+
+commands[blog/publish-queue] = Publish scheduled blog posts.
+
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/conf/config.php elefant-elefant_1_3_10_beta/apps/blog/conf/config.php
--- elefant-elefant_1_3_9_beta/apps/blog/conf/config.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/conf/config.php	2014-12-03 23:59:25.000000000 -0600
@@ -43,6 +43,13 @@
 ;comments = disqus
 ;comments = comments/embed
 
+; Show related posts in a "You might also like" box at the bottom
+; of full post pages.
+
+show_related_posts = Off
+
+; Your Disqus.com shortname.
+
 disqus_shortname = ""
 
 [Social Buttons]
@@ -71,7 +78,8 @@
 name = Blog Posts
 install = blog/upgrade
 upgrade = blog/upgrade
-version = 1.1.3-stable
+version = 1.1.4-stable
 sitemap = "blog\Post::sitemap"
+search = "blog\Post::search"
 
 ; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/conf/embed.php elefant-elefant_1_3_10_beta/apps/blog/conf/embed.php
--- elefant-elefant_1_3_9_beta/apps/blog/conf/embed.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/conf/embed.php	2014-12-03 23:59:25.000000000 -0600
@@ -1,10 +1,19 @@
 ; <?php /*
 
+[blog/archives]
+
+label = "Blog: Archives Sidebar"
+icon = rss
+
 [blog/headlines]
 
 label = "Blog: Headlines"
 icon = rss
 
+limit[label] = "Number of Posts"
+limit[type] = numeric
+limit[initial] = 10
+
 tag[label] = "Tag (optional)"
 tag[type] = select
 tag[require] = "apps/blog/lib/Functions.php"
@@ -15,6 +24,16 @@
 dates[require] = "apps/blog/lib/Functions.php"
 dates[callback] = "blog_yes_no"
 
+[blog/bymonth]
+
+label = "Blog: Headlines by Month"
+icon = rss
+
+tag[label] = "Tag (optional)"
+tag[type] = select
+tag[require] = "apps/blog/lib/Functions.php"
+tag[callback] = "blog_get_tags"
+
 [blog/tags]
 
 label = "Blog: Tag Cloud"
@@ -40,4 +59,9 @@
 number[type] = numeric
 number[initial] = 5
 
-; */ ?>
\ No newline at end of file
+tag[label] = "Tag (optional)"
+tag[type] = select
+tag[require] = "apps/blog/lib/Functions.php"
+tag[callback] = "blog_get_tags"
+
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/conf/helpers.php elefant-elefant_1_3_10_beta/apps/blog/conf/helpers.php
--- elefant-elefant_1_3_9_beta/apps/blog/conf/helpers.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/conf/helpers.php	2014-12-03 23:59:25.000000000 -0600
@@ -3,4 +3,4 @@
 blog/headlines = 1
 blog/postsfeed = 1
 blog/rssviewer = 1
-blog/tags = 1
\ No newline at end of file
+blog/tags = 1
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/conf/upgrade_1.1.3_mysql.sql elefant-elefant_1_3_10_beta/apps/blog/conf/upgrade_1.1.3_mysql.sql
--- elefant-elefant_1_3_9_beta/apps/blog/conf/upgrade_1.1.3_mysql.sql	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/conf/upgrade_1.1.3_mysql.sql	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1 @@
+alter table #prefix#blog_post add column extra text not null;
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/conf/upgrade_1.1.3_pgsql.sql elefant-elefant_1_3_10_beta/apps/blog/conf/upgrade_1.1.3_pgsql.sql
--- elefant-elefant_1_3_9_beta/apps/blog/conf/upgrade_1.1.3_pgsql.sql	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/conf/upgrade_1.1.3_pgsql.sql	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1 @@
+alter table #prefix#blog_post add column extra text not null default '';
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/conf/upgrade_1.1.3_sqlite.sql elefant-elefant_1_3_10_beta/apps/blog/conf/upgrade_1.1.3_sqlite.sql
--- elefant-elefant_1_3_9_beta/apps/blog/conf/upgrade_1.1.3_sqlite.sql	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/conf/upgrade_1.1.3_sqlite.sql	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1 @@
+alter table #prefix#blog_post add column "extra" "text not null";
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/conf/upgrade_1.1.4_mysql.sql elefant-elefant_1_3_10_beta/apps/blog/conf/upgrade_1.1.4_mysql.sql
--- elefant-elefant_1_3_9_beta/apps/blog/conf/upgrade_1.1.4_mysql.sql	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/conf/upgrade_1.1.4_mysql.sql	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,2 @@
+alter table #prefix#blog_post add column thumbnail char(128) not null default '';
+alter table #prefix#blog_post change column published published enum('yes','no','que') not null;
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/conf/upgrade_1.1.4_pgsql.sql elefant-elefant_1_3_10_beta/apps/blog/conf/upgrade_1.1.4_pgsql.sql
--- elefant-elefant_1_3_9_beta/apps/blog/conf/upgrade_1.1.4_pgsql.sql	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/conf/upgrade_1.1.4_pgsql.sql	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1 @@
+alter table #prefix#blog_post add column thumbnail char(128) not null default '';
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/conf/upgrade_1.1.4_sqlite.sql elefant-elefant_1_3_10_beta/apps/blog/conf/upgrade_1.1.4_sqlite.sql
--- elefant-elefant_1_3_9_beta/apps/blog/conf/upgrade_1.1.4_sqlite.sql	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/conf/upgrade_1.1.4_sqlite.sql	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1 @@
+alter table #prefix#blog_post add column "thumbnail" "char(128) not null default ''";
Binary files elefant-elefant_1_3_9_beta/apps/blog/css/default.jpg and elefant-elefant_1_3_10_beta/apps/blog/css/default.jpg differ
Files elefant-elefant_1_3_9_beta/apps/blog/css/jquery.tagit.css and elefant-elefant_1_3_10_beta/apps/blog/css/jquery.tagit.css are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/css/related.css elefant-elefant_1_3_10_beta/apps/blog/css/related.css
--- elefant-elefant_1_3_9_beta/apps/blog/css/related.css	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/css/related.css	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,94 @@
+/**
+ * Grid with thumbnails
+ */
+
+.item-list {
+	margin-top: 10px;
+}
+	.item {
+		width: 95%;
+		margin-bottom: 20px;
+	}
+		.item-info {
+			-webkit-box-sizing: border-box;
+			-moz-box-sizing: border-box;
+			box-sizing: border-box;
+			border-left: 1px solid #ccc;
+			border-right: 1px solid #ccc;
+			border-bottom: 1px solid #ccc;
+			margin: 0;
+			padding: 0;
+		}
+		.thumbnail-wrapper {
+			background-color: #ccc;
+			position: relative;
+			margin: 0;
+			padding: 0;
+			padding-bottom: 66%;
+			width: 100%;
+			height: 0;
+		}
+		.thumbnail {
+			position: absolute;
+			top: 0;
+			left: 0;
+			width: 100%;
+			height: 100%;
+			background-image: url(/apps/blog/css/default.jpg);
+			background-position: 50% 50%;
+			background-size: cover;
+		}
+		.item h4 {
+			padding: 5px 10px 0px 10px;
+			margin: 0;
+		}
+		.item p {
+			padding: 0px 10px 5px 10px;
+			margin: 0;
+		}
+		a.item-link {
+			display: block;
+			background-color: #444;
+			color: #fff;
+			padding: 3px;
+			text-align: center;
+			text-transform: uppercase;
+			text-decoration: none;
+		}
+		a.item-link:hover {
+			background-color: #333;
+			text-decoration: none;
+		}
+
+.summary>div:first-child {
+	padding: 0;
+}
+.summary>div:last-child {
+	position: relative;
+}
+.summary-info {
+	background-color: #f5f5f5;
+}
+	.summary-info-text {
+		padding: 10px 10px 0px 10px;
+	}
+	a.external-link {
+		position: absolute;
+		bottom: 0;
+		display: block;
+		background-color: #444;
+		color: #fff;
+		padding: 3px;
+		text-align: center;
+		text-transform: uppercase;
+		text-decoration: none;
+		width: 100%;
+	}
+	a.external-link:hover {
+		background-color: #333;
+		text-decoration: none;
+	}
+
+.details {
+	padding-top: 10px;
+}
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/forms/add.php elefant-elefant_1_3_10_beta/apps/blog/forms/add.php
--- elefant-elefant_1_3_9_beta/apps/blog/forms/add.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/forms/add.php	2014-12-03 23:59:25.000000000 -0600
@@ -16,4 +16,4 @@
 
 not empty = 1
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/forms/edit.php elefant-elefant_1_3_10_beta/apps/blog/forms/edit.php
--- elefant-elefant_1_3_9_beta/apps/blog/forms/edit.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/forms/edit.php	2014-12-03 23:59:25.000000000 -0600
@@ -16,4 +16,4 @@
 
 not empty = 1
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/forms/settings.php elefant-elefant_1_3_10_beta/apps/blog/forms/settings.php
--- elefant-elefant_1_3_9_beta/apps/blog/forms/settings.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/forms/settings.php	2014-12-03 23:59:25.000000000 -0600
@@ -7,12 +7,12 @@
 [layout]
 
 skip_if_empty = 1
-callback = admin_layout_exists
+callback = "admin\Layout::exists"
 
 [post_layout]
 
 skip_if_empty = 1
-callback = admin_layout_exists
+callback = "admin\Layout::exists"
 
 [comments]
 
@@ -39,4 +39,4 @@
 ;skip_if_empty = 1
 ;regex = "/^[a-zA-Z0-9_-]+$/"
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/handlers/add.php elefant-elefant_1_3_10_beta/apps/blog/handlers/add.php
--- elefant-elefant_1_3_9_beta/apps/blog/handlers/add.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/handlers/add.php	2014-12-03 23:59:25.000000000 -0600
@@ -57,7 +57,7 @@
 	$p = new blog\Post;
 	$p->author = User::val ('name');
 	$p->ts = gmdate ('Y-m-d H:i:s');
-	$p->yes_no = array ('yes' => __ ('Yes'), 'no' => __ ('No'));
+	$p->yes_no = array ('yes' => __ ('Yes'), 'no' => __ ('No'), 'que' => __ ('Scheduled'));
 	$p->autopost_pom = 'yes';
 
 	$p->failed = $f->failed;
@@ -80,5 +80,3 @@
 	echo $tpl->render ('blog/add/head', $p);
 	echo $tpl->render ('blog/add', $p);
 }
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/handlers/admin.php elefant-elefant_1_3_10_beta/apps/blog/handlers/admin.php
--- elefant-elefant_1_3_9_beta/apps/blog/handlers/admin.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/handlers/admin.php	2014-12-03 23:59:25.000000000 -0600
@@ -13,16 +13,44 @@
 $limit = 20;
 $num = isset ($_GET['offset']) ? $_GET['offset'] : 1;
 $offset = ($num - 1) * $limit;
+$q = isset ($_GET['q']) ? $_GET['q'] : ''; // search query
+$q_fields = array ('title', 'author', 'tags', 'body');
+$q_exact = array ('author', 'published');
+$m = isset ($_GET['m']) ? $_GET['m'] : ''; // month query
+$url = '/blog/admin?q=' . urlencode ($q) . '&m=' . urlencode ($m) . '&offset=%d';
 
 $lock = new Lock ();
 
-$posts = blog\Post::query ('id, title, ts, author, published')
+// adds yyyy-mm range to query, called via closure
+function blog_admin_where_month ($q, $m) {
+	if (preg_match ('/^[0-9]{4}-[0-9]{2}$/', $m)) {
+		$start = $m . '-01 00:00:00';
+		$end = $m . '-' . gmdate ('t', strtotime ($start)) . ' 23:59:59';
+		$q->where ('ts >= ?', $start);
+		$q->and_where ('ts <= ?', $end);
+	} else {
+		$q->where ('1 = 1');
+	}
+}
+
+$posts = blog\Post::query ('id, title, ts, author, published, tags')
+	->where_search ($q, $q_fields, $q_exact)
+	->and_where (function ($q) use ($m) {
+		blog_admin_where_month ($q, $m);
+	})
 	->order ('ts desc')
 	->fetch_orig ($limit, $offset);
-$count = blog\Post::query ()->count ();
+
+$count = blog\Post::query ()
+	->where_search ($q, $q_fields, $q_exact)
+	->and_where (function ($q) use ($m) {
+		blog_admin_where_month ($q, $m);
+	})
+	->count ();
 
 foreach ($posts as $k => $p) {
 	$posts[$k]->locked = $lock->exists ('Blog', $p->id);
+	$posts[$k]->tags = preg_split ('/, ?/', $posts[$k]->tags);
 }
 
 $page->title = __ ('Blog Posts');
@@ -31,7 +59,9 @@
 	'total' => $count,
 	'posts' => $posts,
 	'count' => count ($posts),
-	'url' => '/blog/admin?offset=%d'
+	'url' => $url,
+	'q' => $q,
+	'm' => $m,
+	'archives' => blog\Post::archive_months (false),
+	'months' => explode (' ', __ ('Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec'))
 ));
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/handlers/archive.php elefant-elefant_1_3_10_beta/apps/blog/handlers/archive.php
--- elefant-elefant_1_3_9_beta/apps/blog/handlers/archive.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/handlers/archive.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,64 @@
+<?php
+
+/**
+ * Displays a month of blog posts from the archive.
+ */
+
+$page->id = 'blog';
+$page->layout = $appconf['Blog']['layout'];
+
+require_once ('apps/blog/lib/Filters.php');
+
+$preview_chars = (int) Appconf::blog('Blog', 'preview_chars') ? (int) Appconf::blog('Blog', 'preview_chars') : false;
+
+if (! isset ($this->params[1])) {
+	$this->redirect ('/blog');
+}
+$page->limit = 10;
+$year = urldecode ($this->params[0]);
+$month = urldecode ($this->params[1]);
+$page->num = (count ($this->params) > 2 && is_numeric ($this->params[2])) ? $this->params[2] - 1 : 0;
+$page->offset = $page->num * $page->limit;
+
+$p = new blog\Post;
+$posts = $p->archive ($year, $month, $page->limit, $page->offset);
+$page->count = $p->count_by_month ($year, $month, $page->limit, $page->offset);
+$page->last = $page->offset + count ($posts);
+$page->more = ($page->count > $page->last) ? true : false;
+$page->next = $page->num + 2;
+$page->year = $year;
+$page->month = str_pad ($month, 2, '0', STR_PAD_LEFT);
+
+if (Appconf::blog ('Blog', 'post_format') === 'markdown') {
+	require_once ('apps/blog/lib/markdown.php');
+}
+
+foreach ($posts as $post) {
+	$post->url = '/blog/post/' . $post->id . '/' . URLify::filter ($post->title);
+	$post->tag_list = (strlen ($post->tags) > 0) ? explode (',', $post->tags) : array ();
+	$post->social_buttons = $appconf['Social Buttons'];
+	if (Appconf::blog ('Blog', 'post_format') === 'html') {
+		$post->body = $tpl->run_includes ($post->body);
+	} else {
+		$post->body = $tpl->run_includes (Markdown ($post->body));
+	}
+	if ($preview_chars) {
+		$post->body = blog_filter_truncate ($post->body, $preview_chars)
+			. ' <a href="' . $post->url . '">' . __ ('Read more') . '</a>';
+	}
+	echo $tpl->render ('blog/post', $post);
+}
+
+$months = explode (
+	' ',
+	__ ('January February March April May June July August September October November December')
+);
+
+$page->title = $months[$month - 1] . ' ' . $tpl->sanitize ($year);
+
+$page->add_script (sprintf (
+	'<link rel="alternate" type="application/rss+xml" href="http://%s/blog/rss" />',
+	$_SERVER['HTTP_HOST']
+));
+
+echo $tpl->render ('blog/archive', $page);
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/handlers/archives.php elefant-elefant_1_3_10_beta/apps/blog/handlers/archives.php
--- elefant-elefant_1_3_9_beta/apps/blog/handlers/archives.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/handlers/archives.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,18 @@
+<?php
+
+$this->cache = 3600;
+
+$res = blog\Post::archive_months ();
+
+$months = explode (
+	' ',
+	__ ('January February March April May June July August September October November December')
+);
+
+echo $tpl->render (
+	'blog/archives',
+	array (
+		'months' => $months,
+		'archives' => $res
+	)
+);
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/handlers/bgsave.php elefant-elefant_1_3_10_beta/apps/blog/handlers/bgsave.php
--- elefant-elefant_1_3_9_beta/apps/blog/handlers/bgsave.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/handlers/bgsave.php	2014-12-03 23:59:25.000000000 -0600
@@ -47,5 +47,3 @@
 }
 
 echo json_encode ($res);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/handlers/by.php elefant-elefant_1_3_10_beta/apps/blog/handlers/by.php
--- elefant-elefant_1_3_9_beta/apps/blog/handlers/by.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/handlers/by.php	2014-12-03 23:59:25.000000000 -0600
@@ -54,5 +54,3 @@
 ));
 
 echo $tpl->render ('blog/by', $page);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/handlers/bymonth.php elefant-elefant_1_3_10_beta/apps/blog/handlers/bymonth.php
--- elefant-elefant_1_3_9_beta/apps/blog/handlers/bymonth.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/handlers/bymonth.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,39 @@
+<?php
+
+/**
+ * Displays the latest blog posts as a bulleted list of links,
+ * with headers grouping posts by month, e.g., "April 2014".
+ *
+ * Parameters:
+ *
+ * - `tag`: Show posts by this tag only (optional)
+ */
+
+if (! $this->internal) {
+	$page->id = 'blog';
+	$page->layout = $appconf['Blog']['layout'];
+	$page->title = __ ('Latest Posts');
+}
+
+require_once ('apps/blog/lib/Filters.php');
+
+$p = new blog\Post;
+if (isset ($data['tag']) && $data['tag'] !== '') {
+	$posts = $p->tagged ($data['tag']);
+} else {
+	$posts = $p->headlines ();
+}
+
+$bymonth = array ();
+foreach ($posts as $post) {
+	$time = strtotime ($post->ts);
+	$mmyy = __ (gmdate ('F')) . ' ' . gmdate ('Y');
+	if (! is_array ($bymonth[$mmyy])) {
+		$bymonth[$mmyy] = array ();
+	}
+	$bymonth[$mmyy][] = $post;
+}
+
+echo $tpl->render ('blog/bymonth', array (
+	'posts' => $bymonth
+));
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/handlers/commentcount.php elefant-elefant_1_3_10_beta/apps/blog/handlers/commentcount.php
--- elefant-elefant_1_3_9_beta/apps/blog/handlers/commentcount.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/handlers/commentcount.php	2014-12-03 23:59:25.000000000 -0600
@@ -33,5 +33,3 @@
 		}
 		break;
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/handlers/delete.php elefant-elefant_1_3_10_beta/apps/blog/handlers/delete.php
--- elefant-elefant_1_3_9_beta/apps/blog/handlers/delete.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/handlers/delete.php	2014-12-03 23:59:25.000000000 -0600
@@ -43,5 +43,3 @@
 $this->hook ('blog/delete', $_POST);
 $this->add_notification (__ ('Blog post deleted.'));
 $this->redirect ('/blog/admin');
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/handlers/disqus/commentcount.php elefant-elefant_1_3_10_beta/apps/blog/handlers/disqus/commentcount.php
--- elefant-elefant_1_3_9_beta/apps/blog/handlers/disqus/commentcount.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/handlers/disqus/commentcount.php	2014-12-03 23:59:25.000000000 -0600
@@ -17,5 +17,3 @@
 	$data['id'],
 	__ ('comments')
 );
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/handlers/disqus/comments.php elefant-elefant_1_3_10_beta/apps/blog/handlers/disqus/comments.php
--- elefant-elefant_1_3_9_beta/apps/blog/handlers/disqus/comments.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/handlers/disqus/comments.php	2014-12-03 23:59:25.000000000 -0600
@@ -10,5 +10,3 @@
 	'permalink' => $data['url'],
 	'title' => $data['title']
 ));
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/handlers/edit.php elefant-elefant_1_3_10_beta/apps/blog/handlers/edit.php
--- elefant-elefant_1_3_9_beta/apps/blog/handlers/edit.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/handlers/edit.php	2014-12-03 23:59:25.000000000 -0600
@@ -37,6 +37,7 @@
 	$p->published = $_POST['published'];
 	$p->body = $_POST['body'];
 	$p->tags = $_POST['tags'];
+	$p->thumbnail = $_POST['thumbnail'];
 
 	$p->update_extended ();
 
@@ -81,7 +82,7 @@
 	$page->title = __ ('An Error Occurred');
 	echo __ ('Error Message') . ': ' . $p->error;
 } else {
-	$p->yes_no = array ('yes' => __ ('Yes'), 'no' => __ ('No'));
+	$p->yes_no = array ('yes' => __ ('Yes'), 'no' => __ ('No'), 'que' => __ ('Scheduled'));
 	$p->autopost_pom = 'yes';
 	$p->tag_list = explode (',', $p->tags);
 
@@ -104,5 +105,3 @@
 	echo $tpl->render ('blog/edit/head', $p);
 	echo $tpl->render ('blog/edit', $p);
 }
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/handlers/headlines.php elefant-elefant_1_3_10_beta/apps/blog/handlers/headlines.php
--- elefant-elefant_1_3_9_beta/apps/blog/handlers/headlines.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/handlers/headlines.php	2014-12-03 23:59:25.000000000 -0600
@@ -5,6 +5,7 @@
  *
  * Parameters:
  *
+ * - `limit`: Number of posts to show (default=10)
  * - `tag`: Show posts by this tag only (optional)
  * - `dates`: Show post dates (yes, no, default=no)
  */
@@ -17,16 +18,16 @@
 
 require_once ('apps/blog/lib/Filters.php');
 
+$limit = isset ($data['limit']) ? $data['limit'] : 10;
+
 $p = new blog\Post;
 if (isset ($data['tag']) && $data['tag'] !== '') {
 	$posts = $p->tagged ($data['tag']);
 } else {
-	$posts = $p->headlines ();
+	$posts = $p->headlines ($limit);
 }
 $dates = (isset ($data['dates']) && $data['dates'] === 'yes') ? true : false;
 echo $tpl->render ('blog/headlines', array (
 	'posts' => $posts,
 	'dates' => $dates
 ));
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/handlers/import/blogger.php elefant-elefant_1_3_10_beta/apps/blog/handlers/import/blogger.php
--- elefant-elefant_1_3_9_beta/apps/blog/handlers/import/blogger.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/handlers/import/blogger.php	2014-12-03 23:59:25.000000000 -0600
@@ -64,5 +64,3 @@
 $o = new StdClass;
 
 echo $tpl->render ('blog/import/blogger', $o);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/handlers/import/csv.php elefant-elefant_1_3_10_beta/apps/blog/handlers/import/csv.php
--- elefant-elefant_1_3_9_beta/apps/blog/handlers/import/csv.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/handlers/import/csv.php	2014-12-03 23:59:25.000000000 -0600
@@ -44,5 +44,3 @@
 $o = new StdClass;
 
 echo $tpl->render ('blog/import/csv', $o);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/handlers/import/csv2.php elefant-elefant_1_3_10_beta/apps/blog/handlers/import/csv2.php
--- elefant-elefant_1_3_9_beta/apps/blog/handlers/import/csv2.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/handlers/import/csv2.php	2014-12-03 23:59:25.000000000 -0600
@@ -62,5 +62,3 @@
 
 echo '<p>' . __ ('Imported %d posts.', $imported) . '</p>';
 echo '<p><a href="/blog/admin">' . __ ('Continue') . '</a></p>';
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/handlers/import/wordpress.php elefant-elefant_1_3_10_beta/apps/blog/handlers/import/wordpress.php
--- elefant-elefant_1_3_9_beta/apps/blog/handlers/import/wordpress.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/handlers/import/wordpress.php	2014-12-03 23:59:25.000000000 -0600
@@ -12,6 +12,22 @@
 $f = new Form ('post');
 
 if ($f->submit ()) {
+	set_time_limit (0);
+	if (! is_dir ('files/imported')) {
+		mkdir ('files/imported', 0777);
+	}
+	
+	// download files from external site into files/imported
+	function blog_import_wordpress_fix_links ($matches) {
+		$url = trim ($matches[0], '"');
+		$file = 'files/imported/' . str_replace ('/', '-', $matches[1]);
+		if (! file_exists ($file)) {
+			file_put_contents ($file, fetch_url ($url));
+			chmod ($file, 0666);
+		}
+		return '"/' . $file . '"';
+	}
+
 	if (move_uploaded_file ($_FILES['import_file']['tmp_name'], 'cache/blog_' . $_FILES['import_file']['name'])) {
 		$file = 'cache/blog_' . $_FILES['import_file']['name'];
 		
@@ -23,12 +39,22 @@
 			foreach ($posts->channel->item as $entry) {
 				$dc = $entry->children ('http://purl.org/dc/elements/1.1/');
 				$content = $entry->children ('http://purl.org/rss/1.0/modules/content/');
+				$wp = $entry->children ('http://wordpress.org/export/1.2/');
+				$published = $wp->status == 'publish' ? 'yes' : 'no';
+
+				$body = str_replace ("\n", "<br />\n", (string) $content->encoded);
+				$body = preg_replace_callback (
+					'|"https?://[^"]+?/wp-content/uploads/([^"]+)?"|i',
+					'blog_import_wordpress_fix_links',
+					$body
+				);
+
 				$post = array (
 					'title' => (string) $entry->title,
 					'author' => (string) $dc->creator,
 					'ts' => gmdate ('Y-m-d H:i:s', strtotime ($entry->pubDate)),
-					'published' => $_POST['published'],
-					'body' => str_replace ("\n", "<br />\n", (string) $content->encoded),
+					'published' => $published,
+					'body' => $body,
 					'tags' => ''
 				);
 				$sep = '';
@@ -39,6 +65,21 @@
 				$p = new blog\Post ($post);
 				if ($p->put ()) {
 					Versions::add ($p);
+
+					// add tags
+					if ($published == 'yes' && ! empty ($post['tags'])) {
+						$tags = explode (',', $post['tags']);
+						foreach ($tags as $tag) {
+							$tr = trim ($tag);
+							DB::execute ('insert into #prefix#blog_tag (id) values (?)', $tr);
+							DB::execute (
+								'insert into #prefix#blog_post_tag (tag_id, post_id) values (?, ?)',
+								$tr,
+								$p->id
+							);
+						}
+					}
+
 					$imported++;
 				}
 			}
@@ -58,5 +99,3 @@
 $o = new StdClass;
 
 echo $tpl->render ('blog/import/wordpress', $o);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/handlers/import.php elefant-elefant_1_3_10_beta/apps/blog/handlers/import.php
--- elefant-elefant_1_3_9_beta/apps/blog/handlers/import.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/handlers/import.php	2014-12-03 23:59:25.000000000 -0600
@@ -11,5 +11,3 @@
 $page->title = __ ('Choose an importer');
 
 echo $tpl->render ('blog/import');
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/handlers/index.php elefant-elefant_1_3_10_beta/apps/blog/handlers/index.php
--- elefant-elefant_1_3_9_beta/apps/blog/handlers/index.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/handlers/index.php	2014-12-03 23:59:25.000000000 -0600
@@ -58,7 +58,7 @@
 }
 
 if (! $this->internal) {
-	$page->title = Appconf::blog ('Blog', 'title');
+	$page->window_title = Appconf::blog ('Blog', 'title');
 }
 
 $page->add_script (sprintf (
@@ -67,5 +67,3 @@
 ));
 
 echo $tpl->render ('blog/index', $page);
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/handlers/post.php elefant-elefant_1_3_10_beta/apps/blog/handlers/post.php
--- elefant-elefant_1_3_9_beta/apps/blog/handlers/post.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/handlers/post.php	2014-12-03 23:59:25.000000000 -0600
@@ -16,11 +16,22 @@
 $p = new blog\Post ($this->params[0]);
 
 // post not found
-if($p->error){
-        return $this->error(404, __('Post not found'), '<p>' . __('Hmm, we can\'t seem to find the post you wanted at the moment.') . '</p>');
+if ($p->error || $p->published === 'no') {
+    return $this->error (404, __ ('Post not found'), '<p>' . __ ('Hmm, we can\'t seem to find the post you wanted at the moment.') . '</p>');
 }
 
-$page->title = Appconf::blog ('Blog', 'title');
+// published if it was scheduled and it's time
+if ($p->published === 'que') {
+	if ($p->ts <= gmdate ('Y-m-d H:i:s')) {
+		$p->published = 'yes';
+		$p->put ();
+		Versions::add ($p);
+	} else {
+	    return $this->error (404, __ ('Post not found'), '<p>' . __ ('Hmm, we can\'t seem to find the post you wanted at the moment.') . '</p>');
+	}
+}
+
+$page->title = $p->title;
 
 $post = $p->orig ();
 $post->full = true;
@@ -33,6 +44,7 @@
 	$post->body = $tpl->run_includes (Markdown ($post->body));
 }
 $post->social_buttons = Appconf::blog ('Social Buttons');
+$post->related = Appconf::blog ('Blog', 'show_related_posts');
 
 echo $tpl->render ('blog/post', $post);
 
@@ -55,9 +67,19 @@
 		break;
 }
 
+// add rss discovery
 $page->add_script (sprintf (
 	'<link rel="alternate" type="application/rss+xml" href="http://%s/blog/rss" />',
 	$_SERVER['HTTP_HOST']
 ));
 
-?>
+// add opengraph meta tags
+$page->add_meta ('og:title', $post->title, 'property');
+
+if ($post->thumbnail !== '') {
+	$page->add_meta (
+		'og:image',
+		'//'. $_SERVER['HTTP_HOST'] . $post->thumbnail,
+		'property'
+	);
+}
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/handlers/postsfeed.php elefant-elefant_1_3_10_beta/apps/blog/handlers/postsfeed.php
--- elefant-elefant_1_3_9_beta/apps/blog/handlers/postsfeed.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/handlers/postsfeed.php	2014-12-03 23:59:25.000000000 -0600
@@ -5,15 +5,19 @@
 $preview_chars = (int) Appconf::blog('Blog', 'preview_chars') ? (int) Appconf::blog('Blog', 'preview_chars') : false;
 
 if ($data['number'] !== '') {
-    $page->limit = $data['number'];
+    $limit = $data['number'];
 } else {
-    $page->limit = 5;
+    $limit = 5;
 }
 
-$page->offset = 0;
+$offset = 0;
 
 $p = new blog\Post;
-$posts = $p->latest ($page->limit, $page->offset);
+if (isset ($data['tag']) && $data['tag'] !== '') {
+	$posts = $p->tagged ($data['tag'], $limit, $offset);
+} else {
+	$posts = $p->latest ($limit, $offset);
+}
 $page->count = $p->query ()->where ('published', 'yes')->count ();
 
 if (Appconf::blog ('Blog', 'post_format') === 'markdown') {
@@ -46,5 +50,3 @@
 		echo $tpl->render ('blog/post', $post);
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/handlers/preview.php elefant-elefant_1_3_10_beta/apps/blog/handlers/preview.php
--- elefant-elefant_1_3_9_beta/apps/blog/handlers/preview.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/handlers/preview.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,48 @@
+<?php
+
+/**
+ * Creates a preview of a web page based on POST data sent to it.
+ * POST data must match values available to the Page object.
+ */
+
+$this->require_admin ();
+
+$post = new blog\Post ($_POST);
+
+$page->id = 'blog';
+$page->title = Appconf::blog ('Blog', 'title');
+$page->layout = Appconf::blog ('Blog', 'post_layout');
+
+if (Appconf::blog ('Blog', 'post_format') === 'html') {
+	$post->body = $tpl->run_includes ($post->body);
+} else {
+	require_once ('apps/blog/lib/markdown.php');
+	$post->body = $tpl->run_includes (Markdown ($post->body));
+}
+$post->social_buttons = Appconf::blog ('Social Buttons');
+
+echo $tpl->render ('blog/post', $post);
+
+switch (Appconf::blog ('Blog', 'comments')) {
+	case 'disqus':
+		echo $this->run ('blog/disqus/comments', $post);
+		break;
+	case 'facebook':
+		echo $this->run ('social/facebook/comments', $post);
+		break;
+	default:
+		if (Appconf::blog ('Blog', 'comments') != false) {
+			echo $this->run (
+				Appconf::blog ('Blog', 'comments'),
+				array (
+					'identifier' => $post->url
+				)
+			);
+		}
+		break;
+}
+
+$page->add_script (sprintf (
+	'<link rel="alternate" type="application/rss+xml" href="http://%s/blog/rss" />',
+	$_SERVER['HTTP_HOST']
+));
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/handlers/publish-queue.php elefant-elefant_1_3_10_beta/apps/blog/handlers/publish-queue.php
--- elefant-elefant_1_3_9_beta/apps/blog/handlers/publish-queue.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/handlers/publish-queue.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,24 @@
+<?php
+
+/**
+ * Publish scheduled blog posts. Use via cron like this:
+ *
+ *     0,15,30,45 * * * * /var/www/elefant blog/publish-queue
+ */
+
+if (! $this->cli) die ('Must be run from the command line.');
+
+$page->layout = false;
+
+// fetch queued posts
+$posts = blog\Post::query ()
+	->where ('published', 'que')
+	->where ('ts <= ?', gmdate ('Y-m-d H:i:s'))
+	->fetch ();
+
+// publish posts
+foreach ($posts as $post) {
+	$post->published = 'yes';
+	$post->put ();
+	Versions::add ($post);
+}
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/handlers/related.php elefant-elefant_1_3_10_beta/apps/blog/handlers/related.php
--- elefant-elefant_1_3_9_beta/apps/blog/handlers/related.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/handlers/related.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,34 @@
+<?php
+
+/**
+ * Show related posts. Called internally by blog/post.
+ */
+
+$id = $data['id'];
+$tags = explode (',', $data['tags']);
+
+$posts = blog\Post::query ('id, thumbnail, title, ts')
+	->where ('published', 'yes')
+	->where ('id != ?', $id)
+	->and_where (function ($q) use ($tags) {
+		foreach ($tags as $n => $tag) {
+			$tag = trim ($tag);
+			if ($n === 0) {
+				$q->where ('tags like ?', '%' . $tag . '%');
+			} else {
+				$q->or_where ('tags like ?', '%' . $tag . '%');
+			}
+		}
+	})
+	->order ('ts', 'desc')
+	->fetch_orig (3);
+
+$this->run ('admin/util/minimal-grid');
+$page->add_script ('/apps/blog/css/related.css');
+
+echo $tpl->render (
+	'blog/related',
+	array (
+		'posts' => $posts
+	)
+);
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/handlers/rss.php elefant-elefant_1_3_10_beta/apps/blog/handlers/rss.php
--- elefant-elefant_1_3_9_beta/apps/blog/handlers/rss.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/handlers/rss.php	2014-12-03 23:59:25.000000000 -0600
@@ -38,5 +38,3 @@
 $page->layout = FALSE;
 header ('Content-Type: text/xml');
 echo $res;
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/handlers/rssviewer.php elefant-elefant_1_3_10_beta/apps/blog/handlers/rssviewer.php
--- elefant-elefant_1_3_9_beta/apps/blog/handlers/rssviewer.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/handlers/rssviewer.php	2014-12-03 23:59:25.000000000 -0600
@@ -26,5 +26,3 @@
 }
 
 echo $tpl->render ('blog/rssviewer', array ('items' => $items));
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/handlers/settings.php elefant-elefant_1_3_10_beta/apps/blog/handlers/settings.php
--- elefant-elefant_1_3_9_beta/apps/blog/handlers/settings.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/handlers/settings.php	2014-12-03 23:59:25.000000000 -0600
@@ -6,8 +6,6 @@
 
 $this->require_admin ();
 
-require_once ('apps/admin/lib/Functions.php');
-
 $page->layout = 'admin';
 $page->title = __ ('Blog Settings');
 
@@ -15,12 +13,12 @@
 
 $form->data = array (
 	'title' => $appconf['Blog']['title'],
-	'layouts' => admin_get_layouts (),
 	'layout' => $appconf['Blog']['layout'],
 	'post_layout' => $appconf['Blog']['post_layout'],
 	'comments' => $appconf['Blog']['comments'],
 	'preview_chars' => $appconf['Blog']['preview_chars'],
 	'post_format' => $appconf['Blog']['post_format'],
+	'show_related_posts' => $appconf['Blog']['show_related_posts'],
 	'disqus_shortname' => $appconf['Blog']['disqus_shortname'],
 	'social_twitter' => $appconf['Social Buttons']['twitter'],
 	'social_facebook' => $appconf['Social Buttons']['facebook'],
@@ -36,6 +34,7 @@
 			'preview_chars' => (! empty ($_POST['preview_chars'])) ? (int) $_POST['preview_chars'] : false,
 			'post_format' => $_POST['post_format'],
 			'comments' => ($_POST['comments'] === 'none') ? false : $_POST['comments'],
+			'show_related_posts' => ($_POST['show_related_posts'] === 'yes') ? true : false,
 			'disqus_shortname' => $_POST['disqus_shortname']
 		),
 		'Social Buttons' => array (
@@ -62,5 +61,3 @@
 	$form->controller->add_notification (__ ('Settings saved.'));
 	$form->controller->redirect ('/blog/admin');
 });
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/handlers/tag.php elefant-elefant_1_3_10_beta/apps/blog/handlers/tag.php
--- elefant-elefant_1_3_9_beta/apps/blog/handlers/tag.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/handlers/tag.php	2014-12-03 23:59:25.000000000 -0600
@@ -54,5 +54,3 @@
 ));
 
 echo $tpl->render ('blog/tag', $page);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/handlers/taglist.php elefant-elefant_1_3_10_beta/apps/blog/handlers/taglist.php
--- elefant-elefant_1_3_9_beta/apps/blog/handlers/taglist.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/handlers/taglist.php	2014-12-03 23:59:25.000000000 -0600
@@ -13,5 +13,3 @@
 		'select distinct tag_id from #prefix#blog_post_tag'
 	)
 );
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/handlers/tags.php elefant-elefant_1_3_10_beta/apps/blog/handlers/tags.php
--- elefant-elefant_1_3_9_beta/apps/blog/handlers/tags.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/handlers/tags.php	2014-12-03 23:59:25.000000000 -0600
@@ -22,5 +22,3 @@
 	'<link rel="alternate" type="application/rss+xml" href="http://%s/blog/rss" />',
 	$_SERVER['HTTP_HOST']
 ));
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/handlers/upgrade.php elefant-elefant_1_3_10_beta/apps/blog/handlers/upgrade.php
--- elefant-elefant_1_3_9_beta/apps/blog/handlers/upgrade.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/handlers/upgrade.php	2014-12-03 23:59:25.000000000 -0600
@@ -1,30 +1,66 @@
 <?php
 
-$page->layout = 'admin';
+// keep unauthorized users out
+$this->require_acl ('admin', $this->app);
 
-$this->require_admin ();
+// set the layout
+$page->layout = 'admin';
 
-if ($this->installed ('blog', $appconf['Admin']['version']) === true) {
-	$page->title = __ ('Upgrade completed');
-	echo '<p><a href="/blog/admin">' . __ ('Continue') . '</a></p>';
-	return;
+// get the version and check if the app installed
+$version = Appconf::get ($this->app, 'Admin', 'version');
+$current = $this->installed ($this->app, $version);
+
+if ($current === true) {
+    // app is already installed and up-to-date, stop here
+    $page->title = __ ('Already up-to-date');
+    printf ('<p><a href="/%s/admin">%s</a>', $this->app, __ ('Home'));
+    return;
 }
 
-$page->title = __ ('Upgrading Blog App');
+$page->title = sprintf (
+    '%s: %s',
+    __ ('Upgrading App'),
+    Appconf::get ($this->app, 'Admin', 'name')
+);
+
+// grab the database driver
+$conn = conf ('Database', 'master');
+$driver = $conn['driver'];
+
+// check if upgrade script exists and if so, run it
+$base_version = preg_replace ('/-.*$/', '', $version);
+$file = 'apps/' . $this->app . '/conf/upgrade_' . $base_version . '_' . $driver . '.sql';
+if (file_exists ($file)) {
+    // begin the transaction
+    DB::beginTransaction ();
+
+    // parse the database schema into individual queries
+    $sql = sql_split (file_get_contents ($file));
+
+    // execute each query in turn
+    foreach ($sql as $query) {
+        if (! DB::execute ($query)) {
+            // show error and rollback on failures
+            printf (
+                '<p class="visible-notice">%s: %s</p><p>%s</p>',
+                __ ('Error'),
+                DB::error (),
+                __ ('Install failed.')
+            );
+            DB::rollback ();
+            return;
+        }
+    }
 
-$db = DB::get_connection (1);
-$dbtype = $db->getAttribute (PDO::ATTR_DRIVER_NAME);
-switch ($dbtype) {
-	case 'pgsql':
-	case 'mysql':
-		DB::execute ('alter table #prefix#blog_post add column extra text not null default \'\'');
-		break;
-	case 'sqlite':
-		DB::execute ('alter table #prefix#blog_post add column "extra" "text not null"');
-		break;
+    // commit the transaction
+    DB::commit ();
 }
-echo '<p>' . __ ('Done.') . '</p>';
 
-$this->mark_installed ('blog', $appconf['Admin']['version']);
+// add your upgrade logic here
+
+// mark the new version installed
+$this->mark_installed ($this->app, $version);
+
+printf ('<p><a href="/%s/admin">%s</a></p>', $this->app, __ ('Done.'));
 
 ?>
\ No newline at end of file
Files elefant-elefant_1_3_9_beta/apps/blog/js/autocomplete.js and elefant-elefant_1_3_10_beta/apps/blog/js/autocomplete.js are identical
Files elefant-elefant_1_3_9_beta/apps/blog/js/jquery.timepicker.js and elefant-elefant_1_3_10_beta/apps/blog/js/jquery.timepicker.js are identical
Files elefant-elefant_1_3_9_beta/apps/blog/js/tag-it.js and elefant-elefant_1_3_10_beta/apps/blog/js/tag-it.js are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/lib/Bitly.php elefant-elefant_1_3_10_beta/apps/blog/lib/Bitly.php
--- elefant-elefant_1_3_9_beta/apps/blog/lib/Bitly.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/lib/Bitly.php	2014-12-03 23:59:25.000000000 -0600
@@ -59,5 +59,3 @@
 		return $obj['data']['url'];
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/lib/CsvParser.php elefant-elefant_1_3_10_beta/apps/blog/lib/CsvParser.php
--- elefant-elefant_1_3_9_beta/apps/blog/lib/CsvParser.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/lib/CsvParser.php	2014-12-03 23:59:25.000000000 -0600
@@ -74,35 +74,36 @@
 	public static function parse_line ($str) {
 		$tmp = explode (self::$delimiter, $str);
 		$fields = array ();
+		$field = 0;
+		$is_split = false;
 
 		$last = count ($tmp) - 1;
 		for ($i = 0; $i <= $last; $i++) {
-			if ($i > $last) {
-				break;
-
-			} elseif (strpos ($tmp[$i], '"') === false) {
-				// ordinary field, no quotes
-				$fields[] = $tmp[$i];
-
-			} elseif (strpos ($tmp[$i], '"') === 0 && substr ($tmp[$i], -1, 1) === '"') {
+			if (strpos ($tmp[$i], '"') === 0 && substr ($tmp[$i], -1) === '"') {
 				// remove escaped and outer quotes
 				$tmp[$i] = str_replace ('""', '"', $tmp[$i]);
-				$fields[] = substr ($tmp[$i], 1, -1);
+				$fields[$field] = substr ($tmp[$i], 1, -1);
+				$field++;
+				$is_split = false;
 
-			} elseif ($i < $last && substr ($tmp[$i + 1], -1, 1) === '"') {
-				// field was split with an inner delimiter
-				$fields[] = substr ($tmp[$i], 1) . self::$delimiter . substr ($tmp[$i + 1], 0, -1);
+			} elseif (strpos ($tmp[$i], '"') === 0) {
+				// start of quoted field, but split by comma
+				$tmp[$i] = str_replace ('""', '"', $tmp[$i]);
+				$fields[$field] = substr ($tmp[$i], 1);
+				$is_split = true;
 
-				// remove escaped quotes
-				$fields[count ($fields) - 1] = str_replace ('""', '"', $fields[count ($fields) - 1]);
-				$i++;
+			} elseif (substr ($tmp[$i], -1, 1) === '"') {
+				// end of quoted field, but split by comma
+				$tmp[$i] = str_replace ('""', '"', $tmp[$i]);
+				$fields[$field] .= self::$delimiter . substr ($tmp[$i], 0, -1);
+				$fields++;
+				$is_split = false;
 
 			} else {
-				return false;
+				$fields[$field] = $is_split ? $fields[$field] . self::$delimiter . $tmp[$i] : $tmp[$i];
+				$field = $is_split ? $field : $field + 1;
 			}
 		}
 		return $fields;
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/lib/Filters.php elefant-elefant_1_3_10_beta/apps/blog/lib/Filters.php
--- elefant-elefant_1_3_9_beta/apps/blog/lib/Filters.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/lib/Filters.php	2014-12-03 23:59:25.000000000 -0600
@@ -46,6 +46,18 @@
 }
 
 /**
+ * Filter published yes/no/que to text.
+ */
+function blog_filter_published ($p) {
+	if ($p === 'yes') {
+		return __ ('Published');
+	} elseif ($p === 'no') {
+		return __ ('Draft');
+	}
+	return __ ('Scheduled');
+}
+
+/**
 * Truncates text.
 *
 * Cuts a string to the length of $length and replaces the last characters
@@ -61,7 +73,7 @@
 * @param boolean $considerHtml If true, HTML tags would be handled correctly
 * @return string Trimmed string.
 */
-function blog_filter_truncate($text, $length = 100, $ending = '…', $exact = true, $considerHtml = true) {
+function blog_filter_truncate ($text, $length = 100, $ending = '…', $exact = true, $considerHtml = true) {
         if($considerHtml){
                 // if the plain text is shorter than the maximum length, return the whole text
                 if(strlen(preg_replace('/<.*?>/', '', $text)) <= $length){
@@ -153,11 +165,9 @@
         if($considerHtml){
                 // close all unclosed html-tags
                 foreach ($open_tags as $tag) {
-                        $truncate .= '';
+                        $truncate .= '</' . $tag . '>';
                 }
         }
 
         return $truncate;
 }
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/lib/Functions.php elefant-elefant_1_3_10_beta/apps/blog/lib/Functions.php
--- elefant-elefant_1_3_9_beta/apps/blog/lib/Functions.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/lib/Functions.php	2014-12-03 23:59:25.000000000 -0600
@@ -23,6 +23,3 @@
 		(object) array ('key' => 'yes', 'value' => __ ('Yes')),
 	);
 }
-		
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/lib/Pingomatic.php elefant-elefant_1_3_10_beta/apps/blog/lib/Pingomatic.php
--- elefant-elefant_1_3_9_beta/apps/blog/lib/Pingomatic.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/lib/Pingomatic.php	2014-12-03 23:59:25.000000000 -0600
@@ -73,5 +73,3 @@
 		return $res;
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/lib/Twitter.php elefant-elefant_1_3_10_beta/apps/blog/lib/Twitter.php
--- elefant-elefant_1_3_9_beta/apps/blog/lib/Twitter.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/lib/Twitter.php	2014-12-03 23:59:25.000000000 -0600
@@ -863,5 +863,3 @@
 	    return $this->objectify( $this->process( $request ) );
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/lib/markdown.php elefant-elefant_1_3_10_beta/apps/blog/lib/markdown.php
--- elefant-elefant_1_3_9_beta/apps/blog/lib/markdown.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/lib/markdown.php	2014-12-03 23:59:25.000000000 -0600
@@ -3047,4 +3047,3 @@
 software, even if advised of the possibility of such damage.
 
 */
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/autoloader.php elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/autoloader.php
--- elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/autoloader.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/autoloader.php	2014-12-03 23:59:25.000000000 -0600
@@ -83,4 +83,4 @@
 		$filename = $this->path . DIRECTORY_SEPARATOR . str_replace('_', DIRECTORY_SEPARATOR, $class) . '.php';
 		include $filename;
 	}
-}
\ No newline at end of file
+}
Files elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/.DS_Store and elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/.DS_Store are identical
Files elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/Author.php and elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/Author.php are identical
Files elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/Cache/Base.php and elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/Cache/Base.php are identical
Files elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/Cache/DB.php and elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/Cache/DB.php are identical
Files elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/Cache/File.php and elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/Cache/File.php are identical
Files elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/Cache/Memcache.php and elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/Cache/Memcache.php are identical
Files elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/Cache/MySQL.php and elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/Cache/MySQL.php are identical
Files elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/Cache.php and elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/Cache.php are identical
Files elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/Caption.php and elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/Caption.php are identical
Files elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/Category.php and elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/Category.php are identical
Files elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/Content/Type/Sniffer.php and elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/Content/Type/Sniffer.php are identical
Files elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/Copyright.php and elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/Copyright.php are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/Core.php elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/Core.php
--- elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/Core.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/Core.php	2014-12-03 23:59:25.000000000 -0600
@@ -54,4 +54,4 @@
 class SimplePie_Core extends SimplePie
 {
 
-}
\ No newline at end of file
+}
Files elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/Credit.php and elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/Credit.php are identical
Files elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/Decode/HTML/Entities.php and elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/Decode/HTML/Entities.php are identical
Files elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/Enclosure.php and elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/Enclosure.php are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/Exception.php elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/Exception.php
--- elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/Exception.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/Exception.php	2014-12-03 23:59:25.000000000 -0600
@@ -49,4 +49,4 @@
  */
 class SimplePie_Exception extends Exception
 {
-}
\ No newline at end of file
+}
Files elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/File.php and elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/File.php are identical
Files elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/HTTP/Parser.php and elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/HTTP/Parser.php are identical
Files elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/IRI.php and elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/IRI.php are identical
Files elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/Item.php and elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/Item.php are identical
Files elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/Locator.php and elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/Locator.php are identical
Files elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/Misc.php and elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/Misc.php are identical
Files elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/Net/IPv6.php and elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/Net/IPv6.php are identical
Files elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/Parse/Date.php and elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/Parse/Date.php are identical
Files elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/Parser.php and elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/Parser.php are identical
Files elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/Rating.php and elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/Rating.php are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/Registry.php elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/Registry.php
--- elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/Registry.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/Registry.php	2014-12-03 23:59:25.000000000 -0600
@@ -222,4 +222,4 @@
 		$result = call_user_func_array(array($class, $method), $parameters);
 		return $result;
 	}
-}
\ No newline at end of file
+}
Files elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/Restriction.php and elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/Restriction.php are identical
Files elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/Sanitize.php and elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/Sanitize.php are identical
Files elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/Source.php and elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/Source.php are identical
Files elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/XML/Declaration/Parser.php and elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/XML/Declaration/Parser.php are identical
Files elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie/gzdecode.php and elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie/gzdecode.php are identical
Files elefant-elefant_1_3_9_beta/apps/blog/lib/simplepie/library/SimplePie.php and elefant-elefant_1_3_10_beta/apps/blog/lib/simplepie/library/SimplePie.php are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/models/Post.php elefant-elefant_1_3_10_beta/apps/blog/models/Post.php
--- elefant-elefant_1_3_9_beta/apps/blog/models/Post.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/models/Post.php	2014-12-03 23:59:25.000000000 -0600
@@ -52,11 +52,33 @@
 	 */
 	public $_extended_field = 'extra';
 
+	public static function _publish_queued ($posts) {
+		foreach (array_keys ($posts) as $k) {
+			if ($posts[$k]->published === 'que') {
+				$posts[$k]->published = 'yes';
+				$posts[$k]->put ();
+				\Versions::add ($posts[$k]);
+			}
+		}
+		return $posts;
+	}
+
 	/**
 	 * Get the most recently published posts.
 	 */
 	public static function latest ($limit = 10, $offset = 0) {
-		return self::query ()->where ('published', 'yes')->order ('ts desc')->fetch_orig ($limit, $offset);
+		$posts = self::query ()
+			->where ('published', 'yes')
+			->or_where (function ($q) {
+				$q->where ('published', 'que');
+				$q->where ('ts <= ?', gmdate ('Y-m-d H:i:s'));
+			})
+			->order ('ts desc')
+			->fetch ($limit, $offset);
+
+		$posts = self::_publish_queued ($posts);
+		
+		return $posts;
 	}
 
 	/**
@@ -90,6 +112,22 @@
 	}
 
 	/**
+	 * Get posts by a certain year and month.
+	 */
+	public static function archive ($year, $month, $limit = 10, $offset = 0) {
+		$ids = \DB::shift_array ('select id from #prefix#blog_post where year(ts) = ? and month(ts) = ? and published = "yes"', $year, $month);
+		return self::query ()->where ('id in(' . join (',', $ids) . ')')->where ('published', 'yes')->order ('ts desc')->fetch_orig ($limit, $offset);
+	}
+
+	/**
+	 * Count posts by a certain year and month.
+	 */
+	public static function count_by_month ($year, $month, $limit = 10, $offset = 0) {
+		$ids = \DB::shift_array ('select id from #prefix#blog_post where year(ts) = ? and month(ts) = ? and published = "yes"', $year, $month);
+		return self::query ()->where ('id in(' . join (',', $ids) . ')')->where ('published', 'yes')->order ('ts desc')->count ();
+	}
+
+	/**
 	 * Get a list of tags and the number of posts they've been used on.
 	 */
 	public static function tags () {
@@ -97,6 +135,51 @@
 	}
 
 	/**
+	 * Get a list of archive years, months, and count of posts.
+	 */
+	public static function archive_months ($published = true) {
+		$db = \DB::get_connection (1);
+		$dbtype = $db->getAttribute (\PDO::ATTR_DRIVER_NAME);
+		$published = $published ? 'where published = "yes"' : '';
+		switch ($dbtype) {
+			case 'pgsql':
+				$res = \DB::fetch (
+					'select extract(year from ts) as year, extract(month from ts) as month, count(*) as total
+					 from #prefix#blog_post
+					 ' . $published . '
+					 group by year, month
+					 order by year desc, month desc'
+				);
+				break;
+			case 'mysql':
+				$res = \DB::fetch (
+					'select year(ts) as year, month(ts) as month, count(*) as total
+					 from #prefix#blog_post
+					 ' . $published . '
+					 group by year, month
+					 order by year desc, month desc'
+				);
+				break;
+			case 'sqlite':
+				$res = \DB::fetch (
+					'select strftime(\'%Y\', ts) as year, strftime(\'%m\', ts) as month, count(*) as total
+					 from #prefix#blog_post
+					 ' . $published . '
+					 group by year, month
+					 order by year desc, month desc'
+				);
+				break;
+		}
+		
+		foreach ($res as $k => $row) {
+			$res[$k]->month = str_pad ($row->month, 2, '0', STR_PAD_LEFT);
+			$res[$k]->date = $row->year . '-' . $res[$k]->month;
+		}
+
+		return $res;
+	}
+
+	/**
 	 * Generate a list of pages for the sitemaps app.
 	 */
 	public static function sitemap () {
@@ -110,6 +193,29 @@
 		}
 		return $urls;
 	}
-}
 
-?>
\ No newline at end of file
+	/**
+	 * Generate a list of posts for the search app,
+	 * and add them directly via `Search::add()`.
+	 */
+	public static function search () {
+		$posts = self::query ()
+			->where ('published', 'yes')
+			->fetch_orig ();
+		
+		foreach ($posts as $i => $post) {
+			$url = 'blog/post/' . $post->id . '/' . \URLify::filter ($post->title);
+			if (! \Search::add (
+				$url,
+				array (
+					'title' => $post->title,
+					'text' => $post->body,
+					'url' => '/' . $url
+				)
+			)) {
+				return array (false, $i);
+			}
+		}
+		return array (true, count ($posts));
+	}
+}
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/views/add/head.html elefant-elefant_1_3_10_beta/apps/blog/views/add/head.html
--- elefant-elefant_1_3_9_beta/apps/blog/views/add/head.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/views/add/head.html	2014-12-03 23:59:25.000000000 -0600
@@ -83,4 +83,16 @@
 	}
 	return false;
 }
+function webpage_preview (f) {
+	var t = f.target,
+		a = f.action;
+
+	f.target = 'elefant-preview';
+	f.action = '/blog/preview';
+	f.submit ();
+
+	f.target = t;
+	f.action = a;
+	return false;
+}
 </script>
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/views/add.html elefant-elefant_1_3_10_beta/apps/blog/views/add.html
--- elefant-elefant_1_3_9_beta/apps/blog/views/add.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/views/add.html	2014-12-03 23:59:25.000000000 -0600
@@ -1,4 +1,5 @@
 {! user/util/userchooser !}
+{! filemanager/util/browser !}
 
 <div class="form">
 
@@ -5,8 +6,17 @@
 <p class="autosave-notice">{"Auto-saved data found for this form."} <a href="#" class="autosave-restore">{"Click here to restore."}</a></p>
 
 <form method="POST" id="add-form">
+
 <p>{"Title"}:<br /><input type="text" name="title" size="80" value="{{ title }}" />
 <span class="notice" id="title-notice">{"You must enter a title."}</span></p>
+
+<div id="thumbnail-div">
+	{"Thumbnail"}:<br />
+	<img src="{% if thumbnail == '' %}//:0{% else %}{{thumbnail|quotes}}{% end %}" id="thumbnail-preview" /><br />
+	<input type="hidden" name="thumbnail" id="thumbnail" size="40" value="{{ thumbnail|quotes }}" />
+	<input type="submit" id="thumbnail-browse" value="{"Choose"}" />
+</div>
+
 <p>{"Author"}:<br /><input type="text" name="author" id="author" size="30" value="{{ author }}" />
 <input type="submit" value="{"Choose"}" id="users" />
 <span class="notice" id="author-notice">{"You must enter an author."}</span></p>
@@ -39,6 +51,7 @@
 
 <p>
 	<input type="submit" value="{"Add Blog Post"}" class="autosave-clear" />&nbsp;
+	<input type="submit" value="{"Preview"}" onclick="return webpage_preview (this.form)" />&nbsp;
 	<a href="javascript:history.go(-1)" onclick="return $.cancel_autosave ('{"Are you sure you want to cancel and lose any changes?"}')">{"Cancel"}</a>
 </p>
 </form>
@@ -46,6 +59,23 @@
 </div>
 <div class="clear"></div>
 
+<style>
+#add-form {
+	position: relative;
+}
+#thumbnail-div {
+	position: absolute;
+	top: 0;
+	right: 0;
+	width: 150px;
+}
+#thumbnail-preview {
+	width: 150px;
+	height: 100px;
+	margin-bottom: 5px;
+}
+</style>
+
 <script>
 $(function () {
 	$('#users').click (function () {
@@ -60,5 +90,18 @@
 		'<a href="http://daringfireball.net/projects/markdown/basics" target="_blank" id="markdown-link">' + $.i18n ('Markdown formatting') + '</a>'
 	);
 	{% end %}
+
+	$('#thumbnail-browse').click (function (e) {
+		e.preventDefault ();
+		$.filebrowser ({
+			allowed: ['jpg', 'jpeg', 'png', 'gif'],
+			set_value: '#thumbnail',
+			title: "{"Choose an image"}",
+			thumbs: true,
+			callback: function (file) {
+				$('#thumbnail-preview').attr ('src', file);
+			}
+		});
+	});
 });
 </script>
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/views/admin.html elefant-elefant_1_3_10_beta/apps/blog/views/admin.html
--- elefant-elefant_1_3_9_beta/apps/blog/views/admin.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/views/admin.html	2014-12-03 23:59:25.000000000 -0600
@@ -1,6 +1,11 @@
+{! admin/util/minimal-grid !}
+{! admin/util/search !}
 {! admin/util/dates !}
 
-<p>
+<form method="get" id="search-form">
+
+<div class="e-row-variable" style="margin-bottom: 20px">
+	<div class="e-col-50 e-no-padding">
 	{% if User::require_acl ('admin/add') %}
 	<a href="/blog/add">{"New Post"}</a>
 	&nbsp;|&nbsp;
@@ -12,34 +17,82 @@
 	&nbsp;|&nbsp;
 	<a href="/admin/extended?extends=blog\Post&name=Blog+Posts">{"Custom Fields"}</a>
 	{% end %}
-</p>
-
-<p style="float: left">
-{! navigation/pager?style=results&url=[url]&total=[total]&count=[count]&limit=[limit] !}
-</p>
+	</div>
+	<div class="e-col-50 e-no-padding" style="text-align: right">
+		<input type="text" name="q" id="search-query" size="40" value="{{q|quotes}}" />
+		<button>{"Search"}</button>
+		{% if q != '' %}
+		<button onclick="window.location.href = '/blog/admin'; return false">{"Clear"}</button>
+		{% end %}
+	</div>
+</div>
 
-{% if total > $data->limit %}
-<div style="float: right">
-{! navigation/pager?style=numbers&url=[url]&total=[total]&count=[count]&limit=[limit] !}
+<div class="e-row-variable infobar">
+	<div class="e-col-50 e-no-padding">
+		{! navigation/pager?style=results&url=[url]&total=[total]&count=[count]&limit=[limit] !}
+	</div>
+	<div class="e-col-50 e-no-padding" style="text-align: right">
+		{% if strpos ($data->q, 'published:yes') !== false %}
+			<strong>{"Published"}</strong>
+			&nbsp;|&nbsp;
+			<a href="#" class="search-for" data-search="published:no">{"Draft"}</a>
+			&nbsp;|&nbsp;
+			<a href="#" class="search-for" data-search="published:que">{"Scheduled"}</a>
+		{% elseif strpos ($data->q, 'published:no') !== false %}
+			<a href="#" class="search-for" data-search="published:yes">{"Published"}</a>
+			&nbsp;|&nbsp;
+			<strong>{"Draft"}</strong>
+			&nbsp;|&nbsp;
+			<a href="#" class="search-for" data-search="published:que">{"Scheduled"}</a>
+		{% elseif strpos ($data->q, 'published:que') !== false %}
+			<a href="#" class="search-for" data-search="published:yes">{"Published"}</a>
+			&nbsp;|&nbsp;
+			<a href="#" class="search-for" data-search="published:no">{"Draft"}</a>
+			&nbsp;|&nbsp;
+			<strong>{"Scheduled"}</strong>
+		{% else %}
+			<a href="#" class="search-for" data-search="published:yes">{"Published"}</a>
+			&nbsp;|&nbsp;
+			<a href="#" class="search-for" data-search="published:no">{"Draft"}</a>
+			&nbsp;|&nbsp;
+			<a href="#" class="search-for" data-search="published:que">{"Scheduled"}</a>
+		{% end %}
+	</div>
 </div>
-{% end %}
 
-<p>
 <table width="100%">
 	<tr>
-		<th width="43%">{"Title"}</th>
-		<th width="20%">{"Date"}</th>
-		<th width="12%">{"Author"}</th>
-		<th width="10%">{"Published"}</th>
-		<th width="15%">&nbsp;</th>
+		<th width="38%">{"Title"}</th>
+		<th width="18%">
+			<select name="m" id="search-month">
+				<option value="">{"All Dates"}</option>
+				{% foreach archives as archive %}
+				<option value="{{archive->date}}"
+					{% if m === $data->archive->date %}selected{% end %}
+				>{{months[$data->archive->month - 1]}} {{archive->year}} ({{archive->total}})</option>
+				{% end %}
+			</select>
+		</th>
+		<th width="14%">{"Author"}</th>
+		<th width="17%">{"Tags"}</td>
+		<th width="13%">&nbsp;</th>
 	</tr>
 {% foreach posts %}
 	<tr>
-		<td><a href="/blog/post/{{ loop_value->id }}/{{ loop_value->title|URLify::filter }}" target="_blank">{{ loop_value->title }}</a></td>
-		<td>{{ loop_value->ts|I18n::date_time }}</td>
-		<td>{{ loop_value->author }}</td>
-		<td>{{ loop_value->published|ucfirst }}</td>
-		<td style="text-align: right">
+		<td class="title">
+			<a href="/blog/post/{{ loop_value->id }}/{{ loop_value->title|URLify::filter }}" target="_blank">{{ loop_value->title }}</a><br />
+		</td>
+		<td>
+			{{ loop_value->ts|I18n::short_date }} -
+			<a href="#" class="search-for" data-search="published:{{ loop_value->published}}">{{ loop_value->published|blog_filter_published }}</a>
+		</td>
+		<td><a href="#" class="search-for" data-search="author:&quot;{{ loop_value->author}}&quot;">{{ loop_value->author }}</a></td>
+		<td class="tags">
+			{% foreach loop_value->tags as _tag %}
+				<a href="#" class="search-for" data-search="{{_tag}}">{{_tag|ucfirst}}</a>
+			{% end %}
+		</td>
+		<td class="edit">
 			{% if loop_value->locked %}
 			{"Editing Locked"}
 			{% else %}
@@ -53,8 +106,35 @@
 	</tr>
 {% end %}
 </table>
-</p>
+
+</form>
 
 {% if total > $data->limit %}
 {! navigation/pager?style=numbers&url=[url]&total=[total]&count=[count]&limit=[limit] !}
 {% end %}
+
+<style>
+.tags a {
+	display: inline-block;
+	padding-right: 8px;
+}
+.tags a:last-child {
+	padding-right: 0px;
+}
+</style>
+
+<script>
+$(function () {
+	$.search_init ({
+		form: '#search-form',
+		query: '#search-query',
+		links: '.search-for'
+	});
+
+	$('#search-month').change (function (e) {
+		e.preventDefault ();
+		
+		$('#search-form').submit ();
+	});
+});
+</script>
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/views/archive.html elefant-elefant_1_3_10_beta/apps/blog/views/archive.html
--- elefant-elefant_1_3_9_beta/apps/blog/views/archive.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/views/archive.html	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,11 @@
+{% if num > 1 %}
+<p class="blog-previous"><a href="/blog/archive/{{ year }}/{{ month }}/{{ num }}">&laquo; {" Newer posts "}</a></p>
+{% elseif num == 1 %}
+<p class="blog-previous"><a href="/blog/archive/{{ year }}/{{ month }}">&laquo; {" Newer posts "}</a></p>
+{% end %}
+
+{{ body|none }}
+
+{% if more %}
+<p class="blog-next"><a href="/blog/archive/{{ year }}/{{ month }}/{{ next }}">{" Older posts "} &raquo;</a></p>
+{% end %}
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/views/archives.html elefant-elefant_1_3_10_beta/apps/blog/views/archives.html
--- elefant-elefant_1_3_9_beta/apps/blog/views/archives.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/views/archives.html	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,5 @@
+<ul class="blog-sidebar-archives">
+{% foreach archives as archive %}
+	<li><a href="/blog/archive/{{archive->year}}/{{archive->month}}">{{months[$data->archive->month - 1]}} {{archive->year}}</a> ({{archive->total}})</li>
+{% end %}
+</ul>
Files elefant-elefant_1_3_9_beta/apps/blog/views/by.html and elefant-elefant_1_3_10_beta/apps/blog/views/by.html are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/views/bymonth.html elefant-elefant_1_3_10_beta/apps/blog/views/bymonth.html
--- elefant-elefant_1_3_9_beta/apps/blog/views/bymonth.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/views/bymonth.html	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,9 @@
+{% for mmyy, post in posts %}
+<h4>{{mmyy}}</h4>
+
+<ul>
+	{% for p in post %}
+	<li><a href="/blog/post/{{ p->id }}/{{ p->title|URLify::filter }}">{{ p->title }}</a></li>
+	{% end %}
+</ul>
+{% end %}
Files elefant-elefant_1_3_9_beta/apps/blog/views/disqus/commentcount.html and elefant-elefant_1_3_10_beta/apps/blog/views/disqus/commentcount.html are identical
Files elefant-elefant_1_3_9_beta/apps/blog/views/disqus/comments.html and elefant-elefant_1_3_10_beta/apps/blog/views/disqus/comments.html are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/views/edit/head.html elefant-elefant_1_3_10_beta/apps/blog/views/edit/head.html
--- elefant-elefant_1_3_9_beta/apps/blog/views/edit/head.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/views/edit/head.html	2014-12-03 23:59:25.000000000 -0600
@@ -91,4 +91,16 @@
 	}
 	return false;
 }
+function webpage_preview (f) {
+	var t = f.target,
+		a = f.action;
+
+	f.target = 'elefant-preview';
+	f.action = '/blog/preview';
+	f.submit ();
+
+	f.target = t;
+	f.action = a;
+	return false;
+}
 </script>
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/views/edit.html elefant-elefant_1_3_10_beta/apps/blog/views/edit.html
--- elefant-elefant_1_3_9_beta/apps/blog/views/edit.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/views/edit.html	2014-12-03 23:59:25.000000000 -0600
@@ -1,4 +1,5 @@
 {! user/util/userchooser !}
+{! filemanager/util/browser !}
 
 <div class="form">
 
@@ -5,8 +6,17 @@
 <p class="autosave-notice">{"Auto-saved data found for this form."} <a href="#" class="autosave-restore">{"Click here to restore."}</a></p>
 
 <form method="POST" id="edit-form">
+
 <p>{"Title"}:<br /><input type="text" name="title" size="80" value="{{ title|quotes }}" />
 <span class="notice" id="title-notice">{"You must enter a title."}</span></p>
+
+<div id="thumbnail-div">
+	{"Thumbnail"}:<br />
+	<img src="{% if thumbnail == '' %}//:0{% else %}{{thumbnail|quotes}}{% end %}" id="thumbnail-preview" /><br />
+	<input type="hidden" name="thumbnail" id="thumbnail" size="40" value="{{ thumbnail|quotes }}" />
+	<input type="submit" id="thumbnail-browse" value="{"Choose"}" />
+</div>
+
 <p>{"Author"}:<br /><input type="text" name="author" id="author" size="30" value="{{ author|quotes }}" />
 <input type="submit" value="{"Choose"}" id="users" />
 <span class="notice" id="author-notice">{"You must enter an author."}</span></p>
@@ -35,11 +47,12 @@
 </p>
 </div>
 
-{! admin/util/extended?extends=blog\Post&name=Blog+Posts&values=[extra|none] !}
+{! admin/util/extended?extends=blog\Post&name=Blog+Posts&values=[extra|none]&id=[id] !}
 
 <p>
 	<input type="submit" value="{"Save Blog Post"}" class="autosave-clear" />&nbsp;
 	<input type="submit" value="{"Save &amp; Keep Editing"}" id="bgsave" />&nbsp;
+	<input type="submit" value="{"Preview"}" onclick="return webpage_preview (this.form)" />&nbsp;
 	<a href="/admin/cancel?type=Blog&id={{ id }}&return={{ $_SERVER['HTTP_REFERER']|urlencode }}" onclick="return $.cancel_autosave ('{"Are you sure you want to cancel and lose any changes?"}')">{"Cancel"}</a>&nbsp;
 	<span id="bgsave-status"></span>
 </p>
@@ -48,6 +61,23 @@
 </div>
 <div class="clear"></div>
 
+<style>
+#edit-form {
+	position: relative;
+}
+#thumbnail-div {
+	position: absolute;
+	top: 0;
+	right: 0;
+	width: 150px;
+}
+#thumbnail-preview {
+	width: 150px;
+	height: 100px;
+	margin-bottom: 5px;
+}
+</style>
+
 <script>
 $(function () {
 	$('#users').click (function () {
@@ -62,5 +92,18 @@
 		'<a href="http://daringfireball.net/projects/markdown/basics" target="_blank" id="markdown-link">' + $.i18n ('Markdown formatting') + '</a>'
 	);
 	{% end %}
+
+	$('#thumbnail-browse').click (function (e) {
+		e.preventDefault ();
+		$.filebrowser ({
+			allowed: ['jpg', 'jpeg', 'png', 'gif'],
+			set_value: '#thumbnail',
+			title: "{"Choose an image"}",
+			thumbs: true,
+			callback: function (file) {
+				$('#thumbnail-preview').attr ('src', file);
+			}
+		});
+	});
 });
 </script>
Files elefant-elefant_1_3_9_beta/apps/blog/views/headlines.html and elefant-elefant_1_3_10_beta/apps/blog/views/headlines.html are identical
Files elefant-elefant_1_3_9_beta/apps/blog/views/import/blogger.html and elefant-elefant_1_3_10_beta/apps/blog/views/import/blogger.html are identical
Files elefant-elefant_1_3_9_beta/apps/blog/views/import/csv.html and elefant-elefant_1_3_10_beta/apps/blog/views/import/csv.html are identical
Files elefant-elefant_1_3_9_beta/apps/blog/views/import/csv2.html and elefant-elefant_1_3_10_beta/apps/blog/views/import/csv2.html are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/views/import/wordpress.html elefant-elefant_1_3_10_beta/apps/blog/views/import/wordpress.html
--- elefant-elefant_1_3_9_beta/apps/blog/views/import/wordpress.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/views/import/wordpress.html	2014-12-03 23:59:25.000000000 -0600
@@ -3,12 +3,6 @@
 <p>{"Wordpress export file"}:<br />
 <input type="file" name="import_file" /></p>
 
-<p>{"Mark imported posts as published?"}<br />
-<select name="published">
-	<option value="yes">{"Yes"}</option>
-	<option value="no">{"No"}</option>
-</select></p>
-
 <p>
 	<input type="submit" value="{"Import Posts"}" />&nbsp;
 	<a href="/blog/admin">{"Cancel"}</a>&nbsp;
Files elefant-elefant_1_3_9_beta/apps/blog/views/import.html and elefant-elefant_1_3_10_beta/apps/blog/views/import.html are identical
Files elefant-elefant_1_3_9_beta/apps/blog/views/index.html and elefant-elefant_1_3_10_beta/apps/blog/views/index.html are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/views/post.html elefant-elefant_1_3_10_beta/apps/blog/views/post.html
--- elefant-elefant_1_3_9_beta/apps/blog/views/post.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/views/post.html	2014-12-03 23:59:25.000000000 -0600
@@ -1,14 +1,12 @@
 {! admin/util/dates !}
 
-{% if full %}
-<p><a href="/blog">&laquo; {"Back to posts"}</a></p>
-{% end %}
-
-<div class="blog-post block">
+<div class="blog-post{% if full %} blog-post-full{% end %} block">
+{% if ! full %}
 <h3><a href="{{ url }}">{{ title }}</a></h3>
-<p class="blog-info info">{{ ts|I18n::date_time }} - {" by "} <a href="/blog/by/{{ author }}">{{ author }}</a>
+{% end %}
+<p class="blog-info info">{{ ts|I18n::date_time }}<span class="blog-by"> - {" by "} <a href="/blog/by/{{ author }}">{{ author }}</a></span>
 {% if User::require_acl ('admin', 'blog') %}
-&nbsp;|&nbsp; <a href="/blog/edit?id={{ id }}">{"Edit Post"}</a>
+<span class="hide-in-preview">&nbsp;|&nbsp; <a href="/blog/edit?id={{ id }}">{"Edit Post"}</a></span>
 {% end %}
 </p>
 {{ body|none }}
@@ -16,7 +14,7 @@
 <div class="blog-tags info">
 {"Tags"}: 
 {% foreach tag_list %}
-<a href="/blog/tag/{{ loop_value|trim|strtolower }}">{{ loop_value|trim|ucfirst }}</a>
+<a href="/blog/tag/{{ loop_value|trim|urlencode }}">{{ loop_value|trim|ucfirst }}</a>
 {% end %}
 </div>
 <hr />
@@ -33,4 +31,10 @@
 	{{ controller.run ('social/google/plusone', $data)|none }}
 {% end %}
 </div>
+{% if related %}
+<div class="blog-related">
+<h4>{"You might also like:"}</h4>
+{! blog/related?id=[id]&tags=[tags] !}
+</div>
+{% end %}
 </div>
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/views/related.html elefant-elefant_1_3_10_beta/apps/blog/views/related.html
--- elefant-elefant_1_3_9_beta/apps/blog/views/related.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/views/related.html	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,21 @@
+<div class="e-row-variable">
+{% foreach posts as post %}
+	<div class="e-col-33 e-no-padding">
+		<div class="blog-related-post item">
+			<div class="thumbnail-wrapper">
+				<a href="/blog/post/{{post->id}}/{{post->title|URLify::filter}}">
+					<div class="thumbnail"
+						{% if post->thumbnail != '' %}
+							style="background-image: url('/{{post->thumbnail|Image::resize (%s, 400, 300, 'cover', 'ext')}}')"
+						{% end %}
+					></div>
+				</a>
+			</div>
+			<div class="item-info">
+				<h4><a href="/blog/post/{{post->id}}/{{post->title|URLify::filter}}">{{post->title}}</a></h4>
+				<p>{{post->ts|I18n::short_date_year}}</p>
+			</div>
+		</div>
+	</div>
+{% end %}
+</div>
Files elefant-elefant_1_3_9_beta/apps/blog/views/rss.html and elefant-elefant_1_3_10_beta/apps/blog/views/rss.html are identical
Files elefant-elefant_1_3_9_beta/apps/blog/views/rssviewer.html and elefant-elefant_1_3_10_beta/apps/blog/views/rssviewer.html are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/blog/views/settings.html elefant-elefant_1_3_10_beta/apps/blog/views/settings.html
--- elefant-elefant_1_3_9_beta/apps/blog/views/settings.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/blog/views/settings.html	2014-12-03 23:59:25.000000000 -0600
@@ -8,15 +8,15 @@
 
 <p>{"Page layout"}:<br />
 <select name="layout">
-{% foreach layouts %}
-	<option value="{{ loop_value }}"{% if loop_value == $data->layout %} selected{% end %}>{{ loop_value|ucfirst }}</option>
+{% foreach admin\Layout::options () as _layout, _name %}
+	<option value="{{ _layout }}"{% if _layout == $data->layout %} selected{% end %}>{{ _name }}</option>
 {% end %}
 </select></p>
 
 <p>{"Post page layout"}:<br />
 <select name="post_layout">
-{% foreach layouts %}
-	<option value="{{ loop_value }}"{% if loop_value == $data->post_layout %} selected{% end %}>{{ loop_value|ucfirst }}</option>
+{% foreach admin\Layout::options () as _layout, _name %}
+	<option value="{{ _layout }}"{% if _layout == $data->post_layout %} selected{% end %}>{{ _name }}</option>
 {% end %}
 </select></p>
 
@@ -30,6 +30,13 @@
 	{% end %}
 </select></p>
 
+<p>{"Show related posts"}:<br />
+<select name="show_related_posts">
+	<option value="no"{% if ! show_related_posts %} selected{% end %}>{"No"}</option>
+	<option value="yes"{% if show_related_posts %} selected{% end %}>{"Yes"}</option>
+</select>
+</p>
+
 <p>{"Edit posts with"}:<br />
 <select name="post_format" id="post_format">
 	<option value="html"{% if post_format === 'html' %} selected{% end %}>{"WYSIWYG editor"}</option>
@@ -77,4 +84,4 @@
 		}
 	});
 });
-</script>
\ No newline at end of file
+</script>
Files elefant-elefant_1_3_9_beta/apps/blog/views/tag.html and elefant-elefant_1_3_10_beta/apps/blog/views/tag.html are identical
Files elefant-elefant_1_3_9_beta/apps/blog/views/tags.html and elefant-elefant_1_3_10_beta/apps/blog/views/tags.html are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/handlers/appconf.php elefant-elefant_1_3_10_beta/apps/cli/handlers/appconf.php
--- elefant-elefant_1_3_9_beta/apps/cli/handlers/appconf.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/handlers/appconf.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,135 @@
+<?php
+
+/**
+ * Get or set a setting for an app.
+ *
+ * Usage:
+ *
+ *     # Get the title
+ *     ./elefant appconf events.Events.title     # "Event Calendar"
+ *
+ *     # Set the title to "Event Calendar"
+ *     ./elefant appconf events.Events.title "Event Calendar"
+ *
+ *     # List configuration sections of events app
+ *     ./elefant appconf events                    # Admin, Events
+ *
+ *     # List the configuration options in the
+ *     # Admin section of the events app
+ *     ./elefant appconf events.Admin              # install, handler, name, etc.
+ */
+
+if (! $this->cli) die ('Must be run from the command line.');
+
+$page->layout = false;
+
+$valid_app_name = '/^[a-zA-Z0-9_-]+$/';
+$valid_section_name = '/^[a-zA-Z0-9 _-]+$/';
+$valid_setting_name = '/^[a-zA-Z0-9\/ _-]+$/';
+
+if (! isset ($_SERVER['argv'][2])) {
+	Cli::out ('Usage: ./elefant appconf <app.Section.setting> ["New Value"]', 'info');
+	return;
+}
+
+$parts = explode ('.', $_SERVER['argv'][2]);
+
+// there's a value to update
+if (isset ($_SERVER['argv'][3])) {
+	$value = $_SERVER['argv'][3];
+
+	// make sure they provide a specific and valid setting name
+	if (count ($parts) !== 3) {
+		Cli::out ('Please provide a setting name to update its value.', 'error');
+		return;
+	}
+	
+	list ($app, $section, $setting) = $parts;
+	
+	if (! preg_match ($valid_app_name, $app) || ! is_dir ('apps/' . $app)) {
+		Cli::out ('Invalid app name: ' . $app, 'error');
+		return;
+	}
+
+	if (! preg_match ($valid_section_name, $section)) {
+		Cli::out ('Invalid section name: ' . $section, 'error');
+		return;
+	}
+
+	if (! preg_match ($valid_setting_name, $setting)) {
+		Cli::out ('Invalid setting name: ' . $setting, 'error');
+		return;
+	}
+	
+	// build an updated config to save
+	$merged = Appconf::merge ($app, array ($section => array ($setting => $value)));
+
+	if (! Ini::write ($merged, 'conf/app.' . $app . '.' . ELEFANT_ENV . '.php')) {
+		Cli::out ('Unable to save changes to: conf/app.' . $app . '.' . ELEFANT_ENV . '.php', 'error');
+	}
+
+// show setting info
+} else {
+
+	// list sections
+	if (count ($parts) === 1) {
+		$app = $parts[0];
+
+		if (! preg_match ($valid_app_name, $app) || ! is_dir ('apps/' . $app)) {
+			Cli::out ('Invalid app name: ' . $app, 'error');
+			return;
+		}
+		
+		$settings = Appconf::get ($app);
+		$sections = array_keys ($settings);
+		sort ($sections);
+		echo join (', ', $sections) . "\n";
+
+	// list settings in section
+	} elseif (count ($parts) === 2) {
+		list ($app, $section) = $parts;
+
+		if (! preg_match ($valid_app_name, $app) || ! is_dir ('apps/' . $app)) {
+			Cli::out ('Invalid app name: ' . $app, 'error');
+			return;
+		}
+
+		if (! preg_match ($valid_section_name, $section)) {
+			Cli::out ('Invalid section name: ' . $section, 'error');
+			return;
+		}
+		
+		$settings = Appconf::get ($app, $section);
+		$names = array_keys ($settings);
+		sort ($names);
+		echo join (', ', $names) . "\n";
+
+	// show specific setting (encoded as JSON value)
+	} elseif (count ($parts) === 3) {
+		list ($app, $section, $setting) = $parts;
+	
+		if (! preg_match ($valid_app_name, $app) || ! is_dir ('apps/' . $app)) {
+			Cli::out ('Invalid app name: ' . $app, 'error');
+			return;
+		}
+
+		if (! preg_match ($valid_section_name, $section)) {
+			Cli::out ('Invalid section name: ' . $section, 'error');
+			return;
+		}
+
+		if (! preg_match ($valid_setting_name, $setting)) {
+			Cli::out ('Invalid setting name: ' . $setting, 'error');
+			return;
+		}
+		
+		$value = Appconf::get ($app, $section, $setting);
+		if (! defined ('JSON_PRETTY_PRINT')) {
+			define ('JSON_PRETTY_PRINT', 0);
+		}
+		echo json_encode ($value, JSON_PRETTY_PRINT) . "\n";
+	
+	} else {
+		Cli::out ('Invalid setting value: ' . $_SERVER['argv'][2], 'error');
+	}
+}
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/handlers/backup.php elefant-elefant_1_3_10_beta/apps/cli/handlers/backup.php
--- elefant-elefant_1_3_9_beta/apps/cli/handlers/backup.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/handlers/backup.php	2014-12-03 23:59:25.000000000 -0600
@@ -47,5 +47,3 @@
 chdir ('..');
 exec ('mv .backups/backup-' . $ts . '.tar.gz ' . $path);
 exec ('rm -Rf .backups/backup-' . $ts);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/handlers/build-app.php elefant-elefant_1_3_10_beta/apps/cli/handlers/build-app.php
--- elefant-elefant_1_3_9_beta/apps/cli/handlers/build-app.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/handlers/build-app.php	2014-12-03 23:59:25.000000000 -0600
@@ -58,5 +58,3 @@
 );
 
 Cli::out ('App created in apps/' . $appname, 'success');
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/handlers/bundle-translations.php elefant-elefant_1_3_10_beta/apps/cli/handlers/bundle-translations.php
--- elefant-elefant_1_3_9_beta/apps/cli/handlers/bundle-translations.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/handlers/bundle-translations.php	2014-12-03 23:59:25.000000000 -0600
@@ -81,5 +81,3 @@
 }
 
 Cli::out (sprintf ('Translations exported to apps/%s/lang', $app), 'success');
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/handlers/clear-cache.php elefant-elefant_1_3_10_beta/apps/cli/handlers/clear-cache.php
--- elefant-elefant_1_3_9_beta/apps/cli/handlers/clear-cache.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/handlers/clear-cache.php	2014-12-03 23:59:25.000000000 -0600
@@ -14,6 +14,18 @@
 
 $page->layout = false;
 
+if (isset ($_SERVER['argv'][2])) {
+	$cache->delete ($_SERVER['argv'][2]);
+	return;
+}
+
 exec ('rm -f cache/*.php cache/datastore/* cache/navigation.json');
 
-?>
\ No newline at end of file
+// Also remove datastore dot-files
+$d = dir ('cache/datastore');
+while (false !== ($f = $d->read ())) {
+	if ($f === '.' || $f === '..') {
+		continue;
+	}
+	unlink ('cache/datastore/' . $f);
+}
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/handlers/conf.php elefant-elefant_1_3_10_beta/apps/cli/handlers/conf.php
--- elefant-elefant_1_3_9_beta/apps/cli/handlers/conf.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/handlers/conf.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,111 @@
+<?php
+
+/**
+ * GEt or set a global setting.
+ *
+ * Usage:
+ *
+ *     # Get the default_layout
+ *     ./elefant conf General.default_layout     # "default"
+ *
+ *     # Set the default_layout to "minimal"
+ *     ./elefant conf General.default_layout "minimal"
+ *
+ *     # List configuration sections
+ *     ./elefant conf                            # Cache, Database, etc.
+ *
+ *     # List configuration options in the Mailer section
+ *     ./elefant conf Mailer                     # email_from, email_name, etc.
+ */
+
+if (! $this->cli) die ('Must be run from the command line.');
+
+$page->layout = false;
+
+$valid_section_name = '/^[a-zA-Z0-9 _-]+$/';
+$valid_setting_name = '/^[a-zA-Z0-9\/ _-]+$/';
+
+// there's a value to update
+if (isset ($_SERVER['argv'][3])) {
+	$parts = explode ('.', $_SERVER['argv'][2]);
+	$value = $_SERVER['argv'][3];
+
+	// make sure they provide a specific and valid setting name
+	if (count ($parts) !== 2) {
+		Cli::out ('Please provide a setting name to update its value.', 'error');
+		return;
+	}
+	
+	list ($section, $setting) = $parts;
+	
+	if (! preg_match ($valid_section_name, $section)) {
+		Cli::out ('Invalid section name: ' . $section, 'error');
+		return;
+	}
+
+	if (! preg_match ($valid_setting_name, $setting)) {
+		Cli::out ('Invalid setting name: ' . $setting, 'error');
+		return;
+	}
+	
+	// build an updated config to save
+	$settings = conf ();
+	$merged = array_replace_recursive ($settings, array ($section => array ($setting => $value)));
+
+	if (! Ini::write ($merged, 'conf/' . ELEFANT_ENV . '.php')) {
+		Cli::out ('Unable to save changes to: conf/' . ELEFANT_ENV . '.php', 'error');
+	}
+
+// show setting info
+} else {
+
+	// list sections
+	if (! isset ($_SERVER['argv'][2])) {
+		
+		$settings = conf ();
+		$sections = array_keys ($settings);
+		sort ($sections);
+		echo join (', ', $sections) . "\n";
+		return;
+	}
+	
+	$parts = explode ('.', $_SERVER['argv'][2]);
+
+	// list settings in section
+	if (count ($parts) === 1) {
+		list ($section) = $parts;
+
+		if (! preg_match ($valid_section_name, $section)) {
+			Cli::out ('Invalid section name: ' . $section, 'error');
+			return;
+		}
+		
+		$settings = conf ($section);
+		$names = array_keys ($settings);
+		sort ($names);
+		echo join (', ', $names) . "\n";
+
+	// show specific setting (encoded as JSON value)
+	} elseif (count ($parts) === 2) {
+		list ($section, $setting) = $parts;
+	
+		if (! preg_match ($valid_section_name, $section)) {
+			Cli::out ('Invalid section name: ' . $section, 'error');
+			return;
+		}
+
+		if (! preg_match ($valid_setting_name, $setting)) {
+			Cli::out ('Invalid setting name: ' . $setting, 'error');
+			return;
+		}
+		
+		$value = conf ($section, $setting);
+		if (! defined ('JSON_PRETTY_PRINT')) {
+			define ('JSON_PRETTY_PRINT', 0);
+		}
+		echo json_encode ($value, JSON_PRETTY_PRINT) . "\n";
+	
+	} else {
+		Cli::out ('Invalid setting value: ' . $_SERVER['argv'][2], 'error');
+	}
+}
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/handlers/crud-app.php elefant-elefant_1_3_10_beta/apps/cli/handlers/crud-app.php
--- elefant-elefant_1_3_9_beta/apps/cli/handlers/crud-app.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/handlers/crud-app.php	2014-12-03 23:59:25.000000000 -0600
@@ -123,6 +123,19 @@
 	$pkey = 'id';
 }
 
+$total = count ($fields);
+foreach ($fields as $k => $field) {
+	if ($field->name === $pkey) {
+		continue;
+	}
+
+	if ($k < $total - 1) {
+		$fields[$k]->comma = ',';
+	} else {
+		$fields[$k]->comma = '';
+	}
+}
+
 $data = array (
 	'appname' => $name,
 	'plural' => $plural,
@@ -148,6 +161,11 @@
 );
 
 file_put_contents (
+	'apps/' . $plural . '/conf/acl.php',
+	$tpl->render ('cli/crud-app/acl', $data)
+);
+
+file_put_contents (
 	'apps/' . $plural . '/conf/install_mysql.sql',
 	$tpl->render ('cli/crud-app/install_mysql', $data)
 );
@@ -203,6 +221,16 @@
 );
 
 file_put_contents (
+	'apps/' . $plural . '/handlers/install.php',
+	$tpl->render ('cli/crud-app/install_handler', $data)
+);
+
+file_put_contents (
+	'apps/' . $plural . '/handlers/upgrade.php',
+	$tpl->render ('cli/crud-app/upgrade_handler', $data)
+);
+
+file_put_contents (
 	'apps/' . $plural . '/views/index.html',
 	$tpl->render ('cli/crud-app/index_view', $data)
 );
@@ -223,5 +251,3 @@
 );
 
 Cli::out ('App created in apps/' . $plural, 'success');
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/handlers/encrypt-password.php elefant-elefant_1_3_10_beta/apps/cli/handlers/encrypt-password.php
--- elefant-elefant_1_3_9_beta/apps/cli/handlers/encrypt-password.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/handlers/encrypt-password.php	2014-12-03 23:59:25.000000000 -0600
@@ -17,5 +17,3 @@
 }
 
 echo User::encrypt_pass ($_SERVER['argv'][2]) . "\n";
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/handlers/export-db.php elefant-elefant_1_3_10_beta/apps/cli/handlers/export-db.php
--- elefant-elefant_1_3_9_beta/apps/cli/handlers/export-db.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/handlers/export-db.php	2014-12-03 23:59:25.000000000 -0600
@@ -91,5 +91,3 @@
 		Cli::out ('** Error: Unable to determine database driver from site config.', 'error');
 		break;
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/handlers/generate-key.php elefant-elefant_1_3_10_beta/apps/cli/handlers/generate-key.php
--- elefant-elefant_1_3_9_beta/apps/cli/handlers/generate-key.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/handlers/generate-key.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,13 @@
+<?php
+
+/**
+ * Generates an MD5 key for use in the site_key setting.
+ */
+
+if (! $this->cli) {
+	die ('Must be run from the command line.');
+}
+
+$page->layout = false;
+
+echo md5 (uniqid (rand (), true)) . "\n";
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/handlers/generate-password.php elefant-elefant_1_3_10_beta/apps/cli/handlers/generate-password.php
--- elefant-elefant_1_3_9_beta/apps/cli/handlers/generate-password.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/handlers/generate-password.php	2014-12-03 23:59:25.000000000 -0600
@@ -25,5 +25,3 @@
 }
 
 echo generate_password ($length) . "\n";
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/handlers/import-db.php elefant-elefant_1_3_10_beta/apps/cli/handlers/import-db.php
--- elefant-elefant_1_3_9_beta/apps/cli/handlers/import-db.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/handlers/import-db.php	2014-12-03 23:59:25.000000000 -0600
@@ -34,5 +34,3 @@
 }
 DB::commit ();
 Cli::out (count ($sqldata) . ' commands executed.', 'success');
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/handlers/index.php elefant-elefant_1_3_10_beta/apps/cli/handlers/index.php
--- elefant-elefant_1_3_9_beta/apps/cli/handlers/index.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/handlers/index.php	2014-12-03 23:59:25.000000000 -0600
@@ -27,23 +27,27 @@
 
 Commands:
 
-  <info>install</info>                          Run the command line installer
-  <info>install <url-or-zip></info>             Install a new app or theme
-  <info>update</info>                           Check for and apply Elefant updates
-  <info>permissions</info>                      Set your filesystem permissions
-  <info>backup <path></info>                    Save a backup of the site and db
-  <info>export-db <file></info>                 Export the db to a file or STDOUT
-  <info>import-db <file></info>                 Import a schema file into the db
-  <info>build-app <appname></info>              Build the scaffolding for an app
-  <info>crud-app <modelname> <fieldlist></info> Build the scaffolding for a CRUD app
-  <info>crud-app list-types</info>              List the available CRUD field types
-  <info>clear-cache</info>                      Clear the cache and compiled templates
-  <info>list-helpers</info>                     List available server-side helpers
-  <info>generate-password <length(8)></info>    Generate a random password
-  <info>encrypt-password <password></info>      Encrypt a password for the db
-  <info>bundle-translations <appname></info>    Bundle translations into an app
-  <info>version</info>                          Output the Elefant version number
-  <info>help</info>                             Print this help output
+  <info>install</info>                               Run the command line installer
+  <info>install <url-or-zip></info>                  Install a new app or theme
+  <info>update</info>                                Check for and apply Elefant updates
+  <info>permissions</info>                           Set your filesystem permissions
+  <info>conf <Section.setting> [value]</info>        Get or set a global setting
+<info>  appconf <app.Section.setting> [value]</info> Get or set an app setting
+  <info>backup <path></info>                         Save a backup of the site and db
+  <info>export-db <file></info>                      Export the db to a file or STDOUT
+  <info>import-db <file></info>                      Import a schema file into the db
+  <info>build-app <appname></info>                   Build the scaffolding for an app
+  <info>crud-app <modelname> <fieldlist></info>      Build the scaffolding for a CRUD app
+  <info>crud-app list-types</info>                   List the available CRUD field types
+  <info>clear-cache</info>                           Clear the cache and compiled templates
+  <info>clear-cache <key></info>                     Clear a particular cached object
+  <info>list-helpers</info>                          List available server-side helpers
+  <info>generate-key</info>                          Generate a random 32 character key
+  <info>generate-password <length(8)></info>         Generate a random password
+  <info>encrypt-password <password></info>           Encrypt a password for the db
+  <info>bundle-translations <appname></info>         Bundle translations into an app
+  <info>version</info>                               Output the Elefant version number
+  <info>help</info>                                  Print this help output
 
 
 HELP;
@@ -63,12 +67,10 @@
 	if (count ($commands) > 0) {
 		$help .= "Extended commands:\n\n";
 		foreach ($commands as $cmd => $desc) {
-			$help .= sprintf ("  <info>%-32s</info> %s\n", $cmd, $desc);
+			$help .= sprintf ("  <info>%-37s</info> %s\n", $cmd, $desc);
 		}
 		$help .= "\n";
 	}
 }
 
 Cli::block ($help);
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/handlers/install.php elefant-elefant_1_3_10_beta/apps/cli/handlers/install.php
--- elefant-elefant_1_3_9_beta/apps/cli/handlers/install.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/handlers/install.php	2014-12-03 23:59:25.000000000 -0600
@@ -164,5 +164,3 @@
 @umask (0000);
 @touch ('conf/installed');
 echo "Done.\n";
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/handlers/list-helpers.php elefant-elefant_1_3_10_beta/apps/cli/handlers/list-helpers.php
--- elefant-elefant_1_3_9_beta/apps/cli/handlers/list-helpers.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/handlers/list-helpers.php	2014-12-03 23:59:25.000000000 -0600
@@ -31,5 +31,3 @@
 ksort ($helpers);
 
 echo join ("\n", array_keys ($helpers)) . "\n";
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/handlers/permissions.php elefant-elefant_1_3_10_beta/apps/cli/handlers/permissions.php
--- elefant-elefant_1_3_9_beta/apps/cli/handlers/permissions.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/handlers/permissions.php	2014-12-03 23:59:25.000000000 -0600
@@ -13,5 +13,3 @@
 // set the necessary folder permissions
 system ('chmod -R 777 cache conf css files lang layouts');
 system ('chmod 777 apps');
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/handlers/update.php elefant-elefant_1_3_10_beta/apps/cli/handlers/update.php
--- elefant-elefant_1_3_9_beta/apps/cli/handlers/update.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/handlers/update.php	2014-12-03 23:59:25.000000000 -0600
@@ -15,119 +15,145 @@
 
 $page->layout = false;
 
-require_once ('apps/cli/lib/Functions.php');
-
-// get the major/minor version
-$major_minor = preg_replace ('/\.[0-9]+$/', '', ELEFANT_VERSION);
+// Build a list of apps to upgrade after the core has been upgraded first.
+$app = 'none';
+$update_apps = array ();
+if (isset ($_SERVER['argv'][2])) {
+	$app = $_SERVER['argv'][2];
+	
+	if ($app === 'all') {
+		$files = glob ('apps/*/elefant.json');
+		
+		foreach ($files as $file) {
+			$info = explode ('/', $file);
+			$update_apps[] = $info[1];
+		}
+	} elseif (strpos ($app, '..') !== false || ! file_exists ('apps/' . $app . '/elefant.json')) {
+		// App not found or invalid
+		Cli::out ('Invalid app name: ' . $app, 'error');
+		return;
+	} else {
+		$update_apps[] = $app;
+	}
 
-// fetch the latest version from the server
-$data = Updater::fetch ('releases/' . $major_minor . '.json');
-if (! $data) {
-	Cli::out ('Error: ' . Updater::error () . ' releases/' . $major_minor . '.json', 'error');
+	Cli::out ('Error: Not implemented yet.', 'error');
 	return;
 }
-$res = json_decode ($data);
 
-if (! is_object ($res)) {
-	Cli::out ('Error: Unable to fetch latest version from the server.');
-	return;
-}
+if ($app === 'none' || $app === 'all') {
+	require_once ('apps/cli/lib/Functions.php');
 
-// are we already up to date?
-if ($res->latest <= ELEFANT_VERSION) {
-	echo ELEFANT_VERSION . " is already up-to-date.\n";
-	return;
-}
+	// Get the major/minor version
+	$major_minor = preg_replace ('/\.[0-9]+$/', '', ELEFANT_VERSION);
 
-// new version ready
-$latest = $res->latest;
-echo "New version: {$latest}\n";
-
-// make sure conf/updates exists
-if (! file_exists ('conf/updates')) {
-	mkdir ('conf/updates');
-}
+	// Fetch the latest version from the server
+	$data = Updater::fetch ('releases/' . $major_minor . '.json');
+	if (! $data) {
+		Cli::out ('Error: ' . Updater::error () . ' releases/' . $major_minor . '.json', 'error');
+		return;
+	}
+	$res = json_decode ($data);
 
-// check for and download new patch files
-$data = Updater::fetch ('patches.json');
-if (! $data) {
-	Cli::out ('Error: ' . Updater::error () . ' patches.json', 'error');
-	return;
-}
-$res = json_decode ($data);
+	if (! is_object ($res)) {
+		Cli::out ('Error: Unable to fetch latest version from the server.', 'error');
+		return;
+	}
 
-if (! is_object ($res)) {
-	Cli::out ('Error: Unable to fetch patch list from the server.', 'error');
-	return;
-}
+	// Are we already up to date?
+	if (version_compare ($res->latest, ELEFANT_VERSION,'<=')) {
+		echo ELEFANT_VERSION . " is already up-to-date.\n";
+		return;
+	}
 
-foreach ($res->patches as $patch_file) {
-	$base = basename ($patch_file);
-	if (! file_exists ('conf/updates/' . $base)) {
-		echo "Fetching new patch: {$base}\n";
-		$contents = Updater::fetch ($patch_file);
-		if (! $contents) {
-			Cli::out ('Error: ' . Updater::error () . ' ' . $patch_file, 'error');
-			return;
-		}
-		file_put_contents ('conf/updates/' . $base, $contents);
+	// New version ready
+	$latest = $res->latest;
+	echo "New version: {$latest}\n";
+
+	// Make sure conf/updates exists
+	if (! file_exists ('conf/updates')) {
+		mkdir ('conf/updates');
+	}
 
-		// TODO: MD5 checks from 3rd party repo
+	// Check for and download new patch files
+	$data = Updater::fetch ('patches.json');
+	if (! $data) {
+		Cli::out ('Error: ' . Updater::error () . ' patches.json', 'error');
+		return;
 	}
-}
+	$res = json_decode ($data);
 
-foreach ($res->scripts as $script_file) {
-	$base = basename ($script_file);
-	if (! file_exists ('conf/updates/' . $base)) {
-		echo "Fetching new db update: {$base}\n";
-		$contents = Updater::fetch ($script_file);
-		if (! $contents) {
-			Cli::out ('Error: ' . Updater::error () . ' ' . $script_file, 'error');
-			return;
+	if (! is_object ($res)) {
+		Cli::out ('Error: Unable to fetch patch list from the server.', 'error');
+		return;
+	}
+
+	foreach ($res->patches as $patch_file) {
+		$base = basename ($patch_file);
+		if (! file_exists ('conf/updates/' . $base)) {
+			echo "Fetching new patch: {$base}\n";
+			$contents = Updater::fetch ($patch_file);
+			if (! $contents) {
+				Cli::out ('Error: ' . Updater::error () . ' ' . $patch_file, 'error');
+				return;
+			}
+			file_put_contents ('conf/updates/' . $base, $contents);
 		}
-		file_put_contents ('conf/updates/' . $base, $contents);
+	}
 
-		// TODO: MD5 checks from 3rd party repo
+	foreach ($res->scripts as $script_file) {
+		$base = basename ($script_file);
+		if (! file_exists ('conf/updates/' . $base)) {
+			echo "Fetching new db update: {$base}\n";
+			$contents = Updater::fetch ($script_file);
+			if (! $contents) {
+				Cli::out ('Error: ' . Updater::error () . ' ' . $script_file, 'error');
+				return;
+			}
+			file_put_contents ('conf/updates/' . $base, $contents);
+		}
 	}
-}
 
-$versions = cli_get_versions (ELEFANT_VERSION, $latest);
+	$versions = cli_get_versions (ELEFANT_VERSION, $latest);
 
-// Test and apply the patches and db updates in sequence
-foreach ($versions as $version) {
-	printf ("Testing patch: %s\n", basename ($version['patch']));
-	exec ('patch --dry-run -p1 -f -i ' . $version['patch'], $output);
-	$output = join ("\n", $output);
-	if (strpos ($output, 'FAILED')) {
-		Cli::out ('Error applying patch ' . $version['patch'], 'error');
-		echo "See conf/updates/error.log for details.\n";
-		file_put_contents ('conf/updates/error.log', $output);
-		return;
-	}
+	// Test and apply the patches and db updates in sequence
+	foreach ($versions as $version) {
+		printf ("Testing patch: %s\n", basename ($version['patch']));
+		exec ('patch --dry-run -p1 -f -i ' . $version['patch'], $output);
+		$output = join ("\n", $output);
+		if (strpos ($output, 'FAILED')) {
+			Cli::out ('Error applying patch ' . $version['patch'], 'error');
+			echo "See conf/updates/error.log for details.\n";
+			file_put_contents ('conf/updates/error.log', $output);
+			return;
+		}
 
-	// Patch is okay to apply
-	echo "Patch ok, applying...\n";
-	exec ('patch -p1 -f -i ' . $version['patch']);
-
-	// Apply associated database updates
-	if ($version['script']) {
-		printf ("Applying db update: %s\n", basename ($version['script']));
-		$sqldata = sql_split (file_get_contents ($version['script']));
-		DB::beginTransaction ();
-		foreach ($sqldata as $sql) {
-			if (! DB::execute ($sql)) {
-				$error = DB::error ();
-				DB::rollback ();
-				Cli::out ('Error applying db update: ' . $version['script'], 'error');
-				echo "See conf/updates/error.log for details.\n";
-				file_put_contents ('conf/updates/error.log', $error);
-				return;
+		// Patch is okay to apply
+		echo "Patch ok, applying...\n";
+		exec ('patch -p1 -f -i ' . $version['patch']);
+
+		// Apply associated database updates
+		if ($version['script']) {
+			printf ("Applying db update: %s\n", basename ($version['script']));
+			$sqldata = sql_split (file_get_contents ($version['script']));
+			DB::beginTransaction ();
+			foreach ($sqldata as $sql) {
+				if (! DB::execute ($sql)) {
+					$error = DB::error ();
+					DB::rollback ();
+					Cli::out ('Error applying db update: ' . $version['script'], 'error');
+					echo "See conf/updates/error.log for details.\n";
+					file_put_contents ('conf/updates/error.log', $error);
+					return;
+				}
 			}
+			DB::commit ();
 		}
-		DB::commit ();
 	}
-}
 
-Cli::out (sprintf ("Applied %d updates.", count ($versions)), 'success');
+	Cli::out (sprintf ("Applied %d updates.", count ($versions)), 'success');
+}
 
-?>
+// Upgrade the apps that were specified as well
+foreach ($update_apps as $app) {
+	// TODO: Implement me
+}
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/handlers/version.php elefant-elefant_1_3_10_beta/apps/cli/handlers/version.php
--- elefant-elefant_1_3_9_beta/apps/cli/handlers/version.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/handlers/version.php	2014-12-03 23:59:25.000000000 -0600
@@ -11,5 +11,3 @@
 $page->layout = false;
 
 echo ELEFANT_VERSION . "\n";
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/lib/CRUDHelpers.php elefant-elefant_1_3_10_beta/apps/cli/lib/CRUDHelpers.php
--- elefant-elefant_1_3_9_beta/apps/cli/lib/CRUDHelpers.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/lib/CRUDHelpers.php	2014-12-03 23:59:25.000000000 -0600
@@ -116,5 +116,3 @@
 			return 'char(48) not null';
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/lib/Cli.php elefant-elefant_1_3_10_beta/apps/cli/lib/Cli.php
--- elefant-elefant_1_3_9_beta/apps/cli/lib/Cli.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/lib/Cli.php	2014-12-03 23:59:25.000000000 -0600
@@ -63,5 +63,3 @@
 		);
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/lib/Functions.php elefant-elefant_1_3_10_beta/apps/cli/lib/Functions.php
--- elefant-elefant_1_3_9_beta/apps/cli/lib/Functions.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/lib/Functions.php	2014-12-03 23:59:25.000000000 -0600
@@ -52,5 +52,3 @@
 	}
 	return $versions;
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/lib/Updater.php elefant-elefant_1_3_10_beta/apps/cli/lib/Updater.php
--- elefant-elefant_1_3_9_beta/apps/cli/lib/Updater.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/lib/Updater.php	2014-12-03 23:59:25.000000000 -0600
@@ -7,12 +7,12 @@
 	/**
 	 * The prefix for the update server.
 	 */
-	public static $updates = 'https://raw.github.com/jbroadway/elefant-updates/master/';
+	public static $updates = 'https://raw.githubusercontent.com/jbroadway/elefant-updates/master/';
 	
 	/**
 	 * The prefix for the checksum server.
 	 */
-	public static $checksums = 'https://raw.github.com/elefantcms/checksums/master/';
+	public static $checksums = 'https://raw.githubusercontent.com/elefantcms/checksums/master/';
 	
 	/**
 	 * Contains any errors from the last `fetch()` call.
@@ -81,5 +81,3 @@
 		return true;
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/tests/CliTest.php elefant-elefant_1_3_10_beta/apps/cli/tests/CliTest.php
--- elefant-elefant_1_3_9_beta/apps/cli/tests/CliTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/tests/CliTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -47,5 +47,3 @@
 		$this->assertEquals ("\033[0;32mYay!\033[0m\n\033[31;31mOh noes\033[0m", $out);
 	}
 }
-
-?>
\ No newline at end of file
Files elefant-elefant_1_3_9_beta/apps/cli/views/build-app/admin_handler.html and elefant-elefant_1_3_10_beta/apps/cli/views/build-app/admin_handler.html are identical
Files elefant-elefant_1_3_9_beta/apps/cli/views/build-app/config.html and elefant-elefant_1_3_10_beta/apps/cli/views/build-app/config.html are identical
Files elefant-elefant_1_3_9_beta/apps/cli/views/build-app/index_handler.html and elefant-elefant_1_3_10_beta/apps/cli/views/build-app/index_handler.html are identical
Files elefant-elefant_1_3_9_beta/apps/cli/views/build-app/index_view.html and elefant-elefant_1_3_10_beta/apps/cli/views/build-app/index_view.html are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/acl.html elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/acl.html
--- elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/acl.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/acl.html	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,5 @@
+; {{open_tag|none}} /*
+
+{{plural}} = "Manage {{plural}}"
+
+; */ {{close_tag|none}}
\ No newline at end of file
Files elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/add_form.html and elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/add_form.html are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/add_handler.html elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/add_handler.html
--- elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/add_handler.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/add_handler.html	2014-12-03 23:59:25.000000000 -0600
@@ -1,7 +1,7 @@
 {{open_tag|none}}
 
 
-$this->require_admin ();
+$this->require_acl ('admin', '{{plural}}', 'admin/add');
 
 $page->layout = 'admin';
 $page->title = __ ('Add {{appname|ucfirst}}');
@@ -12,13 +12,16 @@
 	// Create and save a new {{appname}} 
 	${{appname}} = new {{plural}}{{backslash}}{{appname|ucfirst}} (array (
 {% for key, field in fields %}
-		'{{field->name}}' => $_POST['{{field->name}}']{% if $data->key < count ($data->fields) - 1 %},{% end %} 
+{% if field->name !== $data->pkey %}
+		'{{field->name}}' => $_POST['{{field->name}}']{{field->comma}} 
+{% end %}
 {% end %}
 	));
 	${{appname}}->put ();
 
 	if (${{appname}}->error) {
 		// Failed to save
+		error_log ('Error adding {{appname}}: ' . DB::error ());
 		$form->controller->add_notification (__ ('Unable to save {{appname}}.'));
 		return false;
 	}
Files elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/add_view.html and elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/add_view.html are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/admin_handler.html elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/admin_handler.html
--- elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/admin_handler.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/admin_handler.html	2014-12-03 23:59:25.000000000 -0600
@@ -1,7 +1,7 @@
 {{open_tag|none}}
 
 
-$this->require_admin ();
+$this->require_acl ('admin', '{{plural}}');
 
 $page->layout = 'admin';
 $page->title = __ ('{{plural|ucfirst}}');
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/admin_view.html elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/admin_view.html
--- elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/admin_view.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/admin_view.html	2014-12-03 23:59:25.000000000 -0600
@@ -1,4 +1,6 @@
+\{% if User::require_acl ('admin/add') %}
 <p><a href="/{{plural}}/add">\{"Add {{appname|ucfirst}}"}</a></p>
+\{% end %}
 
 <p>
 <table width="100%">
@@ -10,10 +12,15 @@
 	<tr>
 {{ fields|make_fields_row (array_slice (%s, 1)) }}
 		<td style="text-align: right">
-			<a	href="/{{plural}}/edit?id=\{{ loop_value->id }}">\{"Edit"}</a> |
+			\{% if User::require_acl ('admin/edit') %}
+			<a	href="/{{plural}}/edit?id=\{{ loop_value->id }}">\{"Edit"}</a>
+			\{% end %}
+			\{% if User::require_acl ('admin/delete') %}
+			|
 			<a	href="/{{plural}}/delete"
 				data-id="\{{ loop_value->id }}"
 				onclick="return $.confirm_and_post (this, '\{"Are you sure you want to delete this {{appname}}?"}')">\{"Delete"}</a>
+			\{% end %}
 		</td>
 	</tr>
 \{% end %}
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/config.html elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/config.html
--- elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/config.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/config.html	2014-12-03 23:59:25.000000000 -0600
@@ -2,8 +2,11 @@
 
 [Admin]
 
-handler = {{plural}}/admin
 name = {{plural|ucfirst}}
 
+version = 0.1.0
+handler = {{plural}}/admin
+install = {{plural}}/install
+upgrade = {{plural}}/upgrade
 
 ; */ {{close_tag|none}}
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/delete_handler.html elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/delete_handler.html
--- elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/delete_handler.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/delete_handler.html	2014-12-03 23:59:25.000000000 -0600
@@ -1,7 +1,7 @@
 {{open_tag|none}}
 
 
-$this->require_admin ();
+$this->require_acl ('admin', '{{plural}}', 'admin/delete');
 
 if ($_SERVER['REQUEST_METHOD'] !== 'POST') {
 	$this->redirect ('/{{plural}}/admin');
@@ -11,6 +11,7 @@
 ${{appname}}->remove ($_POST['id']);
 
 if (${{appname}}->error) {
+	error_log ('Error deleting {{appname}}: ' . DB::error ());
 	$this->add_notification (__ ('Unable to delete {{appname}}.'));
 	$this->redirect ('/{{plural}}/admin');
 }
Files elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/edit_form.html and elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/edit_form.html are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/edit_handler.html elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/edit_handler.html
--- elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/edit_handler.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/edit_handler.html	2014-12-03 23:59:25.000000000 -0600
@@ -1,7 +1,7 @@
 {{open_tag|none}}
 
 
-$this->require_admin ();
+$this->require_acl ('admin', '{{plural}}', 'admin/edit');
 
 $page->layout = 'admin';
 $page->title = __ ('Edit {{appname|ucfirst}}');
@@ -14,12 +14,15 @@
 	// Update the {{appname}} 
 	${{appname}} = $form->data;
 {% for field in fields %}
+{% if field->name !== $data->pkey %}
 	${{appname}}->{{field->name}} = $_POST['{{field->name}}'];
 {% end %}
+{% end %}
 	${{appname}}->put ();
 
 	if (${{appname}}->error) {
 		// Failed to save
+		error_log ('Error updating {{appname}}: ' . DB::error ());
 		$form->controller->add_notification (__ ('Unable to save {{appname}}.'));
 		return false;
 	}
Files elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/edit_view.html and elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/edit_view.html are identical
Files elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/index_handler.html and elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/index_handler.html are identical
Files elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/index_view.html and elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/index_view.html are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/install_handler.html elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/install_handler.html
--- elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/install_handler.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/install_handler.html	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,61 @@
+{{open_tag|none}}
+
+
+// keep unauthorized users out
+$this->require_acl ('admin', $this->app);
+
+// set the layout
+$page->layout = 'admin';
+
+// get the version and check if the app installed
+$version = Appconf::get ($this->app, 'Admin', 'version');
+$current = $this->installed ($this->app, $version);
+
+if ($current === true) {
+    // app is already installed and up-to-date, stop here
+    $page->title = __ ('Already installed');
+    printf ('<p><a href="/%s/admin">%s</a>', $this->app, __ ('Continue'));
+    return;
+
+} elseif ($current !== false) {
+    // earlier version found, redirect to upgrade handler
+    $this->redirect ('/' . Appconf::get ($this->app, 'Admin', 'upgrade'));
+}
+
+$page->title = sprintf (
+    '%s: %s',
+    __ ('Installing App'),
+    Appconf::get ($this->app, 'Admin', 'name')
+);
+
+// grab the database driver and begin the transaction
+$conn = conf ('Database', 'master');
+$driver = $conn['driver'];
+DB::beginTransaction ();
+
+// parse the database schema into individual queries
+$file = 'apps/' . $this->app . '/conf/install_' . $driver . '.sql';
+$sql = sql_split (file_get_contents ($file));
+
+// execute each query in turn
+foreach ($sql as $query) {
+    if (! DB::execute ($query)) {
+        // show error and rollback on failures
+        printf (
+            '<p class="visible-notice">%s: %s</p><p>%s</p>',
+            __ ('Error'),
+            DB::error (),
+            __ ('Install failed.')
+        );
+        DB::rollback ();
+        return;
+    }
+}
+
+// commit transaction and mark the app installed
+DB::commit ();
+$this->mark_installed ($this->app, $version);
+
+printf ('<p><a href="/%s/admin">%s</a></p>', $this->app, __ ('Done.'));
+
+{{close_tag|none}}
\ No newline at end of file
Files elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/install_mysql.html and elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/install_mysql.html are identical
Files elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/install_pgsql.html and elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/install_pgsql.html are identical
Files elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/install_sqlite.html and elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/install_sqlite.html are identical
Files elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/model.html and elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/model.html are identical
Files elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/types/checkbox.html and elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/types/checkbox.html are identical
Files elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/types/date.html and elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/types/date.html are identical
Files elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/types/datetime.html and elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/types/datetime.html are identical
Files elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/types/email.html and elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/types/email.html are identical
Files elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/types/password.html and elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/types/password.html are identical
Files elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/types/pkey.html and elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/types/pkey.html are identical
Files elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/types/radio.html and elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/types/radio.html are identical
Files elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/types/select.html and elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/types/select.html are identical
Files elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/types/text.html and elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/types/text.html are identical
Files elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/types/textarea.html and elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/types/textarea.html are identical
Files elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/types/time.html and elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/types/time.html are identical
Files elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/types/wysiwyg.html and elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/types/wysiwyg.html are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/upgrade_handler.html elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/upgrade_handler.html
--- elefant-elefant_1_3_9_beta/apps/cli/views/crud-app/upgrade_handler.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/cli/views/crud-app/upgrade_handler.html	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,67 @@
+{{open_tag|none}}
+
+
+// keep unauthorized users out
+$this->require_acl ('admin', $this->app);
+
+// set the layout
+$page->layout = 'admin';
+
+// get the version and check if the app installed
+$version = Appconf::get ($this->app, 'Admin', 'version');
+$current = $this->installed ($this->app, $version);
+
+if ($current === true) {
+    // app is already installed and up-to-date, stop here
+    $page->title = __ ('Already up-to-date');
+    printf ('<p><a href="/%s/admin">%s</a>', $this->app, __ ('Home'));
+    return;
+}
+
+$page->title = sprintf (
+    '%s: %s',
+    __ ('Upgrading App'),
+    Appconf::get ($this->app, 'Admin', 'name')
+);
+
+// grab the database driver
+$conn = conf ('Database', 'master');
+$driver = $conn['driver'];
+
+// check if upgrade script exists and if so, run it
+$base_version = preg_replace ('/-.*$/', '', $version);
+$file = 'apps/' . $this->app . '/conf/upgrade_' . $base_version . '_' . $driver . '.sql';
+if (file_exists ($file)) {
+    // begin the transaction
+    DB::beginTransaction ();
+
+    // parse the database schema into individual queries
+    $sql = sql_split (file_get_contents ($file));
+
+    // execute each query in turn
+    foreach ($sql as $query) {
+        if (! DB::execute ($query)) {
+            // show error and rollback on failures
+            printf (
+                '<p class="visible-notice">%s: %s</p><p>%s</p>',
+                __ ('Error'),
+                DB::error (),
+                __ ('Install failed.')
+            );
+            DB::rollback ();
+            return;
+        }
+    }
+
+    // commit the transaction
+    DB::commit ();
+}
+
+// add your upgrade logic here
+
+// mark the new version installed
+$this->mark_installed ($this->app, $version);
+
+printf ('<p><a href="/%s/admin">%s</a></p>', $this->app, __ ('Done.'));
+
+{{close_tag|none}}
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/designer/conf/acl.php elefant-elefant_1_3_10_beta/apps/designer/conf/acl.php
--- elefant-elefant_1_3_9_beta/apps/designer/conf/acl.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/designer/conf/acl.php	2014-12-03 23:59:25.000000000 -0600
@@ -3,4 +3,4 @@
 designer = "Edit design themes"
 designer/installer = "Install new apps/themes"
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/designer/conf/config.php elefant-elefant_1_3_10_beta/apps/designer/conf/config.php
--- elefant-elefant_1_3_9_beta/apps/designer/conf/config.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/designer/conf/config.php	2014-12-03 23:59:25.000000000 -0600
@@ -6,4 +6,4 @@
 name = Designer
 platforms = desktop, tablet
 
-; */ ?>
\ No newline at end of file
+; */ ?>
Files elefant-elefant_1_3_9_beta/apps/designer/css/add_layout.css and elefant-elefant_1_3_10_beta/apps/designer/css/add_layout.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/css/add_stylesheet.css and elefant-elefant_1_3_10_beta/apps/designer/css/add_stylesheet.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/css/edit_layout.css and elefant-elefant_1_3_10_beta/apps/designer/css/edit_layout.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/css/edit_stylesheet.css and elefant-elefant_1_3_10_beta/apps/designer/css/edit_stylesheet.css are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/designer/forms/addlayout.php elefant-elefant_1_3_10_beta/apps/designer/forms/addlayout.php
--- elefant-elefant_1_3_9_beta/apps/designer/forms/addlayout.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/designer/forms/addlayout.php	2014-12-03 23:59:25.000000000 -0600
@@ -3,11 +3,11 @@
 [name]
 
 not empty = 1
-regex = '/^[a-z0-9_-]+$/'
+regex = '/^[a-z0-9_-]+(\/[a-z0-9_-]+)?(\/[a-z0-9_-]+)?$/'
 not exists = "layouts/%s.html"
 
 [body]
 
 not empty = 1
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/designer/forms/addstylesheet.php elefant-elefant_1_3_10_beta/apps/designer/forms/addstylesheet.php
--- elefant-elefant_1_3_9_beta/apps/designer/forms/addstylesheet.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/designer/forms/addstylesheet.php	2014-12-03 23:59:25.000000000 -0600
@@ -3,11 +3,11 @@
 [name]
 
 not empty = 1
-regex = '/^[a-z0-9_-]+$/'
+regex = '/^[a-z0-9_-]+(\/[a-z0-9_-]+)?(\/[a-z0-9_-]+)?$/'
 not exists = "css/%s.css"
 
 [body]
 
 not empty = 1
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/designer/forms/editlayout.php elefant-elefant_1_3_10_beta/apps/designer/forms/editlayout.php
--- elefant-elefant_1_3_9_beta/apps/designer/forms/editlayout.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/designer/forms/editlayout.php	2014-12-03 23:59:25.000000000 -0600
@@ -4,4 +4,4 @@
 
 not empty = 1
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/designer/forms/editstylesheet.php elefant-elefant_1_3_10_beta/apps/designer/forms/editstylesheet.php
--- elefant-elefant_1_3_9_beta/apps/designer/forms/editstylesheet.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/designer/forms/editstylesheet.php	2014-12-03 23:59:25.000000000 -0600
@@ -4,4 +4,4 @@
 
 not empty = 1
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/designer/forms/installer.php elefant-elefant_1_3_10_beta/apps/designer/forms/installer.php
--- elefant-elefant_1_3_9_beta/apps/designer/forms/installer.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/designer/forms/installer.php	2014-12-03 23:59:25.000000000 -0600
@@ -11,4 +11,4 @@
 skip_if_empty = 1
 callback = github_is_valid_url
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/designer/handlers/add/layout.php elefant-elefant_1_3_10_beta/apps/designer/handlers/add/layout.php
--- elefant-elefant_1_3_9_beta/apps/designer/handlers/add/layout.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/designer/handlers/add/layout.php	2014-12-03 23:59:25.000000000 -0600
@@ -11,9 +11,25 @@
 $f = new Form ('post', 'designer/addlayout');
 $f->verify_csrf = false;
 if ($f->submit ()) {
-	if (@file_put_contents ('layouts/' . $_POST['name'] . '.html', $_POST['body'])) {
+	// determine file path and make any necessary new directories
+	if (strpos ($_POST['name'], '/') !== false) {
+		$file_path = 'layouts/' . $_POST['name'] . '.html';
+		$folder = join ('/', explode ('/', $_POST['name'], -1));
+		if (! is_dir ('layouts/' . $folder)) {
+			mkdir ('layouts/' . $folder, 0777, true);
+		}
+
+	// if the file is [a-z0-9_-]+ only, convert to new theme (layouts/name/name.html)
+	} else {
+		$file_path = 'layouts/' . $_POST['name'] . '/' . $_POST['name'] . '.html';
+		if (! is_dir ('layouts/' . $_POST['name'])) {
+			mkdir ('layouts/' . $_POST['name'], 0777);
+		}
+	}
+
+	if (@file_put_contents ($file_path, $_POST['body'])) {
 		$this->add_notification (__ ('Layout added.'));
-		@chmod ('layouts/' . $_POST['name'] . '.html', 0666);
+		@chmod ($file_path, 0666);
 		$this->redirect ('/designer');
 	}
 	$page->title = __ ('Saving Layout Failed');
@@ -43,5 +59,3 @@
 $o = $f->merge_values ($o);
 $page->add_script ('/apps/designer/css/add_layout.css');
 echo $tpl->render ('designer/add/layout', $o);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/designer/handlers/add/stylesheet.php elefant-elefant_1_3_10_beta/apps/designer/handlers/add/stylesheet.php
--- elefant-elefant_1_3_9_beta/apps/designer/handlers/add/stylesheet.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/designer/handlers/add/stylesheet.php	2014-12-03 23:59:25.000000000 -0600
@@ -11,9 +11,25 @@
 $f = new Form ('post', 'designer/addstylesheet');
 $f->verify_csrf = false;
 if ($f->submit ()) {
-	if (@file_put_contents ('css/' . $_POST['name'] . '.css', $_POST['body'])) {
+	// determine file path and make any necessary new directories
+	if (strpos ($_POST['name'], '/') !== false) {
+		$file_path = 'layouts/' . $_POST['name'] . '.css';
+		$folder = join ('/', explode ('/', $_POST['name'], -1));
+		if (! is_dir ('layouts/' . $folder)) {
+			mkdir ('layouts/' . $folder, 0777, true);
+		}
+
+	// if the file is [a-z0-9_-]+ only, convert to new theme (layouts/name/style.css)
+	} else {
+		$file_path = 'layouts/' . $_POST['name'] . '/style.css';
+		if (! is_dir ('layouts/' . $_POST['name'])) {
+			mkdir ('layouts/' . $_POST['name'], 0777);
+		}
+	}
+
+	if (@file_put_contents ($file_path, $_POST['body'])) {
 		$this->add_notification (__ ('Stylesheet added.'));
-		@chmod ('css/' . $_POST['name'] . '.css', 0666);
+		@chmod ($file_path, 0666);
 		$this->redirect ('/designer');
 	}
 	$page->title = __ ('Saving Stylesheet Failed');
@@ -43,5 +59,3 @@
 $o = $f->merge_values ($o);
 $page->add_script ('/apps/designer/css/add_stylesheet.css');
 echo $tpl->render ('designer/add/stylesheet', $o);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/designer/handlers/bgsave.php elefant-elefant_1_3_10_beta/apps/designer/handlers/bgsave.php
--- elefant-elefant_1_3_9_beta/apps/designer/handlers/bgsave.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/designer/handlers/bgsave.php	2014-12-03 23:59:25.000000000 -0600
@@ -17,7 +17,7 @@
 
 $error = false;
 
-if (! preg_match ('/^(css|layouts|layouts\/[a-z0-9_-]+|layouts\/[a-z0-9_-]+\/[a-z0-9_-]+)\/[a-z0-9_-]+\.(html|css)$/i', $_GET['file'])) {
+if (! preg_match ('/^(css|layouts|layouts\/[a-z0-9 _-]+|layouts\/[a-z0-9 _-]+\/[a-z0-9 _-]+)\/[a-z0-9 _-]+\.(html|css)$/i', $_GET['file'])) {
 	$res = new StdClass;
 	$res->success = false;
 	$res->error = 'Invalid file path';
@@ -43,5 +43,3 @@
 }
 
 echo json_encode ($res);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/designer/handlers/csspreview.php elefant-elefant_1_3_10_beta/apps/designer/handlers/csspreview.php
--- elefant-elefant_1_3_9_beta/apps/designer/handlers/csspreview.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/designer/handlers/csspreview.php	2014-12-03 23:59:25.000000000 -0600
@@ -20,7 +20,7 @@
 			}
 		}
 	}
-	if ($_GET['css'] && preg_match ('/^(layouts|css)\/[a-z0-9\/_-]+\.css$/i', $_GET['css'])) {
+	if ($_GET['css'] && preg_match ('/^(layouts|css)\/[a-z0-9\/ _-]+\.css$/i', $_GET['css'])) {
 		$page->layout = str_replace ('</head>', '<style>' . file_get_contents ($_GET['css']) . '</style></head>', $page->layout);
 	}
 } else {
@@ -43,5 +43,3 @@
 }
 
 echo '<p>' . __ ('This is a preview of how your layout will look.') . '</p>';
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/designer/handlers/delete.php elefant-elefant_1_3_10_beta/apps/designer/handlers/delete.php
--- elefant-elefant_1_3_9_beta/apps/designer/handlers/delete.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/designer/handlers/delete.php	2014-12-03 23:59:25.000000000 -0600
@@ -8,7 +8,7 @@
 
 $this->require_acl ('admin', 'designer');
 
-if (! preg_match ('/^(css|layouts|layouts\/[a-z0-9_-]+|layouts\/[a-z0-9_-]+\/[a-z0-9_-]+)\/[a-z0-9\/_-]+\.(css|html)$/i', $_GET['file'])) {
+if (! preg_match ('/^(css|layouts|layouts\/[a-z0-9 _-]+|layouts\/[a-z0-9 _-]+\/[a-z0-9 _-]+)\/[a-z0-9\/ _-]+\.(css|html)$/i', $_GET['file'])) {
 	$this->redirect ('/designer');
 }
 
@@ -28,5 +28,3 @@
 
 $this->add_notification (__ ('File deleted.'));
 $this->redirect ('/designer');
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/designer/handlers/edit/layout.php elefant-elefant_1_3_10_beta/apps/designer/handlers/edit/layout.php
--- elefant-elefant_1_3_9_beta/apps/designer/handlers/edit/layout.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/designer/handlers/edit/layout.php	2014-12-03 23:59:25.000000000 -0600
@@ -8,7 +8,7 @@
 
 $this->require_acl ('admin', 'designer');
 
-if (! preg_match ('/^(layouts|layouts\/[a-z0-9_-]+)\/[a-z0-9_-]+\.html$/i', $_GET['file'])) {
+if (! preg_match ('/^(layouts|layouts\/[a-z0-9 _-]+|layouts\/[a-z0-9 _-]+\/[a-z0-9 _-]+)\/[a-z0-9 _-]+\.html$/i', $_GET['file'])) {
 	$this->redirect ('/designer');
 }
 
@@ -47,5 +47,3 @@
 $page->add_script ('/apps/designer/css/edit_layout.css');
 $page->add_script ('/apps/designer/js/jquery.bindWithDelay.js');
 echo $tpl->render ('designer/edit/layout', $o);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/designer/handlers/edit/stylesheet.php elefant-elefant_1_3_10_beta/apps/designer/handlers/edit/stylesheet.php
--- elefant-elefant_1_3_9_beta/apps/designer/handlers/edit/stylesheet.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/designer/handlers/edit/stylesheet.php	2014-12-03 23:59:25.000000000 -0600
@@ -8,7 +8,7 @@
 
 $this->require_acl ('admin', 'designer');
 
-if (! preg_match ('/^(css|layouts|layouts\/[a-z0-9_-]+|layouts\/[a-z0-9_-]+\/[a-z0-9_-]+)\/[a-z0-9_-]+\.css$/i', $_GET['file'])) {
+if (! preg_match ('/^(css|layouts|layouts\/[a-z0-9 _-]+|layouts\/[a-z0-9 _-]+\/[a-z0-9 _-]+)\/[a-z0-9 _-]+\.css$/i', $_GET['file'])) {
 	$this->redirect ('/designer');
 }
 
@@ -62,5 +62,3 @@
 $page->add_script ('/apps/designer/css/edit_stylesheet.css');
 $page->add_script ('/apps/designer/js/jquery.bindWithDelay.js');
 echo $tpl->render ('designer/edit/stylesheet', $o);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/designer/handlers/index.php elefant-elefant_1_3_10_beta/apps/designer/handlers/index.php
--- elefant-elefant_1_3_9_beta/apps/designer/handlers/index.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/designer/handlers/index.php	2014-12-03 23:59:25.000000000 -0600
@@ -13,6 +13,7 @@
 $out = array (
 	'layouts' => glob ('layouts/*.html'),
 	'layouts2' => glob ('layouts/*/*.html'),
+	'layouts3' => glob ('layouts/*/*/*.html'),
 	'stylesheets' => glob ('css/*.css'),
 	'stylesheets2' => glob ('layouts/*/*.css'),
 	'stylesheets3' => glob ('layouts/*/*/*.css'),
@@ -25,6 +26,12 @@
   }
 }
 
+if ($out['layouts3']) {
+  foreach ($out['layouts3'] as $name) {
+	  $out['layouts'][] = $name;
+  }
+}
+
 if ($out['stylesheets2']) {
   foreach ($out['stylesheets2'] as $name) {
 	  $out['stylesheets'][] = $name;
@@ -53,5 +60,3 @@
 
 $page->title = __ ('Designer');
 echo $tpl->render ('designer/index', $out);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/designer/handlers/installer.php elefant-elefant_1_3_10_beta/apps/designer/handlers/installer.php
--- elefant-elefant_1_3_9_beta/apps/designer/handlers/installer.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/designer/handlers/installer.php	2014-12-03 23:59:25.000000000 -0600
@@ -76,5 +76,3 @@
 		return false;
 	}
 });
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/designer/handlers/makedefault.php elefant-elefant_1_3_10_beta/apps/designer/handlers/makedefault.php
--- elefant-elefant_1_3_9_beta/apps/designer/handlers/makedefault.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/designer/handlers/makedefault.php	2014-12-03 23:59:25.000000000 -0600
@@ -37,5 +37,3 @@
 
 $this->add_notification (__ ('Default layout updated.'));
 $this->redirect ('/designer');
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/designer/handlers/preview.php elefant-elefant_1_3_10_beta/apps/designer/handlers/preview.php
--- elefant-elefant_1_3_9_beta/apps/designer/handlers/preview.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/designer/handlers/preview.php	2014-12-03 23:59:25.000000000 -0600
@@ -12,7 +12,7 @@
 if ($_SERVER['REQUEST_METHOD'] == 'GET') {
 	$page->layout = '<h1>{{title}}</h1>{{ body|none }}';
 	if (! empty ($_GET['layout'])) {
-		if (preg_match('/^layouts\/[a-z0-9\/_-]+\.html$/i', $_GET['layout']) &&
+		if (preg_match('/^layouts\/[a-z0-9\/ _-]+\.html$/i', $_GET['layout']) &&
 			file_exists($_GET['layout']) ) {
 			$page->layout = file_get_contents ($_GET['layout']);
 		}
@@ -22,5 +22,3 @@
 }
 
 echo '<p>' . __ ('This is a preview of how your layout will look.') . '</p>';
-
-?>
\ No newline at end of file
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/CONTRIBUTING.md and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/CONTRIBUTING.md are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/LICENSE and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/LICENSE are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/README.md and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/README.md are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/comment/comment.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/comment/comment.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/dialog/dialog.css and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/dialog/dialog.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/dialog/dialog.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/dialog/dialog.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/display/placeholder.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/display/placeholder.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/edit/closebrackets.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/edit/closebrackets.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/edit/closetag.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/edit/closetag.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/edit/continuecomment.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/edit/continuecomment.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/edit/continuelist.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/edit/continuelist.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/edit/matchbrackets.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/edit/matchbrackets.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/edit/trailingspace.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/edit/trailingspace.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/fold/brace-fold.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/fold/brace-fold.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/fold/foldcode.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/fold/foldcode.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/fold/indent-fold.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/fold/indent-fold.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/fold/xml-fold.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/fold/xml-fold.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/hint/html-hint.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/hint/html-hint.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/hint/javascript-hint.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/hint/javascript-hint.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/hint/pig-hint.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/hint/pig-hint.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/hint/python-hint.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/hint/python-hint.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/hint/show-hint.css and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/hint/show-hint.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/hint/show-hint.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/hint/show-hint.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/hint/xml-hint.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/hint/xml-hint.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/lint/coffeescript-lint.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/lint/coffeescript-lint.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/lint/javascript-lint.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/lint/javascript-lint.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/lint/json-lint.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/lint/json-lint.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/lint/lint.css and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/lint/lint.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/lint/lint.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/lint/lint.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/merge/dep/diff_match_patch.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/merge/dep/diff_match_patch.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/merge/merge.css and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/merge/merge.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/merge/merge.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/merge/merge.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/mode/loadmode.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/mode/loadmode.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/mode/multiplex.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/mode/multiplex.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/mode/multiplex_test.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/mode/multiplex_test.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/mode/overlay.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/mode/overlay.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/runmode/colorize.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/runmode/colorize.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/runmode/runmode-standalone.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/runmode/runmode-standalone.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/runmode/runmode.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/runmode/runmode.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/runmode/runmode.node.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/runmode/runmode.node.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/search/match-highlighter.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/search/match-highlighter.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/search/search.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/search/search.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/search/searchcursor.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/search/searchcursor.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/selection/active-line.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/selection/active-line.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/addon/selection/mark-selection.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/addon/selection/mark-selection.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/bin/compress and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/bin/compress are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/bin/lint and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/bin/lint are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/bin/source-highlight and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/bin/source-highlight are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/bower.json and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/bower.json are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/compress.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/compress.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/css/baboon.png and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/css/baboon.png are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/css/baboon_vector.svg and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/css/baboon_vector.svg are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/css/docs.css and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/css/docs.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/activeline.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/activeline.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/bidi.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/bidi.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/btree.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/btree.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/buffers.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/buffers.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/changemode.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/changemode.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/closebrackets.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/closebrackets.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/closetag.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/closetag.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/complete.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/complete.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/emacs.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/emacs.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/folding.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/folding.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/fullscreen.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/fullscreen.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/html5complete.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/html5complete.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/indentwrap.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/indentwrap.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/lint.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/lint.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/loadmode.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/loadmode.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/marker.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/marker.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/markselection.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/markselection.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/matchhighlighter.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/matchhighlighter.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/merge.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/merge.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/multiplex.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/multiplex.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/mustache.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/mustache.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/placeholder.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/placeholder.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/preview.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/preview.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/resize.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/resize.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/runmode.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/runmode.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/search.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/search.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/spanaffectswrapping_shim.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/spanaffectswrapping_shim.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/theme.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/theme.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/trailingspace.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/trailingspace.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/variableheight.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/variableheight.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/vim.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/vim.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/visibletabs.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/visibletabs.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/widget.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/widget.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/demo/xmlcomplete.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/demo/xmlcomplete.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/doc/baboon.png and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/doc/baboon.png are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/doc/baboon_vector.svg and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/doc/baboon_vector.svg are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/doc/compress.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/doc/compress.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/doc/docs.css and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/doc/docs.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/doc/internals.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/doc/internals.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/doc/manual.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/doc/manual.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/doc/modes.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/doc/modes.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/doc/oldrelease.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/doc/oldrelease.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/doc/realworld.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/doc/realworld.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/doc/reporting.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/doc/reporting.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/doc/upgrade_v2.2.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/doc/upgrade_v2.2.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/doc/upgrade_v3.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/doc/upgrade_v3.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/internals.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/internals.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/keymap/emacs.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/keymap/emacs.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/keymap/extra.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/keymap/extra.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/keymap/vim.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/keymap/vim.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/lib/codemirror.css and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/lib/codemirror.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/lib/codemirror.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/lib/codemirror.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/manual.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/manual.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/apl/apl.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/apl/apl.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/apl/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/apl/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/asterisk/asterisk.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/asterisk/asterisk.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/asterisk/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/asterisk/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/clike/clike.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/clike/clike.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/clike/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/clike/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/clike/scala.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/clike/scala.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/clojure/clojure.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/clojure/clojure.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/clojure/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/clojure/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/cobol/cobol.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/cobol/cobol.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/cobol/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/cobol/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/coffeescript/LICENSE and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/coffeescript/LICENSE are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/coffeescript/coffeescript.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/coffeescript/coffeescript.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/coffeescript/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/coffeescript/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/commonlisp/commonlisp.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/commonlisp/commonlisp.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/commonlisp/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/commonlisp/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/css/css.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/css/css.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/css/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/css/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/css/scss.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/css/scss.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/css/scss_test.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/css/scss_test.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/css/test.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/css/test.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/d/d.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/d/d.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/d/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/d/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/diff/diff.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/diff/diff.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/diff/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/diff/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/ecl/ecl.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/ecl/ecl.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/ecl/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/ecl/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/erlang/erlang.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/erlang/erlang.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/erlang/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/erlang/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/gas/gas.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/gas/gas.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/gas/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/gas/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/gfm/gfm.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/gfm/gfm.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/gfm/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/gfm/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/gfm/test.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/gfm/test.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/go/go.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/go/go.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/go/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/go/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/groovy/groovy.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/groovy/groovy.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/groovy/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/groovy/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/haml/haml.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/haml/haml.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/haml/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/haml/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/haml/test.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/haml/test.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/haskell/haskell.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/haskell/haskell.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/haskell/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/haskell/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/haxe/haxe.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/haxe/haxe.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/haxe/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/haxe/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/htmlembedded/htmlembedded.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/htmlembedded/htmlembedded.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/htmlembedded/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/htmlembedded/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/htmlmixed/htmlmixed.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/htmlmixed/htmlmixed.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/htmlmixed/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/htmlmixed/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/http/http.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/http/http.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/http/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/http/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/javascript/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/javascript/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/javascript/javascript.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/javascript/javascript.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/javascript/typescript.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/javascript/typescript.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/jinja2/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/jinja2/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/jinja2/jinja2.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/jinja2/jinja2.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/less/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/less/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/less/less.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/less/less.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/livescript/LICENSE and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/livescript/LICENSE are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/livescript/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/livescript/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/livescript/livescript.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/livescript/livescript.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/livescript/livescript.ls and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/livescript/livescript.ls are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/lua/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/lua/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/lua/lua.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/lua/lua.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/markdown/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/markdown/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/markdown/markdown.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/markdown/markdown.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/markdown/test.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/markdown/test.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/meta.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/meta.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/mirc/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/mirc/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/mirc/mirc.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/mirc/mirc.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/ntriples/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/ntriples/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/ntriples/ntriples.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/ntriples/ntriples.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/ocaml/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/ocaml/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/ocaml/ocaml.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/ocaml/ocaml.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/pascal/LICENSE and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/pascal/LICENSE are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/pascal/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/pascal/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/pascal/pascal.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/pascal/pascal.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/perl/LICENSE and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/perl/LICENSE are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/perl/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/perl/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/perl/perl.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/perl/perl.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/php/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/php/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/php/php.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/php/php.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/pig/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/pig/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/pig/pig.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/pig/pig.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/properties/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/properties/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/properties/properties.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/properties/properties.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/python/LICENSE.txt and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/python/LICENSE.txt are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/python/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/python/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/python/python.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/python/python.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/q/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/q/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/q/q.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/q/q.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/r/LICENSE and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/r/LICENSE are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/r/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/r/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/r/r.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/r/r.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/rpm/changes/changes.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/rpm/changes/changes.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/rpm/changes/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/rpm/changes/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/rpm/spec/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/rpm/spec/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/rpm/spec/spec.css and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/rpm/spec/spec.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/rpm/spec/spec.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/rpm/spec/spec.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/rst/LICENSE.txt and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/rst/LICENSE.txt are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/rst/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/rst/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/rst/rst.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/rst/rst.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/ruby/LICENSE and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/ruby/LICENSE are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/ruby/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/ruby/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/ruby/ruby.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/ruby/ruby.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/rust/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/rust/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/rust/rust.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/rust/rust.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/sass/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/sass/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/sass/sass.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/sass/sass.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/scheme/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/scheme/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/scheme/scheme.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/scheme/scheme.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/shell/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/shell/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/shell/shell.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/shell/shell.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/sieve/LICENSE and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/sieve/LICENSE are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/sieve/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/sieve/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/sieve/sieve.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/sieve/sieve.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/smalltalk/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/smalltalk/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/smalltalk/smalltalk.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/smalltalk/smalltalk.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/smarty/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/smarty/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/smarty/smarty.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/smarty/smarty.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/sparql/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/sparql/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/sparql/sparql.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/sparql/sparql.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/sql/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/sql/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/sql/sql.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/sql/sql.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/stex/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/stex/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/stex/stex.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/stex/stex.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/stex/test.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/stex/test.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/tcl/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/tcl/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/tcl/tcl.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/tcl/tcl.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/tiddlywiki/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/tiddlywiki/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/tiddlywiki/tiddlywiki.css and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/tiddlywiki/tiddlywiki.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/tiddlywiki/tiddlywiki.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/tiddlywiki/tiddlywiki.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/tiki/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/tiki/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/tiki/tiki.css and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/tiki/tiki.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/tiki/tiki.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/tiki/tiki.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/turtle/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/turtle/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/turtle/turtle.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/turtle/turtle.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/vb/LICENSE.txt and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/vb/LICENSE.txt are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/vb/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/vb/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/vb/vb.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/vb/vb.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/vbscript/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/vbscript/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/vbscript/vbscript.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/vbscript/vbscript.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/velocity/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/velocity/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/velocity/velocity.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/velocity/velocity.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/verilog/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/verilog/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/verilog/verilog.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/verilog/verilog.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/xml/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/xml/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/xml/xml.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/xml/xml.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/xquery/LICENSE and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/xquery/LICENSE are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/xquery/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/xquery/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/xquery/test.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/xquery/test.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/xquery/xquery.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/xquery/xquery.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/yaml/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/yaml/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/yaml/yaml.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/yaml/yaml.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/z80/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/z80/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/mode/z80/z80.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/mode/z80/z80.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/oldrelease.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/oldrelease.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/package.json and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/package.json are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/test/comment_test.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/test/comment_test.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/test/doc_test.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/test/doc_test.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/test/driver.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/test/driver.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/test/emacs_test.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/test/emacs_test.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/test/index.html and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/test/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/test/lint/acorn.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/test/lint/acorn.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/test/lint/lint.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/test/lint/lint.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/test/lint/parse-js.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/test/lint/parse-js.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/test/lint/walk.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/test/lint/walk.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/test/mode_test.css and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/test/mode_test.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/test/mode_test.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/test/mode_test.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/test/phantom_driver.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/test/phantom_driver.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/test/run.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/test/run.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/test/test.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/test/test.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/test/vim_test.js and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/test/vim_test.js are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/theme/ambiance-mobile.css and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/theme/ambiance-mobile.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/theme/ambiance.css and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/theme/ambiance.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/theme/blackboard.css and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/theme/blackboard.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/theme/cobalt.css and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/theme/cobalt.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/theme/eclipse.css and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/theme/eclipse.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/theme/elegant.css and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/theme/elegant.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/theme/erlang-dark.css and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/theme/erlang-dark.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/theme/lesser-dark.css and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/theme/lesser-dark.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/theme/midnight.css and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/theme/midnight.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/theme/monokai.css and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/theme/monokai.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/theme/neat.css and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/theme/neat.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/theme/night.css and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/theme/night.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/theme/rubyblue.css and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/theme/rubyblue.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/theme/solarized.css and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/theme/solarized.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/theme/twilight.css and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/theme/twilight.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/theme/vibrant-ink.css and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/theme/vibrant-ink.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/theme/xq-dark.css and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/theme/xq-dark.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/codemirror/theme/xq-light.css and elefant-elefant_1_3_10_beta/apps/designer/js/codemirror/theme/xq-light.css are identical
Files elefant-elefant_1_3_9_beta/apps/designer/js/jquery.bindWithDelay.js and elefant-elefant_1_3_10_beta/apps/designer/js/jquery.bindWithDelay.js are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/designer/lib/Functions.php elefant-elefant_1_3_10_beta/apps/designer/lib/Functions.php
--- elefant-elefant_1_3_9_beta/apps/designer/lib/Functions.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/designer/lib/Functions.php	2014-12-03 23:59:25.000000000 -0600
@@ -82,5 +82,3 @@
 		? chmod ($path, $mode)
 		: array_map ('chmod_recursive', glob ($path . '/{,.}*', GLOB_BRACE)) == chmod ($path, $mode);
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/designer/lib/GithubFetcher.php elefant-elefant_1_3_10_beta/apps/designer/lib/GithubFetcher.php
--- elefant-elefant_1_3_9_beta/apps/designer/lib/GithubFetcher.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/designer/lib/GithubFetcher.php	2014-12-03 23:59:25.000000000 -0600
@@ -167,5 +167,3 @@
 		return $res->content;
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/designer/lib/GithubInstaller.php elefant-elefant_1_3_10_beta/apps/designer/lib/GithubInstaller.php
--- elefant-elefant_1_3_9_beta/apps/designer/lib/GithubInstaller.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/designer/lib/GithubInstaller.php	2014-12-03 23:59:25.000000000 -0600
@@ -89,5 +89,3 @@
 		return $conf;
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/designer/lib/Installer.php elefant-elefant_1_3_10_beta/apps/designer/lib/Installer.php
--- elefant-elefant_1_3_9_beta/apps/designer/lib/Installer.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/designer/lib/Installer.php	2014-12-03 23:59:25.000000000 -0600
@@ -95,5 +95,3 @@
 		return false;
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/designer/lib/PclZip.php elefant-elefant_1_3_10_beta/apps/designer/lib/PclZip.php
--- elefant-elefant_1_3_9_beta/apps/designer/lib/PclZip.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/designer/lib/PclZip.php	2014-12-03 23:59:25.000000000 -0600
@@ -5689,6 +5689,3 @@
     return $p_path;
   }
   // --------------------------------------------------------------------------------
-
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/designer/lib/ZipInstaller.php elefant-elefant_1_3_10_beta/apps/designer/lib/ZipInstaller.php
--- elefant-elefant_1_3_9_beta/apps/designer/lib/ZipInstaller.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/designer/lib/ZipInstaller.php	2014-12-03 23:59:25.000000000 -0600
@@ -17,7 +17,7 @@
 			return false;
 		}
 
-		$folder = ZipInstaller::find_folder ('cache/zip');
+		$folder = Zipper::find_folder ($source['name']);
 
 		// Get config and verify it
 		if (! file_exists ($folder . '/elefant.json')) {
@@ -57,25 +57,10 @@
 	}
 
 	/**
-	 * Find the folder that the zip created.
-	 */
-	public static function find_folder ($base) {
-		$files = glob ($base . '/*');
-		foreach ($files as $file) {
-			if (is_dir ($file)) {
-				return $file;
-			}
-		}
-		return false;
-	}
-
-	/**
 	 * Remove all files and keep the cache folder clean.
 	 */
 	public static function clean () {
-		if (file_exists ('cache/zip')) {
-			rmdir_recursive ('cache/zip');
-		}
+		Zipper::clean ();
 	}
 
 	/**
@@ -129,5 +114,3 @@
 		);
 	}
 }
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/designer/lib/Zipper.php elefant-elefant_1_3_10_beta/apps/designer/lib/Zipper.php
--- elefant-elefant_1_3_9_beta/apps/designer/lib/Zipper.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/designer/lib/Zipper.php	2014-12-03 23:59:25.000000000 -0600
@@ -5,35 +5,75 @@
  * option.
  */
 class Zipper {
+	public static $folder = 'cache/zip';
 	/**
 	 * Unzip a file into the specified directory. Throws a RuntimeException
 	 * if the extraction failed.
 	 */
-	public static function unzip ($file, $to = 'cache/zip') {
+	public static function unzip ($source, $base = null) {
+		$base = $base ? $base : self::$folder;
+
 		@ini_set ('memory_limit', '256M');
 	
-		if (! is_dir ($to)) {
-			mkdir ($to);
-			chmod ($to, 0777);
+		if (! is_dir ($base)) {
+			mkdir ($base);
+			chmod ($base, 0777);
 		}
 	
 		if (class_exists ('ZipArchive')) {
 			// use ZipArchive
 			$zip = new ZipArchive;
-			$res = $zip->open ($file);
+			$res = $zip->open ($source);
 			if ($res === true) {
-				$zip->extractTo ($to);
+				$zip->extractTo ($base);
 				$zip->close ();
 			} else {
 				throw new RuntimeException ('Could not open zip file [ZipArchive].');
 			}
 		} else {
 			// use PclZip
-			$zip = new PclZip ($file);
-			if ($zip->extract (PCLZIP_OPT_PATH, $to) === 0) {
+			$zip = new PclZip ($source);
+			if ($zip->extract (PCLZIP_OPT_PATH, $base) === 0) {
 				throw new RuntimeException ('Could not extract zip file [PclZip].');
 			}
 		}
 		return true;
 	}
-}
\ No newline at end of file
+
+	/**
+	 * Find the folder that the zip created.
+	 */
+	public static function find_folder ($source, $base = null) {
+		$base = $base ? $base : self::$folder;
+
+		$folder = preg_replace ('/\.zip$/i', '', basename ($source));
+
+		// file folder matching basename
+		$files = glob ($base . '/*');
+		foreach ($files as $file) {
+			if (is_dir ($file) && basename ($file) === $folder) {
+				return $file;
+			}
+		}
+
+		// if one is zip and other is folder, return folder
+		if (count ($files) === 2) {
+			if (preg_match ('/\.zip$/i', $files[0]) && is_dir ($files[1])) {
+				return $files[1];
+			} elseif (preg_match ('/\.zip$/i', $files[1]) && is_dir ($files[0])) {
+				return $files[0];
+			}
+		}
+
+		return false;
+	}
+
+	/**
+	 * Remove all files and keep the cache folder clean.
+	 */
+	public static function clean () {
+		if (file_exists (self::$folder)) {
+			rmdir_recursive (self::$folder);
+		}
+	}
+}
diff -urBNs elefant-elefant_1_3_9_beta/apps/designer/tests/GithubFetcherTest.php elefant-elefant_1_3_10_beta/apps/designer/tests/GithubFetcherTest.php
--- elefant-elefant_1_3_9_beta/apps/designer/tests/GithubFetcherTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/designer/tests/GithubFetcherTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -45,5 +45,3 @@
 		}
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/designer/tests/ZipperTest.php elefant-elefant_1_3_10_beta/apps/designer/tests/ZipperTest.php
--- elefant-elefant_1_3_9_beta/apps/designer/tests/ZipperTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/designer/tests/ZipperTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -26,5 +26,3 @@
 		$this->assertEquals ('Test', file_get_contents ('cache/zip/zipper_test/foo.txt'));
 	}
 }
-
-?>
\ No newline at end of file
Files elefant-elefant_1_3_9_beta/apps/designer/views/add/layout.html and elefant-elefant_1_3_10_beta/apps/designer/views/add/layout.html are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/designer/views/add/stylesheet.html elefant-elefant_1_3_10_beta/apps/designer/views/add/stylesheet.html
--- elefant-elefant_1_3_9_beta/apps/designer/views/add/stylesheet.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/designer/views/add/stylesheet.html	2014-12-03 23:59:25.000000000 -0600
@@ -9,7 +9,7 @@
 	<a href="javascript:history.go(-1)" onclick="return $.cancel_autosave ('{"Are you sure you want to cancel and lose any changes?"}')">{"Cancel"}</a>
 </p>
 
-<p id="name"><strong>{"New Stylesheet"}</strong> (ex: <tt>css/<strong>name</strong>.css</tt>): <input type="text" name="name" id="name-field" size="40" value="{{ name }}" /></p>
+<p id="name"><strong>{"New Stylesheet"}</strong> (ex: <tt>layouts/<strong>theme/style</strong>.css</tt>): <input type="text" name="name" id="name-field" size="40" value="{{ name }}" /></p>
 <span class="notice" id="name-notice1">{"Please enter a name for your stylesheet."}</span>
 <span class="notice" id="name-notice2">{"Your name must be alphanumeric and not a duplicate of an existing stylesheet."}</span>
 <div class="body"><textarea name="body" id="code-body" cols="90" rows="28">{{ body }}</textarea>
Files elefant-elefant_1_3_9_beta/apps/designer/views/edit/layout.html and elefant-elefant_1_3_10_beta/apps/designer/views/edit/layout.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/views/edit/stylesheet.html and elefant-elefant_1_3_10_beta/apps/designer/views/edit/stylesheet.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/views/index.html and elefant-elefant_1_3_10_beta/apps/designer/views/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/views/installed.html and elefant-elefant_1_3_10_beta/apps/designer/views/installed.html are identical
Files elefant-elefant_1_3_9_beta/apps/designer/views/installer.html and elefant-elefant_1_3_10_beta/apps/designer/views/installer.html are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/conf/acl.php elefant-elefant_1_3_10_beta/apps/filemanager/conf/acl.php
--- elefant-elefant_1_3_9_beta/apps/filemanager/conf/acl.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/conf/acl.php	2014-12-03 23:59:25.000000000 -0600
@@ -2,4 +2,4 @@
 
 filemanager = "Upload and manage files"
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/conf/config.php elefant-elefant_1_3_10_beta/apps/filemanager/conf/config.php
--- elefant-elefant_1_3_9_beta/apps/filemanager/conf/config.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/conf/config.php	2014-12-03 23:59:25.000000000 -0600
@@ -19,4 +19,4 @@
 version = 1.3.0-beta
 platforms = desktop, tablet
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/conf/embed.php elefant-elefant_1_3_10_beta/apps/filemanager/conf/embed.php
--- elefant-elefant_1_3_9_beta/apps/filemanager/conf/embed.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/conf/embed.php	2014-12-03 23:59:25.000000000 -0600
@@ -1,5 +1,21 @@
 ; <?php /*
 
+[filemanager/photo]
+
+label = "Images: Editable Photo"
+icon = picture-o
+
+key[type] = hidden
+key[filter] = "Image::generate_key"
+
+width[label] = "Width (px)"
+width[type] = text
+width[initial] = 300
+
+height[label] = "Height (px)"
+height[type] = text
+height[initial] = 200
+
 [filemanager/slideshow]
 
 label = "Images: Slideshow"
@@ -10,6 +26,14 @@
 path[require] = "apps/filemanager/lib/Functions.php"
 path[callback] = "filemanager_list_folders"
 
+autoplay[label] = Auto-play
+autoplay[type] = select
+autoplay[require] = "apps/filemanager/lib/Functions.php"
+autoplay[callback] = "filemanager_yes_no"
+
+dimensions[label] = "Dimensions (format: WIDTHxHEIGHT)"
+dimensions[type] = text
+
 [filemanager/gallery]
 
 label = "Images: Gallery"
@@ -59,4 +83,4 @@
 file[label] = SWF Flash File
 file[type] = file
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/conf/helpers.php elefant-elefant_1_3_10_beta/apps/filemanager/conf/helpers.php
--- elefant-elefant_1_3_9_beta/apps/filemanager/conf/helpers.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/conf/helpers.php	2014-12-03 23:59:25.000000000 -0600
@@ -2,9 +2,10 @@
 
 filemanager/audio = 1
 filemanager/gallery = 1
+filemanager/photo = 1
 filemanager/slideshow = 1
 filemanager/swf = 1
 filemanager/video = 1
 filemanager/util/browser = 1
 filemanager/util/multi-file = 1
-filemanager/util/multi-image = 1
\ No newline at end of file
+filemanager/util/multi-image = 1
Files elefant-elefant_1_3_9_beta/apps/filemanager/css/colorbox/colorbox.css and elefant-elefant_1_3_10_beta/apps/filemanager/css/colorbox/colorbox.css are identical
Files elefant-elefant_1_3_9_beta/apps/filemanager/css/colorbox/controls.png and elefant-elefant_1_3_10_beta/apps/filemanager/css/colorbox/controls.png are identical
Files elefant-elefant_1_3_9_beta/apps/filemanager/css/colorbox/loading.gif and elefant-elefant_1_3_10_beta/apps/filemanager/css/colorbox/loading.gif are identical
Files elefant-elefant_1_3_9_beta/apps/filemanager/css/current.png and elefant-elefant_1_3_10_beta/apps/filemanager/css/current.png are identical
Files elefant-elefant_1_3_9_beta/apps/filemanager/css/filebrowser.css and elefant-elefant_1_3_10_beta/apps/filemanager/css/filebrowser.css are identical
Files elefant-elefant_1_3_9_beta/apps/filemanager/css/filemanager.css and elefant-elefant_1_3_10_beta/apps/filemanager/css/filemanager.css are identical
Files elefant-elefant_1_3_9_beta/apps/filemanager/css/gallery.css and elefant-elefant_1_3_10_beta/apps/filemanager/css/gallery.css are identical
Files elefant-elefant_1_3_9_beta/apps/filemanager/css/gallery_embedded.css and elefant-elefant_1_3_10_beta/apps/filemanager/css/gallery_embedded.css are identical
Files elefant-elefant_1_3_9_beta/apps/filemanager/css/icon-swf.png and elefant-elefant_1_3_10_beta/apps/filemanager/css/icon-swf.png are identical
Files elefant-elefant_1_3_9_beta/apps/filemanager/css/mediaelement/background.png and elefant-elefant_1_3_10_beta/apps/filemanager/css/mediaelement/background.png are identical
Files elefant-elefant_1_3_9_beta/apps/filemanager/css/mediaelement/bigplay.png and elefant-elefant_1_3_10_beta/apps/filemanager/css/mediaelement/bigplay.png are identical
Files elefant-elefant_1_3_9_beta/apps/filemanager/css/mediaelement/controls.png and elefant-elefant_1_3_10_beta/apps/filemanager/css/mediaelement/controls.png are identical
Files elefant-elefant_1_3_9_beta/apps/filemanager/css/mediaelement/loading.gif and elefant-elefant_1_3_10_beta/apps/filemanager/css/mediaelement/loading.gif are identical
Files elefant-elefant_1_3_9_beta/apps/filemanager/css/mediaelement/mediaelementplayer.css and elefant-elefant_1_3_10_beta/apps/filemanager/css/mediaelement/mediaelementplayer.css are identical
Files elefant-elefant_1_3_9_beta/apps/filemanager/css/multi-file.css and elefant-elefant_1_3_10_beta/apps/filemanager/css/multi-file.css are identical
Files elefant-elefant_1_3_9_beta/apps/filemanager/css/multi-image.css and elefant-elefant_1_3_10_beta/apps/filemanager/css/multi-image.css are identical
Files elefant-elefant_1_3_9_beta/apps/filemanager/css/notcurrent.png and elefant-elefant_1_3_10_beta/apps/filemanager/css/notcurrent.png are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/handlers/api.php elefant-elefant_1_3_10_beta/apps/filemanager/handlers/api.php
--- elefant-elefant_1_3_9_beta/apps/filemanager/handlers/api.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/handlers/api.php	2014-12-03 23:59:25.000000000 -0600
@@ -13,5 +13,3 @@
 	return;
 }
 $this->restful (new filemanager\API ());
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/handlers/audio.php elefant-elefant_1_3_10_beta/apps/filemanager/handlers/audio.php
--- elefant-elefant_1_3_9_beta/apps/filemanager/handlers/audio.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/handlers/audio.php	2014-12-03 23:59:25.000000000 -0600
@@ -17,5 +17,3 @@
 }
 
 echo $tpl->render ('filemanager/audio', $data);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/handlers/edit/img.php elefant-elefant_1_3_10_beta/apps/filemanager/handlers/edit/img.php
--- elefant-elefant_1_3_9_beta/apps/filemanager/handlers/edit/img.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/handlers/edit/img.php	2014-12-03 23:59:25.000000000 -0600
@@ -53,5 +53,3 @@
 	'success' => true,
 	'data' => __ ('File saved.')
 ));
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/handlers/edit.php elefant-elefant_1_3_10_beta/apps/filemanager/handlers/edit.php
--- elefant-elefant_1_3_9_beta/apps/filemanager/handlers/edit.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/handlers/edit.php	2014-12-03 23:59:25.000000000 -0600
@@ -37,5 +37,3 @@
 	$form->controller->add_notification (__ ('File saved.'));
 	$form->controller->redirect ('/filemanager/index');
 });
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/handlers/embed.php elefant-elefant_1_3_10_beta/apps/filemanager/handlers/embed.php
--- elefant-elefant_1_3_9_beta/apps/filemanager/handlers/embed.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/handlers/embed.php	2014-12-03 23:59:25.000000000 -0600
@@ -127,5 +127,3 @@
 		'data' => $out
 	));
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/handlers/gallery.php elefant-elefant_1_3_10_beta/apps/filemanager/handlers/gallery.php
--- elefant-elefant_1_3_9_beta/apps/filemanager/handlers/gallery.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/handlers/gallery.php	2014-12-03 23:59:25.000000000 -0600
@@ -125,5 +125,3 @@
 		'desc' => $data['desc']
 	)
 );
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/handlers/index.php elefant-elefant_1_3_10_beta/apps/filemanager/handlers/index.php
--- elefant-elefant_1_3_9_beta/apps/filemanager/handlers/index.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/handlers/index.php	2014-12-03 23:59:25.000000000 -0600
@@ -63,11 +63,10 @@
 	'New folder name:',
 	'Rename:',
 	'Are you sure you want to delete this file?',
+	'Are you sure you want to delete this folder and all of its contents?',
 	'Your browser does not support drag and drop file uploads.',
 	'Please upload fewer files at a time.',
 	'The following file is too large to upload'
 ));
 
 echo $tpl->render ('filemanager/index', $o);
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/handlers/mediaelement.php elefant-elefant_1_3_10_beta/apps/filemanager/handlers/mediaelement.php
--- elefant-elefant_1_3_9_beta/apps/filemanager/handlers/mediaelement.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/handlers/mediaelement.php	2014-12-03 23:59:25.000000000 -0600
@@ -10,5 +10,3 @@
 }
 
 echo $tpl->render ('filemanager/mediaelement');
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/handlers/photo.php elefant-elefant_1_3_10_beta/apps/filemanager/handlers/photo.php
--- elefant-elefant_1_3_9_beta/apps/filemanager/handlers/photo.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/handlers/photo.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,81 @@
+<?php
+
+/**
+ * Creates a space where a photo can be updated by a site admin
+ * and will be automatically resized to fit the dimensions set
+ * out in advance.
+ *
+ * Usage:
+ *
+ *     {! filemanager/photo?key=about-photo&width=150&height=200 !}
+ *
+ * Options:
+ *
+ * - key:     A unique ID for the photo spot (alphanumeric, no spaces).
+ * - width:   The width of the photo spot (default: 300).
+ * - height:  The height of the photo spot (default: 200).
+ * - alt:     Text for the alt attribute.
+ * - class:   Class name(s) for the class attribute.
+ * - default: The path to a default photo, otherwise a placehold.it image is used.
+ */
+
+if (! $this->internal) {
+	// GET request means return JSON for updated photo
+	$this->require_acl ('admin', 'filemanager');
+	$page->layout = false;
+	$data = $_GET;
+}
+
+$data['width'] = (isset ($data['width']) && is_numeric ($data['width']))
+	? $data['width']
+	: 300;
+
+$data['height'] = (isset ($data['height']) && is_numeric ($data['height']))
+	? $data['height']
+	: 200;
+
+$data['alt'] = isset ($data['alt']) ? $data['alt'] : '';
+$data['class'] = isset ($data['class']) ? $data['class'] : false;
+
+if (! isset ($data['key'])) {
+	echo '<!-- Error: Missing key value -->';
+	return;
+}
+
+if (! $this->internal) {
+	if (isset ($data['photo'])) {
+		$photo = preg_replace ('|^/files/|', '', $data['photo']);
+		if (! FileManager::verify_file ($photo)) {
+			$data['photo'] = null;
+		}
+	} else {
+		$data['photo'] = null;
+	}
+}
+
+$data['photo'] = Image::for_key ($data['key'], $data['photo']);
+
+if ($data['photo']) {
+	$data['src'] = '/' . Image::resize ($data['photo'], $data['width'], $data['height'], 'cover', 'ext');
+} elseif (isset ($data['default'])) {
+	if (preg_match ('/^https?:\/\//', $data['default'])) {
+		$data['src'] = $data['default'];
+	} else {
+		$data['src'] = '/' . Image::resize (ltrim ($data['default'], '/'), $data['width'], $data['height'], 'cover', 'ext');
+	}
+} else {
+	$data['src'] = 'http://placehold.it/' . $data['width'] . 'x' . $data['height'];
+}
+
+if (! $this->internal) {
+	header ('Content-Type: application/json');
+	echo json_encode (array ('success' => true, 'data' => $data));
+	return;
+}
+
+if (User::is_valid () && User::require_acl ('admin', 'filemanager')) {
+	echo $this->run ('filemanager/util/browser');
+	$page->add_script ('/apps/filemanager/js/jquery.photoswitcher.js');
+}
+
+echo $tpl->render ('filemanager/photo', $data);
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/handlers/properties.php elefant-elefant_1_3_10_beta/apps/filemanager/handlers/properties.php
--- elefant-elefant_1_3_9_beta/apps/filemanager/handlers/properties.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/handlers/properties.php	2014-12-03 23:59:25.000000000 -0600
@@ -22,5 +22,3 @@
 );
 
 echo json_encode ($out);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/handlers/proxy.php elefant-elefant_1_3_10_beta/apps/filemanager/handlers/proxy.php
--- elefant-elefant_1_3_9_beta/apps/filemanager/handlers/proxy.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/handlers/proxy.php	2014-12-03 23:59:25.000000000 -0600
@@ -21,5 +21,3 @@
 }
 
 $this->permanent_redirect ('/files/' . join ('/', $this->params));
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/handlers/redactor/images.php elefant-elefant_1_3_10_beta/apps/filemanager/handlers/redactor/images.php
--- elefant-elefant_1_3_9_beta/apps/filemanager/handlers/redactor/images.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/handlers/redactor/images.php	2014-12-03 23:59:25.000000000 -0600
@@ -32,5 +32,3 @@
 }
 
 echo stripslashes (json_encode ($images));
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/handlers/redactor/upload.php elefant-elefant_1_3_10_beta/apps/filemanager/handlers/redactor/upload.php
--- elefant-elefant_1_3_9_beta/apps/filemanager/handlers/redactor/upload.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/handlers/redactor/upload.php	2014-12-03 23:59:25.000000000 -0600
@@ -57,5 +57,3 @@
 } else {
 	echo json_encode (array ('error' => __ ('Failed to save file') . ': ' . $_FILES['file']['name']));
 }
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/handlers/settings.php elefant-elefant_1_3_10_beta/apps/filemanager/handlers/settings.php
--- elefant-elefant_1_3_9_beta/apps/filemanager/handlers/settings.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/handlers/settings.php	2014-12-03 23:59:25.000000000 -0600
@@ -36,5 +36,3 @@
     $form->controller->add_notification (__ ('Settings saved.'));
     $form->controller->redirect ('/filemanager/index');
 });
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/handlers/slideshow.php elefant-elefant_1_3_10_beta/apps/filemanager/handlers/slideshow.php
--- elefant-elefant_1_3_9_beta/apps/filemanager/handlers/slideshow.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/handlers/slideshow.php	2014-12-03 23:59:25.000000000 -0600
@@ -17,69 +17,117 @@
  * The `filelist` is a list of images inside `/files/` or the directory set
  * by the `filemanager_path` option in your config file.
  * `filelist` can either be an array or a string with each file path delimited
- * by `|`.
+ * by `|` or a glob pattern like 'stuff/*_light.jpg'.
  * `idsuffix` will be appended to the CSS id of the slideshow.
+ *
+ * To limit the photo dimensions to a certain size, add a `dimensions`
+ * parameter in the form `WIDTHxHEIGH`, for example:
+ *
+ *     {! filemanager/slideshow?path=foldername&dimensions=500x300 !}
+ *
+ * Note that this will also reorient photos that have been uploaded from
+ * devices that don't automatically correct the photo orientation, based
+ * the EXIF metadata.
  */
 $root = trim (conf ('Paths', 'filemanager_path'), '/') . '/';
 
+if (! isset ($data['autoplay']) || $data['autoplay'] === 'yes') {
+	$timeout = '6000';
+} else {
+	$timeout = '0';
+}
+
 if (isset ($data['path']) or isset ($_GET['path'])) {
 
-        if (isset ($data['path'])) {
-                $path = trim ($data['path'], '/');
-        } elseif (isset ($_GET['path'])) {
-                $path = trim ($_GET['path'], '/');
-        }
-
-        if (strpos ($path, '..') !== false) {
-                return;
-        }
-
-        if ( ! @is_dir ($root . $path)) {
-                return;
-        }
+	if (isset ($data['path'])) {
+		$path = trim ($data['path'], '/');
+	} elseif (isset ($_GET['path'])) {
+		$path = trim ($_GET['path'], '/');
+	}
+
+	if (strpos ($path, '..') !== false) {
+		return;
+	}
+
+	if ( ! @is_dir ($root . $path)) {
+		return;
+	}
 
-        $name = str_replace ('/', '-', $path);
+	$name = str_replace ('/', '-', $path);
 
-        $files = glob ($root . $path . '/*.{jpg,jpeg,gif,png,JPG,JPEG,GIF,PNG}', GLOB_BRACE);
-        $files = is_array ($files) ? $files : array ();
+	$files = glob ($root . $path . '/*.{jpg,jpeg,gif,png,JPG,JPEG,GIF,PNG}', GLOB_BRACE);
+	$files = is_array ($files) ? $files : array ();
 } elseif (isset ($data['files']) or isset ($_GET['files'])) {
 
-        if (isset ($data['files'])) {
-                $files_arg = $data['files'];
-        } elseif (isset ($_GET['files'])) {
-                $files_arg = $_GET['files'];
-        }
-
-        if (is_string ($files_arg)) {
-                $files = explode ('|', $files_arg);
-        } elseif (is_array ($files_arg)) {
-                $files = $files_arg;
-        } else {
-                return;
-        }
+	if (isset ($data['files'])) {
+		$files_arg = $data['files'];
+	} elseif (isset ($_GET['files'])) {
+		$files_arg = $_GET['files'];
+	}
+
+	$addroot = true;
+	if (is_string ($files_arg)) {
+		if (strpos($files_arg,'|') !== false) {
+			$files = explode ('|', $files_arg);
+		} elseif (strpos($files_arg,'*') !== false || strpos($files_arg,'?') !== false) {
+			if (strpos ($files_arg, '..') !== false) {
+				return;
+			}
+			$files = glob ($root .  $files_arg, GLOB_BRACE);
+			$files = is_array ($files) ? $files : array ();
+			$addroot = false;
+		} else {
+			return;
+		}
+	} elseif (is_array ($files_arg)) {
+		$files = $files_arg;
+	} else {
+		return;
+	}
 
+    if ($addroot) {
         $files = array_map (
-                function($var) use ($root) {
-                        return ($root . trim ($var, '/'));
-                }
-                , $files);
-
-        if (isset ($data['name'])) {
-                $name = $data['name'];
-        } elseif (isset ($_GET['name'])) {
-                $name = $_GET['name'];
-        }
+            function($var) use ($root) {
+                return ($root . trim ($var, '/'));
+            }
+            , $files);
+    }
+
+	if (isset ($data['name'])) {
+		$name = $data['name'];
+	} elseif (isset ($_GET['name'])) {
+		$name = $_GET['name'];
+	}
 } else {
-        return;
+	return;
+}
+
+if (isset ($data['dimensions']) && strpos ($data['dimensions'], 'x')) {
+	list ($width, $height) = explode ('x', $data['dimensions']);
+	$width = (int) $width;
+	$height = (int) $height;
+	$files = array_map (
+		function ($file) use ($width, $height) {
+			Image::reorient ($file);
+			return Image::resize ($file, $width, $height);
+		},
+		$files
+	);
 }
 
 // rewrite if proxy is set
 if ($appconf['General']['proxy_handler']) {
-        foreach ($files as $k => $file) {
-                $files[$k] = str_replace ($root, 'filemanager/proxy/', $file);
-        }
+	foreach ($files as $k => $file) {
+		$files[$k] = str_replace ($root, 'filemanager/proxy/', $file);
+	}
 }
 
-$page -> add_script ('/apps/filemanager/js/jquery.cycle.all.min.js');
-echo $tpl -> render ('filemanager/slideshow', array ('files' => $files, 'name' => $name));
-?>
\ No newline at end of file
+$page->add_script ('/apps/filemanager/js/jquery.cycle.all.min.js');
+echo $tpl->render (
+	'filemanager/slideshow', 
+	array (
+		'files' => $files,
+		'name' => $name,
+		'timeout' => $timeout
+	)
+);
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/handlers/swf.php elefant-elefant_1_3_10_beta/apps/filemanager/handlers/swf.php
--- elefant-elefant_1_3_9_beta/apps/filemanager/handlers/swf.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/handlers/swf.php	2014-12-03 23:59:25.000000000 -0600
@@ -13,5 +13,3 @@
 }
 
 echo $tpl->render ('filemanager/swf', $data);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/handlers/upgrade.php elefant-elefant_1_3_10_beta/apps/filemanager/handlers/upgrade.php
--- elefant-elefant_1_3_9_beta/apps/filemanager/handlers/upgrade.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/handlers/upgrade.php	2014-12-03 23:59:25.000000000 -0600
@@ -36,5 +36,3 @@
 echo '<p>' . __ ('Done.') . '</p>';
 
 $this->mark_installed ('filemanager', $appconf['Admin']['version']);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/handlers/upload/drop.php elefant-elefant_1_3_10_beta/apps/filemanager/handlers/upload/drop.php
--- elefant-elefant_1_3_9_beta/apps/filemanager/handlers/upload/drop.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/handlers/upload/drop.php	2014-12-03 23:59:25.000000000 -0600
@@ -37,6 +37,9 @@
 	return;
 }
 
+// some browsers may urlencode the file name
+$_FILES['file']['name'] = urldecode ($_FILES['file']['name']);
+
 if (@file_exists ($root . $_POST['path'] . '/' . $_FILES['file']['name'])) {
 	echo json_encode (array ('success' => false, 'error' => __ ('A file by that name already exists.')));
 	return;
@@ -57,5 +60,3 @@
 }
 
 echo json_encode (array ('success' => true, 'data' => __ ('File saved.')));
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/handlers/upload.php elefant-elefant_1_3_10_beta/apps/filemanager/handlers/upload.php
--- elefant-elefant_1_3_9_beta/apps/filemanager/handlers/upload.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/handlers/upload.php	2014-12-03 23:59:25.000000000 -0600
@@ -42,6 +42,7 @@
 }
 
 for ($i = 0; $i < count ($_FILES['file']['name']); $i++) {
+	$_FILES['file']['name'][$i] = urldecode ($_FILES['file']['name'][$i]);
 	if (@file_exists ($root . $_POST['path'] . '/' . $_FILES['file']['name'][$i])) {
 		$page->title = __ ('File Already Exists') . ': ' . $_FILES['file']['name'][$i];
 		echo '<p>' . __ ('A file by that name already exists.') . '</p>';
@@ -80,5 +81,3 @@
 	$this->add_notification (__ ('File saved.'));
 }
 $this->redirect ('/filemanager?path=' . $_POST['path']);
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/handlers/util/browser.php elefant-elefant_1_3_10_beta/apps/filemanager/handlers/util/browser.php
--- elefant-elefant_1_3_9_beta/apps/filemanager/handlers/util/browser.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/handlers/util/browser.php	2014-12-03 23:59:25.000000000 -0600
@@ -37,7 +37,7 @@
  * - title:     A custom title for the dialog window.
  */
 
-$this->run ('admin/util/modal');
+echo $this->run ('admin/util/modal');
 
 $page->add_style ('/apps/filemanager/css/filebrowser.css');
 $page->add_script (
@@ -70,5 +70,3 @@
 		)
 	)
 );
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/handlers/util/multi-file.php elefant-elefant_1_3_10_beta/apps/filemanager/handlers/util/multi-file.php
--- elefant-elefant_1_3_9_beta/apps/filemanager/handlers/util/multi-file.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/handlers/util/multi-file.php	2014-12-03 23:59:25.000000000 -0600
@@ -41,8 +41,8 @@
  * - preview: The selector of an element to use to contain the list preview.
  */
 
-$this->run ('filemanager/util/browser');
-$this->run ('admin/util/fontawesome');
+echo $this->run ('filemanager/util/browser');
+echo $this->run ('admin/util/fontawesome');
 
 $page->add_style ('/apps/filemanager/css/multi-file.css');
 $page->add_script (
@@ -57,5 +57,3 @@
 	'Click to remove',
 	'Browse files'
 ));
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/handlers/util/multi-image.php elefant-elefant_1_3_10_beta/apps/filemanager/handlers/util/multi-image.php
--- elefant-elefant_1_3_9_beta/apps/filemanager/handlers/util/multi-image.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/handlers/util/multi-image.php	2014-12-03 23:59:25.000000000 -0600
@@ -41,7 +41,7 @@
  * - preview: The selector of an element to use to contain the list preview.
  */
 
-$this->run ('filemanager/util/browser');
+echo $this->run ('filemanager/util/browser');
 
 $page->add_style ('/apps/filemanager/css/multi-image.css');
 $page->add_script (
@@ -56,5 +56,3 @@
 	'Click to remove, drag to re-order',
 	'Browse images'
 ));
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/handlers/video.php elefant-elefant_1_3_10_beta/apps/filemanager/handlers/video.php
--- elefant-elefant_1_3_9_beta/apps/filemanager/handlers/video.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/handlers/video.php	2014-12-03 23:59:25.000000000 -0600
@@ -17,5 +17,3 @@
 }
 
 echo $tpl->render ('filemanager/video', $data);
-
-?>
\ No newline at end of file
Files elefant-elefant_1_3_9_beta/apps/filemanager/js/expressInstall.swf and elefant-elefant_1_3_10_beta/apps/filemanager/js/expressInstall.swf are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/js/filemanager.js elefant-elefant_1_3_10_beta/apps/filemanager/js/filemanager.js
--- elefant-elefant_1_3_9_beta/apps/filemanager/js/filemanager.js	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/js/filemanager.js	2014-12-03 23:59:25.000000000 -0600
@@ -70,7 +70,7 @@
 			throw new Error ('filemanager.mkdir() - Missing parameter: name');
 		}
 
-		$.get (
+		$.post (
 			self.prefix + 'mkdir/' + opts.path + '/' + opts.name,
 			callback
 		);
@@ -82,12 +82,24 @@
 			throw new Error ('filemanager.rm() - Missing parameter: path');
 		}
 
-		$.get (
+		$.post (
 			self.prefix + 'rm/' + opts.path,
 			callback
 		);
 	};
 
+	// Delete a folder
+	self.rmdir = function (opts, callback) {
+		if (! _has (opts, 'path')) {
+			throw new Error ('filemanager.rmdir() - Missing parameter: path');
+		}
+
+		$.post (
+			self.prefix + 'rmdir/' + opts.path,
+			callback
+		);
+	};
+
 	// Rename a file
 	self.mv = function (opts, callback) {
 		if (! _has (opts, 'path')) {
@@ -98,9 +110,9 @@
 			throw new Error ('filemanager.mv() - Missing parameter: rename');
 		}
 
-		$.get (
-			self.prefix + 'rm/' + opts.path
-				+ '?rename=' + encodeURIComponent (opts.rename),
+		$.post (
+			self.prefix + 'rm/' + opts.path,
+			{rename: opts.rename},
 			callback
 		);
 	};
@@ -115,9 +127,9 @@
 			throw new Error ('filemanager.drop() - Missing parameter: folder');
 		}
 
-		$.get (
-			self.prefix + 'drop/' + opts.path
-				+ '?folder=' + encodeURIComponent (opts.folder),
+		$.post (
+			self.prefix + 'drop/' + opts.path,
+			{folder: opts.folder},
 			callback
 		);
 	};
@@ -136,10 +148,9 @@
 			throw new Error ('filemanager.prop() - Missing parameter: value');
 		}
 
-		$.get (
-			self.prefix + 'prop/' + opts.path
-				+ '?prop=' + encodeURIComponent (opts.prop)
-				+ '&value=' + encodeURIComponent (opts.value),
+		$.post (
+			self.prefix + 'prop/' + opts.path,
+			{prop: opts.prop, value: opts.value},
 			callback
 		);
 	};
Files elefant-elefant_1_3_9_beta/apps/filemanager/js/flashmediaelement.swf and elefant-elefant_1_3_10_beta/apps/filemanager/js/flashmediaelement.swf are identical
Files elefant-elefant_1_3_9_beta/apps/filemanager/js/jquery.colorbox.min.js and elefant-elefant_1_3_10_beta/apps/filemanager/js/jquery.colorbox.min.js are identical
Files elefant-elefant_1_3_9_beta/apps/filemanager/js/jquery.cycle.all.min.js and elefant-elefant_1_3_10_beta/apps/filemanager/js/jquery.cycle.all.min.js are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/js/jquery.filebrowser.js elefant-elefant_1_3_10_beta/apps/filemanager/js/jquery.filebrowser.js
--- elefant-elefant_1_3_9_beta/apps/filemanager/js/jquery.filebrowser.js	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/js/jquery.filebrowser.js	2014-12-03 23:59:25.000000000 -0600
@@ -300,7 +300,7 @@
 				fallback_id: 'filebrowser-file',
 				url: '/filemanager/upload/drop',
 				paramname: 'file',
-				withCredentials: true,
+				withCredentials: (navigator.userAgent.indexOf('MSIE') === -1) ? true : false,
 				data: {
 					path: function () {
 						return self.opts.path;
@@ -400,6 +400,13 @@
 					$('#filebrowser-upload-progress-bar').css ('width', progress + '%');
 				}
 			});
+			
+			// filedrop hides the input, show it again
+			$('#filebrowser-file').css ({
+				display: 'inline',
+				width: 'auto',
+				height: 'auto'
+			});
 		}
 	};
 })(jQuery);
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/js/jquery.filedrop.js elefant-elefant_1_3_10_beta/apps/filemanager/js/jquery.filedrop.js
--- elefant-elefant_1_3_9_beta/apps/filemanager/js/jquery.filedrop.js	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/js/jquery.filedrop.js	2014-12-03 23:59:25.000000000 -0600
@@ -34,6 +34,8 @@
       url: '',
       refresh: 1000,
       paramname: 'userfile',
+      requestType: 'POST',    // just in case you want to use another HTTP verb
+      allowedfileextensions:[],
       allowedfiletypes:[],
       maxfiles: 25,           // Ignored if queuefiles is set > 0
       maxfilesize: 1,         // MB file size limit
@@ -61,19 +63,28 @@
       globalProgressUpdated: empty,
       speedUpdated: empty
       },
-      errors = ["BrowserNotSupported", "TooManyFiles", "FileTooLarge", "FileTypeNotAllowed", "NotFound", "NotReadable", "AbortError", "ReadError"],
-      doc_leave_timer, stop_loop = false,
-      files_count = 0,
-      files,
-      useBinaryUrl = window.FileReader && !jQuery.isFunction(window.FileReader.prototype.readAsBinaryString);
+      errors = ["BrowserNotSupported", "TooManyFiles", "FileTooLarge", "FileTypeNotAllowed", "NotFound", "NotReadable", "AbortError", "ReadError", "FileExtensionNotAllowed"];
 
   $.fn.filedrop = function(options) {
     var opts = $.extend({}, default_opts, options),
-        global_progress = [];
+        global_progress = [],
+        doc_leave_timer, stop_loop = false,
+        files_count = 0,
+        files;
+
+    $('#' + opts.fallback_id).css({
+      display: 'none',
+      width: 0,
+      height: 0
+    });
 
     this.on('drop', drop).on('dragstart', opts.dragStart).on('dragenter', dragEnter).on('dragover', dragOver).on('dragleave', dragLeave);
     $(document).on('drop', docDrop).on('dragenter', docEnter).on('dragover', docOver).on('dragleave', docLeave);
 
+    this.on('click', function(e){
+      $('#' + opts.fallback_id).trigger(e);
+    });
+
     $('#' + opts.fallback_id).change(function(e) {
       opts.drop(e);
       files = e.target.files;
@@ -83,6 +94,8 @@
 
     function drop(e) {
       if( opts.drop.call(this, e) === false ) return false;
+      if(!e.dataTransfer)
+        return;
       files = e.dataTransfer.files;
       if (files === null || files === undefined || files.length === 0) {
         opts.error(errors[0]);
@@ -97,16 +110,21 @@
     function getBuilder(filename, filedata, mime, boundary) {
       var dashdash = '--',
           crlf = '\r\n',
-          builder = '';
+          builder = '',
+          paramname = opts.paramname;
 
       if (opts.data) {
-        var params = $.param(opts.data).split(/&/);
+        var params = $.param(opts.data).replace(/\+/g, '%20').split(/&/);
 
         $.each(params, function() {
           var pair = this.split("=", 2),
               name = decodeURIComponent(pair[0]),
               val  = decodeURIComponent(pair[1]);
 
+          if (pair.length !== 2) {
+              return;
+          }
+
           builder += dashdash;
           builder += boundary;
           builder += crlf;
@@ -118,24 +136,22 @@
         });
       }
 
+      if (jQuery.isFunction(paramname)){
+        paramname = paramname(filename);
+      }
+
       builder += dashdash;
       builder += boundary;
       builder += crlf;
-      builder += 'Content-Disposition: form-data; name="' + opts.paramname + '"';
-      builder += '; filename="' + filename + '"';
+      builder += 'Content-Disposition: form-data; name="' + (paramname||"") + '"';
+      builder += '; filename="' + encodeURIComponent(filename) + '"';
       builder += crlf;
 
       builder += 'Content-Type: ' + mime;
       builder += crlf;
       builder += crlf;
 
-      if (useBinaryUrl) {
-      	if (filedata !== null) {
-          builder += atob(filedata.split(',')[1]);
-        }
-      } else {
-        builder += filedata;
-      }
+      builder += filedata;
       builder += crlf;
 
       builder += dashdash;
@@ -202,6 +218,23 @@
         }
       }
 
+      if (opts.allowedfileextensions.push && opts.allowedfileextensions.length) {
+        for(var fileIndex = files.length;fileIndex--;) {
+          var allowedextension = false;
+          for (i=0;i<opts.allowedfileextensions.length;i++){
+            if (files[fileIndex].name.substr(files[fileIndex].name.length-opts.allowedfileextensions[i].length).toLowerCase()
+                    == opts.allowedfileextensions[i].toLowerCase()
+            ) {
+              allowedextension = true;
+            }
+          }
+          if (!allowedextension){
+            opts.error(errors[8], files[fileIndex]);
+            return false;
+          }
+        }
+      }
+
       var filesDone = 0,
           filesRejected = 0;
 
@@ -289,12 +322,8 @@
             reader.onloadend = !opts.beforeSend ? send : function (e) {
               opts.beforeSend(files[fileIndex], fileIndex, function () { send(e); });
             };
-            
-            if (!useBinaryUrl) {
-                reader.readAsBinaryString(files[fileIndex]);
-            } else {
-            	reader.readAsDataURL(files[fileIndex]);
-            }
+
+            reader.readAsDataURL(files[fileIndex]);
 
           } else {
             filesRejected++;
@@ -306,7 +335,6 @@
               processingQueue.splice(key, 1);
             }
           });
-          if (window.console){ console.error(err); }
           opts.error(errors[0]);
           return false;
         }
@@ -319,7 +347,7 @@
 
       var send = function(e) {
 
-        var fileIndex = ((typeof(e.srcElement) === "undefined") || e.srcElement === null? e.target : e.srcElement).index;
+        var fileIndex = (e.srcElement || e.target).index;
 
         // Sometimes the index is not attached to the
         // event object. Find it by size. Hack for sure.
@@ -338,10 +366,15 @@
             newName = rename(file.name),
             mime = file.type;
 
+        if (opts.withCredentials) {
+          xhr.withCredentials = opts.withCredentials;
+        }
+
+        var data = atob(e.target.result.split(',')[1]);
         if (typeof newName === "string") {
-          builder = getBuilder(newName, e.target.result, mime, boundary);
+          builder = getBuilder(newName, data, mime, boundary);
         } else {
-          builder = getBuilder(file.name, e.target.result, mime, boundary);
+          builder = getBuilder(file.name, data, mime, boundary);
         }
 
         upload.index = index;
@@ -353,24 +386,32 @@
         upload.startData = 0;
         upload.addEventListener("progress", progress, false);
 
-		// Allow url to be a method
-		if (jQuery.isFunction(opts.url)) {
-	        xhr.open("POST", opts.url(), true);
-	    } else {
-	    	xhr.open("POST", opts.url, true);
-	    }
-
-        if (opts.withCredentials) {
-          xhr.withCredentials = opts.withCredentials;
+        // Allow url to be a method
+        if (jQuery.isFunction(opts.url)) {
+            xhr.open(opts.requestType, opts.url(), true);
+        } else {
+            xhr.open(opts.requestType, opts.url, true);
         }
-	    
+
         xhr.setRequestHeader('content-type', 'multipart/form-data; boundary=' + boundary);
+        xhr.setRequestHeader("X-Requested-With", "XMLHttpRequest");
 
         // Add headers
         $.each(opts.headers, function(k, v) {
           xhr.setRequestHeader(k, v);
         });
 
+          if(!xhr.sendAsBinary){
+              xhr.sendAsBinary = function(datastr) {
+                  function byteValue(x) {
+                      return x.charCodeAt(0) & 0xff;
+                  }
+                  var ords = Array.prototype.map.call(datastr, byteValue);
+                  var ui8a = new Uint8Array(ords);
+                  this.send(ui8a.buffer);
+              }
+          }
+          
         xhr.sendAsBinary(builder);
 
         global_progress[global_progress_index] = 0;
@@ -415,7 +456,7 @@
             if (result === false) {
               stop_loop = true;
             }
-          
+
 
           // Pass any errors to the error option
           if (xhr.status < 200 || xhr.status > 299) {
@@ -512,7 +553,15 @@
       }
       var ords = Array.prototype.map.call(datastr, byteValue);
       var ui8a = new Uint8Array(ords);
-      this.send(ui8a.buffer);
+
+      // Not pretty: Chrome 22 deprecated sending ArrayBuffer, moving instead
+      // to sending ArrayBufferView.  Sadly, no proper way to detect this
+      // functionality has been discovered.  Happily, Chrome 22 also introduced
+      // the base ArrayBufferView class, not present in Chrome 21.
+      if ('ArrayBufferView' in window)
+        this.send(ui8a);
+      else
+        this.send(ui8a.buffer);
     };
   } catch (e) {}
 
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/js/jquery.filemanager.js elefant-elefant_1_3_10_beta/apps/filemanager/js/jquery.filemanager.js
--- elefant-elefant_1_3_9_beta/apps/filemanager/js/jquery.filemanager.js	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/js/jquery.filemanager.js	2014-12-03 23:59:25.000000000 -0600
@@ -9,6 +9,7 @@
 		aviary_current: false,
 		text_file: /\.(txt|html?|xml|md|csv|css|js|json)$/i,
 		img_file: /\.(gif|png|jpe?g)$/i,
+		zip_file: /\.zip$/i,
 		max_filesize: 2,
 		strings: {
 			
@@ -28,7 +29,7 @@
 				case 'mkdir':
 					var name = downcode ( prompt ($.i18n ('New folder name:'), ''), dir_length );
 					if (name) {
-						$.get (options.root + cmd + '/' + options.file + '/' + name, function (res) {
+						$.post (options.root + cmd + '/' + options.file + '/' + name, function (res) {
 							if (res.success) {
 								$.add_notification (res.data.msg);
 								window.location = '/filemanager?path=' + res.data.data;
@@ -41,7 +42,7 @@
 				case 'mv':
 					var name = downcode ( prompt ($.i18n ('Rename:'), options.name), dir_length);
 					if (name) {
-						$.get (options.root + cmd + '/' + options.file + '?rename=' + name, function (res) {
+						$.post (options.root + cmd + '/' + options.file, {rename: name}, function (res) {
 							if (res.success) {
 								$.add_notification (res.data.msg);
 								$.filemanager ('ls', {file: filemanager.path});
@@ -52,7 +53,7 @@
 					}
 					break;
 				case 'drop':
-					$.get (options.root + cmd + '/' + options.file + '?folder=' + options.folder, function (res) {
+					$.post (options.root + cmd + '/' + options.file, {folder: options.folder}, function (res) {
 						if (res.success) {
 							$.add_notification (res.data.msg);
 							$.filemanager ('ls', {file: filemanager.path});
@@ -63,7 +64,19 @@
 					break;
 				case 'rm':
 					if (confirm ($.i18n ('Are you sure you want to delete this file?'))) {
-						$.get (options.root + cmd + '/' + options.file, function (res) {
+						$.post (options.root + cmd + '/' + options.file, function (res) {
+							if (res.success) {
+								$.add_notification (res.data.msg);
+								$.filemanager ('ls', {file: filemanager.path});
+							} else {
+								$.add_notification (res.error);
+							}
+						});
+					}
+					break;
+				case 'rmdir':
+					if (confirm ($.i18n ('Are you sure you want to delete this folder and all of its contents?'))) {
+						$.post (options.root + cmd + '/' + options.file, function (res) {
 							if (res.success) {
 								$.add_notification (res.data.msg);
 								$.filemanager ('ls', {file: filemanager.path});
@@ -92,6 +105,7 @@
 									res.data.files[i].image_file = (filemanager.aviary !== null)
 										? res.data.files[i].name.match (filemanager.img_file)
 										: false;
+									res.data.files[i].zip_file = res.data.files[i].name.match (filemanager.zip_file);
 									res.data.files[i].text_file = res.data.files[i].name.match (filemanager.text_file);
 									res.data.files[i]._name = res.data.files[i].name.replace (/'/g, '\\\'');
 									res.data.files[i]._path = res.data.files[i].path.replace (/'/g, '\\\'');
@@ -130,7 +144,7 @@
 					break;
 				case 'prop':
 					// display properties dialogue
-					$.get ('/filemanager/properties/' + options.file, function (res) {
+					$.post ('/filemanager/properties/' + options.file, function (res) {
 						$.open_dialog (
 							res.title,
 							res.body
@@ -148,6 +162,17 @@
 						url: url
 					});
 					break;
+				case 'unzip':
+					// unzip an archive
+					$.post (options.root + cmd + '/' + options.file, function (res) {
+						if (! res.success) {
+							$.add_notification (res.error);
+							return;
+						}
+						$.add_notification (res.data.msg);
+						$.filemanager ('ls', {file: filemanager.path});
+					});
+					break;
 			}
 			return false;
 		}
@@ -181,7 +206,7 @@
 			fallback_id: 'file-upload',
 			url: '/filemanager/upload/drop',
 			paramname: 'file',
-			withCredentials: true,
+			withCredentials: (navigator.userAgent.indexOf('MSIE') === -1) ? true : false,
 			data: {
 				path: function () {
 					return filemanager.path
@@ -256,6 +281,13 @@
 				$('#filemanager-upload-progress-bar').css ('width', progress + '%');
 			}
 		});
+			
+		// filedrop hides the input, show it again
+		$('#file-upload').css ({
+			display: 'inline',
+			width: 'auto',
+			height: 'auto'
+		});
 	};
 
 	function show_progress_bar () {
@@ -277,7 +309,7 @@
 		var file = form.elements.file.value,
 			desc = form.elements.desc.value;
 
-		$.get ('/filemanager/api/prop/' + file + '?prop=desc&value=' + encodeURIComponent (desc), function (res) {
+		$.post ('/filemanager/api/prop/' + file, {prop: 'desc', value: desc}, function (res) {
 			$.close_dialog ();
 			$.add_notification (res.data.msg);
 		});
Files elefant-elefant_1_3_9_beta/apps/filemanager/js/jquery.multi-file.js and elefant-elefant_1_3_10_beta/apps/filemanager/js/jquery.multi-file.js are identical
Files elefant-elefant_1_3_9_beta/apps/filemanager/js/jquery.multi-image.js and elefant-elefant_1_3_10_beta/apps/filemanager/js/jquery.multi-image.js are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/js/jquery.photoswitcher.js elefant-elefant_1_3_10_beta/apps/filemanager/js/jquery.photoswitcher.js
--- elefant-elefant_1_3_9_beta/apps/filemanager/js/jquery.photoswitcher.js	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/js/jquery.photoswitcher.js	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,63 @@
+/**
+ * Used by the filemanager/photo handler to provide a file browser
+ * for changing an image in place.
+ */
+(function ($) {
+	/**
+	 * Open the file browser to choose a new image.
+	 */
+	var open = function (opts, e) {
+		e.preventDefault ();
+
+		$.filebrowser ({
+			allowed: ['jpg', 'jpeg', 'png', 'gif'],
+			title: opts.title,
+			thumbs: true,
+			callback: $.proxy (update, this, opts)
+		});
+	};
+	
+	/**
+	 * Send newly chosen image to server.
+	 */
+	var update = function (opts, file) {
+		$.get (
+			'/filemanager/photo?key=' + opts.key
+				+ '&width=' + opts.width
+				+ '&height=' + opts.height
+				+ '&photo=' + file,
+			$.proxy (replace, this, opts)
+		);
+	};
+	
+	/**
+	 * Update page with newly chosen image.
+	 */
+	var replace = function (opts, res) {
+		if (! res.success) {
+			return;
+		}
+		
+		opts.src = res.data.src;
+		$(this).attr ('src', res.data.src);
+	};
+	
+	$.fn.extend ({
+		photoswitcher: function (options) {
+			var defaults = {
+				key: null,
+				src: 'http://placehold.it/300x200',
+				width: 300,
+				height: 200,
+				title: 'Choose an image'
+			};
+
+			var options = $.extend (defaults, options);
+
+			return this.each (function () {
+				var opts = options;
+				$('#photo-' + opts.key + '-wrapper').on ('click', $.proxy (open, this, opts));
+			});
+		}
+	});
+})(jQuery);
Files elefant-elefant_1_3_9_beta/apps/filemanager/js/jquery.tmpl.beta1.min.js and elefant-elefant_1_3_10_beta/apps/filemanager/js/jquery.tmpl.beta1.min.js are identical
Files elefant-elefant_1_3_9_beta/apps/filemanager/js/mediaelement-and-player.min.js and elefant-elefant_1_3_10_beta/apps/filemanager/js/mediaelement-and-player.min.js are identical
Files elefant-elefant_1_3_9_beta/apps/filemanager/js/swfobject.js and elefant-elefant_1_3_10_beta/apps/filemanager/js/swfobject.js are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/lib/API.php elefant-elefant_1_3_10_beta/apps/filemanager/lib/API.php
--- elefant-elefant_1_3_9_beta/apps/filemanager/lib/API.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/lib/API.php	2014-12-03 23:59:25.000000000 -0600
@@ -2,7 +2,7 @@
 
 namespace filemanager;
 
-use DB, FileManager, I18n, Restful;
+use DB, FileManager, I18n, Restful, Zipper;
 
 /**
  * Provides the JSON API for the admin file manager/browser, as well as functions
@@ -42,7 +42,7 @@
 	/**
 	 * Handle remove file requests (/filemanager/api/rm).
 	 */
-	public function get_rm () {
+	public function post_rm () {
 		$file = urldecode (join ('/', func_get_args ()));
 
 		$res = FileManager::unlink ($file);
@@ -56,21 +56,40 @@
 
 		return array ('msg' => __ ('File deleted.'), 'data' => $file);
 	}
+	
+	/**
+	 * Handle remove folder requests (/filemanager/api/rmdir).
+	 * Note: Erases the contents of the folder as well.
+	 */
+	public function post_rmdir () {
+		$file = urldecode (join ('/', func_get_args ()));
+
+		$res = FileManager::rmdir ($file, true);
+		if (! $res) {
+			return $this->error (FileManager::error ());
+		}
+
+		$this->controller->hook ('filemanager/delete', array (
+			'file' => $file
+		));
+
+		return array ('msg' => __ ('Folder deleted.'), 'data' => $file);
+	}
 
 	/**
 	 * Handle rename requests (/filemanager/api/mv).
 	 */
-	public function get_mv () {
+	public function post_mv () {
 		$file = urldecode (join ('/', func_get_args ()));
 
 		$is_folder = FileManager::verify_folder ($file) ? true : false;
 		
-		if (! FileManager::rename ($file, $_GET['rename'])) {
+		if (! FileManager::rename ($file, $_POST['rename'])) {
 			return $this->error (FileManager::error ());
 		}
 		$parts = explode ('/', $file);
 		$old = array_pop ($parts);
-		$new = preg_replace ('/' . preg_quote ($old) . '$/', $_GET['rename'], $file);
+		$new = preg_replace ('/' . preg_quote ($old) . '$/', $_POST['rename'], $file);
 		if ($is_folder) {
 			return array ('msg' => __ ('Folder renamed.'), 'data' => $new);
 		}
@@ -85,17 +104,17 @@
 	 * Handle drop requests (/filemanager/api/drop), which move files between
 	 * folders.
 	 */
-	public function get_drop () {
+	public function post_drop () {
 		$file = urldecode (join ('/', func_get_args ()));
 		
-		if (! FileManager::move ($file, $_GET['folder'])) {
+		if (! FileManager::move ($file, $_POST['folder'])) {
 			return $this->error (FileManager::error ());
 		}
 
-		$new = $_GET['folder'] . '/' . basename ($file);
+		$new = $_POST['folder'] . '/' . basename ($file);
 		$this->controller->hook ('filemanager/drop', array (
 			'file' => $file,
-			'folder' => $_GET['folder'],
+			'folder' => $_POST['folder'],
 			'new' => $new
 		));
 		return array ('msg' => __ ('File moved.'), 'data' => $new);
@@ -104,7 +123,7 @@
 	/**
 	 * Handle make directory requests (/filemanager/api/mkdir).
 	 */
-	public function get_mkdir () {
+	public function post_mkdir () {
 		$file = urldecode (join ('/', func_get_args ()));
 		
 		if (! FileManager::mkdir ($file)) {
@@ -117,28 +136,71 @@
 	/**
 	 * Handle property update requests (/filemanager/api/prop).
 	 */
-	public function get_prop () {
+	public function post_prop () {
 		$file = urldecode (join ('/', func_get_args ()));
-		if (! FileManager::verify_file ($file, $this->root)) {
+		if (! FileManager::verify_file ($file)) {
 			return $this->error (__ ('Invalid file name'));
 		}
-		if (! isset ($_GET['prop'])) {
+		if (! isset ($_POST['prop'])) {
 			return $this->error (__ ('Missing property name'));
 		}
-		if (isset ($_GET['value'])) {
+		if (isset ($_POST['value'])) {
 			// update and fetch
-			$res = FileManager::prop ($file, $_GET['prop'], $_GET['value']);
+			$res = FileManager::prop ($file, $_POST['prop'], $_POST['value']);
 		} else {
 			// fetch
-			$res = FileManager::prop ($file, $_GET['prop']);
+			$res = FileManager::prop ($file, $_POST['prop']);
 		}
 		return array (
 			'file' => $file,
-			'prop' => $_GET['prop'],
+			'prop' => $_POST['prop'],
 			'value' => $res,
 			'msg' => __ ('Properties saved.')
 		);
 	}
-}
+	
+	/**
+	 * Handle unzip requests via (/filemanager/api/unzip).
+	 */
+	public function post_unzip () {
+		$file = urldecode (join ('/', func_get_args ()));
+		if (! FileManager::verify_file ($file)) {
+			return $this->error (__ ('Invalid file name'));
+		}
+		
+		// make sure it's a zip file
+		if (! preg_match ('/\.zip$/i', $file)) {
+			return $this->error (__ ('Invalid file type'));
+		}
+		
+		// make sure the folder doesn't already exist
+		$folder = preg_replace ('/\.zip$/i', '', $file);
+		if (FileManager::verify_folder ($folder)) {
+			return $this->error (__ ('Folder already exists'));
+		}
+		
+		// unzip the file
+		try {
+			Zipper::unzip (FileManager::root () . $file);
+		} catch (\Exception $e) {
+			return $this->error ($e->getMessage ());
+		}
+
+		// move the unzipped folder
+		$created = Zipper::find_folder (FileManager::root () . $file);
+		error_log ($created);
+		if (! $created) {
+			if (! rename (Zipper::$folder, FileManager::root () . $folder)) {
+				return $this->error (__ ('Unable to save unzipped folder.'));
+			}
+		} elseif (! rename ($created, FileManager::root () . $folder)) {
+			return $this->error (__ ('Unable to save unzipped folder.'));
+		}
 
-?>
\ No newline at end of file
+		// return the newly-created folder
+		return array (
+			'file' => $folder,
+			'msg' => __ ('File unzipped.')
+		);
+	}
+}
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/lib/FileManager.php elefant-elefant_1_3_10_beta/apps/filemanager/lib/FileManager.php
--- elefant-elefant_1_3_9_beta/apps/filemanager/lib/FileManager.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/lib/FileManager.php	2014-12-03 23:59:25.000000000 -0600
@@ -515,5 +515,3 @@
 		return true;
 	}
 }
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/lib/Functions.php elefant-elefant_1_3_10_beta/apps/filemanager/lib/Functions.php
--- elefant-elefant_1_3_9_beta/apps/filemanager/lib/Functions.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/lib/Functions.php	2014-12-03 23:59:25.000000000 -0600
@@ -117,5 +117,3 @@
 function filemanager_get_thumbnail ($file, $width = 140, $height = 105, $style = "cover") {
 	return Image::resize ($file, $width, $height, $style);
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/lib/Image.php elefant-elefant_1_3_10_beta/apps/filemanager/lib/Image.php
--- elefant-elefant_1_3_9_beta/apps/filemanager/lib/Image.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/lib/Image.php	2014-12-03 23:59:25.000000000 -0600
@@ -26,17 +26,32 @@
 	 */
 	public static function resize ($file, $width = 140, $height = 105, $style = 'cover', $format = 'jpg') {
 		if (strpos ($file, '/') === 0) {
+			// trim slash in case we get an absolute path
 			$file = ltrim ($file, '/');
 		}
+		
+		if (strpos ($file, '#') !== false) {
+			// remove hashmark from previous Image:: call
+			$file = explode ('#', $file);
+			$file = $file[0];
+		}
 
-		$cache_file = 'cache/thumbs/' . md5 ($file) . '-'. $style ."-" . $width . 'x' . $height . '.' . $format;
-		if (@file_exists ($cache_file) && @filemtime ($cache_file) > @filemtime ($file)) {
-			return $cache_file;
+		if (! file_exists ($file)) {
+			return $file . '#file-missing';
 		}
 
 		$info = pathinfo ($file);
 		$ext = strtolower ($info['extension']);
 
+		if ($format === 'ext') {
+			$format = $ext;
+		}
+
+		$cache_file = 'cache/thumbs/' . md5 ($file) . '-'. $style ."-" . $width . 'x' . $height . '.' . $format;
+		if (@file_exists ($cache_file) && @filemtime ($cache_file) > @filemtime ($file)) {
+			return $cache_file;
+		}
+
 		if (! extension_loaded ('gd')) {
 			return $file . '#gd-missing';
 		}
@@ -110,6 +125,134 @@
 		@imagedestroy ($new);
 		return $cache_file;
 	}
-}
 
-?>
\ No newline at end of file
+	/**
+	 * Fixes the orientation of a JPEG image based on its exif data.
+	 * Note: Requires the exif PHP extension, or it will simply
+	 * return the original image untouched with the following
+	 * hashmark added: #exif-missing.
+	 */
+	public static function reorient ($file) {
+		if (strpos ($file, '/') === 0) {
+			// trim slash in case we get an absolute path
+			$file = ltrim ($file, '/');
+		}
+		
+		if (strpos ($file, '#') !== false) {
+			// remove hashmark from previous Image:: call
+			$file = explode ('#', $file);
+			$file = $file[0];
+		}
+
+		$info = pathinfo ($file);
+		$ext = strtolower ($info['extension']);
+		
+		if ($ext !== 'jpg' && $ext !== 'jpeg') {
+			// only jpegs have exif data
+			return $file;
+		}
+		
+		if (! extension_loaded ('exif')) {
+			return $file . '#exif-missing';
+		}
+		
+		try {
+			$exif = exif_read_data ($file);
+		} catch (Exception $e) {
+			return $file . '#exif-error';
+		}
+		$orientation = isset ($exif['Orientation']) ? $exif['Orientation'] : false;
+		if (! $orientation || $orientation === 1) {
+			// no reorientation needed :)
+			return $file;
+		}
+
+		list ($width, $height) = getimagesize ($file);
+		$new = @imagecreatetruecolor ($width, $height);
+		
+		try {
+			if (@imagetypes () & IMG_JPG) {
+				$orig = @imagecreatefromjpeg ($file);
+				@imagecopyresampled ($new, $orig, 0, 0, 0, 0, $width, $height, $width, $height);
+			} else {
+				return $file . '#libjpg-missing';
+			}
+		} catch (Exception $e) {
+			return $file . '#exception-caught';
+		}
+
+		switch ($orientation) {
+			case 3:
+				$new = @imagerotate ($new, 180, 0);
+				break;
+			case 6:
+				$new = @imagerotate ($new, -90, 0);
+				break;
+			case 8:
+				$new = @imagerotate ($new, 90, 0);
+				break;
+		}
+		
+		@imagejpeg ($new, $file);
+		@imagedestroy ($orig);
+		@imagedestroy ($new);
+		return $file;
+	}
+	
+	/**
+	 * Generate a unique key for embedded image spots.
+	 */
+	public static function generate_key ($key) {
+		if (! empty ($key)) {
+			return $key;
+		}
+		
+		if (! @is_dir ('cache/photos')) {
+			mkdir ('cache/photos');
+		}
+
+		while (true) {
+			$key = md5 (uniqid (rand (), true));
+			$file = 'cache/photos/' . $key;
+			// TODO: verify uniqueness
+			if (! file_exists ($file)) {
+				touch ($file);
+				chmod ($file, 0666);
+				break;
+			}
+		}
+
+		return $key;
+	}
+	
+	/**
+	 * Get or set the image associated with a key.
+	 */
+	public static function for_key ($key, $image = null) {
+		if (! @is_dir ('cache/photos')) {
+			mkdir ('cache/photos');
+		}
+
+		if (! preg_match ('/^[a-zA-Z0-9-]+$/', $key)) {
+			// invalid key
+			return false;
+		}
+
+		$file = 'cache/photos/' . $key;
+		
+		if ($image !== null) {
+			file_put_contents ($file, $image);
+			chmod ($file, 0666);
+		}
+		
+		if (! file_exists ($file)) {
+			return false;
+		}
+		
+		$res = file_get_contents ($file);
+		if (empty ($res)) {
+			return false;
+		}
+		return $res;
+	}
+}
Files elefant-elefant_1_3_9_beta/apps/filemanager/views/audio.html and elefant-elefant_1_3_10_beta/apps/filemanager/views/audio.html are identical
Files elefant-elefant_1_3_9_beta/apps/filemanager/views/edit.html and elefant-elefant_1_3_10_beta/apps/filemanager/views/edit.html are identical
Files elefant-elefant_1_3_9_beta/apps/filemanager/views/gallery/embedded.html and elefant-elefant_1_3_10_beta/apps/filemanager/views/gallery/embedded.html are identical
Files elefant-elefant_1_3_9_beta/apps/filemanager/views/gallery.html and elefant-elefant_1_3_10_beta/apps/filemanager/views/gallery.html are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/views/index.html elefant-elefant_1_3_10_beta/apps/filemanager/views/index.html
--- elefant-elefant_1_3_9_beta/apps/filemanager/views/index.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/views/index.html	2014-12-03 23:59:25.000000000 -0600
@@ -7,16 +7,22 @@
 		<td><div class="dropzone draggable" data-folder="${path}"><img src="/apps/admin/css/admin/folder.png" alt="${name}" style="padding-right: 5px; margin-top: -2px" /> <a href="/filemanager?path=${path}">${name}</a></div></td>
 		<td>\{{html mtime}}</td>
 		<td>&nbsp;</td>
-		<td style="text-align: right"><a href="#" onclick="return $.filemanager ('mv', {file: '${path}', name: '${name}'})">{"Rename"}</a></td>
+		<td style="text-align: right">
+			<a href="#" onclick="return $.filemanager ('mv', {file: '${path}', name: '${name}'})">{"Rename"}</a> | 
+			<a href="#" onclick="return $.filemanager ('rmdir', {file: '${_path}'})">{"Delete"}</a>
+		</td>
 	</tr>
 </script>
 
 <script type="text/x-jquery-tmpl" id="tpl_file">
 	<tr>
-		<td><div class="draggable" data-file="${_path}"><img src="/apps/admin/css/admin/file.png" alt="${name}" style="padding-right: 5px; margin-top: -2px" /> <a href="${conf_root}${path}" target="_blank"\{{if is_img}} class="file-img"\{{/if}}>${name}</a></div></td>
+		<td><div class="draggable" data-file="${_path}"><img src="/apps/admin/css/admin/file.png" alt="${name}" style="padding-right: 5px; margin-top: -2px" /> <a href="/${conf_root}${path}" target="_blank"\{{if is_img}} class="file-img"\{{/if}}>${name}</a></div></td>
 		<td>\{{html mtime}}</td>
 		<td>${fsize}</td>
 		<td style="text-align: right">
+			\{{if zip_file}}
+			<a href="#" onclick="return $.filemanager ('unzip', {file: '${_path}', name: '${_name}'})">{"Unzip"}</a> |
+			\{{/if}}
 			\{{if image_file}}
 			<a href="#" onclick="return $.filemanager ('img', {file: '${_path}', name: '${_name}'})">{"Edit"}</a> |
 			\{{/if}}
@@ -88,7 +94,7 @@
 {% end %}
 </h2>
 
-<div id="filemanager-dropzone">
+<div id="filemanager-dropzone" title="{"Drag files here to upload."}">
 
 <p>
 	<form action="/filemanager/upload" method="post" enctype="multipart/form-data">
Files elefant-elefant_1_3_9_beta/apps/filemanager/views/mediaelement.html and elefant-elefant_1_3_10_beta/apps/filemanager/views/mediaelement.html are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/views/photo.html elefant-elefant_1_3_10_beta/apps/filemanager/views/photo.html
--- elefant-elefant_1_3_9_beta/apps/filemanager/views/photo.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/views/photo.html	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,61 @@
+{% if ! User::require_acl ('admin', 'filemanager') %}
+<img src="{{src}}"
+	 id="photo-{{key}}"
+	 style="width: {{width}}px; height: {{height}}px"
+	 alt="{{alt}}"
+	 {% if class %} class="{{class}}"{% end %}
+/>
+{% else %}
+<div id="photo-{{key}}-wrapper" title="{'Edit Photo'} ({{width}}x{{height}})">
+	<img src="{{src}}"
+		 id="photo-{{key}}"
+		 style="width: {{width}}px; height: {{height}}px"
+		 alt="{{alt}}"
+		 {% if class %} class="{{class}}"{% end %}
+	/>
+	<div id="photo-{{key}}-overlay"></div>
+</div>
+<script>
+$(function () {
+	$('#photo-{{key}}').photoswitcher ({
+		key: '{{key}}',
+		src: '{{src}}',
+		width: {{width}},
+		height: {{height}},
+		title: '{"Choose an image"}'
+	});
+	
+	$('#photo-{{key}}-wrapper').on ('mouseover', function () {
+		$('#photo-{{key}}-overlay').show ();
+	});
+	
+	$('#photo-{{key}}-wrapper').on ('mouseout', function () {
+		$('#photo-{{key}}-overlay').hide ();
+	});
+});
+</script>
+<style>
+div#photo-{{key}}-wrapper {
+	position: relative;
+	display: inline-block;
+	border: 0;
+	padding: 0;
+	margin: 0;
+	cursor: pointer;
+}
+div#photo-{{key}}-overlay {
+	position: absolute;
+	display: none;
+	top: 0;
+	left: 0;
+	width: {{width - 2}}px;
+	height: {{height - 2}}px;
+	border: 1px solid #222;
+	padding: 0;
+	margin: 0;
+	background-image: url(/apps/admin/css/admin/editable-photo.png);
+	background-position: 100% 0px;
+	background-repeat: no-repeat;
+}
+</style>
+{% end %}
Files elefant-elefant_1_3_9_beta/apps/filemanager/views/properties.html and elefant-elefant_1_3_10_beta/apps/filemanager/views/properties.html are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/views/settings.html elefant-elefant_1_3_10_beta/apps/filemanager/views/settings.html
--- elefant-elefant_1_3_9_beta/apps/filemanager/views/settings.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/views/settings.html	2014-12-03 23:59:25.000000000 -0600
@@ -3,7 +3,7 @@
 
 <p>
 	<strong>{"Aviary image editor"}</strong><br />
-    <a href="">{"Register your website here to generate your Aviary credentials."}</a>
+    <a href="http://developers.aviary.com/">{"Register your website here to generate your Aviary credentials."}</a>
 </p>
 
 <p>
@@ -18,4 +18,4 @@
 </p>
 
 </form>
-</div>
\ No newline at end of file
+</div>
diff -urBNs elefant-elefant_1_3_9_beta/apps/filemanager/views/slideshow.html elefant-elefant_1_3_10_beta/apps/filemanager/views/slideshow.html
--- elefant-elefant_1_3_9_beta/apps/filemanager/views/slideshow.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/filemanager/views/slideshow.html	2014-12-03 23:59:25.000000000 -0600
@@ -3,7 +3,7 @@
 	$('#slideshow-{{name}}').cycle ({
 		fx: 'fade',
 		pager: '#slideshow-{{name}}-nav',
-		timeout: 6000,
+		timeout: {{timeout}},
 		startingSlide: Math.floor (Math.random () * 5)
 	});
 });
Files elefant-elefant_1_3_9_beta/apps/filemanager/views/swf.html and elefant-elefant_1_3_10_beta/apps/filemanager/views/swf.html are identical
Files elefant-elefant_1_3_9_beta/apps/filemanager/views/video.html and elefant-elefant_1_3_10_beta/apps/filemanager/views/video.html are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/navigation/conf/acl.php elefant-elefant_1_3_10_beta/apps/navigation/conf/acl.php
--- elefant-elefant_1_3_9_beta/apps/navigation/conf/acl.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/navigation/conf/acl.php	2014-12-03 23:59:25.000000000 -0600
@@ -2,4 +2,4 @@
 
 navigation = "Edit site navigation"
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/navigation/conf/config.php elefant-elefant_1_3_10_beta/apps/navigation/conf/config.php
--- elefant-elefant_1_3_9_beta/apps/navigation/conf/config.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/navigation/conf/config.php	2014-12-03 23:59:25.000000000 -0600
@@ -6,4 +6,4 @@
 name = Navigation
 platforms = desktop
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/navigation/conf/embed.php elefant-elefant_1_3_10_beta/apps/navigation/conf/embed.php
--- elefant-elefant_1_3_9_beta/apps/navigation/conf/embed.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/navigation/conf/embed.php	2014-12-03 23:59:25.000000000 -0600
@@ -37,4 +37,4 @@
 
 label = "Multilingual Homepage Redirect"
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/navigation/conf/helpers.php elefant-elefant_1_3_10_beta/apps/navigation/conf/helpers.php
--- elefant-elefant_1_3_9_beta/apps/navigation/conf/helpers.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/navigation/conf/helpers.php	2014-12-03 23:59:25.000000000 -0600
@@ -10,4 +10,4 @@
 navigation/section = 1
 navigation/top = 1
 
-; */ ?>
\ No newline at end of file
+; */ ?>
Files elefant-elefant_1_3_9_beta/apps/navigation/css/dropmenu.css and elefant-elefant_1_3_10_beta/apps/navigation/css/dropmenu.css are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/css/icon-nav-contextual.png and elefant-elefant_1_3_10_beta/apps/navigation/css/icon-nav-contextual.png are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/css/icon-nav-section.png and elefant-elefant_1_3_10_beta/apps/navigation/css/icon-nav-section.png are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/css/icon-nav-top.png and elefant-elefant_1_3_10_beta/apps/navigation/css/icon-nav-top.png are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/css/icon-sitemap.png and elefant-elefant_1_3_10_beta/apps/navigation/css/icon-sitemap.png are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/navigation/handlers/admin.php elefant-elefant_1_3_10_beta/apps/navigation/handlers/admin.php
--- elefant-elefant_1_3_9_beta/apps/navigation/handlers/admin.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/navigation/handlers/admin.php	2014-12-03 23:59:25.000000000 -0600
@@ -25,5 +25,3 @@
 echo $tpl->render ('navigation/admin', array (
 	'other_pages' => $other_pages
 ));
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/navigation/handlers/admin_tree.php elefant-elefant_1_3_10_beta/apps/navigation/handlers/admin_tree.php
--- elefant-elefant_1_3_9_beta/apps/navigation/handlers/admin_tree.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/navigation/handlers/admin_tree.php	2014-12-03 23:59:25.000000000 -0600
@@ -10,5 +10,3 @@
 navigation_print_admin_tree ($n->tree);
 
 //$this->cache = true;
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/navigation/handlers/api.php elefant-elefant_1_3_10_beta/apps/navigation/handlers/api.php
--- elefant-elefant_1_3_9_beta/apps/navigation/handlers/api.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/navigation/handlers/api.php	2014-12-03 23:59:25.000000000 -0600
@@ -57,5 +57,3 @@
 }
 
 echo json_encode ($res);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/navigation/handlers/breadcrumb.php elefant-elefant_1_3_10_beta/apps/navigation/handlers/breadcrumb.php
--- elefant-elefant_1_3_9_beta/apps/navigation/handlers/breadcrumb.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/navigation/handlers/breadcrumb.php	2014-12-03 23:59:25.000000000 -0600
@@ -46,5 +46,3 @@
 	}
 }
 echo '</ul>';
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/navigation/handlers/contextual.php elefant-elefant_1_3_10_beta/apps/navigation/handlers/contextual.php
--- elefant-elefant_1_3_9_beta/apps/navigation/handlers/contextual.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/navigation/handlers/contextual.php	2014-12-03 23:59:25.000000000 -0600
@@ -20,5 +20,3 @@
 } else {
 	navigation_print_context ($n->tree, $path);
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/navigation/handlers/cookie.php elefant-elefant_1_3_10_beta/apps/navigation/handlers/cookie.php
--- elefant-elefant_1_3_9_beta/apps/navigation/handlers/cookie.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/navigation/handlers/cookie.php	2014-12-03 23:59:25.000000000 -0600
@@ -24,5 +24,3 @@
 isset ($_GET['redirect'])
 	? $this->redirect ($_GET['redirect'])
 	: $this->redirect ($_SERVER['HTTP_REFERER']);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/navigation/handlers/dropmenu.php elefant-elefant_1_3_10_beta/apps/navigation/handlers/dropmenu.php
--- elefant-elefant_1_3_9_beta/apps/navigation/handlers/dropmenu.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/navigation/handlers/dropmenu.php	2014-12-03 23:59:25.000000000 -0600
@@ -29,5 +29,3 @@
 } else {
 	navigation_print_dropmenu ($n->tree, $data['id']);
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/navigation/handlers/hook/delete.php elefant-elefant_1_3_10_beta/apps/navigation/handlers/hook/delete.php
--- elefant-elefant_1_3_9_beta/apps/navigation/handlers/hook/delete.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/navigation/handlers/hook/delete.php	2014-12-03 23:59:25.000000000 -0600
@@ -15,5 +15,3 @@
 
 require_once ('apps/navigation/lib/Functions.php');
 navigation_clear_cache ();
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/navigation/handlers/hook/edit.php elefant-elefant_1_3_10_beta/apps/navigation/handlers/hook/edit.php
--- elefant-elefant_1_3_9_beta/apps/navigation/handlers/hook/edit.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/navigation/handlers/hook/edit.php	2014-12-03 23:59:25.000000000 -0600
@@ -22,5 +22,3 @@
 	require_once ('apps/navigation/lib/Functions.php');
 	navigation_clear_cache ();
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/navigation/handlers/index.php elefant-elefant_1_3_10_beta/apps/navigation/handlers/index.php
--- elefant-elefant_1_3_9_beta/apps/navigation/handlers/index.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/navigation/handlers/index.php	2014-12-03 23:59:25.000000000 -0600
@@ -5,5 +5,3 @@
  */
 
 $this->redirect ('/navigation/admin');
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/navigation/handlers/json.php elefant-elefant_1_3_10_beta/apps/navigation/handlers/json.php
--- elefant-elefant_1_3_9_beta/apps/navigation/handlers/json.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/navigation/handlers/json.php	2014-12-03 23:59:25.000000000 -0600
@@ -8,5 +8,3 @@
 header ('Content-Type: application/json');
 echo file_exists (conf('Paths','navigation_json')) ? file_get_contents (conf('Paths','navigation_json')) : '[]';
 $this->quit ();
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/navigation/handlers/languages.php elefant-elefant_1_3_10_beta/apps/navigation/handlers/languages.php
--- elefant-elefant_1_3_9_beta/apps/navigation/handlers/languages.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/navigation/handlers/languages.php	2014-12-03 23:59:25.000000000 -0600
@@ -40,5 +40,3 @@
 	}
 }
 echo '</ul>';
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/navigation/handlers/map.php elefant-elefant_1_3_10_beta/apps/navigation/handlers/map.php
--- elefant-elefant_1_3_9_beta/apps/navigation/handlers/map.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/navigation/handlers/map.php	2014-12-03 23:59:25.000000000 -0600
@@ -17,5 +17,3 @@
 } else {
 	navigation_print_level ($n->tree);
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/navigation/handlers/pager.php elefant-elefant_1_3_10_beta/apps/navigation/handlers/pager.php
--- elefant-elefant_1_3_9_beta/apps/navigation/handlers/pager.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/navigation/handlers/pager.php	2014-12-03 23:59:25.000000000 -0600
@@ -72,6 +72,7 @@
 $o->prev = $o->num - 1; // the num for the previous screen
 $o->last_screen = ceil ($o->total / $o->limit); // the num of the last screen
 
+$o->url = preg_replace ('/%([^d])/', '%%\1', $o->url);
 $o->next_link = sprintf ($o->url, $o->next);
 $o->prev_link = sprintf ($o->url, $o->prev);
 $o->first_link = sprintf ($o->url, 1);
@@ -87,6 +88,7 @@
 if (isset ($_SERVER["QUERY_STRING"]) && $_SERVER["QUERY_STRING"]) $o->url .= '?'.$_SERVER["QUERY_STRING"];
 
 if ($data['style'] === 'results') {
+	echo '<div class="pager">';
 	if ($o->total == 0) {
 		echo __ ('No results.');
 	} elseif ($o->total == 1) {
@@ -99,9 +101,8 @@
 			$o->total
 		);
 	}
+	echo '</div>';
 	return;
 }
 
 echo $tpl->render ('navigation/pager/' . $data['style'], $o);
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/navigation/handlers/redirect.php elefant-elefant_1_3_10_beta/apps/navigation/handlers/redirect.php
--- elefant-elefant_1_3_9_beta/apps/navigation/handlers/redirect.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/navigation/handlers/redirect.php	2014-12-03 23:59:25.000000000 -0600
@@ -17,5 +17,3 @@
 }
 
 $this->permanent_redirect ($url);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/navigation/handlers/section.php elefant-elefant_1_3_10_beta/apps/navigation/handlers/section.php
--- elefant-elefant_1_3_9_beta/apps/navigation/handlers/section.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/navigation/handlers/section.php	2014-12-03 23:59:25.000000000 -0600
@@ -15,6 +15,4 @@
 		echo Link::single ($item->attr->id, $item->data);
 	}
 	echo '</ul>';
-}	
-
-?>
\ No newline at end of file
+}
diff -urBNs elefant-elefant_1_3_9_beta/apps/navigation/handlers/top.php elefant-elefant_1_3_10_beta/apps/navigation/handlers/top.php
--- elefant-elefant_1_3_9_beta/apps/navigation/handlers/top.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/navigation/handlers/top.php	2014-12-03 23:59:25.000000000 -0600
@@ -18,5 +18,3 @@
 	echo Link::single ($item->attr->id, $item->data);
 }
 echo '</ul>';
-
-?>
\ No newline at end of file
Files elefant-elefant_1_3_9_beta/apps/navigation/js/dropmenu.js and elefant-elefant_1_3_10_beta/apps/navigation/js/dropmenu.js are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/js/themes/apple/bg.jpg and elefant-elefant_1_3_10_beta/apps/navigation/js/themes/apple/bg.jpg are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/js/themes/apple/d.png and elefant-elefant_1_3_10_beta/apps/navigation/js/themes/apple/d.png are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/js/themes/apple/dot_for_ie.gif and elefant-elefant_1_3_10_beta/apps/navigation/js/themes/apple/dot_for_ie.gif are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/js/themes/apple/style.css and elefant-elefant_1_3_10_beta/apps/navigation/js/themes/apple/style.css are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/js/themes/apple/throbber.gif and elefant-elefant_1_3_10_beta/apps/navigation/js/themes/apple/throbber.gif are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/js/themes/classic/d.gif and elefant-elefant_1_3_10_beta/apps/navigation/js/themes/classic/d.gif are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/js/themes/classic/d.png and elefant-elefant_1_3_10_beta/apps/navigation/js/themes/classic/d.png are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/js/themes/classic/dot_for_ie.gif and elefant-elefant_1_3_10_beta/apps/navigation/js/themes/classic/dot_for_ie.gif are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/js/themes/classic/style.css and elefant-elefant_1_3_10_beta/apps/navigation/js/themes/classic/style.css are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/js/themes/classic/throbber.gif and elefant-elefant_1_3_10_beta/apps/navigation/js/themes/classic/throbber.gif are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/js/themes/default/d.gif and elefant-elefant_1_3_10_beta/apps/navigation/js/themes/default/d.gif are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/js/themes/default/d.png and elefant-elefant_1_3_10_beta/apps/navigation/js/themes/default/d.png are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/js/themes/default/style.css and elefant-elefant_1_3_10_beta/apps/navigation/js/themes/default/style.css are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/js/themes/default/throbber.gif and elefant-elefant_1_3_10_beta/apps/navigation/js/themes/default/throbber.gif are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/js/themes/default-rtl/d.gif and elefant-elefant_1_3_10_beta/apps/navigation/js/themes/default-rtl/d.gif are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/js/themes/default-rtl/d.png and elefant-elefant_1_3_10_beta/apps/navigation/js/themes/default-rtl/d.png are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/js/themes/default-rtl/dots.gif and elefant-elefant_1_3_10_beta/apps/navigation/js/themes/default-rtl/dots.gif are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/js/themes/default-rtl/style.css and elefant-elefant_1_3_10_beta/apps/navigation/js/themes/default-rtl/style.css are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/js/themes/default-rtl/throbber.gif and elefant-elefant_1_3_10_beta/apps/navigation/js/themes/default-rtl/throbber.gif are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/js/tree-drag-drop/css/closedhand.cur and elefant-elefant_1_3_10_beta/apps/navigation/js/tree-drag-drop/css/closedhand.cur are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/js/tree-drag-drop/css/collapsed.png and elefant-elefant_1_3_10_beta/apps/navigation/js/tree-drag-drop/css/collapsed.png are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/js/tree-drag-drop/css/cursorGrab.png and elefant-elefant_1_3_10_beta/apps/navigation/js/tree-drag-drop/css/cursorGrab.png are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/js/tree-drag-drop/css/cursorGrabbing.png and elefant-elefant_1_3_10_beta/apps/navigation/js/tree-drag-drop/css/cursorGrabbing.png are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/js/tree-drag-drop/css/expanded.png and elefant-elefant_1_3_10_beta/apps/navigation/js/tree-drag-drop/css/expanded.png are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/js/tree-drag-drop/css/openhand.cur and elefant-elefant_1_3_10_beta/apps/navigation/js/tree-drag-drop/css/openhand.cur are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/js/tree-drag-drop/css/tree-drag-drop.css and elefant-elefant_1_3_10_beta/apps/navigation/js/tree-drag-drop/css/tree-drag-drop.css are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/js/tree-drag-drop/jquery-ui-1.9.1.custom.min.js and elefant-elefant_1_3_10_beta/apps/navigation/js/tree-drag-drop/jquery-ui-1.9.1.custom.min.js are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/js/tree-drag-drop/tree-drag-drop.js and elefant-elefant_1_3_10_beta/apps/navigation/js/tree-drag-drop/tree-drag-drop.js are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/navigation/lib/Functions.php elefant-elefant_1_3_10_beta/apps/navigation/lib/Functions.php
--- elefant-elefant_1_3_9_beta/apps/navigation/lib/Functions.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/navigation/lib/Functions.php	2014-12-03 23:59:25.000000000 -0600
@@ -62,7 +62,11 @@
 	}
 
 	foreach ($tree as $item) {
-		echo '<li>' . Link::make ($item->attr->id, $item->data);
+		$current = ($item->attr->id == Link::current()) ? ' class="current"' : '';
+		if (empty ($current)) {
+			$current = in_array ($item->attr->id, Link::active()) ? ' class="active"' : $current;
+		}
+		echo '<li' . $current . '>' . Link::make ($item->attr->id, $item->data);
 		if (isset ($item->children)) {
 			navigation_print_level ($item->children);
 		}
@@ -86,7 +90,7 @@
  */
 function navigation_get_other_pages ($ids) {
 	$pages = array ();
-	$res = DB::fetch ('select id, title, menu_title from #prefix#webpage where access = "public"');
+	$res = DB::fetch ("select id, title, menu_title, access from #prefix#webpage where access != 'private'");
 
 	//Adds apps to Navigation
 	$apps = glob ('apps/*');
@@ -122,6 +126,15 @@
 			$pages[$p->id] = $p->title;
 		}
 	}
+
+	uasort ($pages, function ($a, $b) {
+		if ($a === $b) {
+			return 0;
+		}
+		
+		return ($a < $b) ? -1 : 1;
+	});
+
 	return $pages;
 }
 
@@ -136,6 +149,3 @@
 	}
 	echo '</ul>';
 }
-
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/navigation/lib/Link.php elefant-elefant_1_3_10_beta/apps/navigation/lib/Link.php
--- elefant-elefant_1_3_9_beta/apps/navigation/lib/Link.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/navigation/lib/Link.php	2014-12-03 23:59:25.000000000 -0600
@@ -217,5 +217,3 @@
 		return join ('.', $parts);
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/navigation/lib/Navigation.php elefant-elefant_1_3_10_beta/apps/navigation/lib/Navigation.php
--- elefant-elefant_1_3_9_beta/apps/navigation/lib/Navigation.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/navigation/lib/Navigation.php	2014-12-03 23:59:25.000000000 -0600
@@ -95,5 +95,3 @@
 	$n = new Navigation;
 	return $n->sections ();
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/navigation/lib/Tree.php elefant-elefant_1_3_10_beta/apps/navigation/lib/Tree.php
--- elefant-elefant_1_3_9_beta/apps/navigation/lib/Tree.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/navigation/lib/Tree.php	2014-12-03 23:59:25.000000000 -0600
@@ -229,8 +229,7 @@
 		}
 
 		// locate $parent and add child
-		if ($parent) {
-			$ref = $this->node ($parent);
+		if ($parent && ($ref = $this->node ($parent))) {
 			if (! isset ($ref->children)) {
 				$ref->children = array ();
 			}
@@ -446,5 +445,3 @@
 		return true;
 	}
 }
-
-?>
\ No newline at end of file
Files elefant-elefant_1_3_9_beta/apps/navigation/pix/trash.png and elefant-elefant_1_3_10_beta/apps/navigation/pix/trash.png are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/navigation/views/admin.html elefant-elefant_1_3_10_beta/apps/navigation/views/admin.html
--- elefant-elefant_1_3_9_beta/apps/navigation/views/admin.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/navigation/views/admin.html	2014-12-03 23:59:25.000000000 -0600
@@ -47,4 +47,4 @@
 <p class="caption"><em>{"Note: Pages that are not publicly visible will not be listed here."}</em></p>
 
 <script type="text/javascript">
-</script>
\ No newline at end of file
+</script>
Files elefant-elefant_1_3_9_beta/apps/navigation/views/pager/numbers.html and elefant-elefant_1_3_10_beta/apps/navigation/views/pager/numbers.html are identical
Files elefant-elefant_1_3_9_beta/apps/navigation/views/pager/text.html and elefant-elefant_1_3_10_beta/apps/navigation/views/pager/text.html are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/social/conf/config.php elefant-elefant_1_3_10_beta/apps/social/conf/config.php
--- elefant-elefant_1_3_9_beta/apps/social/conf/config.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/social/conf/config.php	2014-12-03 23:59:25.000000000 -0600
@@ -6,4 +6,4 @@
 
 [Facebook]
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/social/conf/embed.php elefant-elefant_1_3_10_beta/apps/social/conf/embed.php
--- elefant-elefant_1_3_9_beta/apps/social/conf/embed.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/social/conf/embed.php	2014-12-03 23:59:25.000000000 -0600
@@ -157,13 +157,13 @@
 
 width[label] = Player width
 width[type] = text
-width[initial] = 480
+width[initial] = 640
 width[not empty] = 1
 width[message] = Please enter a player width.
 
 height[label] = Player height
 height[type] = text
-height[initial] = 303
+height[initial] = 360
 height[not empty] = 1
 height[message] = Please enter a player height.
 
@@ -218,13 +218,13 @@
 
 width[label] = Player width
 width[type] = text
-width[initial] = 480
+width[initial] = 640
 width[not empty] = 1
 width[message] = Please enter a player width.
 
 height[label] = Player height
 height[type] = text
-height[initial] = 270
+height[initial] = 360
 height[not empty] = 1
 height[message] = Please enter a player height.
 
Files elefant-elefant_1_3_9_beta/apps/social/conf/helpers.php and elefant-elefant_1_3_10_beta/apps/social/conf/helpers.php are identical
Files elefant-elefant_1_3_9_beta/apps/social/css/icon-facebook-commentcount.png and elefant-elefant_1_3_10_beta/apps/social/css/icon-facebook-commentcount.png are identical
Files elefant-elefant_1_3_9_beta/apps/social/css/icon-facebook-comments.png and elefant-elefant_1_3_10_beta/apps/social/css/icon-facebook-comments.png are identical
Files elefant-elefant_1_3_9_beta/apps/social/css/icon-twitter-follow.png and elefant-elefant_1_3_10_beta/apps/social/css/icon-twitter-follow.png are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/social/handlers/facebook/commentcount.php elefant-elefant_1_3_10_beta/apps/social/handlers/facebook/commentcount.php
--- elefant-elefant_1_3_9_beta/apps/social/handlers/facebook/commentcount.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/social/handlers/facebook/commentcount.php	2014-12-03 23:59:25.000000000 -0600
@@ -13,5 +13,3 @@
 	$data['url'] = 'http://' . $_SERVER['HTTP_HOST'] . $data['url'];
 }
 echo $tpl->render ('social/facebook/commentcount', $data);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/social/handlers/facebook/comments.php elefant-elefant_1_3_10_beta/apps/social/handlers/facebook/comments.php
--- elefant-elefant_1_3_9_beta/apps/social/handlers/facebook/comments.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/social/handlers/facebook/comments.php	2014-12-03 23:59:25.000000000 -0600
@@ -14,5 +14,3 @@
 	: '//' . $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI'];
 
 echo $tpl->render ('social/facebook/comments', $data);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/social/handlers/facebook/init.php elefant-elefant_1_3_10_beta/apps/social/handlers/facebook/init.php
--- elefant-elefant_1_3_9_beta/apps/social/handlers/facebook/init.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/social/handlers/facebook/init.php	2014-12-03 23:59:25.000000000 -0600
@@ -9,5 +9,3 @@
 }
 
 echo $tpl->render ('social/facebook/init');
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/social/handlers/facebook/like-box.php elefant-elefant_1_3_10_beta/apps/social/handlers/facebook/like-box.php
--- elefant-elefant_1_3_9_beta/apps/social/handlers/facebook/like-box.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/social/handlers/facebook/like-box.php	2014-12-03 23:59:25.000000000 -0600
@@ -13,5 +13,3 @@
 	$data['url'] = 'http://' . $_SERVER['HTTP_HOST'] . $data['url'];
 }
 echo $tpl->render ('social/facebook/like-box', $data);
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/social/handlers/facebook/like.php elefant-elefant_1_3_10_beta/apps/social/handlers/facebook/like.php
--- elefant-elefant_1_3_9_beta/apps/social/handlers/facebook/like.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/social/handlers/facebook/like.php	2014-12-03 23:59:25.000000000 -0600
@@ -13,5 +13,3 @@
 	$data['url'] = 'http://' . $_SERVER['HTTP_HOST'] . $data['url'];
 }
 echo $tpl->render ('social/facebook/like', $data);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/social/handlers/google/init.php elefant-elefant_1_3_10_beta/apps/social/handlers/google/init.php
--- elefant-elefant_1_3_9_beta/apps/social/handlers/google/init.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/social/handlers/google/init.php	2014-12-03 23:59:25.000000000 -0600
@@ -9,5 +9,3 @@
 }
 
 $page->tail .= $tpl->render ('social/google/init');
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/social/handlers/google/maps.php elefant-elefant_1_3_10_beta/apps/social/handlers/google/maps.php
--- elefant-elefant_1_3_9_beta/apps/social/handlers/google/maps.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/social/handlers/google/maps.php	2014-12-03 23:59:25.000000000 -0600
@@ -6,7 +6,7 @@
  */
 
 if (self::$called['social/google/maps'] == 1) {
-	echo '<script src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>';
+	echo '<script src="//maps.googleapis.com/maps/api/js?sensor=false"></script>';
 }
 
 $data['map_id'] = rand ();
@@ -17,5 +17,3 @@
 $data['height'] = is_numeric ($data['height']) ? $data['height'] . 'px' : $data['height'];
 
 echo $tpl->render ('social/google/maps', $data);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/social/handlers/google/plusone.php elefant-elefant_1_3_10_beta/apps/social/handlers/google/plusone.php
--- elefant-elefant_1_3_9_beta/apps/social/handlers/google/plusone.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/social/handlers/google/plusone.php	2014-12-03 23:59:25.000000000 -0600
@@ -12,5 +12,3 @@
 	$data['url'] = 'http://' . $_SERVER['HTTP_HOST'] . $data['url'];
 }
 echo $tpl->render ('social/google/plusone', $data);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/social/handlers/index.php elefant-elefant_1_3_10_beta/apps/social/handlers/index.php
--- elefant-elefant_1_3_9_beta/apps/social/handlers/index.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/social/handlers/index.php	2014-12-03 23:59:25.000000000 -0600
@@ -6,5 +6,3 @@
  */
 
 echo $tpl->render ('social/index', array ());
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/social/handlers/twitter/feed.php elefant-elefant_1_3_10_beta/apps/social/handlers/twitter/feed.php
--- elefant-elefant_1_3_9_beta/apps/social/handlers/twitter/feed.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/social/handlers/twitter/feed.php	2014-12-03 23:59:25.000000000 -0600
@@ -50,5 +50,3 @@
 $out = $tpl->render ('social/twitter/feed', $data);
 $cache->set ($cache_key, $out, 0, 1800);
 echo $out;
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/social/handlers/twitter/follow.php elefant-elefant_1_3_10_beta/apps/social/handlers/twitter/follow.php
--- elefant-elefant_1_3_9_beta/apps/social/handlers/twitter/follow.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/social/handlers/twitter/follow.php	2014-12-03 23:59:25.000000000 -0600
@@ -15,5 +15,3 @@
 }
 
 echo $tpl->render ('social/twitter/follow', $data);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/social/handlers/twitter/init.php elefant-elefant_1_3_10_beta/apps/social/handlers/twitter/init.php
--- elefant-elefant_1_3_9_beta/apps/social/handlers/twitter/init.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/social/handlers/twitter/init.php	2014-12-03 23:59:25.000000000 -0600
@@ -9,5 +9,3 @@
 }
 
 echo $tpl->render ('social/twitter/init');
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/social/handlers/twitter/tweet.php elefant-elefant_1_3_10_beta/apps/social/handlers/twitter/tweet.php
--- elefant-elefant_1_3_9_beta/apps/social/handlers/twitter/tweet.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/social/handlers/twitter/tweet.php	2014-12-03 23:59:25.000000000 -0600
@@ -18,5 +18,3 @@
 	$data['url'] = 'http://' . $_SERVER['HTTP_HOST'] . $data['url'];
 }
 echo $tpl->render ('social/twitter/tweet', $data);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/social/handlers/video/vimeo.php elefant-elefant_1_3_10_beta/apps/social/handlers/video/vimeo.php
--- elefant-elefant_1_3_9_beta/apps/social/handlers/video/vimeo.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/social/handlers/video/vimeo.php	2014-12-03 23:59:25.000000000 -0600
@@ -11,5 +11,3 @@
 $data['height'] = isset ($data['height']) ? $data['height'] : 270;
 
 echo $tpl->render ('social/video/vimeo', $data);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/social/handlers/video/youtube.php elefant-elefant_1_3_10_beta/apps/social/handlers/video/youtube.php
--- elefant-elefant_1_3_9_beta/apps/social/handlers/video/youtube.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/social/handlers/video/youtube.php	2014-12-03 23:59:25.000000000 -0600
@@ -17,5 +17,3 @@
 $data['height'] = isset ($data['height']) ? $data['height'] : 303;
 
 echo $tpl->render ('social/video/youtube', $data);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/social/lib/Filter.php elefant-elefant_1_3_10_beta/apps/social/lib/Filter.php
--- elefant-elefant_1_3_9_beta/apps/social/lib/Filter.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/social/lib/Filter.php	2014-12-03 23:59:25.000000000 -0600
@@ -31,5 +31,3 @@
 		return $tweet;
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/social/lib/Functions.php elefant-elefant_1_3_10_beta/apps/social/lib/Functions.php
--- elefant-elefant_1_3_9_beta/apps/social/lib/Functions.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/social/lib/Functions.php	2014-12-03 23:59:25.000000000 -0600
@@ -31,4 +31,3 @@
 		(object) array ('key' => 'dark', 'value' => __ ('Dark')),
 	);
 }
-?>
Files elefant-elefant_1_3_9_beta/apps/social/views/facebook/commentcount.html and elefant-elefant_1_3_10_beta/apps/social/views/facebook/commentcount.html are identical
Files elefant-elefant_1_3_9_beta/apps/social/views/facebook/comments.html and elefant-elefant_1_3_10_beta/apps/social/views/facebook/comments.html are identical
Files elefant-elefant_1_3_9_beta/apps/social/views/facebook/init.html and elefant-elefant_1_3_10_beta/apps/social/views/facebook/init.html are identical
Files elefant-elefant_1_3_9_beta/apps/social/views/facebook/like-box.html and elefant-elefant_1_3_10_beta/apps/social/views/facebook/like-box.html are identical
Files elefant-elefant_1_3_9_beta/apps/social/views/facebook/like.html and elefant-elefant_1_3_10_beta/apps/social/views/facebook/like.html are identical
Files elefant-elefant_1_3_9_beta/apps/social/views/google/init.html and elefant-elefant_1_3_10_beta/apps/social/views/google/init.html are identical
Files elefant-elefant_1_3_9_beta/apps/social/views/google/maps.html and elefant-elefant_1_3_10_beta/apps/social/views/google/maps.html are identical
Files elefant-elefant_1_3_9_beta/apps/social/views/google/plusone.html and elefant-elefant_1_3_10_beta/apps/social/views/google/plusone.html are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/social/views/index.html elefant-elefant_1_3_10_beta/apps/social/views/index.html
--- elefant-elefant_1_3_9_beta/apps/social/views/index.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/social/views/index.html	2014-12-03 23:59:25.000000000 -0600
@@ -1 +1 @@
-<p>{{ body|none }}</p>
\ No newline at end of file
+<p>{{ body|none }}</p>
Files elefant-elefant_1_3_9_beta/apps/social/views/twitter/feed.html and elefant-elefant_1_3_10_beta/apps/social/views/twitter/feed.html are identical
Files elefant-elefant_1_3_9_beta/apps/social/views/twitter/follow.html and elefant-elefant_1_3_10_beta/apps/social/views/twitter/follow.html are identical
Files elefant-elefant_1_3_9_beta/apps/social/views/twitter/init.html and elefant-elefant_1_3_10_beta/apps/social/views/twitter/init.html are identical
Files elefant-elefant_1_3_9_beta/apps/social/views/twitter/tweet.html and elefant-elefant_1_3_10_beta/apps/social/views/twitter/tweet.html are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/social/views/video/vimeo.html elefant-elefant_1_3_10_beta/apps/social/views/video/vimeo.html
--- elefant-elefant_1_3_9_beta/apps/social/views/video/vimeo.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/social/views/video/vimeo.html	2014-12-03 23:59:25.000000000 -0600
@@ -1 +1 @@
-<iframe src="http://player.vimeo.com/video/{{video}}?title=0&amp;byline=0&amp;portrait=0" width="{{width}}" height="{{height}}" frameborder="0"></iframe>
\ No newline at end of file
+<iframe src="//player.vimeo.com/video/{{video}}?title=0&amp;byline=0&amp;portrait=0" width="{{width}}" height="{{height}}" frameborder="0"></iframe>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/social/views/video/youtube.html elefant-elefant_1_3_10_beta/apps/social/views/video/youtube.html
--- elefant-elefant_1_3_9_beta/apps/social/views/video/youtube.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/social/views/video/youtube.html	2014-12-03 23:59:25.000000000 -0600
@@ -1 +1 @@
-<iframe width="{{width}}" height="{{height}}" src="http://www.youtube.com/embed/{{video}}" frameborder="0" allowfullscreen></iframe>
\ No newline at end of file
+<iframe width="{{width}}" height="{{height}}" src="//www.youtube.com/embed/{{video}}" frameborder="0" allowfullscreen></iframe>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/translator/conf/acl.php elefant-elefant_1_3_10_beta/apps/translator/conf/acl.php
--- elefant-elefant_1_3_9_beta/apps/translator/conf/acl.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/translator/conf/acl.php	2014-12-03 23:59:25.000000000 -0600
@@ -2,4 +2,4 @@
 
 translator = "Modify translations and language settings"
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/translator/conf/config.php elefant-elefant_1_3_10_beta/apps/translator/conf/config.php
--- elefant-elefant_1_3_9_beta/apps/translator/conf/config.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/translator/conf/config.php	2014-12-03 23:59:25.000000000 -0600
@@ -6,4 +6,4 @@
 name = Languages
 platforms = desktop, tablet
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/translator/forms/add.php elefant-elefant_1_3_10_beta/apps/translator/forms/add.php
--- elefant-elefant_1_3_9_beta/apps/translator/forms/add.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/translator/forms/add.php	2014-12-03 23:59:25.000000000 -0600
@@ -26,4 +26,4 @@
 
 default = "h:MMa"
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/translator/forms/settings.php elefant-elefant_1_3_10_beta/apps/translator/forms/settings.php
--- elefant-elefant_1_3_9_beta/apps/translator/forms/settings.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/translator/forms/settings.php	2014-12-03 23:59:25.000000000 -0600
@@ -12,4 +12,4 @@
 
 not empty = 1
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/translator/handlers/add.php elefant-elefant_1_3_10_beta/apps/translator/handlers/add.php
--- elefant-elefant_1_3_9_beta/apps/translator/handlers/add.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/translator/handlers/add.php	2014-12-03 23:59:25.000000000 -0600
@@ -50,5 +50,3 @@
 	$form->controller->add_notification (__ ('Language added.'));
 	$form->controller->redirect ('/translator/index');
 });
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/translator/handlers/api.php elefant-elefant_1_3_10_beta/apps/translator/handlers/api.php
--- elefant-elefant_1_3_9_beta/apps/translator/handlers/api.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/translator/handlers/api.php	2014-12-03 23:59:25.000000000 -0600
@@ -6,5 +6,3 @@
 
 $this->require_acl ('admin', 'translator');
 $this->restful (new Translator ());
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/translator/handlers/build.php elefant-elefant_1_3_10_beta/apps/translator/handlers/build.php
--- elefant-elefant_1_3_9_beta/apps/translator/handlers/build.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/translator/handlers/build.php	2014-12-03 23:59:25.000000000 -0600
@@ -147,5 +147,3 @@
 $page->title = __ ('Indexing completed');
 
 echo '<p><a href="/translator/index">' . __ ('Continue') . '</a></p>';
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/translator/handlers/delete.php elefant-elefant_1_3_10_beta/apps/translator/handlers/delete.php
--- elefant-elefant_1_3_9_beta/apps/translator/handlers/delete.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/translator/handlers/delete.php	2014-12-03 23:59:25.000000000 -0600
@@ -18,5 +18,3 @@
 
 $this->add_notification (__ ('Language deleted.'));
 $this->redirect ('/translator/index');
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/translator/handlers/edit.php elefant-elefant_1_3_10_beta/apps/translator/handlers/edit.php
--- elefant-elefant_1_3_9_beta/apps/translator/handlers/edit.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/translator/handlers/edit.php	2014-12-03 23:59:25.000000000 -0600
@@ -91,5 +91,3 @@
 		'empty' => $empty
 	));
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/translator/handlers/index.php elefant-elefant_1_3_10_beta/apps/translator/handlers/index.php
--- elefant-elefant_1_3_9_beta/apps/translator/handlers/index.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/translator/handlers/index.php	2014-12-03 23:59:25.000000000 -0600
@@ -17,5 +17,3 @@
 $page->title = __ ('Languages');
 
 echo $tpl->render ('translator/index', $i18n);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/translator/handlers/makedefault.php elefant-elefant_1_3_10_beta/apps/translator/handlers/makedefault.php
--- elefant-elefant_1_3_9_beta/apps/translator/handlers/makedefault.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/translator/handlers/makedefault.php	2014-12-03 23:59:25.000000000 -0600
@@ -21,5 +21,3 @@
 
 $this->add_notification (__ ('Default language updated.'));
 $this->redirect ('/translator/index');
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/translator/handlers/settings.php elefant-elefant_1_3_10_beta/apps/translator/handlers/settings.php
--- elefant-elefant_1_3_9_beta/apps/translator/handlers/settings.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/translator/handlers/settings.php	2014-12-03 23:59:25.000000000 -0600
@@ -68,5 +68,3 @@
 	$form->controller->add_notification (__ ('Language updated.'));
 	$form->controller->redirect ('/translator/index');
 });
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/translator/handlers/sources.php elefant-elefant_1_3_10_beta/apps/translator/handlers/sources.php
--- elefant-elefant_1_3_9_beta/apps/translator/handlers/sources.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/translator/handlers/sources.php	2014-12-03 23:59:25.000000000 -0600
@@ -37,5 +37,3 @@
 }
 
 echo View::render ('translator/sources', array ('contexts' => $contexts));
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/translator/lib/Functions.php elefant-elefant_1_3_10_beta/apps/translator/lib/Functions.php
--- elefant-elefant_1_3_9_beta/apps/translator/lib/Functions.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/translator/lib/Functions.php	2014-12-03 23:59:25.000000000 -0600
@@ -58,5 +58,3 @@
 	$sources = is_array ($sources) ? $sources : array ($sources);
 	return "\n- " . join ("\n- ", $sources);
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/translator/lib/Translator.php elefant-elefant_1_3_10_beta/apps/translator/lib/Translator.php
--- elefant-elefant_1_3_9_beta/apps/translator/lib/Translator.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/translator/lib/Translator.php	2014-12-03 23:59:25.000000000 -0600
@@ -138,5 +138,3 @@
 		return ($count / $index_count) * 100;
 	}
 }
-
-?>
\ No newline at end of file
Files elefant-elefant_1_3_9_beta/apps/translator/views/add.html and elefant-elefant_1_3_10_beta/apps/translator/views/add.html are identical
Files elefant-elefant_1_3_9_beta/apps/translator/views/edit.html and elefant-elefant_1_3_10_beta/apps/translator/views/edit.html are identical
Files elefant-elefant_1_3_9_beta/apps/translator/views/edit_search.html and elefant-elefant_1_3_10_beta/apps/translator/views/edit_search.html are identical
Files elefant-elefant_1_3_9_beta/apps/translator/views/edit_source.html and elefant-elefant_1_3_10_beta/apps/translator/views/edit_source.html are identical
Files elefant-elefant_1_3_9_beta/apps/translator/views/index.html and elefant-elefant_1_3_10_beta/apps/translator/views/index.html are identical
Files elefant-elefant_1_3_9_beta/apps/translator/views/settings.html and elefant-elefant_1_3_10_beta/apps/translator/views/settings.html are identical
Files elefant-elefant_1_3_9_beta/apps/translator/views/sources.html and elefant-elefant_1_3_10_beta/apps/translator/views/sources.html are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/conf/acl.php elefant-elefant_1_3_10_beta/apps/user/conf/acl.php
--- elefant-elefant_1_3_9_beta/apps/user/conf/acl.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/conf/acl.php	2014-12-03 23:59:25.000000000 -0600
@@ -3,7 +3,8 @@
 default = "Default access for this role (selected means allow by default)"
 content/member = "View members-only content"
 content/private = "View private content"
-user = "Modify user accounts"
-user/roles = "Modify user roles and permissions"
+user = "Members: Create or modify member accounts"
+user/roles = "Members: Create or modify member roles"
+user/edit_roles = "Members: Assign or change member roles"
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/conf/config.php elefant-elefant_1_3_10_beta/apps/user/conf/config.php
--- elefant-elefant_1_3_9_beta/apps/user/conf/config.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/conf/config.php	2014-12-03 23:59:25.000000000 -0600
@@ -22,6 +22,19 @@
 login_attempt_limit = 5
 block_attempts_for = 900
 
+; Height and width to resize photos to
+
+photo_width = 125
+photo_height = 125
+
+; Default photo to use for users without profile photos.
+
+default_photo = "/apps/admin/css/admin/user_profile.png"
+
+; The default role for new users.
+
+default_role = "member"
+
 [Custom Handlers]
 
 ; You can override some of the built-in handlers with your own
@@ -32,6 +45,7 @@
 user/signup = user/signup
 user/update = user/update
 user/login = user/login
+user/login/newuser = user/login/newuser
 user/logout = user/logout
 
 [Facebook]
@@ -58,9 +72,9 @@
 [Admin]
 
 handler = user/admin
-name = Users
+name = Members
 install = user/upgrade
 upgrade = user/upgrade
 version = 1.1.3-stable
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/conf/embed.php elefant-elefant_1_3_10_beta/apps/user/conf/embed.php
--- elefant-elefant_1_3_9_beta/apps/user/conf/embed.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/conf/embed.php	2014-12-03 23:59:25.000000000 -0600
@@ -10,4 +10,4 @@
 label = "User: Sidebar"
 icon = user
 
-; */ ?>
\ No newline at end of file
+; */ ?>
Files elefant-elefant_1_3_9_beta/apps/user/conf/helpers.php and elefant-elefant_1_3_10_beta/apps/user/conf/helpers.php are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/css/details.css elefant-elefant_1_3_10_beta/apps/user/css/details.css
--- elefant-elefant_1_3_9_beta/apps/user/css/details.css	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/css/details.css	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,27 @@
+#body>p, .note {
+	max-width: 600px;
+}
+#photo {
+	max-width: 200px;
+	float: right;
+}
+.clear-photo {
+	clear: both;
+}
+#link-list, #note-list, .note {
+	margin-bottom: 15px;
+}
+.note-info-line {
+	display: block;
+	font-weight: bold;
+}
+.note-made-by:after {
+	content: ":";
+}
+.link .fa {
+	margin-right: 8px;
+	width: 13px;
+}
+.note-delete {
+	font-weight: normal;
+}
\ No newline at end of file
Files elefant-elefant_1_3_9_beta/apps/user/css/userchooser.css and elefant-elefant_1_3_10_beta/apps/user/css/userchooser.css are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/forms/add.php elefant-elefant_1_3_10_beta/apps/user/forms/add.php
--- elefant-elefant_1_3_9_beta/apps/user/forms/add.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/forms/add.php	2014-12-03 23:59:25.000000000 -0600
@@ -16,4 +16,4 @@
 
 matches = "$_POST['password']"
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/forms/edit.php elefant-elefant_1_3_10_beta/apps/user/forms/edit.php
--- elefant-elefant_1_3_9_beta/apps/user/forms/edit.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/forms/edit.php	2014-12-03 23:59:25.000000000 -0600
@@ -17,4 +17,4 @@
 
 matches = "$_POST['password']"
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/forms/login/newuser.php elefant-elefant_1_3_10_beta/apps/user/forms/login/newuser.php
--- elefant-elefant_1_3_9_beta/apps/user/forms/login/newuser.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/forms/login/newuser.php	2014-12-03 23:59:25.000000000 -0600
@@ -17,4 +17,4 @@
 
 matches = "$_POST['password']"
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/forms/newpass.php elefant-elefant_1_3_10_beta/apps/user/forms/newpass.php
--- elefant-elefant_1_3_9_beta/apps/user/forms/newpass.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/forms/newpass.php	2014-12-03 23:59:25.000000000 -0600
@@ -8,4 +8,4 @@
 
 matches = "$_POST['password']"
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/forms/recover.php elefant-elefant_1_3_10_beta/apps/user/forms/recover.php
--- elefant-elefant_1_3_9_beta/apps/user/forms/recover.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/forms/recover.php	2014-12-03 23:59:25.000000000 -0600
@@ -5,4 +5,4 @@
 email = 1
 not unique = "#prefix#user.email"
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/forms/role/add.php elefant-elefant_1_3_10_beta/apps/user/forms/role/add.php
--- elefant-elefant_1_3_9_beta/apps/user/forms/role/add.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/forms/role/add.php	2014-12-03 23:59:25.000000000 -0600
@@ -5,4 +5,4 @@
 not empty = 1
 callback = "user\Rules::new_role"
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/forms/role/edit.php elefant-elefant_1_3_10_beta/apps/user/forms/role/edit.php
--- elefant-elefant_1_3_9_beta/apps/user/forms/role/edit.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/forms/role/edit.php	2014-12-03 23:59:25.000000000 -0600
@@ -4,4 +4,4 @@
 
 not empty = 1
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/forms/settings.php elefant-elefant_1_3_10_beta/apps/user/forms/settings.php
--- elefant-elefant_1_3_9_beta/apps/user/forms/settings.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/forms/settings.php	2014-12-03 23:59:25.000000000 -0600
@@ -1,3 +1,3 @@
 ; <?php /*
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/forms/signup.php elefant-elefant_1_3_10_beta/apps/user/forms/signup.php
--- elefant-elefant_1_3_9_beta/apps/user/forms/signup.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/forms/signup.php	2014-12-03 23:59:25.000000000 -0600
@@ -17,4 +17,4 @@
 
 matches = "$_POST['password']"
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/forms/update.php elefant-elefant_1_3_10_beta/apps/user/forms/update.php
--- elefant-elefant_1_3_9_beta/apps/user/forms/update.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/forms/update.php	2014-12-03 23:59:25.000000000 -0600
@@ -17,4 +17,4 @@
 
 matches = "$_POST['password']"
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/add.php elefant-elefant_1_3_10_beta/apps/user/handlers/add.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/add.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/add.php	2014-12-03 23:59:25.000000000 -0600
@@ -11,6 +11,9 @@
 $f = new Form ('post', 'user/add');
 $f->verify_csrf = false;
 if ($f->submit ()) {
+	if (! User::require_acl ('user/edit_roles')) {
+		$_POST['type'] = Appconf::user ('User', 'default_role');
+	}
 	$_POST['password'] = User::encrypt_pass ($_POST['password']);
 	$now = gmdate ('Y-m-d H:i:s');
 	$_POST['expires'] = $now;
@@ -18,11 +21,13 @@
 	$_POST['updated'] = $now;
 	$_POST['userdata'] = json_encode (array ());
 	unset ($_POST['verify_pass']);
+	unset ($_POST['_states']);
+	unset ($_POST['_countries']);
 	$u = new User ($_POST);
 	$u->put ();
 	Versions::add ($u);
 	if (! $u->error) {
-		$this->add_notification (__ ('User added.'));
+		$this->add_notification (__ ('Member added.'));
 		$this->hook ('user/add', $_POST);
 		$this->redirect ('/user/admin');
 	}
@@ -30,16 +35,16 @@
 	echo __ ('Error Message') . ': ' . $u->error;
 } else {
 	$u = new User;
-	$u->type = 'admin';
-	$u->types = array_keys (User::acl ()->rules);
+	$u->type = Appconf::user ('User', 'default_role');
+	$u->types = User::allowed_roles ();
 
 	$u->failed = $f->failed;
 	$u = $f->merge_values ($u);
-	$page->title = __ ('Add User');
+	$u->_states = user\Data::states ();
+	$u->_countries = user\Data::countries ();
+	$page->title = __ ('Add Member');
 	$page->add_script ('/js/json2.js');
 	$page->add_script ('/js/jstorage.js');
 	$page->add_script ('/js/jquery.autosave.js');
 	echo $tpl->render ('user/add', $u);
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/admin.php elefant-elefant_1_3_10_beta/apps/user/handlers/admin.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/admin.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/admin.php	2014-12-03 23:59:25.000000000 -0600
@@ -11,19 +11,28 @@
 $limit = 20;
 $num = isset ($_GET['offset']) ? $_GET['offset'] : 1;
 $offset = ($num - 1) * $limit;
+$q = isset ($_GET['q']) ? $_GET['q'] : '';
+$q_fields = array ('name', 'email', 'company', 'city', 'state', 'address', 'type', 'phone', 'title');
+$q_exact = array ('company', 'type');
+$url = ! empty ($q)
+	? '/user/admin?q=' . urlencode ($q) . '&offset=%d'
+	: '/user/admin?offset=%d';
 
-$users = User::query ('id, name, email, type')
+$users = User::query ('id, name, email, type, company, title, phone')
+	->where_search ($q, $q_fields, $q_exact)
 	->order ('name asc')
 	->fetch_orig ($limit, $offset);
-$count = User::query ()->count ();
 
-$page->title = __ ('Users');
+$count = User::query ()
+	->where_search ($q, $q_fields, $q_exact)
+	->count ();
+
+$page->title = __ ('Members');
 echo $tpl->render ('user/admin', array (
 	'limit' => $limit,
 	'total' => $count,
 	'users' => $users,
 	'count' => count ($users),
-	'url' => '/user/admin?offset=%d'
+	'url' => $url,
+	'q' => $q
 ));
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/api/link.php elefant-elefant_1_3_10_beta/apps/user/handlers/api/link.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/api/link.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/api/link.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,5 @@
+<?php
+
+$this->require_acl ('admin', 'user');
+
+$this->restful (new user\API\Link);
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/api/note.php elefant-elefant_1_3_10_beta/apps/user/handlers/api/note.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/api/note.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/api/note.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,5 @@
+<?php
+
+$this->require_acl ('admin', 'user');
+
+$this->restful (new user\API\Note);
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/chooser/addform.php elefant-elefant_1_3_10_beta/apps/user/handlers/chooser/addform.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/chooser/addform.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/chooser/addform.php	2014-12-03 23:59:25.000000000 -0600
@@ -4,14 +4,12 @@
  * Renders the user add form HTML for the user chooser.
  */
 
-$this->require_admin ();
+$this->require_acl ('admin', 'user');
 
 $u = new User;
-$u->type = 'admin';
-$u->types = array_keys (User::acl ()->rules);
+$u->type = Appconf::user ('User', 'default_role');
+$u->types = User::allowed_roles ();
 
 $page->layout = false;
 
 echo $tpl->render ('user/chooser/addform', $u);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/chooser/adduser.php elefant-elefant_1_3_10_beta/apps/user/handlers/chooser/adduser.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/chooser/adduser.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/chooser/adduser.php	2014-12-03 23:59:25.000000000 -0600
@@ -4,7 +4,7 @@
  * Adds a new user for the user chooser's new user form.
  */
 
-$this->require_admin ();
+$this->require_acl ('admin', 'user');
 
 $page->layout = false;
 
@@ -20,6 +20,9 @@
 	return;
 }
 
+if (! User::require_acl ('user/edit_roles')) {
+	$_POST['type'] = Appconf::user ('User', 'default_role');
+}
 $_POST['password'] = User::encrypt_pass ($_POST['password']);
 $now = gmdate ('Y-m-d H:i:s');
 $_POST['expires'] = $now;
@@ -31,7 +34,7 @@
 $u->put ();
 Versions::add ($u);
 if (! $u->error) {
-	$this->add_notification (__ ('User added.'));
+	$this->add_notification (__ ('Member added.'));
 	$this->hook ('user/add', $_POST);
 	echo json_encode (array (
 		'success' => true,
@@ -48,5 +51,3 @@
 	'success' => false,
 	'error' => __ ('An Error Occurred') . ': ' . $u->error
 ));
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/chooser.php elefant-elefant_1_3_10_beta/apps/user/handlers/chooser.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/chooser.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/chooser.php	2014-12-03 23:59:25.000000000 -0600
@@ -4,7 +4,7 @@
  * Provides a JSON list of users to the user/util/userchooser dialog.
  */
 
-$this->require_admin ();
+$this->require_acl ('admin', 'user');
 
 $page->layout = false;
 
@@ -12,8 +12,18 @@
 	->order ('name asc')
 	->fetch_orig ();
 
-header ('Content-Type: application/json');
+header ('Content-Type: application/json; charset=utf8');
 
-echo json_encode ($users);
+$out = json_encode ($users);
+$error = null;
 
-?>
\ No newline at end of file
+switch (json_last_error ()) {
+	case JSON_ERROR_NONE:
+		echo $out;
+		break;
+	default:
+		echo json_encode (array (
+			'success' => false,
+			'error' => json_last_error_msg ()
+		));
+}
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/delete.php elefant-elefant_1_3_10_beta/apps/user/handlers/delete.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/delete.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/delete.php	2014-12-03 23:59:25.000000000 -0600
@@ -19,7 +19,5 @@
 }
 
 $this->hook ('user/delete', $_GET);
-$this->add_notification (__ ('User deleted.'));
+$this->add_notification (__ ('Member deleted.'));
 $this->redirect ('/user/admin');
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/details.php elefant-elefant_1_3_10_beta/apps/user/handlers/details.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/details.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/details.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,27 @@
+<?php
+
+/**
+ * Details of a user profile.
+ */
+
+$page->layout = 'admin';
+
+$this->require_acl ('admin', 'user');
+
+if (! isset ($_GET['id'])) {
+	$this->redirect ('/user/admin');
+}
+
+$user = new User ($_GET['id']);
+if ($user->error) {
+	$page->title = __ ('Member not found');
+	printf ('<p><a href="/user/admin">&laquo; %s</a></p>', __ ('Back'));
+	return;
+}
+
+$page->title = __ ('Member') . ': ' . Template::sanitize ($user->name);
+$page->add_script ('/apps/user/js/react/react.js');
+$page->add_script ('/apps/user/js/build/links.js');
+$page->add_script ('/apps/user/js/build/notes.js');
+$page->add_style ('/apps/user/css/details.css');
+echo $tpl->render ('user/details', $user->orig ());
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/edit.php elefant-elefant_1_3_10_beta/apps/user/handlers/edit.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/edit.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/edit.php	2014-12-03 23:59:25.000000000 -0600
@@ -15,15 +15,29 @@
 if ($f->submit ()) {
 	$u->name = $_POST['name'];
 	$u->email = $_POST['email'];
-	$u->type = $_POST['type'];
+	if (User::require_acl ('user/edit_roles')) {
+		$u->type = $_POST['type'];
+	}
 	if (! empty ($_POST['password'])) {
 		$u->password = User::encrypt_pass ($_POST['password']);
 	}
+	$u->photo = $_POST['photo'];
+	$u->about = $_POST['about'];
+	$u->phone = $_POST['phone'];
+	$u->address = $_POST['address'];
+	$u->address2 = $_POST['address2'];
+	$u->city = $_POST['city'];
+	$u->state = $_POST['state'];
+	$u->country = $_POST['country'];
+	$u->zip = $_POST['zip'];
+	$u->title = $_POST['title'];
+	$u->company = $_POST['company'];
+	$u->website = $_POST['website'];
 	$u->update_extended ();
 	$u->put ();
 	Versions::add ($u);
 	if (! $u->error) {
-		$this->add_notification (__ ('User saved.'));
+		$this->add_notification (__ ('Member saved.'));
 		$this->hook ('user/edit', $_POST);
 		$this->redirect ('/user/admin');
 	}
@@ -31,15 +45,15 @@
 	echo __ ('Error Message') . ': ' . $u->error;
 } else {
 	$u->password = '';
-	$u->types = array_keys (User::acl ()->rules);
+	$u->types = User::allowed_roles ();
 
 	$u->failed = $f->failed;
 	$u = $f->merge_values ($u);
-	$page->title = __ ('Edit User') . ': ' . $u->name;
+	$u->_states = user\Data::states ();
+	$u->_countries = user\Data::countries ();
+	$page->title = __ ('Edit Member') . ': ' . $u->name;
 	$page->add_script ('/js/json2.js');
 	$page->add_script ('/js/jstorage.js');
 	$page->add_script ('/js/jquery.autosave.js');
 	echo $tpl->render ('user/edit', $u);
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/import/csv.php elefant-elefant_1_3_10_beta/apps/user/handlers/import/csv.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/import/csv.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/import/csv.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,47 @@
+<?php
+
+/**
+ * Implements a member importer from a CSV file.
+ */
+
+$this->require_acl ('admin', 'user');
+
+$page->layout = 'admin';
+$page->title = __ ('CSV Importer');
+
+$f = new Form ('post');
+
+if ($f->submit ()) {
+	if (move_uploaded_file ($_FILES['import_file']['tmp_name'], 'cache/user_csv_import.csv')) {
+		$file = 'cache/user_csv_import.csv';
+
+		$res = blog\CsvParser::parse ($file);
+
+		if (is_array ($res)) {
+			$headers = array_shift ($res);
+			$samples = array ();
+			for ($i = 0; $i < 3; $i++) {
+				if (isset ($res[$i])) {
+					$samples[] = $res[$i];
+				}
+			}
+
+			require_once ('apps/blog/lib/Filters.php');
+
+			echo $tpl->render ('user/import/csv2', array (
+				'headers' => $headers,
+				'samples' => $samples,
+				'extended' => ExtendedFields::for_class ('User')
+			));
+			return;
+		} else {
+			echo '<p><strong>' . __ ('Unable to parse the uploaded file.') . '</strong></p>';
+		}
+	} else {
+		echo '<p><strong>' . __ ('Error uploading file.') . '</strong></p>';
+	}
+}
+
+$o = new StdClass;
+
+echo $tpl->render ('user/import/csv', $o);
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/import/csv2.php elefant-elefant_1_3_10_beta/apps/user/handlers/import/csv2.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/import/csv2.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/import/csv2.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,103 @@
+<?php
+
+/**
+ * Finishes importing a CSV file.
+ */
+
+$this->require_acl ('admin', 'user');
+
+$page->layout = 'admin';
+$page->title = __ ('CSV Importer');
+
+$imported = 0;
+
+$file = 'cache/user_csv_import.csv';
+
+if (! file_exists ($file)) {
+	echo '<p>' . __ ('Uploaded CSV file not found.') . '</p>';
+	echo '<p><a href="/user/import">' . __ ('Back') . '</a></p>';
+	return;
+}
+
+$res = blog\CsvParser::parse ($file);
+if (! $res) {
+	echo '<p>' . __ ('Unable to parse the uploaded file.') . '</p>';
+	echo '<p><a href="/user/import">' . __ ('Back') . '</a></p>';
+	return;
+}
+
+// Map fields
+$name = false;
+$first_name = false;
+$last_name = false;
+$email = false;
+$company = false;
+$title = false;
+$website = false;
+$photo = false;
+$about = false;
+$phone = false;
+$address = false;
+$address2 = false;
+$city = false;
+$state = false;
+$country = false;
+$zip = false;
+
+$fields = ExtendedFields::for_class ('User');
+
+foreach ($_POST as $k => $v) {
+	if (strpos ($k, 'map-') === 0 && $v !== '') {
+		$n = (int) str_replace ('map-', '', $k);
+		${$v} = $n;
+	}
+}
+
+// Remove first line
+array_shift ($res);
+
+foreach ($res as $k => $row) {
+	$name_joined = ($first_name !== false) ? $row[$first_name] . ' ' . $row[$last_name] : '';
+	$user = array (
+		'name' => ($name !== false) ? $row[$name] : $name_joined,
+		'email' => ($email !== false) ? trim ($row[$email]) : '',
+		'company' => ($company !== false) ? $row[$company] : '',
+		'title' => ($title !== false) ? $row[$title] : '',
+		'website' => ($website !== false) ? $row[$website] : '',
+		'photo' => ($photo !== false) ? $row[$photo] : '',
+		'about' => ($about !== false) ? $row[$about] : '',
+		'phone' => ($phone !== false) ? $row[$phone] : '',
+		'address' => ($address !== false) ? $row[$address] : '',
+		'address2' => ($address2 !== false) ? $row[$address2] : '',
+		'city' => ($city !== false) ? $row[$city] : '',
+		'state' => ($state !== false) ? $row[$state] : '',
+		'country' => ($country !== false) ? $row[$country] : '',
+		'zip' => ($zip !== false) ? $row[$zip] : '',
+		'password' => '',
+		'type' => 'member',
+		'expires' => gmdate ('Y-m-d H:i:s'),
+		'signed_up' => gmdate ('Y-m-d H:i:s'),
+		'updated' => gmdate ('Y-m-d H:i:s')
+	);
+	
+	if ($user['email'] === '' || ! Validator::validate ($user['email'], 'unique', '#prefix#user.email')) {
+		continue;
+	}
+
+	$u = new User ($user);
+
+	$fields = ExtendedFields::for_class ('User');
+	foreach ($fields as $field) {
+		if (isset (${$field->name}) && ${$field->name} !== false) {
+			$u->ext ($field->name, $row[${$field->name}]);
+		}
+	}
+
+	if ($u->put ()) {
+		Versions::add ($u);
+		$imported++;
+	}
+}
+
+echo '<p>' . __ ('Imported %d members.', $imported) . '</p>';
+echo '<p><a href="/user/admin">' . __ ('Continue') . '</a></p>';
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/import/vcf.php elefant-elefant_1_3_10_beta/apps/user/handlers/import/vcf.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/import/vcf.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/import/vcf.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,69 @@
+<?php
+
+/**
+ * Implements a VCF importer.
+ */
+
+$this->require_acl ('admin', 'user');
+
+$page->layout = 'admin';
+$page->title = __ ('VCF importer');
+
+$f = new Form ('post');
+
+if ($f->submit ()) {
+	if (move_uploaded_file ($_FILES['import_file']['tmp_name'], 'cache/user_' . $_FILES['import_file']['name'])) {
+		$file = 'cache/user_' . $_FILES['import_file']['name'];
+		
+		$imported = 0;
+
+		$cards = new vCard ($file);
+		
+		if (count ($cards) === 1) {
+			$cards = array ($cards);
+		}
+
+		foreach ($cards as $card) {
+			$u = new User (array (
+				'name' => isset ($card->fn[0]) ? $card->fn[0] : '',
+				'email' => isset ($card->email[0]) ? $card->email[0]['Value'] : '',
+				'company' => isset ($card->org[0]) ? $card->org[0]['Name'] : '',
+				'title' => isset ($card->title[0]) ? $card->title[0] : '',
+				'website' => isset ($card->url[0]) ? $card->url[0]['Value'] : '',
+				'photo' => (isset ($card->photo[0]) && $card->photo[0]['Encoding'] === 'uri') ? $card->photo[0]['Value'] : '',
+				'about' => '',
+				'phone' => isset ($card->tel[0]) ? $card->tel[0]['Value'] : '',
+				'address' => isset ($card->adr[0]) ? $card->adr[0]['StreetAddress'] : '',
+				'address2' => '',
+				'city' => isset ($card->adr[0]) ? $card->adr[0]['Locality'] : '',
+				'state' => isset ($card->adr[0]) ? $card->adr[0]['Region'] : '',
+				'country' => isset ($card->adr[0]) ? $card->adr[0]['Country'] : '',
+				'zip' => isset ($card->adr[0]) ? $card->adr[0]['PostalCode'] : '',
+				'password' => '',
+				'type' => 'member',
+				'expires' => gmdate ('Y-m-d H:i:s'),
+				'signed_up' => gmdate ('Y-m-d H:i:s'),
+				'updated' => gmdate ('Y-m-d H:i:s')
+			));
+	
+			if ($u->email === '' || ! Validator::validate ($u->email, 'unique', '#prefix#user.email')) {
+				continue;
+			}
+
+			if ($u->put ()) {
+				Versions::add ($u);
+				$imported++;
+			}
+		}
+			
+		echo '<p>' . __ ('Imported %d members.', $imported) . '</p>';
+		echo '<p><a href="/user/admin">' . __ ('Continue') . '</a></p>';
+		return;
+	} else {
+		echo '<p><strong>' . __ ('Error uploading file.') . '</strong></p>';
+	}
+}
+
+$o = new StdClass;
+
+echo $tpl->render ('user/import/vcf', $o);
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/import.php elefant-elefant_1_3_10_beta/apps/user/handlers/import.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/import.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/import.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,13 @@
+<?php
+
+/**
+ * Lists available importers.
+ */
+
+$this->require_acl ('admin', 'user');
+
+$page->layout = 'admin';
+
+$page->title = __ ('Choose an importer');
+
+echo $tpl->render ('user/import');
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/index.php elefant-elefant_1_3_10_beta/apps/user/handlers/index.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/index.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/index.php	2014-12-03 23:59:25.000000000 -0600
@@ -25,7 +25,4 @@
 	$data->is_current = (User::is_valid () && $this->params[0] === User::$user->id) ? true : false;
 }
 
-$data->hash = md5 (strtolower (trim ($data->email)));
 echo $tpl->render ('user/index', $data);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/login/facebook.php elefant-elefant_1_3_10_beta/apps/user/handlers/login/facebook.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/login/facebook.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/login/facebook.php	2014-12-03 23:59:25.000000000 -0600
@@ -122,5 +122,3 @@
 	$_POST['token'] = $token;
 	echo $this->run ('user/login/newuser');
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/login/google.php elefant-elefant_1_3_10_beta/apps/user/handlers/login/google.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/login/google.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/login/google.php	2014-12-03 23:59:25.000000000 -0600
@@ -76,5 +76,3 @@
 	$_POST['token'] = $token;
 	echo $this->run ('user/login/newuser');
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/login/newpersona.php elefant-elefant_1_3_10_beta/apps/user/handlers/login/newpersona.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/login/newpersona.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/login/newpersona.php	2014-12-03 23:59:25.000000000 -0600
@@ -7,5 +7,3 @@
 $_POST['token'] = $_SESSION['persona/token'];
 
 echo $this->run ('user/login/newuser');
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/login/newuser.php elefant-elefant_1_3_10_beta/apps/user/handlers/login/newuser.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/login/newuser.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/login/newuser.php	2014-12-03 23:59:25.000000000 -0600
@@ -9,6 +9,10 @@
 	return;
 }
 
+// Check for a custom handler override
+$res = $this->override ('user/login/newuser');
+if ($res) { echo $res; return; }
+
 $f = new Form ('post', 'user/login/newuser');
 if ($f->submit ()) {
 	$date = gmdate ('Y-m-d H:i:s');
@@ -17,10 +21,11 @@
 		'email' => $_POST['email'],
 		'password' => User::encrypt_pass ($_POST['password']),
 		'expires' => $date,
-		'type' => 'member',
+		'type' => Appconf::user ('User', 'default_role'),
 		'signed_up' => $date,
 		'updated' => $date,
-		'userdata' => json_encode (array ())
+		'userdata' => json_encode (array ()),
+		'about' => ''
 	));
 	$u->put ();
 	Versions::add ($u);
@@ -48,5 +53,3 @@
 	$page->title = __ ('New User');
 	echo $tpl->render ('user/login/newuser', $u);
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/login/openid.php elefant-elefant_1_3_10_beta/apps/user/handlers/login/openid.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/login/openid.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/login/openid.php	2014-12-03 23:59:25.000000000 -0600
@@ -81,5 +81,3 @@
 	$_POST['token'] = $token;
 	echo $this->run ('user/login/newuser');
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/login/persona.php elefant-elefant_1_3_10_beta/apps/user/handlers/login/persona.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/login/persona.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/login/persona.php	2014-12-03 23:59:25.000000000 -0600
@@ -59,5 +59,3 @@
 	$_SESSION['persona/token'] = $response->email;
 	echo json_encode (array ('redirect' => '/user/login/newpersona'));
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/login/twitter.php elefant-elefant_1_3_10_beta/apps/user/handlers/login/twitter.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/login/twitter.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/login/twitter.php	2014-12-03 23:59:25.000000000 -0600
@@ -14,7 +14,8 @@
 	'consumer_secret' => $appconf['Twitter']['consumer_secret']
 ));
 
-$here = tmhUtilities::php_self ();
+$tmhu = new tmhUtilities;
+$here = $tmhu->php_self ();
 if (strpos ($here, '?redirect=') === false) {
 	$here .= '?redirect=' . urlencode ($_GET['redirect']);
 }
@@ -107,5 +108,3 @@
 		$this->redirect ($_GET['redirect']);
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/login.php elefant-elefant_1_3_10_beta/apps/user/handlers/login.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/login.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/login.php	2014-12-03 23:59:25.000000000 -0600
@@ -11,6 +11,8 @@
 
 if (! $this->internal) {
 	$page->title = __ ('Members');
+} elseif (isset ($data['redirect'])) {
+	$_POST['redirect'] = $data['redirect'];
 }
 
 if (isset ($_GET['redirect'])) {
@@ -37,5 +39,3 @@
 } elseif (! $this->internal) {
 	$this->redirect ($_POST['redirect']);
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/logout.php elefant-elefant_1_3_10_beta/apps/user/handlers/logout.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/logout.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/logout.php	2014-12-03 23:59:25.000000000 -0600
@@ -19,5 +19,3 @@
 
 Lock::clear ();
 echo User::logout ($_GET['redirect']);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/newpass.php elefant-elefant_1_3_10_beta/apps/user/handlers/newpass.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/newpass.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/newpass.php	2014-12-03 23:59:25.000000000 -0600
@@ -37,5 +37,3 @@
 	$page->title = __ ('Invalid or expired recovery link');
 	echo '<p><a href="/">' . __ ('Continue') . '</a></p>';
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/recover.php elefant-elefant_1_3_10_beta/apps/user/handlers/recover.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/recover.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/recover.php	2014-12-03 23:59:25.000000000 -0600
@@ -44,5 +44,3 @@
 	$page->title = __ ('Forgot your password?');
 	echo $tpl->render ('user/recover', $u);
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/role/add.php elefant-elefant_1_3_10_beta/apps/user/handlers/role/add.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/role/add.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/role/add.php	2014-12-03 23:59:25.000000000 -0600
@@ -15,7 +15,8 @@
 unset ($resources['default']);
 
 $form->data = array (
-	'_resources' => $resources
+	'_resources' => $resources,
+	'_roles' => array_keys (User::acl ()->rules)
 );
 
 echo $form->handle (function ($form) use ($page) {
@@ -61,5 +62,3 @@
 	$form->controller->add_notification (__ ('Role added.'));
 	$form->controller->redirect ('/user/roles');
 });
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/role/delete.php elefant-elefant_1_3_10_beta/apps/user/handlers/role/delete.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/role/delete.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/role/delete.php	2014-12-03 23:59:25.000000000 -0600
@@ -21,5 +21,3 @@
 	$this->add_notification (__ ('Role deleted.'));
 }
 $this->redirect ('/user/roles');
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/role/edit.php elefant-elefant_1_3_10_beta/apps/user/handlers/role/edit.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/role/edit.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/role/edit.php	2014-12-03 23:59:25.000000000 -0600
@@ -37,7 +37,8 @@
 $form->data = array (
 	'_resources' => $resources,
 	'name' => $_GET['role'],
-	'resources' => $checked
+	'resources' => $checked,
+	'_roles' => array_keys (User::acl ()->rules)
 );
 
 echo $form->handle (function ($form) use ($page) {
@@ -85,5 +86,3 @@
 	$form->controller->add_notification (__ ('Role saved.'));
 	$form->controller->redirect ('/user/roles');
 });
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/roles.php elefant-elefant_1_3_10_beta/apps/user/handlers/roles.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/roles.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/roles.php	2014-12-03 23:59:25.000000000 -0600
@@ -6,11 +6,9 @@
 
 $page->layout = 'admin';
 
-$this->require_acl ('admin', 'user', 'user/acl');
+$this->require_acl ('admin', 'user', 'user/roles');
 
 $page->title = __ ('Roles');
 echo $tpl->render ('user/roles', array (
 	'roles' => array_keys (User::acl ()->rules)
 ));
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/settings.php elefant-elefant_1_3_10_beta/apps/user/handlers/settings.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/settings.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/settings.php	2014-12-03 23:59:25.000000000 -0600
@@ -9,7 +9,7 @@
 require_once ('apps/admin/lib/Functions.php');
 
 $page->layout = 'admin';
-$page->title = __ ('User Settings');
+$page->title = __ ('Member Settings');
 
 $form = new Form ('post', $this);
 
@@ -29,7 +29,9 @@
 	'login_google' => in_array ('google', $appconf['User']['login_methods']),
 	'login_facebook' => in_array ('facebook', $appconf['User']['login_methods']),
 	'login_twitter' => in_array ('twitter', $appconf['User']['login_methods']),
-	'login_persona' => in_array ('persona', $appconf['User']['login_methods'])
+	'login_persona' => in_array ('persona', $appconf['User']['login_methods']),
+	'default_role' => $appconf['User']['default_role'],
+	'roles' => array_keys (User::acl ()->rules)
 );
 
 echo $form->handle (function ($form) {
@@ -55,7 +57,8 @@
 
 	$merged = Appconf::merge ('user', array (
 		'User' => array (
-			'login_methods' => $login_methods
+			'login_methods' => $login_methods,
+			'default_role' => $_POST['default_role']
 		),
 		'Facebook' => array (
 			'application_id' => $_POST['facebook_app_id'],
@@ -78,5 +81,3 @@
 	$form->controller->add_notification (__ ('Settings saved.'));
 	$form->controller->redirect ('/user/admin');
 });
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/sidebar.php elefant-elefant_1_3_10_beta/apps/user/handlers/sidebar.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/sidebar.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/sidebar.php	2014-12-03 23:59:25.000000000 -0600
@@ -21,5 +21,3 @@
 }
 
 echo $tpl->render ('user/sidebar', array ('login_methods' => $appconf['User']['login_methods']));
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/signup.php elefant-elefant_1_3_10_beta/apps/user/handlers/signup.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/signup.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/signup.php	2014-12-03 23:59:25.000000000 -0600
@@ -1,7 +1,15 @@
 <?php
 
 /**
- * Default user sign up form.
+ * Default user sign up form. You can specify a `redirect` value
+ * to send them to after logging in if you embed the signup into
+ * a page via:
+ *
+ *     echo $this->run ('user/signup', array ('redirect' => '/welcome'));
+ *
+ * Or in a template via:
+ *
+ *     {! user/signup?redirect=/welcome !}
  */
 
 // Check for a custom handler override
@@ -17,10 +25,11 @@
 		'email' => $_POST['email'],
 		'password' => User::encrypt_pass ($_POST['password']),
 		'expires' => $date,
-		'type' => 'member',
+		'type' => Appconf::user ('User', 'default_role'),
 		'signed_up' => $date,
 		'updated' => $date,
-		'userdata' => json_encode (array ('verifier' => $verifier))
+		'userdata' => json_encode (array ('verifier' => $verifier)),
+		'about' => ''
 	));
 	$u->put ();
 	Versions::add ($u);
@@ -45,7 +54,8 @@
 
 		$_POST['username'] = $_POST['email'];
 		User::require_login ();
-		$this->redirect ('/user');
+		$redirect = isset ($data['redirect']) ? $data['redirect'] : '/user';
+		$this->redirect ($redirect);
 	}
 	@error_log ('Error creating profile: ' . $u->error);
 	$page->title = __ ('An Error Occurred');
@@ -55,8 +65,8 @@
 	$u = new User;
 	$u = $f->merge_values ($u);
 	$u->failed = $f->failed;
-	$page->title = __ ('Sign Up');
+	if (! $this->internal) {
+		$page->title = __ ('Sign Up');
+	}
 	echo $tpl->render ('user/signup', $u);
 }
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/too-many-attempts.php elefant-elefant_1_3_10_beta/apps/user/handlers/too-many-attempts.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/too-many-attempts.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/too-many-attempts.php	2014-12-03 23:59:25.000000000 -0600
@@ -9,5 +9,3 @@
 		($appconf['User']['block_attempts_for'] / 60)
 	)
 );
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/update.php elefant-elefant_1_3_10_beta/apps/user/handlers/update.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/update.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/update.php	2014-12-03 23:59:25.000000000 -0600
@@ -16,13 +16,57 @@
 
 $u = User::$user;
 
-$f = new Form ('post', 'user/update');
-if ($f->submit ()) {
+$form = new Form ('post', $this);
+
+$form->data = $u->orig ();
+$form->data->password = '';
+$form->data = $form->merge_values ($form->data);
+$form->data->failed = $form->failed;
+$form->data->_states = user\Data::states ();
+$form->data->_countries = user\Data::countries ();
+$page->title = __ ('Update Profile');
+
+echo $form->handle (function ($form) use ($u, $page) {
 	$u->name = $_POST['name'];
 	$u->email = $_POST['email'];
 	if (! empty ($_POST['password'])) {
 		$u->password = User::encrypt_pass ($_POST['password']);
 	}
+	$u->about = $_POST['about'];
+	$u->phone = $_POST['phone'];
+	$u->address = $_POST['address'];
+	$u->address2 = $_POST['address2'];
+	$u->city = $_POST['city'];
+	$u->state = $_POST['state'];
+	$u->country = $_POST['country'];
+	$u->zip = $_POST['zip'];
+	$u->title = $_POST['title'];
+	$u->company = $_POST['company'];
+	$u->website = $_POST['website'];
+
+	if (isset ($_FILES['photo']) && is_uploaded_file ($_FILES['photo']['tmp_name'])) {
+		$tmp_file = 'cache/.' . basename ($_FILES['photo']['name']);
+		$old_file = $u->photo;
+		if (move_uploaded_file ($_FILES['photo']['tmp_name'], $tmp_file)) {
+			if (preg_match ('/\.jpe?g$/i', $tmp_file)) {
+				Image::reorient ($tmp_file);
+			}
+			
+			$u->photo = Image::resize (
+				$tmp_file,
+				Appconf::user ('User', 'photo_width'),
+				Appconf::user ('User', 'photo_height')
+			);
+			if (strpos ($u->photo, '#') !== false) {
+				error_log ('Error processing photo: ' . $u->photo);
+				$u->photo = $old_file;
+			} elseif (! empty ($old_file) && $old_file !== $u->photo && file_exists ($old_file)) {
+				unlink ($old_file);
+			}
+			unlink ($tmp_file);
+		}
+	}
+
 	$u->put ();
 	Versions::add ($u);
 	if (! $u->error) {
@@ -34,12 +78,4 @@
 	$page->title = __ ('An Error Occurred');
 	echo '<p>' . __ ('Please try again later.') . '</p>';
 	echo '<p><a href="/user">' . __ ('Back') . '</a></p>';
-} else {
-	$u->password = '';
-	$u = $f->merge_values ($u);
-	$u->failed = $f->failed;
-	$page->title = __ ('Update Profile');
-	echo $tpl->render ('user/update', $u);
-}
-
-?>
\ No newline at end of file
+});
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/upgrade.php elefant-elefant_1_3_10_beta/apps/user/handlers/upgrade.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/upgrade.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/upgrade.php	2014-12-03 23:59:25.000000000 -0600
@@ -48,5 +48,3 @@
 echo '<p>' . __ ('Done.') . '</p>';
 
 $this->mark_installed ('user', $appconf['Admin']['version']);
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/util/userchooser.php elefant-elefant_1_3_10_beta/apps/user/handlers/util/userchooser.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/util/userchooser.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/util/userchooser.php	2014-12-03 23:59:25.000000000 -0600
@@ -46,11 +46,9 @@
 $page->add_script ('/apps/user/js/jquery.userchooser.js');
 $page->add_script (
 	I18n::export (
-		'Add User',
-		'Choose a User',
+		'Add Member',
+		'Choose a Member',
 		'Search',
-		'Unable to load the user list. Please try again in a few seconds.'
+		'Unable to load the member list. Please try again in a few seconds.'
 	)
 );
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/handlers/verify.php elefant-elefant_1_3_10_beta/apps/user/handlers/verify.php
--- elefant-elefant_1_3_9_beta/apps/user/handlers/verify.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/handlers/verify.php	2014-12-03 23:59:25.000000000 -0600
@@ -21,5 +21,3 @@
 	$page->title = __ ('Invalid Verifier');
 	echo '<p><a href="/">' . __ ('Continue') . '</a></p>';
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/js/build/links.js elefant-elefant_1_3_10_beta/apps/user/js/build/links.js
--- elefant-elefant_1_3_9_beta/apps/user/js/build/links.js	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/js/build/links.js	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,180 @@
+/** @jsx React.DOM */
+var Link = React.createClass ({displayName: 'Link',
+	render: function () {
+		var link = this.props.link;
+		link.type = link.service.toLowerCase ().replace ('+', '-plus');
+		link.class_name = 'fa fa-' + link.type;
+		if (link.type === 'website') {
+			link.class_name = 'fa fa-external-link';
+		}
+		return (
+			React.DOM.div( {className:"link"}, 
+				React.DOM.span( {className:link.class_name}),
+				React.DOM.a( {href:link.link, target:"_blank"}, link.link),
+				" ",
+				React.DOM.span( {className:"note-delete"}, 
+					"(",React.DOM.a( {href:"#", onClick:this.handleDelete}, this.props.i18n.del),")"
+				)
+			)
+		);
+	},
+	
+	handleDelete: function (event) {
+		event.preventDefault ();
+		
+		if (! confirm (this.props.i18n.confirm_delete_link)) {
+			return false;
+		}
+
+		this.props.onLinkDelete ({id: this.props.link.id});
+	}
+});
+
+var LinkList = React.createClass ({displayName: 'LinkList',
+	render: function () {
+		var links = [],
+			i18n = this.props.i18n,
+			link_delete = this.props.onLinkDelete;
+		//console.log (this.props.links);
+		this.props.links.forEach (function (link) {
+			links.push (
+				Link(
+					{link:link,
+					key:link.id,
+					onLinkDelete:link_delete,
+					i18n:i18n}
+				)
+			);
+		});
+		return (React.DOM.div( {id:"link-list"}, links));
+	}
+});
+
+var LinkForm = React.createClass ({displayName: 'LinkForm',
+	render: function () {
+		return (
+			React.DOM.form( {onSubmit:this.handleSubmit}, 
+				React.DOM.p(null, 
+					React.DOM.input( {type:"text", ref:"handle", placeholder:this.props.i18n.link_placeholder, size:"35"} ),
+					React.DOM.select( {ref:"service"}, 
+						React.DOM.option( {value:""}, this.props.i18n.service),
+						React.DOM.option( {value:"Facebook"}, "Facebook"),
+						React.DOM.option( {value:"Google+"}, "Google+"),
+						React.DOM.option( {value:"Instagram"}, "Instagram"),
+						React.DOM.option( {value:"Twitter"}, "Twitter"),
+						React.DOM.option( {value:"Tumblr"}, "Tumblr"),
+						React.DOM.option( {value:"Website"}, "Website"),
+						React.DOM.option( {value:"YouTube"}, "YouTube")
+					),
+					React.DOM.input( {type:"submit", value:this.props.i18n.add_link} )
+				)
+			)
+		);
+	},
+	
+	handleSubmit: function (event) {
+		event.preventDefault ();
+
+		var handle = this.refs.handle.getDOMNode ().value,
+			service_node = this.refs.service.getDOMNode (),
+			service = service_node.options[service_node.selectedIndex].value;
+
+		this.props.onLinkSubmit ({handle: handle, service: service});
+		this.refs.handle.getDOMNode ().value = '';
+		service_node.selectedIndex = 0;
+	}
+});
+
+var LinkBox = React.createClass ({displayName: 'LinkBox',
+	getInitialState: function () {
+		return {links: []};
+	},
+	
+	loadLinksFromServer: function () {
+		$.ajax ({
+			url: this.props.init_url,
+			dataType: 'json',
+			success: function (res) {
+				if (! res.success) {
+					//console.log (res.error);
+				} else {
+					this.setState ({links: res.data});
+				}
+			}.bind (this),
+			error: function (xhr, status, err) {
+				// do nothing
+				//console.log (err.toString ());
+			}.bind (this)
+		});
+	},
+	
+	handleLinkDelete: function (data) {
+		var notification = this.props.i18n.link_deleted;
+
+		data.user = this.props.user_id;
+		//console.log (data);
+		$.ajax ({
+			url: this.props.del_url,
+			dataType: 'json',
+			type: 'POST',
+			data: data,
+			success: function (res) {
+				if (! res.success) {
+					//console.log (res.error);
+				} else {
+					$.add_notification (notification);
+					this.setState ({links: res.data});
+				}
+			}.bind (this),
+			error: function (xhr, status, err) {
+				// do nothing
+				//console.error (this.props_add_url, status, err.toString ());
+			}.bind (this)
+		});
+	},
+	
+	handleLinkSubmit: function (data) {
+		var notification = this.props.i18n.link_added;
+
+		data.user = this.props.user_id;
+		//console.log (data);
+		$.ajax ({
+			url: this.props.add_url,
+			dataType: 'json',
+			type: 'POST',
+			data: data,
+			success: function (res) {
+				if (! res.success) {
+					//console.log (res.error);
+				} else {
+					$.add_notification (notification);
+					this.setState ({links: res.data});
+				}
+			}.bind (this),
+			error: function (xhr, status, err) {
+				// do nothing
+				//console.error (this.props_add_url, status, err.toString ());
+			}.bind (this)
+		});
+	},
+	
+	componentWillMount: function () {
+		this.loadLinksFromServer ();
+	},
+	
+	render: function () {
+		return (
+			React.DOM.div( {className:"link-box"}, 
+				LinkList(
+					{links:this.state.links,
+					onLinkDelete:this.handleLinkDelete,
+					i18n:this.props.i18n}
+				),
+				LinkForm(
+					{onLinkSubmit:this.handleLinkSubmit,
+					i18n:this.props.i18n}
+				)
+			)
+		);
+	}
+});
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/js/build/notes.js elefant-elefant_1_3_10_beta/apps/user/js/build/notes.js
--- elefant-elefant_1_3_9_beta/apps/user/js/build/notes.js	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/js/build/notes.js	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,178 @@
+/** @jsx React.DOM */
+var Note = React.createClass ({displayName: 'Note',
+	render: function () {
+		var note = this.props.note,
+			del = '';
+
+		if (this.props.current_user == note.made_by) {
+			del = (
+				React.DOM.span( {className:"note-delete"}, 
+					"(",React.DOM.a( {href:"#", onClick:this.handleDelete}, this.props.i18n.del),")"
+				)
+			);
+		}
+
+		return (
+			React.DOM.div( {className:"note"}, 
+				React.DOM.div( {className:"note-info-line"}, 
+					React.DOM.span( {className:"note-date-time", dangerouslySetInnerHTML:{__html: note.date}} ),
+					" — ",
+					React.DOM.span( {className:"note-made-by"}, note.made_by_name),
+					" ",
+					del
+				),
+				React.DOM.span( {className:"note-body"}, note.note)
+			)
+		);
+	},
+	
+	handleDelete: function (event) {
+		event.preventDefault ();
+		
+		if (! confirm (this.props.i18n.confirm_delete_note)) {
+			return false;
+		}
+
+		this.props.onNoteDelete ({id: this.props.note.id});
+	}
+});
+
+var NoteList = React.createClass ({displayName: 'NoteList',
+	render: function () {
+		var notes = [],
+			i18n = this.props.i18n,
+			user_id = this.props.user_id,
+			note_delete = this.props.onNoteDelete,
+			current_user = this.props.current_user;
+
+		this.props.notes.forEach (function (note) {
+			notes.push (
+				Note(
+					{note:note,
+					key:note.id,
+					user_id:user_id,
+					current_user:current_user,
+					onNoteDelete:note_delete,
+					i18n:i18n}
+				)
+			);
+		});
+		return (React.DOM.div( {id:"note-list"}, notes));
+	}
+});
+
+var NoteForm = React.createClass ({displayName: 'NoteForm',
+	render: function () {
+		return (
+			React.DOM.form( {onSubmit:this.handleSubmit}, 
+				React.DOM.p(null, 
+					React.DOM.textarea( {ref:"note", cols:"70", rows:"4"}),React.DOM.br(null ),
+					React.DOM.input( {type:"submit", value:this.props.i18n.add_note} )
+				)
+			)
+		);
+	},
+	
+	handleSubmit: function (event) {
+		event.preventDefault ();
+		var note = this.refs.note.getDOMNode ().value;
+		this.props.onNoteSubmit ({note: note});
+		this.refs.note.getDOMNode ().value = '';
+	}
+});
+
+var NoteBox = React.createClass ({displayName: 'NoteBox',
+	getInitialState: function () {
+		return {notes: []};
+	},
+	
+	loadNotesFromServer: function () {
+		$.ajax ({
+			url: this.props.init_url,
+			dataType: 'json',
+			success: function (res) {
+				if (! res.success) {
+					//console.log (res.error);
+				} else {
+					this.setState ({notes: res.data});
+				}
+			}.bind (this),
+			error: function (xhr, status, err) {
+				// do nothing
+				//console.log (err.toString ());
+			}.bind (this)
+		});
+	},
+	
+	handleNoteDelete: function (data) {
+		var notification = this.props.i18n.note_deleted;
+
+		data.user = this.props.user_id;
+		//console.log (data);
+		$.ajax ({
+			url: this.props.del_url,
+			dataType: 'json',
+			type: 'POST',
+			data: data,
+			success: function (res) {
+				if (! res.success) {
+					//console.log (res.error);
+				} else {
+					$.add_notification (notification);
+					this.setState ({notes: res.data});
+				}
+			}.bind (this),
+			error: function (xhr, status, err) {
+				// do nothing
+				//console.error (this.props_add_url, status, err.toString ());
+			}.bind (this)
+		});
+	},
+	
+	handleNoteSubmit: function (data) {
+		var notification = this.props.i18n.note_added;
+
+		data.user = this.props.user_id;
+		//console.log (data);
+		$.ajax ({
+			url: this.props.add_url,
+			dataType: 'json',
+			type: 'POST',
+			data: data,
+			success: function (res) {
+				if (! res.success) {
+					//console.log (res.error);
+				} else {
+					$.add_notification (notification);
+					this.setState ({notes: res.data});
+				}
+			}.bind (this),
+			error: function (xhr, status, err) {
+				// do nothing
+				//console.error (this.props_add_url, status, err.toString ());
+			}.bind (this)
+		});
+	},
+	
+	componentWillMount: function () {
+		this.loadNotesFromServer ();
+	},
+
+	render: function () {
+		return (
+			React.DOM.div( {className:"note-box"}, 
+				NoteList(
+					{notes:this.state.notes,
+					user_id:this.props.user_id,
+					current_user:this.props.current_user,
+					onNoteDelete:this.handleNoteDelete,
+					i18n:this.props.i18n}
+				),
+				NoteForm(
+					{onNoteSubmit:this.handleNoteSubmit,
+					i18n:this.props.i18n}
+				)
+			)
+		);
+	}
+});
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/js/jquery.adduser.js elefant-elefant_1_3_10_beta/apps/user/js/jquery.adduser.js
--- elefant-elefant_1_3_9_beta/apps/user/js/jquery.adduser.js	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/js/jquery.adduser.js	2014-12-03 23:59:25.000000000 -0600
@@ -48,13 +48,13 @@
 	$.add_user = function (opts) {
 		var defaults = {
 			callback: null,
-			title: $.i18n ('Add User')
+			title: $.i18n ('Add Member')
 		}
 
 		self.opts = $.extend (defaults, opts);
 
 		if (! self.initialized) {
-			alert ($.i18n ('Unable to load the add user form. Please try again in a few seconds.'));
+			alert ($.i18n ('Unable to load the add member form. Please try again in a few seconds.'));
 			return;
 		}
 
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/js/jquery.userchooser.js elefant-elefant_1_3_10_beta/apps/user/js/jquery.userchooser.js
--- elefant-elefant_1_3_9_beta/apps/user/js/jquery.userchooser.js	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/js/jquery.userchooser.js	2014-12-03 23:59:25.000000000 -0600
@@ -34,7 +34,9 @@
 			if (q === '' || self.users[i].name.toLowerCase ().match (q)) {
 				if ($.inArray (parseInt (self.users[i].id), self.opts.chosen) > -1) {
 					if (self.opts.chosen_visible) {
-						list.append ('<li><span class="userchooser-disabled"><i class="fa fa-user"></i> ' + self.users[i].name + '</span></li>');
+						list.append ('<li><span class="userchooser-disabled"><i class="fa fa-user"></i> '
+							+ $('<div />').text (self.users[i].name).html ()
+							+ '</span></li>');
 					}
 				} else {
 					list.append (
@@ -44,7 +46,8 @@
 								.data ('id', self.users[i].id)
 								.data ('name', self.users[i].name)
 								.data ('email', self.users[i].email)
-								.html ('<i class="fa fa-user"></i> ' + self.users[i].name)
+								.html ('<i class="fa fa-user"></i> '
+								+ $('<div />').text (self.users[i].name).html ())
 						)
 					);
 				}
@@ -153,7 +156,7 @@
 			set_name_value: null,
 			set_email_value: null,
 			set_mailto: null,
-			title: $.i18n ('Choose a User'),
+			title: $.i18n ('Choose a Member'),
 			chosen: [],
 			chosen_visible: true
 		};
@@ -161,12 +164,12 @@
 		self.opts = $.extend (defaults, opts);
 		
 		if (! self.initialized) {
-			alert ($.i18n ('Unable to load the user list. Please try again in a few seconds.'));
+			alert ($.i18n ('Unable to load the member list. Please try again in a few seconds.'));
 			return;
 		}
 
 		var html = '<div id="userchooser-wrapper">' +
-			'<a href="#" id="userchooser-add-link" class="clearfix">' + $.i18n ('Add User') + '</a>' +
+			'<a href="#" id="userchooser-add-link" class="clearfix">' + $.i18n ('Add Member') + '</a>' +
 			'<div id="userchooser-search">' +
 				'<form id="userchooser-form">' +
 					'<input type="text" name="userchooser-input" id="userchooser-input" size="30" />' +
@@ -183,7 +186,9 @@
 		for (var i = 0; i < self.users.length; i++) {
 			if ($.inArray (parseInt (self.users[i].id), self.opts.chosen) > -1) {
 				if (self.opts.chosen_visible) {
-					list.append ('<li><span class="userchooser-disabled"><i class="fa fa-user"></i> ' + self.users[i].name + '</span></li>');
+					list.append ('<li><span class="userchooser-disabled"><i class="fa fa-user"></i> '
+						+ $('<div />').text (self.users[i].name).html ()
+						+ '</span></li>');
 				}
 			} else {
 				list.append (
@@ -193,7 +198,8 @@
 							.data ('id', self.users[i].id)
 							.data ('name', self.users[i].name)
 							.data ('email', self.users[i].email)
-							.html ('<i class="fa fa-user"></i> ' + self.users[i].name)
+							.html ('<i class="fa fa-user"></i> '
+							+ $('<div />').text (self.users[i].name).html ())
 					)
 				);
 			}
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/js/jsx/links.js elefant-elefant_1_3_10_beta/apps/user/js/jsx/links.js
--- elefant-elefant_1_3_9_beta/apps/user/js/jsx/links.js	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/js/jsx/links.js	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,180 @@
+/** @jsx React.DOM */
+var Link = React.createClass ({
+	render: function () {
+		var link = this.props.link;
+		link.type = link.service.toLowerCase ().replace ('+', '-plus');
+		link.class_name = 'fa fa-' + link.type;
+		if (link.type === 'website') {
+			link.class_name = 'fa fa-external-link';
+		}
+		return (
+			<div className="link">
+				<span className={link.class_name}></span>
+				<a href={link.link} target="_blank">{link.link}</a>
+				&nbsp;
+				<span className="note-delete">
+					(<a href="#" onClick={this.handleDelete}>{this.props.i18n.del}</a>)
+				</span>
+			</div>
+		);
+	},
+	
+	handleDelete: function (event) {
+		event.preventDefault ();
+		
+		if (! confirm (this.props.i18n.confirm_delete_link)) {
+			return false;
+		}
+
+		this.props.onLinkDelete ({id: this.props.link.id});
+	}
+});
+
+var LinkList = React.createClass ({
+	render: function () {
+		var links = [],
+			i18n = this.props.i18n,
+			link_delete = this.props.onLinkDelete;
+		//console.log (this.props.links);
+		this.props.links.forEach (function (link) {
+			links.push (
+				<Link
+					link={link}
+					key={link.id}
+					onLinkDelete={link_delete}
+					i18n={i18n}
+				/>
+			);
+		});
+		return (<div id="link-list">{links}</div>);
+	}
+});
+
+var LinkForm = React.createClass ({
+	render: function () {
+		return (
+			<form onSubmit={this.handleSubmit}>
+				<p>
+					<input type="text" ref="handle" placeholder={this.props.i18n.link_placeholder} size="35" />
+					<select ref="service">
+						<option value="">{this.props.i18n.service}</option>
+						<option value="Facebook">Facebook</option>
+						<option value="Google+">Google+</option>
+						<option value="Instagram">Instagram</option>
+						<option value="Twitter">Twitter</option>
+						<option value="Tumblr">Tumblr</option>
+						<option value="Website">Website</option>
+						<option value="YouTube">YouTube</option>
+					</select>
+					<input type="submit" value={this.props.i18n.add_link} />
+				</p>
+			</form>
+		);
+	},
+	
+	handleSubmit: function (event) {
+		event.preventDefault ();
+
+		var handle = this.refs.handle.getDOMNode ().value,
+			service_node = this.refs.service.getDOMNode (),
+			service = service_node.options[service_node.selectedIndex].value;
+
+		this.props.onLinkSubmit ({handle: handle, service: service});
+		this.refs.handle.getDOMNode ().value = '';
+		service_node.selectedIndex = 0;
+	}
+});
+
+var LinkBox = React.createClass ({
+	getInitialState: function () {
+		return {links: []};
+	},
+	
+	loadLinksFromServer: function () {
+		$.ajax ({
+			url: this.props.init_url,
+			dataType: 'json',
+			success: function (res) {
+				if (! res.success) {
+					//console.log (res.error);
+				} else {
+					this.setState ({links: res.data});
+				}
+			}.bind (this),
+			error: function (xhr, status, err) {
+				// do nothing
+				//console.log (err.toString ());
+			}.bind (this)
+		});
+	},
+	
+	handleLinkDelete: function (data) {
+		var notification = this.props.i18n.link_deleted;
+
+		data.user = this.props.user_id;
+		//console.log (data);
+		$.ajax ({
+			url: this.props.del_url,
+			dataType: 'json',
+			type: 'POST',
+			data: data,
+			success: function (res) {
+				if (! res.success) {
+					//console.log (res.error);
+				} else {
+					$.add_notification (notification);
+					this.setState ({links: res.data});
+				}
+			}.bind (this),
+			error: function (xhr, status, err) {
+				// do nothing
+				//console.error (this.props_add_url, status, err.toString ());
+			}.bind (this)
+		});
+	},
+	
+	handleLinkSubmit: function (data) {
+		var notification = this.props.i18n.link_added;
+
+		data.user = this.props.user_id;
+		//console.log (data);
+		$.ajax ({
+			url: this.props.add_url,
+			dataType: 'json',
+			type: 'POST',
+			data: data,
+			success: function (res) {
+				if (! res.success) {
+					//console.log (res.error);
+				} else {
+					$.add_notification (notification);
+					this.setState ({links: res.data});
+				}
+			}.bind (this),
+			error: function (xhr, status, err) {
+				// do nothing
+				//console.error (this.props_add_url, status, err.toString ());
+			}.bind (this)
+		});
+	},
+	
+	componentWillMount: function () {
+		this.loadLinksFromServer ();
+	},
+	
+	render: function () {
+		return (
+			<div className="link-box">
+				<LinkList
+					links={this.state.links}
+					onLinkDelete={this.handleLinkDelete}
+					i18n={this.props.i18n}
+				/>
+				<LinkForm
+					onLinkSubmit={this.handleLinkSubmit}
+					i18n={this.props.i18n}
+				/>
+			</div>
+		);
+	}
+});
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/js/jsx/notes.js elefant-elefant_1_3_10_beta/apps/user/js/jsx/notes.js
--- elefant-elefant_1_3_9_beta/apps/user/js/jsx/notes.js	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/js/jsx/notes.js	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,178 @@
+/** @jsx React.DOM */
+var Note = React.createClass ({
+	render: function () {
+		var note = this.props.note,
+			del = '';
+
+		if (this.props.current_user == note.made_by) {
+			del = (
+				<span className="note-delete">
+					(<a href="#" onClick={this.handleDelete}>{this.props.i18n.del}</a>)
+				</span>
+			);
+		}
+
+		return (
+			<div className="note">
+				<div className="note-info-line">
+					<span className="note-date-time" dangerouslySetInnerHTML={{__html: note.date}} />
+					&nbsp;&mdash;&nbsp;
+					<span className="note-made-by">{note.made_by_name}</span>
+					&nbsp;
+					{del}
+				</div>
+				<span className="note-body">{note.note}</span>
+			</div>
+		);
+	},
+	
+	handleDelete: function (event) {
+		event.preventDefault ();
+		
+		if (! confirm (this.props.i18n.confirm_delete_note)) {
+			return false;
+		}
+
+		this.props.onNoteDelete ({id: this.props.note.id});
+	}
+});
+
+var NoteList = React.createClass ({
+	render: function () {
+		var notes = [],
+			i18n = this.props.i18n,
+			user_id = this.props.user_id,
+			note_delete = this.props.onNoteDelete,
+			current_user = this.props.current_user;
+
+		this.props.notes.forEach (function (note) {
+			notes.push (
+				<Note
+					note={note}
+					key={note.id}
+					user_id={user_id}
+					current_user={current_user}
+					onNoteDelete={note_delete}
+					i18n={i18n}
+				/>
+			);
+		});
+		return (<div id="note-list">{notes}</div>);
+	}
+});
+
+var NoteForm = React.createClass ({
+	render: function () {
+		return (
+			<form onSubmit={this.handleSubmit}>
+				<p>
+					<textarea ref="note" cols="70" rows="4"></textarea><br />
+					<input type="submit" value={this.props.i18n.add_note} />
+				</p>
+			</form>
+		);
+	},
+	
+	handleSubmit: function (event) {
+		event.preventDefault ();
+		var note = this.refs.note.getDOMNode ().value;
+		this.props.onNoteSubmit ({note: note});
+		this.refs.note.getDOMNode ().value = '';
+	}
+});
+
+var NoteBox = React.createClass ({
+	getInitialState: function () {
+		return {notes: []};
+	},
+	
+	loadNotesFromServer: function () {
+		$.ajax ({
+			url: this.props.init_url,
+			dataType: 'json',
+			success: function (res) {
+				if (! res.success) {
+					//console.log (res.error);
+				} else {
+					this.setState ({notes: res.data});
+				}
+			}.bind (this),
+			error: function (xhr, status, err) {
+				// do nothing
+				//console.log (err.toString ());
+			}.bind (this)
+		});
+	},
+	
+	handleNoteDelete: function (data) {
+		var notification = this.props.i18n.note_deleted;
+
+		data.user = this.props.user_id;
+		//console.log (data);
+		$.ajax ({
+			url: this.props.del_url,
+			dataType: 'json',
+			type: 'POST',
+			data: data,
+			success: function (res) {
+				if (! res.success) {
+					//console.log (res.error);
+				} else {
+					$.add_notification (notification);
+					this.setState ({notes: res.data});
+				}
+			}.bind (this),
+			error: function (xhr, status, err) {
+				// do nothing
+				//console.error (this.props_add_url, status, err.toString ());
+			}.bind (this)
+		});
+	},
+	
+	handleNoteSubmit: function (data) {
+		var notification = this.props.i18n.note_added;
+
+		data.user = this.props.user_id;
+		//console.log (data);
+		$.ajax ({
+			url: this.props.add_url,
+			dataType: 'json',
+			type: 'POST',
+			data: data,
+			success: function (res) {
+				if (! res.success) {
+					//console.log (res.error);
+				} else {
+					$.add_notification (notification);
+					this.setState ({notes: res.data});
+				}
+			}.bind (this),
+			error: function (xhr, status, err) {
+				// do nothing
+				//console.error (this.props_add_url, status, err.toString ());
+			}.bind (this)
+		});
+	},
+	
+	componentWillMount: function () {
+		this.loadNotesFromServer ();
+	},
+
+	render: function () {
+		return (
+			<div className="note-box">
+				<NoteList
+					notes={this.state.notes}
+					user_id={this.props.user_id}
+					current_user={this.props.current_user}
+					onNoteDelete={this.handleNoteDelete}
+					i18n={this.props.i18n}
+				/>
+				<NoteForm
+					onNoteSubmit={this.handleNoteSubmit}
+					i18n={this.props.i18n}
+				/>
+			</div>
+		);
+	}
+});
Files elefant-elefant_1_3_9_beta/apps/user/js/persona.js and elefant-elefant_1_3_10_beta/apps/user/js/persona.js are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/js/react/JSXTransformer.js elefant-elefant_1_3_10_beta/apps/user/js/react/JSXTransformer.js
--- elefant-elefant_1_3_9_beta/apps/user/js/react/JSXTransformer.js	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/js/react/JSXTransformer.js	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,12569 @@
+/**
+ * JSXTransformer v0.10.0
+ */
+!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.JSXTransformer=e()}}(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){
+/**
+ * The buffer module from node.js, for the browser.
+ *
+ * Author:   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
+ * License:  MIT
+ *
+ * `npm install buffer`
+ */
+
+var base64 = _dereq_('base64-js')
+var ieee754 = _dereq_('ieee754')
+
+exports.Buffer = Buffer
+exports.SlowBuffer = Buffer
+exports.INSPECT_MAX_BYTES = 50
+Buffer.poolSize = 8192
+
+/**
+ * If `Buffer._useTypedArrays`:
+ *   === true    Use Uint8Array implementation (fastest)
+ *   === false   Use Object implementation (compatible down to IE6)
+ */
+Buffer._useTypedArrays = (function () {
+   // Detect if browser supports Typed Arrays. Supported browsers are IE 10+,
+   // Firefox 4+, Chrome 7+, Safari 5.1+, Opera 11.6+, iOS 4.2+.
+  if (typeof Uint8Array !== 'function' || typeof ArrayBuffer !== 'function')
+    return false
+
+  // Does the browser support adding properties to `Uint8Array` instances? If
+  // not, then that's the same as no `Uint8Array` support. We need to be able to
+  // add all the node Buffer API methods.
+  // Bug in Firefox 4-29, now fixed: https://bugzilla.mozilla.org/show_bug.cgi?id=695438
+  try {
+    var arr = new Uint8Array(0)
+    arr.foo = function () { return 42 }
+    return 42 === arr.foo() &&
+        typeof arr.subarray === 'function' // Chrome 9-10 lack `subarray`
+  } catch (e) {
+    return false
+  }
+})()
+
+/**
+ * Class: Buffer
+ * =============
+ *
+ * The Buffer constructor returns instances of `Uint8Array` that are augmented
+ * with function properties for all the node `Buffer` API functions. We use
+ * `Uint8Array` so that square bracket notation works as expected -- it returns
+ * a single octet.
+ *
+ * By augmenting the instances, we can avoid modifying the `Uint8Array`
+ * prototype.
+ */
+function Buffer (subject, encoding, noZero) {
+  if (!(this instanceof Buffer))
+    return new Buffer(subject, encoding, noZero)
+
+  var type = typeof subject
+
+  // Workaround: node's base64 implementation allows for non-padded strings
+  // while base64-js does not.
+  if (encoding === 'base64' && type === 'string') {
+    subject = stringtrim(subject)
+    while (subject.length % 4 !== 0) {
+      subject = subject + '='
+    }
+  }
+
+  // Find the length
+  var length
+  if (type === 'number')
+    length = coerce(subject)
+  else if (type === 'string')
+    length = Buffer.byteLength(subject, encoding)
+  else if (type === 'object')
+    length = coerce(subject.length) // Assume object is an array
+  else
+    throw new Error('First argument needs to be a number, array or string.')
+
+  var buf
+  if (Buffer._useTypedArrays) {
+    // Preferred: Return an augmented `Uint8Array` instance for best performance
+    buf = augment(new Uint8Array(length))
+  } else {
+    // Fallback: Return THIS instance of Buffer (created by `new`)
+    buf = this
+    buf.length = length
+    buf._isBuffer = true
+  }
+
+  var i
+  if (Buffer._useTypedArrays && typeof Uint8Array === 'function' &&
+      subject instanceof Uint8Array) {
+    // Speed optimization -- use set if we're copying from a Uint8Array
+    buf._set(subject)
+  } else if (isArrayish(subject)) {
+    // Treat array-ish objects as a byte array
+    for (i = 0; i < length; i++) {
+      if (Buffer.isBuffer(subject))
+        buf[i] = subject.readUInt8(i)
+      else
+        buf[i] = subject[i]
+    }
+  } else if (type === 'string') {
+    buf.write(subject, 0, encoding)
+  } else if (type === 'number' && !Buffer._useTypedArrays && !noZero) {
+    for (i = 0; i < length; i++) {
+      buf[i] = 0
+    }
+  }
+
+  return buf
+}
+
+// STATIC METHODS
+// ==============
+
+Buffer.isEncoding = function (encoding) {
+  switch (String(encoding).toLowerCase()) {
+    case 'hex':
+    case 'utf8':
+    case 'utf-8':
+    case 'ascii':
+    case 'binary':
+    case 'base64':
+    case 'raw':
+    case 'ucs2':
+    case 'ucs-2':
+    case 'utf16le':
+    case 'utf-16le':
+      return true
+    default:
+      return false
+  }
+}
+
+Buffer.isBuffer = function (b) {
+  return !!(b !== null && b !== undefined && b._isBuffer)
+}
+
+Buffer.byteLength = function (str, encoding) {
+  var ret
+  str = str + ''
+  switch (encoding || 'utf8') {
+    case 'hex':
+      ret = str.length / 2
+      break
+    case 'utf8':
+    case 'utf-8':
+      ret = utf8ToBytes(str).length
+      break
+    case 'ascii':
+    case 'binary':
+    case 'raw':
+      ret = str.length
+      break
+    case 'base64':
+      ret = base64ToBytes(str).length
+      break
+    case 'ucs2':
+    case 'ucs-2':
+    case 'utf16le':
+    case 'utf-16le':
+      ret = str.length * 2
+      break
+    default:
+      throw new Error('Unknown encoding')
+  }
+  return ret
+}
+
+Buffer.concat = function (list, totalLength) {
+  assert(isArray(list), 'Usage: Buffer.concat(list, [totalLength])\n' +
+      'list should be an Array.')
+
+  if (list.length === 0) {
+    return new Buffer(0)
+  } else if (list.length === 1) {
+    return list[0]
+  }
+
+  var i
+  if (typeof totalLength !== 'number') {
+    totalLength = 0
+    for (i = 0; i < list.length; i++) {
+      totalLength += list[i].length
+    }
+  }
+
+  var buf = new Buffer(totalLength)
+  var pos = 0
+  for (i = 0; i < list.length; i++) {
+    var item = list[i]
+    item.copy(buf, pos)
+    pos += item.length
+  }
+  return buf
+}
+
+// BUFFER INSTANCE METHODS
+// =======================
+
+function _hexWrite (buf, string, offset, length) {
+  offset = Number(offset) || 0
+  var remaining = buf.length - offset
+  if (!length) {
+    length = remaining
+  } else {
+    length = Number(length)
+    if (length > remaining) {
+      length = remaining
+    }
+  }
+
+  // must be an even number of digits
+  var strLen = string.length
+  assert(strLen % 2 === 0, 'Invalid hex string')
+
+  if (length > strLen / 2) {
+    length = strLen / 2
+  }
+  for (var i = 0; i < length; i++) {
+    var byte = parseInt(string.substr(i * 2, 2), 16)
+    assert(!isNaN(byte), 'Invalid hex string')
+    buf[offset + i] = byte
+  }
+  Buffer._charsWritten = i * 2
+  return i
+}
+
+function _utf8Write (buf, string, offset, length) {
+  var charsWritten = Buffer._charsWritten =
+    blitBuffer(utf8ToBytes(string), buf, offset, length)
+  return charsWritten
+}
+
+function _asciiWrite (buf, string, offset, length) {
+  var charsWritten = Buffer._charsWritten =
+    blitBuffer(asciiToBytes(string), buf, offset, length)
+  return charsWritten
+}
+
+function _binaryWrite (buf, string, offset, length) {
+  return _asciiWrite(buf, string, offset, length)
+}
+
+function _base64Write (buf, string, offset, length) {
+  var charsWritten = Buffer._charsWritten =
+    blitBuffer(base64ToBytes(string), buf, offset, length)
+  return charsWritten
+}
+
+function _utf16leWrite (buf, string, offset, length) {
+  var charsWritten = Buffer._charsWritten =
+    blitBuffer(utf16leToBytes(string), buf, offset, length)
+  return charsWritten
+}
+
+Buffer.prototype.write = function (string, offset, length, encoding) {
+  // Support both (string, offset, length, encoding)
+  // and the legacy (string, encoding, offset, length)
+  if (isFinite(offset)) {
+    if (!isFinite(length)) {
+      encoding = length
+      length = undefined
+    }
+  } else {  // legacy
+    var swap = encoding
+    encoding = offset
+    offset = length
+    length = swap
+  }
+
+  offset = Number(offset) || 0
+  var remaining = this.length - offset
+  if (!length) {
+    length = remaining
+  } else {
+    length = Number(length)
+    if (length > remaining) {
+      length = remaining
+    }
+  }
+  encoding = String(encoding || 'utf8').toLowerCase()
+
+  var ret
+  switch (encoding) {
+    case 'hex':
+      ret = _hexWrite(this, string, offset, length)
+      break
+    case 'utf8':
+    case 'utf-8':
+      ret = _utf8Write(this, string, offset, length)
+      break
+    case 'ascii':
+      ret = _asciiWrite(this, string, offset, length)
+      break
+    case 'binary':
+      ret = _binaryWrite(this, string, offset, length)
+      break
+    case 'base64':
+      ret = _base64Write(this, string, offset, length)
+      break
+    case 'ucs2':
+    case 'ucs-2':
+    case 'utf16le':
+    case 'utf-16le':
+      ret = _utf16leWrite(this, string, offset, length)
+      break
+    default:
+      throw new Error('Unknown encoding')
+  }
+  return ret
+}
+
+Buffer.prototype.toString = function (encoding, start, end) {
+  var self = this
+
+  encoding = String(encoding || 'utf8').toLowerCase()
+  start = Number(start) || 0
+  end = (end !== undefined)
+    ? Number(end)
+    : end = self.length
+
+  // Fastpath empty strings
+  if (end === start)
+    return ''
+
+  var ret
+  switch (encoding) {
+    case 'hex':
+      ret = _hexSlice(self, start, end)
+      break
+    case 'utf8':
+    case 'utf-8':
+      ret = _utf8Slice(self, start, end)
+      break
+    case 'ascii':
+      ret = _asciiSlice(self, start, end)
+      break
+    case 'binary':
+      ret = _binarySlice(self, start, end)
+      break
+    case 'base64':
+      ret = _base64Slice(self, start, end)
+      break
+    case 'ucs2':
+    case 'ucs-2':
+    case 'utf16le':
+    case 'utf-16le':
+      ret = _utf16leSlice(self, start, end)
+      break
+    default:
+      throw new Error('Unknown encoding')
+  }
+  return ret
+}
+
+Buffer.prototype.toJSON = function () {
+  return {
+    type: 'Buffer',
+    data: Array.prototype.slice.call(this._arr || this, 0)
+  }
+}
+
+// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)
+Buffer.prototype.copy = function (target, target_start, start, end) {
+  var source = this
+
+  if (!start) start = 0
+  if (!end && end !== 0) end = this.length
+  if (!target_start) target_start = 0
+
+  // Copy 0 bytes; we're done
+  if (end === start) return
+  if (target.length === 0 || source.length === 0) return
+
+  // Fatal error conditions
+  assert(end >= start, 'sourceEnd < sourceStart')
+  assert(target_start >= 0 && target_start < target.length,
+      'targetStart out of bounds')
+  assert(start >= 0 && start < source.length, 'sourceStart out of bounds')
+  assert(end >= 0 && end <= source.length, 'sourceEnd out of bounds')
+
+  // Are we oob?
+  if (end > this.length)
+    end = this.length
+  if (target.length - target_start < end - start)
+    end = target.length - target_start + start
+
+  // copy!
+  for (var i = 0; i < end - start; i++)
+    target[i + target_start] = this[i + start]
+}
+
+function _base64Slice (buf, start, end) {
+  if (start === 0 && end === buf.length) {
+    return base64.fromByteArray(buf)
+  } else {
+    return base64.fromByteArray(buf.slice(start, end))
+  }
+}
+
+function _utf8Slice (buf, start, end) {
+  var res = ''
+  var tmp = ''
+  end = Math.min(buf.length, end)
+
+  for (var i = start; i < end; i++) {
+    if (buf[i] <= 0x7F) {
+      res += decodeUtf8Char(tmp) + String.fromCharCode(buf[i])
+      tmp = ''
+    } else {
+      tmp += '%' + buf[i].toString(16)
+    }
+  }
+
+  return res + decodeUtf8Char(tmp)
+}
+
+function _asciiSlice (buf, start, end) {
+  var ret = ''
+  end = Math.min(buf.length, end)
+
+  for (var i = start; i < end; i++)
+    ret += String.fromCharCode(buf[i])
+  return ret
+}
+
+function _binarySlice (buf, start, end) {
+  return _asciiSlice(buf, start, end)
+}
+
+function _hexSlice (buf, start, end) {
+  var len = buf.length
+
+  if (!start || start < 0) start = 0
+  if (!end || end < 0 || end > len) end = len
+
+  var out = ''
+  for (var i = start; i < end; i++) {
+    out += toHex(buf[i])
+  }
+  return out
+}
+
+function _utf16leSlice (buf, start, end) {
+  var bytes = buf.slice(start, end)
+  var res = ''
+  for (var i = 0; i < bytes.length; i += 2) {
+    res += String.fromCharCode(bytes[i] + bytes[i+1] * 256)
+  }
+  return res
+}
+
+Buffer.prototype.slice = function (start, end) {
+  var len = this.length
+  start = clamp(start, len, 0)
+  end = clamp(end, len, len)
+
+  if (Buffer._useTypedArrays) {
+    return augment(this.subarray(start, end))
+  } else {
+    var sliceLen = end - start
+    var newBuf = new Buffer(sliceLen, undefined, true)
+    for (var i = 0; i < sliceLen; i++) {
+      newBuf[i] = this[i + start]
+    }
+    return newBuf
+  }
+}
+
+// `get` will be removed in Node 0.13+
+Buffer.prototype.get = function (offset) {
+  console.log('.get() is deprecated. Access using array indexes instead.')
+  return this.readUInt8(offset)
+}
+
+// `set` will be removed in Node 0.13+
+Buffer.prototype.set = function (v, offset) {
+  console.log('.set() is deprecated. Access using array indexes instead.')
+  return this.writeUInt8(v, offset)
+}
+
+Buffer.prototype.readUInt8 = function (offset, noAssert) {
+  if (!noAssert) {
+    assert(offset !== undefined && offset !== null, 'missing offset')
+    assert(offset < this.length, 'Trying to read beyond buffer length')
+  }
+
+  if (offset >= this.length)
+    return
+
+  return this[offset]
+}
+
+function _readUInt16 (buf, offset, littleEndian, noAssert) {
+  if (!noAssert) {
+    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')
+    assert(offset !== undefined && offset !== null, 'missing offset')
+    assert(offset + 1 < buf.length, 'Trying to read beyond buffer length')
+  }
+
+  var len = buf.length
+  if (offset >= len)
+    return
+
+  var val
+  if (littleEndian) {
+    val = buf[offset]
+    if (offset + 1 < len)
+      val |= buf[offset + 1] << 8
+  } else {
+    val = buf[offset] << 8
+    if (offset + 1 < len)
+      val |= buf[offset + 1]
+  }
+  return val
+}
+
+Buffer.prototype.readUInt16LE = function (offset, noAssert) {
+  return _readUInt16(this, offset, true, noAssert)
+}
+
+Buffer.prototype.readUInt16BE = function (offset, noAssert) {
+  return _readUInt16(this, offset, false, noAssert)
+}
+
+function _readUInt32 (buf, offset, littleEndian, noAssert) {
+  if (!noAssert) {
+    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')
+    assert(offset !== undefined && offset !== null, 'missing offset')
+    assert(offset + 3 < buf.length, 'Trying to read beyond buffer length')
+  }
+
+  var len = buf.length
+  if (offset >= len)
+    return
+
+  var val
+  if (littleEndian) {
+    if (offset + 2 < len)
+      val = buf[offset + 2] << 16
+    if (offset + 1 < len)
+      val |= buf[offset + 1] << 8
+    val |= buf[offset]
+    if (offset + 3 < len)
+      val = val + (buf[offset + 3] << 24 >>> 0)
+  } else {
+    if (offset + 1 < len)
+      val = buf[offset + 1] << 16
+    if (offset + 2 < len)
+      val |= buf[offset + 2] << 8
+    if (offset + 3 < len)
+      val |= buf[offset + 3]
+    val = val + (buf[offset] << 24 >>> 0)
+  }
+  return val
+}
+
+Buffer.prototype.readUInt32LE = function (offset, noAssert) {
+  return _readUInt32(this, offset, true, noAssert)
+}
+
+Buffer.prototype.readUInt32BE = function (offset, noAssert) {
+  return _readUInt32(this, offset, false, noAssert)
+}
+
+Buffer.prototype.readInt8 = function (offset, noAssert) {
+  if (!noAssert) {
+    assert(offset !== undefined && offset !== null,
+        'missing offset')
+    assert(offset < this.length, 'Trying to read beyond buffer length')
+  }
+
+  if (offset >= this.length)
+    return
+
+  var neg = this[offset] & 0x80
+  if (neg)
+    return (0xff - this[offset] + 1) * -1
+  else
+    return this[offset]
+}
+
+function _readInt16 (buf, offset, littleEndian, noAssert) {
+  if (!noAssert) {
+    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')
+    assert(offset !== undefined && offset !== null, 'missing offset')
+    assert(offset + 1 < buf.length, 'Trying to read beyond buffer length')
+  }
+
+  var len = buf.length
+  if (offset >= len)
+    return
+
+  var val = _readUInt16(buf, offset, littleEndian, true)
+  var neg = val & 0x8000
+  if (neg)
+    return (0xffff - val + 1) * -1
+  else
+    return val
+}
+
+Buffer.prototype.readInt16LE = function (offset, noAssert) {
+  return _readInt16(this, offset, true, noAssert)
+}
+
+Buffer.prototype.readInt16BE = function (offset, noAssert) {
+  return _readInt16(this, offset, false, noAssert)
+}
+
+function _readInt32 (buf, offset, littleEndian, noAssert) {
+  if (!noAssert) {
+    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')
+    assert(offset !== undefined && offset !== null, 'missing offset')
+    assert(offset + 3 < buf.length, 'Trying to read beyond buffer length')
+  }
+
+  var len = buf.length
+  if (offset >= len)
+    return
+
+  var val = _readUInt32(buf, offset, littleEndian, true)
+  var neg = val & 0x80000000
+  if (neg)
+    return (0xffffffff - val + 1) * -1
+  else
+    return val
+}
+
+Buffer.prototype.readInt32LE = function (offset, noAssert) {
+  return _readInt32(this, offset, true, noAssert)
+}
+
+Buffer.prototype.readInt32BE = function (offset, noAssert) {
+  return _readInt32(this, offset, false, noAssert)
+}
+
+function _readFloat (buf, offset, littleEndian, noAssert) {
+  if (!noAssert) {
+    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')
+    assert(offset + 3 < buf.length, 'Trying to read beyond buffer length')
+  }
+
+  return ieee754.read(buf, offset, littleEndian, 23, 4)
+}
+
+Buffer.prototype.readFloatLE = function (offset, noAssert) {
+  return _readFloat(this, offset, true, noAssert)
+}
+
+Buffer.prototype.readFloatBE = function (offset, noAssert) {
+  return _readFloat(this, offset, false, noAssert)
+}
+
+function _readDouble (buf, offset, littleEndian, noAssert) {
+  if (!noAssert) {
+    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')
+    assert(offset + 7 < buf.length, 'Trying to read beyond buffer length')
+  }
+
+  return ieee754.read(buf, offset, littleEndian, 52, 8)
+}
+
+Buffer.prototype.readDoubleLE = function (offset, noAssert) {
+  return _readDouble(this, offset, true, noAssert)
+}
+
+Buffer.prototype.readDoubleBE = function (offset, noAssert) {
+  return _readDouble(this, offset, false, noAssert)
+}
+
+Buffer.prototype.writeUInt8 = function (value, offset, noAssert) {
+  if (!noAssert) {
+    assert(value !== undefined && value !== null, 'missing value')
+    assert(offset !== undefined && offset !== null, 'missing offset')
+    assert(offset < this.length, 'trying to write beyond buffer length')
+    verifuint(value, 0xff)
+  }
+
+  if (offset >= this.length) return
+
+  this[offset] = value
+}
+
+function _writeUInt16 (buf, value, offset, littleEndian, noAssert) {
+  if (!noAssert) {
+    assert(value !== undefined && value !== null, 'missing value')
+    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')
+    assert(offset !== undefined && offset !== null, 'missing offset')
+    assert(offset + 1 < buf.length, 'trying to write beyond buffer length')
+    verifuint(value, 0xffff)
+  }
+
+  var len = buf.length
+  if (offset >= len)
+    return
+
+  for (var i = 0, j = Math.min(len - offset, 2); i < j; i++) {
+    buf[offset + i] =
+        (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>
+            (littleEndian ? i : 1 - i) * 8
+  }
+}
+
+Buffer.prototype.writeUInt16LE = function (value, offset, noAssert) {
+  _writeUInt16(this, value, offset, true, noAssert)
+}
+
+Buffer.prototype.writeUInt16BE = function (value, offset, noAssert) {
+  _writeUInt16(this, value, offset, false, noAssert)
+}
+
+function _writeUInt32 (buf, value, offset, littleEndian, noAssert) {
+  if (!noAssert) {
+    assert(value !== undefined && value !== null, 'missing value')
+    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')
+    assert(offset !== undefined && offset !== null, 'missing offset')
+    assert(offset + 3 < buf.length, 'trying to write beyond buffer length')
+    verifuint(value, 0xffffffff)
+  }
+
+  var len = buf.length
+  if (offset >= len)
+    return
+
+  for (var i = 0, j = Math.min(len - offset, 4); i < j; i++) {
+    buf[offset + i] =
+        (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff
+  }
+}
+
+Buffer.prototype.writeUInt32LE = function (value, offset, noAssert) {
+  _writeUInt32(this, value, offset, true, noAssert)
+}
+
+Buffer.prototype.writeUInt32BE = function (value, offset, noAssert) {
+  _writeUInt32(this, value, offset, false, noAssert)
+}
+
+Buffer.prototype.writeInt8 = function (value, offset, noAssert) {
+  if (!noAssert) {
+    assert(value !== undefined && value !== null, 'missing value')
+    assert(offset !== undefined && offset !== null, 'missing offset')
+    assert(offset < this.length, 'Trying to write beyond buffer length')
+    verifsint(value, 0x7f, -0x80)
+  }
+
+  if (offset >= this.length)
+    return
+
+  if (value >= 0)
+    this.writeUInt8(value, offset, noAssert)
+  else
+    this.writeUInt8(0xff + value + 1, offset, noAssert)
+}
+
+function _writeInt16 (buf, value, offset, littleEndian, noAssert) {
+  if (!noAssert) {
+    assert(value !== undefined && value !== null, 'missing value')
+    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')
+    assert(offset !== undefined && offset !== null, 'missing offset')
+    assert(offset + 1 < buf.length, 'Trying to write beyond buffer length')
+    verifsint(value, 0x7fff, -0x8000)
+  }
+
+  var len = buf.length
+  if (offset >= len)
+    return
+
+  if (value >= 0)
+    _writeUInt16(buf, value, offset, littleEndian, noAssert)
+  else
+    _writeUInt16(buf, 0xffff + value + 1, offset, littleEndian, noAssert)
+}
+
+Buffer.prototype.writeInt16LE = function (value, offset, noAssert) {
+  _writeInt16(this, value, offset, true, noAssert)
+}
+
+Buffer.prototype.writeInt16BE = function (value, offset, noAssert) {
+  _writeInt16(this, value, offset, false, noAssert)
+}
+
+function _writeInt32 (buf, value, offset, littleEndian, noAssert) {
+  if (!noAssert) {
+    assert(value !== undefined && value !== null, 'missing value')
+    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')
+    assert(offset !== undefined && offset !== null, 'missing offset')
+    assert(offset + 3 < buf.length, 'Trying to write beyond buffer length')
+    verifsint(value, 0x7fffffff, -0x80000000)
+  }
+
+  var len = buf.length
+  if (offset >= len)
+    return
+
+  if (value >= 0)
+    _writeUInt32(buf, value, offset, littleEndian, noAssert)
+  else
+    _writeUInt32(buf, 0xffffffff + value + 1, offset, littleEndian, noAssert)
+}
+
+Buffer.prototype.writeInt32LE = function (value, offset, noAssert) {
+  _writeInt32(this, value, offset, true, noAssert)
+}
+
+Buffer.prototype.writeInt32BE = function (value, offset, noAssert) {
+  _writeInt32(this, value, offset, false, noAssert)
+}
+
+function _writeFloat (buf, value, offset, littleEndian, noAssert) {
+  if (!noAssert) {
+    assert(value !== undefined && value !== null, 'missing value')
+    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')
+    assert(offset !== undefined && offset !== null, 'missing offset')
+    assert(offset + 3 < buf.length, 'Trying to write beyond buffer length')
+    verifIEEE754(value, 3.4028234663852886e+38, -3.4028234663852886e+38)
+  }
+
+  var len = buf.length
+  if (offset >= len)
+    return
+
+  ieee754.write(buf, value, offset, littleEndian, 23, 4)
+}
+
+Buffer.prototype.writeFloatLE = function (value, offset, noAssert) {
+  _writeFloat(this, value, offset, true, noAssert)
+}
+
+Buffer.prototype.writeFloatBE = function (value, offset, noAssert) {
+  _writeFloat(this, value, offset, false, noAssert)
+}
+
+function _writeDouble (buf, value, offset, littleEndian, noAssert) {
+  if (!noAssert) {
+    assert(value !== undefined && value !== null, 'missing value')
+    assert(typeof littleEndian === 'boolean', 'missing or invalid endian')
+    assert(offset !== undefined && offset !== null, 'missing offset')
+    assert(offset + 7 < buf.length,
+        'Trying to write beyond buffer length')
+    verifIEEE754(value, 1.7976931348623157E+308, -1.7976931348623157E+308)
+  }
+
+  var len = buf.length
+  if (offset >= len)
+    return
+
+  ieee754.write(buf, value, offset, littleEndian, 52, 8)
+}
+
+Buffer.prototype.writeDoubleLE = function (value, offset, noAssert) {
+  _writeDouble(this, value, offset, true, noAssert)
+}
+
+Buffer.prototype.writeDoubleBE = function (value, offset, noAssert) {
+  _writeDouble(this, value, offset, false, noAssert)
+}
+
+// fill(value, start=0, end=buffer.length)
+Buffer.prototype.fill = function (value, start, end) {
+  if (!value) value = 0
+  if (!start) start = 0
+  if (!end) end = this.length
+
+  if (typeof value === 'string') {
+    value = value.charCodeAt(0)
+  }
+
+  assert(typeof value === 'number' && !isNaN(value), 'value is not a number')
+  assert(end >= start, 'end < start')
+
+  // Fill 0 bytes; we're done
+  if (end === start) return
+  if (this.length === 0) return
+
+  assert(start >= 0 && start < this.length, 'start out of bounds')
+  assert(end >= 0 && end <= this.length, 'end out of bounds')
+
+  for (var i = start; i < end; i++) {
+    this[i] = value
+  }
+}
+
+Buffer.prototype.inspect = function () {
+  var out = []
+  var len = this.length
+  for (var i = 0; i < len; i++) {
+    out[i] = toHex(this[i])
+    if (i === exports.INSPECT_MAX_BYTES) {
+      out[i + 1] = '...'
+      break
+    }
+  }
+  return '<Buffer ' + out.join(' ') + '>'
+}
+
+/**
+ * Creates a new `ArrayBuffer` with the *copied* memory of the buffer instance.
+ * Added in Node 0.12. Only available in browsers that support ArrayBuffer.
+ */
+Buffer.prototype.toArrayBuffer = function () {
+  if (typeof Uint8Array === 'function') {
+    if (Buffer._useTypedArrays) {
+      return (new Buffer(this)).buffer
+    } else {
+      var buf = new Uint8Array(this.length)
+      for (var i = 0, len = buf.length; i < len; i += 1)
+        buf[i] = this[i]
+      return buf.buffer
+    }
+  } else {
+    throw new Error('Buffer.toArrayBuffer not supported in this browser')
+  }
+}
+
+// HELPER FUNCTIONS
+// ================
+
+function stringtrim (str) {
+  if (str.trim) return str.trim()
+  return str.replace(/^\s+|\s+$/g, '')
+}
+
+var BP = Buffer.prototype
+
+/**
+ * Augment the Uint8Array *instance* (not the class!) with Buffer methods
+ */
+function augment (arr) {
+  arr._isBuffer = true
+
+  // save reference to original Uint8Array get/set methods before overwriting
+  arr._get = arr.get
+  arr._set = arr.set
+
+  // deprecated, will be removed in node 0.13+
+  arr.get = BP.get
+  arr.set = BP.set
+
+  arr.write = BP.write
+  arr.toString = BP.toString
+  arr.toLocaleString = BP.toString
+  arr.toJSON = BP.toJSON
+  arr.copy = BP.copy
+  arr.slice = BP.slice
+  arr.readUInt8 = BP.readUInt8
+  arr.readUInt16LE = BP.readUInt16LE
+  arr.readUInt16BE = BP.readUInt16BE
+  arr.readUInt32LE = BP.readUInt32LE
+  arr.readUInt32BE = BP.readUInt32BE
+  arr.readInt8 = BP.readInt8
+  arr.readInt16LE = BP.readInt16LE
+  arr.readInt16BE = BP.readInt16BE
+  arr.readInt32LE = BP.readInt32LE
+  arr.readInt32BE = BP.readInt32BE
+  arr.readFloatLE = BP.readFloatLE
+  arr.readFloatBE = BP.readFloatBE
+  arr.readDoubleLE = BP.readDoubleLE
+  arr.readDoubleBE = BP.readDoubleBE
+  arr.writeUInt8 = BP.writeUInt8
+  arr.writeUInt16LE = BP.writeUInt16LE
+  arr.writeUInt16BE = BP.writeUInt16BE
+  arr.writeUInt32LE = BP.writeUInt32LE
+  arr.writeUInt32BE = BP.writeUInt32BE
+  arr.writeInt8 = BP.writeInt8
+  arr.writeInt16LE = BP.writeInt16LE
+  arr.writeInt16BE = BP.writeInt16BE
+  arr.writeInt32LE = BP.writeInt32LE
+  arr.writeInt32BE = BP.writeInt32BE
+  arr.writeFloatLE = BP.writeFloatLE
+  arr.writeFloatBE = BP.writeFloatBE
+  arr.writeDoubleLE = BP.writeDoubleLE
+  arr.writeDoubleBE = BP.writeDoubleBE
+  arr.fill = BP.fill
+  arr.inspect = BP.inspect
+  arr.toArrayBuffer = BP.toArrayBuffer
+
+  return arr
+}
+
+// slice(start, end)
+function clamp (index, len, defaultValue) {
+  if (typeof index !== 'number') return defaultValue
+  index = ~~index;  // Coerce to integer.
+  if (index >= len) return len
+  if (index >= 0) return index
+  index += len
+  if (index >= 0) return index
+  return 0
+}
+
+function coerce (length) {
+  // Coerce length to a number (possibly NaN), round up
+  // in case it's fractional (e.g. 123.456) then do a
+  // double negate to coerce a NaN to 0. Easy, right?
+  length = ~~Math.ceil(+length)
+  return length < 0 ? 0 : length
+}
+
+function isArray (subject) {
+  return (Array.isArray || function (subject) {
+    return Object.prototype.toString.call(subject) === '[object Array]'
+  })(subject)
+}
+
+function isArrayish (subject) {
+  return isArray(subject) || Buffer.isBuffer(subject) ||
+      subject && typeof subject === 'object' &&
+      typeof subject.length === 'number'
+}
+
+function toHex (n) {
+  if (n < 16) return '0' + n.toString(16)
+  return n.toString(16)
+}
+
+function utf8ToBytes (str) {
+  var byteArray = []
+  for (var i = 0; i < str.length; i++) {
+    var b = str.charCodeAt(i)
+    if (b <= 0x7F)
+      byteArray.push(str.charCodeAt(i))
+    else {
+      var start = i
+      if (b >= 0xD800 && b <= 0xDFFF) i++
+      var h = encodeURIComponent(str.slice(start, i+1)).substr(1).split('%')
+      for (var j = 0; j < h.length; j++)
+        byteArray.push(parseInt(h[j], 16))
+    }
+  }
+  return byteArray
+}
+
+function asciiToBytes (str) {
+  var byteArray = []
+  for (var i = 0; i < str.length; i++) {
+    // Node's code seems to be doing this and not & 0x7F..
+    byteArray.push(str.charCodeAt(i) & 0xFF)
+  }
+  return byteArray
+}
+
+function utf16leToBytes (str) {
+  var c, hi, lo
+  var byteArray = []
+  for (var i = 0; i < str.length; i++) {
+    c = str.charCodeAt(i)
+    hi = c >> 8
+    lo = c % 256
+    byteArray.push(lo)
+    byteArray.push(hi)
+  }
+
+  return byteArray
+}
+
+function base64ToBytes (str) {
+  return base64.toByteArray(str)
+}
+
+function blitBuffer (src, dst, offset, length) {
+  var pos
+  for (var i = 0; i < length; i++) {
+    if ((i + offset >= dst.length) || (i >= src.length))
+      break
+    dst[i + offset] = src[i]
+  }
+  return i
+}
+
+function decodeUtf8Char (str) {
+  try {
+    return decodeURIComponent(str)
+  } catch (err) {
+    return String.fromCharCode(0xFFFD) // UTF 8 invalid char
+  }
+}
+
+/*
+ * We have to make sure that the value is a valid integer. This means that it
+ * is non-negative. It has no fractional component and that it does not
+ * exceed the maximum allowed value.
+ */
+function verifuint (value, max) {
+  assert(typeof value === 'number', 'cannot write a non-number as a number')
+  assert(value >= 0, 'specified a negative value for writing an unsigned value')
+  assert(value <= max, 'value is larger than maximum value for type')
+  assert(Math.floor(value) === value, 'value has a fractional component')
+}
+
+function verifsint (value, max, min) {
+  assert(typeof value === 'number', 'cannot write a non-number as a number')
+  assert(value <= max, 'value larger than maximum allowed value')
+  assert(value >= min, 'value smaller than minimum allowed value')
+  assert(Math.floor(value) === value, 'value has a fractional component')
+}
+
+function verifIEEE754 (value, max, min) {
+  assert(typeof value === 'number', 'cannot write a non-number as a number')
+  assert(value <= max, 'value larger than maximum allowed value')
+  assert(value >= min, 'value smaller than minimum allowed value')
+}
+
+function assert (test, message) {
+  if (!test) throw new Error(message || 'Failed assertion')
+}
+
+},{"base64-js":2,"ieee754":3}],2:[function(_dereq_,module,exports){
+var lookup = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';
+
+;(function (exports) {
+	'use strict';
+
+  var Arr = (typeof Uint8Array !== 'undefined')
+    ? Uint8Array
+    : Array
+
+	var ZERO   = '0'.charCodeAt(0)
+	var PLUS   = '+'.charCodeAt(0)
+	var SLASH  = '/'.charCodeAt(0)
+	var NUMBER = '0'.charCodeAt(0)
+	var LOWER  = 'a'.charCodeAt(0)
+	var UPPER  = 'A'.charCodeAt(0)
+
+	function decode (elt) {
+		var code = elt.charCodeAt(0)
+		if (code === PLUS)
+			return 62 // '+'
+		if (code === SLASH)
+			return 63 // '/'
+		if (code < NUMBER)
+			return -1 //no match
+		if (code < NUMBER + 10)
+			return code - NUMBER + 26 + 26
+		if (code < UPPER + 26)
+			return code - UPPER
+		if (code < LOWER + 26)
+			return code - LOWER + 26
+	}
+
+	function b64ToByteArray (b64) {
+		var i, j, l, tmp, placeHolders, arr
+
+		if (b64.length % 4 > 0) {
+			throw new Error('Invalid string. Length must be a multiple of 4')
+		}
+
+		// the number of equal signs (place holders)
+		// if there are two placeholders, than the two characters before it
+		// represent one byte
+		// if there is only one, then the three characters before it represent 2 bytes
+		// this is just a cheap hack to not do indexOf twice
+		var len = b64.length
+		placeHolders = '=' === b64.charAt(len - 2) ? 2 : '=' === b64.charAt(len - 1) ? 1 : 0
+
+		// base64 is 4/3 + up to two characters of the original data
+		arr = new Arr(b64.length * 3 / 4 - placeHolders)
+
+		// if there are placeholders, only get up to the last complete 4 chars
+		l = placeHolders > 0 ? b64.length - 4 : b64.length
+
+		var L = 0
+
+		function push (v) {
+			arr[L++] = v
+		}
+
+		for (i = 0, j = 0; i < l; i += 4, j += 3) {
+			tmp = (decode(b64.charAt(i)) << 18) | (decode(b64.charAt(i + 1)) << 12) | (decode(b64.charAt(i + 2)) << 6) | decode(b64.charAt(i + 3))
+			push((tmp & 0xFF0000) >> 16)
+			push((tmp & 0xFF00) >> 8)
+			push(tmp & 0xFF)
+		}
+
+		if (placeHolders === 2) {
+			tmp = (decode(b64.charAt(i)) << 2) | (decode(b64.charAt(i + 1)) >> 4)
+			push(tmp & 0xFF)
+		} else if (placeHolders === 1) {
+			tmp = (decode(b64.charAt(i)) << 10) | (decode(b64.charAt(i + 1)) << 4) | (decode(b64.charAt(i + 2)) >> 2)
+			push((tmp >> 8) & 0xFF)
+			push(tmp & 0xFF)
+		}
+
+		return arr
+	}
+
+	function uint8ToBase64 (uint8) {
+		var i,
+			extraBytes = uint8.length % 3, // if we have 1 byte left, pad 2 bytes
+			output = "",
+			temp, length
+
+		function encode (num) {
+			return lookup.charAt(num)
+		}
+
+		function tripletToBase64 (num) {
+			return encode(num >> 18 & 0x3F) + encode(num >> 12 & 0x3F) + encode(num >> 6 & 0x3F) + encode(num & 0x3F)
+		}
+
+		// go through the array every three bytes, we'll deal with trailing stuff later
+		for (i = 0, length = uint8.length - extraBytes; i < length; i += 3) {
+			temp = (uint8[i] << 16) + (uint8[i + 1] << 8) + (uint8[i + 2])
+			output += tripletToBase64(temp)
+		}
+
+		// pad the end with zeros, but make sure to not forget the extra bytes
+		switch (extraBytes) {
+			case 1:
+				temp = uint8[uint8.length - 1]
+				output += encode(temp >> 2)
+				output += encode((temp << 4) & 0x3F)
+				output += '=='
+				break
+			case 2:
+				temp = (uint8[uint8.length - 2] << 8) + (uint8[uint8.length - 1])
+				output += encode(temp >> 10)
+				output += encode((temp >> 4) & 0x3F)
+				output += encode((temp << 2) & 0x3F)
+				output += '='
+				break
+		}
+
+		return output
+	}
+
+	module.exports.toByteArray = b64ToByteArray
+	module.exports.fromByteArray = uint8ToBase64
+}())
+
+},{}],3:[function(_dereq_,module,exports){
+exports.read = function(buffer, offset, isLE, mLen, nBytes) {
+  var e, m,
+      eLen = nBytes * 8 - mLen - 1,
+      eMax = (1 << eLen) - 1,
+      eBias = eMax >> 1,
+      nBits = -7,
+      i = isLE ? (nBytes - 1) : 0,
+      d = isLE ? -1 : 1,
+      s = buffer[offset + i];
+
+  i += d;
+
+  e = s & ((1 << (-nBits)) - 1);
+  s >>= (-nBits);
+  nBits += eLen;
+  for (; nBits > 0; e = e * 256 + buffer[offset + i], i += d, nBits -= 8);
+
+  m = e & ((1 << (-nBits)) - 1);
+  e >>= (-nBits);
+  nBits += mLen;
+  for (; nBits > 0; m = m * 256 + buffer[offset + i], i += d, nBits -= 8);
+
+  if (e === 0) {
+    e = 1 - eBias;
+  } else if (e === eMax) {
+    return m ? NaN : ((s ? -1 : 1) * Infinity);
+  } else {
+    m = m + Math.pow(2, mLen);
+    e = e - eBias;
+  }
+  return (s ? -1 : 1) * m * Math.pow(2, e - mLen);
+};
+
+exports.write = function(buffer, value, offset, isLE, mLen, nBytes) {
+  var e, m, c,
+      eLen = nBytes * 8 - mLen - 1,
+      eMax = (1 << eLen) - 1,
+      eBias = eMax >> 1,
+      rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0),
+      i = isLE ? 0 : (nBytes - 1),
+      d = isLE ? 1 : -1,
+      s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0;
+
+  value = Math.abs(value);
+
+  if (isNaN(value) || value === Infinity) {
+    m = isNaN(value) ? 1 : 0;
+    e = eMax;
+  } else {
+    e = Math.floor(Math.log(value) / Math.LN2);
+    if (value * (c = Math.pow(2, -e)) < 1) {
+      e--;
+      c *= 2;
+    }
+    if (e + eBias >= 1) {
+      value += rt / c;
+    } else {
+      value += rt * Math.pow(2, 1 - eBias);
+    }
+    if (value * c >= 2) {
+      e++;
+      c /= 2;
+    }
+
+    if (e + eBias >= eMax) {
+      m = 0;
+      e = eMax;
+    } else if (e + eBias >= 1) {
+      m = (value * c - 1) * Math.pow(2, mLen);
+      e = e + eBias;
+    } else {
+      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen);
+      e = 0;
+    }
+  }
+
+  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8);
+
+  e = (e << mLen) | m;
+  eLen += mLen;
+  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8);
+
+  buffer[offset + i - d] |= s * 128;
+};
+
+},{}],4:[function(_dereq_,module,exports){
+// shim for using process in browser
+
+var process = module.exports = {};
+
+process.nextTick = (function () {
+    var canSetImmediate = typeof window !== 'undefined'
+    && window.setImmediate;
+    var canPost = typeof window !== 'undefined'
+    && window.postMessage && window.addEventListener
+    ;
+
+    if (canSetImmediate) {
+        return function (f) { return window.setImmediate(f) };
+    }
+
+    if (canPost) {
+        var queue = [];
+        window.addEventListener('message', function (ev) {
+            var source = ev.source;
+            if ((source === window || source === null) && ev.data === 'process-tick') {
+                ev.stopPropagation();
+                if (queue.length > 0) {
+                    var fn = queue.shift();
+                    fn();
+                }
+            }
+        }, true);
+
+        return function nextTick(fn) {
+            queue.push(fn);
+            window.postMessage('process-tick', '*');
+        };
+    }
+
+    return function nextTick(fn) {
+        setTimeout(fn, 0);
+    };
+})();
+
+process.title = 'browser';
+process.browser = true;
+process.env = {};
+process.argv = [];
+
+process.binding = function (name) {
+    throw new Error('process.binding is not supported');
+}
+
+// TODO(shtylman)
+process.cwd = function () { return '/' };
+process.chdir = function (dir) {
+    throw new Error('process.chdir is not supported');
+};
+
+},{}],5:[function(_dereq_,module,exports){
+(function (process){
+// Copyright Joyent, Inc. and other Node contributors.
+//
+// Permission is hereby granted, free of charge, to any person obtaining a
+// copy of this software and associated documentation files (the
+// "Software"), to deal in the Software without restriction, including
+// without limitation the rights to use, copy, modify, merge, publish,
+// distribute, sublicense, and/or sell copies of the Software, and to permit
+// persons to whom the Software is furnished to do so, subject to the
+// following conditions:
+//
+// The above copyright notice and this permission notice shall be included
+// in all copies or substantial portions of the Software.
+//
+// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
+// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
+// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
+// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
+// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
+// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
+// USE OR OTHER DEALINGS IN THE SOFTWARE.
+
+// resolves . and .. elements in a path array with directory names there
+// must be no slashes, empty elements, or device names (c:\) in the array
+// (so also no leading and trailing slashes - it does not distinguish
+// relative and absolute paths)
+function normalizeArray(parts, allowAboveRoot) {
+  // if the path tries to go above the root, `up` ends up > 0
+  var up = 0;
+  for (var i = parts.length - 1; i >= 0; i--) {
+    var last = parts[i];
+    if (last === '.') {
+      parts.splice(i, 1);
+    } else if (last === '..') {
+      parts.splice(i, 1);
+      up++;
+    } else if (up) {
+      parts.splice(i, 1);
+      up--;
+    }
+  }
+
+  // if the path is allowed to go above the root, restore leading ..s
+  if (allowAboveRoot) {
+    for (; up--; up) {
+      parts.unshift('..');
+    }
+  }
+
+  return parts;
+}
+
+// Split a filename into [root, dir, basename, ext], unix version
+// 'root' is just a slash, or nothing.
+var splitPathRe =
+    /^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;
+var splitPath = function(filename) {
+  return splitPathRe.exec(filename).slice(1);
+};
+
+// path.resolve([from ...], to)
+// posix version
+exports.resolve = function() {
+  var resolvedPath = '',
+      resolvedAbsolute = false;
+
+  for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {
+    var path = (i >= 0) ? arguments[i] : process.cwd();
+
+    // Skip empty and invalid entries
+    if (typeof path !== 'string') {
+      throw new TypeError('Arguments to path.resolve must be strings');
+    } else if (!path) {
+      continue;
+    }
+
+    resolvedPath = path + '/' + resolvedPath;
+    resolvedAbsolute = path.charAt(0) === '/';
+  }
+
+  // At this point the path should be resolved to a full absolute path, but
+  // handle relative paths to be safe (might happen when process.cwd() fails)
+
+  // Normalize the path
+  resolvedPath = normalizeArray(filter(resolvedPath.split('/'), function(p) {
+    return !!p;
+  }), !resolvedAbsolute).join('/');
+
+  return ((resolvedAbsolute ? '/' : '') + resolvedPath) || '.';
+};
+
+// path.normalize(path)
+// posix version
+exports.normalize = function(path) {
+  var isAbsolute = exports.isAbsolute(path),
+      trailingSlash = substr(path, -1) === '/';
+
+  // Normalize the path
+  path = normalizeArray(filter(path.split('/'), function(p) {
+    return !!p;
+  }), !isAbsolute).join('/');
+
+  if (!path && !isAbsolute) {
+    path = '.';
+  }
+  if (path && trailingSlash) {
+    path += '/';
+  }
+
+  return (isAbsolute ? '/' : '') + path;
+};
+
+// posix version
+exports.isAbsolute = function(path) {
+  return path.charAt(0) === '/';
+};
+
+// posix version
+exports.join = function() {
+  var paths = Array.prototype.slice.call(arguments, 0);
+  return exports.normalize(filter(paths, function(p, index) {
+    if (typeof p !== 'string') {
+      throw new TypeError('Arguments to path.join must be strings');
+    }
+    return p;
+  }).join('/'));
+};
+
+
+// path.relative(from, to)
+// posix version
+exports.relative = function(from, to) {
+  from = exports.resolve(from).substr(1);
+  to = exports.resolve(to).substr(1);
+
+  function trim(arr) {
+    var start = 0;
+    for (; start < arr.length; start++) {
+      if (arr[start] !== '') break;
+    }
+
+    var end = arr.length - 1;
+    for (; end >= 0; end--) {
+      if (arr[end] !== '') break;
+    }
+
+    if (start > end) return [];
+    return arr.slice(start, end - start + 1);
+  }
+
+  var fromParts = trim(from.split('/'));
+  var toParts = trim(to.split('/'));
+
+  var length = Math.min(fromParts.length, toParts.length);
+  var samePartsLength = length;
+  for (var i = 0; i < length; i++) {
+    if (fromParts[i] !== toParts[i]) {
+      samePartsLength = i;
+      break;
+    }
+  }
+
+  var outputParts = [];
+  for (var i = samePartsLength; i < fromParts.length; i++) {
+    outputParts.push('..');
+  }
+
+  outputParts = outputParts.concat(toParts.slice(samePartsLength));
+
+  return outputParts.join('/');
+};
+
+exports.sep = '/';
+exports.delimiter = ':';
+
+exports.dirname = function(path) {
+  var result = splitPath(path),
+      root = result[0],
+      dir = result[1];
+
+  if (!root && !dir) {
+    // No dirname whatsoever
+    return '.';
+  }
+
+  if (dir) {
+    // It has a dirname, strip trailing slash
+    dir = dir.substr(0, dir.length - 1);
+  }
+
+  return root + dir;
+};
+
+
+exports.basename = function(path, ext) {
+  var f = splitPath(path)[2];
+  // TODO: make this comparison case-insensitive on windows?
+  if (ext && f.substr(-1 * ext.length) === ext) {
+    f = f.substr(0, f.length - ext.length);
+  }
+  return f;
+};
+
+
+exports.extname = function(path) {
+  return splitPath(path)[3];
+};
+
+function filter (xs, f) {
+    if (xs.filter) return xs.filter(f);
+    var res = [];
+    for (var i = 0; i < xs.length; i++) {
+        if (f(xs[i], i, xs)) res.push(xs[i]);
+    }
+    return res;
+}
+
+// String.prototype.substr - negative index don't work in IE8
+var substr = 'ab'.substr(-1) === 'b'
+    ? function (str, start, len) { return str.substr(start, len) }
+    : function (str, start, len) {
+        if (start < 0) start = str.length + start;
+        return str.substr(start, len);
+    }
+;
+
+}).call(this,_dereq_("/Users/poshannessy/FB/code/react/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"))
+},{"/Users/poshannessy/FB/code/react/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4}],6:[function(_dereq_,module,exports){
+/*
+  Copyright (C) 2013 Ariya Hidayat <ariya.hidayat@gmail.com>
+  Copyright (C) 2013 Thaddee Tyl <thaddee.tyl@gmail.com>
+  Copyright (C) 2012 Ariya Hidayat <ariya.hidayat@gmail.com>
+  Copyright (C) 2012 Mathias Bynens <mathias@qiwi.be>
+  Copyright (C) 2012 Joost-Wim Boekesteijn <joost-wim@boekesteijn.nl>
+  Copyright (C) 2012 Kris Kowal <kris.kowal@cixar.com>
+  Copyright (C) 2012 Yusuke Suzuki <utatane.tea@gmail.com>
+  Copyright (C) 2012 Arpad Borsos <arpad.borsos@googlemail.com>
+  Copyright (C) 2011 Ariya Hidayat <ariya.hidayat@gmail.com>
+
+  Redistribution and use in source and binary forms, with or without
+  modification, are permitted provided that the following conditions are met:
+
+    * Redistributions of source code must retain the above copyright
+      notice, this list of conditions and the following disclaimer.
+    * Redistributions in binary form must reproduce the above copyright
+      notice, this list of conditions and the following disclaimer in the
+      documentation and/or other materials provided with the distribution.
+
+  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+  ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> BE LIABLE FOR ANY
+  DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+  (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
+  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
+  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
+  THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+*/
+
+/*jslint bitwise:true plusplus:true */
+/*global esprima:true, define:true, exports:true, window: true,
+throwError: true, generateStatement: true, peek: true,
+parseAssignmentExpression: true, parseBlock: true,
+parseClassExpression: true, parseClassDeclaration: true, parseExpression: true,
+parseForStatement: true,
+parseFunctionDeclaration: true, parseFunctionExpression: true,
+parseFunctionSourceElements: true, parseVariableIdentifier: true,
+parseImportSpecifier: true,
+parseLeftHandSideExpression: true, parseParams: true, validateParam: true,
+parseSpreadOrAssignmentExpression: true,
+parseStatement: true, parseSourceElement: true, parseModuleBlock: true, parseConciseBody: true,
+advanceXJSChild: true, isXJSIdentifierStart: true, isXJSIdentifierPart: true,
+scanXJSStringLiteral: true, scanXJSIdentifier: true,
+parseXJSAttributeValue: true, parseXJSChild: true, parseXJSElement: true, parseXJSExpressionContainer: true, parseXJSEmptyExpression: true,
+parseTypeAnnotation: true, parseTypeAnnotatableIdentifier: true,
+parseYieldExpression: true
+*/
+
+(function (root, factory) {
+    'use strict';
+
+    // Universal Module Definition (UMD) to support AMD, CommonJS/Node.js,
+    // Rhino, and plain browser loading.
+    if (typeof define === 'function' && define.amd) {
+        define(['exports'], factory);
+    } else if (typeof exports !== 'undefined') {
+        factory(exports);
+    } else {
+        factory((root.esprima = {}));
+    }
+}(this, function (exports) {
+    'use strict';
+
+    var Token,
+        TokenName,
+        FnExprTokens,
+        Syntax,
+        PropertyKind,
+        Messages,
+        Regex,
+        SyntaxTreeDelegate,
+        XHTMLEntities,
+        ClassPropertyType,
+        source,
+        strict,
+        index,
+        lineNumber,
+        lineStart,
+        length,
+        delegate,
+        lookahead,
+        state,
+        extra;
+
+    Token = {
+        BooleanLiteral: 1,
+        EOF: 2,
+        Identifier: 3,
+        Keyword: 4,
+        NullLiteral: 5,
+        NumericLiteral: 6,
+        Punctuator: 7,
+        StringLiteral: 8,
+        RegularExpression: 9,
+        Template: 10,
+        XJSIdentifier: 11,
+        XJSText: 12
+    };
+
+    TokenName = {};
+    TokenName[Token.BooleanLiteral] = 'Boolean';
+    TokenName[Token.EOF] = '<end>';
+    TokenName[Token.Identifier] = 'Identifier';
+    TokenName[Token.Keyword] = 'Keyword';
+    TokenName[Token.NullLiteral] = 'Null';
+    TokenName[Token.NumericLiteral] = 'Numeric';
+    TokenName[Token.Punctuator] = 'Punctuator';
+    TokenName[Token.StringLiteral] = 'String';
+    TokenName[Token.XJSIdentifier] = 'XJSIdentifier';
+    TokenName[Token.XJSText] = 'XJSText';
+    TokenName[Token.RegularExpression] = 'RegularExpression';
+
+    // A function following one of those tokens is an expression.
+    FnExprTokens = ['(', '{', '[', 'in', 'typeof', 'instanceof', 'new',
+                    'return', 'case', 'delete', 'throw', 'void',
+                    // assignment operators
+                    '=', '+=', '-=', '*=', '/=', '%=', '<<=', '>>=', '>>>=',
+                    '&=', '|=', '^=', ',',
+                    // binary/unary operators
+                    '+', '-', '*', '/', '%', '++', '--', '<<', '>>', '>>>', '&',
+                    '|', '^', '!', '~', '&&', '||', '?', ':', '===', '==', '>=',
+                    '<=', '<', '>', '!=', '!=='];
+
+    Syntax = {
+        ArrayExpression: 'ArrayExpression',
+        ArrayPattern: 'ArrayPattern',
+        ArrowFunctionExpression: 'ArrowFunctionExpression',
+        AssignmentExpression: 'AssignmentExpression',
+        BinaryExpression: 'BinaryExpression',
+        BlockStatement: 'BlockStatement',
+        BreakStatement: 'BreakStatement',
+        CallExpression: 'CallExpression',
+        CatchClause: 'CatchClause',
+        ClassBody: 'ClassBody',
+        ClassDeclaration: 'ClassDeclaration',
+        ClassExpression: 'ClassExpression',
+        ClassHeritage: 'ClassHeritage',
+        ComprehensionBlock: 'ComprehensionBlock',
+        ComprehensionExpression: 'ComprehensionExpression',
+        ConditionalExpression: 'ConditionalExpression',
+        ContinueStatement: 'ContinueStatement',
+        DebuggerStatement: 'DebuggerStatement',
+        DoWhileStatement: 'DoWhileStatement',
+        EmptyStatement: 'EmptyStatement',
+        ExportDeclaration: 'ExportDeclaration',
+        ExportBatchSpecifier: 'ExportBatchSpecifier',
+        ExportSpecifier: 'ExportSpecifier',
+        ExpressionStatement: 'ExpressionStatement',
+        ForInStatement: 'ForInStatement',
+        ForOfStatement: 'ForOfStatement',
+        ForStatement: 'ForStatement',
+        FunctionDeclaration: 'FunctionDeclaration',
+        FunctionExpression: 'FunctionExpression',
+        Identifier: 'Identifier',
+        IfStatement: 'IfStatement',
+        ImportDeclaration: 'ImportDeclaration',
+        ImportSpecifier: 'ImportSpecifier',
+        LabeledStatement: 'LabeledStatement',
+        Literal: 'Literal',
+        LogicalExpression: 'LogicalExpression',
+        MemberExpression: 'MemberExpression',
+        MethodDefinition: 'MethodDefinition',
+        ModuleDeclaration: 'ModuleDeclaration',
+        NewExpression: 'NewExpression',
+        ObjectExpression: 'ObjectExpression',
+        ObjectPattern: 'ObjectPattern',
+        Program: 'Program',
+        Property: 'Property',
+        ReturnStatement: 'ReturnStatement',
+        SequenceExpression: 'SequenceExpression',
+        SpreadElement: 'SpreadElement',
+        SwitchCase: 'SwitchCase',
+        SwitchStatement: 'SwitchStatement',
+        TaggedTemplateExpression: 'TaggedTemplateExpression',
+        TemplateElement: 'TemplateElement',
+        TemplateLiteral: 'TemplateLiteral',
+        ThisExpression: 'ThisExpression',
+        ThrowStatement: 'ThrowStatement',
+        TryStatement: 'TryStatement',
+        TypeAnnotatedIdentifier: 'TypeAnnotatedIdentifier',
+        TypeAnnotation: 'TypeAnnotation',
+        UnaryExpression: 'UnaryExpression',
+        UpdateExpression: 'UpdateExpression',
+        VariableDeclaration: 'VariableDeclaration',
+        VariableDeclarator: 'VariableDeclarator',
+        WhileStatement: 'WhileStatement',
+        WithStatement: 'WithStatement',
+        XJSIdentifier: 'XJSIdentifier',
+        XJSEmptyExpression: 'XJSEmptyExpression',
+        XJSExpressionContainer: 'XJSExpressionContainer',
+        XJSElement: 'XJSElement',
+        XJSClosingElement: 'XJSClosingElement',
+        XJSOpeningElement: 'XJSOpeningElement',
+        XJSAttribute: 'XJSAttribute',
+        XJSText: 'XJSText',
+        YieldExpression: 'YieldExpression'
+    };
+
+    PropertyKind = {
+        Data: 1,
+        Get: 2,
+        Set: 4
+    };
+
+    ClassPropertyType = {
+        'static': 'static',
+        prototype: 'prototype'
+    };
+
+    // Error messages should be identical to V8.
+    Messages = {
+        UnexpectedToken:  'Unexpected token %0',
+        UnexpectedNumber:  'Unexpected number',
+        UnexpectedString:  'Unexpected string',
+        UnexpectedIdentifier:  'Unexpected identifier',
+        UnexpectedReserved:  'Unexpected reserved word',
+        UnexpectedTemplate:  'Unexpected quasi %0',
+        UnexpectedEOS:  'Unexpected end of input',
+        NewlineAfterThrow:  'Illegal newline after throw',
+        InvalidRegExp: 'Invalid regular expression',
+        UnterminatedRegExp:  'Invalid regular expression: missing /',
+        InvalidLHSInAssignment:  'Invalid left-hand side in assignment',
+        InvalidLHSInFormalsList:  'Invalid left-hand side in formals list',
+        InvalidLHSInForIn:  'Invalid left-hand side in for-in',
+        MultipleDefaultsInSwitch: 'More than one default clause in switch statement',
+        NoCatchOrFinally:  'Missing catch or finally after try',
+        UnknownLabel: 'Undefined label \'%0\'',
+        Redeclaration: '%0 \'%1\' has already been declared',
+        IllegalContinue: 'Illegal continue statement',
+        IllegalBreak: 'Illegal break statement',
+        IllegalDuplicateClassProperty: 'Illegal duplicate property in class definition',
+        IllegalReturn: 'Illegal return statement',
+        IllegalYield: 'Illegal yield expression',
+        IllegalSpread: 'Illegal spread element',
+        StrictModeWith:  'Strict mode code may not include a with statement',
+        StrictCatchVariable:  'Catch variable may not be eval or arguments in strict mode',
+        StrictVarName:  'Variable name may not be eval or arguments in strict mode',
+        StrictParamName:  'Parameter name eval or arguments is not allowed in strict mode',
+        StrictParamDupe: 'Strict mode function may not have duplicate parameter names',
+        ParameterAfterRestParameter: 'Rest parameter must be final parameter of an argument list',
+        DefaultRestParameter: 'Rest parameter can not have a default value',
+        ElementAfterSpreadElement: 'Spread must be the final element of an element list',
+        ObjectPatternAsRestParameter: 'Invalid rest parameter',
+        ObjectPatternAsSpread: 'Invalid spread argument',
+        StrictFunctionName:  'Function name may not be eval or arguments in strict mode',
+        StrictOctalLiteral:  'Octal literals are not allowed in strict mode.',
+        StrictDelete:  'Delete of an unqualified identifier in strict mode.',
+        StrictDuplicateProperty:  'Duplicate data property in object literal not allowed in strict mode',
+        AccessorDataProperty:  'Object literal may not have data and accessor property with the same name',
+        AccessorGetSet:  'Object literal may not have multiple get/set accessors with the same name',
+        StrictLHSAssignment:  'Assignment to eval or arguments is not allowed in strict mode',
+        StrictLHSPostfix:  'Postfix increment/decrement may not have eval or arguments operand in strict mode',
+        StrictLHSPrefix:  'Prefix increment/decrement may not have eval or arguments operand in strict mode',
+        StrictReservedWord:  'Use of future reserved word in strict mode',
+        NewlineAfterModule:  'Illegal newline after module',
+        NoFromAfterImport: 'Missing from after import',
+        InvalidModuleSpecifier: 'Invalid module specifier',
+        NestedModule: 'Module declaration can not be nested',
+        NoYieldInGenerator: 'Missing yield in generator',
+        NoUnintializedConst: 'Const must be initialized',
+        ComprehensionRequiresBlock: 'Comprehension must have at least one block',
+        ComprehensionError:  'Comprehension Error',
+        EachNotAllowed:  'Each is not supported',
+        InvalidXJSTagName: 'XJS tag name can not be empty',
+        InvalidXJSAttributeValue: 'XJS value should be either an expression or a quoted XJS text',
+        ExpectedXJSClosingTag: 'Expected corresponding XJS closing tag for %0'
+    };
+
+    // See also tools/generate-unicode-regex.py.
+    Regex = {
+        NonAsciiIdentifierStart: new RegExp('[\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0\u08a2-\u08ac\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f0\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191c\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua697\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua793\ua7a0-\ua7aa\ua7f8-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa80-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]'),
+        NonAsciiIdentifierPart: new RegExp('[\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0300-\u0374\u0376\u0377\u037a-\u037d\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u0483-\u0487\u048a-\u0527\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u05d0-\u05ea\u05f0-\u05f2\u0610-\u061a\u0620-\u0669\u066e-\u06d3\u06d5-\u06dc\u06df-\u06e8\u06ea-\u06fc\u06ff\u0710-\u074a\u074d-\u07b1\u07c0-\u07f5\u07fa\u0800-\u082d\u0840-\u085b\u08a0\u08a2-\u08ac\u08e4-\u08fe\u0900-\u0963\u0966-\u096f\u0971-\u0977\u0979-\u097f\u0981-\u0983\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bc-\u09c4\u09c7\u09c8\u09cb-\u09ce\u09d7\u09dc\u09dd\u09df-\u09e3\u09e6-\u09f1\u0a01-\u0a03\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a59-\u0a5c\u0a5e\u0a66-\u0a75\u0a81-\u0a83\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abc-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ad0\u0ae0-\u0ae3\u0ae6-\u0aef\u0b01-\u0b03\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3c-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b5c\u0b5d\u0b5f-\u0b63\u0b66-\u0b6f\u0b71\u0b82\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd0\u0bd7\u0be6-\u0bef\u0c01-\u0c03\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c58\u0c59\u0c60-\u0c63\u0c66-\u0c6f\u0c82\u0c83\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbc-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0cde\u0ce0-\u0ce3\u0ce6-\u0cef\u0cf1\u0cf2\u0d02\u0d03\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d-\u0d44\u0d46-\u0d48\u0d4a-\u0d4e\u0d57\u0d60-\u0d63\u0d66-\u0d6f\u0d7a-\u0d7f\u0d82\u0d83\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0df2\u0df3\u0e01-\u0e3a\u0e40-\u0e4e\u0e50-\u0e59\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb9\u0ebb-\u0ebd\u0ec0-\u0ec4\u0ec6\u0ec8-\u0ecd\u0ed0-\u0ed9\u0edc-\u0edf\u0f00\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f3e-\u0f47\u0f49-\u0f6c\u0f71-\u0f84\u0f86-\u0f97\u0f99-\u0fbc\u0fc6\u1000-\u1049\u1050-\u109d\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u135d-\u135f\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f0\u1700-\u170c\u170e-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176c\u176e-\u1770\u1772\u1773\u1780-\u17d3\u17d7\u17dc\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u1820-\u1877\u1880-\u18aa\u18b0-\u18f5\u1900-\u191c\u1920-\u192b\u1930-\u193b\u1946-\u196d\u1970-\u1974\u1980-\u19ab\u19b0-\u19c9\u19d0-\u19d9\u1a00-\u1a1b\u1a20-\u1a5e\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1aa7\u1b00-\u1b4b\u1b50-\u1b59\u1b6b-\u1b73\u1b80-\u1bf3\u1c00-\u1c37\u1c40-\u1c49\u1c4d-\u1c7d\u1cd0-\u1cd2\u1cd4-\u1cf6\u1d00-\u1de6\u1dfc-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u200c\u200d\u203f\u2040\u2054\u2071\u207f\u2090-\u209c\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d7f-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2de0-\u2dff\u2e2f\u3005-\u3007\u3021-\u302f\u3031-\u3035\u3038-\u303c\u3041-\u3096\u3099\u309a\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua62b\ua640-\ua66f\ua674-\ua67d\ua67f-\ua697\ua69f-\ua6f1\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua793\ua7a0-\ua7aa\ua7f8-\ua827\ua840-\ua873\ua880-\ua8c4\ua8d0-\ua8d9\ua8e0-\ua8f7\ua8fb\ua900-\ua92d\ua930-\ua953\ua960-\ua97c\ua980-\ua9c0\ua9cf-\ua9d9\uaa00-\uaa36\uaa40-\uaa4d\uaa50-\uaa59\uaa60-\uaa76\uaa7a\uaa7b\uaa80-\uaac2\uaadb-\uaadd\uaae0-\uaaef\uaaf2-\uaaf6\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uabc0-\uabea\uabec\uabed\uabf0-\uabf9\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe00-\ufe0f\ufe20-\ufe26\ufe33\ufe34\ufe4d-\ufe4f\ufe70-\ufe74\ufe76-\ufefc\uff10-\uff19\uff21-\uff3a\uff3f\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]')
+    };
+
+    // Ensure the condition is true, otherwise throw an error.
+    // This is only to have a better contract semantic, i.e. another safety net
+    // to catch a logic error. The condition shall be fulfilled in normal case.
+    // Do NOT use this to enforce a certain condition on any user input.
+
+    function assert(condition, message) {
+        if (!condition) {
+            throw new Error('ASSERT: ' + message);
+        }
+    }
+
+    function isDecimalDigit(ch) {
+        return (ch >= 48 && ch <= 57);   // 0..9
+    }
+
+    function isHexDigit(ch) {
+        return '0123456789abcdefABCDEF'.indexOf(ch) >= 0;
+    }
+
+    function isOctalDigit(ch) {
+        return '01234567'.indexOf(ch) >= 0;
+    }
+
+
+    // 7.2 White Space
+
+    function isWhiteSpace(ch) {
+        return (ch === 32) ||  // space
+            (ch === 9) ||      // tab
+            (ch === 0xB) ||
+            (ch === 0xC) ||
+            (ch === 0xA0) ||
+            (ch >= 0x1680 && '\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\uFEFF'.indexOf(String.fromCharCode(ch)) > 0);
+    }
+
+    // 7.3 Line Terminators
+
+    function isLineTerminator(ch) {
+        return (ch === 10) || (ch === 13) || (ch === 0x2028) || (ch === 0x2029);
+    }
+
+    // 7.6 Identifier Names and Identifiers
+
+    function isIdentifierStart(ch) {
+        return (ch === 36) || (ch === 95) ||  // $ (dollar) and _ (underscore)
+            (ch >= 65 && ch <= 90) ||         // A..Z
+            (ch >= 97 && ch <= 122) ||        // a..z
+            (ch === 92) ||                    // \ (backslash)
+            ((ch >= 0x80) && Regex.NonAsciiIdentifierStart.test(String.fromCharCode(ch)));
+    }
+
+    function isIdentifierPart(ch) {
+        return (ch === 36) || (ch === 95) ||  // $ (dollar) and _ (underscore)
+            (ch >= 65 && ch <= 90) ||         // A..Z
+            (ch >= 97 && ch <= 122) ||        // a..z
+            (ch >= 48 && ch <= 57) ||         // 0..9
+            (ch === 92) ||                    // \ (backslash)
+            ((ch >= 0x80) && Regex.NonAsciiIdentifierPart.test(String.fromCharCode(ch)));
+    }
+
+    // 7.6.1.2 Future Reserved Words
+
+    function isFutureReservedWord(id) {
+        switch (id) {
+        case 'class':
+        case 'enum':
+        case 'export':
+        case 'extends':
+        case 'import':
+        case 'super':
+            return true;
+        default:
+            return false;
+        }
+    }
+
+    function isStrictModeReservedWord(id) {
+        switch (id) {
+        case 'implements':
+        case 'interface':
+        case 'package':
+        case 'private':
+        case 'protected':
+        case 'public':
+        case 'static':
+        case 'yield':
+        case 'let':
+            return true;
+        default:
+            return false;
+        }
+    }
+
+    function isRestrictedWord(id) {
+        return id === 'eval' || id === 'arguments';
+    }
+
+    // 7.6.1.1 Keywords
+
+    function isKeyword(id) {
+        if (strict && isStrictModeReservedWord(id)) {
+            return true;
+        }
+
+        // 'const' is specialized as Keyword in V8.
+        // 'yield' and 'let' are for compatiblity with SpiderMonkey and ES.next.
+        // Some others are from future reserved words.
+
+        switch (id.length) {
+        case 2:
+            return (id === 'if') || (id === 'in') || (id === 'do');
+        case 3:
+            return (id === 'var') || (id === 'for') || (id === 'new') ||
+                (id === 'try') || (id === 'let');
+        case 4:
+            return (id === 'this') || (id === 'else') || (id === 'case') ||
+                (id === 'void') || (id === 'with') || (id === 'enum');
+        case 5:
+            return (id === 'while') || (id === 'break') || (id === 'catch') ||
+                (id === 'throw') || (id === 'const') || (id === 'yield') ||
+                (id === 'class') || (id === 'super');
+        case 6:
+            return (id === 'return') || (id === 'typeof') || (id === 'delete') ||
+                (id === 'switch') || (id === 'export') || (id === 'import');
+        case 7:
+            return (id === 'default') || (id === 'finally') || (id === 'extends');
+        case 8:
+            return (id === 'function') || (id === 'continue') || (id === 'debugger');
+        case 10:
+            return (id === 'instanceof');
+        default:
+            return false;
+        }
+    }
+
+    // 7.4 Comments
+
+    function skipComment() {
+        var ch, blockComment, lineComment;
+
+        blockComment = false;
+        lineComment = false;
+
+        while (index < length) {
+            ch = source.charCodeAt(index);
+
+            if (lineComment) {
+                ++index;
+                if (isLineTerminator(ch)) {
+                    lineComment = false;
+                    if (ch === 13 && source.charCodeAt(index) === 10) {
+                        ++index;
+                    }
+                    ++lineNumber;
+                    lineStart = index;
+                }
+            } else if (blockComment) {
+                if (isLineTerminator(ch)) {
+                    if (ch === 13 && source.charCodeAt(index + 1) === 10) {
+                        ++index;
+                    }
+                    ++lineNumber;
+                    ++index;
+                    lineStart = index;
+                    if (index >= length) {
+                        throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
+                    }
+                } else {
+                    ch = source.charCodeAt(index++);
+                    if (index >= length) {
+                        throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
+                    }
+                    // Block comment ends with '*/' (char #42, char #47).
+                    if (ch === 42) {
+                        ch = source.charCodeAt(index);
+                        if (ch === 47) {
+                            ++index;
+                            blockComment = false;
+                        }
+                    }
+                }
+            } else if (ch === 47) {
+                ch = source.charCodeAt(index + 1);
+                // Line comment starts with '//' (char #47, char #47).
+                if (ch === 47) {
+                    index += 2;
+                    lineComment = true;
+                } else if (ch === 42) {
+                    // Block comment starts with '/*' (char #47, char #42).
+                    index += 2;
+                    blockComment = true;
+                    if (index >= length) {
+                        throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
+                    }
+                } else {
+                    break;
+                }
+            } else if (isWhiteSpace(ch)) {
+                ++index;
+            } else if (isLineTerminator(ch)) {
+                ++index;
+                if (ch === 13 && source.charCodeAt(index) === 10) {
+                    ++index;
+                }
+                ++lineNumber;
+                lineStart = index;
+            } else {
+                break;
+            }
+        }
+    }
+
+    function scanHexEscape(prefix) {
+        var i, len, ch, code = 0;
+
+        len = (prefix === 'u') ? 4 : 2;
+        for (i = 0; i < len; ++i) {
+            if (index < length && isHexDigit(source[index])) {
+                ch = source[index++];
+                code = code * 16 + '0123456789abcdef'.indexOf(ch.toLowerCase());
+            } else {
+                return '';
+            }
+        }
+        return String.fromCharCode(code);
+    }
+
+    function scanUnicodeCodePointEscape() {
+        var ch, code, cu1, cu2;
+
+        ch = source[index];
+        code = 0;
+
+        // At least, one hex digit is required.
+        if (ch === '}') {
+            throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
+        }
+
+        while (index < length) {
+            ch = source[index++];
+            if (!isHexDigit(ch)) {
+                break;
+            }
+            code = code * 16 + '0123456789abcdef'.indexOf(ch.toLowerCase());
+        }
+
+        if (code > 0x10FFFF || ch !== '}') {
+            throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
+        }
+
+        // UTF-16 Encoding
+        if (code <= 0xFFFF) {
+            return String.fromCharCode(code);
+        }
+        cu1 = ((code - 0x10000) >> 10) + 0xD800;
+        cu2 = ((code - 0x10000) & 1023) + 0xDC00;
+        return String.fromCharCode(cu1, cu2);
+    }
+
+    function getEscapedIdentifier() {
+        var ch, id;
+
+        ch = source.charCodeAt(index++);
+        id = String.fromCharCode(ch);
+
+        // '\u' (char #92, char #117) denotes an escaped character.
+        if (ch === 92) {
+            if (source.charCodeAt(index) !== 117) {
+                throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
+            }
+            ++index;
+            ch = scanHexEscape('u');
+            if (!ch || ch === '\\' || !isIdentifierStart(ch.charCodeAt(0))) {
+                throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
+            }
+            id = ch;
+        }
+
+        while (index < length) {
+            ch = source.charCodeAt(index);
+            if (!isIdentifierPart(ch)) {
+                break;
+            }
+            ++index;
+            id += String.fromCharCode(ch);
+
+            // '\u' (char #92, char #117) denotes an escaped character.
+            if (ch === 92) {
+                id = id.substr(0, id.length - 1);
+                if (source.charCodeAt(index) !== 117) {
+                    throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
+                }
+                ++index;
+                ch = scanHexEscape('u');
+                if (!ch || ch === '\\' || !isIdentifierPart(ch.charCodeAt(0))) {
+                    throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
+                }
+                id += ch;
+            }
+        }
+
+        return id;
+    }
+
+    function getIdentifier() {
+        var start, ch;
+
+        start = index++;
+        while (index < length) {
+            ch = source.charCodeAt(index);
+            if (ch === 92) {
+                // Blackslash (char #92) marks Unicode escape sequence.
+                index = start;
+                return getEscapedIdentifier();
+            }
+            if (isIdentifierPart(ch)) {
+                ++index;
+            } else {
+                break;
+            }
+        }
+
+        return source.slice(start, index);
+    }
+
+    function scanIdentifier() {
+        var start, id, type;
+
+        start = index;
+
+        // Backslash (char #92) starts an escaped character.
+        id = (source.charCodeAt(index) === 92) ? getEscapedIdentifier() : getIdentifier();
+
+        // There is no keyword or literal with only one character.
+        // Thus, it must be an identifier.
+        if (id.length === 1) {
+            type = Token.Identifier;
+        } else if (isKeyword(id)) {
+            type = Token.Keyword;
+        } else if (id === 'null') {
+            type = Token.NullLiteral;
+        } else if (id === 'true' || id === 'false') {
+            type = Token.BooleanLiteral;
+        } else {
+            type = Token.Identifier;
+        }
+
+        return {
+            type: type,
+            value: id,
+            lineNumber: lineNumber,
+            lineStart: lineStart,
+            range: [start, index]
+        };
+    }
+
+
+    // 7.7 Punctuators
+
+    function scanPunctuator() {
+        var start = index,
+            code = source.charCodeAt(index),
+            code2,
+            ch1 = source[index],
+            ch2,
+            ch3,
+            ch4;
+
+        switch (code) {
+        // Check for most common single-character punctuators.
+        case 40:   // ( open bracket
+        case 41:   // ) close bracket
+        case 59:   // ; semicolon
+        case 44:   // , comma
+        case 123:  // { open curly brace
+        case 125:  // } close curly brace
+        case 91:   // [
+        case 93:   // ]
+        case 58:   // :
+        case 63:   // ?
+        case 126:  // ~
+            ++index;
+            if (extra.tokenize) {
+                if (code === 40) {
+                    extra.openParenToken = extra.tokens.length;
+                } else if (code === 123) {
+                    extra.openCurlyToken = extra.tokens.length;
+                }
+            }
+            return {
+                type: Token.Punctuator,
+                value: String.fromCharCode(code),
+                lineNumber: lineNumber,
+                lineStart: lineStart,
+                range: [start, index]
+            };
+
+        default:
+            code2 = source.charCodeAt(index + 1);
+
+            // '=' (char #61) marks an assignment or comparison operator.
+            if (code2 === 61) {
+                switch (code) {
+                case 37:  // %
+                case 38:  // &
+                case 42:  // *:
+                case 43:  // +
+                case 45:  // -
+                case 47:  // /
+                case 60:  // <
+                case 62:  // >
+                case 94:  // ^
+                case 124: // |
+                    index += 2;
+                    return {
+                        type: Token.Punctuator,
+                        value: String.fromCharCode(code) + String.fromCharCode(code2),
+                        lineNumber: lineNumber,
+                        lineStart: lineStart,
+                        range: [start, index]
+                    };
+
+                case 33: // !
+                case 61: // =
+                    index += 2;
+
+                    // !== and ===
+                    if (source.charCodeAt(index) === 61) {
+                        ++index;
+                    }
+                    return {
+                        type: Token.Punctuator,
+                        value: source.slice(start, index),
+                        lineNumber: lineNumber,
+                        lineStart: lineStart,
+                        range: [start, index]
+                    };
+                default:
+                    break;
+                }
+            }
+            break;
+        }
+
+        // Peek more characters.
+
+        ch2 = source[index + 1];
+        ch3 = source[index + 2];
+        ch4 = source[index + 3];
+
+        // 4-character punctuator: >>>=
+
+        if (ch1 === '>' && ch2 === '>' && ch3 === '>') {
+            if (ch4 === '=') {
+                index += 4;
+                return {
+                    type: Token.Punctuator,
+                    value: '>>>=',
+                    lineNumber: lineNumber,
+                    lineStart: lineStart,
+                    range: [start, index]
+                };
+            }
+        }
+
+        // 3-character punctuators: === !== >>> <<= >>=
+
+        if (ch1 === '>' && ch2 === '>' && ch3 === '>') {
+            index += 3;
+            return {
+                type: Token.Punctuator,
+                value: '>>>',
+                lineNumber: lineNumber,
+                lineStart: lineStart,
+                range: [start, index]
+            };
+        }
+
+        if (ch1 === '<' && ch2 === '<' && ch3 === '=') {
+            index += 3;
+            return {
+                type: Token.Punctuator,
+                value: '<<=',
+                lineNumber: lineNumber,
+                lineStart: lineStart,
+                range: [start, index]
+            };
+        }
+
+        if (ch1 === '>' && ch2 === '>' && ch3 === '=') {
+            index += 3;
+            return {
+                type: Token.Punctuator,
+                value: '>>=',
+                lineNumber: lineNumber,
+                lineStart: lineStart,
+                range: [start, index]
+            };
+        }
+
+        if (ch1 === '.' && ch2 === '.' && ch3 === '.') {
+            index += 3;
+            return {
+                type: Token.Punctuator,
+                value: '...',
+                lineNumber: lineNumber,
+                lineStart: lineStart,
+                range: [start, index]
+            };
+        }
+
+        // Other 2-character punctuators: ++ -- << >> && ||
+
+        if (ch1 === ch2 && ('+-<>&|'.indexOf(ch1) >= 0)) {
+            index += 2;
+            return {
+                type: Token.Punctuator,
+                value: ch1 + ch2,
+                lineNumber: lineNumber,
+                lineStart: lineStart,
+                range: [start, index]
+            };
+        }
+
+        if (ch1 === '=' && ch2 === '>') {
+            index += 2;
+            return {
+                type: Token.Punctuator,
+                value: '=>',
+                lineNumber: lineNumber,
+                lineStart: lineStart,
+                range: [start, index]
+            };
+        }
+
+        if ('<>=!+-*%&|^/'.indexOf(ch1) >= 0) {
+            ++index;
+            return {
+                type: Token.Punctuator,
+                value: ch1,
+                lineNumber: lineNumber,
+                lineStart: lineStart,
+                range: [start, index]
+            };
+        }
+
+        if (ch1 === '.') {
+            ++index;
+            return {
+                type: Token.Punctuator,
+                value: ch1,
+                lineNumber: lineNumber,
+                lineStart: lineStart,
+                range: [start, index]
+            };
+        }
+
+        throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
+    }
+
+    // 7.8.3 Numeric Literals
+
+    function scanHexLiteral(start) {
+        var number = '';
+
+        while (index < length) {
+            if (!isHexDigit(source[index])) {
+                break;
+            }
+            number += source[index++];
+        }
+
+        if (number.length === 0) {
+            throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
+        }
+
+        if (isIdentifierStart(source.charCodeAt(index))) {
+            throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
+        }
+
+        return {
+            type: Token.NumericLiteral,
+            value: parseInt('0x' + number, 16),
+            lineNumber: lineNumber,
+            lineStart: lineStart,
+            range: [start, index]
+        };
+    }
+
+    function scanOctalLiteral(prefix, start) {
+        var number, octal;
+
+        if (isOctalDigit(prefix)) {
+            octal = true;
+            number = '0' + source[index++];
+        } else {
+            octal = false;
+            ++index;
+            number = '';
+        }
+
+        while (index < length) {
+            if (!isOctalDigit(source[index])) {
+                break;
+            }
+            number += source[index++];
+        }
+
+        if (!octal && number.length === 0) {
+            // only 0o or 0O
+            throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
+        }
+
+        if (isIdentifierStart(source.charCodeAt(index)) || isDecimalDigit(source.charCodeAt(index))) {
+            throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
+        }
+
+        return {
+            type: Token.NumericLiteral,
+            value: parseInt(number, 8),
+            octal: octal,
+            lineNumber: lineNumber,
+            lineStart: lineStart,
+            range: [start, index]
+        };
+    }
+
+    function scanNumericLiteral() {
+        var number, start, ch, octal;
+
+        ch = source[index];
+        assert(isDecimalDigit(ch.charCodeAt(0)) || (ch === '.'),
+            'Numeric literal must start with a decimal digit or a decimal point');
+
+        start = index;
+        number = '';
+        if (ch !== '.') {
+            number = source[index++];
+            ch = source[index];
+
+            // Hex number starts with '0x'.
+            // Octal number starts with '0'.
+            // Octal number in ES6 starts with '0o'.
+            // Binary number in ES6 starts with '0b'.
+            if (number === '0') {
+                if (ch === 'x' || ch === 'X') {
+                    ++index;
+                    return scanHexLiteral(start);
+                }
+                if (ch === 'b' || ch === 'B') {
+                    ++index;
+                    number = '';
+
+                    while (index < length) {
+                        ch = source[index];
+                        if (ch !== '0' && ch !== '1') {
+                            break;
+                        }
+                        number += source[index++];
+                    }
+
+                    if (number.length === 0) {
+                        // only 0b or 0B
+                        throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
+                    }
+
+                    if (index < length) {
+                        ch = source.charCodeAt(index);
+                        if (isIdentifierStart(ch) || isDecimalDigit(ch)) {
+                            throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
+                        }
+                    }
+                    return {
+                        type: Token.NumericLiteral,
+                        value: parseInt(number, 2),
+                        lineNumber: lineNumber,
+                        lineStart: lineStart,
+                        range: [start, index]
+                    };
+                }
+                if (ch === 'o' || ch === 'O' || isOctalDigit(ch)) {
+                    return scanOctalLiteral(ch, start);
+                }
+                // decimal number starts with '0' such as '09' is illegal.
+                if (ch && isDecimalDigit(ch.charCodeAt(0))) {
+                    throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
+                }
+            }
+
+            while (isDecimalDigit(source.charCodeAt(index))) {
+                number += source[index++];
+            }
+            ch = source[index];
+        }
+
+        if (ch === '.') {
+            number += source[index++];
+            while (isDecimalDigit(source.charCodeAt(index))) {
+                number += source[index++];
+            }
+            ch = source[index];
+        }
+
+        if (ch === 'e' || ch === 'E') {
+            number += source[index++];
+
+            ch = source[index];
+            if (ch === '+' || ch === '-') {
+                number += source[index++];
+            }
+            if (isDecimalDigit(source.charCodeAt(index))) {
+                while (isDecimalDigit(source.charCodeAt(index))) {
+                    number += source[index++];
+                }
+            } else {
+                throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
+            }
+        }
+
+        if (isIdentifierStart(source.charCodeAt(index))) {
+            throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
+        }
+
+        return {
+            type: Token.NumericLiteral,
+            value: parseFloat(number),
+            lineNumber: lineNumber,
+            lineStart: lineStart,
+            range: [start, index]
+        };
+    }
+
+    // 7.8.4 String Literals
+
+    function scanStringLiteral() {
+        var str = '', quote, start, ch, code, unescaped, restore, octal = false;
+
+        quote = source[index];
+        assert((quote === '\'' || quote === '"'),
+            'String literal must starts with a quote');
+
+        start = index;
+        ++index;
+
+        while (index < length) {
+            ch = source[index++];
+
+            if (ch === quote) {
+                quote = '';
+                break;
+            } else if (ch === '\\') {
+                ch = source[index++];
+                if (!ch || !isLineTerminator(ch.charCodeAt(0))) {
+                    switch (ch) {
+                    case 'n':
+                        str += '\n';
+                        break;
+                    case 'r':
+                        str += '\r';
+                        break;
+                    case 't':
+                        str += '\t';
+                        break;
+                    case 'u':
+                    case 'x':
+                        if (source[index] === '{') {
+                            ++index;
+                            str += scanUnicodeCodePointEscape();
+                        } else {
+                            restore = index;
+                            unescaped = scanHexEscape(ch);
+                            if (unescaped) {
+                                str += unescaped;
+                            } else {
+                                index = restore;
+                                str += ch;
+                            }
+                        }
+                        break;
+                    case 'b':
+                        str += '\b';
+                        break;
+                    case 'f':
+                        str += '\f';
+                        break;
+                    case 'v':
+                        str += '\x0B';
+                        break;
+
+                    default:
+                        if (isOctalDigit(ch)) {
+                            code = '01234567'.indexOf(ch);
+
+                            // \0 is not octal escape sequence
+                            if (code !== 0) {
+                                octal = true;
+                            }
+
+                            if (index < length && isOctalDigit(source[index])) {
+                                octal = true;
+                                code = code * 8 + '01234567'.indexOf(source[index++]);
+
+                                // 3 digits are only allowed when string starts
+                                // with 0, 1, 2, 3
+                                if ('0123'.indexOf(ch) >= 0 &&
+                                        index < length &&
+                                        isOctalDigit(source[index])) {
+                                    code = code * 8 + '01234567'.indexOf(source[index++]);
+                                }
+                            }
+                            str += String.fromCharCode(code);
+                        } else {
+                            str += ch;
+                        }
+                        break;
+                    }
+                } else {
+                    ++lineNumber;
+                    if (ch ===  '\r' && source[index] === '\n') {
+                        ++index;
+                    }
+                }
+            } else if (isLineTerminator(ch.charCodeAt(0))) {
+                break;
+            } else {
+                str += ch;
+            }
+        }
+
+        if (quote !== '') {
+            throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
+        }
+
+        return {
+            type: Token.StringLiteral,
+            value: str,
+            octal: octal,
+            lineNumber: lineNumber,
+            lineStart: lineStart,
+            range: [start, index]
+        };
+    }
+
+    function scanTemplate() {
+        var cooked = '', ch, start, terminated, tail, restore, unescaped, code, octal;
+
+        terminated = false;
+        tail = false;
+        start = index;
+
+        ++index;
+
+        while (index < length) {
+            ch = source[index++];
+            if (ch === '`') {
+                tail = true;
+                terminated = true;
+                break;
+            } else if (ch === '$') {
+                if (source[index] === '{') {
+                    ++index;
+                    terminated = true;
+                    break;
+                }
+                cooked += ch;
+            } else if (ch === '\\') {
+                ch = source[index++];
+                if (!isLineTerminator(ch.charCodeAt(0))) {
+                    switch (ch) {
+                    case 'n':
+                        cooked += '\n';
+                        break;
+                    case 'r':
+                        cooked += '\r';
+                        break;
+                    case 't':
+                        cooked += '\t';
+                        break;
+                    case 'u':
+                    case 'x':
+                        if (source[index] === '{') {
+                            ++index;
+                            cooked += scanUnicodeCodePointEscape();
+                        } else {
+                            restore = index;
+                            unescaped = scanHexEscape(ch);
+                            if (unescaped) {
+                                cooked += unescaped;
+                            } else {
+                                index = restore;
+                                cooked += ch;
+                            }
+                        }
+                        break;
+                    case 'b':
+                        cooked += '\b';
+                        break;
+                    case 'f':
+                        cooked += '\f';
+                        break;
+                    case 'v':
+                        cooked += '\v';
+                        break;
+
+                    default:
+                        if (isOctalDigit(ch)) {
+                            code = '01234567'.indexOf(ch);
+
+                            // \0 is not octal escape sequence
+                            if (code !== 0) {
+                                octal = true;
+                            }
+
+                            if (index < length && isOctalDigit(source[index])) {
+                                octal = true;
+                                code = code * 8 + '01234567'.indexOf(source[index++]);
+
+                                // 3 digits are only allowed when string starts
+                                // with 0, 1, 2, 3
+                                if ('0123'.indexOf(ch) >= 0 &&
+                                        index < length &&
+                                        isOctalDigit(source[index])) {
+                                    code = code * 8 + '01234567'.indexOf(source[index++]);
+                                }
+                            }
+                            cooked += String.fromCharCode(code);
+                        } else {
+                            cooked += ch;
+                        }
+                        break;
+                    }
+                } else {
+                    ++lineNumber;
+                    if (ch ===  '\r' && source[index] === '\n') {
+                        ++index;
+                    }
+                }
+            } else if (isLineTerminator(ch.charCodeAt(0))) {
+                ++lineNumber;
+                if (ch ===  '\r' && source[index] === '\n') {
+                    ++index;
+                }
+                cooked += '\n';
+            } else {
+                cooked += ch;
+            }
+        }
+
+        if (!terminated) {
+            throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
+        }
+
+        return {
+            type: Token.Template,
+            value: {
+                cooked: cooked,
+                raw: source.slice(start + 1, index - ((tail) ? 1 : 2))
+            },
+            tail: tail,
+            octal: octal,
+            lineNumber: lineNumber,
+            lineStart: lineStart,
+            range: [start, index]
+        };
+    }
+
+    function scanTemplateElement(option) {
+        var startsWith, template;
+
+        lookahead = null;
+        skipComment();
+
+        startsWith = (option.head) ? '`' : '}';
+
+        if (source[index] !== startsWith) {
+            throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
+        }
+
+        template = scanTemplate();
+
+        peek();
+
+        return template;
+    }
+
+    function scanRegExp() {
+        var str, ch, start, pattern, flags, value, classMarker = false, restore, terminated = false;
+
+        lookahead = null;
+        skipComment();
+
+        start = index;
+        ch = source[index];
+        assert(ch === '/', 'Regular expression literal must start with a slash');
+        str = source[index++];
+
+        while (index < length) {
+            ch = source[index++];
+            str += ch;
+            if (classMarker) {
+                if (ch === ']') {
+                    classMarker = false;
+                }
+            } else {
+                if (ch === '\\') {
+                    ch = source[index++];
+                    // ECMA-262 7.8.5
+                    if (isLineTerminator(ch.charCodeAt(0))) {
+                        throwError({}, Messages.UnterminatedRegExp);
+                    }
+                    str += ch;
+                } else if (ch === '/') {
+                    terminated = true;
+                    break;
+                } else if (ch === '[') {
+                    classMarker = true;
+                } else if (isLineTerminator(ch.charCodeAt(0))) {
+                    throwError({}, Messages.UnterminatedRegExp);
+                }
+            }
+        }
+
+        if (!terminated) {
+            throwError({}, Messages.UnterminatedRegExp);
+        }
+
+        // Exclude leading and trailing slash.
+        pattern = str.substr(1, str.length - 2);
+
+        flags = '';
+        while (index < length) {
+            ch = source[index];
+            if (!isIdentifierPart(ch.charCodeAt(0))) {
+                break;
+            }
+
+            ++index;
+            if (ch === '\\' && index < length) {
+                ch = source[index];
+                if (ch === 'u') {
+                    ++index;
+                    restore = index;
+                    ch = scanHexEscape('u');
+                    if (ch) {
+                        flags += ch;
+                        for (str += '\\u'; restore < index; ++restore) {
+                            str += source[restore];
+                        }
+                    } else {
+                        index = restore;
+                        flags += 'u';
+                        str += '\\u';
+                    }
+                } else {
+                    str += '\\';
+                }
+            } else {
+                flags += ch;
+                str += ch;
+            }
+        }
+
+        try {
+            value = new RegExp(pattern, flags);
+        } catch (e) {
+            throwError({}, Messages.InvalidRegExp);
+        }
+
+        peek();
+
+
+        if (extra.tokenize) {
+            return {
+                type: Token.RegularExpression,
+                value: value,
+                lineNumber: lineNumber,
+                lineStart: lineStart,
+                range: [start, index]
+            };
+        }
+        return {
+            literal: str,
+            value: value,
+            range: [start, index]
+        };
+    }
+
+    function isIdentifierName(token) {
+        return token.type === Token.Identifier ||
+            token.type === Token.Keyword ||
+            token.type === Token.BooleanLiteral ||
+            token.type === Token.NullLiteral;
+    }
+
+    function advanceSlash() {
+        var prevToken,
+            checkToken;
+        // Using the following algorithm:
+        // https://github.com/mozilla/sweet.js/wiki/design
+        prevToken = extra.tokens[extra.tokens.length - 1];
+        if (!prevToken) {
+            // Nothing before that: it cannot be a division.
+            return scanRegExp();
+        }
+        if (prevToken.type === 'Punctuator') {
+            if (prevToken.value === ')') {
+                checkToken = extra.tokens[extra.openParenToken - 1];
+                if (checkToken &&
+                        checkToken.type === 'Keyword' &&
+                        (checkToken.value === 'if' ||
+                         checkToken.value === 'while' ||
+                         checkToken.value === 'for' ||
+                         checkToken.value === 'with')) {
+                    return scanRegExp();
+                }
+                return scanPunctuator();
+            }
+            if (prevToken.value === '}') {
+                // Dividing a function by anything makes little sense,
+                // but we have to check for that.
+                if (extra.tokens[extra.openCurlyToken - 3] &&
+                        extra.tokens[extra.openCurlyToken - 3].type === 'Keyword') {
+                    // Anonymous function.
+                    checkToken = extra.tokens[extra.openCurlyToken - 4];
+                    if (!checkToken) {
+                        return scanPunctuator();
+                    }
+                } else if (extra.tokens[extra.openCurlyToken - 4] &&
+                        extra.tokens[extra.openCurlyToken - 4].type === 'Keyword') {
+                    // Named function.
+                    checkToken = extra.tokens[extra.openCurlyToken - 5];
+                    if (!checkToken) {
+                        return scanRegExp();
+                    }
+                } else {
+                    return scanPunctuator();
+                }
+                // checkToken determines whether the function is
+                // a declaration or an expression.
+                if (FnExprTokens.indexOf(checkToken.value) >= 0) {
+                    // It is an expression.
+                    return scanPunctuator();
+                }
+                // It is a declaration.
+                return scanRegExp();
+            }
+            return scanRegExp();
+        }
+        if (prevToken.type === 'Keyword') {
+            return scanRegExp();
+        }
+        return scanPunctuator();
+    }
+
+    function advance() {
+        var ch;
+
+        if (!state.inXJSChild) {
+            skipComment();
+        }
+
+        if (index >= length) {
+            return {
+                type: Token.EOF,
+                lineNumber: lineNumber,
+                lineStart: lineStart,
+                range: [index, index]
+            };
+        }
+
+        if (state.inXJSChild) {
+            return advanceXJSChild();
+        }
+
+        ch = source.charCodeAt(index);
+
+        // Very common: ( and ) and ;
+        if (ch === 40 || ch === 41 || ch === 58) {
+            return scanPunctuator();
+        }
+
+        // String literal starts with single quote (#39) or double quote (#34).
+        if (ch === 39 || ch === 34) {
+            if (state.inXJSTag) {
+                return scanXJSStringLiteral();
+            }
+            return scanStringLiteral();
+        }
+
+        if (state.inXJSTag && isXJSIdentifierStart(ch)) {
+            return scanXJSIdentifier();
+        }
+
+        if (ch === 96) {
+            return scanTemplate();
+        }
+        if (isIdentifierStart(ch)) {
+            return scanIdentifier();
+        }
+
+        // Dot (.) char #46 can also start a floating-point number, hence the need
+        // to check the next character.
+        if (ch === 46) {
+            if (isDecimalDigit(source.charCodeAt(index + 1))) {
+                return scanNumericLiteral();
+            }
+            return scanPunctuator();
+        }
+
+        if (isDecimalDigit(ch)) {
+            return scanNumericLiteral();
+        }
+
+        // Slash (/) char #47 can also start a regex.
+        if (extra.tokenize && ch === 47) {
+            return advanceSlash();
+        }
+
+        return scanPunctuator();
+    }
+
+    function lex() {
+        var token;
+
+        token = lookahead;
+        index = token.range[1];
+        lineNumber = token.lineNumber;
+        lineStart = token.lineStart;
+
+        lookahead = advance();
+
+        index = token.range[1];
+        lineNumber = token.lineNumber;
+        lineStart = token.lineStart;
+
+        return token;
+    }
+
+    function peek() {
+        var pos, line, start;
+
+        pos = index;
+        line = lineNumber;
+        start = lineStart;
+        lookahead = advance();
+        index = pos;
+        lineNumber = line;
+        lineStart = start;
+    }
+
+    function lookahead2() {
+        var adv, pos, line, start, result;
+
+        // If we are collecting the tokens, don't grab the next one yet.
+        adv = (typeof extra.advance === 'function') ? extra.advance : advance;
+
+        pos = index;
+        line = lineNumber;
+        start = lineStart;
+
+        // Scan for the next immediate token.
+        if (lookahead === null) {
+            lookahead = adv();
+        }
+        index = lookahead.range[1];
+        lineNumber = lookahead.lineNumber;
+        lineStart = lookahead.lineStart;
+
+        // Grab the token right after.
+        result = adv();
+        index = pos;
+        lineNumber = line;
+        lineStart = start;
+
+        return result;
+    }
+
+    SyntaxTreeDelegate = {
+
+        name: 'SyntaxTree',
+
+        postProcess: function (node) {
+            return node;
+        },
+
+        createArrayExpression: function (elements) {
+            return {
+                type: Syntax.ArrayExpression,
+                elements: elements
+            };
+        },
+
+        createAssignmentExpression: function (operator, left, right) {
+            return {
+                type: Syntax.AssignmentExpression,
+                operator: operator,
+                left: left,
+                right: right
+            };
+        },
+
+        createBinaryExpression: function (operator, left, right) {
+            var type = (operator === '||' || operator === '&&') ? Syntax.LogicalExpression :
+                        Syntax.BinaryExpression;
+            return {
+                type: type,
+                operator: operator,
+                left: left,
+                right: right
+            };
+        },
+
+        createBlockStatement: function (body) {
+            return {
+                type: Syntax.BlockStatement,
+                body: body
+            };
+        },
+
+        createBreakStatement: function (label) {
+            return {
+                type: Syntax.BreakStatement,
+                label: label
+            };
+        },
+
+        createCallExpression: function (callee, args) {
+            return {
+                type: Syntax.CallExpression,
+                callee: callee,
+                'arguments': args
+            };
+        },
+
+        createCatchClause: function (param, body) {
+            return {
+                type: Syntax.CatchClause,
+                param: param,
+                body: body
+            };
+        },
+
+        createConditionalExpression: function (test, consequent, alternate) {
+            return {
+                type: Syntax.ConditionalExpression,
+                test: test,
+                consequent: consequent,
+                alternate: alternate
+            };
+        },
+
+        createContinueStatement: function (label) {
+            return {
+                type: Syntax.ContinueStatement,
+                label: label
+            };
+        },
+
+        createDebuggerStatement: function () {
+            return {
+                type: Syntax.DebuggerStatement
+            };
+        },
+
+        createDoWhileStatement: function (body, test) {
+            return {
+                type: Syntax.DoWhileStatement,
+                body: body,
+                test: test
+            };
+        },
+
+        createEmptyStatement: function () {
+            return {
+                type: Syntax.EmptyStatement
+            };
+        },
+
+        createExpressionStatement: function (expression) {
+            return {
+                type: Syntax.ExpressionStatement,
+                expression: expression
+            };
+        },
+
+        createForStatement: function (init, test, update, body) {
+            return {
+                type: Syntax.ForStatement,
+                init: init,
+                test: test,
+                update: update,
+                body: body
+            };
+        },
+
+        createForInStatement: function (left, right, body) {
+            return {
+                type: Syntax.ForInStatement,
+                left: left,
+                right: right,
+                body: body,
+                each: false
+            };
+        },
+
+        createForOfStatement: function (left, right, body) {
+            return {
+                type: Syntax.ForOfStatement,
+                left: left,
+                right: right,
+                body: body
+            };
+        },
+
+        createFunctionDeclaration: function (id, params, defaults, body, rest, generator, expression,
+                                             returnType) {
+            return {
+                type: Syntax.FunctionDeclaration,
+                id: id,
+                params: params,
+                defaults: defaults,
+                body: body,
+                rest: rest,
+                generator: generator,
+                expression: expression,
+                returnType: returnType
+            };
+        },
+
+        createFunctionExpression: function (id, params, defaults, body, rest, generator, expression,
+                                            returnType) {
+            return {
+                type: Syntax.FunctionExpression,
+                id: id,
+                params: params,
+                defaults: defaults,
+                body: body,
+                rest: rest,
+                generator: generator,
+                expression: expression,
+                returnType: returnType
+            };
+        },
+
+        createIdentifier: function (name) {
+            return {
+                type: Syntax.Identifier,
+                name: name,
+                // Only here to initialize the shape of the object to ensure
+                // that the 'typeAnnotation' key is ordered before others that
+                // are added later (like 'loc' and 'range'). This just helps
+                // keep the shape of Identifier nodes consistent with everything
+                // else.
+                typeAnnotation: undefined
+            };
+        },
+
+        createTypeAnnotation: function (typeIdentifier, paramTypes, returnType, nullable) {
+            return {
+                type: Syntax.TypeAnnotation,
+                id: typeIdentifier,
+                paramTypes: paramTypes,
+                returnType: returnType,
+                nullable: nullable
+            };
+        },
+
+        createTypeAnnotatedIdentifier: function (identifier, annotation) {
+            return {
+                type: Syntax.TypeAnnotatedIdentifier,
+                id: identifier,
+                annotation: annotation
+            };
+        },
+
+        createXJSAttribute: function (name, value) {
+            return {
+                type: Syntax.XJSAttribute,
+                name: name,
+                value: value
+            };
+        },
+
+        createXJSIdentifier: function (name, namespace) {
+            return {
+                type: Syntax.XJSIdentifier,
+                name: name,
+                namespace: namespace
+            };
+        },
+
+        createXJSElement: function (openingElement, closingElement, children) {
+            return {
+                type: Syntax.XJSElement,
+                openingElement: openingElement,
+                closingElement: closingElement,
+                children: children
+            };
+        },
+
+        createXJSEmptyExpression: function () {
+            return {
+                type: Syntax.XJSEmptyExpression
+            };
+        },
+
+        createXJSExpressionContainer: function (expression) {
+            return {
+                type: Syntax.XJSExpressionContainer,
+                expression: expression
+            };
+        },
+
+        createXJSOpeningElement: function (name, attributes, selfClosing) {
+            return {
+                type: Syntax.XJSOpeningElement,
+                name: name,
+                selfClosing: selfClosing,
+                attributes: attributes
+            };
+        },
+
+        createXJSClosingElement: function (name) {
+            return {
+                type: Syntax.XJSClosingElement,
+                name: name
+            };
+        },
+
+        createIfStatement: function (test, consequent, alternate) {
+            return {
+                type: Syntax.IfStatement,
+                test: test,
+                consequent: consequent,
+                alternate: alternate
+            };
+        },
+
+        createLabeledStatement: function (label, body) {
+            return {
+                type: Syntax.LabeledStatement,
+                label: label,
+                body: body
+            };
+        },
+
+        createLiteral: function (token) {
+            return {
+                type: Syntax.Literal,
+                value: token.value,
+                raw: source.slice(token.range[0], token.range[1])
+            };
+        },
+
+        createMemberExpression: function (accessor, object, property) {
+            return {
+                type: Syntax.MemberExpression,
+                computed: accessor === '[',
+                object: object,
+                property: property
+            };
+        },
+
+        createNewExpression: function (callee, args) {
+            return {
+                type: Syntax.NewExpression,
+                callee: callee,
+                'arguments': args
+            };
+        },
+
+        createObjectExpression: function (properties) {
+            return {
+                type: Syntax.ObjectExpression,
+                properties: properties
+            };
+        },
+
+        createPostfixExpression: function (operator, argument) {
+            return {
+                type: Syntax.UpdateExpression,
+                operator: operator,
+                argument: argument,
+                prefix: false
+            };
+        },
+
+        createProgram: function (body) {
+            return {
+                type: Syntax.Program,
+                body: body
+            };
+        },
+
+        createProperty: function (kind, key, value, method, shorthand) {
+            return {
+                type: Syntax.Property,
+                key: key,
+                value: value,
+                kind: kind,
+                method: method,
+                shorthand: shorthand
+            };
+        },
+
+        createReturnStatement: function (argument) {
+            return {
+                type: Syntax.ReturnStatement,
+                argument: argument
+            };
+        },
+
+        createSequenceExpression: function (expressions) {
+            return {
+                type: Syntax.SequenceExpression,
+                expressions: expressions
+            };
+        },
+
+        createSwitchCase: function (test, consequent) {
+            return {
+                type: Syntax.SwitchCase,
+                test: test,
+                consequent: consequent
+            };
+        },
+
+        createSwitchStatement: function (discriminant, cases) {
+            return {
+                type: Syntax.SwitchStatement,
+                discriminant: discriminant,
+                cases: cases
+            };
+        },
+
+        createThisExpression: function () {
+            return {
+                type: Syntax.ThisExpression
+            };
+        },
+
+        createThrowStatement: function (argument) {
+            return {
+                type: Syntax.ThrowStatement,
+                argument: argument
+            };
+        },
+
+        createTryStatement: function (block, guardedHandlers, handlers, finalizer) {
+            return {
+                type: Syntax.TryStatement,
+                block: block,
+                guardedHandlers: guardedHandlers,
+                handlers: handlers,
+                finalizer: finalizer
+            };
+        },
+
+        createUnaryExpression: function (operator, argument) {
+            if (operator === '++' || operator === '--') {
+                return {
+                    type: Syntax.UpdateExpression,
+                    operator: operator,
+                    argument: argument,
+                    prefix: true
+                };
+            }
+            return {
+                type: Syntax.UnaryExpression,
+                operator: operator,
+                argument: argument
+            };
+        },
+
+        createVariableDeclaration: function (declarations, kind) {
+            return {
+                type: Syntax.VariableDeclaration,
+                declarations: declarations,
+                kind: kind
+            };
+        },
+
+        createVariableDeclarator: function (id, init) {
+            return {
+                type: Syntax.VariableDeclarator,
+                id: id,
+                init: init
+            };
+        },
+
+        createWhileStatement: function (test, body) {
+            return {
+                type: Syntax.WhileStatement,
+                test: test,
+                body: body
+            };
+        },
+
+        createWithStatement: function (object, body) {
+            return {
+                type: Syntax.WithStatement,
+                object: object,
+                body: body
+            };
+        },
+
+        createTemplateElement: function (value, tail) {
+            return {
+                type: Syntax.TemplateElement,
+                value: value,
+                tail: tail
+            };
+        },
+
+        createTemplateLiteral: function (quasis, expressions) {
+            return {
+                type: Syntax.TemplateLiteral,
+                quasis: quasis,
+                expressions: expressions
+            };
+        },
+
+        createSpreadElement: function (argument) {
+            return {
+                type: Syntax.SpreadElement,
+                argument: argument
+            };
+        },
+
+        createTaggedTemplateExpression: function (tag, quasi) {
+            return {
+                type: Syntax.TaggedTemplateExpression,
+                tag: tag,
+                quasi: quasi
+            };
+        },
+
+        createArrowFunctionExpression: function (params, defaults, body, rest, expression) {
+            return {
+                type: Syntax.ArrowFunctionExpression,
+                id: null,
+                params: params,
+                defaults: defaults,
+                body: body,
+                rest: rest,
+                generator: false,
+                expression: expression
+            };
+        },
+
+        createMethodDefinition: function (propertyType, kind, key, value) {
+            return {
+                type: Syntax.MethodDefinition,
+                key: key,
+                value: value,
+                kind: kind,
+                'static': propertyType === ClassPropertyType["static"]
+            };
+        },
+
+        createClassBody: function (body) {
+            return {
+                type: Syntax.ClassBody,
+                body: body
+            };
+        },
+
+        createClassExpression: function (id, superClass, body) {
+            return {
+                type: Syntax.ClassExpression,
+                id: id,
+                superClass: superClass,
+                body: body
+            };
+        },
+
+        createClassDeclaration: function (id, superClass, body) {
+            return {
+                type: Syntax.ClassDeclaration,
+                id: id,
+                superClass: superClass,
+                body: body
+            };
+        },
+
+        createExportSpecifier: function (id, name) {
+            return {
+                type: Syntax.ExportSpecifier,
+                id: id,
+                name: name
+            };
+        },
+
+        createExportBatchSpecifier: function () {
+            return {
+                type: Syntax.ExportBatchSpecifier
+            };
+        },
+
+        createExportDeclaration: function (declaration, specifiers, source) {
+            return {
+                type: Syntax.ExportDeclaration,
+                declaration: declaration,
+                specifiers: specifiers,
+                source: source
+            };
+        },
+
+        createImportSpecifier: function (id, name) {
+            return {
+                type: Syntax.ImportSpecifier,
+                id: id,
+                name: name
+            };
+        },
+
+        createImportDeclaration: function (specifiers, kind, source) {
+            return {
+                type: Syntax.ImportDeclaration,
+                specifiers: specifiers,
+                kind: kind,
+                source: source
+            };
+        },
+
+        createYieldExpression: function (argument, delegate) {
+            return {
+                type: Syntax.YieldExpression,
+                argument: argument,
+                delegate: delegate
+            };
+        },
+
+        createModuleDeclaration: function (id, source, body) {
+            return {
+                type: Syntax.ModuleDeclaration,
+                id: id,
+                source: source,
+                body: body
+            };
+        }
+
+
+    };
+
+    // Return true if there is a line terminator before the next token.
+
+    function peekLineTerminator() {
+        var pos, line, start, found;
+
+        pos = index;
+        line = lineNumber;
+        start = lineStart;
+        skipComment();
+        found = lineNumber !== line;
+        index = pos;
+        lineNumber = line;
+        lineStart = start;
+
+        return found;
+    }
+
+    // Throw an exception
+
+    function throwError(token, messageFormat) {
+        var error,
+            args = Array.prototype.slice.call(arguments, 2),
+            msg = messageFormat.replace(
+                /%(\d)/g,
+                function (whole, index) {
+                    assert(index < args.length, 'Message reference must be in range');
+                    return args[index];
+                }
+            );
+
+        if (typeof token.lineNumber === 'number') {
+            error = new Error('Line ' + token.lineNumber + ': ' + msg);
+            error.index = token.range[0];
+            error.lineNumber = token.lineNumber;
+            error.column = token.range[0] - lineStart + 1;
+        } else {
+            error = new Error('Line ' + lineNumber + ': ' + msg);
+            error.index = index;
+            error.lineNumber = lineNumber;
+            error.column = index - lineStart + 1;
+        }
+
+        error.description = msg;
+        throw error;
+    }
+
+    function throwErrorTolerant() {
+        try {
+            throwError.apply(null, arguments);
+        } catch (e) {
+            if (extra.errors) {
+                extra.errors.push(e);
+            } else {
+                throw e;
+            }
+        }
+    }
+
+
+    // Throw an exception because of the token.
+
+    function throwUnexpected(token) {
+        if (token.type === Token.EOF) {
+            throwError(token, Messages.UnexpectedEOS);
+        }
+
+        if (token.type === Token.NumericLiteral) {
+            throwError(token, Messages.UnexpectedNumber);
+        }
+
+        if (token.type === Token.StringLiteral || token.type === Token.XJSText) {
+            throwError(token, Messages.UnexpectedString);
+        }
+
+        if (token.type === Token.Identifier) {
+            throwError(token, Messages.UnexpectedIdentifier);
+        }
+
+        if (token.type === Token.Keyword) {
+            if (isFutureReservedWord(token.value)) {
+                throwError(token, Messages.UnexpectedReserved);
+            } else if (strict && isStrictModeReservedWord(token.value)) {
+                throwErrorTolerant(token, Messages.StrictReservedWord);
+                return;
+            }
+            throwError(token, Messages.UnexpectedToken, token.value);
+        }
+
+        if (token.type === Token.Template) {
+            throwError(token, Messages.UnexpectedTemplate, token.value.raw);
+        }
+
+        // BooleanLiteral, NullLiteral, or Punctuator.
+        throwError(token, Messages.UnexpectedToken, token.value);
+    }
+
+    // Expect the next token to match the specified punctuator.
+    // If not, an exception will be thrown.
+
+    function expect(value) {
+        var token = lex();
+        if (token.type !== Token.Punctuator || token.value !== value) {
+            throwUnexpected(token);
+        }
+    }
+
+    // Expect the next token to match the specified keyword.
+    // If not, an exception will be thrown.
+
+    function expectKeyword(keyword) {
+        var token = lex();
+        if (token.type !== Token.Keyword || token.value !== keyword) {
+            throwUnexpected(token);
+        }
+    }
+
+    // Return true if the next token matches the specified punctuator.
+
+    function match(value) {
+        return lookahead.type === Token.Punctuator && lookahead.value === value;
+    }
+
+    // Return true if the next token matches the specified keyword
+
+    function matchKeyword(keyword) {
+        return lookahead.type === Token.Keyword && lookahead.value === keyword;
+    }
+
+
+    // Return true if the next token matches the specified contextual keyword
+
+    function matchContextualKeyword(keyword) {
+        return lookahead.type === Token.Identifier && lookahead.value === keyword;
+    }
+
+    // Return true if the next token is an assignment operator
+
+    function matchAssign() {
+        var op;
+
+        if (lookahead.type !== Token.Punctuator) {
+            return false;
+        }
+        op = lookahead.value;
+        return op === '=' ||
+            op === '*=' ||
+            op === '/=' ||
+            op === '%=' ||
+            op === '+=' ||
+            op === '-=' ||
+            op === '<<=' ||
+            op === '>>=' ||
+            op === '>>>=' ||
+            op === '&=' ||
+            op === '^=' ||
+            op === '|=';
+    }
+
+    function consumeSemicolon() {
+        var line;
+
+        // Catch the very common case first: immediately a semicolon (char #59).
+        if (source.charCodeAt(index) === 59) {
+            lex();
+            return;
+        }
+
+        line = lineNumber;
+        skipComment();
+        if (lineNumber !== line) {
+            return;
+        }
+
+        if (match(';')) {
+            lex();
+            return;
+        }
+
+        if (lookahead.type !== Token.EOF && !match('}')) {
+            throwUnexpected(lookahead);
+        }
+    }
+
+    // Return true if provided expression is LeftHandSideExpression
+
+    function isLeftHandSide(expr) {
+        return expr.type === Syntax.Identifier || expr.type === Syntax.MemberExpression;
+    }
+
+    function isAssignableLeftHandSide(expr) {
+        return isLeftHandSide(expr) || expr.type === Syntax.ObjectPattern || expr.type === Syntax.ArrayPattern;
+    }
+
+    // 11.1.4 Array Initialiser
+
+    function parseArrayInitialiser() {
+        var elements = [], blocks = [], filter = null, tmp, possiblecomprehension = true, body;
+
+        expect('[');
+        while (!match(']')) {
+            if (lookahead.value === 'for' &&
+                    lookahead.type === Token.Keyword) {
+                if (!possiblecomprehension) {
+                    throwError({}, Messages.ComprehensionError);
+                }
+                matchKeyword('for');
+                tmp = parseForStatement({ignoreBody: true});
+                tmp.of = tmp.type === Syntax.ForOfStatement;
+                tmp.type = Syntax.ComprehensionBlock;
+                if (tmp.left.kind) { // can't be let or const
+                    throwError({}, Messages.ComprehensionError);
+                }
+                blocks.push(tmp);
+            } else if (lookahead.value === 'if' &&
+                           lookahead.type === Token.Keyword) {
+                if (!possiblecomprehension) {
+                    throwError({}, Messages.ComprehensionError);
+                }
+                expectKeyword('if');
+                expect('(');
+                filter = parseExpression();
+                expect(')');
+            } else if (lookahead.value === ',' &&
+                           lookahead.type === Token.Punctuator) {
+                possiblecomprehension = false; // no longer allowed.
+                lex();
+                elements.push(null);
+            } else {
+                tmp = parseSpreadOrAssignmentExpression();
+                elements.push(tmp);
+                if (tmp && tmp.type === Syntax.SpreadElement) {
+                    if (!match(']')) {
+                        throwError({}, Messages.ElementAfterSpreadElement);
+                    }
+                } else if (!(match(']') || matchKeyword('for') || matchKeyword('if'))) {
+                    expect(','); // this lexes.
+                    possiblecomprehension = false;
+                }
+            }
+        }
+
+        expect(']');
+
+        if (filter && !blocks.length) {
+            throwError({}, Messages.ComprehensionRequiresBlock);
+        }
+
+        if (blocks.length) {
+            if (elements.length !== 1) {
+                throwError({}, Messages.ComprehensionError);
+            }
+            return {
+                type:  Syntax.ComprehensionExpression,
+                filter: filter,
+                blocks: blocks,
+                body: elements[0]
+            };
+        }
+        return delegate.createArrayExpression(elements);
+    }
+
+    // 11.1.5 Object Initialiser
+
+    function parsePropertyFunction(options) {
+        var previousStrict, previousYieldAllowed, params, defaults, body;
+
+        previousStrict = strict;
+        previousYieldAllowed = state.yieldAllowed;
+        state.yieldAllowed = options.generator;
+        params = options.params || [];
+        defaults = options.defaults || [];
+
+        body = parseConciseBody();
+        if (options.name && strict && isRestrictedWord(params[0].name)) {
+            throwErrorTolerant(options.name, Messages.StrictParamName);
+        }
+        if (state.yieldAllowed && !state.yieldFound) {
+            throwErrorTolerant({}, Messages.NoYieldInGenerator);
+        }
+        strict = previousStrict;
+        state.yieldAllowed = previousYieldAllowed;
+
+        return delegate.createFunctionExpression(null, params, defaults, body, options.rest || null, options.generator, body.type !== Syntax.BlockStatement,
+                options.returnTypeAnnotation);
+    }
+
+
+    function parsePropertyMethodFunction(options) {
+        var previousStrict, tmp, method;
+
+        previousStrict = strict;
+        strict = true;
+
+        tmp = parseParams();
+
+        if (tmp.stricted) {
+            throwErrorTolerant(tmp.stricted, tmp.message);
+        }
+
+
+        method = parsePropertyFunction({
+            params: tmp.params,
+            defaults: tmp.defaults,
+            rest: tmp.rest,
+            generator: options.generator,
+            returnTypeAnnotation: tmp.returnTypeAnnotation
+        });
+
+        strict = previousStrict;
+
+        return method;
+    }
+
+
+    function parseObjectPropertyKey() {
+        var token = lex();
+
+        // Note: This function is called only from parseObjectProperty(), where
+        // EOF and Punctuator tokens are already filtered out.
+
+        if (token.type === Token.StringLiteral || token.type === Token.NumericLiteral) {
+            if (strict && token.octal) {
+                throwErrorTolerant(token, Messages.StrictOctalLiteral);
+            }
+            return delegate.createLiteral(token);
+        }
+
+        return delegate.createIdentifier(token.value);
+    }
+
+    function parseObjectProperty() {
+        var token, key, id, value, param;
+
+        token = lookahead;
+
+        if (token.type === Token.Identifier) {
+
+            id = parseObjectPropertyKey();
+
+            // Property Assignment: Getter and Setter.
+
+            if (token.value === 'get' && !(match(':') || match('('))) {
+                key = parseObjectPropertyKey();
+                expect('(');
+                expect(')');
+                return delegate.createProperty('get', key, parsePropertyFunction({ generator: false }), false, false);
+            }
+            if (token.value === 'set' && !(match(':') || match('('))) {
+                key = parseObjectPropertyKey();
+                expect('(');
+                token = lookahead;
+                param = [ parseTypeAnnotatableIdentifier() ];
+                expect(')');
+                return delegate.createProperty('set', key, parsePropertyFunction({ params: param, generator: false, name: token }), false, false);
+            }
+            if (match(':')) {
+                lex();
+                return delegate.createProperty('init', id, parseAssignmentExpression(), false, false);
+            }
+            if (match('(')) {
+                return delegate.createProperty('init', id, parsePropertyMethodFunction({ generator: false }), true, false);
+            }
+            return delegate.createProperty('init', id, id, false, true);
+        }
+        if (token.type === Token.EOF || token.type === Token.Punctuator) {
+            if (!match('*')) {
+                throwUnexpected(token);
+            }
+            lex();
+
+            id = parseObjectPropertyKey();
+
+            if (!match('(')) {
+                throwUnexpected(lex());
+            }
+
+            return delegate.createProperty('init', id, parsePropertyMethodFunction({ generator: true }), true, false);
+        }
+        key = parseObjectPropertyKey();
+        if (match(':')) {
+            lex();
+            return delegate.createProperty('init', key, parseAssignmentExpression(), false, false);
+        }
+        if (match('(')) {
+            return delegate.createProperty('init', key, parsePropertyMethodFunction({ generator: false }), true, false);
+        }
+        throwUnexpected(lex());
+    }
+
+    function parseObjectInitialiser() {
+        var properties = [], property, name, key, kind, map = {}, toString = String;
+
+        expect('{');
+
+        while (!match('}')) {
+            property = parseObjectProperty();
+
+            if (property.key.type === Syntax.Identifier) {
+                name = property.key.name;
+            } else {
+                name = toString(property.key.value);
+            }
+            kind = (property.kind === 'init') ? PropertyKind.Data : (property.kind === 'get') ? PropertyKind.Get : PropertyKind.Set;
+
+            key = '$' + name;
+            if (Object.prototype.hasOwnProperty.call(map, key)) {
+                if (map[key] === PropertyKind.Data) {
+                    if (strict && kind === PropertyKind.Data) {
+                        throwErrorTolerant({}, Messages.StrictDuplicateProperty);
+                    } else if (kind !== PropertyKind.Data) {
+                        throwErrorTolerant({}, Messages.AccessorDataProperty);
+                    }
+                } else {
+                    if (kind === PropertyKind.Data) {
+                        throwErrorTolerant({}, Messages.AccessorDataProperty);
+                    } else if (map[key] & kind) {
+                        throwErrorTolerant({}, Messages.AccessorGetSet);
+                    }
+                }
+                map[key] |= kind;
+            } else {
+                map[key] = kind;
+            }
+
+            properties.push(property);
+
+            if (!match('}')) {
+                expect(',');
+            }
+        }
+
+        expect('}');
+
+        return delegate.createObjectExpression(properties);
+    }
+
+    function parseTemplateElement(option) {
+        var token = scanTemplateElement(option);
+        if (strict && token.octal) {
+            throwError(token, Messages.StrictOctalLiteral);
+        }
+        return delegate.createTemplateElement({ raw: token.value.raw, cooked: token.value.cooked }, token.tail);
+    }
+
+    function parseTemplateLiteral() {
+        var quasi, quasis, expressions;
+
+        quasi = parseTemplateElement({ head: true });
+        quasis = [ quasi ];
+        expressions = [];
+
+        while (!quasi.tail) {
+            expressions.push(parseExpression());
+            quasi = parseTemplateElement({ head: false });
+            quasis.push(quasi);
+        }
+
+        return delegate.createTemplateLiteral(quasis, expressions);
+    }
+
+    // 11.1.6 The Grouping Operator
+
+    function parseGroupExpression() {
+        var expr;
+
+        expect('(');
+
+        ++state.parenthesizedCount;
+
+        expr = parseExpression();
+
+        expect(')');
+
+        return expr;
+    }
+
+
+    // 11.1 Primary Expressions
+
+    function parsePrimaryExpression() {
+        var type, token;
+
+        token = lookahead;
+        type = lookahead.type;
+
+        if (type === Token.Identifier) {
+            lex();
+            return delegate.createIdentifier(token.value);
+        }
+
+        if (type === Token.StringLiteral || type === Token.NumericLiteral) {
+            if (strict && lookahead.octal) {
+                throwErrorTolerant(lookahead, Messages.StrictOctalLiteral);
+            }
+            return delegate.createLiteral(lex());
+        }
+
+        if (type === Token.Keyword) {
+            if (matchKeyword('this')) {
+                lex();
+                return delegate.createThisExpression();
+            }
+
+            if (matchKeyword('function')) {
+                return parseFunctionExpression();
+            }
+
+            if (matchKeyword('class')) {
+                return parseClassExpression();
+            }
+
+            if (matchKeyword('super')) {
+                lex();
+                return delegate.createIdentifier('super');
+            }
+        }
+
+        if (type === Token.BooleanLiteral) {
+            token = lex();
+            token.value = (token.value === 'true');
+            return delegate.createLiteral(token);
+        }
+
+        if (type === Token.NullLiteral) {
+            token = lex();
+            token.value = null;
+            return delegate.createLiteral(token);
+        }
+
+        if (match('[')) {
+            return parseArrayInitialiser();
+        }
+
+        if (match('{')) {
+            return parseObjectInitialiser();
+        }
+
+        if (match('(')) {
+            return parseGroupExpression();
+        }
+
+        if (match('/') || match('/=')) {
+            return delegate.createLiteral(scanRegExp());
+        }
+
+        if (type === Token.Template) {
+            return parseTemplateLiteral();
+        }
+
+        if (match('<')) {
+            return parseXJSElement();
+        }
+
+        return throwUnexpected(lex());
+    }
+
+    // 11.2 Left-Hand-Side Expressions
+
+    function parseArguments() {
+        var args = [], arg;
+
+        expect('(');
+
+        if (!match(')')) {
+            while (index < length) {
+                arg = parseSpreadOrAssignmentExpression();
+                args.push(arg);
+
+                if (match(')')) {
+                    break;
+                } else if (arg.type === Syntax.SpreadElement) {
+                    throwError({}, Messages.ElementAfterSpreadElement);
+                }
+
+                expect(',');
+            }
+        }
+
+        expect(')');
+
+        return args;
+    }
+
+    function parseSpreadOrAssignmentExpression() {
+        if (match('...')) {
+            lex();
+            return delegate.createSpreadElement(parseAssignmentExpression());
+        }
+        return parseAssignmentExpression();
+    }
+
+    function parseNonComputedProperty() {
+        var token = lex();
+
+        if (!isIdentifierName(token)) {
+            throwUnexpected(token);
+        }
+
+        return delegate.createIdentifier(token.value);
+    }
+
+    function parseNonComputedMember() {
+        expect('.');
+
+        return parseNonComputedProperty();
+    }
+
+    function parseComputedMember() {
+        var expr;
+
+        expect('[');
+
+        expr = parseExpression();
+
+        expect(']');
+
+        return expr;
+    }
+
+    function parseNewExpression() {
+        var callee, args;
+
+        expectKeyword('new');
+        callee = parseLeftHandSideExpression();
+        args = match('(') ? parseArguments() : [];
+
+        return delegate.createNewExpression(callee, args);
+    }
+
+    function parseLeftHandSideExpressionAllowCall() {
+        var expr, args, property;
+
+        expr = matchKeyword('new') ? parseNewExpression() : parsePrimaryExpression();
+
+        while (match('.') || match('[') || match('(') || lookahead.type === Token.Template) {
+            if (match('(')) {
+                args = parseArguments();
+                expr = delegate.createCallExpression(expr, args);
+            } else if (match('[')) {
+                expr = delegate.createMemberExpression('[', expr, parseComputedMember());
+            } else if (match('.')) {
+                expr = delegate.createMemberExpression('.', expr, parseNonComputedMember());
+            } else {
+                expr = delegate.createTaggedTemplateExpression(expr, parseTemplateLiteral());
+            }
+        }
+
+        return expr;
+    }
+
+
+    function parseLeftHandSideExpression() {
+        var expr, property;
+
+        expr = matchKeyword('new') ? parseNewExpression() : parsePrimaryExpression();
+
+        while (match('.') || match('[') || lookahead.type === Token.Template) {
+            if (match('[')) {
+                expr = delegate.createMemberExpression('[', expr, parseComputedMember());
+            } else if (match('.')) {
+                expr = delegate.createMemberExpression('.', expr, parseNonComputedMember());
+            } else {
+                expr = delegate.createTaggedTemplateExpression(expr, parseTemplateLiteral());
+            }
+        }
+
+        return expr;
+    }
+
+    // 11.3 Postfix Expressions
+
+    function parsePostfixExpression() {
+        var expr = parseLeftHandSideExpressionAllowCall(),
+            token = lookahead;
+
+        if (lookahead.type !== Token.Punctuator) {
+            return expr;
+        }
+
+        if ((match('++') || match('--')) && !peekLineTerminator()) {
+            // 11.3.1, 11.3.2
+            if (strict && expr.type === Syntax.Identifier && isRestrictedWord(expr.name)) {
+                throwErrorTolerant({}, Messages.StrictLHSPostfix);
+            }
+
+            if (!isLeftHandSide(expr)) {
+                throwError({}, Messages.InvalidLHSInAssignment);
+            }
+
+            token = lex();
+            expr = delegate.createPostfixExpression(token.value, expr);
+        }
+
+        return expr;
+    }
+
+    // 11.4 Unary Operators
+
+    function parseUnaryExpression() {
+        var token, expr;
+
+        if (lookahead.type !== Token.Punctuator && lookahead.type !== Token.Keyword) {
+            return parsePostfixExpression();
+        }
+
+        if (match('++') || match('--')) {
+            token = lex();
+            expr = parseUnaryExpression();
+            // 11.4.4, 11.4.5
+            if (strict && expr.type === Syntax.Identifier && isRestrictedWord(expr.name)) {
+                throwErrorTolerant({}, Messages.StrictLHSPrefix);
+            }
+
+            if (!isLeftHandSide(expr)) {
+                throwError({}, Messages.InvalidLHSInAssignment);
+            }
+
+            return delegate.createUnaryExpression(token.value, expr);
+        }
+
+        if (match('+') || match('-') || match('~') || match('!')) {
+            token = lex();
+            expr = parseUnaryExpression();
+            return delegate.createUnaryExpression(token.value, expr);
+        }
+
+        if (matchKeyword('delete') || matchKeyword('void') || matchKeyword('typeof')) {
+            token = lex();
+            expr = parseUnaryExpression();
+            expr = delegate.createUnaryExpression(token.value, expr);
+            if (strict && expr.operator === 'delete' && expr.argument.type === Syntax.Identifier) {
+                throwErrorTolerant({}, Messages.StrictDelete);
+            }
+            return expr;
+        }
+
+        return parsePostfixExpression();
+    }
+
+    function binaryPrecedence(token, allowIn) {
+        var prec = 0;
+
+        if (token.type !== Token.Punctuator && token.type !== Token.Keyword) {
+            return 0;
+        }
+
+        switch (token.value) {
+        case '||':
+            prec = 1;
+            break;
+
+        case '&&':
+            prec = 2;
+            break;
+
+        case '|':
+            prec = 3;
+            break;
+
+        case '^':
+            prec = 4;
+            break;
+
+        case '&':
+            prec = 5;
+            break;
+
+        case '==':
+        case '!=':
+        case '===':
+        case '!==':
+            prec = 6;
+            break;
+
+        case '<':
+        case '>':
+        case '<=':
+        case '>=':
+        case 'instanceof':
+            prec = 7;
+            break;
+
+        case 'in':
+            prec = allowIn ? 7 : 0;
+            break;
+
+        case '<<':
+        case '>>':
+        case '>>>':
+            prec = 8;
+            break;
+
+        case '+':
+        case '-':
+            prec = 9;
+            break;
+
+        case '*':
+        case '/':
+        case '%':
+            prec = 11;
+            break;
+
+        default:
+            break;
+        }
+
+        return prec;
+    }
+
+    // 11.5 Multiplicative Operators
+    // 11.6 Additive Operators
+    // 11.7 Bitwise Shift Operators
+    // 11.8 Relational Operators
+    // 11.9 Equality Operators
+    // 11.10 Binary Bitwise Operators
+    // 11.11 Binary Logical Operators
+
+    function parseBinaryExpression() {
+        var expr, token, prec, previousAllowIn, stack, right, operator, left, i;
+
+        previousAllowIn = state.allowIn;
+        state.allowIn = true;
+
+        expr = parseUnaryExpression();
+
+        token = lookahead;
+        prec = binaryPrecedence(token, previousAllowIn);
+        if (prec === 0) {
+            return expr;
+        }
+        token.prec = prec;
+        lex();
+
+        stack = [expr, token, parseUnaryExpression()];
+
+        while ((prec = binaryPrecedence(lookahead, previousAllowIn)) > 0) {
+
+            // Reduce: make a binary expression from the three topmost entries.
+            while ((stack.length > 2) && (prec <= stack[stack.length - 2].prec)) {
+                right = stack.pop();
+                operator = stack.pop().value;
+                left = stack.pop();
+                stack.push(delegate.createBinaryExpression(operator, left, right));
+            }
+
+            // Shift.
+            token = lex();
+            token.prec = prec;
+            stack.push(token);
+            stack.push(parseUnaryExpression());
+        }
+
+        state.allowIn = previousAllowIn;
+
+        // Final reduce to clean-up the stack.
+        i = stack.length - 1;
+        expr = stack[i];
+        while (i > 1) {
+            expr = delegate.createBinaryExpression(stack[i - 1].value, stack[i - 2], expr);
+            i -= 2;
+        }
+        return expr;
+    }
+
+
+    // 11.12 Conditional Operator
+
+    function parseConditionalExpression() {
+        var expr, previousAllowIn, consequent, alternate;
+
+        expr = parseBinaryExpression();
+
+        if (match('?')) {
+            lex();
+            previousAllowIn = state.allowIn;
+            state.allowIn = true;
+            consequent = parseAssignmentExpression();
+            state.allowIn = previousAllowIn;
+            expect(':');
+            alternate = parseAssignmentExpression();
+
+            expr = delegate.createConditionalExpression(expr, consequent, alternate);
+        }
+
+        return expr;
+    }
+
+    // 11.13 Assignment Operators
+
+    function reinterpretAsAssignmentBindingPattern(expr) {
+        var i, len, property, element;
+
+        if (expr.type === Syntax.ObjectExpression) {
+            expr.type = Syntax.ObjectPattern;
+            for (i = 0, len = expr.properties.length; i < len; i += 1) {
+                property = expr.properties[i];
+                if (property.kind !== 'init') {
+                    throwError({}, Messages.InvalidLHSInAssignment);
+                }
+                reinterpretAsAssignmentBindingPattern(property.value);
+            }
+        } else if (expr.type === Syntax.ArrayExpression) {
+            expr.type = Syntax.ArrayPattern;
+            for (i = 0, len = expr.elements.length; i < len; i += 1) {
+                element = expr.elements[i];
+                if (element) {
+                    reinterpretAsAssignmentBindingPattern(element);
+                }
+            }
+        } else if (expr.type === Syntax.Identifier) {
+            if (isRestrictedWord(expr.name)) {
+                throwError({}, Messages.InvalidLHSInAssignment);
+            }
+        } else if (expr.type === Syntax.SpreadElement) {
+            reinterpretAsAssignmentBindingPattern(expr.argument);
+            if (expr.argument.type === Syntax.ObjectPattern) {
+                throwError({}, Messages.ObjectPatternAsSpread);
+            }
+        } else {
+            if (expr.type !== Syntax.MemberExpression && expr.type !== Syntax.CallExpression && expr.type !== Syntax.NewExpression) {
+                throwError({}, Messages.InvalidLHSInAssignment);
+            }
+        }
+    }
+
+
+    function reinterpretAsDestructuredParameter(options, expr) {
+        var i, len, property, element;
+
+        if (expr.type === Syntax.ObjectExpression) {
+            expr.type = Syntax.ObjectPattern;
+            for (i = 0, len = expr.properties.length; i < len; i += 1) {
+                property = expr.properties[i];
+                if (property.kind !== 'init') {
+                    throwError({}, Messages.InvalidLHSInFormalsList);
+                }
+                reinterpretAsDestructuredParameter(options, property.value);
+            }
+        } else if (expr.type === Syntax.ArrayExpression) {
+            expr.type = Syntax.ArrayPattern;
+            for (i = 0, len = expr.elements.length; i < len; i += 1) {
+                element = expr.elements[i];
+                if (element) {
+                    reinterpretAsDestructuredParameter(options, element);
+                }
+            }
+        } else if (expr.type === Syntax.Identifier) {
+            validateParam(options, expr, expr.name);
+        } else {
+            if (expr.type !== Syntax.MemberExpression) {
+                throwError({}, Messages.InvalidLHSInFormalsList);
+            }
+        }
+    }
+
+    function reinterpretAsCoverFormalsList(expressions) {
+        var i, len, param, params, defaults, defaultCount, options, rest;
+
+        params = [];
+        defaults = [];
+        defaultCount = 0;
+        rest = null;
+        options = {
+            paramSet: {}
+        };
+
+        for (i = 0, len = expressions.length; i < len; i += 1) {
+            param = expressions[i];
+            if (param.type === Syntax.Identifier) {
+                params.push(param);
+                defaults.push(null);
+                validateParam(options, param, param.name);
+            } else if (param.type === Syntax.ObjectExpression || param.type === Syntax.ArrayExpression) {
+                reinterpretAsDestructuredParameter(options, param);
+                params.push(param);
+                defaults.push(null);
+            } else if (param.type === Syntax.SpreadElement) {
+                assert(i === len - 1, 'It is guaranteed that SpreadElement is last element by parseExpression');
+                reinterpretAsDestructuredParameter(options, param.argument);
+                rest = param.argument;
+            } else if (param.type === Syntax.AssignmentExpression) {
+                params.push(param.left);
+                defaults.push(param.right);
+                ++defaultCount;
+                validateParam(options, param.left, param.left.name);
+            } else {
+                return null;
+            }
+        }
+
+        if (options.message === Messages.StrictParamDupe) {
+            throwError(
+                strict ? options.stricted : options.firstRestricted,
+                options.message
+            );
+        }
+
+        if (defaultCount === 0) {
+            defaults = [];
+        }
+
+        return {
+            params: params,
+            defaults: defaults,
+            rest: rest,
+            stricted: options.stricted,
+            firstRestricted: options.firstRestricted,
+            message: options.message
+        };
+    }
+
+    function parseArrowFunctionExpression(options) {
+        var previousStrict, previousYieldAllowed, body;
+
+        expect('=>');
+
+        previousStrict = strict;
+        previousYieldAllowed = state.yieldAllowed;
+        state.yieldAllowed = false;
+        body = parseConciseBody();
+
+        if (strict && options.firstRestricted) {
+            throwError(options.firstRestricted, options.message);
+        }
+        if (strict && options.stricted) {
+            throwErrorTolerant(options.stricted, options.message);
+        }
+
+        strict = previousStrict;
+        state.yieldAllowed = previousYieldAllowed;
+
+        return delegate.createArrowFunctionExpression(options.params, options.defaults, body, options.rest, body.type !== Syntax.BlockStatement);
+    }
+
+    function parseAssignmentExpression() {
+        var expr, token, params, oldParenthesizedCount;
+
+        if (matchKeyword('yield')) {
+            return parseYieldExpression();
+        }
+
+        oldParenthesizedCount = state.parenthesizedCount;
+
+        if (match('(')) {
+            token = lookahead2();
+            if ((token.type === Token.Punctuator && token.value === ')') || token.value === '...') {
+                params = parseParams();
+                if (!match('=>')) {
+                    throwUnexpected(lex());
+                }
+                return parseArrowFunctionExpression(params);
+            }
+        }
+
+        token = lookahead;
+        expr = parseConditionalExpression();
+
+        if (match('=>') &&
+                (state.parenthesizedCount === oldParenthesizedCount ||
+                state.parenthesizedCount === (oldParenthesizedCount + 1))) {
+            if (expr.type === Syntax.Identifier) {
+                params = reinterpretAsCoverFormalsList([ expr ]);
+            } else if (expr.type === Syntax.SequenceExpression) {
+                params = reinterpretAsCoverFormalsList(expr.expressions);
+            }
+            if (params) {
+                return parseArrowFunctionExpression(params);
+            }
+        }
+
+        if (matchAssign()) {
+            // 11.13.1
+            if (strict && expr.type === Syntax.Identifier && isRestrictedWord(expr.name)) {
+                throwErrorTolerant(token, Messages.StrictLHSAssignment);
+            }
+
+            // ES.next draf 11.13 Runtime Semantics step 1
+            if (match('=') && (expr.type === Syntax.ObjectExpression || expr.type === Syntax.ArrayExpression)) {
+                reinterpretAsAssignmentBindingPattern(expr);
+            } else if (!isLeftHandSide(expr)) {
+                throwError({}, Messages.InvalidLHSInAssignment);
+            }
+
+            expr = delegate.createAssignmentExpression(lex().value, expr, parseAssignmentExpression());
+        }
+
+        return expr;
+    }
+
+    // 11.14 Comma Operator
+
+    function parseExpression() {
+        var expr, expressions, sequence, coverFormalsList, spreadFound, oldParenthesizedCount;
+
+        oldParenthesizedCount = state.parenthesizedCount;
+
+        expr = parseAssignmentExpression();
+        expressions = [ expr ];
+
+        if (match(',')) {
+            while (index < length) {
+                if (!match(',')) {
+                    break;
+                }
+
+                lex();
+                expr = parseSpreadOrAssignmentExpression();
+                expressions.push(expr);
+
+                if (expr.type === Syntax.SpreadElement) {
+                    spreadFound = true;
+                    if (!match(')')) {
+                        throwError({}, Messages.ElementAfterSpreadElement);
+                    }
+                    break;
+                }
+            }
+
+            sequence = delegate.createSequenceExpression(expressions);
+        }
+
+        if (match('=>')) {
+            // Do not allow nested parentheses on the LHS of the =>.
+            if (state.parenthesizedCount === oldParenthesizedCount || state.parenthesizedCount === (oldParenthesizedCount + 1)) {
+                expr = expr.type === Syntax.SequenceExpression ? expr.expressions : expressions;
+                coverFormalsList = reinterpretAsCoverFormalsList(expr);
+                if (coverFormalsList) {
+                    return parseArrowFunctionExpression(coverFormalsList);
+                }
+            }
+            throwUnexpected(lex());
+        }
+
+        if (spreadFound && lookahead2().value !== '=>') {
+            throwError({}, Messages.IllegalSpread);
+        }
+
+        return sequence || expr;
+    }
+
+    // 12.1 Block
+
+    function parseStatementList() {
+        var list = [],
+            statement;
+
+        while (index < length) {
+            if (match('}')) {
+                break;
+            }
+            statement = parseSourceElement();
+            if (typeof statement === 'undefined') {
+                break;
+            }
+            list.push(statement);
+        }
+
+        return list;
+    }
+
+    function parseBlock() {
+        var block;
+
+        expect('{');
+
+        block = parseStatementList();
+
+        expect('}');
+
+        return delegate.createBlockStatement(block);
+    }
+
+    // 12.2 Variable Statement
+
+    function parseTypeAnnotation(dontExpectColon) {
+        var typeIdentifier = null, paramTypes = null, returnType = null,
+            nullable = false;
+
+        if (!dontExpectColon) {
+            expect(':');
+        }
+
+        if (match('?')) {
+            lex();
+            nullable = true;
+        }
+
+        if (lookahead.type === Token.Identifier) {
+            typeIdentifier = parseVariableIdentifier();
+        }
+
+        if (match('(')) {
+            lex();
+            paramTypes = [];
+            while (lookahead.type === Token.Identifier || match('?')) {
+                paramTypes.push(parseTypeAnnotation(true));
+                if (!match(')')) {
+                    expect(',');
+                }
+            }
+            expect(')');
+            expect('=>');
+
+            if (matchKeyword('void')) {
+                lex();
+            } else {
+                returnType = parseTypeAnnotation(true);
+            }
+        }
+
+        return delegate.createTypeAnnotation(
+            typeIdentifier,
+            paramTypes,
+            returnType,
+            nullable
+        );
+    }
+
+    function parseVariableIdentifier() {
+        var token = lex();
+
+        if (token.type !== Token.Identifier) {
+            throwUnexpected(token);
+        }
+
+        return delegate.createIdentifier(token.value);
+    }
+
+    function parseTypeAnnotatableIdentifier() {
+        var ident = parseVariableIdentifier();
+
+        if (match(':')) {
+            return delegate.createTypeAnnotatedIdentifier(ident, parseTypeAnnotation());
+        }
+
+        return ident;
+    }
+
+    function parseVariableDeclaration(kind) {
+        var id,
+            init = null;
+        if (match('{')) {
+            id = parseObjectInitialiser();
+            reinterpretAsAssignmentBindingPattern(id);
+        } else if (match('[')) {
+            id = parseArrayInitialiser();
+            reinterpretAsAssignmentBindingPattern(id);
+        } else {
+            id = state.allowKeyword ? parseNonComputedProperty() : parseTypeAnnotatableIdentifier();
+            // 12.2.1
+            if (strict && isRestrictedWord(id.name)) {
+                throwErrorTolerant({}, Messages.StrictVarName);
+            }
+        }
+
+        if (kind === 'const') {
+            if (!match('=')) {
+                throwError({}, Messages.NoUnintializedConst);
+            }
+            expect('=');
+            init = parseAssignmentExpression();
+        } else if (match('=')) {
+            lex();
+            init = parseAssignmentExpression();
+        }
+
+        return delegate.createVariableDeclarator(id, init);
+    }
+
+    function parseVariableDeclarationList(kind) {
+        var list = [];
+
+        do {
+            list.push(parseVariableDeclaration(kind));
+            if (!match(',')) {
+                break;
+            }
+            lex();
+        } while (index < length);
+
+        return list;
+    }
+
+    function parseVariableStatement() {
+        var declarations;
+
+        expectKeyword('var');
+
+        declarations = parseVariableDeclarationList();
+
+        consumeSemicolon();
+
+        return delegate.createVariableDeclaration(declarations, 'var');
+    }
+
+    // kind may be `const` or `let`
+    // Both are experimental and not in the specification yet.
+    // see http://wiki.ecmascript.org/doku.php?id=harmony:const
+    // and http://wiki.ecmascript.org/doku.php?id=harmony:let
+    function parseConstLetDeclaration(kind) {
+        var declarations;
+
+        expectKeyword(kind);
+
+        declarations = parseVariableDeclarationList(kind);
+
+        consumeSemicolon();
+
+        return delegate.createVariableDeclaration(declarations, kind);
+    }
+
+    // http://wiki.ecmascript.org/doku.php?id=harmony:modules
+
+    function parseModuleDeclaration() {
+        var id, src, body;
+
+        lex();   // 'module'
+
+        if (peekLineTerminator()) {
+            throwError({}, Messages.NewlineAfterModule);
+        }
+
+        switch (lookahead.type) {
+
+        case Token.StringLiteral:
+            id = parsePrimaryExpression();
+            body = parseModuleBlock();
+            src = null;
+            break;
+
+        case Token.Identifier:
+            id = parseVariableIdentifier();
+            body = null;
+            if (!matchContextualKeyword('from')) {
+                throwUnexpected(lex());
+            }
+            lex();
+            src = parsePrimaryExpression();
+            if (src.type !== Syntax.Literal) {
+                throwError({}, Messages.InvalidModuleSpecifier);
+            }
+            break;
+        }
+
+        consumeSemicolon();
+        return delegate.createModuleDeclaration(id, src, body);
+    }
+
+    function parseExportBatchSpecifier() {
+        expect('*');
+        return delegate.createExportBatchSpecifier();
+    }
+
+    function parseExportSpecifier() {
+        var id, name = null;
+
+        id = parseVariableIdentifier();
+        if (matchContextualKeyword('as')) {
+            lex();
+            name = parseNonComputedProperty();
+        }
+
+        return delegate.createExportSpecifier(id, name);
+    }
+
+    function parseExportDeclaration() {
+        var previousAllowKeyword, decl, def, src, specifiers;
+
+        expectKeyword('export');
+
+        if (lookahead.type === Token.Keyword) {
+            switch (lookahead.value) {
+            case 'let':
+            case 'const':
+            case 'var':
+            case 'class':
+            case 'function':
+                return delegate.createExportDeclaration(parseSourceElement(), null, null);
+            }
+        }
+
+        if (isIdentifierName(lookahead)) {
+            previousAllowKeyword = state.allowKeyword;
+            state.allowKeyword = true;
+            decl = parseVariableDeclarationList('let');
+            state.allowKeyword = previousAllowKeyword;
+            return delegate.createExportDeclaration(decl, null, null);
+        }
+
+        specifiers = [];
+        src = null;
+
+        if (match('*')) {
+            specifiers.push(parseExportBatchSpecifier());
+        } else {
+            expect('{');
+            do {
+                specifiers.push(parseExportSpecifier());
+            } while (match(',') && lex());
+            expect('}');
+        }
+
+        if (matchContextualKeyword('from')) {
+            lex();
+            src = parsePrimaryExpression();
+            if (src.type !== Syntax.Literal) {
+                throwError({}, Messages.InvalidModuleSpecifier);
+            }
+        }
+
+        consumeSemicolon();
+
+        return delegate.createExportDeclaration(null, specifiers, src);
+    }
+
+    function parseImportDeclaration() {
+        var specifiers, kind, src;
+
+        expectKeyword('import');
+        specifiers = [];
+
+        if (isIdentifierName(lookahead)) {
+            kind = 'default';
+            specifiers.push(parseImportSpecifier());
+
+            if (!matchContextualKeyword('from')) {
+                throwError({}, Messages.NoFromAfterImport);
+            }
+            lex();
+        } else if (match('{')) {
+            kind = 'named';
+            lex();
+            do {
+                specifiers.push(parseImportSpecifier());
+            } while (match(',') && lex());
+            expect('}');
+
+            if (!matchContextualKeyword('from')) {
+                throwError({}, Messages.NoFromAfterImport);
+            }
+            lex();
+        }
+
+        src = parsePrimaryExpression();
+        if (src.type !== Syntax.Literal) {
+            throwError({}, Messages.InvalidModuleSpecifier);
+        }
+
+        consumeSemicolon();
+
+        return delegate.createImportDeclaration(specifiers, kind, src);
+    }
+
+    function parseImportSpecifier() {
+        var id, name = null;
+
+        id = parseNonComputedProperty();
+        if (matchContextualKeyword('as')) {
+            lex();
+            name = parseVariableIdentifier();
+        }
+
+        return delegate.createImportSpecifier(id, name);
+    }
+
+    // 12.3 Empty Statement
+
+    function parseEmptyStatement() {
+        expect(';');
+        return delegate.createEmptyStatement();
+    }
+
+    // 12.4 Expression Statement
+
+    function parseExpressionStatement() {
+        var expr = parseExpression();
+        consumeSemicolon();
+        return delegate.createExpressionStatement(expr);
+    }
+
+    // 12.5 If statement
+
+    function parseIfStatement() {
+        var test, consequent, alternate;
+
+        expectKeyword('if');
+
+        expect('(');
+
+        test = parseExpression();
+
+        expect(')');
+
+        consequent = parseStatement();
+
+        if (matchKeyword('else')) {
+            lex();
+            alternate = parseStatement();
+        } else {
+            alternate = null;
+        }
+
+        return delegate.createIfStatement(test, consequent, alternate);
+    }
+
+    // 12.6 Iteration Statements
+
+    function parseDoWhileStatement() {
+        var body, test, oldInIteration;
+
+        expectKeyword('do');
+
+        oldInIteration = state.inIteration;
+        state.inIteration = true;
+
+        body = parseStatement();
+
+        state.inIteration = oldInIteration;
+
+        expectKeyword('while');
+
+        expect('(');
+
+        test = parseExpression();
+
+        expect(')');
+
+        if (match(';')) {
+            lex();
+        }
+
+        return delegate.createDoWhileStatement(body, test);
+    }
+
+    function parseWhileStatement() {
+        var test, body, oldInIteration;
+
+        expectKeyword('while');
+
+        expect('(');
+
+        test = parseExpression();
+
+        expect(')');
+
+        oldInIteration = state.inIteration;
+        state.inIteration = true;
+
+        body = parseStatement();
+
+        state.inIteration = oldInIteration;
+
+        return delegate.createWhileStatement(test, body);
+    }
+
+    function parseForVariableDeclaration() {
+        var token = lex(),
+            declarations = parseVariableDeclarationList();
+
+        return delegate.createVariableDeclaration(declarations, token.value);
+    }
+
+    function parseForStatement(opts) {
+        var init, test, update, left, right, body, operator, oldInIteration;
+        init = test = update = null;
+        expectKeyword('for');
+
+        // http://wiki.ecmascript.org/doku.php?id=proposals:iterators_and_generators&s=each
+        if (matchContextualKeyword('each')) {
+            throwError({}, Messages.EachNotAllowed);
+        }
+
+        expect('(');
+
+        if (match(';')) {
+            lex();
+        } else {
+            if (matchKeyword('var') || matchKeyword('let') || matchKeyword('const')) {
+                state.allowIn = false;
+                init = parseForVariableDeclaration();
+                state.allowIn = true;
+
+                if (init.declarations.length === 1) {
+                    if (matchKeyword('in') || matchContextualKeyword('of')) {
+                        operator = lookahead;
+                        if (!((operator.value === 'in' || init.kind !== 'var') && init.declarations[0].init)) {
+                            lex();
+                            left = init;
+                            right = parseExpression();
+                            init = null;
+                        }
+                    }
+                }
+            } else {
+                state.allowIn = false;
+                init = parseExpression();
+                state.allowIn = true;
+
+                if (matchContextualKeyword('of')) {
+                    operator = lex();
+                    left = init;
+                    right = parseExpression();
+                    init = null;
+                } else if (matchKeyword('in')) {
+                    // LeftHandSideExpression
+                    if (!isAssignableLeftHandSide(init)) {
+                        throwError({}, Messages.InvalidLHSInForIn);
+                    }
+                    operator = lex();
+                    left = init;
+                    right = parseExpression();
+                    init = null;
+                }
+            }
+
+            if (typeof left === 'undefined') {
+                expect(';');
+            }
+        }
+
+        if (typeof left === 'undefined') {
+
+            if (!match(';')) {
+                test = parseExpression();
+            }
+            expect(';');
+
+            if (!match(')')) {
+                update = parseExpression();
+            }
+        }
+
+        expect(')');
+
+        oldInIteration = state.inIteration;
+        state.inIteration = true;
+
+        if (!(opts !== undefined && opts.ignoreBody)) {
+            body = parseStatement();
+        }
+
+        state.inIteration = oldInIteration;
+
+        if (typeof left === 'undefined') {
+            return delegate.createForStatement(init, test, update, body);
+        }
+
+        if (operator.value === 'in') {
+            return delegate.createForInStatement(left, right, body);
+        }
+        return delegate.createForOfStatement(left, right, body);
+    }
+
+    // 12.7 The continue statement
+
+    function parseContinueStatement() {
+        var label = null, key;
+
+        expectKeyword('continue');
+
+        // Optimize the most common form: 'continue;'.
+        if (source.charCodeAt(index) === 59) {
+            lex();
+
+            if (!state.inIteration) {
+                throwError({}, Messages.IllegalContinue);
+            }
+
+            return delegate.createContinueStatement(null);
+        }
+
+        if (peekLineTerminator()) {
+            if (!state.inIteration) {
+                throwError({}, Messages.IllegalContinue);
+            }
+
+            return delegate.createContinueStatement(null);
+        }
+
+        if (lookahead.type === Token.Identifier) {
+            label = parseVariableIdentifier();
+
+            key = '$' + label.name;
+            if (!Object.prototype.hasOwnProperty.call(state.labelSet, key)) {
+                throwError({}, Messages.UnknownLabel, label.name);
+            }
+        }
+
+        consumeSemicolon();
+
+        if (label === null && !state.inIteration) {
+            throwError({}, Messages.IllegalContinue);
+        }
+
+        return delegate.createContinueStatement(label);
+    }
+
+    // 12.8 The break statement
+
+    function parseBreakStatement() {
+        var label = null, key;
+
+        expectKeyword('break');
+
+        // Catch the very common case first: immediately a semicolon (char #59).
+        if (source.charCodeAt(index) === 59) {
+            lex();
+
+            if (!(state.inIteration || state.inSwitch)) {
+                throwError({}, Messages.IllegalBreak);
+            }
+
+            return delegate.createBreakStatement(null);
+        }
+
+        if (peekLineTerminator()) {
+            if (!(state.inIteration || state.inSwitch)) {
+                throwError({}, Messages.IllegalBreak);
+            }
+
+            return delegate.createBreakStatement(null);
+        }
+
+        if (lookahead.type === Token.Identifier) {
+            label = parseVariableIdentifier();
+
+            key = '$' + label.name;
+            if (!Object.prototype.hasOwnProperty.call(state.labelSet, key)) {
+                throwError({}, Messages.UnknownLabel, label.name);
+            }
+        }
+
+        consumeSemicolon();
+
+        if (label === null && !(state.inIteration || state.inSwitch)) {
+            throwError({}, Messages.IllegalBreak);
+        }
+
+        return delegate.createBreakStatement(label);
+    }
+
+    // 12.9 The return statement
+
+    function parseReturnStatement() {
+        var argument = null;
+
+        expectKeyword('return');
+
+        if (!state.inFunctionBody) {
+            throwErrorTolerant({}, Messages.IllegalReturn);
+        }
+
+        // 'return' followed by a space and an identifier is very common.
+        if (source.charCodeAt(index) === 32) {
+            if (isIdentifierStart(source.charCodeAt(index + 1))) {
+                argument = parseExpression();
+                consumeSemicolon();
+                return delegate.createReturnStatement(argument);
+            }
+        }
+
+        if (peekLineTerminator()) {
+            return delegate.createReturnStatement(null);
+        }
+
+        if (!match(';')) {
+            if (!match('}') && lookahead.type !== Token.EOF) {
+                argument = parseExpression();
+            }
+        }
+
+        consumeSemicolon();
+
+        return delegate.createReturnStatement(argument);
+    }
+
+    // 12.10 The with statement
+
+    function parseWithStatement() {
+        var object, body;
+
+        if (strict) {
+            throwErrorTolerant({}, Messages.StrictModeWith);
+        }
+
+        expectKeyword('with');
+
+        expect('(');
+
+        object = parseExpression();
+
+        expect(')');
+
+        body = parseStatement();
+
+        return delegate.createWithStatement(object, body);
+    }
+
+    // 12.10 The swith statement
+
+    function parseSwitchCase() {
+        var test,
+            consequent = [],
+            sourceElement;
+
+        if (matchKeyword('default')) {
+            lex();
+            test = null;
+        } else {
+            expectKeyword('case');
+            test = parseExpression();
+        }
+        expect(':');
+
+        while (index < length) {
+            if (match('}') || matchKeyword('default') || matchKeyword('case')) {
+                break;
+            }
+            sourceElement = parseSourceElement();
+            if (typeof sourceElement === 'undefined') {
+                break;
+            }
+            consequent.push(sourceElement);
+        }
+
+        return delegate.createSwitchCase(test, consequent);
+    }
+
+    function parseSwitchStatement() {
+        var discriminant, cases, clause, oldInSwitch, defaultFound;
+
+        expectKeyword('switch');
+
+        expect('(');
+
+        discriminant = parseExpression();
+
+        expect(')');
+
+        expect('{');
+
+        cases = [];
+
+        if (match('}')) {
+            lex();
+            return delegate.createSwitchStatement(discriminant, cases);
+        }
+
+        oldInSwitch = state.inSwitch;
+        state.inSwitch = true;
+        defaultFound = false;
+
+        while (index < length) {
+            if (match('}')) {
+                break;
+            }
+            clause = parseSwitchCase();
+            if (clause.test === null) {
+                if (defaultFound) {
+                    throwError({}, Messages.MultipleDefaultsInSwitch);
+                }
+                defaultFound = true;
+            }
+            cases.push(clause);
+        }
+
+        state.inSwitch = oldInSwitch;
+
+        expect('}');
+
+        return delegate.createSwitchStatement(discriminant, cases);
+    }
+
+    // 12.13 The throw statement
+
+    function parseThrowStatement() {
+        var argument;
+
+        expectKeyword('throw');
+
+        if (peekLineTerminator()) {
+            throwError({}, Messages.NewlineAfterThrow);
+        }
+
+        argument = parseExpression();
+
+        consumeSemicolon();
+
+        return delegate.createThrowStatement(argument);
+    }
+
+    // 12.14 The try statement
+
+    function parseCatchClause() {
+        var param, body;
+
+        expectKeyword('catch');
+
+        expect('(');
+        if (match(')')) {
+            throwUnexpected(lookahead);
+        }
+
+        param = parseExpression();
+        // 12.14.1
+        if (strict && param.type === Syntax.Identifier && isRestrictedWord(param.name)) {
+            throwErrorTolerant({}, Messages.StrictCatchVariable);
+        }
+
+        expect(')');
+        body = parseBlock();
+        return delegate.createCatchClause(param, body);
+    }
+
+    function parseTryStatement() {
+        var block, handlers = [], finalizer = null;
+
+        expectKeyword('try');
+
+        block = parseBlock();
+
+        if (matchKeyword('catch')) {
+            handlers.push(parseCatchClause());
+        }
+
+        if (matchKeyword('finally')) {
+            lex();
+            finalizer = parseBlock();
+        }
+
+        if (handlers.length === 0 && !finalizer) {
+            throwError({}, Messages.NoCatchOrFinally);
+        }
+
+        return delegate.createTryStatement(block, [], handlers, finalizer);
+    }
+
+    // 12.15 The debugger statement
+
+    function parseDebuggerStatement() {
+        expectKeyword('debugger');
+
+        consumeSemicolon();
+
+        return delegate.createDebuggerStatement();
+    }
+
+    // 12 Statements
+
+    function parseStatement() {
+        var type = lookahead.type,
+            expr,
+            labeledBody,
+            key;
+
+        if (type === Token.EOF) {
+            throwUnexpected(lookahead);
+        }
+
+        if (type === Token.Punctuator) {
+            switch (lookahead.value) {
+            case ';':
+                return parseEmptyStatement();
+            case '{':
+                return parseBlock();
+            case '(':
+                return parseExpressionStatement();
+            default:
+                break;
+            }
+        }
+
+        if (type === Token.Keyword) {
+            switch (lookahead.value) {
+            case 'break':
+                return parseBreakStatement();
+            case 'continue':
+                return parseContinueStatement();
+            case 'debugger':
+                return parseDebuggerStatement();
+            case 'do':
+                return parseDoWhileStatement();
+            case 'for':
+                return parseForStatement();
+            case 'function':
+                return parseFunctionDeclaration();
+            case 'class':
+                return parseClassDeclaration();
+            case 'if':
+                return parseIfStatement();
+            case 'return':
+                return parseReturnStatement();
+            case 'switch':
+                return parseSwitchStatement();
+            case 'throw':
+                return parseThrowStatement();
+            case 'try':
+                return parseTryStatement();
+            case 'var':
+                return parseVariableStatement();
+            case 'while':
+                return parseWhileStatement();
+            case 'with':
+                return parseWithStatement();
+            default:
+                break;
+            }
+        }
+
+        expr = parseExpression();
+
+        // 12.12 Labelled Statements
+        if ((expr.type === Syntax.Identifier) && match(':')) {
+            lex();
+
+            key = '$' + expr.name;
+            if (Object.prototype.hasOwnProperty.call(state.labelSet, key)) {
+                throwError({}, Messages.Redeclaration, 'Label', expr.name);
+            }
+
+            state.labelSet[key] = true;
+            labeledBody = parseStatement();
+            delete state.labelSet[key];
+            return delegate.createLabeledStatement(expr, labeledBody);
+        }
+
+        consumeSemicolon();
+
+        return delegate.createExpressionStatement(expr);
+    }
+
+    // 13 Function Definition
+
+    function parseConciseBody() {
+        if (match('{')) {
+            return parseFunctionSourceElements();
+        }
+        return parseAssignmentExpression();
+    }
+
+    function parseFunctionSourceElements() {
+        var sourceElement, sourceElements = [], token, directive, firstRestricted,
+            oldLabelSet, oldInIteration, oldInSwitch, oldInFunctionBody, oldParenthesizedCount;
+
+        expect('{');
+
+        while (index < length) {
+            if (lookahead.type !== Token.StringLiteral) {
+                break;
+            }
+            token = lookahead;
+
+            sourceElement = parseSourceElement();
+            sourceElements.push(sourceElement);
+            if (sourceElement.expression.type !== Syntax.Literal) {
+                // this is not directive
+                break;
+            }
+            directive = source.slice(token.range[0] + 1, token.range[1] - 1);
+            if (directive === 'use strict') {
+                strict = true;
+                if (firstRestricted) {
+                    throwErrorTolerant(firstRestricted, Messages.StrictOctalLiteral);
+                }
+            } else {
+                if (!firstRestricted && token.octal) {
+                    firstRestricted = token;
+                }
+            }
+        }
+
+        oldLabelSet = state.labelSet;
+        oldInIteration = state.inIteration;
+        oldInSwitch = state.inSwitch;
+        oldInFunctionBody = state.inFunctionBody;
+        oldParenthesizedCount = state.parenthesizedCount;
+
+        state.labelSet = {};
+        state.inIteration = false;
+        state.inSwitch = false;
+        state.inFunctionBody = true;
+        state.parenthesizedCount = 0;
+
+        while (index < length) {
+            if (match('}')) {
+                break;
+            }
+            sourceElement = parseSourceElement();
+            if (typeof sourceElement === 'undefined') {
+                break;
+            }
+            sourceElements.push(sourceElement);
+        }
+
+        expect('}');
+
+        state.labelSet = oldLabelSet;
+        state.inIteration = oldInIteration;
+        state.inSwitch = oldInSwitch;
+        state.inFunctionBody = oldInFunctionBody;
+        state.parenthesizedCount = oldParenthesizedCount;
+
+        return delegate.createBlockStatement(sourceElements);
+    }
+
+    function validateParam(options, param, name) {
+        var key = '$' + name;
+        if (strict) {
+            if (isRestrictedWord(name)) {
+                options.stricted = param;
+                options.message = Messages.StrictParamName;
+            }
+            if (Object.prototype.hasOwnProperty.call(options.paramSet, key)) {
+                options.stricted = param;
+                options.message = Messages.StrictParamDupe;
+            }
+        } else if (!options.firstRestricted) {
+            if (isRestrictedWord(name)) {
+                options.firstRestricted = param;
+                options.message = Messages.StrictParamName;
+            } else if (isStrictModeReservedWord(name)) {
+                options.firstRestricted = param;
+                options.message = Messages.StrictReservedWord;
+            } else if (Object.prototype.hasOwnProperty.call(options.paramSet, key)) {
+                options.firstRestricted = param;
+                options.message = Messages.StrictParamDupe;
+            }
+        }
+        options.paramSet[key] = true;
+    }
+
+    function parseParam(options) {
+        var token, rest, param, def;
+
+        token = lookahead;
+        if (token.value === '...') {
+            token = lex();
+            rest = true;
+        }
+
+        if (match('[')) {
+            param = parseArrayInitialiser();
+            reinterpretAsDestructuredParameter(options, param);
+        } else if (match('{')) {
+            if (rest) {
+                throwError({}, Messages.ObjectPatternAsRestParameter);
+            }
+            param = parseObjectInitialiser();
+            reinterpretAsDestructuredParameter(options, param);
+        } else {
+            // Typing rest params is awkward, so punting on that for now
+            param = rest
+                ? parseVariableIdentifier()
+                : parseTypeAnnotatableIdentifier();
+            validateParam(options, token, token.value);
+            if (match('=')) {
+                if (rest) {
+                    throwErrorTolerant(lookahead, Messages.DefaultRestParameter);
+                }
+                lex();
+                def = parseAssignmentExpression();
+                ++options.defaultCount;
+            }
+        }
+
+        if (rest) {
+            if (!match(')')) {
+                throwError({}, Messages.ParameterAfterRestParameter);
+            }
+            options.rest = param;
+            return false;
+        }
+
+        options.params.push(param);
+        options.defaults.push(def);
+        return !match(')');
+    }
+
+    function parseParams(firstRestricted) {
+        var options;
+
+        options = {
+            params: [],
+            defaultCount: 0,
+            defaults: [],
+            rest: null,
+            firstRestricted: firstRestricted
+        };
+
+        expect('(');
+
+        if (!match(')')) {
+            options.paramSet = {};
+            while (index < length) {
+                if (!parseParam(options)) {
+                    break;
+                }
+                expect(',');
+            }
+        }
+
+        expect(')');
+
+        if (options.defaultCount === 0) {
+            options.defaults = [];
+        }
+
+        if (match(':')) {
+            options.returnTypeAnnotation = parseTypeAnnotation();
+        }
+
+        return options;
+    }
+
+    function parseFunctionDeclaration() {
+        var id, body, token, tmp, firstRestricted, message, previousStrict, previousYieldAllowed, generator;
+
+        expectKeyword('function');
+
+        generator = false;
+        if (match('*')) {
+            lex();
+            generator = true;
+        }
+
+        token = lookahead;
+
+        id = parseVariableIdentifier();
+
+        if (strict) {
+            if (isRestrictedWord(token.value)) {
+                throwErrorTolerant(token, Messages.StrictFunctionName);
+            }
+        } else {
+            if (isRestrictedWord(token.value)) {
+                firstRestricted = token;
+                message = Messages.StrictFunctionName;
+            } else if (isStrictModeReservedWord(token.value)) {
+                firstRestricted = token;
+                message = Messages.StrictReservedWord;
+            }
+        }
+
+        tmp = parseParams(firstRestricted);
+        firstRestricted = tmp.firstRestricted;
+        if (tmp.message) {
+            message = tmp.message;
+        }
+
+        previousStrict = strict;
+        previousYieldAllowed = state.yieldAllowed;
+        state.yieldAllowed = generator;
+
+        body = parseFunctionSourceElements();
+
+        if (strict && firstRestricted) {
+            throwError(firstRestricted, message);
+        }
+        if (strict && tmp.stricted) {
+            throwErrorTolerant(tmp.stricted, message);
+        }
+        if (state.yieldAllowed && !state.yieldFound) {
+            throwErrorTolerant({}, Messages.NoYieldInGenerator);
+        }
+        strict = previousStrict;
+        state.yieldAllowed = previousYieldAllowed;
+
+        return delegate.createFunctionDeclaration(id, tmp.params, tmp.defaults, body, tmp.rest, generator, false,
+                tmp.returnTypeAnnotation);
+    }
+
+    function parseFunctionExpression() {
+        var token, id = null, firstRestricted, message, tmp, body, previousStrict, previousYieldAllowed, generator;
+
+        expectKeyword('function');
+
+        generator = false;
+
+        if (match('*')) {
+            lex();
+            generator = true;
+        }
+
+        if (!match('(')) {
+            token = lookahead;
+            id = parseVariableIdentifier();
+            if (strict) {
+                if (isRestrictedWord(token.value)) {
+                    throwErrorTolerant(token, Messages.StrictFunctionName);
+                }
+            } else {
+                if (isRestrictedWord(token.value)) {
+                    firstRestricted = token;
+                    message = Messages.StrictFunctionName;
+                } else if (isStrictModeReservedWord(token.value)) {
+                    firstRestricted = token;
+                    message = Messages.StrictReservedWord;
+                }
+            }
+        }
+
+        tmp = parseParams(firstRestricted);
+        firstRestricted = tmp.firstRestricted;
+        if (tmp.message) {
+            message = tmp.message;
+        }
+
+        previousStrict = strict;
+        previousYieldAllowed = state.yieldAllowed;
+        state.yieldAllowed = generator;
+
+        body = parseFunctionSourceElements();
+
+        if (strict && firstRestricted) {
+            throwError(firstRestricted, message);
+        }
+        if (strict && tmp.stricted) {
+            throwErrorTolerant(tmp.stricted, message);
+        }
+        if (state.yieldAllowed && !state.yieldFound) {
+            throwErrorTolerant({}, Messages.NoYieldInGenerator);
+        }
+        strict = previousStrict;
+        state.yieldAllowed = previousYieldAllowed;
+
+        return delegate.createFunctionExpression(id, tmp.params, tmp.defaults, body, tmp.rest, generator, false,
+                tmp.returnTypeAnnotation);
+    }
+
+    function parseYieldExpression() {
+        var delegateFlag, expr;
+
+        expectKeyword('yield');
+
+        if (!state.yieldAllowed) {
+            throwErrorTolerant({}, Messages.IllegalYield);
+        }
+
+        delegateFlag = false;
+        if (match('*')) {
+            lex();
+            delegateFlag = true;
+        }
+
+        expr = parseAssignmentExpression();
+        state.yieldFound = true;
+
+        return delegate.createYieldExpression(expr, delegateFlag);
+    }
+
+    // 14 Classes
+
+    function parseMethodDefinition(existingPropNames) {
+        var token, key, param, propType, isValidDuplicateProp = false;
+
+        if (lookahead.value === 'static') {
+            propType = ClassPropertyType["static"];
+            lex();
+        } else {
+            propType = ClassPropertyType.prototype;
+        }
+
+        if (match('*')) {
+            lex();
+            return delegate.createMethodDefinition(
+                propType,
+                '',
+                parseObjectPropertyKey(),
+                parsePropertyMethodFunction({ generator: true })
+            );
+        }
+
+        token = lookahead;
+        key = parseObjectPropertyKey();
+
+        if (token.value === 'get' && !match('(')) {
+            key = parseObjectPropertyKey();
+
+            // It is a syntax error if any other properties have a name
+            // duplicating this one unless they are a setter
+            if (existingPropNames[propType].hasOwnProperty(key.name)) {
+                isValidDuplicateProp =
+                    // There isn't already a getter for this prop
+                    existingPropNames[propType][key.name].get === undefined
+                    // There isn't already a data prop by this name
+                    && existingPropNames[propType][key.name].data === undefined
+                    // The only existing prop by this name is a setter
+                    && existingPropNames[propType][key.name].set !== undefined;
+                if (!isValidDuplicateProp) {
+                    throwError(key, Messages.IllegalDuplicateClassProperty);
+                }
+            } else {
+                existingPropNames[propType][key.name] = {};
+            }
+            existingPropNames[propType][key.name].get = true;
+
+            expect('(');
+            expect(')');
+            return delegate.createMethodDefinition(
+                propType,
+                'get',
+                key,
+                parsePropertyFunction({ generator: false })
+            );
+        }
+        if (token.value === 'set' && !match('(')) {
+            key = parseObjectPropertyKey();
+
+            // It is a syntax error if any other properties have a name
+            // duplicating this one unless they are a getter
+            if (existingPropNames[propType].hasOwnProperty(key.name)) {
+                isValidDuplicateProp =
+                    // There isn't already a setter for this prop
+                    existingPropNames[propType][key.name].set === undefined
+                    // There isn't already a data prop by this name
+                    && existingPropNames[propType][key.name].data === undefined
+                    // The only existing prop by this name is a getter
+                    && existingPropNames[propType][key.name].get !== undefined;
+                if (!isValidDuplicateProp) {
+                    throwError(key, Messages.IllegalDuplicateClassProperty);
+                }
+            } else {
+                existingPropNames[propType][key.name] = {};
+            }
+            existingPropNames[propType][key.name].set = true;
+
+            expect('(');
+            token = lookahead;
+            param = [ parseTypeAnnotatableIdentifier() ];
+            expect(')');
+            return delegate.createMethodDefinition(
+                propType,
+                'set',
+                key,
+                parsePropertyFunction({ params: param, generator: false, name: token })
+            );
+        }
+
+        // It is a syntax error if any other properties have the same name as a
+        // non-getter, non-setter method
+        if (existingPropNames[propType].hasOwnProperty(key.name)) {
+            throwError(key, Messages.IllegalDuplicateClassProperty);
+        } else {
+            existingPropNames[propType][key.name] = {};
+        }
+        existingPropNames[propType][key.name].data = true;
+
+        return delegate.createMethodDefinition(
+            propType,
+            '',
+            key,
+            parsePropertyMethodFunction({ generator: false })
+        );
+    }
+
+    function parseClassElement(existingProps) {
+        if (match(';')) {
+            lex();
+            return;
+        }
+        return parseMethodDefinition(existingProps);
+    }
+
+    function parseClassBody() {
+        var classElement, classElements = [], existingProps = {};
+
+        existingProps[ClassPropertyType["static"]] = {};
+        existingProps[ClassPropertyType.prototype] = {};
+
+        expect('{');
+
+        while (index < length) {
+            if (match('}')) {
+                break;
+            }
+            classElement = parseClassElement(existingProps);
+
+            if (typeof classElement !== 'undefined') {
+                classElements.push(classElement);
+            }
+        }
+
+        expect('}');
+
+        return delegate.createClassBody(classElements);
+    }
+
+    function parseClassExpression() {
+        var id, previousYieldAllowed, superClass = null;
+
+        expectKeyword('class');
+
+        if (!matchKeyword('extends') && !match('{')) {
+            id = parseVariableIdentifier();
+        }
+
+        if (matchKeyword('extends')) {
+            expectKeyword('extends');
+            previousYieldAllowed = state.yieldAllowed;
+            state.yieldAllowed = false;
+            superClass = parseAssignmentExpression();
+            state.yieldAllowed = previousYieldAllowed;
+        }
+
+        return delegate.createClassExpression(id, superClass, parseClassBody());
+    }
+
+    function parseClassDeclaration() {
+        var id, previousYieldAllowed, superClass = null;
+
+        expectKeyword('class');
+
+        id = parseVariableIdentifier();
+
+        if (matchKeyword('extends')) {
+            expectKeyword('extends');
+            previousYieldAllowed = state.yieldAllowed;
+            state.yieldAllowed = false;
+            superClass = parseAssignmentExpression();
+            state.yieldAllowed = previousYieldAllowed;
+        }
+
+        return delegate.createClassDeclaration(id, superClass, parseClassBody());
+    }
+
+    // 15 Program
+
+    function matchModuleDeclaration() {
+        var id;
+        if (matchContextualKeyword('module')) {
+            id = lookahead2();
+            return id.type === Token.StringLiteral || id.type === Token.Identifier;
+        }
+        return false;
+    }
+
+    function parseSourceElement() {
+        if (lookahead.type === Token.Keyword) {
+            switch (lookahead.value) {
+            case 'const':
+            case 'let':
+                return parseConstLetDeclaration(lookahead.value);
+            case 'function':
+                return parseFunctionDeclaration();
+            case 'export':
+                return parseExportDeclaration();
+            case 'import':
+                return parseImportDeclaration();
+            default:
+                return parseStatement();
+            }
+        }
+
+        if (matchModuleDeclaration()) {
+            throwError({}, Messages.NestedModule);
+        }
+
+        if (lookahead.type !== Token.EOF) {
+            return parseStatement();
+        }
+    }
+
+    function parseProgramElement() {
+        if (lookahead.type === Token.Keyword) {
+            switch (lookahead.value) {
+            case 'export':
+                return parseExportDeclaration();
+            case 'import':
+                return parseImportDeclaration();
+            }
+        }
+
+        if (matchModuleDeclaration()) {
+            return parseModuleDeclaration();
+        }
+
+        return parseSourceElement();
+    }
+
+    function parseProgramElements() {
+        var sourceElement, sourceElements = [], token, directive, firstRestricted;
+
+        while (index < length) {
+            token = lookahead;
+            if (token.type !== Token.StringLiteral) {
+                break;
+            }
+
+            sourceElement = parseProgramElement();
+            sourceElements.push(sourceElement);
+            if (sourceElement.expression.type !== Syntax.Literal) {
+                // this is not directive
+                break;
+            }
+            directive = source.slice(token.range[0] + 1, token.range[1] - 1);
+            if (directive === 'use strict') {
+                strict = true;
+                if (firstRestricted) {
+                    throwErrorTolerant(firstRestricted, Messages.StrictOctalLiteral);
+                }
+            } else {
+                if (!firstRestricted && token.octal) {
+                    firstRestricted = token;
+                }
+            }
+        }
+
+        while (index < length) {
+            sourceElement = parseProgramElement();
+            if (typeof sourceElement === 'undefined') {
+                break;
+            }
+            sourceElements.push(sourceElement);
+        }
+        return sourceElements;
+    }
+
+    function parseModuleElement() {
+        return parseSourceElement();
+    }
+
+    function parseModuleElements() {
+        var list = [],
+            statement;
+
+        while (index < length) {
+            if (match('}')) {
+                break;
+            }
+            statement = parseModuleElement();
+            if (typeof statement === 'undefined') {
+                break;
+            }
+            list.push(statement);
+        }
+
+        return list;
+    }
+
+    function parseModuleBlock() {
+        var block;
+
+        expect('{');
+
+        block = parseModuleElements();
+
+        expect('}');
+
+        return delegate.createBlockStatement(block);
+    }
+
+    function parseProgram() {
+        var body;
+        strict = false;
+        peek();
+        body = parseProgramElements();
+        return delegate.createProgram(body);
+    }
+
+    // The following functions are needed only when the option to preserve
+    // the comments is active.
+
+    function addComment(type, value, start, end, loc) {
+        assert(typeof start === 'number', 'Comment must have valid position');
+
+        // Because the way the actual token is scanned, often the comments
+        // (if any) are skipped twice during the lexical analysis.
+        // Thus, we need to skip adding a comment if the comment array already
+        // handled it.
+        if (extra.comments.length > 0) {
+            if (extra.comments[extra.comments.length - 1].range[1] > start) {
+                return;
+            }
+        }
+
+        extra.comments.push({
+            type: type,
+            value: value,
+            range: [start, end],
+            loc: loc
+        });
+    }
+
+    function scanComment() {
+        var comment, ch, loc, start, blockComment, lineComment;
+
+        comment = '';
+        blockComment = false;
+        lineComment = false;
+
+        while (index < length) {
+            ch = source[index];
+
+            if (lineComment) {
+                ch = source[index++];
+                if (isLineTerminator(ch.charCodeAt(0))) {
+                    loc.end = {
+                        line: lineNumber,
+                        column: index - lineStart - 1
+                    };
+                    lineComment = false;
+                    addComment('Line', comment, start, index - 1, loc);
+                    if (ch === '\r' && source[index] === '\n') {
+                        ++index;
+                    }
+                    ++lineNumber;
+                    lineStart = index;
+                    comment = '';
+                } else if (index >= length) {
+                    lineComment = false;
+                    comment += ch;
+                    loc.end = {
+                        line: lineNumber,
+                        column: length - lineStart
+                    };
+                    addComment('Line', comment, start, length, loc);
+                } else {
+                    comment += ch;
+                }
+            } else if (blockComment) {
+                if (isLineTerminator(ch.charCodeAt(0))) {
+                    if (ch === '\r' && source[index + 1] === '\n') {
+                        ++index;
+                        comment += '\r\n';
+                    } else {
+                        comment += ch;
+                    }
+                    ++lineNumber;
+                    ++index;
+                    lineStart = index;
+                    if (index >= length) {
+                        throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
+                    }
+                } else {
+                    ch = source[index++];
+                    if (index >= length) {
+                        throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
+                    }
+                    comment += ch;
+                    if (ch === '*') {
+                        ch = source[index];
+                        if (ch === '/') {
+                            comment = comment.substr(0, comment.length - 1);
+                            blockComment = false;
+                            ++index;
+                            loc.end = {
+                                line: lineNumber,
+                                column: index - lineStart
+                            };
+                            addComment('Block', comment, start, index, loc);
+                            comment = '';
+                        }
+                    }
+                }
+            } else if (ch === '/') {
+                ch = source[index + 1];
+                if (ch === '/') {
+                    loc = {
+                        start: {
+                            line: lineNumber,
+                            column: index - lineStart
+                        }
+                    };
+                    start = index;
+                    index += 2;
+                    lineComment = true;
+                    if (index >= length) {
+                        loc.end = {
+                            line: lineNumber,
+                            column: index - lineStart
+                        };
+                        lineComment = false;
+                        addComment('Line', comment, start, index, loc);
+                    }
+                } else if (ch === '*') {
+                    start = index;
+                    index += 2;
+                    blockComment = true;
+                    loc = {
+                        start: {
+                            line: lineNumber,
+                            column: index - lineStart - 2
+                        }
+                    };
+                    if (index >= length) {
+                        throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
+                    }
+                } else {
+                    break;
+                }
+            } else if (isWhiteSpace(ch.charCodeAt(0))) {
+                ++index;
+            } else if (isLineTerminator(ch.charCodeAt(0))) {
+                ++index;
+                if (ch ===  '\r' && source[index] === '\n') {
+                    ++index;
+                }
+                ++lineNumber;
+                lineStart = index;
+            } else {
+                break;
+            }
+        }
+    }
+
+    function filterCommentLocation() {
+        var i, entry, comment, comments = [];
+
+        for (i = 0; i < extra.comments.length; ++i) {
+            entry = extra.comments[i];
+            comment = {
+                type: entry.type,
+                value: entry.value
+            };
+            if (extra.range) {
+                comment.range = entry.range;
+            }
+            if (extra.loc) {
+                comment.loc = entry.loc;
+            }
+            comments.push(comment);
+        }
+
+        extra.comments = comments;
+    }
+
+    // 16 XJS
+
+    XHTMLEntities = {
+        quot: '\u0022',
+        amp: '&',
+        apos: "\u0027",
+        lt: "<",
+        gt: ">",
+        nbsp: "\u00A0",
+        iexcl: "\u00A1",
+        cent: "\u00A2",
+        pound: "\u00A3",
+        curren: "\u00A4",
+        yen: "\u00A5",
+        brvbar: "\u00A6",
+        sect: "\u00A7",
+        uml: "\u00A8",
+        copy: "\u00A9",
+        ordf: "\u00AA",
+        laquo: "\u00AB",
+        not: "\u00AC",
+        shy: "\u00AD",
+        reg: "\u00AE",
+        macr: "\u00AF",
+        deg: "\u00B0",
+        plusmn: "\u00B1",
+        sup2: "\u00B2",
+        sup3: "\u00B3",
+        acute: "\u00B4",
+        micro: "\u00B5",
+        para: "\u00B6",
+        middot: "\u00B7",
+        cedil: "\u00B8",
+        sup1: "\u00B9",
+        ordm: "\u00BA",
+        raquo: "\u00BB",
+        frac14: "\u00BC",
+        frac12: "\u00BD",
+        frac34: "\u00BE",
+        iquest: "\u00BF",
+        Agrave: "\u00C0",
+        Aacute: "\u00C1",
+        Acirc: "\u00C2",
+        Atilde: "\u00C3",
+        Auml: "\u00C4",
+        Aring: "\u00C5",
+        AElig: "\u00C6",
+        Ccedil: "\u00C7",
+        Egrave: "\u00C8",
+        Eacute: "\u00C9",
+        Ecirc: "\u00CA",
+        Euml: "\u00CB",
+        Igrave: "\u00CC",
+        Iacute: "\u00CD",
+        Icirc: "\u00CE",
+        Iuml: "\u00CF",
+        ETH: "\u00D0",
+        Ntilde: "\u00D1",
+        Ograve: "\u00D2",
+        Oacute: "\u00D3",
+        Ocirc: "\u00D4",
+        Otilde: "\u00D5",
+        Ouml: "\u00D6",
+        times: "\u00D7",
+        Oslash: "\u00D8",
+        Ugrave: "\u00D9",
+        Uacute: "\u00DA",
+        Ucirc: "\u00DB",
+        Uuml: "\u00DC",
+        Yacute: "\u00DD",
+        THORN: "\u00DE",
+        szlig: "\u00DF",
+        agrave: "\u00E0",
+        aacute: "\u00E1",
+        acirc: "\u00E2",
+        atilde: "\u00E3",
+        auml: "\u00E4",
+        aring: "\u00E5",
+        aelig: "\u00E6",
+        ccedil: "\u00E7",
+        egrave: "\u00E8",
+        eacute: "\u00E9",
+        ecirc: "\u00EA",
+        euml: "\u00EB",
+        igrave: "\u00EC",
+        iacute: "\u00ED",
+        icirc: "\u00EE",
+        iuml: "\u00EF",
+        eth: "\u00F0",
+        ntilde: "\u00F1",
+        ograve: "\u00F2",
+        oacute: "\u00F3",
+        ocirc: "\u00F4",
+        otilde: "\u00F5",
+        ouml: "\u00F6",
+        divide: "\u00F7",
+        oslash: "\u00F8",
+        ugrave: "\u00F9",
+        uacute: "\u00FA",
+        ucirc: "\u00FB",
+        uuml: "\u00FC",
+        yacute: "\u00FD",
+        thorn: "\u00FE",
+        yuml: "\u00FF",
+        OElig: "\u0152",
+        oelig: "\u0153",
+        Scaron: "\u0160",
+        scaron: "\u0161",
+        Yuml: "\u0178",
+        fnof: "\u0192",
+        circ: "\u02C6",
+        tilde: "\u02DC",
+        Alpha: "\u0391",
+        Beta: "\u0392",
+        Gamma: "\u0393",
+        Delta: "\u0394",
+        Epsilon: "\u0395",
+        Zeta: "\u0396",
+        Eta: "\u0397",
+        Theta: "\u0398",
+        Iota: "\u0399",
+        Kappa: "\u039A",
+        Lambda: "\u039B",
+        Mu: "\u039C",
+        Nu: "\u039D",
+        Xi: "\u039E",
+        Omicron: "\u039F",
+        Pi: "\u03A0",
+        Rho: "\u03A1",
+        Sigma: "\u03A3",
+        Tau: "\u03A4",
+        Upsilon: "\u03A5",
+        Phi: "\u03A6",
+        Chi: "\u03A7",
+        Psi: "\u03A8",
+        Omega: "\u03A9",
+        alpha: "\u03B1",
+        beta: "\u03B2",
+        gamma: "\u03B3",
+        delta: "\u03B4",
+        epsilon: "\u03B5",
+        zeta: "\u03B6",
+        eta: "\u03B7",
+        theta: "\u03B8",
+        iota: "\u03B9",
+        kappa: "\u03BA",
+        lambda: "\u03BB",
+        mu: "\u03BC",
+        nu: "\u03BD",
+        xi: "\u03BE",
+        omicron: "\u03BF",
+        pi: "\u03C0",
+        rho: "\u03C1",
+        sigmaf: "\u03C2",
+        sigma: "\u03C3",
+        tau: "\u03C4",
+        upsilon: "\u03C5",
+        phi: "\u03C6",
+        chi: "\u03C7",
+        psi: "\u03C8",
+        omega: "\u03C9",
+        thetasym: "\u03D1",
+        upsih: "\u03D2",
+        piv: "\u03D6",
+        ensp: "\u2002",
+        emsp: "\u2003",
+        thinsp: "\u2009",
+        zwnj: "\u200C",
+        zwj: "\u200D",
+        lrm: "\u200E",
+        rlm: "\u200F",
+        ndash: "\u2013",
+        mdash: "\u2014",
+        lsquo: "\u2018",
+        rsquo: "\u2019",
+        sbquo: "\u201A",
+        ldquo: "\u201C",
+        rdquo: "\u201D",
+        bdquo: "\u201E",
+        dagger: "\u2020",
+        Dagger: "\u2021",
+        bull: "\u2022",
+        hellip: "\u2026",
+        permil: "\u2030",
+        prime: "\u2032",
+        Prime: "\u2033",
+        lsaquo: "\u2039",
+        rsaquo: "\u203A",
+        oline: "\u203E",
+        frasl: "\u2044",
+        euro: "\u20AC",
+        image: "\u2111",
+        weierp: "\u2118",
+        real: "\u211C",
+        trade: "\u2122",
+        alefsym: "\u2135",
+        larr: "\u2190",
+        uarr: "\u2191",
+        rarr: "\u2192",
+        darr: "\u2193",
+        harr: "\u2194",
+        crarr: "\u21B5",
+        lArr: "\u21D0",
+        uArr: "\u21D1",
+        rArr: "\u21D2",
+        dArr: "\u21D3",
+        hArr: "\u21D4",
+        forall: "\u2200",
+        part: "\u2202",
+        exist: "\u2203",
+        empty: "\u2205",
+        nabla: "\u2207",
+        isin: "\u2208",
+        notin: "\u2209",
+        ni: "\u220B",
+        prod: "\u220F",
+        sum: "\u2211",
+        minus: "\u2212",
+        lowast: "\u2217",
+        radic: "\u221A",
+        prop: "\u221D",
+        infin: "\u221E",
+        ang: "\u2220",
+        and: "\u2227",
+        or: "\u2228",
+        cap: "\u2229",
+        cup: "\u222A",
+        "int": "\u222B",
+        there4: "\u2234",
+        sim: "\u223C",
+        cong: "\u2245",
+        asymp: "\u2248",
+        ne: "\u2260",
+        equiv: "\u2261",
+        le: "\u2264",
+        ge: "\u2265",
+        sub: "\u2282",
+        sup: "\u2283",
+        nsub: "\u2284",
+        sube: "\u2286",
+        supe: "\u2287",
+        oplus: "\u2295",
+        otimes: "\u2297",
+        perp: "\u22A5",
+        sdot: "\u22C5",
+        lceil: "\u2308",
+        rceil: "\u2309",
+        lfloor: "\u230A",
+        rfloor: "\u230B",
+        lang: "\u2329",
+        rang: "\u232A",
+        loz: "\u25CA",
+        spades: "\u2660",
+        clubs: "\u2663",
+        hearts: "\u2665",
+        diams: "\u2666"
+    };
+
+    function isXJSIdentifierStart(ch) {
+        // exclude backslash (\)
+        return (ch !== 92) && isIdentifierStart(ch);
+    }
+
+    function isXJSIdentifierPart(ch) {
+        // exclude backslash (\) and add hyphen (-)
+        return (ch !== 92) && (ch === 45 || isIdentifierPart(ch));
+    }
+
+    function scanXJSIdentifier() {
+        var ch, start, id = '', namespace;
+
+        start = index;
+        while (index < length) {
+            ch = source.charCodeAt(index);
+            if (!isXJSIdentifierPart(ch)) {
+                break;
+            }
+            id += source[index++];
+        }
+
+        if (ch === 58) { // :
+            ++index;
+            namespace = id;
+            id = '';
+
+            while (index < length) {
+                ch = source.charCodeAt(index);
+                if (!isXJSIdentifierPart(ch)) {
+                    break;
+                }
+                id += source[index++];
+            }
+        }
+
+        if (!id) {
+            throwError({}, Messages.InvalidXJSTagName);
+        }
+
+        return {
+            type: Token.XJSIdentifier,
+            value: id,
+            namespace: namespace,
+            lineNumber: lineNumber,
+            lineStart: lineStart,
+            range: [start, index]
+        };
+    }
+
+    function scanXJSEntity() {
+        var ch, str = '', count = 0, entity;
+        ch = source[index];
+        assert(ch === '&', 'Entity must start with an ampersand');
+        index++;
+        while (index < length && count++ < 10) {
+            ch = source[index++];
+            if (ch === ';') {
+                break;
+            }
+            str += ch;
+        }
+
+        if (str[0] === '#' && str[1] === 'x') {
+            entity = String.fromCharCode(parseInt(str.substr(2), 16));
+        } else if (str[0] === '#') {
+            entity = String.fromCharCode(parseInt(str.substr(1), 10));
+        } else {
+            entity = XHTMLEntities[str];
+        }
+        return entity;
+    }
+
+    function scanXJSText(stopChars) {
+        var ch, str = '', start;
+        start = index;
+        while (index < length) {
+            ch = source[index];
+            if (stopChars.indexOf(ch) !== -1) {
+                break;
+            }
+            if (ch === '&') {
+                str += scanXJSEntity();
+            } else {
+                ch = source[index++];
+                if (isLineTerminator(ch.charCodeAt(0))) {
+                    ++lineNumber;
+                    lineStart = index;
+                }
+                str += ch;
+            }
+        }
+        return {
+            type: Token.XJSText,
+            value: str,
+            lineNumber: lineNumber,
+            lineStart: lineStart,
+            range: [start, index]
+        };
+    }
+
+    function scanXJSStringLiteral() {
+        var innerToken, quote, start;
+
+        quote = source[index];
+        assert((quote === '\'' || quote === '"'),
+            'String literal must starts with a quote');
+
+        start = index;
+        ++index;
+
+        innerToken = scanXJSText([quote]);
+
+        if (quote !== source[index]) {
+            throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
+        }
+
+        ++index;
+
+        innerToken.range = [start, index];
+
+        return innerToken;
+    }
+
+    /**
+     * Between XJS opening and closing tags (e.g. <foo>HERE</foo>), anything that
+     * is not another XJS tag and is not an expression wrapped by {} is text.
+     */
+    function advanceXJSChild() {
+        var ch = source.charCodeAt(index);
+
+        // { (123) and < (60)
+        if (ch !== 123 && ch !== 60) {
+            return scanXJSText(['<', '{']);
+        }
+
+        return scanPunctuator();
+    }
+
+    function parseXJSIdentifier() {
+        var token;
+
+        if (lookahead.type !== Token.XJSIdentifier) {
+            throwUnexpected(lookahead);
+        }
+
+        token = lex();
+        return delegate.createXJSIdentifier(token.value, token.namespace);
+    }
+
+    function parseXJSAttributeValue() {
+        var value;
+        if (match('{')) {
+            value = parseXJSExpressionContainer();
+            if (value.expression.type === Syntax.XJSEmptyExpression) {
+                throwError(
+                    value,
+                    'XJS attributes must only be assigned a non-empty ' +
+                        'expression'
+                );
+            }
+        } else if (match('<')) {
+            value = parseXJSElement();
+        } else if (lookahead.type === Token.XJSText) {
+            value = delegate.createLiteral(lex());
+        } else {
+            throwError({}, Messages.InvalidXJSAttributeValue);
+        }
+        return value;
+    }
+
+    function parseXJSEmptyExpression() {
+        while (source.charAt(index) !== '}') {
+            index++;
+        }
+        return delegate.createXJSEmptyExpression();
+    }
+
+    function parseXJSExpressionContainer() {
+        var expression, origInXJSChild, origInXJSTag;
+
+        origInXJSChild = state.inXJSChild;
+        origInXJSTag = state.inXJSTag;
+        state.inXJSChild = false;
+        state.inXJSTag = false;
+
+        expect('{');
+
+        if (match('}')) {
+            expression = parseXJSEmptyExpression();
+        } else {
+            expression = parseExpression();
+        }
+
+        state.inXJSChild = origInXJSChild;
+        state.inXJSTag = origInXJSTag;
+
+        expect('}');
+
+        return delegate.createXJSExpressionContainer(expression);
+    }
+
+    function parseXJSAttribute() {
+        var token, name, value;
+
+        name = parseXJSIdentifier();
+
+        // HTML empty attribute
+        if (match('=')) {
+            lex();
+            return delegate.createXJSAttribute(name, parseXJSAttributeValue());
+        }
+
+        return delegate.createXJSAttribute(name);
+    }
+
+    function parseXJSChild() {
+        var token;
+        if (match('{')) {
+            token = parseXJSExpressionContainer();
+        } else if (lookahead.type === Token.XJSText) {
+            token = delegate.createLiteral(lex());
+        } else {
+            token = parseXJSElement();
+        }
+        return token;
+    }
+
+    function parseXJSClosingElement() {
+        var name, origInXJSChild, origInXJSTag;
+        origInXJSChild = state.inXJSChild;
+        origInXJSTag = state.inXJSTag;
+        state.inXJSChild = false;
+        state.inXJSTag = true;
+        expect('<');
+        expect('/');
+        name = parseXJSIdentifier();
+        // Because advance() (called by lex() called by expect()) expects there
+        // to be a valid token after >, it needs to know whether to look for a
+        // standard JS token or an XJS text node
+        state.inXJSChild = origInXJSChild;
+        state.inXJSTag = origInXJSTag;
+        expect('>');
+        return delegate.createXJSClosingElement(name);
+    }
+
+    function parseXJSOpeningElement() {
+        var name, attribute, attributes = [], selfClosing = false, origInXJSChild, origInXJSTag;
+
+        origInXJSChild = state.inXJSChild;
+        origInXJSTag = state.inXJSTag;
+        state.inXJSChild = false;
+        state.inXJSTag = true;
+
+        expect('<');
+
+        name = parseXJSIdentifier();
+
+        while (index < length &&
+                lookahead.value !== '/' &&
+                lookahead.value !== '>') {
+            attributes.push(parseXJSAttribute());
+        }
+
+        state.inXJSTag = origInXJSTag;
+
+        if (lookahead.value === '/') {
+            expect('/');
+            // Because advance() (called by lex() called by expect()) expects
+            // there to be a valid token after >, it needs to know whether to
+            // look for a standard JS token or an XJS text node
+            state.inXJSChild = origInXJSChild;
+            expect('>');
+            selfClosing = true;
+        } else {
+            state.inXJSChild = true;
+            expect('>');
+        }
+        return delegate.createXJSOpeningElement(name, attributes, selfClosing);
+    }
+
+    function parseXJSElement() {
+        var openingElement, closingElement, children = [], origInXJSChild, origInXJSTag;
+
+        origInXJSChild = state.inXJSChild;
+        origInXJSTag = state.inXJSTag;
+        openingElement = parseXJSOpeningElement();
+
+        if (!openingElement.selfClosing) {
+            while (index < length) {
+                state.inXJSChild = false; // Call lookahead2() with inXJSChild = false because </ should not be considered in the child
+                if (lookahead.value === '<' && lookahead2().value === '/') {
+                    break;
+                }
+                state.inXJSChild = true;
+                peek(); // reset lookahead token
+                children.push(parseXJSChild());
+            }
+            state.inXJSChild = origInXJSChild;
+            state.inXJSTag = origInXJSTag;
+            closingElement = parseXJSClosingElement();
+            if (closingElement.name.namespace !== openingElement.name.namespace || closingElement.name.name !== openingElement.name.name) {
+                throwError({}, Messages.ExpectedXJSClosingTag, openingElement.name.namespace ? openingElement.name.namespace + ':' + openingElement.name.name : openingElement.name.name);
+            }
+        }
+
+        return delegate.createXJSElement(openingElement, closingElement, children);
+    }
+
+    function collectToken() {
+        var start, loc, token, range, value;
+
+        skipComment();
+        start = index;
+        loc = {
+            start: {
+                line: lineNumber,
+                column: index - lineStart
+            }
+        };
+
+        token = extra.advance();
+        loc.end = {
+            line: lineNumber,
+            column: index - lineStart
+        };
+
+        if (token.type !== Token.EOF) {
+            range = [token.range[0], token.range[1]];
+            value = source.slice(token.range[0], token.range[1]);
+            extra.tokens.push({
+                type: TokenName[token.type],
+                value: value,
+                range: range,
+                loc: loc
+            });
+        }
+
+        return token;
+    }
+
+    function collectRegex() {
+        var pos, loc, regex, token;
+
+        skipComment();
+
+        pos = index;
+        loc = {
+            start: {
+                line: lineNumber,
+                column: index - lineStart
+            }
+        };
+
+        regex = extra.scanRegExp();
+        loc.end = {
+            line: lineNumber,
+            column: index - lineStart
+        };
+
+        if (!extra.tokenize) {
+            // Pop the previous token, which is likely '/' or '/='
+            if (extra.tokens.length > 0) {
+                token = extra.tokens[extra.tokens.length - 1];
+                if (token.range[0] === pos && token.type === 'Punctuator') {
+                    if (token.value === '/' || token.value === '/=') {
+                        extra.tokens.pop();
+                    }
+                }
+            }
+
+            extra.tokens.push({
+                type: 'RegularExpression',
+                value: regex.literal,
+                range: [pos, index],
+                loc: loc
+            });
+        }
+
+        return regex;
+    }
+
+    function filterTokenLocation() {
+        var i, entry, token, tokens = [];
+
+        for (i = 0; i < extra.tokens.length; ++i) {
+            entry = extra.tokens[i];
+            token = {
+                type: entry.type,
+                value: entry.value
+            };
+            if (extra.range) {
+                token.range = entry.range;
+            }
+            if (extra.loc) {
+                token.loc = entry.loc;
+            }
+            tokens.push(token);
+        }
+
+        extra.tokens = tokens;
+    }
+
+    function LocationMarker() {
+        this.range = [index, index];
+        this.loc = {
+            start: {
+                line: lineNumber,
+                column: index - lineStart
+            },
+            end: {
+                line: lineNumber,
+                column: index - lineStart
+            }
+        };
+    }
+
+    LocationMarker.prototype = {
+        constructor: LocationMarker,
+
+        end: function () {
+            this.range[1] = index;
+            this.loc.end.line = lineNumber;
+            this.loc.end.column = index - lineStart;
+        },
+
+        applyGroup: function (node) {
+            if (extra.range) {
+                node.groupRange = [this.range[0], this.range[1]];
+            }
+            if (extra.loc) {
+                node.groupLoc = {
+                    start: {
+                        line: this.loc.start.line,
+                        column: this.loc.start.column
+                    },
+                    end: {
+                        line: this.loc.end.line,
+                        column: this.loc.end.column
+                    }
+                };
+                node = delegate.postProcess(node);
+            }
+        },
+
+        apply: function (node) {
+            var nodeType = typeof node;
+            assert(nodeType === 'object',
+                'Applying location marker to an unexpected node type: ' +
+                    nodeType);
+
+            if (extra.range) {
+                node.range = [this.range[0], this.range[1]];
+            }
+            if (extra.loc) {
+                node.loc = {
+                    start: {
+                        line: this.loc.start.line,
+                        column: this.loc.start.column
+                    },
+                    end: {
+                        line: this.loc.end.line,
+                        column: this.loc.end.column
+                    }
+                };
+                node = delegate.postProcess(node);
+            }
+        }
+    };
+
+    function createLocationMarker() {
+        return new LocationMarker();
+    }
+
+    function trackGroupExpression() {
+        var marker, expr;
+
+        skipComment();
+        marker = createLocationMarker();
+        expect('(');
+
+        ++state.parenthesizedCount;
+        expr = parseExpression();
+
+        expect(')');
+        marker.end();
+        marker.applyGroup(expr);
+
+        return expr;
+    }
+
+    function trackLeftHandSideExpression() {
+        var marker, expr;
+
+        skipComment();
+        marker = createLocationMarker();
+
+        expr = matchKeyword('new') ? parseNewExpression() : parsePrimaryExpression();
+
+        while (match('.') || match('[') || lookahead.type === Token.Template) {
+            if (match('[')) {
+                expr = delegate.createMemberExpression('[', expr, parseComputedMember());
+                marker.end();
+                marker.apply(expr);
+            } else if (match('.')) {
+                expr = delegate.createMemberExpression('.', expr, parseNonComputedMember());
+                marker.end();
+                marker.apply(expr);
+            } else {
+                expr = delegate.createTaggedTemplateExpression(expr, parseTemplateLiteral());
+                marker.end();
+                marker.apply(expr);
+            }
+        }
+
+        return expr;
+    }
+
+    function trackLeftHandSideExpressionAllowCall() {
+        var marker, expr, args;
+
+        skipComment();
+        marker = createLocationMarker();
+
+        expr = matchKeyword('new') ? parseNewExpression() : parsePrimaryExpression();
+
+        while (match('.') || match('[') || match('(') || lookahead.type === Token.Template) {
+            if (match('(')) {
+                args = parseArguments();
+                expr = delegate.createCallExpression(expr, args);
+                marker.end();
+                marker.apply(expr);
+            } else if (match('[')) {
+                expr = delegate.createMemberExpression('[', expr, parseComputedMember());
+                marker.end();
+                marker.apply(expr);
+            } else if (match('.')) {
+                expr = delegate.createMemberExpression('.', expr, parseNonComputedMember());
+                marker.end();
+                marker.apply(expr);
+            } else {
+                expr = delegate.createTaggedTemplateExpression(expr, parseTemplateLiteral());
+                marker.end();
+                marker.apply(expr);
+            }
+        }
+
+        return expr;
+    }
+
+    function filterGroup(node) {
+        var n, i, entry;
+
+        n = (Object.prototype.toString.apply(node) === '[object Array]') ? [] : {};
+        for (i in node) {
+            if (node.hasOwnProperty(i) && i !== 'groupRange' && i !== 'groupLoc') {
+                entry = node[i];
+                if (entry === null || typeof entry !== 'object' || entry instanceof RegExp) {
+                    n[i] = entry;
+                } else {
+                    n[i] = filterGroup(entry);
+                }
+            }
+        }
+        return n;
+    }
+
+    function wrapTrackingFunction(range, loc, preserveWhitespace) {
+
+        return function (parseFunction) {
+
+            function isBinary(node) {
+                return node.type === Syntax.LogicalExpression ||
+                    node.type === Syntax.BinaryExpression;
+            }
+
+            function visit(node) {
+                var start, end;
+
+                if (isBinary(node.left)) {
+                    visit(node.left);
+                }
+                if (isBinary(node.right)) {
+                    visit(node.right);
+                }
+
+                if (range) {
+                    if (node.left.groupRange || node.right.groupRange) {
+                        start = node.left.groupRange ? node.left.groupRange[0] : node.left.range[0];
+                        end = node.right.groupRange ? node.right.groupRange[1] : node.right.range[1];
+                        node.range = [start, end];
+                    } else if (typeof node.range === 'undefined') {
+                        start = node.left.range[0];
+                        end = node.right.range[1];
+                        node.range = [start, end];
+                    }
+                }
+                if (loc) {
+                    if (node.left.groupLoc || node.right.groupLoc) {
+                        start = node.left.groupLoc ? node.left.groupLoc.start : node.left.loc.start;
+                        end = node.right.groupLoc ? node.right.groupLoc.end : node.right.loc.end;
+                        node.loc = {
+                            start: start,
+                            end: end
+                        };
+                        node = delegate.postProcess(node);
+                    } else if (typeof node.loc === 'undefined') {
+                        node.loc = {
+                            start: node.left.loc.start,
+                            end: node.right.loc.end
+                        };
+                        node = delegate.postProcess(node);
+                    }
+                }
+            }
+
+            return function () {
+                var marker, node;
+
+                if (!preserveWhitespace) {
+                    skipComment();
+                }
+
+                marker = createLocationMarker();
+                node = parseFunction.apply(null, arguments);
+                marker.end();
+
+                if (range && typeof node.range === 'undefined') {
+                    marker.apply(node);
+                }
+
+                if (loc && typeof node.loc === 'undefined') {
+                    marker.apply(node);
+                }
+
+                if (isBinary(node)) {
+                    visit(node);
+                }
+
+                return node;
+            };
+        };
+    }
+
+    function patch() {
+
+        var wrapTracking, wrapTrackingPreserveWhitespace;
+
+        if (extra.comments) {
+            extra.skipComment = skipComment;
+            skipComment = scanComment;
+        }
+
+        if (extra.range || extra.loc) {
+
+            extra.parseGroupExpression = parseGroupExpression;
+            extra.parseLeftHandSideExpression = parseLeftHandSideExpression;
+            extra.parseLeftHandSideExpressionAllowCall = parseLeftHandSideExpressionAllowCall;
+            parseGroupExpression = trackGroupExpression;
+            parseLeftHandSideExpression = trackLeftHandSideExpression;
+            parseLeftHandSideExpressionAllowCall = trackLeftHandSideExpressionAllowCall;
+
+            wrapTracking = wrapTrackingFunction(extra.range, extra.loc);
+            wrapTrackingPreserveWhitespace =
+                wrapTrackingFunction(extra.range, extra.loc, true);
+
+            extra.parseArrayInitialiser = parseArrayInitialiser;
+            extra.parseAssignmentExpression = parseAssignmentExpression;
+            extra.parseBinaryExpression = parseBinaryExpression;
+            extra.parseBlock = parseBlock;
+            extra.parseFunctionSourceElements = parseFunctionSourceElements;
+            extra.parseCatchClause = parseCatchClause;
+            extra.parseComputedMember = parseComputedMember;
+            extra.parseConditionalExpression = parseConditionalExpression;
+            extra.parseConstLetDeclaration = parseConstLetDeclaration;
+            extra.parseExportBatchSpecifier = parseExportBatchSpecifier;
+            extra.parseExportDeclaration = parseExportDeclaration;
+            extra.parseExportSpecifier = parseExportSpecifier;
+            extra.parseExpression = parseExpression;
+            extra.parseForVariableDeclaration = parseForVariableDeclaration;
+            extra.parseFunctionDeclaration = parseFunctionDeclaration;
+            extra.parseFunctionExpression = parseFunctionExpression;
+            extra.parseParams = parseParams;
+            extra.parseImportDeclaration = parseImportDeclaration;
+            extra.parseImportSpecifier = parseImportSpecifier;
+            extra.parseModuleDeclaration = parseModuleDeclaration;
+            extra.parseModuleBlock = parseModuleBlock;
+            extra.parseNewExpression = parseNewExpression;
+            extra.parseNonComputedProperty = parseNonComputedProperty;
+            extra.parseObjectInitialiser = parseObjectInitialiser;
+            extra.parseObjectProperty = parseObjectProperty;
+            extra.parseObjectPropertyKey = parseObjectPropertyKey;
+            extra.parsePostfixExpression = parsePostfixExpression;
+            extra.parsePrimaryExpression = parsePrimaryExpression;
+            extra.parseProgram = parseProgram;
+            extra.parsePropertyFunction = parsePropertyFunction;
+            extra.parseSpreadOrAssignmentExpression = parseSpreadOrAssignmentExpression;
+            extra.parseTemplateElement = parseTemplateElement;
+            extra.parseTemplateLiteral = parseTemplateLiteral;
+            extra.parseTypeAnnotatableIdentifier = parseTypeAnnotatableIdentifier;
+            extra.parseTypeAnnotation = parseTypeAnnotation;
+            extra.parseStatement = parseStatement;
+            extra.parseSwitchCase = parseSwitchCase;
+            extra.parseUnaryExpression = parseUnaryExpression;
+            extra.parseVariableDeclaration = parseVariableDeclaration;
+            extra.parseVariableIdentifier = parseVariableIdentifier;
+            extra.parseMethodDefinition = parseMethodDefinition;
+            extra.parseClassDeclaration = parseClassDeclaration;
+            extra.parseClassExpression = parseClassExpression;
+            extra.parseClassBody = parseClassBody;
+            extra.parseXJSIdentifier = parseXJSIdentifier;
+            extra.parseXJSChild = parseXJSChild;
+            extra.parseXJSAttribute = parseXJSAttribute;
+            extra.parseXJSAttributeValue = parseXJSAttributeValue;
+            extra.parseXJSExpressionContainer = parseXJSExpressionContainer;
+            extra.parseXJSEmptyExpression = parseXJSEmptyExpression;
+            extra.parseXJSElement = parseXJSElement;
+            extra.parseXJSClosingElement = parseXJSClosingElement;
+            extra.parseXJSOpeningElement = parseXJSOpeningElement;
+
+            parseArrayInitialiser = wrapTracking(extra.parseArrayInitialiser);
+            parseAssignmentExpression = wrapTracking(extra.parseAssignmentExpression);
+            parseBinaryExpression = wrapTracking(extra.parseBinaryExpression);
+            parseBlock = wrapTracking(extra.parseBlock);
+            parseFunctionSourceElements = wrapTracking(extra.parseFunctionSourceElements);
+            parseCatchClause = wrapTracking(extra.parseCatchClause);
+            parseComputedMember = wrapTracking(extra.parseComputedMember);
+            parseConditionalExpression = wrapTracking(extra.parseConditionalExpression);
+            parseConstLetDeclaration = wrapTracking(extra.parseConstLetDeclaration);
+            parseExportBatchSpecifier = wrapTracking(parseExportBatchSpecifier);
+            parseExportDeclaration = wrapTracking(parseExportDeclaration);
+            parseExportSpecifier = wrapTracking(parseExportSpecifier);
+            parseExpression = wrapTracking(extra.parseExpression);
+            parseForVariableDeclaration = wrapTracking(extra.parseForVariableDeclaration);
+            parseFunctionDeclaration = wrapTracking(extra.parseFunctionDeclaration);
+            parseFunctionExpression = wrapTracking(extra.parseFunctionExpression);
+            parseParams = wrapTracking(extra.parseParams);
+            parseImportDeclaration = wrapTracking(extra.parseImportDeclaration);
+            parseImportSpecifier = wrapTracking(extra.parseImportSpecifier);
+            parseModuleDeclaration = wrapTracking(extra.parseModuleDeclaration);
+            parseModuleBlock = wrapTracking(extra.parseModuleBlock);
+            parseLeftHandSideExpression = wrapTracking(parseLeftHandSideExpression);
+            parseNewExpression = wrapTracking(extra.parseNewExpression);
+            parseNonComputedProperty = wrapTracking(extra.parseNonComputedProperty);
+            parseObjectInitialiser = wrapTracking(extra.parseObjectInitialiser);
+            parseObjectProperty = wrapTracking(extra.parseObjectProperty);
+            parseObjectPropertyKey = wrapTracking(extra.parseObjectPropertyKey);
+            parsePostfixExpression = wrapTracking(extra.parsePostfixExpression);
+            parsePrimaryExpression = wrapTracking(extra.parsePrimaryExpression);
+            parseProgram = wrapTracking(extra.parseProgram);
+            parsePropertyFunction = wrapTracking(extra.parsePropertyFunction);
+            parseTemplateElement = wrapTracking(extra.parseTemplateElement);
+            parseTemplateLiteral = wrapTracking(extra.parseTemplateLiteral);
+            parseTypeAnnotatableIdentifier = wrapTracking(extra.parseTypeAnnotatableIdentifier);
+            parseTypeAnnotation = wrapTracking(extra.parseTypeAnnotation);
+            parseSpreadOrAssignmentExpression = wrapTracking(extra.parseSpreadOrAssignmentExpression);
+            parseStatement = wrapTracking(extra.parseStatement);
+            parseSwitchCase = wrapTracking(extra.parseSwitchCase);
+            parseUnaryExpression = wrapTracking(extra.parseUnaryExpression);
+            parseVariableDeclaration = wrapTracking(extra.parseVariableDeclaration);
+            parseVariableIdentifier = wrapTracking(extra.parseVariableIdentifier);
+            parseMethodDefinition = wrapTracking(extra.parseMethodDefinition);
+            parseClassDeclaration = wrapTracking(extra.parseClassDeclaration);
+            parseClassExpression = wrapTracking(extra.parseClassExpression);
+            parseClassBody = wrapTracking(extra.parseClassBody);
+            parseXJSIdentifier = wrapTracking(extra.parseXJSIdentifier);
+            parseXJSChild = wrapTrackingPreserveWhitespace(extra.parseXJSChild);
+            parseXJSAttribute = wrapTracking(extra.parseXJSAttribute);
+            parseXJSAttributeValue = wrapTracking(extra.parseXJSAttributeValue);
+            parseXJSExpressionContainer = wrapTracking(extra.parseXJSExpressionContainer);
+            parseXJSEmptyExpression = wrapTrackingPreserveWhitespace(extra.parseXJSEmptyExpression);
+            parseXJSElement = wrapTracking(extra.parseXJSElement);
+            parseXJSClosingElement = wrapTracking(extra.parseXJSClosingElement);
+            parseXJSOpeningElement = wrapTracking(extra.parseXJSOpeningElement);
+        }
+
+        if (typeof extra.tokens !== 'undefined') {
+            extra.advance = advance;
+            extra.scanRegExp = scanRegExp;
+
+            advance = collectToken;
+            scanRegExp = collectRegex;
+        }
+    }
+
+    function unpatch() {
+        if (typeof extra.skipComment === 'function') {
+            skipComment = extra.skipComment;
+        }
+
+        if (extra.range || extra.loc) {
+            parseArrayInitialiser = extra.parseArrayInitialiser;
+            parseAssignmentExpression = extra.parseAssignmentExpression;
+            parseBinaryExpression = extra.parseBinaryExpression;
+            parseBlock = extra.parseBlock;
+            parseFunctionSourceElements = extra.parseFunctionSourceElements;
+            parseCatchClause = extra.parseCatchClause;
+            parseComputedMember = extra.parseComputedMember;
+            parseConditionalExpression = extra.parseConditionalExpression;
+            parseConstLetDeclaration = extra.parseConstLetDeclaration;
+            parseExportBatchSpecifier = extra.parseExportBatchSpecifier;
+            parseExportDeclaration = extra.parseExportDeclaration;
+            parseExportSpecifier = extra.parseExportSpecifier;
+            parseExpression = extra.parseExpression;
+            parseForVariableDeclaration = extra.parseForVariableDeclaration;
+            parseFunctionDeclaration = extra.parseFunctionDeclaration;
+            parseFunctionExpression = extra.parseFunctionExpression;
+            parseImportDeclaration = extra.parseImportDeclaration;
+            parseImportSpecifier = extra.parseImportSpecifier;
+            parseGroupExpression = extra.parseGroupExpression;
+            parseLeftHandSideExpression = extra.parseLeftHandSideExpression;
+            parseLeftHandSideExpressionAllowCall = extra.parseLeftHandSideExpressionAllowCall;
+            parseModuleDeclaration = extra.parseModuleDeclaration;
+            parseModuleBlock = extra.parseModuleBlock;
+            parseNewExpression = extra.parseNewExpression;
+            parseNonComputedProperty = extra.parseNonComputedProperty;
+            parseObjectInitialiser = extra.parseObjectInitialiser;
+            parseObjectProperty = extra.parseObjectProperty;
+            parseObjectPropertyKey = extra.parseObjectPropertyKey;
+            parsePostfixExpression = extra.parsePostfixExpression;
+            parsePrimaryExpression = extra.parsePrimaryExpression;
+            parseProgram = extra.parseProgram;
+            parsePropertyFunction = extra.parsePropertyFunction;
+            parseTemplateElement = extra.parseTemplateElement;
+            parseTemplateLiteral = extra.parseTemplateLiteral;
+            parseTypeAnnotatableIdentifier = extra.parseTypeAnnotatableIdentifier;
+            parseTypeAnnotation = extra.parseTypeAnnotation;
+            parseSpreadOrAssignmentExpression = extra.parseSpreadOrAssignmentExpression;
+            parseStatement = extra.parseStatement;
+            parseSwitchCase = extra.parseSwitchCase;
+            parseUnaryExpression = extra.parseUnaryExpression;
+            parseVariableDeclaration = extra.parseVariableDeclaration;
+            parseVariableIdentifier = extra.parseVariableIdentifier;
+            parseMethodDefinition = extra.parseMethodDefinition;
+            parseClassDeclaration = extra.parseClassDeclaration;
+            parseClassExpression = extra.parseClassExpression;
+            parseClassBody = extra.parseClassBody;
+            parseXJSIdentifier = extra.parseXJSIdentifier;
+            parseXJSChild = extra.parseXJSChild;
+            parseXJSAttribute = extra.parseXJSAttribute;
+            parseXJSAttributeValue = extra.parseXJSAttributeValue;
+            parseXJSExpressionContainer = extra.parseXJSExpressionContainer;
+            parseXJSEmptyExpression = extra.parseXJSEmptyExpression;
+            parseXJSElement = extra.parseXJSElement;
+            parseXJSClosingElement = extra.parseXJSClosingElement;
+            parseXJSOpeningElement = extra.parseXJSOpeningElement;
+        }
+
+        if (typeof extra.scanRegExp === 'function') {
+            advance = extra.advance;
+            scanRegExp = extra.scanRegExp;
+        }
+    }
+
+    // This is used to modify the delegate.
+
+    function extend(object, properties) {
+        var entry, result = {};
+
+        for (entry in object) {
+            if (object.hasOwnProperty(entry)) {
+                result[entry] = object[entry];
+            }
+        }
+
+        for (entry in properties) {
+            if (properties.hasOwnProperty(entry)) {
+                result[entry] = properties[entry];
+            }
+        }
+
+        return result;
+    }
+
+    function tokenize(code, options) {
+        var toString,
+            token,
+            tokens;
+
+        toString = String;
+        if (typeof code !== 'string' && !(code instanceof String)) {
+            code = toString(code);
+        }
+
+        delegate = SyntaxTreeDelegate;
+        source = code;
+        index = 0;
+        lineNumber = (source.length > 0) ? 1 : 0;
+        lineStart = 0;
+        length = source.length;
+        lookahead = null;
+        state = {
+            allowKeyword: true,
+            allowIn: true,
+            labelSet: {},
+            inFunctionBody: false,
+            inIteration: false,
+            inSwitch: false
+        };
+
+        extra = {};
+
+        // Options matching.
+        options = options || {};
+
+        // Of course we collect tokens here.
+        options.tokens = true;
+        extra.tokens = [];
+        extra.tokenize = true;
+        // The following two fields are necessary to compute the Regex tokens.
+        extra.openParenToken = -1;
+        extra.openCurlyToken = -1;
+
+        extra.range = (typeof options.range === 'boolean') && options.range;
+        extra.loc = (typeof options.loc === 'boolean') && options.loc;
+
+        if (typeof options.comment === 'boolean' && options.comment) {
+            extra.comments = [];
+        }
+        if (typeof options.tolerant === 'boolean' && options.tolerant) {
+            extra.errors = [];
+        }
+
+        if (length > 0) {
+            if (typeof source[0] === 'undefined') {
+                // Try first to convert to a string. This is good as fast path
+                // for old IE which understands string indexing for string
+                // literals only and not for string object.
+                if (code instanceof String) {
+                    source = code.valueOf();
+                }
+            }
+        }
+
+        patch();
+
+        try {
+            peek();
+            if (lookahead.type === Token.EOF) {
+                return extra.tokens;
+            }
+
+            token = lex();
+            while (lookahead.type !== Token.EOF) {
+                try {
+                    token = lex();
+                } catch (lexError) {
+                    token = lookahead;
+                    if (extra.errors) {
+                        extra.errors.push(lexError);
+                        // We have to break on the first error
+                        // to avoid infinite loops.
+                        break;
+                    } else {
+                        throw lexError;
+                    }
+                }
+            }
+
+            filterTokenLocation();
+            tokens = extra.tokens;
+            if (typeof extra.comments !== 'undefined') {
+                filterCommentLocation();
+                tokens.comments = extra.comments;
+            }
+            if (typeof extra.errors !== 'undefined') {
+                tokens.errors = extra.errors;
+            }
+        } catch (e) {
+            throw e;
+        } finally {
+            unpatch();
+            extra = {};
+        }
+        return tokens;
+    }
+
+    function parse(code, options) {
+        var program, toString;
+
+        toString = String;
+        if (typeof code !== 'string' && !(code instanceof String)) {
+            code = toString(code);
+        }
+
+        delegate = SyntaxTreeDelegate;
+        source = code;
+        index = 0;
+        lineNumber = (source.length > 0) ? 1 : 0;
+        lineStart = 0;
+        length = source.length;
+        lookahead = null;
+        state = {
+            allowKeyword: false,
+            allowIn: true,
+            labelSet: {},
+            parenthesizedCount: 0,
+            inFunctionBody: false,
+            inIteration: false,
+            inSwitch: false,
+            inXJSChild: false,
+            inXJSTag: false,
+            yieldAllowed: false,
+            yieldFound: false
+        };
+
+        extra = {};
+        if (typeof options !== 'undefined') {
+            extra.range = (typeof options.range === 'boolean') && options.range;
+            extra.loc = (typeof options.loc === 'boolean') && options.loc;
+
+            if (extra.loc && options.source !== null && options.source !== undefined) {
+                delegate = extend(delegate, {
+                    'postProcess': function (node) {
+                        node.loc.source = toString(options.source);
+                        return node;
+                    }
+                });
+            }
+
+            if (typeof options.tokens === 'boolean' && options.tokens) {
+                extra.tokens = [];
+            }
+            if (typeof options.comment === 'boolean' && options.comment) {
+                extra.comments = [];
+            }
+            if (typeof options.tolerant === 'boolean' && options.tolerant) {
+                extra.errors = [];
+            }
+        }
+
+        if (length > 0) {
+            if (typeof source[0] === 'undefined') {
+                // Try first to convert to a string. This is good as fast path
+                // for old IE which understands string indexing for string
+                // literals only and not for string object.
+                if (code instanceof String) {
+                    source = code.valueOf();
+                }
+            }
+        }
+
+        patch();
+        try {
+            program = parseProgram();
+            if (typeof extra.comments !== 'undefined') {
+                filterCommentLocation();
+                program.comments = extra.comments;
+            }
+            if (typeof extra.tokens !== 'undefined') {
+                filterTokenLocation();
+                program.tokens = extra.tokens;
+            }
+            if (typeof extra.errors !== 'undefined') {
+                program.errors = extra.errors;
+            }
+            if (extra.range || extra.loc) {
+                program.body = filterGroup(program.body);
+            }
+        } catch (e) {
+            throw e;
+        } finally {
+            unpatch();
+            extra = {};
+        }
+
+        return program;
+    }
+
+    // Sync with *.json manifests.
+    exports.version = '1.1.0-dev-harmony';
+
+    exports.tokenize = tokenize;
+
+    exports.parse = parse;
+
+    // Deep copy.
+    exports.Syntax = (function () {
+        var name, types = {};
+
+        if (typeof Object.create === 'function') {
+            types = Object.create(null);
+        }
+
+        for (name in Syntax) {
+            if (Syntax.hasOwnProperty(name)) {
+                types[name] = Syntax[name];
+            }
+        }
+
+        if (typeof Object.freeze === 'function') {
+            Object.freeze(types);
+        }
+
+        return types;
+    }());
+
+}));
+/* vim: set sw=4 ts=4 et tw=80 : */
+
+},{}],7:[function(_dereq_,module,exports){
+var Base62 = (function (my) {
+  my.chars = ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z", "A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"]
+
+  my.encode = function(i){
+    if (i === 0) {return '0'}
+    var s = ''
+    while (i > 0) {
+      s = this.chars[i % 62] + s
+      i = Math.floor(i/62)
+    }
+    return s
+  };
+  my.decode = function(a,b,c,d){
+    for (
+      b = c = (
+        a === (/\W|_|^$/.test(a += "") || a)
+      ) - 1;
+      d = a.charCodeAt(c++);
+    )
+    b = b * 62 + d - [, 48, 29, 87][d >> 5];
+    return b
+  };
+
+  return my;
+}({}));
+
+module.exports = Base62
+},{}],8:[function(_dereq_,module,exports){
+/*
+ * Copyright 2009-2011 Mozilla Foundation and contributors
+ * Licensed under the New BSD license. See LICENSE.txt or:
+ * http://opensource.org/licenses/BSD-3-Clause
+ */
+exports.SourceMapGenerator = _dereq_('./source-map/source-map-generator').SourceMapGenerator;
+exports.SourceMapConsumer = _dereq_('./source-map/source-map-consumer').SourceMapConsumer;
+exports.SourceNode = _dereq_('./source-map/source-node').SourceNode;
+
+},{"./source-map/source-map-consumer":13,"./source-map/source-map-generator":14,"./source-map/source-node":15}],9:[function(_dereq_,module,exports){
+/* -*- Mode: js; js-indent-level: 2; -*- */
+/*
+ * Copyright 2011 Mozilla Foundation and contributors
+ * Licensed under the New BSD license. See LICENSE or:
+ * http://opensource.org/licenses/BSD-3-Clause
+ */
+if (typeof define !== 'function') {
+    var define = _dereq_('amdefine')(module, _dereq_);
+}
+define(function (_dereq_, exports, module) {
+
+  var util = _dereq_('./util');
+
+  /**
+   * A data structure which is a combination of an array and a set. Adding a new
+   * member is O(1), testing for membership is O(1), and finding the index of an
+   * element is O(1). Removing elements from the set is not supported. Only
+   * strings are supported for membership.
+   */
+  function ArraySet() {
+    this._array = [];
+    this._set = {};
+  }
+
+  /**
+   * Static method for creating ArraySet instances from an existing array.
+   */
+  ArraySet.fromArray = function ArraySet_fromArray(aArray, aAllowDuplicates) {
+    var set = new ArraySet();
+    for (var i = 0, len = aArray.length; i < len; i++) {
+      set.add(aArray[i], aAllowDuplicates);
+    }
+    return set;
+  };
+
+  /**
+   * Add the given string to this set.
+   *
+   * @param String aStr
+   */
+  ArraySet.prototype.add = function ArraySet_add(aStr, aAllowDuplicates) {
+    var isDuplicate = this.has(aStr);
+    var idx = this._array.length;
+    if (!isDuplicate || aAllowDuplicates) {
+      this._array.push(aStr);
+    }
+    if (!isDuplicate) {
+      this._set[util.toSetString(aStr)] = idx;
+    }
+  };
+
+  /**
+   * Is the given string a member of this set?
+   *
+   * @param String aStr
+   */
+  ArraySet.prototype.has = function ArraySet_has(aStr) {
+    return Object.prototype.hasOwnProperty.call(this._set,
+                                                util.toSetString(aStr));
+  };
+
+  /**
+   * What is the index of the given string in the array?
+   *
+   * @param String aStr
+   */
+  ArraySet.prototype.indexOf = function ArraySet_indexOf(aStr) {
+    if (this.has(aStr)) {
+      return this._set[util.toSetString(aStr)];
+    }
+    throw new Error('"' + aStr + '" is not in the set.');
+  };
+
+  /**
+   * What is the element at the given index?
+   *
+   * @param Number aIdx
+   */
+  ArraySet.prototype.at = function ArraySet_at(aIdx) {
+    if (aIdx >= 0 && aIdx < this._array.length) {
+      return this._array[aIdx];
+    }
+    throw new Error('No element indexed by ' + aIdx);
+  };
+
+  /**
+   * Returns the array representation of this set (which has the proper indices
+   * indicated by indexOf). Note that this is a copy of the internal array used
+   * for storing the members so that no one can mess with internal state.
+   */
+  ArraySet.prototype.toArray = function ArraySet_toArray() {
+    return this._array.slice();
+  };
+
+  exports.ArraySet = ArraySet;
+
+});
+
+},{"./util":16,"amdefine":17}],10:[function(_dereq_,module,exports){
+/* -*- Mode: js; js-indent-level: 2; -*- */
+/*
+ * Copyright 2011 Mozilla Foundation and contributors
+ * Licensed under the New BSD license. See LICENSE or:
+ * http://opensource.org/licenses/BSD-3-Clause
+ *
+ * Based on the Base 64 VLQ implementation in Closure Compiler:
+ * https://code.google.com/p/closure-compiler/source/browse/trunk/src/com/google/debugging/sourcemap/Base64VLQ.java
+ *
+ * Copyright 2011 The Closure Compiler Authors. All rights reserved.
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions are
+ * met:
+ *
+ *  * Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ *  * Redistributions in binary form must reproduce the above
+ *    copyright notice, this list of conditions and the following
+ *    disclaimer in the documentation and/or other materials provided
+ *    with the distribution.
+ *  * Neither the name of Google Inc. nor the names of its
+ *    contributors may be used to endorse or promote products derived
+ *    from this software without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
+ * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
+ * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
+ * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
+ * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
+ * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
+ * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
+ * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
+ * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+ */
+if (typeof define !== 'function') {
+    var define = _dereq_('amdefine')(module, _dereq_);
+}
+define(function (_dereq_, exports, module) {
+
+  var base64 = _dereq_('./base64');
+
+  // A single base 64 digit can contain 6 bits of data. For the base 64 variable
+  // length quantities we use in the source map spec, the first bit is the sign,
+  // the next four bits are the actual value, and the 6th bit is the
+  // continuation bit. The continuation bit tells us whether there are more
+  // digits in this value following this digit.
+  //
+  //   Continuation
+  //   |    Sign
+  //   |    |
+  //   V    V
+  //   101011
+
+  var VLQ_BASE_SHIFT = 5;
+
+  // binary: 100000
+  var VLQ_BASE = 1 << VLQ_BASE_SHIFT;
+
+  // binary: 011111
+  var VLQ_BASE_MASK = VLQ_BASE - 1;
+
+  // binary: 100000
+  var VLQ_CONTINUATION_BIT = VLQ_BASE;
+
+  /**
+   * Converts from a two-complement value to a value where the sign bit is
+   * is placed in the least significant bit.  For example, as decimals:
+   *   1 becomes 2 (10 binary), -1 becomes 3 (11 binary)
+   *   2 becomes 4 (100 binary), -2 becomes 5 (101 binary)
+   */
+  function toVLQSigned(aValue) {
+    return aValue < 0
+      ? ((-aValue) << 1) + 1
+      : (aValue << 1) + 0;
+  }
+
+  /**
+   * Converts to a two-complement value from a value where the sign bit is
+   * is placed in the least significant bit.  For example, as decimals:
+   *   2 (10 binary) becomes 1, 3 (11 binary) becomes -1
+   *   4 (100 binary) becomes 2, 5 (101 binary) becomes -2
+   */
+  function fromVLQSigned(aValue) {
+    var isNegative = (aValue & 1) === 1;
+    var shifted = aValue >> 1;
+    return isNegative
+      ? -shifted
+      : shifted;
+  }
+
+  /**
+   * Returns the base 64 VLQ encoded value.
+   */
+  exports.encode = function base64VLQ_encode(aValue) {
+    var encoded = "";
+    var digit;
+
+    var vlq = toVLQSigned(aValue);
+
+    do {
+      digit = vlq & VLQ_BASE_MASK;
+      vlq >>>= VLQ_BASE_SHIFT;
+      if (vlq > 0) {
+        // There are still more digits in this value, so we must make sure the
+        // continuation bit is marked.
+        digit |= VLQ_CONTINUATION_BIT;
+      }
+      encoded += base64.encode(digit);
+    } while (vlq > 0);
+
+    return encoded;
+  };
+
+  /**
+   * Decodes the next base 64 VLQ value from the given string and returns the
+   * value and the rest of the string.
+   */
+  exports.decode = function base64VLQ_decode(aStr) {
+    var i = 0;
+    var strLen = aStr.length;
+    var result = 0;
+    var shift = 0;
+    var continuation, digit;
+
+    do {
+      if (i >= strLen) {
+        throw new Error("Expected more digits in base 64 VLQ value.");
+      }
+      digit = base64.decode(aStr.charAt(i++));
+      continuation = !!(digit & VLQ_CONTINUATION_BIT);
+      digit &= VLQ_BASE_MASK;
+      result = result + (digit << shift);
+      shift += VLQ_BASE_SHIFT;
+    } while (continuation);
+
+    return {
+      value: fromVLQSigned(result),
+      rest: aStr.slice(i)
+    };
+  };
+
+});
+
+},{"./base64":11,"amdefine":17}],11:[function(_dereq_,module,exports){
+/* -*- Mode: js; js-indent-level: 2; -*- */
+/*
+ * Copyright 2011 Mozilla Foundation and contributors
+ * Licensed under the New BSD license. See LICENSE or:
+ * http://opensource.org/licenses/BSD-3-Clause
+ */
+if (typeof define !== 'function') {
+    var define = _dereq_('amdefine')(module, _dereq_);
+}
+define(function (_dereq_, exports, module) {
+
+  var charToIntMap = {};
+  var intToCharMap = {};
+
+  'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
+    .split('')
+    .forEach(function (ch, index) {
+      charToIntMap[ch] = index;
+      intToCharMap[index] = ch;
+    });
+
+  /**
+   * Encode an integer in the range of 0 to 63 to a single base 64 digit.
+   */
+  exports.encode = function base64_encode(aNumber) {
+    if (aNumber in intToCharMap) {
+      return intToCharMap[aNumber];
+    }
+    throw new TypeError("Must be between 0 and 63: " + aNumber);
+  };
+
+  /**
+   * Decode a single base 64 digit to an integer.
+   */
+  exports.decode = function base64_decode(aChar) {
+    if (aChar in charToIntMap) {
+      return charToIntMap[aChar];
+    }
+    throw new TypeError("Not a valid base 64 digit: " + aChar);
+  };
+
+});
+
+},{"amdefine":17}],12:[function(_dereq_,module,exports){
+/* -*- Mode: js; js-indent-level: 2; -*- */
+/*
+ * Copyright 2011 Mozilla Foundation and contributors
+ * Licensed under the New BSD license. See LICENSE or:
+ * http://opensource.org/licenses/BSD-3-Clause
+ */
+if (typeof define !== 'function') {
+    var define = _dereq_('amdefine')(module, _dereq_);
+}
+define(function (_dereq_, exports, module) {
+
+  /**
+   * Recursive implementation of binary search.
+   *
+   * @param aLow Indices here and lower do not contain the needle.
+   * @param aHigh Indices here and higher do not contain the needle.
+   * @param aNeedle The element being searched for.
+   * @param aHaystack The non-empty array being searched.
+   * @param aCompare Function which takes two elements and returns -1, 0, or 1.
+   */
+  function recursiveSearch(aLow, aHigh, aNeedle, aHaystack, aCompare) {
+    // This function terminates when one of the following is true:
+    //
+    //   1. We find the exact element we are looking for.
+    //
+    //   2. We did not find the exact element, but we can return the next
+    //      closest element that is less than that element.
+    //
+    //   3. We did not find the exact element, and there is no next-closest
+    //      element which is less than the one we are searching for, so we
+    //      return null.
+    var mid = Math.floor((aHigh - aLow) / 2) + aLow;
+    var cmp = aCompare(aNeedle, aHaystack[mid], true);
+    if (cmp === 0) {
+      // Found the element we are looking for.
+      return aHaystack[mid];
+    }
+    else if (cmp > 0) {
+      // aHaystack[mid] is greater than our needle.
+      if (aHigh - mid > 1) {
+        // The element is in the upper half.
+        return recursiveSearch(mid, aHigh, aNeedle, aHaystack, aCompare);
+      }
+      // We did not find an exact match, return the next closest one
+      // (termination case 2).
+      return aHaystack[mid];
+    }
+    else {
+      // aHaystack[mid] is less than our needle.
+      if (mid - aLow > 1) {
+        // The element is in the lower half.
+        return recursiveSearch(aLow, mid, aNeedle, aHaystack, aCompare);
+      }
+      // The exact needle element was not found in this haystack. Determine if
+      // we are in termination case (2) or (3) and return the appropriate thing.
+      return aLow < 0
+        ? null
+        : aHaystack[aLow];
+    }
+  }
+
+  /**
+   * This is an implementation of binary search which will always try and return
+   * the next lowest value checked if there is no exact hit. This is because
+   * mappings between original and generated line/col pairs are single points,
+   * and there is an implicit region between each of them, so a miss just means
+   * that you aren't on the very start of a region.
+   *
+   * @param aNeedle The element you are looking for.
+   * @param aHaystack The array that is being searched.
+   * @param aCompare A function which takes the needle and an element in the
+   *     array and returns -1, 0, or 1 depending on whether the needle is less
+   *     than, equal to, or greater than the element, respectively.
+   */
+  exports.search = function search(aNeedle, aHaystack, aCompare) {
+    return aHaystack.length > 0
+      ? recursiveSearch(-1, aHaystack.length, aNeedle, aHaystack, aCompare)
+      : null;
+  };
+
+});
+
+},{"amdefine":17}],13:[function(_dereq_,module,exports){
+/* -*- Mode: js; js-indent-level: 2; -*- */
+/*
+ * Copyright 2011 Mozilla Foundation and contributors
+ * Licensed under the New BSD license. See LICENSE or:
+ * http://opensource.org/licenses/BSD-3-Clause
+ */
+if (typeof define !== 'function') {
+    var define = _dereq_('amdefine')(module, _dereq_);
+}
+define(function (_dereq_, exports, module) {
+
+  var util = _dereq_('./util');
+  var binarySearch = _dereq_('./binary-search');
+  var ArraySet = _dereq_('./array-set').ArraySet;
+  var base64VLQ = _dereq_('./base64-vlq');
+
+  /**
+   * A SourceMapConsumer instance represents a parsed source map which we can
+   * query for information about the original file positions by giving it a file
+   * position in the generated source.
+   *
+   * The only parameter is the raw source map (either as a JSON string, or
+   * already parsed to an object). According to the spec, source maps have the
+   * following attributes:
+   *
+   *   - version: Which version of the source map spec this map is following.
+   *   - sources: An array of URLs to the original source files.
+   *   - names: An array of identifiers which can be referrenced by individual mappings.
+   *   - sourceRoot: Optional. The URL root from which all sources are relative.
+   *   - sourcesContent: Optional. An array of contents of the original source files.
+   *   - mappings: A string of base64 VLQs which contain the actual mappings.
+   *   - file: The generated file this source map is associated with.
+   *
+   * Here is an example source map, taken from the source map spec[0]:
+   *
+   *     {
+   *       version : 3,
+   *       file: "out.js",
+   *       sourceRoot : "",
+   *       sources: ["foo.js", "bar.js"],
+   *       names: ["src", "maps", "are", "fun"],
+   *       mappings: "AA,AB;;ABCDE;"
+   *     }
+   *
+   * [0]: https://docs.google.com/document/d/1U1RGAehQwRypUTovF1KRlpiOFze0b-_2gc6fAH0KY0k/edit?pli=1#
+   */
+  function SourceMapConsumer(aSourceMap) {
+    var sourceMap = aSourceMap;
+    if (typeof aSourceMap === 'string') {
+      sourceMap = JSON.parse(aSourceMap.replace(/^\)\]\}'/, ''));
+    }
+
+    var version = util.getArg(sourceMap, 'version');
+    var sources = util.getArg(sourceMap, 'sources');
+    // Sass 3.3 leaves out the 'names' array, so we deviate from the spec (which
+    // requires the array) to play nice here.
+    var names = util.getArg(sourceMap, 'names', []);
+    var sourceRoot = util.getArg(sourceMap, 'sourceRoot', null);
+    var sourcesContent = util.getArg(sourceMap, 'sourcesContent', null);
+    var mappings = util.getArg(sourceMap, 'mappings');
+    var file = util.getArg(sourceMap, 'file', null);
+
+    // Once again, Sass deviates from the spec and supplies the version as a
+    // string rather than a number, so we use loose equality checking here.
+    if (version != this._version) {
+      throw new Error('Unsupported version: ' + version);
+    }
+
+    // Pass `true` below to allow duplicate names and sources. While source maps
+    // are intended to be compressed and deduplicated, the TypeScript compiler
+    // sometimes generates source maps with duplicates in them. See Github issue
+    // #72 and bugzil.la/889492.
+    this._names = ArraySet.fromArray(names, true);
+    this._sources = ArraySet.fromArray(sources, true);
+
+    this.sourceRoot = sourceRoot;
+    this.sourcesContent = sourcesContent;
+    this._mappings = mappings;
+    this.file = file;
+  }
+
+  /**
+   * Create a SourceMapConsumer from a SourceMapGenerator.
+   *
+   * @param SourceMapGenerator aSourceMap
+   *        The source map that will be consumed.
+   * @returns SourceMapConsumer
+   */
+  SourceMapConsumer.fromSourceMap =
+    function SourceMapConsumer_fromSourceMap(aSourceMap) {
+      var smc = Object.create(SourceMapConsumer.prototype);
+
+      smc._names = ArraySet.fromArray(aSourceMap._names.toArray(), true);
+      smc._sources = ArraySet.fromArray(aSourceMap._sources.toArray(), true);
+      smc.sourceRoot = aSourceMap._sourceRoot;
+      smc.sourcesContent = aSourceMap._generateSourcesContent(smc._sources.toArray(),
+                                                              smc.sourceRoot);
+      smc.file = aSourceMap._file;
+
+      smc.__generatedMappings = aSourceMap._mappings.slice()
+        .sort(util.compareByGeneratedPositions);
+      smc.__originalMappings = aSourceMap._mappings.slice()
+        .sort(util.compareByOriginalPositions);
+
+      return smc;
+    };
+
+  /**
+   * The version of the source mapping spec that we are consuming.
+   */
+  SourceMapConsumer.prototype._version = 3;
+
+  /**
+   * The list of original sources.
+   */
+  Object.defineProperty(SourceMapConsumer.prototype, 'sources', {
+    get: function () {
+      return this._sources.toArray().map(function (s) {
+        return this.sourceRoot ? util.join(this.sourceRoot, s) : s;
+      }, this);
+    }
+  });
+
+  // `__generatedMappings` and `__originalMappings` are arrays that hold the
+  // parsed mapping coordinates from the source map's "mappings" attribute. They
+  // are lazily instantiated, accessed via the `_generatedMappings` and
+  // `_originalMappings` getters respectively, and we only parse the mappings
+  // and create these arrays once queried for a source location. We jump through
+  // these hoops because there can be many thousands of mappings, and parsing
+  // them is expensive, so we only want to do it if we must.
+  //
+  // Each object in the arrays is of the form:
+  //
+  //     {
+  //       generatedLine: The line number in the generated code,
+  //       generatedColumn: The column number in the generated code,
+  //       source: The path to the original source file that generated this
+  //               chunk of code,
+  //       originalLine: The line number in the original source that
+  //                     corresponds to this chunk of generated code,
+  //       originalColumn: The column number in the original source that
+  //                       corresponds to this chunk of generated code,
+  //       name: The name of the original symbol which generated this chunk of
+  //             code.
+  //     }
+  //
+  // All properties except for `generatedLine` and `generatedColumn` can be
+  // `null`.
+  //
+  // `_generatedMappings` is ordered by the generated positions.
+  //
+  // `_originalMappings` is ordered by the original positions.
+
+  SourceMapConsumer.prototype.__generatedMappings = null;
+  Object.defineProperty(SourceMapConsumer.prototype, '_generatedMappings', {
+    get: function () {
+      if (!this.__generatedMappings) {
+        this.__generatedMappings = [];
+        this.__originalMappings = [];
+        this._parseMappings(this._mappings, this.sourceRoot);
+      }
+
+      return this.__generatedMappings;
+    }
+  });
+
+  SourceMapConsumer.prototype.__originalMappings = null;
+  Object.defineProperty(SourceMapConsumer.prototype, '_originalMappings', {
+    get: function () {
+      if (!this.__originalMappings) {
+        this.__generatedMappings = [];
+        this.__originalMappings = [];
+        this._parseMappings(this._mappings, this.sourceRoot);
+      }
+
+      return this.__originalMappings;
+    }
+  });
+
+  /**
+   * Parse the mappings in a string in to a data structure which we can easily
+   * query (the ordered arrays in the `this.__generatedMappings` and
+   * `this.__originalMappings` properties).
+   */
+  SourceMapConsumer.prototype._parseMappings =
+    function SourceMapConsumer_parseMappings(aStr, aSourceRoot) {
+      var generatedLine = 1;
+      var previousGeneratedColumn = 0;
+      var previousOriginalLine = 0;
+      var previousOriginalColumn = 0;
+      var previousSource = 0;
+      var previousName = 0;
+      var mappingSeparator = /^[,;]/;
+      var str = aStr;
+      var mapping;
+      var temp;
+
+      while (str.length > 0) {
+        if (str.charAt(0) === ';') {
+          generatedLine++;
+          str = str.slice(1);
+          previousGeneratedColumn = 0;
+        }
+        else if (str.charAt(0) === ',') {
+          str = str.slice(1);
+        }
+        else {
+          mapping = {};
+          mapping.generatedLine = generatedLine;
+
+          // Generated column.
+          temp = base64VLQ.decode(str);
+          mapping.generatedColumn = previousGeneratedColumn + temp.value;
+          previousGeneratedColumn = mapping.generatedColumn;
+          str = temp.rest;
+
+          if (str.length > 0 && !mappingSeparator.test(str.charAt(0))) {
+            // Original source.
+            temp = base64VLQ.decode(str);
+            mapping.source = this._sources.at(previousSource + temp.value);
+            previousSource += temp.value;
+            str = temp.rest;
+            if (str.length === 0 || mappingSeparator.test(str.charAt(0))) {
+              throw new Error('Found a source, but no line and column');
+            }
+
+            // Original line.
+            temp = base64VLQ.decode(str);
+            mapping.originalLine = previousOriginalLine + temp.value;
+            previousOriginalLine = mapping.originalLine;
+            // Lines are stored 0-based
+            mapping.originalLine += 1;
+            str = temp.rest;
+            if (str.length === 0 || mappingSeparator.test(str.charAt(0))) {
+              throw new Error('Found a source and line, but no column');
+            }
+
+            // Original column.
+            temp = base64VLQ.decode(str);
+            mapping.originalColumn = previousOriginalColumn + temp.value;
+            previousOriginalColumn = mapping.originalColumn;
+            str = temp.rest;
+
+            if (str.length > 0 && !mappingSeparator.test(str.charAt(0))) {
+              // Original name.
+              temp = base64VLQ.decode(str);
+              mapping.name = this._names.at(previousName + temp.value);
+              previousName += temp.value;
+              str = temp.rest;
+            }
+          }
+
+          this.__generatedMappings.push(mapping);
+          if (typeof mapping.originalLine === 'number') {
+            this.__originalMappings.push(mapping);
+          }
+        }
+      }
+
+      this.__originalMappings.sort(util.compareByOriginalPositions);
+    };
+
+  /**
+   * Find the mapping that best matches the hypothetical "needle" mapping that
+   * we are searching for in the given "haystack" of mappings.
+   */
+  SourceMapConsumer.prototype._findMapping =
+    function SourceMapConsumer_findMapping(aNeedle, aMappings, aLineName,
+                                           aColumnName, aComparator) {
+      // To return the position we are searching for, we must first find the
+      // mapping for the given position and then return the opposite position it
+      // points to. Because the mappings are sorted, we can use binary search to
+      // find the best mapping.
+
+      if (aNeedle[aLineName] <= 0) {
+        throw new TypeError('Line must be greater than or equal to 1, got '
+                            + aNeedle[aLineName]);
+      }
+      if (aNeedle[aColumnName] < 0) {
+        throw new TypeError('Column must be greater than or equal to 0, got '
+                            + aNeedle[aColumnName]);
+      }
+
+      return binarySearch.search(aNeedle, aMappings, aComparator);
+    };
+
+  /**
+   * Returns the original source, line, and column information for the generated
+   * source's line and column positions provided. The only argument is an object
+   * with the following properties:
+   *
+   *   - line: The line number in the generated source.
+   *   - column: The column number in the generated source.
+   *
+   * and an object is returned with the following properties:
+   *
+   *   - source: The original source file, or null.
+   *   - line: The line number in the original source, or null.
+   *   - column: The column number in the original source, or null.
+   *   - name: The original identifier, or null.
+   */
+  SourceMapConsumer.prototype.originalPositionFor =
+    function SourceMapConsumer_originalPositionFor(aArgs) {
+      var needle = {
+        generatedLine: util.getArg(aArgs, 'line'),
+        generatedColumn: util.getArg(aArgs, 'column')
+      };
+
+      var mapping = this._findMapping(needle,
+                                      this._generatedMappings,
+                                      "generatedLine",
+                                      "generatedColumn",
+                                      util.compareByGeneratedPositions);
+
+      if (mapping) {
+        var source = util.getArg(mapping, 'source', null);
+        if (source && this.sourceRoot) {
+          source = util.join(this.sourceRoot, source);
+        }
+        return {
+          source: source,
+          line: util.getArg(mapping, 'originalLine', null),
+          column: util.getArg(mapping, 'originalColumn', null),
+          name: util.getArg(mapping, 'name', null)
+        };
+      }
+
+      return {
+        source: null,
+        line: null,
+        column: null,
+        name: null
+      };
+    };
+
+  /**
+   * Returns the original source content. The only argument is the url of the
+   * original source file. Returns null if no original source content is
+   * availible.
+   */
+  SourceMapConsumer.prototype.sourceContentFor =
+    function SourceMapConsumer_sourceContentFor(aSource) {
+      if (!this.sourcesContent) {
+        return null;
+      }
+
+      if (this.sourceRoot) {
+        aSource = util.relative(this.sourceRoot, aSource);
+      }
+
+      if (this._sources.has(aSource)) {
+        return this.sourcesContent[this._sources.indexOf(aSource)];
+      }
+
+      var url;
+      if (this.sourceRoot
+          && (url = util.urlParse(this.sourceRoot))) {
+        // XXX: file:// URIs and absolute paths lead to unexpected behavior for
+        // many users. We can help them out when they expect file:// URIs to
+        // behave like it would if they were running a local HTTP server. See
+        // https://bugzilla.mozilla.org/show_bug.cgi?id=885597.
+        var fileUriAbsPath = aSource.replace(/^file:\/\//, "");
+        if (url.scheme == "file"
+            && this._sources.has(fileUriAbsPath)) {
+          return this.sourcesContent[this._sources.indexOf(fileUriAbsPath)]
+        }
+
+        if ((!url.path || url.path == "/")
+            && this._sources.has("/" + aSource)) {
+          return this.sourcesContent[this._sources.indexOf("/" + aSource)];
+        }
+      }
+
+      throw new Error('"' + aSource + '" is not in the SourceMap.');
+    };
+
+  /**
+   * Returns the generated line and column information for the original source,
+   * line, and column positions provided. The only argument is an object with
+   * the following properties:
+   *
+   *   - source: The filename of the original source.
+   *   - line: The line number in the original source.
+   *   - column: The column number in the original source.
+   *
+   * and an object is returned with the following properties:
+   *
+   *   - line: The line number in the generated source, or null.
+   *   - column: The column number in the generated source, or null.
+   */
+  SourceMapConsumer.prototype.generatedPositionFor =
+    function SourceMapConsumer_generatedPositionFor(aArgs) {
+      var needle = {
+        source: util.getArg(aArgs, 'source'),
+        originalLine: util.getArg(aArgs, 'line'),
+        originalColumn: util.getArg(aArgs, 'column')
+      };
+
+      if (this.sourceRoot) {
+        needle.source = util.relative(this.sourceRoot, needle.source);
+      }
+
+      var mapping = this._findMapping(needle,
+                                      this._originalMappings,
+                                      "originalLine",
+                                      "originalColumn",
+                                      util.compareByOriginalPositions);
+
+      if (mapping) {
+        return {
+          line: util.getArg(mapping, 'generatedLine', null),
+          column: util.getArg(mapping, 'generatedColumn', null)
+        };
+      }
+
+      return {
+        line: null,
+        column: null
+      };
+    };
+
+  SourceMapConsumer.GENERATED_ORDER = 1;
+  SourceMapConsumer.ORIGINAL_ORDER = 2;
+
+  /**
+   * Iterate over each mapping between an original source/line/column and a
+   * generated line/column in this source map.
+   *
+   * @param Function aCallback
+   *        The function that is called with each mapping.
+   * @param Object aContext
+   *        Optional. If specified, this object will be the value of `this` every
+   *        time that `aCallback` is called.
+   * @param aOrder
+   *        Either `SourceMapConsumer.GENERATED_ORDER` or
+   *        `SourceMapConsumer.ORIGINAL_ORDER`. Specifies whether you want to
+   *        iterate over the mappings sorted by the generated file's line/column
+   *        order or the original's source/line/column order, respectively. Defaults to
+   *        `SourceMapConsumer.GENERATED_ORDER`.
+   */
+  SourceMapConsumer.prototype.eachMapping =
+    function SourceMapConsumer_eachMapping(aCallback, aContext, aOrder) {
+      var context = aContext || null;
+      var order = aOrder || SourceMapConsumer.GENERATED_ORDER;
+
+      var mappings;
+      switch (order) {
+      case SourceMapConsumer.GENERATED_ORDER:
+        mappings = this._generatedMappings;
+        break;
+      case SourceMapConsumer.ORIGINAL_ORDER:
+        mappings = this._originalMappings;
+        break;
+      default:
+        throw new Error("Unknown order of iteration.");
+      }
+
+      var sourceRoot = this.sourceRoot;
+      mappings.map(function (mapping) {
+        var source = mapping.source;
+        if (source && sourceRoot) {
+          source = util.join(sourceRoot, source);
+        }
+        return {
+          source: source,
+          generatedLine: mapping.generatedLine,
+          generatedColumn: mapping.generatedColumn,
+          originalLine: mapping.originalLine,
+          originalColumn: mapping.originalColumn,
+          name: mapping.name
+        };
+      }).forEach(aCallback, context);
+    };
+
+  exports.SourceMapConsumer = SourceMapConsumer;
+
+});
+
+},{"./array-set":9,"./base64-vlq":10,"./binary-search":12,"./util":16,"amdefine":17}],14:[function(_dereq_,module,exports){
+/* -*- Mode: js; js-indent-level: 2; -*- */
+/*
+ * Copyright 2011 Mozilla Foundation and contributors
+ * Licensed under the New BSD license. See LICENSE or:
+ * http://opensource.org/licenses/BSD-3-Clause
+ */
+if (typeof define !== 'function') {
+    var define = _dereq_('amdefine')(module, _dereq_);
+}
+define(function (_dereq_, exports, module) {
+
+  var base64VLQ = _dereq_('./base64-vlq');
+  var util = _dereq_('./util');
+  var ArraySet = _dereq_('./array-set').ArraySet;
+
+  /**
+   * An instance of the SourceMapGenerator represents a source map which is
+   * being built incrementally. To create a new one, you must pass an object
+   * with the following properties:
+   *
+   *   - file: The filename of the generated source.
+   *   - sourceRoot: An optional root for all URLs in this source map.
+   */
+  function SourceMapGenerator(aArgs) {
+    this._file = util.getArg(aArgs, 'file');
+    this._sourceRoot = util.getArg(aArgs, 'sourceRoot', null);
+    this._sources = new ArraySet();
+    this._names = new ArraySet();
+    this._mappings = [];
+    this._sourcesContents = null;
+  }
+
+  SourceMapGenerator.prototype._version = 3;
+
+  /**
+   * Creates a new SourceMapGenerator based on a SourceMapConsumer
+   *
+   * @param aSourceMapConsumer The SourceMap.
+   */
+  SourceMapGenerator.fromSourceMap =
+    function SourceMapGenerator_fromSourceMap(aSourceMapConsumer) {
+      var sourceRoot = aSourceMapConsumer.sourceRoot;
+      var generator = new SourceMapGenerator({
+        file: aSourceMapConsumer.file,
+        sourceRoot: sourceRoot
+      });
+      aSourceMapConsumer.eachMapping(function (mapping) {
+        var newMapping = {
+          generated: {
+            line: mapping.generatedLine,
+            column: mapping.generatedColumn
+          }
+        };
+
+        if (mapping.source) {
+          newMapping.source = mapping.source;
+          if (sourceRoot) {
+            newMapping.source = util.relative(sourceRoot, newMapping.source);
+          }
+
+          newMapping.original = {
+            line: mapping.originalLine,
+            column: mapping.originalColumn
+          };
+
+          if (mapping.name) {
+            newMapping.name = mapping.name;
+          }
+        }
+
+        generator.addMapping(newMapping);
+      });
+      aSourceMapConsumer.sources.forEach(function (sourceFile) {
+        var content = aSourceMapConsumer.sourceContentFor(sourceFile);
+        if (content) {
+          generator.setSourceContent(sourceFile, content);
+        }
+      });
+      return generator;
+    };
+
+  /**
+   * Add a single mapping from original source line and column to the generated
+   * source's line and column for this source map being created. The mapping
+   * object should have the following properties:
+   *
+   *   - generated: An object with the generated line and column positions.
+   *   - original: An object with the original line and column positions.
+   *   - source: The original source file (relative to the sourceRoot).
+   *   - name: An optional original token name for this mapping.
+   */
+  SourceMapGenerator.prototype.addMapping =
+    function SourceMapGenerator_addMapping(aArgs) {
+      var generated = util.getArg(aArgs, 'generated');
+      var original = util.getArg(aArgs, 'original', null);
+      var source = util.getArg(aArgs, 'source', null);
+      var name = util.getArg(aArgs, 'name', null);
+
+      this._validateMapping(generated, original, source, name);
+
+      if (source && !this._sources.has(source)) {
+        this._sources.add(source);
+      }
+
+      if (name && !this._names.has(name)) {
+        this._names.add(name);
+      }
+
+      this._mappings.push({
+        generatedLine: generated.line,
+        generatedColumn: generated.column,
+        originalLine: original != null && original.line,
+        originalColumn: original != null && original.column,
+        source: source,
+        name: name
+      });
+    };
+
+  /**
+   * Set the source content for a source file.
+   */
+  SourceMapGenerator.prototype.setSourceContent =
+    function SourceMapGenerator_setSourceContent(aSourceFile, aSourceContent) {
+      var source = aSourceFile;
+      if (this._sourceRoot) {
+        source = util.relative(this._sourceRoot, source);
+      }
+
+      if (aSourceContent !== null) {
+        // Add the source content to the _sourcesContents map.
+        // Create a new _sourcesContents map if the property is null.
+        if (!this._sourcesContents) {
+          this._sourcesContents = {};
+        }
+        this._sourcesContents[util.toSetString(source)] = aSourceContent;
+      } else {
+        // Remove the source file from the _sourcesContents map.
+        // If the _sourcesContents map is empty, set the property to null.
+        delete this._sourcesContents[util.toSetString(source)];
+        if (Object.keys(this._sourcesContents).length === 0) {
+          this._sourcesContents = null;
+        }
+      }
+    };
+
+  /**
+   * Applies the mappings of a sub-source-map for a specific source file to the
+   * source map being generated. Each mapping to the supplied source file is
+   * rewritten using the supplied source map. Note: The resolution for the
+   * resulting mappings is the minimium of this map and the supplied map.
+   *
+   * @param aSourceMapConsumer The source map to be applied.
+   * @param aSourceFile Optional. The filename of the source file.
+   *        If omitted, SourceMapConsumer's file property will be used.
+   */
+  SourceMapGenerator.prototype.applySourceMap =
+    function SourceMapGenerator_applySourceMap(aSourceMapConsumer, aSourceFile) {
+      // If aSourceFile is omitted, we will use the file property of the SourceMap
+      if (!aSourceFile) {
+        aSourceFile = aSourceMapConsumer.file;
+      }
+      var sourceRoot = this._sourceRoot;
+      // Make "aSourceFile" relative if an absolute Url is passed.
+      if (sourceRoot) {
+        aSourceFile = util.relative(sourceRoot, aSourceFile);
+      }
+      // Applying the SourceMap can add and remove items from the sources and
+      // the names array.
+      var newSources = new ArraySet();
+      var newNames = new ArraySet();
+
+      // Find mappings for the "aSourceFile"
+      this._mappings.forEach(function (mapping) {
+        if (mapping.source === aSourceFile && mapping.originalLine) {
+          // Check if it can be mapped by the source map, then update the mapping.
+          var original = aSourceMapConsumer.originalPositionFor({
+            line: mapping.originalLine,
+            column: mapping.originalColumn
+          });
+          if (original.source !== null) {
+            // Copy mapping
+            if (sourceRoot) {
+              mapping.source = util.relative(sourceRoot, original.source);
+            } else {
+              mapping.source = original.source;
+            }
+            mapping.originalLine = original.line;
+            mapping.originalColumn = original.column;
+            if (original.name !== null && mapping.name !== null) {
+              // Only use the identifier name if it's an identifier
+              // in both SourceMaps
+              mapping.name = original.name;
+            }
+          }
+        }
+
+        var source = mapping.source;
+        if (source && !newSources.has(source)) {
+          newSources.add(source);
+        }
+
+        var name = mapping.name;
+        if (name && !newNames.has(name)) {
+          newNames.add(name);
+        }
+
+      }, this);
+      this._sources = newSources;
+      this._names = newNames;
+
+      // Copy sourcesContents of applied map.
+      aSourceMapConsumer.sources.forEach(function (sourceFile) {
+        var content = aSourceMapConsumer.sourceContentFor(sourceFile);
+        if (content) {
+          if (sourceRoot) {
+            sourceFile = util.relative(sourceRoot, sourceFile);
+          }
+          this.setSourceContent(sourceFile, content);
+        }
+      }, this);
+    };
+
+  /**
+   * A mapping can have one of the three levels of data:
+   *
+   *   1. Just the generated position.
+   *   2. The Generated position, original position, and original source.
+   *   3. Generated and original position, original source, as well as a name
+   *      token.
+   *
+   * To maintain consistency, we validate that any new mapping being added falls
+   * in to one of these categories.
+   */
+  SourceMapGenerator.prototype._validateMapping =
+    function SourceMapGenerator_validateMapping(aGenerated, aOriginal, aSource,
+                                                aName) {
+      if (aGenerated && 'line' in aGenerated && 'column' in aGenerated
+          && aGenerated.line > 0 && aGenerated.column >= 0
+          && !aOriginal && !aSource && !aName) {
+        // Case 1.
+        return;
+      }
+      else if (aGenerated && 'line' in aGenerated && 'column' in aGenerated
+               && aOriginal && 'line' in aOriginal && 'column' in aOriginal
+               && aGenerated.line > 0 && aGenerated.column >= 0
+               && aOriginal.line > 0 && aOriginal.column >= 0
+               && aSource) {
+        // Cases 2 and 3.
+        return;
+      }
+      else {
+        throw new Error('Invalid mapping: ' + JSON.stringify({
+          generated: aGenerated,
+          source: aSource,
+          orginal: aOriginal,
+          name: aName
+        }));
+      }
+    };
+
+  /**
+   * Serialize the accumulated mappings in to the stream of base 64 VLQs
+   * specified by the source map format.
+   */
+  SourceMapGenerator.prototype._serializeMappings =
+    function SourceMapGenerator_serializeMappings() {
+      var previousGeneratedColumn = 0;
+      var previousGeneratedLine = 1;
+      var previousOriginalColumn = 0;
+      var previousOriginalLine = 0;
+      var previousName = 0;
+      var previousSource = 0;
+      var result = '';
+      var mapping;
+
+      // The mappings must be guaranteed to be in sorted order before we start
+      // serializing them or else the generated line numbers (which are defined
+      // via the ';' separators) will be all messed up. Note: it might be more
+      // performant to maintain the sorting as we insert them, rather than as we
+      // serialize them, but the big O is the same either way.
+      this._mappings.sort(util.compareByGeneratedPositions);
+
+      for (var i = 0, len = this._mappings.length; i < len; i++) {
+        mapping = this._mappings[i];
+
+        if (mapping.generatedLine !== previousGeneratedLine) {
+          previousGeneratedColumn = 0;
+          while (mapping.generatedLine !== previousGeneratedLine) {
+            result += ';';
+            previousGeneratedLine++;
+          }
+        }
+        else {
+          if (i > 0) {
+            if (!util.compareByGeneratedPositions(mapping, this._mappings[i - 1])) {
+              continue;
+            }
+            result += ',';
+          }
+        }
+
+        result += base64VLQ.encode(mapping.generatedColumn
+                                   - previousGeneratedColumn);
+        previousGeneratedColumn = mapping.generatedColumn;
+
+        if (mapping.source) {
+          result += base64VLQ.encode(this._sources.indexOf(mapping.source)
+                                     - previousSource);
+          previousSource = this._sources.indexOf(mapping.source);
+
+          // lines are stored 0-based in SourceMap spec version 3
+          result += base64VLQ.encode(mapping.originalLine - 1
+                                     - previousOriginalLine);
+          previousOriginalLine = mapping.originalLine - 1;
+
+          result += base64VLQ.encode(mapping.originalColumn
+                                     - previousOriginalColumn);
+          previousOriginalColumn = mapping.originalColumn;
+
+          if (mapping.name) {
+            result += base64VLQ.encode(this._names.indexOf(mapping.name)
+                                       - previousName);
+            previousName = this._names.indexOf(mapping.name);
+          }
+        }
+      }
+
+      return result;
+    };
+
+  SourceMapGenerator.prototype._generateSourcesContent =
+    function SourceMapGenerator_generateSourcesContent(aSources, aSourceRoot) {
+      return aSources.map(function (source) {
+        if (!this._sourcesContents) {
+          return null;
+        }
+        if (aSourceRoot) {
+          source = util.relative(aSourceRoot, source);
+        }
+        var key = util.toSetString(source);
+        return Object.prototype.hasOwnProperty.call(this._sourcesContents,
+                                                    key)
+          ? this._sourcesContents[key]
+          : null;
+      }, this);
+    };
+
+  /**
+   * Externalize the source map.
+   */
+  SourceMapGenerator.prototype.toJSON =
+    function SourceMapGenerator_toJSON() {
+      var map = {
+        version: this._version,
+        file: this._file,
+        sources: this._sources.toArray(),
+        names: this._names.toArray(),
+        mappings: this._serializeMappings()
+      };
+      if (this._sourceRoot) {
+        map.sourceRoot = this._sourceRoot;
+      }
+      if (this._sourcesContents) {
+        map.sourcesContent = this._generateSourcesContent(map.sources, map.sourceRoot);
+      }
+
+      return map;
+    };
+
+  /**
+   * Render the source map being generated to a string.
+   */
+  SourceMapGenerator.prototype.toString =
+    function SourceMapGenerator_toString() {
+      return JSON.stringify(this);
+    };
+
+  exports.SourceMapGenerator = SourceMapGenerator;
+
+});
+
+},{"./array-set":9,"./base64-vlq":10,"./util":16,"amdefine":17}],15:[function(_dereq_,module,exports){
+/* -*- Mode: js; js-indent-level: 2; -*- */
+/*
+ * Copyright 2011 Mozilla Foundation and contributors
+ * Licensed under the New BSD license. See LICENSE or:
+ * http://opensource.org/licenses/BSD-3-Clause
+ */
+if (typeof define !== 'function') {
+    var define = _dereq_('amdefine')(module, _dereq_);
+}
+define(function (_dereq_, exports, module) {
+
+  var SourceMapGenerator = _dereq_('./source-map-generator').SourceMapGenerator;
+  var util = _dereq_('./util');
+
+  /**
+   * SourceNodes provide a way to abstract over interpolating/concatenating
+   * snippets of generated JavaScript source code while maintaining the line and
+   * column information associated with the original source code.
+   *
+   * @param aLine The original line number.
+   * @param aColumn The original column number.
+   * @param aSource The original source's filename.
+   * @param aChunks Optional. An array of strings which are snippets of
+   *        generated JS, or other SourceNodes.
+   * @param aName The original identifier.
+   */
+  function SourceNode(aLine, aColumn, aSource, aChunks, aName) {
+    this.children = [];
+    this.sourceContents = {};
+    this.line = aLine === undefined ? null : aLine;
+    this.column = aColumn === undefined ? null : aColumn;
+    this.source = aSource === undefined ? null : aSource;
+    this.name = aName === undefined ? null : aName;
+    if (aChunks != null) this.add(aChunks);
+  }
+
+  /**
+   * Creates a SourceNode from generated code and a SourceMapConsumer.
+   *
+   * @param aGeneratedCode The generated code
+   * @param aSourceMapConsumer The SourceMap for the generated code
+   */
+  SourceNode.fromStringWithSourceMap =
+    function SourceNode_fromStringWithSourceMap(aGeneratedCode, aSourceMapConsumer) {
+      // The SourceNode we want to fill with the generated code
+      // and the SourceMap
+      var node = new SourceNode();
+
+      // The generated code
+      // Processed fragments are removed from this array.
+      var remainingLines = aGeneratedCode.split('\n');
+
+      // We need to remember the position of "remainingLines"
+      var lastGeneratedLine = 1, lastGeneratedColumn = 0;
+
+      // The generate SourceNodes we need a code range.
+      // To extract it current and last mapping is used.
+      // Here we store the last mapping.
+      var lastMapping = null;
+
+      aSourceMapConsumer.eachMapping(function (mapping) {
+        if (lastMapping === null) {
+          // We add the generated code until the first mapping
+          // to the SourceNode without any mapping.
+          // Each line is added as separate string.
+          while (lastGeneratedLine < mapping.generatedLine) {
+            node.add(remainingLines.shift() + "\n");
+            lastGeneratedLine++;
+          }
+          if (lastGeneratedColumn < mapping.generatedColumn) {
+            var nextLine = remainingLines[0];
+            node.add(nextLine.substr(0, mapping.generatedColumn));
+            remainingLines[0] = nextLine.substr(mapping.generatedColumn);
+            lastGeneratedColumn = mapping.generatedColumn;
+          }
+        } else {
+          // We add the code from "lastMapping" to "mapping":
+          // First check if there is a new line in between.
+          if (lastGeneratedLine < mapping.generatedLine) {
+            var code = "";
+            // Associate full lines with "lastMapping"
+            do {
+              code += remainingLines.shift() + "\n";
+              lastGeneratedLine++;
+              lastGeneratedColumn = 0;
+            } while (lastGeneratedLine < mapping.generatedLine);
+            // When we reached the correct line, we add code until we
+            // reach the correct column too.
+            if (lastGeneratedColumn < mapping.generatedColumn) {
+              var nextLine = remainingLines[0];
+              code += nextLine.substr(0, mapping.generatedColumn);
+              remainingLines[0] = nextLine.substr(mapping.generatedColumn);
+              lastGeneratedColumn = mapping.generatedColumn;
+            }
+            // Create the SourceNode.
+            addMappingWithCode(lastMapping, code);
+          } else {
+            // There is no new line in between.
+            // Associate the code between "lastGeneratedColumn" and
+            // "mapping.generatedColumn" with "lastMapping"
+            var nextLine = remainingLines[0];
+            var code = nextLine.substr(0, mapping.generatedColumn -
+                                          lastGeneratedColumn);
+            remainingLines[0] = nextLine.substr(mapping.generatedColumn -
+                                                lastGeneratedColumn);
+            lastGeneratedColumn = mapping.generatedColumn;
+            addMappingWithCode(lastMapping, code);
+          }
+        }
+        lastMapping = mapping;
+      }, this);
+      // We have processed all mappings.
+      // Associate the remaining code in the current line with "lastMapping"
+      // and add the remaining lines without any mapping
+      addMappingWithCode(lastMapping, remainingLines.join("\n"));
+
+      // Copy sourcesContent into SourceNode
+      aSourceMapConsumer.sources.forEach(function (sourceFile) {
+        var content = aSourceMapConsumer.sourceContentFor(sourceFile);
+        if (content) {
+          node.setSourceContent(sourceFile, content);
+        }
+      });
+
+      return node;
+
+      function addMappingWithCode(mapping, code) {
+        if (mapping === null || mapping.source === undefined) {
+          node.add(code);
+        } else {
+          node.add(new SourceNode(mapping.originalLine,
+                                  mapping.originalColumn,
+                                  mapping.source,
+                                  code,
+                                  mapping.name));
+        }
+      }
+    };
+
+  /**
+   * Add a chunk of generated JS to this source node.
+   *
+   * @param aChunk A string snippet of generated JS code, another instance of
+   *        SourceNode, or an array where each member is one of those things.
+   */
+  SourceNode.prototype.add = function SourceNode_add(aChunk) {
+    if (Array.isArray(aChunk)) {
+      aChunk.forEach(function (chunk) {
+        this.add(chunk);
+      }, this);
+    }
+    else if (aChunk instanceof SourceNode || typeof aChunk === "string") {
+      if (aChunk) {
+        this.children.push(aChunk);
+      }
+    }
+    else {
+      throw new TypeError(
+        "Expected a SourceNode, string, or an array of SourceNodes and strings. Got " + aChunk
+      );
+    }
+    return this;
+  };
+
+  /**
+   * Add a chunk of generated JS to the beginning of this source node.
+   *
+   * @param aChunk A string snippet of generated JS code, another instance of
+   *        SourceNode, or an array where each member is one of those things.
+   */
+  SourceNode.prototype.prepend = function SourceNode_prepend(aChunk) {
+    if (Array.isArray(aChunk)) {
+      for (var i = aChunk.length-1; i >= 0; i--) {
+        this.prepend(aChunk[i]);
+      }
+    }
+    else if (aChunk instanceof SourceNode || typeof aChunk === "string") {
+      this.children.unshift(aChunk);
+    }
+    else {
+      throw new TypeError(
+        "Expected a SourceNode, string, or an array of SourceNodes and strings. Got " + aChunk
+      );
+    }
+    return this;
+  };
+
+  /**
+   * Walk over the tree of JS snippets in this node and its children. The
+   * walking function is called once for each snippet of JS and is passed that
+   * snippet and the its original associated source's line/column location.
+   *
+   * @param aFn The traversal function.
+   */
+  SourceNode.prototype.walk = function SourceNode_walk(aFn) {
+    var chunk;
+    for (var i = 0, len = this.children.length; i < len; i++) {
+      chunk = this.children[i];
+      if (chunk instanceof SourceNode) {
+        chunk.walk(aFn);
+      }
+      else {
+        if (chunk !== '') {
+          aFn(chunk, { source: this.source,
+                       line: this.line,
+                       column: this.column,
+                       name: this.name });
+        }
+      }
+    }
+  };
+
+  /**
+   * Like `String.prototype.join` except for SourceNodes. Inserts `aStr` between
+   * each of `this.children`.
+   *
+   * @param aSep The separator.
+   */
+  SourceNode.prototype.join = function SourceNode_join(aSep) {
+    var newChildren;
+    var i;
+    var len = this.children.length;
+    if (len > 0) {
+      newChildren = [];
+      for (i = 0; i < len-1; i++) {
+        newChildren.push(this.children[i]);
+        newChildren.push(aSep);
+      }
+      newChildren.push(this.children[i]);
+      this.children = newChildren;
+    }
+    return this;
+  };
+
+  /**
+   * Call String.prototype.replace on the very right-most source snippet. Useful
+   * for trimming whitespace from the end of a source node, etc.
+   *
+   * @param aPattern The pattern to replace.
+   * @param aReplacement The thing to replace the pattern with.
+   */
+  SourceNode.prototype.replaceRight = function SourceNode_replaceRight(aPattern, aReplacement) {
+    var lastChild = this.children[this.children.length - 1];
+    if (lastChild instanceof SourceNode) {
+      lastChild.replaceRight(aPattern, aReplacement);
+    }
+    else if (typeof lastChild === 'string') {
+      this.children[this.children.length - 1] = lastChild.replace(aPattern, aReplacement);
+    }
+    else {
+      this.children.push(''.replace(aPattern, aReplacement));
+    }
+    return this;
+  };
+
+  /**
+   * Set the source content for a source file. This will be added to the SourceMapGenerator
+   * in the sourcesContent field.
+   *
+   * @param aSourceFile The filename of the source file
+   * @param aSourceContent The content of the source file
+   */
+  SourceNode.prototype.setSourceContent =
+    function SourceNode_setSourceContent(aSourceFile, aSourceContent) {
+      this.sourceContents[util.toSetString(aSourceFile)] = aSourceContent;
+    };
+
+  /**
+   * Walk over the tree of SourceNodes. The walking function is called for each
+   * source file content and is passed the filename and source content.
+   *
+   * @param aFn The traversal function.
+   */
+  SourceNode.prototype.walkSourceContents =
+    function SourceNode_walkSourceContents(aFn) {
+      for (var i = 0, len = this.children.length; i < len; i++) {
+        if (this.children[i] instanceof SourceNode) {
+          this.children[i].walkSourceContents(aFn);
+        }
+      }
+
+      var sources = Object.keys(this.sourceContents);
+      for (var i = 0, len = sources.length; i < len; i++) {
+        aFn(util.fromSetString(sources[i]), this.sourceContents[sources[i]]);
+      }
+    };
+
+  /**
+   * Return the string representation of this source node. Walks over the tree
+   * and concatenates all the various snippets together to one string.
+   */
+  SourceNode.prototype.toString = function SourceNode_toString() {
+    var str = "";
+    this.walk(function (chunk) {
+      str += chunk;
+    });
+    return str;
+  };
+
+  /**
+   * Returns the string representation of this source node along with a source
+   * map.
+   */
+  SourceNode.prototype.toStringWithSourceMap = function SourceNode_toStringWithSourceMap(aArgs) {
+    var generated = {
+      code: "",
+      line: 1,
+      column: 0
+    };
+    var map = new SourceMapGenerator(aArgs);
+    var sourceMappingActive = false;
+    var lastOriginalSource = null;
+    var lastOriginalLine = null;
+    var lastOriginalColumn = null;
+    var lastOriginalName = null;
+    this.walk(function (chunk, original) {
+      generated.code += chunk;
+      if (original.source !== null
+          && original.line !== null
+          && original.column !== null) {
+        if(lastOriginalSource !== original.source
+           || lastOriginalLine !== original.line
+           || lastOriginalColumn !== original.column
+           || lastOriginalName !== original.name) {
+          map.addMapping({
+            source: original.source,
+            original: {
+              line: original.line,
+              column: original.column
+            },
+            generated: {
+              line: generated.line,
+              column: generated.column
+            },
+            name: original.name
+          });
+        }
+        lastOriginalSource = original.source;
+        lastOriginalLine = original.line;
+        lastOriginalColumn = original.column;
+        lastOriginalName = original.name;
+        sourceMappingActive = true;
+      } else if (sourceMappingActive) {
+        map.addMapping({
+          generated: {
+            line: generated.line,
+            column: generated.column
+          }
+        });
+        lastOriginalSource = null;
+        sourceMappingActive = false;
+      }
+      chunk.split('').forEach(function (ch) {
+        if (ch === '\n') {
+          generated.line++;
+          generated.column = 0;
+        } else {
+          generated.column++;
+        }
+      });
+    });
+    this.walkSourceContents(function (sourceFile, sourceContent) {
+      map.setSourceContent(sourceFile, sourceContent);
+    });
+
+    return { code: generated.code, map: map };
+  };
+
+  exports.SourceNode = SourceNode;
+
+});
+
+},{"./source-map-generator":14,"./util":16,"amdefine":17}],16:[function(_dereq_,module,exports){
+/* -*- Mode: js; js-indent-level: 2; -*- */
+/*
+ * Copyright 2011 Mozilla Foundation and contributors
+ * Licensed under the New BSD license. See LICENSE or:
+ * http://opensource.org/licenses/BSD-3-Clause
+ */
+if (typeof define !== 'function') {
+    var define = _dereq_('amdefine')(module, _dereq_);
+}
+define(function (_dereq_, exports, module) {
+
+  /**
+   * This is a helper function for getting values from parameter/options
+   * objects.
+   *
+   * @param args The object we are extracting values from
+   * @param name The name of the property we are getting.
+   * @param defaultValue An optional value to return if the property is missing
+   * from the object. If this is not specified and the property is missing, an
+   * error will be thrown.
+   */
+  function getArg(aArgs, aName, aDefaultValue) {
+    if (aName in aArgs) {
+      return aArgs[aName];
+    } else if (arguments.length === 3) {
+      return aDefaultValue;
+    } else {
+      throw new Error('"' + aName + '" is a required argument.');
+    }
+  }
+  exports.getArg = getArg;
+
+  var urlRegexp = /([\w+\-.]+):\/\/((\w+:\w+)@)?([\w.]+)?(:(\d+))?(\S+)?/;
+  var dataUrlRegexp = /^data:.+\,.+/;
+
+  function urlParse(aUrl) {
+    var match = aUrl.match(urlRegexp);
+    if (!match) {
+      return null;
+    }
+    return {
+      scheme: match[1],
+      auth: match[3],
+      host: match[4],
+      port: match[6],
+      path: match[7]
+    };
+  }
+  exports.urlParse = urlParse;
+
+  function urlGenerate(aParsedUrl) {
+    var url = aParsedUrl.scheme + "://";
+    if (aParsedUrl.auth) {
+      url += aParsedUrl.auth + "@"
+    }
+    if (aParsedUrl.host) {
+      url += aParsedUrl.host;
+    }
+    if (aParsedUrl.port) {
+      url += ":" + aParsedUrl.port
+    }
+    if (aParsedUrl.path) {
+      url += aParsedUrl.path;
+    }
+    return url;
+  }
+  exports.urlGenerate = urlGenerate;
+
+  function join(aRoot, aPath) {
+    var url;
+
+    if (aPath.match(urlRegexp) || aPath.match(dataUrlRegexp)) {
+      return aPath;
+    }
+
+    if (aPath.charAt(0) === '/' && (url = urlParse(aRoot))) {
+      url.path = aPath;
+      return urlGenerate(url);
+    }
+
+    return aRoot.replace(/\/$/, '') + '/' + aPath;
+  }
+  exports.join = join;
+
+  /**
+   * Because behavior goes wacky when you set `__proto__` on objects, we
+   * have to prefix all the strings in our set with an arbitrary character.
+   *
+   * See https://github.com/mozilla/source-map/pull/31 and
+   * https://github.com/mozilla/source-map/issues/30
+   *
+   * @param String aStr
+   */
+  function toSetString(aStr) {
+    return '$' + aStr;
+  }
+  exports.toSetString = toSetString;
+
+  function fromSetString(aStr) {
+    return aStr.substr(1);
+  }
+  exports.fromSetString = fromSetString;
+
+  function relative(aRoot, aPath) {
+    aRoot = aRoot.replace(/\/$/, '');
+
+    var url = urlParse(aRoot);
+    if (aPath.charAt(0) == "/" && url && url.path == "/") {
+      return aPath.slice(1);
+    }
+
+    return aPath.indexOf(aRoot + '/') === 0
+      ? aPath.substr(aRoot.length + 1)
+      : aPath;
+  }
+  exports.relative = relative;
+
+  function strcmp(aStr1, aStr2) {
+    var s1 = aStr1 || "";
+    var s2 = aStr2 || "";
+    return (s1 > s2) - (s1 < s2);
+  }
+
+  /**
+   * Comparator between two mappings where the original positions are compared.
+   *
+   * Optionally pass in `true` as `onlyCompareGenerated` to consider two
+   * mappings with the same original source/line/column, but different generated
+   * line and column the same. Useful when searching for a mapping with a
+   * stubbed out mapping.
+   */
+  function compareByOriginalPositions(mappingA, mappingB, onlyCompareOriginal) {
+    var cmp;
+
+    cmp = strcmp(mappingA.source, mappingB.source);
+    if (cmp) {
+      return cmp;
+    }
+
+    cmp = mappingA.originalLine - mappingB.originalLine;
+    if (cmp) {
+      return cmp;
+    }
+
+    cmp = mappingA.originalColumn - mappingB.originalColumn;
+    if (cmp || onlyCompareOriginal) {
+      return cmp;
+    }
+
+    cmp = strcmp(mappingA.name, mappingB.name);
+    if (cmp) {
+      return cmp;
+    }
+
+    cmp = mappingA.generatedLine - mappingB.generatedLine;
+    if (cmp) {
+      return cmp;
+    }
+
+    return mappingA.generatedColumn - mappingB.generatedColumn;
+  };
+  exports.compareByOriginalPositions = compareByOriginalPositions;
+
+  /**
+   * Comparator between two mappings where the generated positions are
+   * compared.
+   *
+   * Optionally pass in `true` as `onlyCompareGenerated` to consider two
+   * mappings with the same generated line and column, but different
+   * source/name/original line and column the same. Useful when searching for a
+   * mapping with a stubbed out mapping.
+   */
+  function compareByGeneratedPositions(mappingA, mappingB, onlyCompareGenerated) {
+    var cmp;
+
+    cmp = mappingA.generatedLine - mappingB.generatedLine;
+    if (cmp) {
+      return cmp;
+    }
+
+    cmp = mappingA.generatedColumn - mappingB.generatedColumn;
+    if (cmp || onlyCompareGenerated) {
+      return cmp;
+    }
+
+    cmp = strcmp(mappingA.source, mappingB.source);
+    if (cmp) {
+      return cmp;
+    }
+
+    cmp = mappingA.originalLine - mappingB.originalLine;
+    if (cmp) {
+      return cmp;
+    }
+
+    cmp = mappingA.originalColumn - mappingB.originalColumn;
+    if (cmp) {
+      return cmp;
+    }
+
+    return strcmp(mappingA.name, mappingB.name);
+  };
+  exports.compareByGeneratedPositions = compareByGeneratedPositions;
+
+});
+
+},{"amdefine":17}],17:[function(_dereq_,module,exports){
+(function (process,__filename){
+/** vim: et:ts=4:sw=4:sts=4
+ * @license amdefine 0.1.0 Copyright (c) 2011, The Dojo Foundation All Rights Reserved.
+ * Available via the MIT or new BSD license.
+ * see: http://github.com/jrburke/amdefine for details
+ */
+
+/*jslint node: true */
+/*global module, process */
+'use strict';
+
+/**
+ * Creates a define for node.
+ * @param {Object} module the "module" object that is defined by Node for the
+ * current module.
+ * @param {Function} [requireFn]. Node's require function for the current module.
+ * It only needs to be passed in Node versions before 0.5, when module.require
+ * did not exist.
+ * @returns {Function} a define function that is usable for the current node
+ * module.
+ */
+function amdefine(module, requireFn) {
+    'use strict';
+    var defineCache = {},
+        loaderCache = {},
+        alreadyCalled = false,
+        path = _dereq_('path'),
+        makeRequire, stringRequire;
+
+    /**
+     * Trims the . and .. from an array of path segments.
+     * It will keep a leading path segment if a .. will become
+     * the first path segment, to help with module name lookups,
+     * which act like paths, but can be remapped. But the end result,
+     * all paths that use this function should look normalized.
+     * NOTE: this method MODIFIES the input array.
+     * @param {Array} ary the array of path segments.
+     */
+    function trimDots(ary) {
+        var i, part;
+        for (i = 0; ary[i]; i+= 1) {
+            part = ary[i];
+            if (part === '.') {
+                ary.splice(i, 1);
+                i -= 1;
+            } else if (part === '..') {
+                if (i === 1 && (ary[2] === '..' || ary[0] === '..')) {
+                    //End of the line. Keep at least one non-dot
+                    //path segment at the front so it can be mapped
+                    //correctly to disk. Otherwise, there is likely
+                    //no path mapping for a path starting with '..'.
+                    //This can still fail, but catches the most reasonable
+                    //uses of ..
+                    break;
+                } else if (i > 0) {
+                    ary.splice(i - 1, 2);
+                    i -= 2;
+                }
+            }
+        }
+    }
+
+    function normalize(name, baseName) {
+        var baseParts;
+
+        //Adjust any relative paths.
+        if (name && name.charAt(0) === '.') {
+            //If have a base name, try to normalize against it,
+            //otherwise, assume it is a top-level require that will
+            //be relative to baseUrl in the end.
+            if (baseName) {
+                baseParts = baseName.split('/');
+                baseParts = baseParts.slice(0, baseParts.length - 1);
+                baseParts = baseParts.concat(name.split('/'));
+                trimDots(baseParts);
+                name = baseParts.join('/');
+            }
+        }
+
+        return name;
+    }
+
+    /**
+     * Create the normalize() function passed to a loader plugin's
+     * normalize method.
+     */
+    function makeNormalize(relName) {
+        return function (name) {
+            return normalize(name, relName);
+        };
+    }
+
+    function makeLoad(id) {
+        function load(value) {
+            loaderCache[id] = value;
+        }
+
+        load.fromText = function (id, text) {
+            //This one is difficult because the text can/probably uses
+            //define, and any relative paths and requires should be relative
+            //to that id was it would be found on disk. But this would require
+            //bootstrapping a module/require fairly deeply from node core.
+            //Not sure how best to go about that yet.
+            throw new Error('amdefine does not implement load.fromText');
+        };
+
+        return load;
+    }
+
+    makeRequire = function (systemRequire, exports, module, relId) {
+        function amdRequire(deps, callback) {
+            if (typeof deps === 'string') {
+                //Synchronous, single module require('')
+                return stringRequire(systemRequire, exports, module, deps, relId);
+            } else {
+                //Array of dependencies with a callback.
+
+                //Convert the dependencies to modules.
+                deps = deps.map(function (depName) {
+                    return stringRequire(systemRequire, exports, module, depName, relId);
+                });
+
+                //Wait for next tick to call back the require call.
+                process.nextTick(function () {
+                    callback.apply(null, deps);
+                });
+            }
+        }
+
+        amdRequire.toUrl = function (filePath) {
+            if (filePath.indexOf('.') === 0) {
+                return normalize(filePath, path.dirname(module.filename));
+            } else {
+                return filePath;
+            }
+        };
+
+        return amdRequire;
+    };
+
+    //Favor explicit value, passed in if the module wants to support Node 0.4.
+    requireFn = requireFn || function req() {
+        return module.require.apply(module, arguments);
+    };
+
+    function runFactory(id, deps, factory) {
+        var r, e, m, result;
+
+        if (id) {
+            e = loaderCache[id] = {};
+            m = {
+                id: id,
+                uri: __filename,
+                exports: e
+            };
+            r = makeRequire(requireFn, e, m, id);
+        } else {
+            //Only support one define call per file
+            if (alreadyCalled) {
+                throw new Error('amdefine with no module ID cannot be called more than once per file.');
+            }
+            alreadyCalled = true;
+
+            //Use the real variables from node
+            //Use module.exports for exports, since
+            //the exports in here is amdefine exports.
+            e = module.exports;
+            m = module;
+            r = makeRequire(requireFn, e, m, module.id);
+        }
+
+        //If there are dependencies, they are strings, so need
+        //to convert them to dependency values.
+        if (deps) {
+            deps = deps.map(function (depName) {
+                return r(depName);
+            });
+        }
+
+        //Call the factory with the right dependencies.
+        if (typeof factory === 'function') {
+            result = factory.apply(m.exports, deps);
+        } else {
+            result = factory;
+        }
+
+        if (result !== undefined) {
+            m.exports = result;
+            if (id) {
+                loaderCache[id] = m.exports;
+            }
+        }
+    }
+
+    stringRequire = function (systemRequire, exports, module, id, relId) {
+        //Split the ID by a ! so that
+        var index = id.indexOf('!'),
+            originalId = id,
+            prefix, plugin;
+
+        if (index === -1) {
+            id = normalize(id, relId);
+
+            //Straight module lookup. If it is one of the special dependencies,
+            //deal with it, otherwise, delegate to node.
+            if (id === 'require') {
+                return makeRequire(systemRequire, exports, module, relId);
+            } else if (id === 'exports') {
+                return exports;
+            } else if (id === 'module') {
+                return module;
+            } else if (loaderCache.hasOwnProperty(id)) {
+                return loaderCache[id];
+            } else if (defineCache[id]) {
+                runFactory.apply(null, defineCache[id]);
+                return loaderCache[id];
+            } else {
+                if(systemRequire) {
+                    return systemRequire(originalId);
+                } else {
+                    throw new Error('No module with ID: ' + id);
+                }
+            }
+        } else {
+            //There is a plugin in play.
+            prefix = id.substring(0, index);
+            id = id.substring(index + 1, id.length);
+
+            plugin = stringRequire(systemRequire, exports, module, prefix, relId);
+
+            if (plugin.normalize) {
+                id = plugin.normalize(id, makeNormalize(relId));
+            } else {
+                //Normalize the ID normally.
+                id = normalize(id, relId);
+            }
+
+            if (loaderCache[id]) {
+                return loaderCache[id];
+            } else {
+                plugin.load(id, makeRequire(systemRequire, exports, module, relId), makeLoad(id), {});
+
+                return loaderCache[id];
+            }
+        }
+    };
+
+    //Create a define function specific to the module asking for amdefine.
+    function define(id, deps, factory) {
+        if (Array.isArray(id)) {
+            factory = deps;
+            deps = id;
+            id = undefined;
+        } else if (typeof id !== 'string') {
+            factory = id;
+            id = deps = undefined;
+        }
+
+        if (deps && !Array.isArray(deps)) {
+            factory = deps;
+            deps = undefined;
+        }
+
+        if (!deps) {
+            deps = ['require', 'exports', 'module'];
+        }
+
+        //Set up properties for this module. If an ID, then use
+        //internal cache. If no ID, then use the external variables
+        //for this node module.
+        if (id) {
+            //Put the module in deep freeze until there is a
+            //require call for it.
+            defineCache[id] = [id, deps, factory];
+        } else {
+            runFactory(id, deps, factory);
+        }
+    }
+
+    //define.require, which has access to all the values in the
+    //cache. Useful for AMD modules that all have IDs in the file,
+    //but need to finally export a value to node based on one of those
+    //IDs.
+    define.require = function (id) {
+        if (loaderCache[id]) {
+            return loaderCache[id];
+        }
+
+        if (defineCache[id]) {
+            runFactory.apply(null, defineCache[id]);
+            return loaderCache[id];
+        }
+    };
+
+    define.amd = {};
+
+    return define;
+}
+
+module.exports = amdefine;
+
+}).call(this,_dereq_("/Users/poshannessy/FB/code/react/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),"/../node_modules/jstransform/node_modules/source-map/node_modules/amdefine/amdefine.js")
+},{"/Users/poshannessy/FB/code/react/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,"path":5}],18:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+var docblockRe = /^\s*(\/\*\*(.|\r?\n)*?\*\/)/;
+var ltrimRe = /^\s*/;
+/**
+ * @param {String} contents
+ * @return {String}
+ */
+function extract(contents) {
+  var match = contents.match(docblockRe);
+  if (match) {
+    return match[0].replace(ltrimRe, '') || '';
+  }
+  return '';
+}
+
+
+var commentStartRe = /^\/\*\*?/;
+var commentEndRe = /\*+\/$/;
+var wsRe = /[\t ]+/g;
+var stringStartRe = /(\r?\n|^) *\*/g;
+var multilineRe = /(?:^|\r?\n) *(@[^\r\n]*?) *\r?\n *([^@\r\n\s][^@\r\n]+?) *\r?\n/g;
+var propertyRe = /(?:^|\r?\n) *@(\S+) *([^\r\n]*)/g;
+
+/**
+ * @param {String} contents
+ * @return {Array}
+ */
+function parse(docblock) {
+  docblock = docblock
+    .replace(commentStartRe, '')
+    .replace(commentEndRe, '')
+    .replace(wsRe, ' ')
+    .replace(stringStartRe, '$1');
+
+  // Normalize multi-line directives
+  var prev = '';
+  while (prev != docblock) {
+    prev = docblock;
+    docblock = docblock.replace(multilineRe, "\n$1 $2\n");
+  }
+  docblock = docblock.trim();
+
+  var result = [];
+  var match;
+  while (match = propertyRe.exec(docblock)) {
+    result.push([match[1], match[2]]);
+  }
+
+  return result;
+}
+
+/**
+ * Same as parse but returns an object of prop: value instead of array of paris
+ * If a property appers more than once the last one will be returned
+ *
+ * @param {String} contents
+ * @return {Object}
+ */
+function parseAsObject(docblock) {
+  var pairs = parse(docblock);
+  var result = {};
+  for (var i = 0; i < pairs.length; i++) {
+    result[pairs[i][0]] = pairs[i][1];
+  }
+  return result;
+}
+
+
+exports.extract = extract;
+exports.parse = parse;
+exports.parseAsObject = parseAsObject;
+
+},{}],19:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+
+/*jslint node: true*/
+"use strict";
+
+/**
+ * Syntax transfomer for javascript. Takes the source in, spits the source
+ * out.
+ *
+ * Parses input source with esprima, applies the given list of visitors to the
+ * AST tree, and returns the resulting output.
+ */
+var esprima = _dereq_('esprima-fb');
+var utils = _dereq_('./utils');
+
+var Syntax = esprima.Syntax;
+
+/**
+ * @param {object} node
+ * @param {object} parentNode
+ * @return {boolean}
+ */
+function _nodeIsClosureScopeBoundary(node, parentNode) {
+  if (node.type === Syntax.Program) {
+    return true;
+  }
+
+  var parentIsFunction =
+    parentNode.type === Syntax.FunctionDeclaration
+    || parentNode.type === Syntax.FunctionExpression;
+
+  return node.type === Syntax.BlockStatement && parentIsFunction;
+}
+
+function _nodeIsBlockScopeBoundary(node, parentNode) {
+  if (node.type === Syntax.Program) {
+    return false;
+  }
+
+  return node.type === Syntax.BlockStatement
+         && parentNode.type === Syntax.CatchClause;
+}
+
+/**
+ * @param {object} node
+ * @param {function} visitor
+ * @param {array} path
+ * @param {object} state
+ */
+function traverse(node, path, state) {
+  // Create a scope stack entry if this is the first node we've encountered in
+  // its local scope
+  var parentNode = path[0];
+  if (!Array.isArray(node) && state.localScope.parentNode !== parentNode) {
+    if (_nodeIsClosureScopeBoundary(node, parentNode)) {
+      var scopeIsStrict =
+        state.scopeIsStrict
+        || node.body.length > 0
+           && node.body[0].type === Syntax.ExpressionStatement
+           && node.body[0].expression.type === Syntax.Literal
+           && node.body[0].expression.value === 'use strict';
+
+      if (node.type === Syntax.Program) {
+        state = utils.updateState(state, {
+          scopeIsStrict: scopeIsStrict
+        });
+      } else {
+        state = utils.updateState(state, {
+          localScope: {
+            parentNode: parentNode,
+            parentScope: state.localScope,
+            identifiers: {}
+          },
+          scopeIsStrict: scopeIsStrict
+        });
+
+        // All functions have an implicit 'arguments' object in scope
+        state.localScope.identifiers['arguments'] = true;
+
+        // Include function arg identifiers in the scope boundaries of the
+        // function
+        if (parentNode.params.length > 0) {
+          var param;
+          for (var i = 0; i < parentNode.params.length; i++) {
+            param = parentNode.params[i];
+            if (param.type === Syntax.Identifier) {
+              state.localScope.identifiers[param.name] = true;
+            }
+          }
+        }
+
+        // Named FunctionExpressions scope their name within the body block of
+        // themselves only
+        if (parentNode.type === Syntax.FunctionExpression && parentNode.id) {
+          state.localScope.identifiers[parentNode.id.name] = true;
+        }
+      }
+
+      // Traverse and find all local identifiers in this closure first to
+      // account for function/variable declaration hoisting
+      collectClosureIdentsAndTraverse(node, path, state);
+    }
+
+    if (_nodeIsBlockScopeBoundary(node, parentNode)) {
+      state = utils.updateState(state, {
+        localScope: {
+          parentNode: parentNode,
+          parentScope: state.localScope,
+          identifiers: {}
+        }
+      });
+
+      if (parentNode.type === Syntax.CatchClause) {
+        state.localScope.identifiers[parentNode.param.name] = true;
+      }
+      collectBlockIdentsAndTraverse(node, path, state);
+    }
+  }
+
+  // Only catchup() before and after traversing a child node
+  function traverser(node, path, state) {
+    node.range && utils.catchup(node.range[0], state);
+    traverse(node, path, state);
+    node.range && utils.catchup(node.range[1], state);
+  }
+
+  utils.analyzeAndTraverse(walker, traverser, node, path, state);
+}
+
+function collectClosureIdentsAndTraverse(node, path, state) {
+  utils.analyzeAndTraverse(
+    visitLocalClosureIdentifiers,
+    collectClosureIdentsAndTraverse,
+    node,
+    path,
+    state
+  );
+}
+
+function collectBlockIdentsAndTraverse(node, path, state) {
+  utils.analyzeAndTraverse(
+    visitLocalBlockIdentifiers,
+    collectBlockIdentsAndTraverse,
+    node,
+    path,
+    state
+  );
+}
+
+function visitLocalClosureIdentifiers(node, path, state) {
+  var identifiers = state.localScope.identifiers;
+  switch (node.type) {
+    case Syntax.FunctionExpression:
+      // Function expressions don't get their names (if there is one) added to
+      // the closure scope they're defined in
+      return false;
+    case Syntax.ClassDeclaration:
+    case Syntax.ClassExpression:
+    case Syntax.FunctionDeclaration:
+      if (node.id) {
+        identifiers[node.id.name] = true;
+      }
+      return false;
+    case Syntax.VariableDeclarator:
+      if (path[0].kind === 'var') {
+        identifiers[node.id.name] = true;
+      }
+      break;
+  }
+}
+
+function visitLocalBlockIdentifiers(node, path, state) {
+  // TODO: Support 'let' here...maybe...one day...or something...
+  if (node.type === Syntax.CatchClause) {
+    return false;
+  }
+}
+
+function walker(node, path, state) {
+  var visitors = state.g.visitors;
+  for (var i = 0; i < visitors.length; i++) {
+    if (visitors[i].test(node, path, state)) {
+      return visitors[i](traverse, node, path, state);
+    }
+  }
+}
+
+/**
+ * Applies all available transformations to the source
+ * @param {array} visitors
+ * @param {string} source
+ * @param {?object} options
+ * @return {object}
+ */
+function transform(visitors, source, options) {
+  options = options || {};
+
+  var ast;
+  try {
+    ast = esprima.parse(source, {
+      comment: true,
+      loc: true,
+      range: true
+    });
+  } catch (e) {
+    e.message = 'Parse Error: ' + e.message;
+    throw e;
+  }
+  var state = utils.createState(source, ast, options);
+  state.g.visitors = visitors;
+
+  if (options.sourceMap) {
+    var SourceMapGenerator = _dereq_('source-map').SourceMapGenerator;
+    state.g.sourceMap = new SourceMapGenerator({file: 'transformed.js'});
+  }
+
+  traverse(ast, [], state);
+  utils.catchup(source.length, state);
+
+  var ret = {code: state.g.buffer};
+  if (options.sourceMap) {
+    ret.sourceMap = state.g.sourceMap;
+    ret.sourceMapFilename =  options.filename || 'source.js';
+  }
+  return ret;
+}
+
+exports.transform = transform;
+
+},{"./utils":20,"esprima-fb":6,"source-map":8}],20:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+
+/*jslint node: true*/
+
+/**
+ * A `state` object represents the state of the parser. It has "local" and
+ * "global" parts. Global contains parser position, source, etc. Local contains
+ * scope based properties like current class name. State should contain all the
+ * info required for transformation. It's the only mandatory object that is
+ * being passed to every function in transform chain.
+ *
+ * @param  {string} source
+ * @param  {object} transformOptions
+ * @return {object}
+ */
+function createState(source, rootNode, transformOptions) {
+  return {
+    /**
+     * A tree representing the current local scope (and its lexical scope chain)
+     * Useful for tracking identifiers from parent scopes, etc.
+     * @type {Object}
+     */
+    localScope: {
+      parentNode: rootNode,
+      parentScope: null,
+      identifiers: {}
+    },
+    /**
+     * The name (and, if applicable, expression) of the super class
+     * @type {Object}
+     */
+    superClass: null,
+    /**
+     * The namespace to use when munging identifiers
+     * @type {String}
+     */
+    mungeNamespace: '',
+    /**
+     * Ref to the node for the FunctionExpression of the enclosing
+     * MethodDefinition
+     * @type {Object}
+     */
+    methodFuncNode: null,
+    /**
+     * Name of the enclosing class
+     * @type {String}
+     */
+    className: null,
+    /**
+     * Whether we're currently within a `strict` scope
+     * @type {Bool}
+     */
+    scopeIsStrict: null,
+    /**
+     * Global state (not affected by updateState)
+     * @type {Object}
+     */
+    g: {
+      /**
+       * A set of general options that transformations can consider while doing
+       * a transformation:
+       *
+       * - minify
+       *   Specifies that transformation steps should do their best to minify
+       *   the output source when possible. This is useful for places where
+       *   minification optimizations are possible with higher-level context
+       *   info than what jsxmin can provide.
+       *
+       *   For example, the ES6 class transform will minify munged private
+       *   variables if this flag is set.
+       */
+      opts: transformOptions,
+      /**
+       * Current position in the source code
+       * @type {Number}
+       */
+      position: 0,
+      /**
+       * Buffer containing the result
+       * @type {String}
+       */
+      buffer: '',
+      /**
+       * Indentation offset (only negative offset is supported now)
+       * @type {Number}
+       */
+      indentBy: 0,
+      /**
+       * Source that is being transformed
+       * @type {String}
+       */
+      source: source,
+
+      /**
+       * Cached parsed docblock (see getDocblock)
+       * @type {object}
+       */
+      docblock: null,
+
+      /**
+       * Whether the thing was used
+       * @type {Boolean}
+       */
+      tagNamespaceUsed: false,
+
+      /**
+       * If using bolt xjs transformation
+       * @type {Boolean}
+       */
+      isBolt: undefined,
+
+      /**
+       * Whether to record source map (expensive) or not
+       * @type {SourceMapGenerator|null}
+       */
+      sourceMap: null,
+
+      /**
+       * Filename of the file being processed. Will be returned as a source
+       * attribute in the source map
+       */
+      sourceMapFilename: 'source.js',
+
+      /**
+       * Only when source map is used: last line in the source for which
+       * source map was generated
+       * @type {Number}
+       */
+      sourceLine: 1,
+
+      /**
+       * Only when source map is used: last line in the buffer for which
+       * source map was generated
+       * @type {Number}
+       */
+      bufferLine: 1,
+
+      /**
+       * The top-level Program AST for the original file.
+       */
+      originalProgramAST: null,
+
+      sourceColumn: 0,
+      bufferColumn: 0
+    }
+  };
+}
+
+/**
+ * Updates a copy of a given state with "update" and returns an updated state.
+ *
+ * @param  {object} state
+ * @param  {object} update
+ * @return {object}
+ */
+function updateState(state, update) {
+  var ret = Object.create(state);
+  Object.keys(update).forEach(function(updatedKey) {
+    ret[updatedKey] = update[updatedKey];
+  });
+  return ret;
+}
+
+/**
+ * Given a state fill the resulting buffer from the original source up to
+ * the end
+ *
+ * @param {number} end
+ * @param {object} state
+ * @param {?function} contentTransformer Optional callback to transform newly
+ *                                       added content.
+ */
+function catchup(end, state, contentTransformer) {
+  if (end < state.g.position) {
+    // cannot move backwards
+    return;
+  }
+  var source = state.g.source.substring(state.g.position, end);
+  var transformed = updateIndent(source, state);
+  if (state.g.sourceMap && transformed) {
+    // record where we are
+    state.g.sourceMap.addMapping({
+      generated: { line: state.g.bufferLine, column: state.g.bufferColumn },
+      original: { line: state.g.sourceLine, column: state.g.sourceColumn },
+      source: state.g.sourceMapFilename
+    });
+
+    // record line breaks in transformed source
+    var sourceLines = source.split('\n');
+    var transformedLines = transformed.split('\n');
+    // Add line break mappings between last known mapping and the end of the
+    // added piece. So for the code piece
+    //  (foo, bar);
+    // > var x = 2;
+    // > var b = 3;
+    //   var c =
+    // only add lines marked with ">": 2, 3.
+    for (var i = 1; i < sourceLines.length - 1; i++) {
+      state.g.sourceMap.addMapping({
+        generated: { line: state.g.bufferLine, column: 0 },
+        original: { line: state.g.sourceLine, column: 0 },
+        source: state.g.sourceMapFilename
+      });
+      state.g.sourceLine++;
+      state.g.bufferLine++;
+    }
+    // offset for the last piece
+    if (sourceLines.length > 1) {
+      state.g.sourceLine++;
+      state.g.bufferLine++;
+      state.g.sourceColumn = 0;
+      state.g.bufferColumn = 0;
+    }
+    state.g.sourceColumn += sourceLines[sourceLines.length - 1].length;
+    state.g.bufferColumn +=
+      transformedLines[transformedLines.length - 1].length;
+  }
+  state.g.buffer +=
+    contentTransformer ? contentTransformer(transformed) : transformed;
+  state.g.position = end;
+}
+
+/**
+ * Removes all non-whitespace characters
+ */
+var reNonWhite = /(\S)/g;
+function stripNonWhite(value) {
+  return value.replace(reNonWhite, function() {
+    return '';
+  });
+}
+
+/**
+ * Catches up as `catchup` but removes all non-whitespace characters.
+ */
+function catchupWhiteSpace(end, state) {
+  catchup(end, state, stripNonWhite);
+}
+
+/**
+ * Removes all non-newline characters
+ */
+var reNonNewline = /[^\n]/g;
+function stripNonNewline(value) {
+  return value.replace(reNonNewline, function() {
+    return '';
+  });
+}
+
+/**
+ * Catches up as `catchup` but removes all non-newline characters.
+ *
+ * Equivalent to appending as many newlines as there are in the original source
+ * between the current position and `end`.
+ */
+function catchupNewlines(end, state) {
+  catchup(end, state, stripNonNewline);
+}
+
+
+/**
+ * Same as catchup but does not touch the buffer
+ *
+ * @param  {number} end
+ * @param  {object} state
+ */
+function move(end, state) {
+  // move the internal cursors
+  if (state.g.sourceMap) {
+    if (end < state.g.position) {
+      state.g.position = 0;
+      state.g.sourceLine = 1;
+      state.g.sourceColumn = 0;
+    }
+
+    var source = state.g.source.substring(state.g.position, end);
+    var sourceLines = source.split('\n');
+    if (sourceLines.length > 1) {
+      state.g.sourceLine += sourceLines.length - 1;
+      state.g.sourceColumn = 0;
+    }
+    state.g.sourceColumn += sourceLines[sourceLines.length - 1].length;
+  }
+  state.g.position = end;
+}
+
+/**
+ * Appends a string of text to the buffer
+ *
+ * @param {string} str
+ * @param {object} state
+ */
+function append(str, state) {
+  if (state.g.sourceMap && str) {
+    state.g.sourceMap.addMapping({
+      generated: { line: state.g.bufferLine, column: state.g.bufferColumn },
+      original: { line: state.g.sourceLine, column: state.g.sourceColumn },
+      source: state.g.sourceMapFilename
+    });
+    var transformedLines = str.split('\n');
+    if (transformedLines.length > 1) {
+      state.g.bufferLine += transformedLines.length - 1;
+      state.g.bufferColumn = 0;
+    }
+    state.g.bufferColumn +=
+      transformedLines[transformedLines.length - 1].length;
+  }
+  state.g.buffer += str;
+}
+
+/**
+ * Update indent using state.indentBy property. Indent is measured in
+ * double spaces. Updates a single line only.
+ *
+ * @param {string} str
+ * @param {object} state
+ * @return {string}
+ */
+function updateIndent(str, state) {
+  for (var i = 0; i < -state.g.indentBy; i++) {
+    str = str.replace(/(^|\n)( {2}|\t)/g, '$1');
+  }
+  return str;
+}
+
+/**
+ * Calculates indent from the beginning of the line until "start" or the first
+ * character before start.
+ * @example
+ *   "  foo.bar()"
+ *         ^
+ *       start
+ *   indent will be 2
+ *
+ * @param  {number} start
+ * @param  {object} state
+ * @return {number}
+ */
+function indentBefore(start, state) {
+  var end = start;
+  start = start - 1;
+
+  while (start > 0 && state.g.source[start] != '\n') {
+    if (!state.g.source[start].match(/[ \t]/)) {
+      end = start;
+    }
+    start--;
+  }
+  return state.g.source.substring(start + 1, end);
+}
+
+function getDocblock(state) {
+  if (!state.g.docblock) {
+    var docblock = _dereq_('./docblock');
+    state.g.docblock =
+      docblock.parseAsObject(docblock.extract(state.g.source));
+  }
+  return state.g.docblock;
+}
+
+function identWithinLexicalScope(identName, state, stopBeforeNode) {
+  var currScope = state.localScope;
+  while (currScope) {
+    if (currScope.identifiers[identName] !== undefined) {
+      return true;
+    }
+
+    if (stopBeforeNode && currScope.parentNode === stopBeforeNode) {
+      break;
+    }
+
+    currScope = currScope.parentScope;
+  }
+  return false;
+}
+
+function identInLocalScope(identName, state) {
+  return state.localScope.identifiers[identName] !== undefined;
+}
+
+function declareIdentInLocalScope(identName, state) {
+  state.localScope.identifiers[identName] = true;
+}
+
+/**
+ * Apply the given analyzer function to the current node. If the analyzer
+ * doesn't return false, traverse each child of the current node using the given
+ * traverser function.
+ *
+ * @param {function} analyzer
+ * @param {function} traverser
+ * @param {object} node
+ * @param {function} visitor
+ * @param {array} path
+ * @param {object} state
+ */
+function analyzeAndTraverse(analyzer, traverser, node, path, state) {
+  var key, child;
+
+  if (node.type) {
+    if (analyzer(node, path, state) === false) {
+      return;
+    }
+    path.unshift(node);
+  }
+
+  for (key in node) {
+    // skip obviously wrong attributes
+    if (key === 'range' || key === 'loc') {
+      continue;
+    }
+    if (node.hasOwnProperty(key)) {
+      child = node[key];
+      if (typeof child === 'object' && child !== null) {
+        traverser(child, path, state);
+      }
+    }
+  }
+  node.type && path.shift();
+}
+
+/**
+ * Checks whether a node or any of its sub-nodes contains
+ * a syntactic construct of the passed type.
+ * @param {object} node - AST node to test.
+ * @param {string} type - node type to lookup.
+ */
+function containsChildOfType(node, type) {
+  var foundMatchingChild = false;
+  function nodeTypeAnalyzer(node) {
+    if (node.type === type) {
+      foundMatchingChild = true;
+      return false;
+    }
+  }
+  function nodeTypeTraverser(child, path, state) {
+    if (!foundMatchingChild) {
+      foundMatchingChild = containsChildOfType(child, type);
+    }
+  }
+  analyzeAndTraverse(
+    nodeTypeAnalyzer,
+    nodeTypeTraverser,
+    node,
+    []
+  );
+  return foundMatchingChild;
+}
+
+exports.append = append;
+exports.catchup = catchup;
+exports.catchupWhiteSpace = catchupWhiteSpace;
+exports.catchupNewlines = catchupNewlines;
+exports.containsChildOfType = containsChildOfType;
+exports.createState = createState;
+exports.declareIdentInLocalScope = declareIdentInLocalScope;
+exports.getDocblock = getDocblock;
+exports.identWithinLexicalScope = identWithinLexicalScope;
+exports.identInLocalScope = identInLocalScope;
+exports.indentBefore = indentBefore;
+exports.move = move;
+exports.updateIndent = updateIndent;
+exports.updateState = updateState;
+exports.analyzeAndTraverse = analyzeAndTraverse;
+
+},{"./docblock":18}],21:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+/*global exports:true*/
+
+/**
+ * Desugars ES6 Arrow functions to ES3 function expressions.
+ * If the function contains `this` expression -- automatically
+ * binds the funciton to current value of `this`.
+ *
+ * Single parameter, simple expression:
+ *
+ * [1, 2, 3].map(x => x * x);
+ *
+ * [1, 2, 3].map(function(x) { return x * x; });
+ *
+ * Several parameters, complex block:
+ *
+ * this.users.forEach((user, idx) => {
+ *   return this.isActive(idx) && this.send(user);
+ * });
+ *
+ * this.users.forEach(function(user, idx) {
+ *   return this.isActive(idx) && this.send(user);
+ * }.bind(this));
+ *
+ */
+var restParamVisitors = _dereq_('./es6-rest-param-visitors');
+var Syntax = _dereq_('esprima-fb').Syntax;
+var utils = _dereq_('../src/utils');
+
+/**
+ * @public
+ */
+function visitArrowFunction(traverse, node, path, state) {
+  // Prologue.
+  utils.append('function', state);
+  renderParams(node, state);
+
+  // Skip arrow.
+  utils.catchupWhiteSpace(node.body.range[0], state);
+
+  var renderBody = node.body.type == Syntax.BlockStatement
+    ? renderStatementBody
+    : renderExpressionBody;
+
+  path.unshift(node);
+  renderBody(traverse, node, path, state);
+  path.shift();
+
+  // Bind the function only if `this` value is used
+  // inside it or inside any sub-expression.
+  if (utils.containsChildOfType(node.body, Syntax.ThisExpression)) {
+    utils.append('.bind(this)', state);
+  }
+
+  return false;
+}
+
+function renderParams(node, state) {
+  // To preserve inline typechecking directives, we
+  // distinguish between parens-free and paranthesized single param.
+  if (isParensFreeSingleParam(node, state) || !node.params.length) {
+    utils.append('(', state);
+  }
+  if (node.params.length !== 0) {
+    utils.catchup(node.params[node.params.length - 1].range[1], state);
+  }
+  utils.append(')', state);
+}
+
+function isParensFreeSingleParam(node, state) {
+  return node.params.length === 1 &&
+    state.g.source[state.g.position] !== '(';
+}
+
+function renderExpressionBody(traverse, node, path, state) {
+  // Wrap simple expression bodies into a block
+  // with explicit return statement.
+  utils.append('{', state);
+  if (node.rest) {
+    utils.append(
+      restParamVisitors.renderRestParamSetup(node),
+      state
+    );
+  }
+  utils.append('return ', state);
+  renderStatementBody(traverse, node, path, state);
+  utils.append(';}', state);
+}
+
+function renderStatementBody(traverse, node, path, state) {
+  traverse(node.body, path, state);
+  utils.catchup(node.body.range[1], state);
+}
+
+visitArrowFunction.test = function(node, path, state) {
+  return node.type === Syntax.ArrowFunctionExpression;
+};
+
+exports.visitorList = [
+  visitArrowFunction
+];
+
+
+},{"../src/utils":20,"./es6-rest-param-visitors":24,"esprima-fb":6}],22:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+/*jslint node:true*/
+
+/**
+ * @typechecks
+ */
+'use strict';
+
+var base62 = _dereq_('base62');
+var Syntax = _dereq_('esprima-fb').Syntax;
+var utils = _dereq_('../src/utils');
+
+var SUPER_PROTO_IDENT_PREFIX = '____SuperProtoOf';
+
+var _anonClassUUIDCounter = 0;
+var _mungedSymbolMaps = {};
+
+/**
+ * Used to generate a unique class for use with code-gens for anonymous class
+ * expressions.
+ *
+ * @param {object} state
+ * @return {string}
+ */
+function _generateAnonymousClassName(state) {
+  var mungeNamespace = state.mungeNamespace || '';
+  return '____Class' + mungeNamespace + base62.encode(_anonClassUUIDCounter++);
+}
+
+/**
+ * Given an identifier name, munge it using the current state's mungeNamespace.
+ *
+ * @param {string} identName
+ * @param {object} state
+ * @return {string}
+ */
+function _getMungedName(identName, state) {
+  var mungeNamespace = state.mungeNamespace;
+  var shouldMinify = state.g.opts.minify;
+
+  if (shouldMinify) {
+    if (!_mungedSymbolMaps[mungeNamespace]) {
+      _mungedSymbolMaps[mungeNamespace] = {
+        symbolMap: {},
+        identUUIDCounter: 0
+      };
+    }
+
+    var symbolMap = _mungedSymbolMaps[mungeNamespace].symbolMap;
+    if (!symbolMap[identName]) {
+      symbolMap[identName] =
+        base62.encode(_mungedSymbolMaps[mungeNamespace].identUUIDCounter++);
+    }
+    identName = symbolMap[identName];
+  }
+  return '$' + mungeNamespace + identName;
+}
+
+/**
+ * Extracts super class information from a class node.
+ *
+ * Information includes name of the super class and/or the expression string
+ * (if extending from an expression)
+ *
+ * @param {object} node
+ * @param {object} state
+ * @return {object}
+ */
+function _getSuperClassInfo(node, state) {
+  var ret = {
+    name: null,
+    expression: null
+  };
+  if (node.superClass) {
+    if (node.superClass.type === Syntax.Identifier) {
+      ret.name = node.superClass.name;
+    } else {
+      // Extension from an expression
+      ret.name = _generateAnonymousClassName(state);
+      ret.expression = state.g.source.substring(
+        node.superClass.range[0],
+        node.superClass.range[1]
+      );
+    }
+  }
+  return ret;
+}
+
+/**
+ * Used with .filter() to find the constructor method in a list of
+ * MethodDefinition nodes.
+ *
+ * @param {object} classElement
+ * @return {boolean}
+ */
+function _isConstructorMethod(classElement) {
+  return classElement.type === Syntax.MethodDefinition &&
+         classElement.key.type === Syntax.Identifier &&
+         classElement.key.name === 'constructor';
+}
+
+/**
+ * @param {object} node
+ * @param {object} state
+ * @return {boolean}
+ */
+function _shouldMungeIdentifier(node, state) {
+  return (
+    !!state.methodFuncNode &&
+    !utils.getDocblock(state).hasOwnProperty('preventMunge') &&
+    /^_(?!_)/.test(node.name)
+  );
+}
+
+/**
+ * @param {function} traverse
+ * @param {object} node
+ * @param {array} path
+ * @param {object} state
+ */
+function visitClassMethod(traverse, node, path, state) {
+  utils.catchup(node.range[0], state);
+  path.unshift(node);
+  traverse(node.value, path, state);
+  path.shift();
+  return false;
+}
+visitClassMethod.test = function(node, path, state) {
+  return node.type === Syntax.MethodDefinition;
+};
+
+/**
+ * @param {function} traverse
+ * @param {object} node
+ * @param {array} path
+ * @param {object} state
+ */
+function visitClassFunctionExpression(traverse, node, path, state) {
+  var methodNode = path[0];
+
+  state = utils.updateState(state, {
+    methodFuncNode: node
+  });
+
+  if (methodNode.key.name === 'constructor') {
+    utils.append('function ' + state.className, state);
+  } else {
+    var methodName = methodNode.key.name;
+    if (_shouldMungeIdentifier(methodNode.key, state)) {
+      methodName = _getMungedName(methodName, state);
+    }
+
+    var prototypeOrStatic = methodNode["static"] ? '' : 'prototype.';
+    utils.append(
+      state.className + '.' + prototypeOrStatic + methodName + '=function',
+      state
+    );
+  }
+  utils.move(methodNode.key.range[1], state);
+
+  var params = node.params;
+  var paramName;
+  if (params.length > 0) {
+    for (var i = 0; i < params.length; i++) {
+      utils.catchup(node.params[i].range[0], state);
+      paramName = params[i].name;
+      if (_shouldMungeIdentifier(params[i], state)) {
+        paramName = _getMungedName(params[i].name, state);
+      }
+      utils.append(paramName, state);
+      utils.move(params[i].range[1], state);
+    }
+  } else {
+    utils.append('(', state);
+  }
+  utils.append(')', state);
+  utils.catchupWhiteSpace(node.body.range[0], state);
+  utils.append('{', state);
+  if (!state.scopeIsStrict) {
+    utils.append('"use strict";', state);
+  }
+  utils.move(node.body.range[0] + '{'.length, state);
+
+  path.unshift(node);
+  traverse(node.body, path, state);
+  path.shift();
+  utils.catchup(node.body.range[1], state);
+
+  if (methodNode.key.name !== 'constructor') {
+    utils.append(';', state);
+  }
+  return false;
+}
+visitClassFunctionExpression.test = function(node, path, state) {
+  return node.type === Syntax.FunctionExpression
+         && path[0].type === Syntax.MethodDefinition;
+};
+
+/**
+ * @param {function} traverse
+ * @param {object} node
+ * @param {array} path
+ * @param {object} state
+ */
+function _renderClassBody(traverse, node, path, state) {
+  var className = state.className;
+  var superClass = state.superClass;
+
+  // Set up prototype of constructor on same line as `extends` for line-number
+  // preservation. This relies on function-hoisting if a constructor function is
+  // defined in the class body.
+  if (superClass.name) {
+    // If the super class is an expression, we need to memoize the output of the
+    // expression into the generated class name variable and use that to refer
+    // to the super class going forward. Example:
+    //
+    //   class Foo extends mixin(Bar, Baz) {}
+    //     --transforms to--
+    //   function Foo() {} var ____Class0Blah = mixin(Bar, Baz);
+    if (superClass.expression !== null) {
+      utils.append(
+        'var ' + superClass.name + '=' + superClass.expression + ';',
+        state
+      );
+    }
+
+    var keyName = superClass.name + '____Key';
+    var keyNameDeclarator = '';
+    if (!utils.identWithinLexicalScope(keyName, state)) {
+      keyNameDeclarator = 'var ';
+      utils.declareIdentInLocalScope(keyName, state);
+    }
+    utils.append(
+      'for(' + keyNameDeclarator + keyName + ' in ' + superClass.name + '){' +
+        'if(' + superClass.name + '.hasOwnProperty(' + keyName + ')){' +
+          className + '[' + keyName + ']=' +
+            superClass.name + '[' + keyName + '];' +
+        '}' +
+      '}',
+      state
+    );
+
+    var superProtoIdentStr = SUPER_PROTO_IDENT_PREFIX + superClass.name;
+    if (!utils.identWithinLexicalScope(superProtoIdentStr, state)) {
+      utils.append(
+        'var ' + superProtoIdentStr + '=' + superClass.name + '===null?' +
+        'null:' + superClass.name + '.prototype;',
+        state
+      );
+      utils.declareIdentInLocalScope(superProtoIdentStr, state);
+    }
+
+    utils.append(
+      className + '.prototype=Object.create(' + superProtoIdentStr + ');',
+      state
+    );
+    utils.append(
+      className + '.prototype.constructor=' + className + ';',
+      state
+    );
+    utils.append(
+      className + '.__superConstructor__=' + superClass.name + ';',
+      state
+    );
+  }
+
+  // If there's no constructor method specified in the class body, create an
+  // empty constructor function at the top (same line as the class keyword)
+  if (!node.body.body.filter(_isConstructorMethod).pop()) {
+    utils.append('function ' + className + '(){', state);
+    if (!state.scopeIsStrict) {
+      utils.append('"use strict";', state);
+    }
+    if (superClass.name) {
+      utils.append(
+        'if(' + superClass.name + '!==null){' +
+        superClass.name + '.apply(this,arguments);}',
+        state
+      );
+    }
+    utils.append('}', state);
+  }
+
+  utils.move(node.body.range[0] + '{'.length, state);
+  traverse(node.body, path, state);
+  utils.catchupWhiteSpace(node.range[1], state);
+}
+
+/**
+ * @param {function} traverse
+ * @param {object} node
+ * @param {array} path
+ * @param {object} state
+ */
+function visitClassDeclaration(traverse, node, path, state) {
+  var className = node.id.name;
+  var superClass = _getSuperClassInfo(node, state);
+
+  state = utils.updateState(state, {
+    mungeNamespace: className,
+    className: className,
+    superClass: superClass
+  });
+
+  _renderClassBody(traverse, node, path, state);
+
+  return false;
+}
+visitClassDeclaration.test = function(node, path, state) {
+  return node.type === Syntax.ClassDeclaration;
+};
+
+/**
+ * @param {function} traverse
+ * @param {object} node
+ * @param {array} path
+ * @param {object} state
+ */
+function visitClassExpression(traverse, node, path, state) {
+  var className = node.id && node.id.name || _generateAnonymousClassName(state);
+  var superClass = _getSuperClassInfo(node, state);
+
+  utils.append('(function(){', state);
+
+  state = utils.updateState(state, {
+    mungeNamespace: className,
+    className: className,
+    superClass: superClass
+  });
+
+  _renderClassBody(traverse, node, path, state);
+
+  utils.append('return ' + className + ';})()', state);
+  return false;
+}
+visitClassExpression.test = function(node, path, state) {
+  return node.type === Syntax.ClassExpression;
+};
+
+/**
+ * @param {function} traverse
+ * @param {object} node
+ * @param {array} path
+ * @param {object} state
+ */
+function visitPrivateIdentifier(traverse, node, path, state) {
+  utils.append(_getMungedName(node.name, state), state);
+  utils.move(node.range[1], state);
+}
+visitPrivateIdentifier.test = function(node, path, state) {
+  if (node.type === Syntax.Identifier && _shouldMungeIdentifier(node, state)) {
+    // Always munge non-computed properties of MemberExpressions
+    // (a la preventing access of properties of unowned objects)
+    if (path[0].type === Syntax.MemberExpression && path[0].object !== node
+        && path[0].computed === false) {
+      return true;
+    }
+
+    // Always munge identifiers that were declared within the method function
+    // scope
+    if (utils.identWithinLexicalScope(node.name, state, state.methodFuncNode)) {
+      return true;
+    }
+
+    // Always munge private keys on object literals defined within a method's
+    // scope.
+    if (path[0].type === Syntax.Property
+        && path[1].type === Syntax.ObjectExpression) {
+      return true;
+    }
+
+    // Always munge function parameters
+    if (path[0].type === Syntax.FunctionExpression
+        || path[0].type === Syntax.FunctionDeclaration) {
+      for (var i = 0; i < path[0].params.length; i++) {
+        if (path[0].params[i] === node) {
+          return true;
+        }
+      }
+    }
+  }
+  return false;
+};
+
+/**
+ * @param {function} traverse
+ * @param {object} node
+ * @param {array} path
+ * @param {object} state
+ */
+function visitSuperCallExpression(traverse, node, path, state) {
+  var superClassName = state.superClass.name;
+
+  if (node.callee.type === Syntax.Identifier) {
+    utils.append(superClassName + '.call(', state);
+    utils.move(node.callee.range[1], state);
+  } else if (node.callee.type === Syntax.MemberExpression) {
+    utils.append(SUPER_PROTO_IDENT_PREFIX + superClassName, state);
+    utils.move(node.callee.object.range[1], state);
+
+    if (node.callee.computed) {
+      // ["a" + "b"]
+      utils.catchup(node.callee.property.range[1] + ']'.length, state);
+    } else {
+      // .ab
+      utils.append('.' + node.callee.property.name, state);
+    }
+
+    utils.append('.call(', state);
+    utils.move(node.callee.range[1], state);
+  }
+
+  utils.append('this', state);
+  if (node.arguments.length > 0) {
+    utils.append(',', state);
+    utils.catchupWhiteSpace(node.arguments[0].range[0], state);
+    traverse(node.arguments, path, state);
+  }
+
+  utils.catchupWhiteSpace(node.range[1], state);
+  utils.append(')', state);
+  return false;
+}
+visitSuperCallExpression.test = function(node, path, state) {
+  if (state.superClass && node.type === Syntax.CallExpression) {
+    var callee = node.callee;
+    if (callee.type === Syntax.Identifier && callee.name === 'super'
+        || callee.type == Syntax.MemberExpression
+           && callee.object.name === 'super') {
+      return true;
+    }
+  }
+  return false;
+};
+
+/**
+ * @param {function} traverse
+ * @param {object} node
+ * @param {array} path
+ * @param {object} state
+ */
+function visitSuperMemberExpression(traverse, node, path, state) {
+  var superClassName = state.superClass.name;
+
+  utils.append(SUPER_PROTO_IDENT_PREFIX + superClassName, state);
+  utils.move(node.object.range[1], state);
+}
+visitSuperMemberExpression.test = function(node, path, state) {
+  return state.superClass
+         && node.type === Syntax.MemberExpression
+         && node.object.type === Syntax.Identifier
+         && node.object.name === 'super';
+};
+
+exports.visitorList = [
+  visitClassDeclaration,
+  visitClassExpression,
+  visitClassFunctionExpression,
+  visitClassMethod,
+  visitPrivateIdentifier,
+  visitSuperCallExpression,
+  visitSuperMemberExpression
+];
+
+},{"../src/utils":20,"base62":7,"esprima-fb":6}],23:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+/*jslint node: true*/
+
+/**
+ * Desugars ES6 Object Literal short notations into ES3 full notation.
+ *
+ * // Easier return values.
+ * function foo(x, y) {
+ *   return {x, y}; // {x: x, y: y}
+ * };
+ *
+ * // Destrucruting.
+ * function init({port, ip, coords: {x, y}}) { ... }
+ *
+ */
+var Syntax = _dereq_('esprima-fb').Syntax;
+var utils = _dereq_('../src/utils');
+
+/**
+ * @public
+ */
+function visitObjectLiteralShortNotation(traverse, node, path, state) {
+  utils.catchup(node.key.range[1], state);
+  utils.append(':' + node.key.name, state);
+  return false;
+}
+
+visitObjectLiteralShortNotation.test = function(node, path, state) {
+  return node.type === Syntax.Property &&
+    node.kind === 'init' &&
+    node.shorthand === true;
+};
+
+exports.visitorList = [
+  visitObjectLiteralShortNotation
+];
+
+
+},{"../src/utils":20,"esprima-fb":6}],24:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+/*jslint node:true*/
+
+/**
+ * Desugars ES6 rest parameters into ES3 arguments slicing.
+ *
+ * function printf(template, ...args) {
+ *   args.forEach(...);
+ * };
+ *
+ * function printf(template) {
+ *   var args = [].slice.call(arguments, 1);
+ *   args.forEach(...);
+ * };
+ *
+ */
+var Syntax = _dereq_('esprima-fb').Syntax;
+var utils = _dereq_('../src/utils');
+
+function _nodeIsFunctionWithRestParam(node) {
+  return (node.type === Syntax.FunctionDeclaration
+          || node.type === Syntax.FunctionExpression
+          || node.type === Syntax.ArrowFunctionExpression)
+         && node.rest;
+}
+
+function visitFunctionParamsWithRestParam(traverse, node, path, state) {
+  // Render params.
+  if (node.params.length) {
+    utils.catchup(node.params[node.params.length - 1].range[1], state);
+  } else {
+    // -3 is for ... of the rest.
+    utils.catchup(node.rest.range[0] - 3, state);
+  }
+  utils.catchupWhiteSpace(node.rest.range[1], state);
+}
+
+visitFunctionParamsWithRestParam.test = function(node, path, state) {
+  return _nodeIsFunctionWithRestParam(node);
+};
+
+function renderRestParamSetup(functionNode) {
+  return 'var ' + functionNode.rest.name + '=Array.prototype.slice.call(' +
+           'arguments,' +
+           functionNode.params.length +
+         ');';
+}
+
+function visitFunctionBodyWithRestParam(traverse, node, path, state) {
+  utils.catchup(node.range[0] + 1, state);
+  var parentNode = path[0];
+  utils.append(renderRestParamSetup(parentNode), state);
+  traverse(node.body, path, state);
+  return false;
+}
+
+visitFunctionBodyWithRestParam.test = function(node, path, state) {
+  return node.type === Syntax.BlockStatement
+         && _nodeIsFunctionWithRestParam(path[0]);
+};
+
+exports.renderRestParamSetup = renderRestParamSetup;
+exports.visitorList = [
+  visitFunctionParamsWithRestParam,
+  visitFunctionBodyWithRestParam
+];
+
+},{"../src/utils":20,"esprima-fb":6}],25:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+/*jslint node:true*/
+
+/**
+ * @typechecks
+ */
+'use strict';
+
+var Syntax = _dereq_('esprima-fb').Syntax;
+var utils = _dereq_('../src/utils');
+
+/**
+ * http://people.mozilla.org/~jorendorff/es6-draft.html#sec-12.1.9
+ */
+function visitTemplateLiteral(traverse, node, path, state) {
+  var templateElements = node.quasis;
+
+  utils.append('(', state);
+  for (var ii = 0; ii < templateElements.length; ii++) {
+    var templateElement = templateElements[ii];
+    if (templateElement.value.raw !== '') {
+      utils.append(getCookedValue(templateElement), state);
+      if (!templateElement.tail) {
+        // + between element and substitution
+        utils.append(' + ', state);
+      }
+      // maintain line numbers
+      utils.move(templateElement.range[0], state);
+      utils.catchupNewlines(templateElement.range[1], state);
+    }
+    utils.move(templateElement.range[1], state);
+    if (!templateElement.tail) {
+      var substitution = node.expressions[ii];
+      if (substitution.type === Syntax.Identifier ||
+          substitution.type === Syntax.MemberExpression ||
+          substitution.type === Syntax.CallExpression) {
+        utils.catchup(substitution.range[1], state);
+      } else {
+        utils.append('(', state);
+        traverse(substitution, path, state);
+        utils.catchup(substitution.range[1], state);
+        utils.append(')', state);
+      }
+      // if next templateElement isn't empty...
+      if (templateElements[ii + 1].value.cooked !== '') {
+        utils.append(' + ', state);
+      }
+    }
+  }
+  utils.move(node.range[1], state);
+  utils.append(')', state);
+  return false;
+}
+
+visitTemplateLiteral.test = function(node, path, state) {
+  return node.type === Syntax.TemplateLiteral;
+};
+
+/**
+ * http://people.mozilla.org/~jorendorff/es6-draft.html#sec-12.2.6
+ */
+function visitTaggedTemplateExpression(traverse, node, path, state) {
+  var template = node.quasi;
+  var numQuasis = template.quasis.length;
+
+  // print the tag
+  utils.move(node.tag.range[0], state);
+  traverse(node.tag, path, state);
+  utils.catchup(node.tag.range[1], state);
+
+  // print array of template elements
+  utils.append('(function() { var siteObj = [', state);
+  for (var ii = 0; ii < numQuasis; ii++) {
+    utils.append(getCookedValue(template.quasis[ii]), state);
+    if (ii !== numQuasis - 1) {
+      utils.append(', ', state);
+    }
+  }
+  utils.append(']; siteObj.raw = [', state);
+  for (ii = 0; ii < numQuasis; ii++) {
+    utils.append(getRawValue(template.quasis[ii]), state);
+    if (ii !== numQuasis - 1) {
+      utils.append(', ', state);
+    }
+  }
+  utils.append(
+    ']; Object.freeze(siteObj.raw); Object.freeze(siteObj); return siteObj; }()',
+    state
+  );
+
+  // print substitutions
+  if (numQuasis > 1) {
+    for (ii = 0; ii < template.expressions.length; ii++) {
+      var expression = template.expressions[ii];
+      utils.append(', ', state);
+
+      // maintain line numbers by calling catchupWhiteSpace over the whole
+      // previous TemplateElement
+      utils.move(template.quasis[ii].range[0], state);
+      utils.catchupNewlines(template.quasis[ii].range[1], state);
+
+      utils.move(expression.range[0], state);
+      traverse(expression, path, state);
+      utils.catchup(expression.range[1], state);
+    }
+  }
+
+  // print blank lines to push the closing ) down to account for the final
+  // TemplateElement.
+  utils.catchupNewlines(node.range[1], state);
+
+  utils.append(')', state);
+
+  return false;
+}
+
+visitTaggedTemplateExpression.test = function(node, path, state) {
+  return node.type === Syntax.TaggedTemplateExpression;
+};
+
+function getCookedValue(templateElement) {
+  return JSON.stringify(templateElement.value.cooked);
+}
+
+function getRawValue(templateElement) {
+  return JSON.stringify(templateElement.value.raw);
+}
+
+exports.visitorList = [
+  visitTemplateLiteral,
+  visitTaggedTemplateExpression
+];
+
+},{"../src/utils":20,"esprima-fb":6}],26:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+/* jshint browser: true */
+/* jslint evil: true */
+
+'use strict';
+var runScripts;
+var headEl;
+
+var buffer = _dereq_('buffer');
+var transform = _dereq_('jstransform').transform;
+var visitors = _dereq_('./fbtransform/visitors').transformVisitors;
+var docblock = _dereq_('jstransform/src/docblock');
+
+// The source-map library relies on Object.defineProperty, but IE8 doesn't
+// support it fully even with es5-sham. Indeed, es5-sham's defineProperty
+// throws when Object.prototype.__defineGetter__ is missing, so we skip building
+// the source map in that case.
+var supportsAccessors = Object.prototype.hasOwnProperty('__defineGetter__');
+
+function transformReact(source) {
+  return transform(visitors.react, source, {
+    sourceMap: supportsAccessors
+  });
+}
+
+exports.transform = transformReact;
+
+exports.exec = function(code) {
+  return eval(transformReact(code).code);
+};
+
+var inlineScriptCount = 0;
+
+// This method returns a nicely formated line of code pointing the
+// exactly location of the error `e`.
+// The line is limited in size so big lines of code are also shown
+// in a readable way.
+// Example:
+//
+// ... x', overflow:'scroll'}} id={} onScroll={this.scroll} class=" ...
+//                                 ^
+var createSourceCodeErrorMessage = function(code, e) {
+  var sourceLines = code.split('\n');
+  var erroneousLine = sourceLines[e.lineNumber - 1];
+
+  // Removes any leading indenting spaces and gets the number of
+  // chars indenting the `erroneousLine`
+  var indentation = 0;
+  erroneousLine = erroneousLine.replace(/^\s+/, function(leadingSpaces) {
+    indentation = leadingSpaces.length;
+    return '';
+  });
+
+  // Defines the number of characters that are going to show
+  // before and after the erroneous code
+  var LIMIT = 30;
+  var errorColumn = e.column - indentation;
+
+  if (errorColumn > LIMIT) {
+    erroneousLine = '... ' + erroneousLine.slice(errorColumn - LIMIT);
+    errorColumn = 4 + LIMIT;
+  }
+  if (erroneousLine.length - errorColumn > LIMIT) {
+    erroneousLine = erroneousLine.slice(0, errorColumn + LIMIT) + ' ...';
+  }
+  var message = '\n\n' + erroneousLine + '\n';
+  message += new Array(errorColumn - 1).join(' ') + '^';
+  return message;
+};
+
+var transformCode = function(code, source) {
+  var jsx = docblock.parseAsObject(docblock.extract(code)).jsx;
+
+  if (jsx) {
+    try {
+      var transformed = transformReact(code);
+    } catch(e) {
+      e.message += '\n    at ';
+      if (source) {
+        if ('fileName' in e) {
+          // We set `fileName` if it's supported by this error object and
+          // a `source` was provided.
+          // The error will correctly point to `source` in Firefox.
+          e.fileName = source;
+        }
+        e.message += source + ':' + e.lineNumber + ':' + e.column;
+      } else {
+        e.message += location.href;
+      }
+      e.message += createSourceCodeErrorMessage(code, e);
+      throw e;
+    }
+
+    if (!transformed.sourceMap) {
+      return transformed.code;
+    }
+
+    var map = transformed.sourceMap.toJSON();
+    if (source == null) {
+      source = "Inline JSX script";
+      inlineScriptCount++;
+      if (inlineScriptCount > 1) {
+        source += ' (' + inlineScriptCount + ')';
+      }
+    }
+    map.sources = [source];
+    map.sourcesContent = [code];
+
+    return (
+      transformed.code +
+      '//# sourceMappingURL=data:application/json;base64,' +
+      buffer.Buffer(JSON.stringify(map)).toString('base64')
+    );
+  } else {
+    return code;
+  }
+};
+
+var run = exports.run = function(code, source) {
+  var scriptEl = document.createElement('script');
+  scriptEl.text = transformCode(code, source);
+  headEl.appendChild(scriptEl);
+};
+
+var load = exports.load = function(url, callback) {
+  var xhr;
+  xhr = window.ActiveXObject ? new window.ActiveXObject('Microsoft.XMLHTTP')
+                             : new XMLHttpRequest();
+
+  // Disable async since we need to execute scripts in the order they are in the
+  // DOM to mirror normal script loading.
+  xhr.open('GET', url, false);
+  if ('overrideMimeType' in xhr) {
+    xhr.overrideMimeType('text/plain');
+  }
+  xhr.onreadystatechange = function() {
+    if (xhr.readyState === 4) {
+      if (xhr.status === 0 || xhr.status === 200) {
+        run(xhr.responseText, url);
+      } else {
+        throw new Error("Could not load " + url);
+      }
+      if (callback) {
+        return callback();
+      }
+    }
+  };
+  return xhr.send(null);
+};
+
+runScripts = function() {
+  var scripts = document.getElementsByTagName('script');
+
+  // Array.prototype.slice cannot be used on NodeList on IE8
+  var jsxScripts = [];
+  for (var i = 0; i < scripts.length; i++) {
+    if (scripts.item(i).type === 'text/jsx') {
+      jsxScripts.push(scripts.item(i));
+    }
+  }
+
+  console.warn("You are using the in-browser JSX transformer. Be sure to precompile your JSX for production - http://facebook.github.io/react/docs/tooling-integration.html#jsx");
+
+  jsxScripts.forEach(function(script) {
+    if (script.src) {
+      load(script.src);
+    } else {
+      run(script.innerHTML, null);
+    }
+  });
+};
+
+if (typeof window !== "undefined" && window !== null) {
+  headEl = document.getElementsByTagName('head')[0];
+
+  if (window.addEventListener) {
+    window.addEventListener('DOMContentLoaded', runScripts, false);
+  } else {
+    window.attachEvent('onload', runScripts);
+  }
+}
+
+},{"./fbtransform/visitors":30,"buffer":1,"jstransform":19,"jstransform/src/docblock":18}],27:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+/*global exports:true*/
+"use strict";
+
+var Syntax = _dereq_('esprima-fb').Syntax;
+var utils = _dereq_('jstransform/src/utils');
+
+var FALLBACK_TAGS = _dereq_('./xjs').knownTags;
+var renderXJSExpressionContainer =
+  _dereq_('./xjs').renderXJSExpressionContainer;
+var renderXJSLiteral = _dereq_('./xjs').renderXJSLiteral;
+var quoteAttrName = _dereq_('./xjs').quoteAttrName;
+
+/**
+ * Customized desugar processor.
+ *
+ * Currently: (Somewhat tailored to React)
+ * <X> </X> => X(null, null)
+ * <X prop="1" /> => X({prop: '1'}, null)
+ * <X prop="2"><Y /></X> => X({prop:'2'}, Y(null, null))
+ * <X prop="2"><Y /><Z /></X> => X({prop:'2'}, [Y(null, null), Z(null, null)])
+ *
+ * Exceptions to the simple rules above:
+ * if a property is named "class" it will be changed to "className" in the
+ * javascript since "class" is not a valid object key in javascript.
+ */
+
+var JSX_ATTRIBUTE_TRANSFORMS = {
+  cxName: function(attr) {
+    throw new Error(
+      "cxName is no longer supported, use className={cx(...)} instead"
+    );
+  }
+};
+
+function visitReactTag(traverse, object, path, state) {
+  var jsxObjIdent = utils.getDocblock(state).jsx;
+  var openingElement = object.openingElement;
+  var nameObject = openingElement.name;
+  var attributesObject = openingElement.attributes;
+
+  utils.catchup(openingElement.range[0], state);
+
+  if (nameObject.namespace) {
+    throw new Error(
+       'Namespace tags are not supported. ReactJSX is not XML.');
+  }
+
+  var isFallbackTag = FALLBACK_TAGS.hasOwnProperty(nameObject.name);
+  utils.append(
+    (isFallbackTag ? jsxObjIdent + '.' : '') + (nameObject.name) + '(',
+    state
+  );
+
+  utils.move(nameObject.range[1], state);
+
+  // if we don't have any attributes, pass in null
+  if (attributesObject.length === 0) {
+    utils.append('null', state);
+  }
+
+  // write attributes
+  attributesObject.forEach(function(attr, index) {
+    utils.catchup(attr.range[0], state);
+    if (attr.name.namespace) {
+      throw new Error(
+         'Namespace attributes are not supported. ReactJSX is not XML.');
+    }
+    var name = attr.name.name;
+    var isFirst = index === 0;
+    var isLast = index === attributesObject.length - 1;
+
+    if (isFirst) {
+      utils.append('{', state);
+    }
+
+    utils.append(quoteAttrName(name), state);
+    utils.append(':', state);
+
+    if (!attr.value) {
+      state.g.buffer += 'true';
+      state.g.position = attr.name.range[1];
+      if (!isLast) {
+        utils.append(',', state);
+      }
+    } else {
+      utils.move(attr.name.range[1], state);
+      // Use catchupWhiteSpace to skip over the '=' in the attribute
+      utils.catchupWhiteSpace(attr.value.range[0], state);
+      if (JSX_ATTRIBUTE_TRANSFORMS.hasOwnProperty(attr.name.name)) {
+        utils.append(JSX_ATTRIBUTE_TRANSFORMS[attr.name.name](attr), state);
+        utils.move(attr.value.range[1], state);
+        if (!isLast) {
+          utils.append(',', state);
+        }
+      } else if (attr.value.type === Syntax.Literal) {
+        renderXJSLiteral(attr.value, isLast, state);
+      } else {
+        renderXJSExpressionContainer(traverse, attr.value, isLast, path, state);
+      }
+    }
+
+    if (isLast) {
+      utils.append('}', state);
+    }
+
+    utils.catchup(attr.range[1], state);
+  });
+
+  if (!openingElement.selfClosing) {
+    utils.catchup(openingElement.range[1] - 1, state);
+    utils.move(openingElement.range[1], state);
+  }
+
+  // filter out whitespace
+  var childrenToRender = object.children.filter(function(child) {
+    return !(child.type === Syntax.Literal
+             && typeof child.value === 'string'
+             && child.value.match(/^[ \t]*[\r\n][ \t\r\n]*$/));
+  });
+  if (childrenToRender.length > 0) {
+    var lastRenderableIndex;
+
+    childrenToRender.forEach(function(child, index) {
+      if (child.type !== Syntax.XJSExpressionContainer ||
+          child.expression.type !== Syntax.XJSEmptyExpression) {
+        lastRenderableIndex = index;
+      }
+    });
+
+    if (lastRenderableIndex !== undefined) {
+      utils.append(', ', state);
+    }
+
+    childrenToRender.forEach(function(child, index) {
+      utils.catchup(child.range[0], state);
+
+      var isLast = index >= lastRenderableIndex;
+
+      if (child.type === Syntax.Literal) {
+        renderXJSLiteral(child, isLast, state);
+      } else if (child.type === Syntax.XJSExpressionContainer) {
+        renderXJSExpressionContainer(traverse, child, isLast, path, state);
+      } else {
+        traverse(child, path, state);
+        if (!isLast) {
+          utils.append(',', state);
+          state.g.buffer = state.g.buffer.replace(/(\s*),$/, ',$1');
+        }
+      }
+
+      utils.catchup(child.range[1], state);
+    });
+  }
+
+  if (openingElement.selfClosing) {
+    // everything up to />
+    utils.catchup(openingElement.range[1] - 2, state);
+    utils.move(openingElement.range[1], state);
+  } else {
+    // everything up to </ sdflksjfd>
+    utils.catchup(object.closingElement.range[0], state);
+    utils.move(object.closingElement.range[1], state);
+  }
+
+  utils.append(')', state);
+  return false;
+}
+
+visitReactTag.test = function(object, path, state) {
+  // only run react when react @jsx namespace is specified in docblock
+  var jsx = utils.getDocblock(state).jsx;
+  return object.type === Syntax.XJSElement && jsx && jsx.length;
+};
+
+exports.visitorList = [
+  visitReactTag
+];
+
+},{"./xjs":29,"esprima-fb":6,"jstransform/src/utils":20}],28:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+/*global exports:true*/
+"use strict";
+
+var Syntax = _dereq_('esprima-fb').Syntax;
+var utils = _dereq_('jstransform/src/utils');
+
+function addDisplayName(displayName, object, state) {
+  if (object &&
+      object.type === Syntax.CallExpression &&
+      object.callee.type === Syntax.MemberExpression &&
+      object.callee.object.type === Syntax.Identifier &&
+      object.callee.object.name === 'React' &&
+      object.callee.property.type === Syntax.Identifier &&
+      object.callee.property.name === 'createClass' &&
+      object['arguments'].length === 1 &&
+      object['arguments'][0].type === Syntax.ObjectExpression) {
+    // Verify that the displayName property isn't already set
+    var properties = object['arguments'][0].properties;
+    var safe = properties.every(function(property) {
+      var value = property.key.type === Syntax.Identifier ?
+        property.key.name :
+        property.key.value;
+      return value !== 'displayName';
+    });
+
+    if (safe) {
+      utils.catchup(object['arguments'][0].range[0] + 1, state);
+      utils.append("displayName: '" + displayName + "',", state);
+    }
+  }
+}
+
+/**
+ * Transforms the following:
+ *
+ * var MyComponent = React.createClass({
+ *    render: ...
+ * });
+ *
+ * into:
+ *
+ * var MyComponent = React.createClass({
+ *    displayName: 'MyComponent',
+ *    render: ...
+ * });
+ *
+ * Also catches:
+ *
+ * MyComponent = React.createClass(...);
+ * exports.MyComponent = React.createClass(...);
+ * module.exports = {MyComponent: React.createClass(...)};
+ */
+function visitReactDisplayName(traverse, object, path, state) {
+  var left, right;
+
+  if (object.type === Syntax.AssignmentExpression) {
+    left = object.left;
+    right = object.right;
+  } else if (object.type === Syntax.Property) {
+    left = object.key;
+    right = object.value;
+  } else if (object.type === Syntax.VariableDeclarator) {
+    left = object.id;
+    right = object.init;
+  }
+
+  if (left && left.type === Syntax.MemberExpression) {
+    left = left.property;
+  }
+  if (left && left.type === Syntax.Identifier) {
+    addDisplayName(left.name, right, state);
+  }
+}
+
+/**
+ * Will only run on @jsx files for now.
+ */
+visitReactDisplayName.test = function(object, path, state) {
+  if (utils.getDocblock(state).jsx) {
+    return (
+      object.type === Syntax.AssignmentExpression ||
+      object.type === Syntax.Property ||
+      object.type === Syntax.VariableDeclarator
+    );
+  } else {
+    return false;
+  }
+};
+
+exports.visitorList = [
+  visitReactDisplayName
+];
+
+},{"esprima-fb":6,"jstransform/src/utils":20}],29:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+/*global exports:true*/
+"use strict";
+var Syntax = _dereq_('esprima-fb').Syntax;
+var utils = _dereq_('jstransform/src/utils');
+
+var knownTags = {
+  a: true,
+  abbr: true,
+  address: true,
+  applet: true,
+  area: true,
+  article: true,
+  aside: true,
+  audio: true,
+  b: true,
+  base: true,
+  bdi: true,
+  bdo: true,
+  big: true,
+  blockquote: true,
+  body: true,
+  br: true,
+  button: true,
+  canvas: true,
+  caption: true,
+  circle: true,
+  cite: true,
+  code: true,
+  col: true,
+  colgroup: true,
+  command: true,
+  data: true,
+  datalist: true,
+  dd: true,
+  defs: true,
+  del: true,
+  details: true,
+  dfn: true,
+  dialog: true,
+  div: true,
+  dl: true,
+  dt: true,
+  ellipse: true,
+  em: true,
+  embed: true,
+  fieldset: true,
+  figcaption: true,
+  figure: true,
+  footer: true,
+  form: true,
+  g: true,
+  h1: true,
+  h2: true,
+  h3: true,
+  h4: true,
+  h5: true,
+  h6: true,
+  head: true,
+  header: true,
+  hgroup: true,
+  hr: true,
+  html: true,
+  i: true,
+  iframe: true,
+  img: true,
+  input: true,
+  ins: true,
+  kbd: true,
+  keygen: true,
+  label: true,
+  legend: true,
+  li: true,
+  line: true,
+  linearGradient: true,
+  link: true,
+  main: true,
+  map: true,
+  mark: true,
+  marquee: true,
+  menu: true,
+  menuitem: true,
+  meta: true,
+  meter: true,
+  nav: true,
+  noscript: true,
+  object: true,
+  ol: true,
+  optgroup: true,
+  option: true,
+  output: true,
+  p: true,
+  param: true,
+  path: true,
+  polygon: true,
+  polyline: true,
+  pre: true,
+  progress: true,
+  q: true,
+  radialGradient: true,
+  rect: true,
+  rp: true,
+  rt: true,
+  ruby: true,
+  s: true,
+  samp: true,
+  script: true,
+  section: true,
+  select: true,
+  small: true,
+  source: true,
+  span: true,
+  stop: true,
+  strong: true,
+  style: true,
+  sub: true,
+  summary: true,
+  sup: true,
+  svg: true,
+  table: true,
+  tbody: true,
+  td: true,
+  text: true,
+  textarea: true,
+  tfoot: true,
+  th: true,
+  thead: true,
+  time: true,
+  title: true,
+  tr: true,
+  track: true,
+  u: true,
+  ul: true,
+  'var': true,
+  video: true,
+  wbr: true
+};
+
+function renderXJSLiteral(object, isLast, state, start, end) {
+  var lines = object.value.split(/\r\n|\n|\r/);
+
+  if (start) {
+    utils.append(start, state);
+  }
+
+  var lastNonEmptyLine = 0;
+
+  lines.forEach(function (line, index) {
+    if (line.match(/[^ \t]/)) {
+      lastNonEmptyLine = index;
+    }
+  });
+
+  lines.forEach(function (line, index) {
+    var isFirstLine = index === 0;
+    var isLastLine = index === lines.length - 1;
+    var isLastNonEmptyLine = index === lastNonEmptyLine;
+
+    // replace rendered whitespace tabs with spaces
+    var trimmedLine = line.replace(/\t/g, ' ');
+
+    // trim whitespace touching a newline
+    if (!isFirstLine) {
+      trimmedLine = trimmedLine.replace(/^[ ]+/, '');
+    }
+    if (!isLastLine) {
+      trimmedLine = trimmedLine.replace(/[ ]+$/, '');
+    }
+
+    utils.append(line.match(/^[ \t]*/)[0], state);
+
+    if (trimmedLine || isLastNonEmptyLine) {
+      utils.append(
+        JSON.stringify(trimmedLine) +
+        (!isLastNonEmptyLine ? "+' '+" : ''),
+        state);
+
+      if (isLastNonEmptyLine) {
+        if (end) {
+          utils.append(end, state);
+        }
+        if (!isLast) {
+          utils.append(',', state);
+        }
+      }
+
+      // only restore tail whitespace if line had literals
+      if (trimmedLine) {
+        utils.append(line.match(/[ \t]*$/)[0], state);
+      }
+    }
+
+    if (!isLastLine) {
+      utils.append('\n', state);
+    }
+  });
+
+  utils.move(object.range[1], state);
+}
+
+function renderXJSExpressionContainer(traverse, object, isLast, path, state) {
+  // Plus 1 to skip `{`.
+  utils.move(object.range[0] + 1, state);
+  traverse(object.expression, path, state);
+  if (!isLast && object.expression.type !== Syntax.XJSEmptyExpression) {
+    // If we need to append a comma, make sure to do so after the expression.
+    utils.catchup(object.expression.range[1], state);
+    utils.append(',', state);
+  }
+
+  // Minus 1 to skip `}`.
+  utils.catchup(object.range[1] - 1, state);
+  utils.move(object.range[1], state);
+  return false;
+}
+
+function quoteAttrName(attr) {
+  // Quote invalid JS identifiers.
+  if (!/^[a-z_$][a-z\d_$]*$/i.test(attr)) {
+    return "'" + attr + "'";
+  }
+  return attr;
+}
+
+exports.knownTags = knownTags;
+exports.renderXJSExpressionContainer = renderXJSExpressionContainer;
+exports.renderXJSLiteral = renderXJSLiteral;
+exports.quoteAttrName = quoteAttrName;
+
+},{"esprima-fb":6,"jstransform/src/utils":20}],30:[function(_dereq_,module,exports){
+/*global exports:true*/
+var es6ArrowFunctions = _dereq_('jstransform/visitors/es6-arrow-function-visitors');
+var es6Classes = _dereq_('jstransform/visitors/es6-class-visitors');
+var es6ObjectShortNotation = _dereq_('jstransform/visitors/es6-object-short-notation-visitors');
+var es6RestParameters = _dereq_('jstransform/visitors/es6-rest-param-visitors');
+var es6Templates = _dereq_('jstransform/visitors/es6-template-visitors');
+var react = _dereq_('./transforms/react');
+var reactDisplayName = _dereq_('./transforms/reactDisplayName');
+
+/**
+ * Map from transformName => orderedListOfVisitors.
+ */
+var transformVisitors = {
+  'es6-arrow-functions': es6ArrowFunctions.visitorList,
+  'es6-classes': es6Classes.visitorList,
+  'es6-object-short-notation': es6ObjectShortNotation.visitorList,
+  'es6-rest-params': es6RestParameters.visitorList,
+  'es6-templates': es6Templates.visitorList,
+  'react': react.visitorList.concat(reactDisplayName.visitorList)
+};
+
+/**
+ * Specifies the order in which each transform should run.
+ */
+var transformRunOrder = [
+  'es6-arrow-functions',
+  'es6-object-short-notation',
+  'es6-classes',
+  'es6-rest-params',
+  'es6-templates',
+  'react'
+];
+
+/**
+ * Given a list of transform names, return the ordered list of visitors to be
+ * passed to the transform() function.
+ *
+ * @param {array?} excludes
+ * @return {array}
+ */
+function getAllVisitors(excludes) {
+  var ret = [];
+  for (var i = 0, il = transformRunOrder.length; i < il; i++) {
+    if (!excludes || excludes.indexOf(transformRunOrder[i]) === -1) {
+      ret = ret.concat(transformVisitors[transformRunOrder[i]]);
+    }
+  }
+  return ret;
+}
+
+exports.getAllVisitors = getAllVisitors;
+exports.transformVisitors = transformVisitors;
+
+},{"./transforms/react":27,"./transforms/reactDisplayName":28,"jstransform/visitors/es6-arrow-function-visitors":21,"jstransform/visitors/es6-class-visitors":22,"jstransform/visitors/es6-object-short-notation-visitors":23,"jstransform/visitors/es6-rest-param-visitors":24,"jstransform/visitors/es6-template-visitors":25}]},{},[26])
+(26)
+});
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/js/react/react-with-addons.js elefant-elefant_1_3_10_beta/apps/user/js/react/react-with-addons.js
--- elefant-elefant_1_3_9_beta/apps/user/js/react/react-with-addons.js	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/js/react/react-with-addons.js	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,18884 @@
+/**
+ * React (with addons) v0.10.0
+ */
+!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.React=e()}}(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule AutoFocusMixin
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var focusNode = _dereq_("./focusNode");
+
+var AutoFocusMixin = {
+  componentDidMount: function() {
+    if (this.props.autoFocus) {
+      focusNode(this.getDOMNode());
+    }
+  }
+};
+
+module.exports = AutoFocusMixin;
+
+},{"./focusNode":113}],2:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule CSSCore
+ * @typechecks
+ */
+
+var invariant = _dereq_("./invariant");
+
+/**
+ * The CSSCore module specifies the API (and implements most of the methods)
+ * that should be used when dealing with the display of elements (via their
+ * CSS classes and visibility on screen. It is an API focused on mutating the
+ * display and not reading it as no logical state should be encoded in the
+ * display of elements.
+ */
+
+var CSSCore = {
+
+  /**
+   * Adds the class passed in to the element if it doesn't already have it.
+   *
+   * @param {DOMElement} element the element to set the class on
+   * @param {string} className the CSS className
+   * @return {DOMElement} the element passed in
+   */
+  addClass: function(element, className) {
+    ("production" !== "development" ? invariant(
+      !/\s/.test(className),
+      'CSSCore.addClass takes only a single class name. "%s" contains ' +
+      'multiple classes.', className
+    ) : invariant(!/\s/.test(className)));
+
+    if (className) {
+      if (element.classList) {
+        element.classList.add(className);
+      } else if (!CSSCore.hasClass(element, className)) {
+        element.className = element.className + ' ' + className;
+      }
+    }
+    return element;
+  },
+
+  /**
+   * Removes the class passed in from the element
+   *
+   * @param {DOMElement} element the element to set the class on
+   * @param {string} className the CSS className
+   * @return {DOMElement} the element passed in
+   */
+  removeClass: function(element, className) {
+    ("production" !== "development" ? invariant(
+      !/\s/.test(className),
+      'CSSCore.removeClass takes only a single class name. "%s" contains ' +
+      'multiple classes.', className
+    ) : invariant(!/\s/.test(className)));
+
+    if (className) {
+      if (element.classList) {
+        element.classList.remove(className);
+      } else if (CSSCore.hasClass(element, className)) {
+        element.className = element.className
+          .replace(new RegExp('(^|\\s)' + className + '(?:\\s|$)', 'g'), '$1')
+          .replace(/\s+/g, ' ') // multiple spaces to one
+          .replace(/^\s*|\s*$/g, ''); // trim the ends
+      }
+    }
+    return element;
+  },
+
+  /**
+   * Helper to add or remove a class from an element based on a condition.
+   *
+   * @param {DOMElement} element the element to set the class on
+   * @param {string} className the CSS className
+   * @param {*} bool condition to whether to add or remove the class
+   * @return {DOMElement} the element passed in
+   */
+  conditionClass: function(element, className, bool) {
+    return (bool ? CSSCore.addClass : CSSCore.removeClass)(element, className);
+  },
+
+  /**
+   * Tests whether the element has the class specified.
+   *
+   * @param {DOMNode|DOMWindow} element the element to set the class on
+   * @param {string} className the CSS className
+   * @returns {boolean} true if the element has the class, false if not
+   */
+  hasClass: function(element, className) {
+    ("production" !== "development" ? invariant(
+      !/\s/.test(className),
+      'CSS.hasClass takes only a single class name.'
+    ) : invariant(!/\s/.test(className)));
+    if (element.classList) {
+      return !!className && element.classList.contains(className);
+    }
+    return (' ' + element.className + ' ').indexOf(' ' + className + ' ') > -1;
+  }
+
+};
+
+module.exports = CSSCore;
+
+},{"./invariant":125}],3:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule CSSProperty
+ */
+
+"use strict";
+
+/**
+ * CSS properties which accept numbers but are not in units of "px".
+ */
+var isUnitlessNumber = {
+  columnCount: true,
+  fillOpacity: true,
+  flex: true,
+  flexGrow: true,
+  flexShrink: true,
+  fontWeight: true,
+  lineClamp: true,
+  lineHeight: true,
+  opacity: true,
+  order: true,
+  orphans: true,
+  widows: true,
+  zIndex: true,
+  zoom: true
+};
+
+/**
+ * @param {string} prefix vendor-specific prefix, eg: Webkit
+ * @param {string} key style name, eg: transitionDuration
+ * @return {string} style name prefixed with `prefix`, properly camelCased, eg:
+ * WebkitTransitionDuration
+ */
+function prefixKey(prefix, key) {
+  return prefix + key.charAt(0).toUpperCase() + key.substring(1);
+}
+
+/**
+ * Support style names that may come passed in prefixed by adding permutations
+ * of vendor prefixes.
+ */
+var prefixes = ['Webkit', 'ms', 'Moz', 'O'];
+
+// Using Object.keys here, or else the vanilla for-in loop makes IE8 go into an
+// infinite loop, because it iterates over the newly added props too.
+Object.keys(isUnitlessNumber).forEach(function(prop) {
+  prefixes.forEach(function(prefix) {
+    isUnitlessNumber[prefixKey(prefix, prop)] = isUnitlessNumber[prop];
+  });
+});
+
+/**
+ * Most style properties can be unset by doing .style[prop] = '' but IE8
+ * doesn't like doing that with shorthand properties so for the properties that
+ * IE8 breaks on, which are listed here, we instead unset each of the
+ * individual properties. See http://bugs.jquery.com/ticket/12385.
+ * The 4-value 'clock' properties like margin, padding, border-width seem to
+ * behave without any problems. Curiously, list-style works too without any
+ * special prodding.
+ */
+var shorthandPropertyExpansions = {
+  background: {
+    backgroundImage: true,
+    backgroundPosition: true,
+    backgroundRepeat: true,
+    backgroundColor: true
+  },
+  border: {
+    borderWidth: true,
+    borderStyle: true,
+    borderColor: true
+  },
+  borderBottom: {
+    borderBottomWidth: true,
+    borderBottomStyle: true,
+    borderBottomColor: true
+  },
+  borderLeft: {
+    borderLeftWidth: true,
+    borderLeftStyle: true,
+    borderLeftColor: true
+  },
+  borderRight: {
+    borderRightWidth: true,
+    borderRightStyle: true,
+    borderRightColor: true
+  },
+  borderTop: {
+    borderTopWidth: true,
+    borderTopStyle: true,
+    borderTopColor: true
+  },
+  font: {
+    fontStyle: true,
+    fontVariant: true,
+    fontWeight: true,
+    fontSize: true,
+    lineHeight: true,
+    fontFamily: true
+  }
+};
+
+var CSSProperty = {
+  isUnitlessNumber: isUnitlessNumber,
+  shorthandPropertyExpansions: shorthandPropertyExpansions
+};
+
+module.exports = CSSProperty;
+
+},{}],4:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule CSSPropertyOperations
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var CSSProperty = _dereq_("./CSSProperty");
+
+var dangerousStyleValue = _dereq_("./dangerousStyleValue");
+var escapeTextForBrowser = _dereq_("./escapeTextForBrowser");
+var hyphenate = _dereq_("./hyphenate");
+var memoizeStringOnly = _dereq_("./memoizeStringOnly");
+
+var processStyleName = memoizeStringOnly(function(styleName) {
+  return escapeTextForBrowser(hyphenate(styleName));
+});
+
+/**
+ * Operations for dealing with CSS properties.
+ */
+var CSSPropertyOperations = {
+
+  /**
+   * Serializes a mapping of style properties for use as inline styles:
+   *
+   *   > createMarkupForStyles({width: '200px', height: 0})
+   *   "width:200px;height:0;"
+   *
+   * Undefined values are ignored so that declarative programming is easier.
+   *
+   * @param {object} styles
+   * @return {?string}
+   */
+  createMarkupForStyles: function(styles) {
+    var serialized = '';
+    for (var styleName in styles) {
+      if (!styles.hasOwnProperty(styleName)) {
+        continue;
+      }
+      var styleValue = styles[styleName];
+      if (styleValue != null) {
+        serialized += processStyleName(styleName) + ':';
+        serialized += dangerousStyleValue(styleName, styleValue) + ';';
+      }
+    }
+    return serialized || null;
+  },
+
+  /**
+   * Sets the value for multiple styles on a node.  If a value is specified as
+   * '' (empty string), the corresponding style property will be unset.
+   *
+   * @param {DOMElement} node
+   * @param {object} styles
+   */
+  setValueForStyles: function(node, styles) {
+    var style = node.style;
+    for (var styleName in styles) {
+      if (!styles.hasOwnProperty(styleName)) {
+        continue;
+      }
+      var styleValue = dangerousStyleValue(styleName, styles[styleName]);
+      if (styleValue) {
+        style[styleName] = styleValue;
+      } else {
+        var expansion = CSSProperty.shorthandPropertyExpansions[styleName];
+        if (expansion) {
+          // Shorthand property that IE8 won't like unsetting, so unset each
+          // component to placate it
+          for (var individualStyleName in expansion) {
+            style[individualStyleName] = '';
+          }
+        } else {
+          style[styleName] = '';
+        }
+      }
+    }
+  }
+
+};
+
+module.exports = CSSPropertyOperations;
+
+},{"./CSSProperty":3,"./dangerousStyleValue":108,"./escapeTextForBrowser":111,"./hyphenate":123,"./memoizeStringOnly":133}],5:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ChangeEventPlugin
+ */
+
+"use strict";
+
+var EventConstants = _dereq_("./EventConstants");
+var EventPluginHub = _dereq_("./EventPluginHub");
+var EventPropagators = _dereq_("./EventPropagators");
+var ExecutionEnvironment = _dereq_("./ExecutionEnvironment");
+var ReactUpdates = _dereq_("./ReactUpdates");
+var SyntheticEvent = _dereq_("./SyntheticEvent");
+
+var isEventSupported = _dereq_("./isEventSupported");
+var isTextInputElement = _dereq_("./isTextInputElement");
+var keyOf = _dereq_("./keyOf");
+
+var topLevelTypes = EventConstants.topLevelTypes;
+
+var eventTypes = {
+  change: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onChange: null}),
+      captured: keyOf({onChangeCapture: null})
+    },
+    dependencies: [
+      topLevelTypes.topBlur,
+      topLevelTypes.topChange,
+      topLevelTypes.topClick,
+      topLevelTypes.topFocus,
+      topLevelTypes.topInput,
+      topLevelTypes.topKeyDown,
+      topLevelTypes.topKeyUp,
+      topLevelTypes.topSelectionChange
+    ]
+  }
+};
+
+/**
+ * For IE shims
+ */
+var activeElement = null;
+var activeElementID = null;
+var activeElementValue = null;
+var activeElementValueProp = null;
+
+/**
+ * SECTION: handle `change` event
+ */
+function shouldUseChangeEvent(elem) {
+  return (
+    elem.nodeName === 'SELECT' ||
+    (elem.nodeName === 'INPUT' && elem.type === 'file')
+  );
+}
+
+var doesChangeEventBubble = false;
+if (ExecutionEnvironment.canUseDOM) {
+  // See `handleChange` comment below
+  doesChangeEventBubble = isEventSupported('change') && (
+    !('documentMode' in document) || document.documentMode > 8
+  );
+}
+
+function manualDispatchChangeEvent(nativeEvent) {
+  var event = SyntheticEvent.getPooled(
+    eventTypes.change,
+    activeElementID,
+    nativeEvent
+  );
+  EventPropagators.accumulateTwoPhaseDispatches(event);
+
+  // If change and propertychange bubbled, we'd just bind to it like all the
+  // other events and have it go through ReactEventTopLevelCallback. Since it
+  // doesn't, we manually listen for the events and so we have to enqueue and
+  // process the abstract event manually.
+  //
+  // Batching is necessary here in order to ensure that all event handlers run
+  // before the next rerender (including event handlers attached to ancestor
+  // elements instead of directly on the input). Without this, controlled
+  // components don't work properly in conjunction with event bubbling because
+  // the component is rerendered and the value reverted before all the event
+  // handlers can run. See https://github.com/facebook/react/issues/708.
+  ReactUpdates.batchedUpdates(runEventInBatch, event);
+}
+
+function runEventInBatch(event) {
+  EventPluginHub.enqueueEvents(event);
+  EventPluginHub.processEventQueue();
+}
+
+function startWatchingForChangeEventIE8(target, targetID) {
+  activeElement = target;
+  activeElementID = targetID;
+  activeElement.attachEvent('onchange', manualDispatchChangeEvent);
+}
+
+function stopWatchingForChangeEventIE8() {
+  if (!activeElement) {
+    return;
+  }
+  activeElement.detachEvent('onchange', manualDispatchChangeEvent);
+  activeElement = null;
+  activeElementID = null;
+}
+
+function getTargetIDForChangeEvent(
+    topLevelType,
+    topLevelTarget,
+    topLevelTargetID) {
+  if (topLevelType === topLevelTypes.topChange) {
+    return topLevelTargetID;
+  }
+}
+function handleEventsForChangeEventIE8(
+    topLevelType,
+    topLevelTarget,
+    topLevelTargetID) {
+  if (topLevelType === topLevelTypes.topFocus) {
+    // stopWatching() should be a noop here but we call it just in case we
+    // missed a blur event somehow.
+    stopWatchingForChangeEventIE8();
+    startWatchingForChangeEventIE8(topLevelTarget, topLevelTargetID);
+  } else if (topLevelType === topLevelTypes.topBlur) {
+    stopWatchingForChangeEventIE8();
+  }
+}
+
+
+/**
+ * SECTION: handle `input` event
+ */
+var isInputEventSupported = false;
+if (ExecutionEnvironment.canUseDOM) {
+  // IE9 claims to support the input event but fails to trigger it when
+  // deleting text, so we ignore its input events
+  isInputEventSupported = isEventSupported('input') && (
+    !('documentMode' in document) || document.documentMode > 9
+  );
+}
+
+/**
+ * (For old IE.) Replacement getter/setter for the `value` property that gets
+ * set on the active element.
+ */
+var newValueProp =  {
+  get: function() {
+    return activeElementValueProp.get.call(this);
+  },
+  set: function(val) {
+    // Cast to a string so we can do equality checks.
+    activeElementValue = '' + val;
+    activeElementValueProp.set.call(this, val);
+  }
+};
+
+/**
+ * (For old IE.) Starts tracking propertychange events on the passed-in element
+ * and override the value property so that we can distinguish user events from
+ * value changes in JS.
+ */
+function startWatchingForValueChange(target, targetID) {
+  activeElement = target;
+  activeElementID = targetID;
+  activeElementValue = target.value;
+  activeElementValueProp = Object.getOwnPropertyDescriptor(
+    target.constructor.prototype,
+    'value'
+  );
+
+  Object.defineProperty(activeElement, 'value', newValueProp);
+  activeElement.attachEvent('onpropertychange', handlePropertyChange);
+}
+
+/**
+ * (For old IE.) Removes the event listeners from the currently-tracked element,
+ * if any exists.
+ */
+function stopWatchingForValueChange() {
+  if (!activeElement) {
+    return;
+  }
+
+  // delete restores the original property definition
+  delete activeElement.value;
+  activeElement.detachEvent('onpropertychange', handlePropertyChange);
+
+  activeElement = null;
+  activeElementID = null;
+  activeElementValue = null;
+  activeElementValueProp = null;
+}
+
+/**
+ * (For old IE.) Handles a propertychange event, sending a `change` event if
+ * the value of the active element has changed.
+ */
+function handlePropertyChange(nativeEvent) {
+  if (nativeEvent.propertyName !== 'value') {
+    return;
+  }
+  var value = nativeEvent.srcElement.value;
+  if (value === activeElementValue) {
+    return;
+  }
+  activeElementValue = value;
+
+  manualDispatchChangeEvent(nativeEvent);
+}
+
+/**
+ * If a `change` event should be fired, returns the target's ID.
+ */
+function getTargetIDForInputEvent(
+    topLevelType,
+    topLevelTarget,
+    topLevelTargetID) {
+  if (topLevelType === topLevelTypes.topInput) {
+    // In modern browsers (i.e., not IE8 or IE9), the input event is exactly
+    // what we want so fall through here and trigger an abstract event
+    return topLevelTargetID;
+  }
+}
+
+// For IE8 and IE9.
+function handleEventsForInputEventIE(
+    topLevelType,
+    topLevelTarget,
+    topLevelTargetID) {
+  if (topLevelType === topLevelTypes.topFocus) {
+    // In IE8, we can capture almost all .value changes by adding a
+    // propertychange handler and looking for events with propertyName
+    // equal to 'value'
+    // In IE9, propertychange fires for most input events but is buggy and
+    // doesn't fire when text is deleted, but conveniently, selectionchange
+    // appears to fire in all of the remaining cases so we catch those and
+    // forward the event if the value has changed
+    // In either case, we don't want to call the event handler if the value
+    // is changed from JS so we redefine a setter for `.value` that updates
+    // our activeElementValue variable, allowing us to ignore those changes
+    //
+    // stopWatching() should be a noop here but we call it just in case we
+    // missed a blur event somehow.
+    stopWatchingForValueChange();
+    startWatchingForValueChange(topLevelTarget, topLevelTargetID);
+  } else if (topLevelType === topLevelTypes.topBlur) {
+    stopWatchingForValueChange();
+  }
+}
+
+// For IE8 and IE9.
+function getTargetIDForInputEventIE(
+    topLevelType,
+    topLevelTarget,
+    topLevelTargetID) {
+  if (topLevelType === topLevelTypes.topSelectionChange ||
+      topLevelType === topLevelTypes.topKeyUp ||
+      topLevelType === topLevelTypes.topKeyDown) {
+    // On the selectionchange event, the target is just document which isn't
+    // helpful for us so just check activeElement instead.
+    //
+    // 99% of the time, keydown and keyup aren't necessary. IE8 fails to fire
+    // propertychange on the first input event after setting `value` from a
+    // script and fires only keydown, keypress, keyup. Catching keyup usually
+    // gets it and catching keydown lets us fire an event for the first
+    // keystroke if user does a key repeat (it'll be a little delayed: right
+    // before the second keystroke). Other input methods (e.g., paste) seem to
+    // fire selectionchange normally.
+    if (activeElement && activeElement.value !== activeElementValue) {
+      activeElementValue = activeElement.value;
+      return activeElementID;
+    }
+  }
+}
+
+
+/**
+ * SECTION: handle `click` event
+ */
+function shouldUseClickEvent(elem) {
+  // Use the `click` event to detect changes to checkbox and radio inputs.
+  // This approach works across all browsers, whereas `change` does not fire
+  // until `blur` in IE8.
+  return (
+    elem.nodeName === 'INPUT' &&
+    (elem.type === 'checkbox' || elem.type === 'radio')
+  );
+}
+
+function getTargetIDForClickEvent(
+    topLevelType,
+    topLevelTarget,
+    topLevelTargetID) {
+  if (topLevelType === topLevelTypes.topClick) {
+    return topLevelTargetID;
+  }
+}
+
+/**
+ * This plugin creates an `onChange` event that normalizes change events
+ * across form elements. This event fires at a time when it's possible to
+ * change the element's value without seeing a flicker.
+ *
+ * Supported elements are:
+ * - input (see `isTextInputElement`)
+ * - textarea
+ * - select
+ */
+var ChangeEventPlugin = {
+
+  eventTypes: eventTypes,
+
+  /**
+   * @param {string} topLevelType Record from `EventConstants`.
+   * @param {DOMEventTarget} topLevelTarget The listening component root node.
+   * @param {string} topLevelTargetID ID of `topLevelTarget`.
+   * @param {object} nativeEvent Native browser event.
+   * @return {*} An accumulation of synthetic events.
+   * @see {EventPluginHub.extractEvents}
+   */
+  extractEvents: function(
+      topLevelType,
+      topLevelTarget,
+      topLevelTargetID,
+      nativeEvent) {
+
+    var getTargetIDFunc, handleEventFunc;
+    if (shouldUseChangeEvent(topLevelTarget)) {
+      if (doesChangeEventBubble) {
+        getTargetIDFunc = getTargetIDForChangeEvent;
+      } else {
+        handleEventFunc = handleEventsForChangeEventIE8;
+      }
+    } else if (isTextInputElement(topLevelTarget)) {
+      if (isInputEventSupported) {
+        getTargetIDFunc = getTargetIDForInputEvent;
+      } else {
+        getTargetIDFunc = getTargetIDForInputEventIE;
+        handleEventFunc = handleEventsForInputEventIE;
+      }
+    } else if (shouldUseClickEvent(topLevelTarget)) {
+      getTargetIDFunc = getTargetIDForClickEvent;
+    }
+
+    if (getTargetIDFunc) {
+      var targetID = getTargetIDFunc(
+        topLevelType,
+        topLevelTarget,
+        topLevelTargetID
+      );
+      if (targetID) {
+        var event = SyntheticEvent.getPooled(
+          eventTypes.change,
+          targetID,
+          nativeEvent
+        );
+        EventPropagators.accumulateTwoPhaseDispatches(event);
+        return event;
+      }
+    }
+
+    if (handleEventFunc) {
+      handleEventFunc(
+        topLevelType,
+        topLevelTarget,
+        topLevelTargetID
+      );
+    }
+  }
+
+};
+
+module.exports = ChangeEventPlugin;
+
+},{"./EventConstants":15,"./EventPluginHub":17,"./EventPropagators":20,"./ExecutionEnvironment":21,"./ReactUpdates":81,"./SyntheticEvent":89,"./isEventSupported":126,"./isTextInputElement":128,"./keyOf":132}],6:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ClientReactRootIndex
+ * @typechecks
+ */
+
+"use strict";
+
+var nextReactRootIndex = 0;
+
+var ClientReactRootIndex = {
+  createReactRootIndex: function() {
+    return nextReactRootIndex++;
+  }
+};
+
+module.exports = ClientReactRootIndex;
+
+},{}],7:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule CompositionEventPlugin
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var EventConstants = _dereq_("./EventConstants");
+var EventPropagators = _dereq_("./EventPropagators");
+var ExecutionEnvironment = _dereq_("./ExecutionEnvironment");
+var ReactInputSelection = _dereq_("./ReactInputSelection");
+var SyntheticCompositionEvent = _dereq_("./SyntheticCompositionEvent");
+
+var getTextContentAccessor = _dereq_("./getTextContentAccessor");
+var keyOf = _dereq_("./keyOf");
+
+var END_KEYCODES = [9, 13, 27, 32]; // Tab, Return, Esc, Space
+var START_KEYCODE = 229;
+
+var useCompositionEvent = (
+  ExecutionEnvironment.canUseDOM &&
+  'CompositionEvent' in window
+);
+
+// In IE9+, we have access to composition events, but the data supplied
+// by the native compositionend event may be incorrect. In Korean, for example,
+// the compositionend event contains only one character regardless of
+// how many characters have been composed since compositionstart.
+// We therefore use the fallback data while still using the native
+// events as triggers.
+var useFallbackData = (
+  !useCompositionEvent ||
+  'documentMode' in document && document.documentMode > 8
+);
+
+var topLevelTypes = EventConstants.topLevelTypes;
+var currentComposition = null;
+
+// Events and their corresponding property names.
+var eventTypes = {
+  compositionEnd: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onCompositionEnd: null}),
+      captured: keyOf({onCompositionEndCapture: null})
+    },
+    dependencies: [
+      topLevelTypes.topBlur,
+      topLevelTypes.topCompositionEnd,
+      topLevelTypes.topKeyDown,
+      topLevelTypes.topKeyPress,
+      topLevelTypes.topKeyUp,
+      topLevelTypes.topMouseDown
+    ]
+  },
+  compositionStart: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onCompositionStart: null}),
+      captured: keyOf({onCompositionStartCapture: null})
+    },
+    dependencies: [
+      topLevelTypes.topBlur,
+      topLevelTypes.topCompositionStart,
+      topLevelTypes.topKeyDown,
+      topLevelTypes.topKeyPress,
+      topLevelTypes.topKeyUp,
+      topLevelTypes.topMouseDown
+    ]
+  },
+  compositionUpdate: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onCompositionUpdate: null}),
+      captured: keyOf({onCompositionUpdateCapture: null})
+    },
+    dependencies: [
+      topLevelTypes.topBlur,
+      topLevelTypes.topCompositionUpdate,
+      topLevelTypes.topKeyDown,
+      topLevelTypes.topKeyPress,
+      topLevelTypes.topKeyUp,
+      topLevelTypes.topMouseDown
+    ]
+  }
+};
+
+/**
+ * Translate native top level events into event types.
+ *
+ * @param {string} topLevelType
+ * @return {object}
+ */
+function getCompositionEventType(topLevelType) {
+  switch (topLevelType) {
+    case topLevelTypes.topCompositionStart:
+      return eventTypes.compositionStart;
+    case topLevelTypes.topCompositionEnd:
+      return eventTypes.compositionEnd;
+    case topLevelTypes.topCompositionUpdate:
+      return eventTypes.compositionUpdate;
+  }
+}
+
+/**
+ * Does our fallback best-guess model think this event signifies that
+ * composition has begun?
+ *
+ * @param {string} topLevelType
+ * @param {object} nativeEvent
+ * @return {boolean}
+ */
+function isFallbackStart(topLevelType, nativeEvent) {
+  return (
+    topLevelType === topLevelTypes.topKeyDown &&
+    nativeEvent.keyCode === START_KEYCODE
+  );
+}
+
+/**
+ * Does our fallback mode think that this event is the end of composition?
+ *
+ * @param {string} topLevelType
+ * @param {object} nativeEvent
+ * @return {boolean}
+ */
+function isFallbackEnd(topLevelType, nativeEvent) {
+  switch (topLevelType) {
+    case topLevelTypes.topKeyUp:
+      // Command keys insert or clear IME input.
+      return (END_KEYCODES.indexOf(nativeEvent.keyCode) !== -1);
+    case topLevelTypes.topKeyDown:
+      // Expect IME keyCode on each keydown. If we get any other
+      // code we must have exited earlier.
+      return (nativeEvent.keyCode !== START_KEYCODE);
+    case topLevelTypes.topKeyPress:
+    case topLevelTypes.topMouseDown:
+    case topLevelTypes.topBlur:
+      // Events are not possible without cancelling IME.
+      return true;
+    default:
+      return false;
+  }
+}
+
+/**
+ * Helper class stores information about selection and document state
+ * so we can figure out what changed at a later date.
+ *
+ * @param {DOMEventTarget} root
+ */
+function FallbackCompositionState(root) {
+  this.root = root;
+  this.startSelection = ReactInputSelection.getSelection(root);
+  this.startValue = this.getText();
+}
+
+/**
+ * Get current text of input.
+ *
+ * @return {string}
+ */
+FallbackCompositionState.prototype.getText = function() {
+  return this.root.value || this.root[getTextContentAccessor()];
+};
+
+/**
+ * Text that has changed since the start of composition.
+ *
+ * @return {string}
+ */
+FallbackCompositionState.prototype.getData = function() {
+  var endValue = this.getText();
+  var prefixLength = this.startSelection.start;
+  var suffixLength = this.startValue.length - this.startSelection.end;
+
+  return endValue.substr(
+    prefixLength,
+    endValue.length - suffixLength - prefixLength
+  );
+};
+
+/**
+ * This plugin creates `onCompositionStart`, `onCompositionUpdate` and
+ * `onCompositionEnd` events on inputs, textareas and contentEditable
+ * nodes.
+ */
+var CompositionEventPlugin = {
+
+  eventTypes: eventTypes,
+
+  /**
+   * @param {string} topLevelType Record from `EventConstants`.
+   * @param {DOMEventTarget} topLevelTarget The listening component root node.
+   * @param {string} topLevelTargetID ID of `topLevelTarget`.
+   * @param {object} nativeEvent Native browser event.
+   * @return {*} An accumulation of synthetic events.
+   * @see {EventPluginHub.extractEvents}
+   */
+  extractEvents: function(
+      topLevelType,
+      topLevelTarget,
+      topLevelTargetID,
+      nativeEvent) {
+
+    var eventType;
+    var data;
+
+    if (useCompositionEvent) {
+      eventType = getCompositionEventType(topLevelType);
+    } else if (!currentComposition) {
+      if (isFallbackStart(topLevelType, nativeEvent)) {
+        eventType = eventTypes.compositionStart;
+      }
+    } else if (isFallbackEnd(topLevelType, nativeEvent)) {
+      eventType = eventTypes.compositionEnd;
+    }
+
+    if (useFallbackData) {
+      // The current composition is stored statically and must not be
+      // overwritten while composition continues.
+      if (!currentComposition && eventType === eventTypes.compositionStart) {
+        currentComposition = new FallbackCompositionState(topLevelTarget);
+      } else if (eventType === eventTypes.compositionEnd) {
+        if (currentComposition) {
+          data = currentComposition.getData();
+          currentComposition = null;
+        }
+      }
+    }
+
+    if (eventType) {
+      var event = SyntheticCompositionEvent.getPooled(
+        eventType,
+        topLevelTargetID,
+        nativeEvent
+      );
+      if (data) {
+        // Inject data generated from fallback path into the synthetic event.
+        // This matches the property of native CompositionEventInterface.
+        event.data = data;
+      }
+      EventPropagators.accumulateTwoPhaseDispatches(event);
+      return event;
+    }
+  }
+};
+
+module.exports = CompositionEventPlugin;
+
+},{"./EventConstants":15,"./EventPropagators":20,"./ExecutionEnvironment":21,"./ReactInputSelection":56,"./SyntheticCompositionEvent":87,"./getTextContentAccessor":121,"./keyOf":132}],8:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule DOMChildrenOperations
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var Danger = _dereq_("./Danger");
+var ReactMultiChildUpdateTypes = _dereq_("./ReactMultiChildUpdateTypes");
+
+var getTextContentAccessor = _dereq_("./getTextContentAccessor");
+
+/**
+ * The DOM property to use when setting text content.
+ *
+ * @type {string}
+ * @private
+ */
+var textContentAccessor = getTextContentAccessor();
+
+/**
+ * Inserts `childNode` as a child of `parentNode` at the `index`.
+ *
+ * @param {DOMElement} parentNode Parent node in which to insert.
+ * @param {DOMElement} childNode Child node to insert.
+ * @param {number} index Index at which to insert the child.
+ * @internal
+ */
+function insertChildAt(parentNode, childNode, index) {
+  var childNodes = parentNode.childNodes;
+  if (childNodes[index] === childNode) {
+    return;
+  }
+  // If `childNode` is already a child of `parentNode`, remove it so that
+  // computing `childNodes[index]` takes into account the removal.
+  if (childNode.parentNode === parentNode) {
+    parentNode.removeChild(childNode);
+  }
+  if (index >= childNodes.length) {
+    parentNode.appendChild(childNode);
+  } else {
+    parentNode.insertBefore(childNode, childNodes[index]);
+  }
+}
+
+var updateTextContent;
+if (textContentAccessor === 'textContent') {
+  /**
+   * Sets the text content of `node` to `text`.
+   *
+   * @param {DOMElement} node Node to change
+   * @param {string} text New text content
+   */
+  updateTextContent = function(node, text) {
+    node.textContent = text;
+  };
+} else {
+  /**
+   * Sets the text content of `node` to `text`.
+   *
+   * @param {DOMElement} node Node to change
+   * @param {string} text New text content
+   */
+  updateTextContent = function(node, text) {
+    // In order to preserve newlines correctly, we can't use .innerText to set
+    // the contents (see #1080), so we empty the element then append a text node
+    while (node.firstChild) {
+      node.removeChild(node.firstChild);
+    }
+    if (text) {
+      var doc = node.ownerDocument || document;
+      node.appendChild(doc.createTextNode(text));
+    }
+  };
+}
+
+/**
+ * Operations for updating with DOM children.
+ */
+var DOMChildrenOperations = {
+
+  dangerouslyReplaceNodeWithMarkup: Danger.dangerouslyReplaceNodeWithMarkup,
+
+  updateTextContent: updateTextContent,
+
+  /**
+   * Updates a component's children by processing a series of updates. The
+   * update configurations are each expected to have a `parentNode` property.
+   *
+   * @param {array<object>} updates List of update configurations.
+   * @param {array<string>} markupList List of markup strings.
+   * @internal
+   */
+  processUpdates: function(updates, markupList) {
+    var update;
+    // Mapping from parent IDs to initial child orderings.
+    var initialChildren = null;
+    // List of children that will be moved or removed.
+    var updatedChildren = null;
+
+    for (var i = 0; update = updates[i]; i++) {
+      if (update.type === ReactMultiChildUpdateTypes.MOVE_EXISTING ||
+          update.type === ReactMultiChildUpdateTypes.REMOVE_NODE) {
+        var updatedIndex = update.fromIndex;
+        var updatedChild = update.parentNode.childNodes[updatedIndex];
+        var parentID = update.parentID;
+
+        initialChildren = initialChildren || {};
+        initialChildren[parentID] = initialChildren[parentID] || [];
+        initialChildren[parentID][updatedIndex] = updatedChild;
+
+        updatedChildren = updatedChildren || [];
+        updatedChildren.push(updatedChild);
+      }
+    }
+
+    var renderedMarkup = Danger.dangerouslyRenderMarkup(markupList);
+
+    // Remove updated children first so that `toIndex` is consistent.
+    if (updatedChildren) {
+      for (var j = 0; j < updatedChildren.length; j++) {
+        updatedChildren[j].parentNode.removeChild(updatedChildren[j]);
+      }
+    }
+
+    for (var k = 0; update = updates[k]; k++) {
+      switch (update.type) {
+        case ReactMultiChildUpdateTypes.INSERT_MARKUP:
+          insertChildAt(
+            update.parentNode,
+            renderedMarkup[update.markupIndex],
+            update.toIndex
+          );
+          break;
+        case ReactMultiChildUpdateTypes.MOVE_EXISTING:
+          insertChildAt(
+            update.parentNode,
+            initialChildren[update.parentID][update.fromIndex],
+            update.toIndex
+          );
+          break;
+        case ReactMultiChildUpdateTypes.TEXT_CONTENT:
+          updateTextContent(
+            update.parentNode,
+            update.textContent
+          );
+          break;
+        case ReactMultiChildUpdateTypes.REMOVE_NODE:
+          // Already removed by the for-loop above.
+          break;
+      }
+    }
+  }
+
+};
+
+module.exports = DOMChildrenOperations;
+
+},{"./Danger":11,"./ReactMultiChildUpdateTypes":63,"./getTextContentAccessor":121}],9:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule DOMProperty
+ * @typechecks static-only
+ */
+
+/*jslint bitwise: true */
+
+"use strict";
+
+var invariant = _dereq_("./invariant");
+
+var DOMPropertyInjection = {
+  /**
+   * Mapping from normalized, camelcased property names to a configuration that
+   * specifies how the associated DOM property should be accessed or rendered.
+   */
+  MUST_USE_ATTRIBUTE: 0x1,
+  MUST_USE_PROPERTY: 0x2,
+  HAS_SIDE_EFFECTS: 0x4,
+  HAS_BOOLEAN_VALUE: 0x8,
+  HAS_POSITIVE_NUMERIC_VALUE: 0x10,
+
+  /**
+   * Inject some specialized knowledge about the DOM. This takes a config object
+   * with the following properties:
+   *
+   * isCustomAttribute: function that given an attribute name will return true
+   * if it can be inserted into the DOM verbatim. Useful for data-* or aria-*
+   * attributes where it's impossible to enumerate all of the possible
+   * attribute names,
+   *
+   * Properties: object mapping DOM property name to one of the
+   * DOMPropertyInjection constants or null. If your attribute isn't in here,
+   * it won't get written to the DOM.
+   *
+   * DOMAttributeNames: object mapping React attribute name to the DOM
+   * attribute name. Attribute names not specified use the **lowercase**
+   * normalized name.
+   *
+   * DOMPropertyNames: similar to DOMAttributeNames but for DOM properties.
+   * Property names not specified use the normalized name.
+   *
+   * DOMMutationMethods: Properties that require special mutation methods. If
+   * `value` is undefined, the mutation method should unset the property.
+   *
+   * @param {object} domPropertyConfig the config as described above.
+   */
+  injectDOMPropertyConfig: function(domPropertyConfig) {
+    var Properties = domPropertyConfig.Properties || {};
+    var DOMAttributeNames = domPropertyConfig.DOMAttributeNames || {};
+    var DOMPropertyNames = domPropertyConfig.DOMPropertyNames || {};
+    var DOMMutationMethods = domPropertyConfig.DOMMutationMethods || {};
+
+    if (domPropertyConfig.isCustomAttribute) {
+      DOMProperty._isCustomAttributeFunctions.push(
+        domPropertyConfig.isCustomAttribute
+      );
+    }
+
+    for (var propName in Properties) {
+      ("production" !== "development" ? invariant(
+        !DOMProperty.isStandardName[propName],
+        'injectDOMPropertyConfig(...): You\'re trying to inject DOM property ' +
+        '\'%s\' which has already been injected. You may be accidentally ' +
+        'injecting the same DOM property config twice, or you may be ' +
+        'injecting two configs that have conflicting property names.',
+        propName
+      ) : invariant(!DOMProperty.isStandardName[propName]));
+
+      DOMProperty.isStandardName[propName] = true;
+
+      var lowerCased = propName.toLowerCase();
+      DOMProperty.getPossibleStandardName[lowerCased] = propName;
+
+      var attributeName = DOMAttributeNames[propName];
+      if (attributeName) {
+        DOMProperty.getPossibleStandardName[attributeName] = propName;
+      }
+
+      DOMProperty.getAttributeName[propName] = attributeName || lowerCased;
+
+      DOMProperty.getPropertyName[propName] =
+        DOMPropertyNames[propName] || propName;
+
+      var mutationMethod = DOMMutationMethods[propName];
+      if (mutationMethod) {
+        DOMProperty.getMutationMethod[propName] = mutationMethod;
+      }
+
+      var propConfig = Properties[propName];
+      DOMProperty.mustUseAttribute[propName] =
+        propConfig & DOMPropertyInjection.MUST_USE_ATTRIBUTE;
+      DOMProperty.mustUseProperty[propName] =
+        propConfig & DOMPropertyInjection.MUST_USE_PROPERTY;
+      DOMProperty.hasSideEffects[propName] =
+        propConfig & DOMPropertyInjection.HAS_SIDE_EFFECTS;
+      DOMProperty.hasBooleanValue[propName] =
+        propConfig & DOMPropertyInjection.HAS_BOOLEAN_VALUE;
+      DOMProperty.hasPositiveNumericValue[propName] =
+        propConfig & DOMPropertyInjection.HAS_POSITIVE_NUMERIC_VALUE;
+
+      ("production" !== "development" ? invariant(
+        !DOMProperty.mustUseAttribute[propName] ||
+          !DOMProperty.mustUseProperty[propName],
+        'DOMProperty: Cannot require using both attribute and property: %s',
+        propName
+      ) : invariant(!DOMProperty.mustUseAttribute[propName] ||
+        !DOMProperty.mustUseProperty[propName]));
+      ("production" !== "development" ? invariant(
+        DOMProperty.mustUseProperty[propName] ||
+          !DOMProperty.hasSideEffects[propName],
+        'DOMProperty: Properties that have side effects must use property: %s',
+        propName
+      ) : invariant(DOMProperty.mustUseProperty[propName] ||
+        !DOMProperty.hasSideEffects[propName]));
+      ("production" !== "development" ? invariant(
+        !DOMProperty.hasBooleanValue[propName] ||
+          !DOMProperty.hasPositiveNumericValue[propName],
+        'DOMProperty: Cannot have both boolean and positive numeric value: %s',
+        propName
+      ) : invariant(!DOMProperty.hasBooleanValue[propName] ||
+        !DOMProperty.hasPositiveNumericValue[propName]));
+    }
+  }
+};
+var defaultValueCache = {};
+
+/**
+ * DOMProperty exports lookup objects that can be used like functions:
+ *
+ *   > DOMProperty.isValid['id']
+ *   true
+ *   > DOMProperty.isValid['foobar']
+ *   undefined
+ *
+ * Although this may be confusing, it performs better in general.
+ *
+ * @see http://jsperf.com/key-exists
+ * @see http://jsperf.com/key-missing
+ */
+var DOMProperty = {
+
+  ID_ATTRIBUTE_NAME: 'data-reactid',
+
+  /**
+   * Checks whether a property name is a standard property.
+   * @type {Object}
+   */
+  isStandardName: {},
+
+  /**
+   * Mapping from lowercase property names to the properly cased version, used
+   * to warn in the case of missing properties.
+   * @type {Object}
+   */
+  getPossibleStandardName: {},
+
+  /**
+   * Mapping from normalized names to attribute names that differ. Attribute
+   * names are used when rendering markup or with `*Attribute()`.
+   * @type {Object}
+   */
+  getAttributeName: {},
+
+  /**
+   * Mapping from normalized names to properties on DOM node instances.
+   * (This includes properties that mutate due to external factors.)
+   * @type {Object}
+   */
+  getPropertyName: {},
+
+  /**
+   * Mapping from normalized names to mutation methods. This will only exist if
+   * mutation cannot be set simply by the property or `setAttribute()`.
+   * @type {Object}
+   */
+  getMutationMethod: {},
+
+  /**
+   * Whether the property must be accessed and mutated as an object property.
+   * @type {Object}
+   */
+  mustUseAttribute: {},
+
+  /**
+   * Whether the property must be accessed and mutated using `*Attribute()`.
+   * (This includes anything that fails `<propName> in <element>`.)
+   * @type {Object}
+   */
+  mustUseProperty: {},
+
+  /**
+   * Whether or not setting a value causes side effects such as triggering
+   * resources to be loaded or text selection changes. We must ensure that
+   * the value is only set if it has changed.
+   * @type {Object}
+   */
+  hasSideEffects: {},
+
+  /**
+   * Whether the property should be removed when set to a falsey value.
+   * @type {Object}
+   */
+  hasBooleanValue: {},
+
+  /**
+   * Whether the property must be positive numeric or parse as a positive
+   * numeric and should be removed when set to a falsey value.
+   * @type {Object}
+   */
+  hasPositiveNumericValue: {},
+
+  /**
+   * All of the isCustomAttribute() functions that have been injected.
+   */
+  _isCustomAttributeFunctions: [],
+
+  /**
+   * Checks whether a property name is a custom attribute.
+   * @method
+   */
+  isCustomAttribute: function(attributeName) {
+    for (var i = 0; i < DOMProperty._isCustomAttributeFunctions.length; i++) {
+      var isCustomAttributeFn = DOMProperty._isCustomAttributeFunctions[i];
+      if (isCustomAttributeFn(attributeName)) {
+        return true;
+      }
+    }
+    return false;
+  },
+
+  /**
+   * Returns the default property value for a DOM property (i.e., not an
+   * attribute). Most default values are '' or false, but not all. Worse yet,
+   * some (in particular, `type`) vary depending on the type of element.
+   *
+   * TODO: Is it better to grab all the possible properties when creating an
+   * element to avoid having to create the same element twice?
+   */
+  getDefaultValueForProperty: function(nodeName, prop) {
+    var nodeDefaults = defaultValueCache[nodeName];
+    var testElement;
+    if (!nodeDefaults) {
+      defaultValueCache[nodeName] = nodeDefaults = {};
+    }
+    if (!(prop in nodeDefaults)) {
+      testElement = document.createElement(nodeName);
+      nodeDefaults[prop] = testElement[prop];
+    }
+    return nodeDefaults[prop];
+  },
+
+  injection: DOMPropertyInjection
+};
+
+module.exports = DOMProperty;
+
+},{"./invariant":125}],10:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule DOMPropertyOperations
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var DOMProperty = _dereq_("./DOMProperty");
+
+var escapeTextForBrowser = _dereq_("./escapeTextForBrowser");
+var memoizeStringOnly = _dereq_("./memoizeStringOnly");
+var warning = _dereq_("./warning");
+
+function shouldIgnoreValue(name, value) {
+  return value == null ||
+    DOMProperty.hasBooleanValue[name] && !value ||
+    DOMProperty.hasPositiveNumericValue[name] && (isNaN(value) || value < 1);
+}
+
+var processAttributeNameAndPrefix = memoizeStringOnly(function(name) {
+  return escapeTextForBrowser(name) + '="';
+});
+
+if ("production" !== "development") {
+  var reactProps = {
+    children: true,
+    dangerouslySetInnerHTML: true,
+    key: true,
+    ref: true
+  };
+  var warnedProperties = {};
+
+  var warnUnknownProperty = function(name) {
+    if (reactProps[name] || warnedProperties[name]) {
+      return;
+    }
+
+    warnedProperties[name] = true;
+    var lowerCasedName = name.toLowerCase();
+
+    // data-* attributes should be lowercase; suggest the lowercase version
+    var standardName = DOMProperty.isCustomAttribute(lowerCasedName) ?
+      lowerCasedName : DOMProperty.getPossibleStandardName[lowerCasedName];
+
+    // For now, only warn when we have a suggested correction. This prevents
+    // logging too much when using transferPropsTo.
+    ("production" !== "development" ? warning(
+      standardName == null,
+      'Unknown DOM property ' + name + '. Did you mean ' + standardName + '?'
+    ) : null);
+
+  };
+}
+
+/**
+ * Operations for dealing with DOM properties.
+ */
+var DOMPropertyOperations = {
+
+  /**
+   * Creates markup for the ID property.
+   *
+   * @param {string} id Unescaped ID.
+   * @return {string} Markup string.
+   */
+  createMarkupForID: function(id) {
+    return processAttributeNameAndPrefix(DOMProperty.ID_ATTRIBUTE_NAME) +
+      escapeTextForBrowser(id) + '"';
+  },
+
+  /**
+   * Creates markup for a property.
+   *
+   * @param {string} name
+   * @param {*} value
+   * @return {?string} Markup string, or null if the property was invalid.
+   */
+  createMarkupForProperty: function(name, value) {
+    if (DOMProperty.isStandardName[name]) {
+      if (shouldIgnoreValue(name, value)) {
+        return '';
+      }
+      var attributeName = DOMProperty.getAttributeName[name];
+      if (DOMProperty.hasBooleanValue[name]) {
+        return escapeTextForBrowser(attributeName);
+      }
+      return processAttributeNameAndPrefix(attributeName) +
+        escapeTextForBrowser(value) + '"';
+    } else if (DOMProperty.isCustomAttribute(name)) {
+      if (value == null) {
+        return '';
+      }
+      return processAttributeNameAndPrefix(name) +
+        escapeTextForBrowser(value) + '"';
+    } else if ("production" !== "development") {
+      warnUnknownProperty(name);
+    }
+    return null;
+  },
+
+  /**
+   * Sets the value for a property on a node.
+   *
+   * @param {DOMElement} node
+   * @param {string} name
+   * @param {*} value
+   */
+  setValueForProperty: function(node, name, value) {
+    if (DOMProperty.isStandardName[name]) {
+      var mutationMethod = DOMProperty.getMutationMethod[name];
+      if (mutationMethod) {
+        mutationMethod(node, value);
+      } else if (shouldIgnoreValue(name, value)) {
+        this.deleteValueForProperty(node, name);
+      } else if (DOMProperty.mustUseAttribute[name]) {
+        node.setAttribute(DOMProperty.getAttributeName[name], '' + value);
+      } else {
+        var propName = DOMProperty.getPropertyName[name];
+        if (!DOMProperty.hasSideEffects[name] || node[propName] !== value) {
+          node[propName] = value;
+        }
+      }
+    } else if (DOMProperty.isCustomAttribute(name)) {
+      if (value == null) {
+        node.removeAttribute(DOMProperty.getAttributeName[name]);
+      } else {
+        node.setAttribute(name, '' + value);
+      }
+    } else if ("production" !== "development") {
+      warnUnknownProperty(name);
+    }
+  },
+
+  /**
+   * Deletes the value for a property on a node.
+   *
+   * @param {DOMElement} node
+   * @param {string} name
+   */
+  deleteValueForProperty: function(node, name) {
+    if (DOMProperty.isStandardName[name]) {
+      var mutationMethod = DOMProperty.getMutationMethod[name];
+      if (mutationMethod) {
+        mutationMethod(node, undefined);
+      } else if (DOMProperty.mustUseAttribute[name]) {
+        node.removeAttribute(DOMProperty.getAttributeName[name]);
+      } else {
+        var propName = DOMProperty.getPropertyName[name];
+        var defaultValue = DOMProperty.getDefaultValueForProperty(
+          node.nodeName,
+          propName
+        );
+        if (!DOMProperty.hasSideEffects[name] ||
+            node[propName] !== defaultValue) {
+          node[propName] = defaultValue;
+        }
+      }
+    } else if (DOMProperty.isCustomAttribute(name)) {
+      node.removeAttribute(name);
+    } else if ("production" !== "development") {
+      warnUnknownProperty(name);
+    }
+  }
+
+};
+
+module.exports = DOMPropertyOperations;
+
+},{"./DOMProperty":9,"./escapeTextForBrowser":111,"./memoizeStringOnly":133,"./warning":148}],11:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule Danger
+ * @typechecks static-only
+ */
+
+/*jslint evil: true, sub: true */
+
+"use strict";
+
+var ExecutionEnvironment = _dereq_("./ExecutionEnvironment");
+
+var createNodesFromMarkup = _dereq_("./createNodesFromMarkup");
+var emptyFunction = _dereq_("./emptyFunction");
+var getMarkupWrap = _dereq_("./getMarkupWrap");
+var invariant = _dereq_("./invariant");
+
+var OPEN_TAG_NAME_EXP = /^(<[^ \/>]+)/;
+var RESULT_INDEX_ATTR = 'data-danger-index';
+
+/**
+ * Extracts the `nodeName` from a string of markup.
+ *
+ * NOTE: Extracting the `nodeName` does not require a regular expression match
+ * because we make assumptions about React-generated markup (i.e. there are no
+ * spaces surrounding the opening tag and there is at least one attribute).
+ *
+ * @param {string} markup String of markup.
+ * @return {string} Node name of the supplied markup.
+ * @see http://jsperf.com/extract-nodename
+ */
+function getNodeName(markup) {
+  return markup.substring(1, markup.indexOf(' '));
+}
+
+var Danger = {
+
+  /**
+   * Renders markup into an array of nodes. The markup is expected to render
+   * into a list of root nodes. Also, the length of `resultList` and
+   * `markupList` should be the same.
+   *
+   * @param {array<string>} markupList List of markup strings to render.
+   * @return {array<DOMElement>} List of rendered nodes.
+   * @internal
+   */
+  dangerouslyRenderMarkup: function(markupList) {
+    ("production" !== "development" ? invariant(
+      ExecutionEnvironment.canUseDOM,
+      'dangerouslyRenderMarkup(...): Cannot render markup in a Worker ' +
+      'thread. This is likely a bug in the framework. Please report ' +
+      'immediately.'
+    ) : invariant(ExecutionEnvironment.canUseDOM));
+    var nodeName;
+    var markupByNodeName = {};
+    // Group markup by `nodeName` if a wrap is necessary, else by '*'.
+    for (var i = 0; i < markupList.length; i++) {
+      ("production" !== "development" ? invariant(
+        markupList[i],
+        'dangerouslyRenderMarkup(...): Missing markup.'
+      ) : invariant(markupList[i]));
+      nodeName = getNodeName(markupList[i]);
+      nodeName = getMarkupWrap(nodeName) ? nodeName : '*';
+      markupByNodeName[nodeName] = markupByNodeName[nodeName] || [];
+      markupByNodeName[nodeName][i] = markupList[i];
+    }
+    var resultList = [];
+    var resultListAssignmentCount = 0;
+    for (nodeName in markupByNodeName) {
+      if (!markupByNodeName.hasOwnProperty(nodeName)) {
+        continue;
+      }
+      var markupListByNodeName = markupByNodeName[nodeName];
+
+      // This for-in loop skips the holes of the sparse array. The order of
+      // iteration should follow the order of assignment, which happens to match
+      // numerical index order, but we don't rely on that.
+      for (var resultIndex in markupListByNodeName) {
+        if (markupListByNodeName.hasOwnProperty(resultIndex)) {
+          var markup = markupListByNodeName[resultIndex];
+
+          // Push the requested markup with an additional RESULT_INDEX_ATTR
+          // attribute.  If the markup does not start with a < character, it
+          // will be discarded below (with an appropriate console.error).
+          markupListByNodeName[resultIndex] = markup.replace(
+            OPEN_TAG_NAME_EXP,
+            // This index will be parsed back out below.
+            '$1 ' + RESULT_INDEX_ATTR + '="' + resultIndex + '" '
+          );
+        }
+      }
+
+      // Render each group of markup with similar wrapping `nodeName`.
+      var renderNodes = createNodesFromMarkup(
+        markupListByNodeName.join(''),
+        emptyFunction // Do nothing special with <script> tags.
+      );
+
+      for (i = 0; i < renderNodes.length; ++i) {
+        var renderNode = renderNodes[i];
+        if (renderNode.hasAttribute &&
+            renderNode.hasAttribute(RESULT_INDEX_ATTR)) {
+
+          resultIndex = +renderNode.getAttribute(RESULT_INDEX_ATTR);
+          renderNode.removeAttribute(RESULT_INDEX_ATTR);
+
+          ("production" !== "development" ? invariant(
+            !resultList.hasOwnProperty(resultIndex),
+            'Danger: Assigning to an already-occupied result index.'
+          ) : invariant(!resultList.hasOwnProperty(resultIndex)));
+
+          resultList[resultIndex] = renderNode;
+
+          // This should match resultList.length and markupList.length when
+          // we're done.
+          resultListAssignmentCount += 1;
+
+        } else if ("production" !== "development") {
+          console.error(
+            "Danger: Discarding unexpected node:",
+            renderNode
+          );
+        }
+      }
+    }
+
+    // Although resultList was populated out of order, it should now be a dense
+    // array.
+    ("production" !== "development" ? invariant(
+      resultListAssignmentCount === resultList.length,
+      'Danger: Did not assign to every index of resultList.'
+    ) : invariant(resultListAssignmentCount === resultList.length));
+
+    ("production" !== "development" ? invariant(
+      resultList.length === markupList.length,
+      'Danger: Expected markup to render %s nodes, but rendered %s.',
+      markupList.length,
+      resultList.length
+    ) : invariant(resultList.length === markupList.length));
+
+    return resultList;
+  },
+
+  /**
+   * Replaces a node with a string of markup at its current position within its
+   * parent. The markup must render into a single root node.
+   *
+   * @param {DOMElement} oldChild Child node to replace.
+   * @param {string} markup Markup to render in place of the child node.
+   * @internal
+   */
+  dangerouslyReplaceNodeWithMarkup: function(oldChild, markup) {
+    ("production" !== "development" ? invariant(
+      ExecutionEnvironment.canUseDOM,
+      'dangerouslyReplaceNodeWithMarkup(...): Cannot render markup in a ' +
+      'worker thread. This is likely a bug in the framework. Please report ' +
+      'immediately.'
+    ) : invariant(ExecutionEnvironment.canUseDOM));
+    ("production" !== "development" ? invariant(markup, 'dangerouslyReplaceNodeWithMarkup(...): Missing markup.') : invariant(markup));
+    ("production" !== "development" ? invariant(
+      oldChild.tagName.toLowerCase() !== 'html',
+      'dangerouslyReplaceNodeWithMarkup(...): Cannot replace markup of the ' +
+      '<html> node. This is because browser quirks make this unreliable ' +
+      'and/or slow. If you want to render to the root you must use ' +
+      'server rendering. See renderComponentToString().'
+    ) : invariant(oldChild.tagName.toLowerCase() !== 'html'));
+
+    var newChild = createNodesFromMarkup(markup, emptyFunction)[0];
+    oldChild.parentNode.replaceChild(newChild, oldChild);
+  }
+
+};
+
+module.exports = Danger;
+
+},{"./ExecutionEnvironment":21,"./createNodesFromMarkup":105,"./emptyFunction":109,"./getMarkupWrap":118,"./invariant":125}],12:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule DefaultDOMPropertyConfig
+ */
+
+/*jslint bitwise: true*/
+
+"use strict";
+
+var DOMProperty = _dereq_("./DOMProperty");
+
+var MUST_USE_ATTRIBUTE = DOMProperty.injection.MUST_USE_ATTRIBUTE;
+var MUST_USE_PROPERTY = DOMProperty.injection.MUST_USE_PROPERTY;
+var HAS_BOOLEAN_VALUE = DOMProperty.injection.HAS_BOOLEAN_VALUE;
+var HAS_SIDE_EFFECTS = DOMProperty.injection.HAS_SIDE_EFFECTS;
+var HAS_POSITIVE_NUMERIC_VALUE =
+  DOMProperty.injection.HAS_POSITIVE_NUMERIC_VALUE;
+
+var DefaultDOMPropertyConfig = {
+  isCustomAttribute: RegExp.prototype.test.bind(
+    /^(data|aria)-[a-z_][a-z\d_.\-]*$/
+  ),
+  Properties: {
+    /**
+     * Standard Properties
+     */
+    accept: null,
+    accessKey: null,
+    action: null,
+    allowFullScreen: MUST_USE_ATTRIBUTE | HAS_BOOLEAN_VALUE,
+    allowTransparency: MUST_USE_ATTRIBUTE,
+    alt: null,
+    async: HAS_BOOLEAN_VALUE,
+    autoComplete: null,
+    // autoFocus is polyfilled/normalized by AutoFocusMixin
+    // autoFocus: HAS_BOOLEAN_VALUE,
+    autoPlay: HAS_BOOLEAN_VALUE,
+    cellPadding: null,
+    cellSpacing: null,
+    charSet: MUST_USE_ATTRIBUTE,
+    checked: MUST_USE_PROPERTY | HAS_BOOLEAN_VALUE,
+    className: MUST_USE_PROPERTY,
+    cols: MUST_USE_ATTRIBUTE | HAS_POSITIVE_NUMERIC_VALUE,
+    colSpan: null,
+    content: null,
+    contentEditable: null,
+    contextMenu: MUST_USE_ATTRIBUTE,
+    controls: MUST_USE_PROPERTY | HAS_BOOLEAN_VALUE,
+    crossOrigin: null,
+    data: null, // For `<object />` acts as `src`.
+    dateTime: MUST_USE_ATTRIBUTE,
+    defer: HAS_BOOLEAN_VALUE,
+    dir: null,
+    disabled: MUST_USE_ATTRIBUTE | HAS_BOOLEAN_VALUE,
+    download: null,
+    draggable: null,
+    encType: null,
+    form: MUST_USE_ATTRIBUTE,
+    formNoValidate: HAS_BOOLEAN_VALUE,
+    frameBorder: MUST_USE_ATTRIBUTE,
+    height: MUST_USE_ATTRIBUTE,
+    hidden: MUST_USE_ATTRIBUTE | HAS_BOOLEAN_VALUE,
+    href: null,
+    hrefLang: null,
+    htmlFor: null,
+    httpEquiv: null,
+    icon: null,
+    id: MUST_USE_PROPERTY,
+    label: null,
+    lang: null,
+    list: null,
+    loop: MUST_USE_PROPERTY | HAS_BOOLEAN_VALUE,
+    max: null,
+    maxLength: MUST_USE_ATTRIBUTE,
+    mediaGroup: null,
+    method: null,
+    min: null,
+    multiple: MUST_USE_PROPERTY | HAS_BOOLEAN_VALUE,
+    muted: MUST_USE_PROPERTY | HAS_BOOLEAN_VALUE,
+    name: null,
+    noValidate: HAS_BOOLEAN_VALUE,
+    pattern: null,
+    placeholder: null,
+    poster: null,
+    preload: null,
+    radioGroup: null,
+    readOnly: MUST_USE_PROPERTY | HAS_BOOLEAN_VALUE,
+    rel: null,
+    required: HAS_BOOLEAN_VALUE,
+    role: MUST_USE_ATTRIBUTE,
+    rows: MUST_USE_ATTRIBUTE | HAS_POSITIVE_NUMERIC_VALUE,
+    rowSpan: null,
+    sandbox: null,
+    scope: null,
+    scrollLeft: MUST_USE_PROPERTY,
+    scrollTop: MUST_USE_PROPERTY,
+    seamless: MUST_USE_ATTRIBUTE | HAS_BOOLEAN_VALUE,
+    selected: MUST_USE_PROPERTY | HAS_BOOLEAN_VALUE,
+    size: MUST_USE_ATTRIBUTE | HAS_POSITIVE_NUMERIC_VALUE,
+    span: HAS_POSITIVE_NUMERIC_VALUE,
+    spellCheck: null,
+    src: null,
+    srcDoc: MUST_USE_PROPERTY,
+    srcSet: null,
+    step: null,
+    style: null,
+    tabIndex: null,
+    target: null,
+    title: null,
+    type: null,
+    value: MUST_USE_PROPERTY | HAS_SIDE_EFFECTS,
+    width: MUST_USE_ATTRIBUTE,
+    wmode: MUST_USE_ATTRIBUTE,
+
+    /**
+     * Non-standard Properties
+     */
+    autoCapitalize: null, // Supported in Mobile Safari for keyboard hints
+    autoCorrect: null, // Supported in Mobile Safari for keyboard hints
+    property: null, // Supports OG in meta tags
+
+    /**
+     * SVG Properties
+     */
+    cx: MUST_USE_ATTRIBUTE,
+    cy: MUST_USE_ATTRIBUTE,
+    d: MUST_USE_ATTRIBUTE,
+    fill: MUST_USE_ATTRIBUTE,
+    fx: MUST_USE_ATTRIBUTE,
+    fy: MUST_USE_ATTRIBUTE,
+    gradientTransform: MUST_USE_ATTRIBUTE,
+    gradientUnits: MUST_USE_ATTRIBUTE,
+    offset: MUST_USE_ATTRIBUTE,
+    points: MUST_USE_ATTRIBUTE,
+    r: MUST_USE_ATTRIBUTE,
+    rx: MUST_USE_ATTRIBUTE,
+    ry: MUST_USE_ATTRIBUTE,
+    spreadMethod: MUST_USE_ATTRIBUTE,
+    stopColor: MUST_USE_ATTRIBUTE,
+    stopOpacity: MUST_USE_ATTRIBUTE,
+    stroke: MUST_USE_ATTRIBUTE,
+    strokeLinecap: MUST_USE_ATTRIBUTE,
+    strokeWidth: MUST_USE_ATTRIBUTE,
+    textAnchor: MUST_USE_ATTRIBUTE,
+    transform: MUST_USE_ATTRIBUTE,
+    version: MUST_USE_ATTRIBUTE,
+    viewBox: MUST_USE_ATTRIBUTE,
+    x1: MUST_USE_ATTRIBUTE,
+    x2: MUST_USE_ATTRIBUTE,
+    x: MUST_USE_ATTRIBUTE,
+    y1: MUST_USE_ATTRIBUTE,
+    y2: MUST_USE_ATTRIBUTE,
+    y: MUST_USE_ATTRIBUTE
+  },
+  DOMAttributeNames: {
+    className: 'class',
+    gradientTransform: 'gradientTransform',
+    gradientUnits: 'gradientUnits',
+    htmlFor: 'for',
+    spreadMethod: 'spreadMethod',
+    stopColor: 'stop-color',
+    stopOpacity: 'stop-opacity',
+    strokeLinecap: 'stroke-linecap',
+    strokeWidth: 'stroke-width',
+    textAnchor: 'text-anchor',
+    viewBox: 'viewBox'
+  },
+  DOMPropertyNames: {
+    autoCapitalize: 'autocapitalize',
+    autoComplete: 'autocomplete',
+    autoCorrect: 'autocorrect',
+    autoFocus: 'autofocus',
+    autoPlay: 'autoplay',
+    encType: 'enctype',
+    hrefLang: 'hreflang',
+    radioGroup: 'radiogroup',
+    spellCheck: 'spellcheck',
+    srcDoc: 'srcdoc',
+    srcSet: 'srcset'
+  }
+};
+
+module.exports = DefaultDOMPropertyConfig;
+
+},{"./DOMProperty":9}],13:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule DefaultEventPluginOrder
+ */
+
+"use strict";
+
+ var keyOf = _dereq_("./keyOf");
+
+/**
+ * Module that is injectable into `EventPluginHub`, that specifies a
+ * deterministic ordering of `EventPlugin`s. A convenient way to reason about
+ * plugins, without having to package every one of them. This is better than
+ * having plugins be ordered in the same order that they are injected because
+ * that ordering would be influenced by the packaging order.
+ * `ResponderEventPlugin` must occur before `SimpleEventPlugin` so that
+ * preventing default on events is convenient in `SimpleEventPlugin` handlers.
+ */
+var DefaultEventPluginOrder = [
+  keyOf({ResponderEventPlugin: null}),
+  keyOf({SimpleEventPlugin: null}),
+  keyOf({TapEventPlugin: null}),
+  keyOf({EnterLeaveEventPlugin: null}),
+  keyOf({ChangeEventPlugin: null}),
+  keyOf({SelectEventPlugin: null}),
+  keyOf({CompositionEventPlugin: null}),
+  keyOf({AnalyticsEventPlugin: null}),
+  keyOf({MobileSafariClickEventPlugin: null})
+];
+
+module.exports = DefaultEventPluginOrder;
+
+},{"./keyOf":132}],14:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule EnterLeaveEventPlugin
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var EventConstants = _dereq_("./EventConstants");
+var EventPropagators = _dereq_("./EventPropagators");
+var SyntheticMouseEvent = _dereq_("./SyntheticMouseEvent");
+
+var ReactMount = _dereq_("./ReactMount");
+var keyOf = _dereq_("./keyOf");
+
+var topLevelTypes = EventConstants.topLevelTypes;
+var getFirstReactDOM = ReactMount.getFirstReactDOM;
+
+var eventTypes = {
+  mouseEnter: {
+    registrationName: keyOf({onMouseEnter: null}),
+    dependencies: [
+      topLevelTypes.topMouseOut,
+      topLevelTypes.topMouseOver
+    ]
+  },
+  mouseLeave: {
+    registrationName: keyOf({onMouseLeave: null}),
+    dependencies: [
+      topLevelTypes.topMouseOut,
+      topLevelTypes.topMouseOver
+    ]
+  }
+};
+
+var extractedEvents = [null, null];
+
+var EnterLeaveEventPlugin = {
+
+  eventTypes: eventTypes,
+
+  /**
+   * For almost every interaction we care about, there will be both a top-level
+   * `mouseover` and `mouseout` event that occurs. Only use `mouseout` so that
+   * we do not extract duplicate events. However, moving the mouse into the
+   * browser from outside will not fire a `mouseout` event. In this case, we use
+   * the `mouseover` top-level event.
+   *
+   * @param {string} topLevelType Record from `EventConstants`.
+   * @param {DOMEventTarget} topLevelTarget The listening component root node.
+   * @param {string} topLevelTargetID ID of `topLevelTarget`.
+   * @param {object} nativeEvent Native browser event.
+   * @return {*} An accumulation of synthetic events.
+   * @see {EventPluginHub.extractEvents}
+   */
+  extractEvents: function(
+      topLevelType,
+      topLevelTarget,
+      topLevelTargetID,
+      nativeEvent) {
+    if (topLevelType === topLevelTypes.topMouseOver &&
+        (nativeEvent.relatedTarget || nativeEvent.fromElement)) {
+      return null;
+    }
+    if (topLevelType !== topLevelTypes.topMouseOut &&
+        topLevelType !== topLevelTypes.topMouseOver) {
+      // Must not be a mouse in or mouse out - ignoring.
+      return null;
+    }
+
+    var win;
+    if (topLevelTarget.window === topLevelTarget) {
+      // `topLevelTarget` is probably a window object.
+      win = topLevelTarget;
+    } else {
+      // TODO: Figure out why `ownerDocument` is sometimes undefined in IE8.
+      var doc = topLevelTarget.ownerDocument;
+      if (doc) {
+        win = doc.defaultView || doc.parentWindow;
+      } else {
+        win = window;
+      }
+    }
+
+    var from, to;
+    if (topLevelType === topLevelTypes.topMouseOut) {
+      from = topLevelTarget;
+      to =
+        getFirstReactDOM(nativeEvent.relatedTarget || nativeEvent.toElement) ||
+        win;
+    } else {
+      from = win;
+      to = topLevelTarget;
+    }
+
+    if (from === to) {
+      // Nothing pertains to our managed components.
+      return null;
+    }
+
+    var fromID = from ? ReactMount.getID(from) : '';
+    var toID = to ? ReactMount.getID(to) : '';
+
+    var leave = SyntheticMouseEvent.getPooled(
+      eventTypes.mouseLeave,
+      fromID,
+      nativeEvent
+    );
+    leave.type = 'mouseleave';
+    leave.target = from;
+    leave.relatedTarget = to;
+
+    var enter = SyntheticMouseEvent.getPooled(
+      eventTypes.mouseEnter,
+      toID,
+      nativeEvent
+    );
+    enter.type = 'mouseenter';
+    enter.target = to;
+    enter.relatedTarget = from;
+
+    EventPropagators.accumulateEnterLeaveDispatches(leave, enter, fromID, toID);
+
+    extractedEvents[0] = leave;
+    extractedEvents[1] = enter;
+
+    return extractedEvents;
+  }
+
+};
+
+module.exports = EnterLeaveEventPlugin;
+
+},{"./EventConstants":15,"./EventPropagators":20,"./ReactMount":60,"./SyntheticMouseEvent":92,"./keyOf":132}],15:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule EventConstants
+ */
+
+"use strict";
+
+var keyMirror = _dereq_("./keyMirror");
+
+var PropagationPhases = keyMirror({bubbled: null, captured: null});
+
+/**
+ * Types of raw signals from the browser caught at the top level.
+ */
+var topLevelTypes = keyMirror({
+  topBlur: null,
+  topChange: null,
+  topClick: null,
+  topCompositionEnd: null,
+  topCompositionStart: null,
+  topCompositionUpdate: null,
+  topContextMenu: null,
+  topCopy: null,
+  topCut: null,
+  topDoubleClick: null,
+  topDrag: null,
+  topDragEnd: null,
+  topDragEnter: null,
+  topDragExit: null,
+  topDragLeave: null,
+  topDragOver: null,
+  topDragStart: null,
+  topDrop: null,
+  topError: null,
+  topFocus: null,
+  topInput: null,
+  topKeyDown: null,
+  topKeyPress: null,
+  topKeyUp: null,
+  topLoad: null,
+  topMouseDown: null,
+  topMouseMove: null,
+  topMouseOut: null,
+  topMouseOver: null,
+  topMouseUp: null,
+  topPaste: null,
+  topReset: null,
+  topScroll: null,
+  topSelectionChange: null,
+  topSubmit: null,
+  topTouchCancel: null,
+  topTouchEnd: null,
+  topTouchMove: null,
+  topTouchStart: null,
+  topWheel: null
+});
+
+var EventConstants = {
+  topLevelTypes: topLevelTypes,
+  PropagationPhases: PropagationPhases
+};
+
+module.exports = EventConstants;
+
+},{"./keyMirror":131}],16:[function(_dereq_,module,exports){
+/**
+ * @providesModule EventListener
+ */
+
+var emptyFunction = _dereq_("./emptyFunction");
+
+/**
+ * Upstream version of event listener. Does not take into account specific
+ * nature of platform.
+ */
+var EventListener = {
+  /**
+   * Listen to DOM events during the bubble phase.
+   *
+   * @param {DOMEventTarget} target DOM element to register listener on.
+   * @param {string} eventType Event type, e.g. 'click' or 'mouseover'.
+   * @param {function} callback Callback function.
+   * @return {object} Object with a `remove` method.
+   */
+  listen: function(target, eventType, callback) {
+    if (target.addEventListener) {
+      target.addEventListener(eventType, callback, false);
+      return {
+        remove: function() {
+          target.removeEventListener(eventType, callback, false);
+        }
+      };
+    } else if (target.attachEvent) {
+      target.attachEvent('on' + eventType, callback);
+      return {
+        remove: function() {
+          target.detachEvent(eventType, callback);
+        }
+      };
+    }
+  },
+
+  /**
+   * Listen to DOM events during the capture phase.
+   *
+   * @param {DOMEventTarget} target DOM element to register listener on.
+   * @param {string} eventType Event type, e.g. 'click' or 'mouseover'.
+   * @param {function} callback Callback function.
+   * @return {object} Object with a `remove` method.
+   */
+  capture: function(target, eventType, callback) {
+    if (!target.addEventListener) {
+      if ("production" !== "development") {
+        console.error(
+          'Attempted to listen to events during the capture phase on a ' +
+          'browser that does not support the capture phase. Your application ' +
+          'will not receive some events.'
+        );
+      }
+      return {
+        remove: emptyFunction
+      };
+    } else {
+      target.addEventListener(eventType, callback, true);
+      return {
+        remove: function() {
+          target.removeEventListener(eventType, callback, true);
+        }
+      };
+    }
+  }
+};
+
+module.exports = EventListener;
+
+},{"./emptyFunction":109}],17:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule EventPluginHub
+ */
+
+"use strict";
+
+var EventPluginRegistry = _dereq_("./EventPluginRegistry");
+var EventPluginUtils = _dereq_("./EventPluginUtils");
+var ExecutionEnvironment = _dereq_("./ExecutionEnvironment");
+
+var accumulate = _dereq_("./accumulate");
+var forEachAccumulated = _dereq_("./forEachAccumulated");
+var invariant = _dereq_("./invariant");
+var isEventSupported = _dereq_("./isEventSupported");
+var monitorCodeUse = _dereq_("./monitorCodeUse");
+
+/**
+ * Internal store for event listeners
+ */
+var listenerBank = {};
+
+/**
+ * Internal queue of events that have accumulated their dispatches and are
+ * waiting to have their dispatches executed.
+ */
+var eventQueue = null;
+
+/**
+ * Dispatches an event and releases it back into the pool, unless persistent.
+ *
+ * @param {?object} event Synthetic event to be dispatched.
+ * @private
+ */
+var executeDispatchesAndRelease = function(event) {
+  if (event) {
+    var executeDispatch = EventPluginUtils.executeDispatch;
+    // Plugins can provide custom behavior when dispatching events.
+    var PluginModule = EventPluginRegistry.getPluginModuleForEvent(event);
+    if (PluginModule && PluginModule.executeDispatch) {
+      executeDispatch = PluginModule.executeDispatch;
+    }
+    EventPluginUtils.executeDispatchesInOrder(event, executeDispatch);
+
+    if (!event.isPersistent()) {
+      event.constructor.release(event);
+    }
+  }
+};
+
+/**
+ * - `InstanceHandle`: [required] Module that performs logical traversals of DOM
+ *   hierarchy given ids of the logical DOM elements involved.
+ */
+var InstanceHandle = null;
+
+function validateInstanceHandle() {
+  var invalid = !InstanceHandle||
+    !InstanceHandle.traverseTwoPhase ||
+    !InstanceHandle.traverseEnterLeave;
+  if (invalid) {
+    throw new Error('InstanceHandle not injected before use!');
+  }
+}
+
+/**
+ * This is a unified interface for event plugins to be installed and configured.
+ *
+ * Event plugins can implement the following properties:
+ *
+ *   `extractEvents` {function(string, DOMEventTarget, string, object): *}
+ *     Required. When a top-level event is fired, this method is expected to
+ *     extract synthetic events that will in turn be queued and dispatched.
+ *
+ *   `eventTypes` {object}
+ *     Optional, plugins that fire events must publish a mapping of registration
+ *     names that are used to register listeners. Values of this mapping must
+ *     be objects that contain `registrationName` or `phasedRegistrationNames`.
+ *
+ *   `executeDispatch` {function(object, function, string)}
+ *     Optional, allows plugins to override how an event gets dispatched. By
+ *     default, the listener is simply invoked.
+ *
+ * Each plugin that is injected into `EventsPluginHub` is immediately operable.
+ *
+ * @public
+ */
+var EventPluginHub = {
+
+  /**
+   * Methods for injecting dependencies.
+   */
+  injection: {
+
+    /**
+     * @param {object} InjectedMount
+     * @public
+     */
+    injectMount: EventPluginUtils.injection.injectMount,
+
+    /**
+     * @param {object} InjectedInstanceHandle
+     * @public
+     */
+    injectInstanceHandle: function(InjectedInstanceHandle) {
+      InstanceHandle = InjectedInstanceHandle;
+      if ("production" !== "development") {
+        validateInstanceHandle();
+      }
+    },
+
+    getInstanceHandle: function() {
+      if ("production" !== "development") {
+        validateInstanceHandle();
+      }
+      return InstanceHandle;
+    },
+
+    /**
+     * @param {array} InjectedEventPluginOrder
+     * @public
+     */
+    injectEventPluginOrder: EventPluginRegistry.injectEventPluginOrder,
+
+    /**
+     * @param {object} injectedNamesToPlugins Map from names to plugin modules.
+     */
+    injectEventPluginsByName: EventPluginRegistry.injectEventPluginsByName
+
+  },
+
+  eventNameDispatchConfigs: EventPluginRegistry.eventNameDispatchConfigs,
+
+  registrationNameModules: EventPluginRegistry.registrationNameModules,
+
+  /**
+   * Stores `listener` at `listenerBank[registrationName][id]`. Is idempotent.
+   *
+   * @param {string} id ID of the DOM element.
+   * @param {string} registrationName Name of listener (e.g. `onClick`).
+   * @param {?function} listener The callback to store.
+   */
+  putListener: function(id, registrationName, listener) {
+    ("production" !== "development" ? invariant(
+      ExecutionEnvironment.canUseDOM,
+      'Cannot call putListener() in a non-DOM environment.'
+    ) : invariant(ExecutionEnvironment.canUseDOM));
+    ("production" !== "development" ? invariant(
+      !listener || typeof listener === 'function',
+      'Expected %s listener to be a function, instead got type %s',
+      registrationName, typeof listener
+    ) : invariant(!listener || typeof listener === 'function'));
+
+    if ("production" !== "development") {
+      // IE8 has no API for event capturing and the `onScroll` event doesn't
+      // bubble.
+      if (registrationName === 'onScroll' &&
+          !isEventSupported('scroll', true)) {
+        monitorCodeUse('react_no_scroll_event');
+        console.warn('This browser doesn\'t support the `onScroll` event');
+      }
+    }
+    var bankForRegistrationName =
+      listenerBank[registrationName] || (listenerBank[registrationName] = {});
+    bankForRegistrationName[id] = listener;
+  },
+
+  /**
+   * @param {string} id ID of the DOM element.
+   * @param {string} registrationName Name of listener (e.g. `onClick`).
+   * @return {?function} The stored callback.
+   */
+  getListener: function(id, registrationName) {
+    var bankForRegistrationName = listenerBank[registrationName];
+    return bankForRegistrationName && bankForRegistrationName[id];
+  },
+
+  /**
+   * Deletes a listener from the registration bank.
+   *
+   * @param {string} id ID of the DOM element.
+   * @param {string} registrationName Name of listener (e.g. `onClick`).
+   */
+  deleteListener: function(id, registrationName) {
+    var bankForRegistrationName = listenerBank[registrationName];
+    if (bankForRegistrationName) {
+      delete bankForRegistrationName[id];
+    }
+  },
+
+  /**
+   * Deletes all listeners for the DOM element with the supplied ID.
+   *
+   * @param {string} id ID of the DOM element.
+   */
+  deleteAllListeners: function(id) {
+    for (var registrationName in listenerBank) {
+      delete listenerBank[registrationName][id];
+    }
+  },
+
+  /**
+   * Allows registered plugins an opportunity to extract events from top-level
+   * native browser events.
+   *
+   * @param {string} topLevelType Record from `EventConstants`.
+   * @param {DOMEventTarget} topLevelTarget The listening component root node.
+   * @param {string} topLevelTargetID ID of `topLevelTarget`.
+   * @param {object} nativeEvent Native browser event.
+   * @return {*} An accumulation of synthetic events.
+   * @internal
+   */
+  extractEvents: function(
+      topLevelType,
+      topLevelTarget,
+      topLevelTargetID,
+      nativeEvent) {
+    var events;
+    var plugins = EventPluginRegistry.plugins;
+    for (var i = 0, l = plugins.length; i < l; i++) {
+      // Not every plugin in the ordering may be loaded at runtime.
+      var possiblePlugin = plugins[i];
+      if (possiblePlugin) {
+        var extractedEvents = possiblePlugin.extractEvents(
+          topLevelType,
+          topLevelTarget,
+          topLevelTargetID,
+          nativeEvent
+        );
+        if (extractedEvents) {
+          events = accumulate(events, extractedEvents);
+        }
+      }
+    }
+    return events;
+  },
+
+  /**
+   * Enqueues a synthetic event that should be dispatched when
+   * `processEventQueue` is invoked.
+   *
+   * @param {*} events An accumulation of synthetic events.
+   * @internal
+   */
+  enqueueEvents: function(events) {
+    if (events) {
+      eventQueue = accumulate(eventQueue, events);
+    }
+  },
+
+  /**
+   * Dispatches all synthetic events on the event queue.
+   *
+   * @internal
+   */
+  processEventQueue: function() {
+    // Set `eventQueue` to null before processing it so that we can tell if more
+    // events get enqueued while processing.
+    var processingEventQueue = eventQueue;
+    eventQueue = null;
+    forEachAccumulated(processingEventQueue, executeDispatchesAndRelease);
+    ("production" !== "development" ? invariant(
+      !eventQueue,
+      'processEventQueue(): Additional events were enqueued while processing ' +
+      'an event queue. Support for this has not yet been implemented.'
+    ) : invariant(!eventQueue));
+  },
+
+  /**
+   * These are needed for tests only. Do not use!
+   */
+  __purge: function() {
+    listenerBank = {};
+  },
+
+  __getListenerBank: function() {
+    return listenerBank;
+  }
+
+};
+
+module.exports = EventPluginHub;
+
+},{"./EventPluginRegistry":18,"./EventPluginUtils":19,"./ExecutionEnvironment":21,"./accumulate":98,"./forEachAccumulated":114,"./invariant":125,"./isEventSupported":126,"./monitorCodeUse":138}],18:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule EventPluginRegistry
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var invariant = _dereq_("./invariant");
+
+/**
+ * Injectable ordering of event plugins.
+ */
+var EventPluginOrder = null;
+
+/**
+ * Injectable mapping from names to event plugin modules.
+ */
+var namesToPlugins = {};
+
+/**
+ * Recomputes the plugin list using the injected plugins and plugin ordering.
+ *
+ * @private
+ */
+function recomputePluginOrdering() {
+  if (!EventPluginOrder) {
+    // Wait until an `EventPluginOrder` is injected.
+    return;
+  }
+  for (var pluginName in namesToPlugins) {
+    var PluginModule = namesToPlugins[pluginName];
+    var pluginIndex = EventPluginOrder.indexOf(pluginName);
+    ("production" !== "development" ? invariant(
+      pluginIndex > -1,
+      'EventPluginRegistry: Cannot inject event plugins that do not exist in ' +
+      'the plugin ordering, `%s`.',
+      pluginName
+    ) : invariant(pluginIndex > -1));
+    if (EventPluginRegistry.plugins[pluginIndex]) {
+      continue;
+    }
+    ("production" !== "development" ? invariant(
+      PluginModule.extractEvents,
+      'EventPluginRegistry: Event plugins must implement an `extractEvents` ' +
+      'method, but `%s` does not.',
+      pluginName
+    ) : invariant(PluginModule.extractEvents));
+    EventPluginRegistry.plugins[pluginIndex] = PluginModule;
+    var publishedEvents = PluginModule.eventTypes;
+    for (var eventName in publishedEvents) {
+      ("production" !== "development" ? invariant(
+        publishEventForPlugin(
+          publishedEvents[eventName],
+          PluginModule,
+          eventName
+        ),
+        'EventPluginRegistry: Failed to publish event `%s` for plugin `%s`.',
+        eventName,
+        pluginName
+      ) : invariant(publishEventForPlugin(
+        publishedEvents[eventName],
+        PluginModule,
+        eventName
+      )));
+    }
+  }
+}
+
+/**
+ * Publishes an event so that it can be dispatched by the supplied plugin.
+ *
+ * @param {object} dispatchConfig Dispatch configuration for the event.
+ * @param {object} PluginModule Plugin publishing the event.
+ * @return {boolean} True if the event was successfully published.
+ * @private
+ */
+function publishEventForPlugin(dispatchConfig, PluginModule, eventName) {
+  ("production" !== "development" ? invariant(
+    !EventPluginRegistry.eventNameDispatchConfigs[eventName],
+    'EventPluginHub: More than one plugin attempted to publish the same ' +
+    'event name, `%s`.',
+    eventName
+  ) : invariant(!EventPluginRegistry.eventNameDispatchConfigs[eventName]));
+  EventPluginRegistry.eventNameDispatchConfigs[eventName] = dispatchConfig;
+
+  var phasedRegistrationNames = dispatchConfig.phasedRegistrationNames;
+  if (phasedRegistrationNames) {
+    for (var phaseName in phasedRegistrationNames) {
+      if (phasedRegistrationNames.hasOwnProperty(phaseName)) {
+        var phasedRegistrationName = phasedRegistrationNames[phaseName];
+        publishRegistrationName(
+          phasedRegistrationName,
+          PluginModule,
+          eventName
+        );
+      }
+    }
+    return true;
+  } else if (dispatchConfig.registrationName) {
+    publishRegistrationName(
+      dispatchConfig.registrationName,
+      PluginModule,
+      eventName
+    );
+    return true;
+  }
+  return false;
+}
+
+/**
+ * Publishes a registration name that is used to identify dispatched events and
+ * can be used with `EventPluginHub.putListener` to register listeners.
+ *
+ * @param {string} registrationName Registration name to add.
+ * @param {object} PluginModule Plugin publishing the event.
+ * @private
+ */
+function publishRegistrationName(registrationName, PluginModule, eventName) {
+  ("production" !== "development" ? invariant(
+    !EventPluginRegistry.registrationNameModules[registrationName],
+    'EventPluginHub: More than one plugin attempted to publish the same ' +
+    'registration name, `%s`.',
+    registrationName
+  ) : invariant(!EventPluginRegistry.registrationNameModules[registrationName]));
+  EventPluginRegistry.registrationNameModules[registrationName] = PluginModule;
+  EventPluginRegistry.registrationNameDependencies[registrationName] =
+    PluginModule.eventTypes[eventName].dependencies;
+}
+
+/**
+ * Registers plugins so that they can extract and dispatch events.
+ *
+ * @see {EventPluginHub}
+ */
+var EventPluginRegistry = {
+
+  /**
+   * Ordered list of injected plugins.
+   */
+  plugins: [],
+
+  /**
+   * Mapping from event name to dispatch config
+   */
+  eventNameDispatchConfigs: {},
+
+  /**
+   * Mapping from registration name to plugin module
+   */
+  registrationNameModules: {},
+
+  /**
+   * Mapping from registration name to event name
+   */
+  registrationNameDependencies: {},
+
+  /**
+   * Injects an ordering of plugins (by plugin name). This allows the ordering
+   * to be decoupled from injection of the actual plugins so that ordering is
+   * always deterministic regardless of packaging, on-the-fly injection, etc.
+   *
+   * @param {array} InjectedEventPluginOrder
+   * @internal
+   * @see {EventPluginHub.injection.injectEventPluginOrder}
+   */
+  injectEventPluginOrder: function(InjectedEventPluginOrder) {
+    ("production" !== "development" ? invariant(
+      !EventPluginOrder,
+      'EventPluginRegistry: Cannot inject event plugin ordering more than once.'
+    ) : invariant(!EventPluginOrder));
+    // Clone the ordering so it cannot be dynamically mutated.
+    EventPluginOrder = Array.prototype.slice.call(InjectedEventPluginOrder);
+    recomputePluginOrdering();
+  },
+
+  /**
+   * Injects plugins to be used by `EventPluginHub`. The plugin names must be
+   * in the ordering injected by `injectEventPluginOrder`.
+   *
+   * Plugins can be injected as part of page initialization or on-the-fly.
+   *
+   * @param {object} injectedNamesToPlugins Map from names to plugin modules.
+   * @internal
+   * @see {EventPluginHub.injection.injectEventPluginsByName}
+   */
+  injectEventPluginsByName: function(injectedNamesToPlugins) {
+    var isOrderingDirty = false;
+    for (var pluginName in injectedNamesToPlugins) {
+      if (!injectedNamesToPlugins.hasOwnProperty(pluginName)) {
+        continue;
+      }
+      var PluginModule = injectedNamesToPlugins[pluginName];
+      if (namesToPlugins[pluginName] !== PluginModule) {
+        ("production" !== "development" ? invariant(
+          !namesToPlugins[pluginName],
+          'EventPluginRegistry: Cannot inject two different event plugins ' +
+          'using the same name, `%s`.',
+          pluginName
+        ) : invariant(!namesToPlugins[pluginName]));
+        namesToPlugins[pluginName] = PluginModule;
+        isOrderingDirty = true;
+      }
+    }
+    if (isOrderingDirty) {
+      recomputePluginOrdering();
+    }
+  },
+
+  /**
+   * Looks up the plugin for the supplied event.
+   *
+   * @param {object} event A synthetic event.
+   * @return {?object} The plugin that created the supplied event.
+   * @internal
+   */
+  getPluginModuleForEvent: function(event) {
+    var dispatchConfig = event.dispatchConfig;
+    if (dispatchConfig.registrationName) {
+      return EventPluginRegistry.registrationNameModules[
+        dispatchConfig.registrationName
+      ] || null;
+    }
+    for (var phase in dispatchConfig.phasedRegistrationNames) {
+      if (!dispatchConfig.phasedRegistrationNames.hasOwnProperty(phase)) {
+        continue;
+      }
+      var PluginModule = EventPluginRegistry.registrationNameModules[
+        dispatchConfig.phasedRegistrationNames[phase]
+      ];
+      if (PluginModule) {
+        return PluginModule;
+      }
+    }
+    return null;
+  },
+
+  /**
+   * Exposed for unit testing.
+   * @private
+   */
+  _resetEventPlugins: function() {
+    EventPluginOrder = null;
+    for (var pluginName in namesToPlugins) {
+      if (namesToPlugins.hasOwnProperty(pluginName)) {
+        delete namesToPlugins[pluginName];
+      }
+    }
+    EventPluginRegistry.plugins.length = 0;
+
+    var eventNameDispatchConfigs = EventPluginRegistry.eventNameDispatchConfigs;
+    for (var eventName in eventNameDispatchConfigs) {
+      if (eventNameDispatchConfigs.hasOwnProperty(eventName)) {
+        delete eventNameDispatchConfigs[eventName];
+      }
+    }
+
+    var registrationNameModules = EventPluginRegistry.registrationNameModules;
+    for (var registrationName in registrationNameModules) {
+      if (registrationNameModules.hasOwnProperty(registrationName)) {
+        delete registrationNameModules[registrationName];
+      }
+    }
+  }
+
+};
+
+module.exports = EventPluginRegistry;
+
+},{"./invariant":125}],19:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule EventPluginUtils
+ */
+
+"use strict";
+
+var EventConstants = _dereq_("./EventConstants");
+
+var invariant = _dereq_("./invariant");
+
+/**
+ * Injected dependencies:
+ */
+
+/**
+ * - `Mount`: [required] Module that can convert between React dom IDs and
+ *   actual node references.
+ */
+var injection = {
+  Mount: null,
+  injectMount: function(InjectedMount) {
+    injection.Mount = InjectedMount;
+    if ("production" !== "development") {
+      ("production" !== "development" ? invariant(
+        InjectedMount && InjectedMount.getNode,
+        'EventPluginUtils.injection.injectMount(...): Injected Mount module ' +
+        'is missing getNode.'
+      ) : invariant(InjectedMount && InjectedMount.getNode));
+    }
+  }
+};
+
+var topLevelTypes = EventConstants.topLevelTypes;
+
+function isEndish(topLevelType) {
+  return topLevelType === topLevelTypes.topMouseUp ||
+         topLevelType === topLevelTypes.topTouchEnd ||
+         topLevelType === topLevelTypes.topTouchCancel;
+}
+
+function isMoveish(topLevelType) {
+  return topLevelType === topLevelTypes.topMouseMove ||
+         topLevelType === topLevelTypes.topTouchMove;
+}
+function isStartish(topLevelType) {
+  return topLevelType === topLevelTypes.topMouseDown ||
+         topLevelType === topLevelTypes.topTouchStart;
+}
+
+
+var validateEventDispatches;
+if ("production" !== "development") {
+  validateEventDispatches = function(event) {
+    var dispatchListeners = event._dispatchListeners;
+    var dispatchIDs = event._dispatchIDs;
+
+    var listenersIsArr = Array.isArray(dispatchListeners);
+    var idsIsArr = Array.isArray(dispatchIDs);
+    var IDsLen = idsIsArr ? dispatchIDs.length : dispatchIDs ? 1 : 0;
+    var listenersLen = listenersIsArr ?
+      dispatchListeners.length :
+      dispatchListeners ? 1 : 0;
+
+    ("production" !== "development" ? invariant(
+      idsIsArr === listenersIsArr && IDsLen === listenersLen,
+      'EventPluginUtils: Invalid `event`.'
+    ) : invariant(idsIsArr === listenersIsArr && IDsLen === listenersLen));
+  };
+}
+
+/**
+ * Invokes `cb(event, listener, id)`. Avoids using call if no scope is
+ * provided. The `(listener,id)` pair effectively forms the "dispatch" but are
+ * kept separate to conserve memory.
+ */
+function forEachEventDispatch(event, cb) {
+  var dispatchListeners = event._dispatchListeners;
+  var dispatchIDs = event._dispatchIDs;
+  if ("production" !== "development") {
+    validateEventDispatches(event);
+  }
+  if (Array.isArray(dispatchListeners)) {
+    for (var i = 0; i < dispatchListeners.length; i++) {
+      if (event.isPropagationStopped()) {
+        break;
+      }
+      // Listeners and IDs are two parallel arrays that are always in sync.
+      cb(event, dispatchListeners[i], dispatchIDs[i]);
+    }
+  } else if (dispatchListeners) {
+    cb(event, dispatchListeners, dispatchIDs);
+  }
+}
+
+/**
+ * Default implementation of PluginModule.executeDispatch().
+ * @param {SyntheticEvent} SyntheticEvent to handle
+ * @param {function} Application-level callback
+ * @param {string} domID DOM id to pass to the callback.
+ */
+function executeDispatch(event, listener, domID) {
+  event.currentTarget = injection.Mount.getNode(domID);
+  var returnValue = listener(event, domID);
+  event.currentTarget = null;
+  return returnValue;
+}
+
+/**
+ * Standard/simple iteration through an event's collected dispatches.
+ */
+function executeDispatchesInOrder(event, executeDispatch) {
+  forEachEventDispatch(event, executeDispatch);
+  event._dispatchListeners = null;
+  event._dispatchIDs = null;
+}
+
+/**
+ * Standard/simple iteration through an event's collected dispatches, but stops
+ * at the first dispatch execution returning true, and returns that id.
+ *
+ * @return id of the first dispatch execution who's listener returns true, or
+ * null if no listener returned true.
+ */
+function executeDispatchesInOrderStopAtTrue(event) {
+  var dispatchListeners = event._dispatchListeners;
+  var dispatchIDs = event._dispatchIDs;
+  if ("production" !== "development") {
+    validateEventDispatches(event);
+  }
+  if (Array.isArray(dispatchListeners)) {
+    for (var i = 0; i < dispatchListeners.length; i++) {
+      if (event.isPropagationStopped()) {
+        break;
+      }
+      // Listeners and IDs are two parallel arrays that are always in sync.
+      if (dispatchListeners[i](event, dispatchIDs[i])) {
+        return dispatchIDs[i];
+      }
+    }
+  } else if (dispatchListeners) {
+    if (dispatchListeners(event, dispatchIDs)) {
+      return dispatchIDs;
+    }
+  }
+  return null;
+}
+
+/**
+ * Execution of a "direct" dispatch - there must be at most one dispatch
+ * accumulated on the event or it is considered an error. It doesn't really make
+ * sense for an event with multiple dispatches (bubbled) to keep track of the
+ * return values at each dispatch execution, but it does tend to make sense when
+ * dealing with "direct" dispatches.
+ *
+ * @return The return value of executing the single dispatch.
+ */
+function executeDirectDispatch(event) {
+  if ("production" !== "development") {
+    validateEventDispatches(event);
+  }
+  var dispatchListener = event._dispatchListeners;
+  var dispatchID = event._dispatchIDs;
+  ("production" !== "development" ? invariant(
+    !Array.isArray(dispatchListener),
+    'executeDirectDispatch(...): Invalid `event`.'
+  ) : invariant(!Array.isArray(dispatchListener)));
+  var res = dispatchListener ?
+    dispatchListener(event, dispatchID) :
+    null;
+  event._dispatchListeners = null;
+  event._dispatchIDs = null;
+  return res;
+}
+
+/**
+ * @param {SyntheticEvent} event
+ * @return {bool} True iff number of dispatches accumulated is greater than 0.
+ */
+function hasDispatches(event) {
+  return !!event._dispatchListeners;
+}
+
+/**
+ * General utilities that are useful in creating custom Event Plugins.
+ */
+var EventPluginUtils = {
+  isEndish: isEndish,
+  isMoveish: isMoveish,
+  isStartish: isStartish,
+
+  executeDirectDispatch: executeDirectDispatch,
+  executeDispatch: executeDispatch,
+  executeDispatchesInOrder: executeDispatchesInOrder,
+  executeDispatchesInOrderStopAtTrue: executeDispatchesInOrderStopAtTrue,
+  hasDispatches: hasDispatches,
+  injection: injection,
+  useTouchEvents: false
+};
+
+module.exports = EventPluginUtils;
+
+},{"./EventConstants":15,"./invariant":125}],20:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule EventPropagators
+ */
+
+"use strict";
+
+var EventConstants = _dereq_("./EventConstants");
+var EventPluginHub = _dereq_("./EventPluginHub");
+
+var accumulate = _dereq_("./accumulate");
+var forEachAccumulated = _dereq_("./forEachAccumulated");
+
+var PropagationPhases = EventConstants.PropagationPhases;
+var getListener = EventPluginHub.getListener;
+
+/**
+ * Some event types have a notion of different registration names for different
+ * "phases" of propagation. This finds listeners by a given phase.
+ */
+function listenerAtPhase(id, event, propagationPhase) {
+  var registrationName =
+    event.dispatchConfig.phasedRegistrationNames[propagationPhase];
+  return getListener(id, registrationName);
+}
+
+/**
+ * Tags a `SyntheticEvent` with dispatched listeners. Creating this function
+ * here, allows us to not have to bind or create functions for each event.
+ * Mutating the event's members allows us to not have to create a wrapping
+ * "dispatch" object that pairs the event with the listener.
+ */
+function accumulateDirectionalDispatches(domID, upwards, event) {
+  if ("production" !== "development") {
+    if (!domID) {
+      throw new Error('Dispatching id must not be null');
+    }
+  }
+  var phase = upwards ? PropagationPhases.bubbled : PropagationPhases.captured;
+  var listener = listenerAtPhase(domID, event, phase);
+  if (listener) {
+    event._dispatchListeners = accumulate(event._dispatchListeners, listener);
+    event._dispatchIDs = accumulate(event._dispatchIDs, domID);
+  }
+}
+
+/**
+ * Collect dispatches (must be entirely collected before dispatching - see unit
+ * tests). Lazily allocate the array to conserve memory.  We must loop through
+ * each event and perform the traversal for each one. We can not perform a
+ * single traversal for the entire collection of events because each event may
+ * have a different target.
+ */
+function accumulateTwoPhaseDispatchesSingle(event) {
+  if (event && event.dispatchConfig.phasedRegistrationNames) {
+    EventPluginHub.injection.getInstanceHandle().traverseTwoPhase(
+      event.dispatchMarker,
+      accumulateDirectionalDispatches,
+      event
+    );
+  }
+}
+
+
+/**
+ * Accumulates without regard to direction, does not look for phased
+ * registration names. Same as `accumulateDirectDispatchesSingle` but without
+ * requiring that the `dispatchMarker` be the same as the dispatched ID.
+ */
+function accumulateDispatches(id, ignoredDirection, event) {
+  if (event && event.dispatchConfig.registrationName) {
+    var registrationName = event.dispatchConfig.registrationName;
+    var listener = getListener(id, registrationName);
+    if (listener) {
+      event._dispatchListeners = accumulate(event._dispatchListeners, listener);
+      event._dispatchIDs = accumulate(event._dispatchIDs, id);
+    }
+  }
+}
+
+/**
+ * Accumulates dispatches on an `SyntheticEvent`, but only for the
+ * `dispatchMarker`.
+ * @param {SyntheticEvent} event
+ */
+function accumulateDirectDispatchesSingle(event) {
+  if (event && event.dispatchConfig.registrationName) {
+    accumulateDispatches(event.dispatchMarker, null, event);
+  }
+}
+
+function accumulateTwoPhaseDispatches(events) {
+  forEachAccumulated(events, accumulateTwoPhaseDispatchesSingle);
+}
+
+function accumulateEnterLeaveDispatches(leave, enter, fromID, toID) {
+  EventPluginHub.injection.getInstanceHandle().traverseEnterLeave(
+    fromID,
+    toID,
+    accumulateDispatches,
+    leave,
+    enter
+  );
+}
+
+
+function accumulateDirectDispatches(events) {
+  forEachAccumulated(events, accumulateDirectDispatchesSingle);
+}
+
+
+
+/**
+ * A small set of propagation patterns, each of which will accept a small amount
+ * of information, and generate a set of "dispatch ready event objects" - which
+ * are sets of events that have already been annotated with a set of dispatched
+ * listener functions/ids. The API is designed this way to discourage these
+ * propagation strategies from actually executing the dispatches, since we
+ * always want to collect the entire set of dispatches before executing event a
+ * single one.
+ *
+ * @constructor EventPropagators
+ */
+var EventPropagators = {
+  accumulateTwoPhaseDispatches: accumulateTwoPhaseDispatches,
+  accumulateDirectDispatches: accumulateDirectDispatches,
+  accumulateEnterLeaveDispatches: accumulateEnterLeaveDispatches
+};
+
+module.exports = EventPropagators;
+
+},{"./EventConstants":15,"./EventPluginHub":17,"./accumulate":98,"./forEachAccumulated":114}],21:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ExecutionEnvironment
+ */
+
+/*jslint evil: true */
+
+"use strict";
+
+var canUseDOM = typeof window !== 'undefined';
+
+/**
+ * Simple, lightweight module assisting with the detection and context of
+ * Worker. Helps avoid circular dependencies and allows code to reason about
+ * whether or not they are in a Worker, even if they never include the main
+ * `ReactWorker` dependency.
+ */
+var ExecutionEnvironment = {
+
+  canUseDOM: canUseDOM,
+
+  canUseWorkers: typeof Worker !== 'undefined',
+
+  canUseEventListeners:
+    canUseDOM && (window.addEventListener || window.attachEvent),
+
+  isInWorker: !canUseDOM // For now, this is true - might change in the future.
+
+};
+
+module.exports = ExecutionEnvironment;
+
+},{}],22:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule LinkedStateMixin
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var ReactLink = _dereq_("./ReactLink");
+var ReactStateSetters = _dereq_("./ReactStateSetters");
+
+/**
+ * A simple mixin around ReactLink.forState().
+ */
+var LinkedStateMixin = {
+  /**
+   * Create a ReactLink that's linked to part of this component's state. The
+   * ReactLink will have the current value of this.state[key] and will call
+   * setState() when a change is requested.
+   *
+   * @param {string} key state key to update. Note: you may want to use keyOf()
+   * if you're using Google Closure Compiler advanced mode.
+   * @return {ReactLink} ReactLink instance linking to the state.
+   */
+  linkState: function(key) {
+    return new ReactLink(
+      this.state[key],
+      ReactStateSetters.createStateKeySetter(this, key)
+    );
+  }
+};
+
+module.exports = LinkedStateMixin;
+
+},{"./ReactLink":58,"./ReactStateSetters":75}],23:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule LinkedValueUtils
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var ReactPropTypes = _dereq_("./ReactPropTypes");
+
+var invariant = _dereq_("./invariant");
+var warning = _dereq_("./warning");
+
+var hasReadOnlyValue = {
+  'button': true,
+  'checkbox': true,
+  'image': true,
+  'hidden': true,
+  'radio': true,
+  'reset': true,
+  'submit': true
+};
+
+function _assertSingleLink(input) {
+  ("production" !== "development" ? invariant(
+      input.props.checkedLink == null || input.props.valueLink == null,
+      'Cannot provide a checkedLink and a valueLink. If you want to use ' +
+      'checkedLink, you probably don\'t want to use valueLink and vice versa.'
+  ) : invariant(input.props.checkedLink == null || input.props.valueLink == null));
+}
+function _assertValueLink(input) {
+  _assertSingleLink(input);
+  ("production" !== "development" ? invariant(
+    input.props.value == null && input.props.onChange == null,
+    'Cannot provide a valueLink and a value or onChange event. If you want ' +
+    'to use value or onChange, you probably don\'t want to use valueLink.'
+  ) : invariant(input.props.value == null && input.props.onChange == null));
+}
+
+function _assertCheckedLink(input) {
+  _assertSingleLink(input);
+  ("production" !== "development" ? invariant(
+    input.props.checked == null && input.props.onChange == null,
+    'Cannot provide a checkedLink and a checked property or onChange event. ' +
+    'If you want to use checked or onChange, you probably don\'t want to ' +
+    'use checkedLink'
+  ) : invariant(input.props.checked == null && input.props.onChange == null));
+}
+
+/**
+ * @param {SyntheticEvent} e change event to handle
+ */
+function _handleLinkedValueChange(e) {
+  /*jshint validthis:true */
+  this.props.valueLink.requestChange(e.target.value);
+}
+
+/**
+  * @param {SyntheticEvent} e change event to handle
+  */
+function _handleLinkedCheckChange(e) {
+  /*jshint validthis:true */
+  this.props.checkedLink.requestChange(e.target.checked);
+}
+
+/**
+ * Provide a linked `value` attribute for controlled forms. You should not use
+ * this outside of the ReactDOM controlled form components.
+ */
+var LinkedValueUtils = {
+  Mixin: {
+    propTypes: {
+      value: function(props, propName, componentName) {
+        if ("production" !== "development") {
+          ("production" !== "development" ? warning(
+            !props[propName] ||
+            hasReadOnlyValue[props.type] ||
+            props.onChange ||
+            props.readOnly ||
+            props.disabled,
+            'You provided a `value` prop to a form field without an ' +
+            '`onChange` handler. This will render a read-only field. If ' +
+            'the field should be mutable use `defaultValue`. Otherwise, ' +
+            'set either `onChange` or `readOnly`.'
+          ) : null);
+        }
+      },
+      checked: function(props, propName, componentName) {
+        if ("production" !== "development") {
+          ("production" !== "development" ? warning(
+            !props[propName] ||
+            props.onChange ||
+            props.readOnly ||
+            props.disabled,
+            'You provided a `checked` prop to a form field without an ' +
+            '`onChange` handler. This will render a read-only field. If ' +
+            'the field should be mutable use `defaultChecked`. Otherwise, ' +
+            'set either `onChange` or `readOnly`.'
+          ) : null);
+        }
+      },
+      onChange: ReactPropTypes.func
+    }
+  },
+
+  /**
+   * @param {ReactComponent} input Form component
+   * @return {*} current value of the input either from value prop or link.
+   */
+  getValue: function(input) {
+    if (input.props.valueLink) {
+      _assertValueLink(input);
+      return input.props.valueLink.value;
+    }
+    return input.props.value;
+  },
+
+  /**
+   * @param {ReactComponent} input Form component
+   * @return {*} current checked status of the input either from checked prop
+   *             or link.
+   */
+  getChecked: function(input) {
+    if (input.props.checkedLink) {
+      _assertCheckedLink(input);
+      return input.props.checkedLink.value;
+    }
+    return input.props.checked;
+  },
+
+  /**
+   * @param {ReactComponent} input Form component
+   * @return {function} change callback either from onChange prop or link.
+   */
+  getOnChange: function(input) {
+    if (input.props.valueLink) {
+      _assertValueLink(input);
+      return _handleLinkedValueChange;
+    } else if (input.props.checkedLink) {
+      _assertCheckedLink(input);
+      return _handleLinkedCheckChange;
+    }
+    return input.props.onChange;
+  }
+};
+
+module.exports = LinkedValueUtils;
+
+},{"./ReactPropTypes":69,"./invariant":125,"./warning":148}],24:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule MobileSafariClickEventPlugin
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var EventConstants = _dereq_("./EventConstants");
+
+var emptyFunction = _dereq_("./emptyFunction");
+
+var topLevelTypes = EventConstants.topLevelTypes;
+
+/**
+ * Mobile Safari does not fire properly bubble click events on non-interactive
+ * elements, which means delegated click listeners do not fire. The workaround
+ * for this bug involves attaching an empty click listener on the target node.
+ *
+ * This particular plugin works around the bug by attaching an empty click
+ * listener on `touchstart` (which does fire on every element).
+ */
+var MobileSafariClickEventPlugin = {
+
+  eventTypes: null,
+
+  /**
+   * @param {string} topLevelType Record from `EventConstants`.
+   * @param {DOMEventTarget} topLevelTarget The listening component root node.
+   * @param {string} topLevelTargetID ID of `topLevelTarget`.
+   * @param {object} nativeEvent Native browser event.
+   * @return {*} An accumulation of synthetic events.
+   * @see {EventPluginHub.extractEvents}
+   */
+  extractEvents: function(
+      topLevelType,
+      topLevelTarget,
+      topLevelTargetID,
+      nativeEvent) {
+    if (topLevelType === topLevelTypes.topTouchStart) {
+      var target = nativeEvent.target;
+      if (target && !target.onclick) {
+        target.onclick = emptyFunction;
+      }
+    }
+  }
+
+};
+
+module.exports = MobileSafariClickEventPlugin;
+
+},{"./EventConstants":15,"./emptyFunction":109}],25:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule PooledClass
+ */
+
+"use strict";
+
+var invariant = _dereq_("./invariant");
+
+/**
+ * Static poolers. Several custom versions for each potential number of
+ * arguments. A completely generic pooler is easy to implement, but would
+ * require accessing the `arguments` object. In each of these, `this` refers to
+ * the Class itself, not an instance. If any others are needed, simply add them
+ * here, or in their own files.
+ */
+var oneArgumentPooler = function(copyFieldsFrom) {
+  var Klass = this;
+  if (Klass.instancePool.length) {
+    var instance = Klass.instancePool.pop();
+    Klass.call(instance, copyFieldsFrom);
+    return instance;
+  } else {
+    return new Klass(copyFieldsFrom);
+  }
+};
+
+var twoArgumentPooler = function(a1, a2) {
+  var Klass = this;
+  if (Klass.instancePool.length) {
+    var instance = Klass.instancePool.pop();
+    Klass.call(instance, a1, a2);
+    return instance;
+  } else {
+    return new Klass(a1, a2);
+  }
+};
+
+var threeArgumentPooler = function(a1, a2, a3) {
+  var Klass = this;
+  if (Klass.instancePool.length) {
+    var instance = Klass.instancePool.pop();
+    Klass.call(instance, a1, a2, a3);
+    return instance;
+  } else {
+    return new Klass(a1, a2, a3);
+  }
+};
+
+var fiveArgumentPooler = function(a1, a2, a3, a4, a5) {
+  var Klass = this;
+  if (Klass.instancePool.length) {
+    var instance = Klass.instancePool.pop();
+    Klass.call(instance, a1, a2, a3, a4, a5);
+    return instance;
+  } else {
+    return new Klass(a1, a2, a3, a4, a5);
+  }
+};
+
+var standardReleaser = function(instance) {
+  var Klass = this;
+  ("production" !== "development" ? invariant(
+    instance instanceof Klass,
+    'Trying to release an instance into a pool of a different type.'
+  ) : invariant(instance instanceof Klass));
+  if (instance.destructor) {
+    instance.destructor();
+  }
+  if (Klass.instancePool.length < Klass.poolSize) {
+    Klass.instancePool.push(instance);
+  }
+};
+
+var DEFAULT_POOL_SIZE = 10;
+var DEFAULT_POOLER = oneArgumentPooler;
+
+/**
+ * Augments `CopyConstructor` to be a poolable class, augmenting only the class
+ * itself (statically) not adding any prototypical fields. Any CopyConstructor
+ * you give this may have a `poolSize` property, and will look for a
+ * prototypical `destructor` on instances (optional).
+ *
+ * @param {Function} CopyConstructor Constructor that can be used to reset.
+ * @param {Function} pooler Customizable pooler.
+ */
+var addPoolingTo = function(CopyConstructor, pooler) {
+  var NewKlass = CopyConstructor;
+  NewKlass.instancePool = [];
+  NewKlass.getPooled = pooler || DEFAULT_POOLER;
+  if (!NewKlass.poolSize) {
+    NewKlass.poolSize = DEFAULT_POOL_SIZE;
+  }
+  NewKlass.release = standardReleaser;
+  return NewKlass;
+};
+
+var PooledClass = {
+  addPoolingTo: addPoolingTo,
+  oneArgumentPooler: oneArgumentPooler,
+  twoArgumentPooler: twoArgumentPooler,
+  threeArgumentPooler: threeArgumentPooler,
+  fiveArgumentPooler: fiveArgumentPooler
+};
+
+module.exports = PooledClass;
+
+},{"./invariant":125}],26:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule React
+ */
+
+"use strict";
+
+var DOMPropertyOperations = _dereq_("./DOMPropertyOperations");
+var EventPluginUtils = _dereq_("./EventPluginUtils");
+var ReactChildren = _dereq_("./ReactChildren");
+var ReactComponent = _dereq_("./ReactComponent");
+var ReactCompositeComponent = _dereq_("./ReactCompositeComponent");
+var ReactContext = _dereq_("./ReactContext");
+var ReactCurrentOwner = _dereq_("./ReactCurrentOwner");
+var ReactDOM = _dereq_("./ReactDOM");
+var ReactDOMComponent = _dereq_("./ReactDOMComponent");
+var ReactDefaultInjection = _dereq_("./ReactDefaultInjection");
+var ReactInstanceHandles = _dereq_("./ReactInstanceHandles");
+var ReactMount = _dereq_("./ReactMount");
+var ReactMultiChild = _dereq_("./ReactMultiChild");
+var ReactPerf = _dereq_("./ReactPerf");
+var ReactPropTypes = _dereq_("./ReactPropTypes");
+var ReactServerRendering = _dereq_("./ReactServerRendering");
+var ReactTextComponent = _dereq_("./ReactTextComponent");
+
+var onlyChild = _dereq_("./onlyChild");
+
+ReactDefaultInjection.inject();
+
+var React = {
+  Children: {
+    map: ReactChildren.map,
+    forEach: ReactChildren.forEach,
+    only: onlyChild
+  },
+  DOM: ReactDOM,
+  PropTypes: ReactPropTypes,
+  initializeTouchEvents: function(shouldUseTouch) {
+    EventPluginUtils.useTouchEvents = shouldUseTouch;
+  },
+  createClass: ReactCompositeComponent.createClass,
+  constructAndRenderComponent: ReactMount.constructAndRenderComponent,
+  constructAndRenderComponentByID: ReactMount.constructAndRenderComponentByID,
+  renderComponent: ReactPerf.measure(
+    'React',
+    'renderComponent',
+    ReactMount.renderComponent
+  ),
+  renderComponentToString: ReactServerRendering.renderComponentToString,
+  renderComponentToStaticMarkup:
+    ReactServerRendering.renderComponentToStaticMarkup,
+  unmountComponentAtNode: ReactMount.unmountComponentAtNode,
+  isValidClass: ReactCompositeComponent.isValidClass,
+  isValidComponent: ReactComponent.isValidComponent,
+  withContext: ReactContext.withContext,
+  __internals: {
+    Component: ReactComponent,
+    CurrentOwner: ReactCurrentOwner,
+    DOMComponent: ReactDOMComponent,
+    DOMPropertyOperations: DOMPropertyOperations,
+    InstanceHandles: ReactInstanceHandles,
+    Mount: ReactMount,
+    MultiChild: ReactMultiChild,
+    TextComponent: ReactTextComponent
+  }
+};
+
+if ("production" !== "development") {
+  var ExecutionEnvironment = _dereq_("./ExecutionEnvironment");
+  if (ExecutionEnvironment.canUseDOM &&
+      window.top === window.self &&
+      navigator.userAgent.indexOf('Chrome') > -1) {
+    console.debug(
+      'Download the React DevTools for a better development experience: ' +
+      'http://fb.me/react-devtools'
+    );
+  }
+}
+
+// Version exists only in the open-source version of React, not in Facebook's
+// internal version.
+React.version = '0.10.0';
+
+module.exports = React;
+
+},{"./DOMPropertyOperations":10,"./EventPluginUtils":19,"./ExecutionEnvironment":21,"./ReactChildren":30,"./ReactComponent":31,"./ReactCompositeComponent":33,"./ReactContext":34,"./ReactCurrentOwner":35,"./ReactDOM":36,"./ReactDOMComponent":38,"./ReactDefaultInjection":48,"./ReactInstanceHandles":57,"./ReactMount":60,"./ReactMultiChild":62,"./ReactPerf":65,"./ReactPropTypes":69,"./ReactServerRendering":73,"./ReactTextComponent":77,"./onlyChild":141}],27:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactBrowserComponentMixin
+ */
+
+"use strict";
+
+var ReactMount = _dereq_("./ReactMount");
+
+var invariant = _dereq_("./invariant");
+
+var ReactBrowserComponentMixin = {
+  /**
+   * Returns the DOM node rendered by this component.
+   *
+   * @return {DOMElement} The root node of this component.
+   * @final
+   * @protected
+   */
+  getDOMNode: function() {
+    ("production" !== "development" ? invariant(
+      this.isMounted(),
+      'getDOMNode(): A component must be mounted to have a DOM node.'
+    ) : invariant(this.isMounted()));
+    return ReactMount.getNode(this._rootNodeID);
+  }
+};
+
+module.exports = ReactBrowserComponentMixin;
+
+},{"./ReactMount":60,"./invariant":125}],28:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @typechecks
+ * @providesModule ReactCSSTransitionGroup
+ */
+
+"use strict";
+
+var React = _dereq_("./React");
+
+var ReactTransitionGroup = _dereq_("./ReactTransitionGroup");
+var ReactCSSTransitionGroupChild = _dereq_("./ReactCSSTransitionGroupChild");
+
+var ReactCSSTransitionGroup = React.createClass({
+  propTypes: {
+    transitionName: React.PropTypes.string.isRequired,
+    transitionEnter: React.PropTypes.bool,
+    transitionLeave: React.PropTypes.bool
+  },
+
+  getDefaultProps: function() {
+    return {
+      transitionEnter: true,
+      transitionLeave: true
+    };
+  },
+
+  _wrapChild: function(child) {
+    // We need to provide this childFactory so that
+    // ReactCSSTransitionGroupChild can receive updates to name, enter, and
+    // leave while it is leaving.
+    return ReactCSSTransitionGroupChild(
+      {
+        name: this.props.transitionName,
+        enter: this.props.transitionEnter,
+        leave: this.props.transitionLeave
+      },
+      child
+    );
+  },
+
+  render: function() {
+    return this.transferPropsTo(
+      ReactTransitionGroup(
+        {childFactory: this._wrapChild},
+        this.props.children
+      )
+    );
+  }
+});
+
+module.exports = ReactCSSTransitionGroup;
+
+},{"./React":26,"./ReactCSSTransitionGroupChild":29,"./ReactTransitionGroup":80}],29:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @typechecks
+ * @providesModule ReactCSSTransitionGroupChild
+ */
+
+"use strict";
+
+var React = _dereq_("./React");
+
+var CSSCore = _dereq_("./CSSCore");
+var ReactTransitionEvents = _dereq_("./ReactTransitionEvents");
+
+var onlyChild = _dereq_("./onlyChild");
+
+// We don't remove the element from the DOM until we receive an animationend or
+// transitionend event. If the user screws up and forgets to add an animation
+// their node will be stuck in the DOM forever, so we detect if an animation
+// does not start and if it doesn't, we just call the end listener immediately.
+var TICK = 17;
+var NO_EVENT_TIMEOUT = 5000;
+
+var noEventListener = null;
+
+
+if ("production" !== "development") {
+  noEventListener = function() {
+    console.warn(
+      'transition(): tried to perform an animation without ' +
+      'an animationend or transitionend event after timeout (' +
+      NO_EVENT_TIMEOUT + 'ms). You should either disable this ' +
+      'transition in JS or add a CSS animation/transition.'
+    );
+  };
+}
+
+var ReactCSSTransitionGroupChild = React.createClass({
+  transition: function(animationType, finishCallback) {
+    var node = this.getDOMNode();
+    var className = this.props.name + '-' + animationType;
+    var activeClassName = className + '-active';
+    var noEventTimeout = null;
+
+    var endListener = function() {
+      if ("production" !== "development") {
+        clearTimeout(noEventTimeout);
+      }
+
+      CSSCore.removeClass(node, className);
+      CSSCore.removeClass(node, activeClassName);
+
+      ReactTransitionEvents.removeEndEventListener(node, endListener);
+
+      // Usually this optional callback is used for informing an owner of
+      // a leave animation and telling it to remove the child.
+      finishCallback && finishCallback();
+    };
+
+    ReactTransitionEvents.addEndEventListener(node, endListener);
+
+    CSSCore.addClass(node, className);
+
+    // Need to do this to actually trigger a transition.
+    this.queueClass(activeClassName);
+
+    if ("production" !== "development") {
+      noEventTimeout = setTimeout(noEventListener, NO_EVENT_TIMEOUT);
+    }
+  },
+
+  queueClass: function(className) {
+    this.classNameQueue.push(className);
+
+    if (this.props.runNextTick) {
+      this.props.runNextTick(this.flushClassNameQueue);
+      return;
+    }
+
+    if (!this.timeout) {
+      this.timeout = setTimeout(this.flushClassNameQueue, TICK);
+    }
+  },
+
+  flushClassNameQueue: function() {
+    if (this.isMounted()) {
+      this.classNameQueue.forEach(
+        CSSCore.addClass.bind(CSSCore, this.getDOMNode())
+      );
+    }
+    this.classNameQueue.length = 0;
+    this.timeout = null;
+  },
+
+  componentWillMount: function() {
+    this.classNameQueue = [];
+  },
+
+  componentWillUnmount: function() {
+    if (this.timeout) {
+      clearTimeout(this.timeout);
+    }
+  },
+
+  componentWillEnter: function(done) {
+    if (this.props.enter) {
+      this.transition('enter', done);
+    } else {
+      done();
+    }
+  },
+
+  componentWillLeave: function(done) {
+    if (this.props.leave) {
+      this.transition('leave', done);
+    } else {
+      done();
+    }
+  },
+
+  render: function() {
+    return onlyChild(this.props.children);
+  }
+});
+
+module.exports = ReactCSSTransitionGroupChild;
+
+},{"./CSSCore":2,"./React":26,"./ReactTransitionEvents":79,"./onlyChild":141}],30:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactChildren
+ */
+
+"use strict";
+
+var PooledClass = _dereq_("./PooledClass");
+
+var invariant = _dereq_("./invariant");
+var traverseAllChildren = _dereq_("./traverseAllChildren");
+
+var twoArgumentPooler = PooledClass.twoArgumentPooler;
+var threeArgumentPooler = PooledClass.threeArgumentPooler;
+
+/**
+ * PooledClass representing the bookkeeping associated with performing a child
+ * traversal. Allows avoiding binding callbacks.
+ *
+ * @constructor ForEachBookKeeping
+ * @param {!function} forEachFunction Function to perform traversal with.
+ * @param {?*} forEachContext Context to perform context with.
+ */
+function ForEachBookKeeping(forEachFunction, forEachContext) {
+  this.forEachFunction = forEachFunction;
+  this.forEachContext = forEachContext;
+}
+PooledClass.addPoolingTo(ForEachBookKeeping, twoArgumentPooler);
+
+function forEachSingleChild(traverseContext, child, name, i) {
+  var forEachBookKeeping = traverseContext;
+  forEachBookKeeping.forEachFunction.call(
+    forEachBookKeeping.forEachContext, child, i);
+}
+
+/**
+ * Iterates through children that are typically specified as `props.children`.
+ *
+ * The provided forEachFunc(child, index) will be called for each
+ * leaf child.
+ *
+ * @param {?*} children Children tree container.
+ * @param {function(*, int)} forEachFunc.
+ * @param {*} forEachContext Context for forEachContext.
+ */
+function forEachChildren(children, forEachFunc, forEachContext) {
+  if (children == null) {
+    return children;
+  }
+
+  var traverseContext =
+    ForEachBookKeeping.getPooled(forEachFunc, forEachContext);
+  traverseAllChildren(children, forEachSingleChild, traverseContext);
+  ForEachBookKeeping.release(traverseContext);
+}
+
+/**
+ * PooledClass representing the bookkeeping associated with performing a child
+ * mapping. Allows avoiding binding callbacks.
+ *
+ * @constructor MapBookKeeping
+ * @param {!*} mapResult Object containing the ordered map of results.
+ * @param {!function} mapFunction Function to perform mapping with.
+ * @param {?*} mapContext Context to perform mapping with.
+ */
+function MapBookKeeping(mapResult, mapFunction, mapContext) {
+  this.mapResult = mapResult;
+  this.mapFunction = mapFunction;
+  this.mapContext = mapContext;
+}
+PooledClass.addPoolingTo(MapBookKeeping, threeArgumentPooler);
+
+function mapSingleChildIntoContext(traverseContext, child, name, i) {
+  var mapBookKeeping = traverseContext;
+  var mapResult = mapBookKeeping.mapResult;
+  var mappedChild =
+    mapBookKeeping.mapFunction.call(mapBookKeeping.mapContext, child, i);
+  // We found a component instance
+  ("production" !== "development" ? invariant(
+    !mapResult.hasOwnProperty(name),
+    'ReactChildren.map(...): Encountered two children with the same key, ' +
+    '`%s`. Children keys must be unique.',
+    name
+  ) : invariant(!mapResult.hasOwnProperty(name)));
+  mapResult[name] = mappedChild;
+}
+
+/**
+ * Maps children that are typically specified as `props.children`.
+ *
+ * The provided mapFunction(child, key, index) will be called for each
+ * leaf child.
+ *
+ * TODO: This may likely break any calls to `ReactChildren.map` that were
+ * previously relying on the fact that we guarded against null children.
+ *
+ * @param {?*} children Children tree container.
+ * @param {function(*, int)} mapFunction.
+ * @param {*} mapContext Context for mapFunction.
+ * @return {object} Object containing the ordered map of results.
+ */
+function mapChildren(children, func, context) {
+  if (children == null) {
+    return children;
+  }
+
+  var mapResult = {};
+  var traverseContext = MapBookKeeping.getPooled(mapResult, func, context);
+  traverseAllChildren(children, mapSingleChildIntoContext, traverseContext);
+  MapBookKeeping.release(traverseContext);
+  return mapResult;
+}
+
+var ReactChildren = {
+  forEach: forEachChildren,
+  map: mapChildren
+};
+
+module.exports = ReactChildren;
+
+},{"./PooledClass":25,"./invariant":125,"./traverseAllChildren":146}],31:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactComponent
+ */
+
+"use strict";
+
+var ReactCurrentOwner = _dereq_("./ReactCurrentOwner");
+var ReactOwner = _dereq_("./ReactOwner");
+var ReactUpdates = _dereq_("./ReactUpdates");
+
+var invariant = _dereq_("./invariant");
+var keyMirror = _dereq_("./keyMirror");
+var merge = _dereq_("./merge");
+var monitorCodeUse = _dereq_("./monitorCodeUse");
+
+/**
+ * Every React component is in one of these life cycles.
+ */
+var ComponentLifeCycle = keyMirror({
+  /**
+   * Mounted components have a DOM node representation and are capable of
+   * receiving new props.
+   */
+  MOUNTED: null,
+  /**
+   * Unmounted components are inactive and cannot receive new props.
+   */
+  UNMOUNTED: null
+});
+
+/**
+ * Warn if there's no key explicitly set on dynamic arrays of children or
+ * object keys are not valid. This allows us to keep track of children between
+ * updates.
+ */
+
+var ownerHasExplicitKeyWarning = {};
+var ownerHasPropertyWarning = {};
+var ownerHasMonitoredObjectMap = {};
+
+var NUMERIC_PROPERTY_REGEX = /^\d+$/;
+
+var injected = false;
+
+/**
+ * Optionally injectable environment dependent cleanup hook. (server vs.
+ * browser etc). Example: A browser system caches DOM nodes based on component
+ * ID and must remove that cache entry when this instance is unmounted.
+ *
+ * @private
+ */
+var unmountIDFromEnvironment = null;
+
+/**
+ * The "image" of a component tree, is the platform specific (typically
+ * serialized) data that represents a tree of lower level UI building blocks.
+ * On the web, this "image" is HTML markup which describes a construction of
+ * low level `div` and `span` nodes. Other platforms may have different
+ * encoding of this "image". This must be injected.
+ *
+ * @private
+ */
+var mountImageIntoNode = null;
+
+/**
+ * Warn if the component doesn't have an explicit key assigned to it.
+ * This component is in an array. The array could grow and shrink or be
+ * reordered. All children that haven't already been validated are required to
+ * have a "key" property assigned to it.
+ *
+ * @internal
+ * @param {ReactComponent} component Component that requires a key.
+ */
+function validateExplicitKey(component) {
+  if (component.__keyValidated__ || component.props.key != null) {
+    return;
+  }
+  component.__keyValidated__ = true;
+
+  // We can't provide friendly warnings for top level components.
+  if (!ReactCurrentOwner.current) {
+    return;
+  }
+
+  // Name of the component whose render method tried to pass children.
+  var currentName = ReactCurrentOwner.current.constructor.displayName;
+  if (ownerHasExplicitKeyWarning.hasOwnProperty(currentName)) {
+    return;
+  }
+  ownerHasExplicitKeyWarning[currentName] = true;
+
+  var message = 'Each child in an array should have a unique "key" prop. ' +
+                'Check the render method of ' + currentName + '.';
+
+  var childOwnerName = null;
+  if (!component.isOwnedBy(ReactCurrentOwner.current)) {
+    // Name of the component that originally created this child.
+    childOwnerName =
+      component._owner &&
+      component._owner.constructor.displayName;
+
+    // Usually the current owner is the offender, but if it accepts
+    // children as a property, it may be the creator of the child that's
+    // responsible for assigning it a key.
+    message += ' It was passed a child from ' + childOwnerName + '.';
+  }
+
+  message += ' See http://fb.me/react-warning-keys for more information.';
+  monitorCodeUse('react_key_warning', {
+    component: currentName,
+    componentOwner: childOwnerName
+  });
+  console.warn(message);
+}
+
+/**
+ * Warn if the key is being defined as an object property but has an incorrect
+ * value.
+ *
+ * @internal
+ * @param {string} name Property name of the key.
+ * @param {ReactComponent} component Component that requires a key.
+ */
+function validatePropertyKey(name) {
+  if (NUMERIC_PROPERTY_REGEX.test(name)) {
+    // Name of the component whose render method tried to pass children.
+    var currentName = ReactCurrentOwner.current.constructor.displayName;
+    if (ownerHasPropertyWarning.hasOwnProperty(currentName)) {
+      return;
+    }
+    ownerHasPropertyWarning[currentName] = true;
+
+    monitorCodeUse('react_numeric_key_warning');
+    console.warn(
+      'Child objects should have non-numeric keys so ordering is preserved. ' +
+      'Check the render method of ' + currentName + '. ' +
+      'See http://fb.me/react-warning-keys for more information.'
+    );
+  }
+}
+
+/**
+ * Log that we're using an object map. We're considering deprecating this
+ * feature and replace it with proper Map and ImmutableMap data structures.
+ *
+ * @internal
+ */
+function monitorUseOfObjectMap() {
+  // Name of the component whose render method tried to pass children.
+  // We only use this to avoid spewing the logs. We lose additional
+  // owner stacks but hopefully one level is enough to trace the source.
+  var currentName = (ReactCurrentOwner.current &&
+                    ReactCurrentOwner.current.constructor.displayName) || '';
+  if (ownerHasMonitoredObjectMap.hasOwnProperty(currentName)) {
+    return;
+  }
+  ownerHasMonitoredObjectMap[currentName] = true;
+  monitorCodeUse('react_object_map_children');
+}
+
+/**
+ * Ensure that every component either is passed in a static location, in an
+ * array with an explicit keys property defined, or in an object literal
+ * with valid key property.
+ *
+ * @internal
+ * @param {*} component Statically passed child of any type.
+ * @return {boolean}
+ */
+function validateChildKeys(component) {
+  if (Array.isArray(component)) {
+    for (var i = 0; i < component.length; i++) {
+      var child = component[i];
+      if (ReactComponent.isValidComponent(child)) {
+        validateExplicitKey(child);
+      }
+    }
+  } else if (ReactComponent.isValidComponent(component)) {
+    // This component was passed in a valid location.
+    component.__keyValidated__ = true;
+  } else if (component && typeof component === 'object') {
+    monitorUseOfObjectMap();
+    for (var name in component) {
+      validatePropertyKey(name, component);
+    }
+  }
+}
+
+/**
+ * Components are the basic units of composition in React.
+ *
+ * Every component accepts a set of keyed input parameters known as "props" that
+ * are initialized by the constructor. Once a component is mounted, the props
+ * can be mutated using `setProps` or `replaceProps`.
+ *
+ * Every component is capable of the following operations:
+ *
+ *   `mountComponent`
+ *     Initializes the component, renders markup, and registers event listeners.
+ *
+ *   `receiveComponent`
+ *     Updates the rendered DOM nodes to match the given component.
+ *
+ *   `unmountComponent`
+ *     Releases any resources allocated by this component.
+ *
+ * Components can also be "owned" by other components. Being owned by another
+ * component means being constructed by that component. This is different from
+ * being the child of a component, which means having a DOM representation that
+ * is a child of the DOM representation of that component.
+ *
+ * @class ReactComponent
+ */
+var ReactComponent = {
+
+  injection: {
+    injectEnvironment: function(ReactComponentEnvironment) {
+      ("production" !== "development" ? invariant(
+        !injected,
+        'ReactComponent: injectEnvironment() can only be called once.'
+      ) : invariant(!injected));
+      mountImageIntoNode = ReactComponentEnvironment.mountImageIntoNode;
+      unmountIDFromEnvironment =
+        ReactComponentEnvironment.unmountIDFromEnvironment;
+      ReactComponent.BackendIDOperations =
+        ReactComponentEnvironment.BackendIDOperations;
+      ReactComponent.ReactReconcileTransaction =
+        ReactComponentEnvironment.ReactReconcileTransaction;
+      injected = true;
+    }
+  },
+
+  /**
+   * @param {?object} object
+   * @return {boolean} True if `object` is a valid component.
+   * @final
+   */
+  isValidComponent: function(object) {
+    if (!object || !object.type || !object.type.prototype) {
+      return false;
+    }
+    // This is the safer way of duck checking the type of instance this is.
+    // The object can be a generic descriptor but the type property refers to
+    // the constructor and it's prototype can be used to inspect the type that
+    // will actually get mounted.
+    var prototype = object.type.prototype;
+    return (
+      typeof prototype.mountComponentIntoNode === 'function' &&
+      typeof prototype.receiveComponent === 'function'
+    );
+  },
+
+  /**
+   * @internal
+   */
+  LifeCycle: ComponentLifeCycle,
+
+  /**
+   * Injected module that provides ability to mutate individual properties.
+   * Injected into the base class because many different subclasses need access
+   * to this.
+   *
+   * @internal
+   */
+  BackendIDOperations: null,
+
+  /**
+   * React references `ReactReconcileTransaction` using this property in order
+   * to allow dependency injection.
+   *
+   * @internal
+   */
+  ReactReconcileTransaction: null,
+
+  /**
+   * Base functionality for every ReactComponent constructor. Mixed into the
+   * `ReactComponent` prototype, but exposed statically for easy access.
+   *
+   * @lends {ReactComponent.prototype}
+   */
+  Mixin: {
+
+    /**
+     * Checks whether or not this component is mounted.
+     *
+     * @return {boolean} True if mounted, false otherwise.
+     * @final
+     * @protected
+     */
+    isMounted: function() {
+      return this._lifeCycleState === ComponentLifeCycle.MOUNTED;
+    },
+
+    /**
+     * Sets a subset of the props.
+     *
+     * @param {object} partialProps Subset of the next props.
+     * @param {?function} callback Called after props are updated.
+     * @final
+     * @public
+     */
+    setProps: function(partialProps, callback) {
+      // Merge with `_pendingProps` if it exists, otherwise with existing props.
+      this.replaceProps(
+        merge(this._pendingProps || this.props, partialProps),
+        callback
+      );
+    },
+
+    /**
+     * Replaces all of the props.
+     *
+     * @param {object} props New props.
+     * @param {?function} callback Called after props are updated.
+     * @final
+     * @public
+     */
+    replaceProps: function(props, callback) {
+      ("production" !== "development" ? invariant(
+        this.isMounted(),
+        'replaceProps(...): Can only update a mounted component.'
+      ) : invariant(this.isMounted()));
+      ("production" !== "development" ? invariant(
+        this._mountDepth === 0,
+        'replaceProps(...): You called `setProps` or `replaceProps` on a ' +
+        'component with a parent. This is an anti-pattern since props will ' +
+        'get reactively updated when rendered. Instead, change the owner\'s ' +
+        '`render` method to pass the correct value as props to the component ' +
+        'where it is created.'
+      ) : invariant(this._mountDepth === 0));
+      this._pendingProps = props;
+      ReactUpdates.enqueueUpdate(this, callback);
+    },
+
+    /**
+     * Base constructor for all React components.
+     *
+     * Subclasses that override this method should make sure to invoke
+     * `ReactComponent.Mixin.construct.call(this, ...)`.
+     *
+     * @param {?object} initialProps
+     * @param {*} children
+     * @internal
+     */
+    construct: function(initialProps, children) {
+      this.props = initialProps || {};
+      // Record the component responsible for creating this component.
+      this._owner = ReactCurrentOwner.current;
+      // All components start unmounted.
+      this._lifeCycleState = ComponentLifeCycle.UNMOUNTED;
+
+      this._pendingProps = null;
+      this._pendingCallbacks = null;
+
+      // Unlike _pendingProps and _pendingCallbacks, we won't use null to
+      // indicate that nothing is pending because it's possible for a component
+      // to have a null owner. Instead, an owner change is pending when
+      // this._owner !== this._pendingOwner.
+      this._pendingOwner = this._owner;
+
+      // Children can be more than one argument
+      var childrenLength = arguments.length - 1;
+      if (childrenLength === 1) {
+        if ("production" !== "development") {
+          validateChildKeys(children);
+        }
+        this.props.children = children;
+      } else if (childrenLength > 1) {
+        var childArray = Array(childrenLength);
+        for (var i = 0; i < childrenLength; i++) {
+          if ("production" !== "development") {
+            validateChildKeys(arguments[i + 1]);
+          }
+          childArray[i] = arguments[i + 1];
+        }
+        this.props.children = childArray;
+      }
+    },
+
+    /**
+     * Initializes the component, renders markup, and registers event listeners.
+     *
+     * NOTE: This does not insert any nodes into the DOM.
+     *
+     * Subclasses that override this method should make sure to invoke
+     * `ReactComponent.Mixin.mountComponent.call(this, ...)`.
+     *
+     * @param {string} rootID DOM ID of the root node.
+     * @param {ReactReconcileTransaction|ReactServerRenderingTransaction} transaction
+     * @param {number} mountDepth number of components in the owner hierarchy.
+     * @return {?string} Rendered markup to be inserted into the DOM.
+     * @internal
+     */
+    mountComponent: function(rootID, transaction, mountDepth) {
+      ("production" !== "development" ? invariant(
+        !this.isMounted(),
+        'mountComponent(%s, ...): Can only mount an unmounted component. ' +
+        'Make sure to avoid storing components between renders or reusing a ' +
+        'single component instance in multiple places.',
+        rootID
+      ) : invariant(!this.isMounted()));
+      var props = this.props;
+      if (props.ref != null) {
+        ReactOwner.addComponentAsRefTo(this, props.ref, this._owner);
+      }
+      this._rootNodeID = rootID;
+      this._lifeCycleState = ComponentLifeCycle.MOUNTED;
+      this._mountDepth = mountDepth;
+      // Effectively: return '';
+    },
+
+    /**
+     * Releases any resources allocated by `mountComponent`.
+     *
+     * NOTE: This does not remove any nodes from the DOM.
+     *
+     * Subclasses that override this method should make sure to invoke
+     * `ReactComponent.Mixin.unmountComponent.call(this)`.
+     *
+     * @internal
+     */
+    unmountComponent: function() {
+      ("production" !== "development" ? invariant(
+        this.isMounted(),
+        'unmountComponent(): Can only unmount a mounted component.'
+      ) : invariant(this.isMounted()));
+      var props = this.props;
+      if (props.ref != null) {
+        ReactOwner.removeComponentAsRefFrom(this, props.ref, this._owner);
+      }
+      unmountIDFromEnvironment(this._rootNodeID);
+      this._rootNodeID = null;
+      this._lifeCycleState = ComponentLifeCycle.UNMOUNTED;
+    },
+
+    /**
+     * Given a new instance of this component, updates the rendered DOM nodes
+     * as if that instance was rendered instead.
+     *
+     * Subclasses that override this method should make sure to invoke
+     * `ReactComponent.Mixin.receiveComponent.call(this, ...)`.
+     *
+     * @param {object} nextComponent Next set of properties.
+     * @param {ReactReconcileTransaction} transaction
+     * @internal
+     */
+    receiveComponent: function(nextComponent, transaction) {
+      ("production" !== "development" ? invariant(
+        this.isMounted(),
+        'receiveComponent(...): Can only update a mounted component.'
+      ) : invariant(this.isMounted()));
+      this._pendingOwner = nextComponent._owner;
+      this._pendingProps = nextComponent.props;
+      this._performUpdateIfNecessary(transaction);
+    },
+
+    /**
+     * Call `_performUpdateIfNecessary` within a new transaction.
+     *
+     * @internal
+     */
+    performUpdateIfNecessary: function() {
+      var transaction = ReactComponent.ReactReconcileTransaction.getPooled();
+      transaction.perform(this._performUpdateIfNecessary, this, transaction);
+      ReactComponent.ReactReconcileTransaction.release(transaction);
+    },
+
+    /**
+     * If `_pendingProps` is set, update the component.
+     *
+     * @param {ReactReconcileTransaction} transaction
+     * @internal
+     */
+    _performUpdateIfNecessary: function(transaction) {
+      if (this._pendingProps == null) {
+        return;
+      }
+      var prevProps = this.props;
+      var prevOwner = this._owner;
+      this.props = this._pendingProps;
+      this._owner = this._pendingOwner;
+      this._pendingProps = null;
+      this.updateComponent(transaction, prevProps, prevOwner);
+    },
+
+    /**
+     * Updates the component's currently mounted representation.
+     *
+     * @param {ReactReconcileTransaction} transaction
+     * @param {object} prevProps
+     * @internal
+     */
+    updateComponent: function(transaction, prevProps, prevOwner) {
+      var props = this.props;
+      // If either the owner or a `ref` has changed, make sure the newest owner
+      // has stored a reference to `this`, and the previous owner (if different)
+      // has forgotten the reference to `this`.
+      if (this._owner !== prevOwner || props.ref !== prevProps.ref) {
+        if (prevProps.ref != null) {
+          ReactOwner.removeComponentAsRefFrom(
+            this, prevProps.ref, prevOwner
+          );
+        }
+        // Correct, even if the owner is the same, and only the ref has changed.
+        if (props.ref != null) {
+          ReactOwner.addComponentAsRefTo(this, props.ref, this._owner);
+        }
+      }
+    },
+
+    /**
+     * Mounts this component and inserts it into the DOM.
+     *
+     * @param {string} rootID DOM ID of the root node.
+     * @param {DOMElement} container DOM element to mount into.
+     * @param {boolean} shouldReuseMarkup If true, do not insert markup
+     * @final
+     * @internal
+     * @see {ReactMount.renderComponent}
+     */
+    mountComponentIntoNode: function(rootID, container, shouldReuseMarkup) {
+      var transaction = ReactComponent.ReactReconcileTransaction.getPooled();
+      transaction.perform(
+        this._mountComponentIntoNode,
+        this,
+        rootID,
+        container,
+        transaction,
+        shouldReuseMarkup
+      );
+      ReactComponent.ReactReconcileTransaction.release(transaction);
+    },
+
+    /**
+     * @param {string} rootID DOM ID of the root node.
+     * @param {DOMElement} container DOM element to mount into.
+     * @param {ReactReconcileTransaction} transaction
+     * @param {boolean} shouldReuseMarkup If true, do not insert markup
+     * @final
+     * @private
+     */
+    _mountComponentIntoNode: function(
+        rootID,
+        container,
+        transaction,
+        shouldReuseMarkup) {
+      var markup = this.mountComponent(rootID, transaction, 0);
+      mountImageIntoNode(markup, container, shouldReuseMarkup);
+    },
+
+    /**
+     * Checks if this component is owned by the supplied `owner` component.
+     *
+     * @param {ReactComponent} owner Component to check.
+     * @return {boolean} True if `owners` owns this component.
+     * @final
+     * @internal
+     */
+    isOwnedBy: function(owner) {
+      return this._owner === owner;
+    },
+
+    /**
+     * Gets another component, that shares the same owner as this one, by ref.
+     *
+     * @param {string} ref of a sibling Component.
+     * @return {?ReactComponent} the actual sibling Component.
+     * @final
+     * @internal
+     */
+    getSiblingByRef: function(ref) {
+      var owner = this._owner;
+      if (!owner || !owner.refs) {
+        return null;
+      }
+      return owner.refs[ref];
+    }
+  }
+};
+
+module.exports = ReactComponent;
+
+},{"./ReactCurrentOwner":35,"./ReactOwner":64,"./ReactUpdates":81,"./invariant":125,"./keyMirror":131,"./merge":134,"./monitorCodeUse":138}],32:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactComponentBrowserEnvironment
+ */
+
+/*jslint evil: true */
+
+"use strict";
+
+var ReactDOMIDOperations = _dereq_("./ReactDOMIDOperations");
+var ReactMarkupChecksum = _dereq_("./ReactMarkupChecksum");
+var ReactMount = _dereq_("./ReactMount");
+var ReactPerf = _dereq_("./ReactPerf");
+var ReactReconcileTransaction = _dereq_("./ReactReconcileTransaction");
+
+var getReactRootElementInContainer = _dereq_("./getReactRootElementInContainer");
+var invariant = _dereq_("./invariant");
+
+
+var ELEMENT_NODE_TYPE = 1;
+var DOC_NODE_TYPE = 9;
+
+
+/**
+ * Abstracts away all functionality of `ReactComponent` requires knowledge of
+ * the browser context.
+ */
+var ReactComponentBrowserEnvironment = {
+  ReactReconcileTransaction: ReactReconcileTransaction,
+
+  BackendIDOperations: ReactDOMIDOperations,
+
+  /**
+   * If a particular environment requires that some resources be cleaned up,
+   * specify this in the injected Mixin. In the DOM, we would likely want to
+   * purge any cached node ID lookups.
+   *
+   * @private
+   */
+  unmountIDFromEnvironment: function(rootNodeID) {
+    ReactMount.purgeID(rootNodeID);
+  },
+
+  /**
+   * @param {string} markup Markup string to place into the DOM Element.
+   * @param {DOMElement} container DOM Element to insert markup into.
+   * @param {boolean} shouldReuseMarkup Should reuse the existing markup in the
+   * container if possible.
+   */
+  mountImageIntoNode: ReactPerf.measure(
+    'ReactComponentBrowserEnvironment',
+    'mountImageIntoNode',
+    function(markup, container, shouldReuseMarkup) {
+      ("production" !== "development" ? invariant(
+        container && (
+          container.nodeType === ELEMENT_NODE_TYPE ||
+            container.nodeType === DOC_NODE_TYPE
+        ),
+        'mountComponentIntoNode(...): Target container is not valid.'
+      ) : invariant(container && (
+        container.nodeType === ELEMENT_NODE_TYPE ||
+          container.nodeType === DOC_NODE_TYPE
+      )));
+
+      if (shouldReuseMarkup) {
+        if (ReactMarkupChecksum.canReuseMarkup(
+          markup,
+          getReactRootElementInContainer(container))) {
+          return;
+        } else {
+          ("production" !== "development" ? invariant(
+            container.nodeType !== DOC_NODE_TYPE,
+            'You\'re trying to render a component to the document using ' +
+            'server rendering but the checksum was invalid. This usually ' +
+            'means you rendered a different component type or props on ' +
+            'the client from the one on the server, or your render() ' +
+            'methods are impure. React cannot handle this case due to ' +
+            'cross-browser quirks by rendering at the document root. You ' +
+            'should look for environment dependent code in your components ' +
+            'and ensure the props are the same client and server side.'
+          ) : invariant(container.nodeType !== DOC_NODE_TYPE));
+
+          if ("production" !== "development") {
+            console.warn(
+              'React attempted to use reuse markup in a container but the ' +
+              'checksum was invalid. This generally means that you are ' +
+              'using server rendering and the markup generated on the ' +
+              'server was not what the client was expecting. React injected' +
+              'new markup to compensate which works but you have lost many ' +
+              'of the benefits of server rendering. Instead, figure out ' +
+              'why the markup being generated is different on the client ' +
+              'or server.'
+            );
+          }
+        }
+      }
+
+      ("production" !== "development" ? invariant(
+        container.nodeType !== DOC_NODE_TYPE,
+        'You\'re trying to render a component to the document but ' +
+          'you didn\'t use server rendering. We can\'t do this ' +
+          'without using server rendering due to cross-browser quirks. ' +
+          'See renderComponentToString() for server rendering.'
+      ) : invariant(container.nodeType !== DOC_NODE_TYPE));
+
+      container.innerHTML = markup;
+    }
+  )
+};
+
+module.exports = ReactComponentBrowserEnvironment;
+
+},{"./ReactDOMIDOperations":40,"./ReactMarkupChecksum":59,"./ReactMount":60,"./ReactPerf":65,"./ReactReconcileTransaction":71,"./getReactRootElementInContainer":120,"./invariant":125}],33:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactCompositeComponent
+ */
+
+"use strict";
+
+var ReactComponent = _dereq_("./ReactComponent");
+var ReactContext = _dereq_("./ReactContext");
+var ReactCurrentOwner = _dereq_("./ReactCurrentOwner");
+var ReactErrorUtils = _dereq_("./ReactErrorUtils");
+var ReactOwner = _dereq_("./ReactOwner");
+var ReactPerf = _dereq_("./ReactPerf");
+var ReactPropTransferer = _dereq_("./ReactPropTransferer");
+var ReactPropTypeLocations = _dereq_("./ReactPropTypeLocations");
+var ReactPropTypeLocationNames = _dereq_("./ReactPropTypeLocationNames");
+var ReactUpdates = _dereq_("./ReactUpdates");
+
+var instantiateReactComponent = _dereq_("./instantiateReactComponent");
+var invariant = _dereq_("./invariant");
+var keyMirror = _dereq_("./keyMirror");
+var merge = _dereq_("./merge");
+var mixInto = _dereq_("./mixInto");
+var monitorCodeUse = _dereq_("./monitorCodeUse");
+var objMap = _dereq_("./objMap");
+var shouldUpdateReactComponent = _dereq_("./shouldUpdateReactComponent");
+var warning = _dereq_("./warning");
+
+/**
+ * Policies that describe methods in `ReactCompositeComponentInterface`.
+ */
+var SpecPolicy = keyMirror({
+  /**
+   * These methods may be defined only once by the class specification or mixin.
+   */
+  DEFINE_ONCE: null,
+  /**
+   * These methods may be defined by both the class specification and mixins.
+   * Subsequent definitions will be chained. These methods must return void.
+   */
+  DEFINE_MANY: null,
+  /**
+   * These methods are overriding the base ReactCompositeComponent class.
+   */
+  OVERRIDE_BASE: null,
+  /**
+   * These methods are similar to DEFINE_MANY, except we assume they return
+   * objects. We try to merge the keys of the return values of all the mixed in
+   * functions. If there is a key conflict we throw.
+   */
+  DEFINE_MANY_MERGED: null
+});
+
+
+var injectedMixins = [];
+
+/**
+ * Composite components are higher-level components that compose other composite
+ * or native components.
+ *
+ * To create a new type of `ReactCompositeComponent`, pass a specification of
+ * your new class to `React.createClass`. The only requirement of your class
+ * specification is that you implement a `render` method.
+ *
+ *   var MyComponent = React.createClass({
+ *     render: function() {
+ *       return <div>Hello World</div>;
+ *     }
+ *   });
+ *
+ * The class specification supports a specific protocol of methods that have
+ * special meaning (e.g. `render`). See `ReactCompositeComponentInterface` for
+ * more the comprehensive protocol. Any other properties and methods in the
+ * class specification will available on the prototype.
+ *
+ * @interface ReactCompositeComponentInterface
+ * @internal
+ */
+var ReactCompositeComponentInterface = {
+
+  /**
+   * An array of Mixin objects to include when defining your component.
+   *
+   * @type {array}
+   * @optional
+   */
+  mixins: SpecPolicy.DEFINE_MANY,
+
+  /**
+   * An object containing properties and methods that should be defined on
+   * the component's constructor instead of its prototype (static methods).
+   *
+   * @type {object}
+   * @optional
+   */
+  statics: SpecPolicy.DEFINE_MANY,
+
+  /**
+   * Definition of prop types for this component.
+   *
+   * @type {object}
+   * @optional
+   */
+  propTypes: SpecPolicy.DEFINE_MANY,
+
+  /**
+   * Definition of context types for this component.
+   *
+   * @type {object}
+   * @optional
+   */
+  contextTypes: SpecPolicy.DEFINE_MANY,
+
+  /**
+   * Definition of context types this component sets for its children.
+   *
+   * @type {object}
+   * @optional
+   */
+  childContextTypes: SpecPolicy.DEFINE_MANY,
+
+  // ==== Definition methods ====
+
+  /**
+   * Invoked when the component is mounted. Values in the mapping will be set on
+   * `this.props` if that prop is not specified (i.e. using an `in` check).
+   *
+   * This method is invoked before `getInitialState` and therefore cannot rely
+   * on `this.state` or use `this.setState`.
+   *
+   * @return {object}
+   * @optional
+   */
+  getDefaultProps: SpecPolicy.DEFINE_MANY_MERGED,
+
+  /**
+   * Invoked once before the component is mounted. The return value will be used
+   * as the initial value of `this.state`.
+   *
+   *   getInitialState: function() {
+   *     return {
+   *       isOn: false,
+   *       fooBaz: new BazFoo()
+   *     }
+   *   }
+   *
+   * @return {object}
+   * @optional
+   */
+  getInitialState: SpecPolicy.DEFINE_MANY_MERGED,
+
+  /**
+   * @return {object}
+   * @optional
+   */
+  getChildContext: SpecPolicy.DEFINE_MANY_MERGED,
+
+  /**
+   * Uses props from `this.props` and state from `this.state` to render the
+   * structure of the component.
+   *
+   * No guarantees are made about when or how often this method is invoked, so
+   * it must not have side effects.
+   *
+   *   render: function() {
+   *     var name = this.props.name;
+   *     return <div>Hello, {name}!</div>;
+   *   }
+   *
+   * @return {ReactComponent}
+   * @nosideeffects
+   * @required
+   */
+  render: SpecPolicy.DEFINE_ONCE,
+
+
+
+  // ==== Delegate methods ====
+
+  /**
+   * Invoked when the component is initially created and about to be mounted.
+   * This may have side effects, but any external subscriptions or data created
+   * by this method must be cleaned up in `componentWillUnmount`.
+   *
+   * @optional
+   */
+  componentWillMount: SpecPolicy.DEFINE_MANY,
+
+  /**
+   * Invoked when the component has been mounted and has a DOM representation.
+   * However, there is no guarantee that the DOM node is in the document.
+   *
+   * Use this as an opportunity to operate on the DOM when the component has
+   * been mounted (initialized and rendered) for the first time.
+   *
+   * @param {DOMElement} rootNode DOM element representing the component.
+   * @optional
+   */
+  componentDidMount: SpecPolicy.DEFINE_MANY,
+
+  /**
+   * Invoked before the component receives new props.
+   *
+   * Use this as an opportunity to react to a prop transition by updating the
+   * state using `this.setState`. Current props are accessed via `this.props`.
+   *
+   *   componentWillReceiveProps: function(nextProps, nextContext) {
+   *     this.setState({
+   *       likesIncreasing: nextProps.likeCount > this.props.likeCount
+   *     });
+   *   }
+   *
+   * NOTE: There is no equivalent `componentWillReceiveState`. An incoming prop
+   * transition may cause a state change, but the opposite is not true. If you
+   * need it, you are probably looking for `componentWillUpdate`.
+   *
+   * @param {object} nextProps
+   * @optional
+   */
+  componentWillReceiveProps: SpecPolicy.DEFINE_MANY,
+
+  /**
+   * Invoked while deciding if the component should be updated as a result of
+   * receiving new props, state and/or context.
+   *
+   * Use this as an opportunity to `return false` when you're certain that the
+   * transition to the new props/state/context will not require a component
+   * update.
+   *
+   *   shouldComponentUpdate: function(nextProps, nextState, nextContext) {
+   *     return !equal(nextProps, this.props) ||
+   *       !equal(nextState, this.state) ||
+   *       !equal(nextContext, this.context);
+   *   }
+   *
+   * @param {object} nextProps
+   * @param {?object} nextState
+   * @param {?object} nextContext
+   * @return {boolean} True if the component should update.
+   * @optional
+   */
+  shouldComponentUpdate: SpecPolicy.DEFINE_ONCE,
+
+  /**
+   * Invoked when the component is about to update due to a transition from
+   * `this.props`, `this.state` and `this.context` to `nextProps`, `nextState`
+   * and `nextContext`.
+   *
+   * Use this as an opportunity to perform preparation before an update occurs.
+   *
+   * NOTE: You **cannot** use `this.setState()` in this method.
+   *
+   * @param {object} nextProps
+   * @param {?object} nextState
+   * @param {?object} nextContext
+   * @param {ReactReconcileTransaction} transaction
+   * @optional
+   */
+  componentWillUpdate: SpecPolicy.DEFINE_MANY,
+
+  /**
+   * Invoked when the component's DOM representation has been updated.
+   *
+   * Use this as an opportunity to operate on the DOM when the component has
+   * been updated.
+   *
+   * @param {object} prevProps
+   * @param {?object} prevState
+   * @param {?object} prevContext
+   * @param {DOMElement} rootNode DOM element representing the component.
+   * @optional
+   */
+  componentDidUpdate: SpecPolicy.DEFINE_MANY,
+
+  /**
+   * Invoked when the component is about to be removed from its parent and have
+   * its DOM representation destroyed.
+   *
+   * Use this as an opportunity to deallocate any external resources.
+   *
+   * NOTE: There is no `componentDidUnmount` since your component will have been
+   * destroyed by that point.
+   *
+   * @optional
+   */
+  componentWillUnmount: SpecPolicy.DEFINE_MANY,
+
+
+
+  // ==== Advanced methods ====
+
+  /**
+   * Updates the component's currently mounted DOM representation.
+   *
+   * By default, this implements React's rendering and reconciliation algorithm.
+   * Sophisticated clients may wish to override this.
+   *
+   * @param {ReactReconcileTransaction} transaction
+   * @internal
+   * @overridable
+   */
+  updateComponent: SpecPolicy.OVERRIDE_BASE
+
+};
+
+/**
+ * Mapping from class specification keys to special processing functions.
+ *
+ * Although these are declared like instance properties in the specification
+ * when defining classes using `React.createClass`, they are actually static
+ * and are accessible on the constructor instead of the prototype. Despite
+ * being static, they must be defined outside of the "statics" key under
+ * which all other static methods are defined.
+ */
+var RESERVED_SPEC_KEYS = {
+  displayName: function(ConvenienceConstructor, displayName) {
+    ConvenienceConstructor.componentConstructor.displayName = displayName;
+  },
+  mixins: function(ConvenienceConstructor, mixins) {
+    if (mixins) {
+      for (var i = 0; i < mixins.length; i++) {
+        mixSpecIntoComponent(ConvenienceConstructor, mixins[i]);
+      }
+    }
+  },
+  childContextTypes: function(ConvenienceConstructor, childContextTypes) {
+    var Constructor = ConvenienceConstructor.componentConstructor;
+    validateTypeDef(
+      Constructor,
+      childContextTypes,
+      ReactPropTypeLocations.childContext
+    );
+    Constructor.childContextTypes = merge(
+      Constructor.childContextTypes,
+      childContextTypes
+    );
+  },
+  contextTypes: function(ConvenienceConstructor, contextTypes) {
+    var Constructor = ConvenienceConstructor.componentConstructor;
+    validateTypeDef(
+      Constructor,
+      contextTypes,
+      ReactPropTypeLocations.context
+    );
+    Constructor.contextTypes = merge(Constructor.contextTypes, contextTypes);
+  },
+  propTypes: function(ConvenienceConstructor, propTypes) {
+    var Constructor = ConvenienceConstructor.componentConstructor;
+    validateTypeDef(
+      Constructor,
+      propTypes,
+      ReactPropTypeLocations.prop
+    );
+    Constructor.propTypes = merge(Constructor.propTypes, propTypes);
+  },
+  statics: function(ConvenienceConstructor, statics) {
+    mixStaticSpecIntoComponent(ConvenienceConstructor, statics);
+  }
+};
+
+function validateTypeDef(Constructor, typeDef, location) {
+  for (var propName in typeDef) {
+    if (typeDef.hasOwnProperty(propName)) {
+      ("production" !== "development" ? invariant(
+        typeof typeDef[propName] == 'function',
+        '%s: %s type `%s` is invalid; it must be a function, usually from ' +
+        'React.PropTypes.',
+        Constructor.displayName || 'ReactCompositeComponent',
+        ReactPropTypeLocationNames[location],
+        propName
+      ) : invariant(typeof typeDef[propName] == 'function'));
+    }
+  }
+}
+
+function validateMethodOverride(proto, name) {
+  var specPolicy = ReactCompositeComponentInterface[name];
+
+  // Disallow overriding of base class methods unless explicitly allowed.
+  if (ReactCompositeComponentMixin.hasOwnProperty(name)) {
+    ("production" !== "development" ? invariant(
+      specPolicy === SpecPolicy.OVERRIDE_BASE,
+      'ReactCompositeComponentInterface: You are attempting to override ' +
+      '`%s` from your class specification. Ensure that your method names ' +
+      'do not overlap with React methods.',
+      name
+    ) : invariant(specPolicy === SpecPolicy.OVERRIDE_BASE));
+  }
+
+  // Disallow defining methods more than once unless explicitly allowed.
+  if (proto.hasOwnProperty(name)) {
+    ("production" !== "development" ? invariant(
+      specPolicy === SpecPolicy.DEFINE_MANY ||
+      specPolicy === SpecPolicy.DEFINE_MANY_MERGED,
+      'ReactCompositeComponentInterface: You are attempting to define ' +
+      '`%s` on your component more than once. This conflict may be due ' +
+      'to a mixin.',
+      name
+    ) : invariant(specPolicy === SpecPolicy.DEFINE_MANY ||
+    specPolicy === SpecPolicy.DEFINE_MANY_MERGED));
+  }
+}
+
+function validateLifeCycleOnReplaceState(instance) {
+  var compositeLifeCycleState = instance._compositeLifeCycleState;
+  ("production" !== "development" ? invariant(
+    instance.isMounted() ||
+      compositeLifeCycleState === CompositeLifeCycle.MOUNTING,
+    'replaceState(...): Can only update a mounted or mounting component.'
+  ) : invariant(instance.isMounted() ||
+    compositeLifeCycleState === CompositeLifeCycle.MOUNTING));
+  ("production" !== "development" ? invariant(compositeLifeCycleState !== CompositeLifeCycle.RECEIVING_STATE,
+    'replaceState(...): Cannot update during an existing state transition ' +
+    '(such as within `render`). This could potentially cause an infinite ' +
+    'loop so it is forbidden.'
+  ) : invariant(compositeLifeCycleState !== CompositeLifeCycle.RECEIVING_STATE));
+  ("production" !== "development" ? invariant(compositeLifeCycleState !== CompositeLifeCycle.UNMOUNTING,
+    'replaceState(...): Cannot update while unmounting component. This ' +
+    'usually means you called setState() on an unmounted component.'
+  ) : invariant(compositeLifeCycleState !== CompositeLifeCycle.UNMOUNTING));
+}
+
+/**
+ * Custom version of `mixInto` which handles policy validation and reserved
+ * specification keys when building `ReactCompositeComponent` classses.
+ */
+function mixSpecIntoComponent(ConvenienceConstructor, spec) {
+  ("production" !== "development" ? invariant(
+    !isValidClass(spec),
+    'ReactCompositeComponent: You\'re attempting to ' +
+    'use a component class as a mixin. Instead, just use a regular object.'
+  ) : invariant(!isValidClass(spec)));
+  ("production" !== "development" ? invariant(
+    !ReactComponent.isValidComponent(spec),
+    'ReactCompositeComponent: You\'re attempting to ' +
+    'use a component as a mixin. Instead, just use a regular object.'
+  ) : invariant(!ReactComponent.isValidComponent(spec)));
+
+  var Constructor = ConvenienceConstructor.componentConstructor;
+  var proto = Constructor.prototype;
+  for (var name in spec) {
+    var property = spec[name];
+    if (!spec.hasOwnProperty(name)) {
+      continue;
+    }
+
+    validateMethodOverride(proto, name);
+
+    if (RESERVED_SPEC_KEYS.hasOwnProperty(name)) {
+      RESERVED_SPEC_KEYS[name](ConvenienceConstructor, property);
+    } else {
+      // Setup methods on prototype:
+      // The following member methods should not be automatically bound:
+      // 1. Expected ReactCompositeComponent methods (in the "interface").
+      // 2. Overridden methods (that were mixed in).
+      var isCompositeComponentMethod = name in ReactCompositeComponentInterface;
+      var isInherited = name in proto;
+      var markedDontBind = property && property.__reactDontBind;
+      var isFunction = typeof property === 'function';
+      var shouldAutoBind =
+        isFunction &&
+        !isCompositeComponentMethod &&
+        !isInherited &&
+        !markedDontBind;
+
+      if (shouldAutoBind) {
+        if (!proto.__reactAutoBindMap) {
+          proto.__reactAutoBindMap = {};
+        }
+        proto.__reactAutoBindMap[name] = property;
+        proto[name] = property;
+      } else {
+        if (isInherited) {
+          // For methods which are defined more than once, call the existing
+          // methods before calling the new property.
+          if (ReactCompositeComponentInterface[name] ===
+              SpecPolicy.DEFINE_MANY_MERGED) {
+            proto[name] = createMergedResultFunction(proto[name], property);
+          } else {
+            proto[name] = createChainedFunction(proto[name], property);
+          }
+        } else {
+          proto[name] = property;
+        }
+      }
+    }
+  }
+}
+
+function mixStaticSpecIntoComponent(ConvenienceConstructor, statics) {
+  if (!statics) {
+    return;
+  }
+  for (var name in statics) {
+    var property = statics[name];
+    if (!statics.hasOwnProperty(name)) {
+      return;
+    }
+
+    var isInherited = name in ConvenienceConstructor;
+    var result = property;
+    if (isInherited) {
+      var existingProperty = ConvenienceConstructor[name];
+      var existingType = typeof existingProperty;
+      var propertyType = typeof property;
+      ("production" !== "development" ? invariant(
+        existingType === 'function' && propertyType === 'function',
+        'ReactCompositeComponent: You are attempting to define ' +
+        '`%s` on your component more than once, but that is only supported ' +
+        'for functions, which are chained together. This conflict may be ' +
+        'due to a mixin.',
+        name
+      ) : invariant(existingType === 'function' && propertyType === 'function'));
+      result = createChainedFunction(existingProperty, property);
+    }
+    ConvenienceConstructor[name] = result;
+    ConvenienceConstructor.componentConstructor[name] = result;
+  }
+}
+
+/**
+ * Merge two objects, but throw if both contain the same key.
+ *
+ * @param {object} one The first object, which is mutated.
+ * @param {object} two The second object
+ * @return {object} one after it has been mutated to contain everything in two.
+ */
+function mergeObjectsWithNoDuplicateKeys(one, two) {
+  ("production" !== "development" ? invariant(
+    one && two && typeof one === 'object' && typeof two === 'object',
+    'mergeObjectsWithNoDuplicateKeys(): Cannot merge non-objects'
+  ) : invariant(one && two && typeof one === 'object' && typeof two === 'object'));
+
+  objMap(two, function(value, key) {
+    ("production" !== "development" ? invariant(
+      one[key] === undefined,
+      'mergeObjectsWithNoDuplicateKeys(): ' +
+      'Tried to merge two objects with the same key: %s',
+      key
+    ) : invariant(one[key] === undefined));
+    one[key] = value;
+  });
+  return one;
+}
+
+/**
+ * Creates a function that invokes two functions and merges their return values.
+ *
+ * @param {function} one Function to invoke first.
+ * @param {function} two Function to invoke second.
+ * @return {function} Function that invokes the two argument functions.
+ * @private
+ */
+function createMergedResultFunction(one, two) {
+  return function mergedResult() {
+    var a = one.apply(this, arguments);
+    var b = two.apply(this, arguments);
+    if (a == null) {
+      return b;
+    } else if (b == null) {
+      return a;
+    }
+    return mergeObjectsWithNoDuplicateKeys(a, b);
+  };
+}
+
+/**
+ * Creates a function that invokes two functions and ignores their return vales.
+ *
+ * @param {function} one Function to invoke first.
+ * @param {function} two Function to invoke second.
+ * @return {function} Function that invokes the two argument functions.
+ * @private
+ */
+function createChainedFunction(one, two) {
+  return function chainedFunction() {
+    one.apply(this, arguments);
+    two.apply(this, arguments);
+  };
+}
+
+if ("production" !== "development") {
+
+  var unmountedPropertyWhitelist = {
+    constructor: true,
+    construct: true,
+    isOwnedBy: true, // should be deprecated but can have code mod (internal)
+    type: true,
+    props: true,
+    // currently private but belong on the descriptor and are valid for use
+    // inside the framework:
+    __keyValidated__: true,
+    _owner: true,
+    _currentContext: true
+  };
+
+  var componentInstanceProperties = {
+    __keyValidated__: true,
+    __keySetters: true,
+    _compositeLifeCycleState: true,
+    _currentContext: true,
+    _defaultProps: true,
+    _instance: true,
+    _lifeCycleState: true,
+    _mountDepth: true,
+    _owner: true,
+    _pendingCallbacks: true,
+    _pendingContext: true,
+    _pendingForceUpdate: true,
+    _pendingOwner: true,
+    _pendingProps: true,
+    _pendingState: true,
+    _renderedComponent: true,
+    _rootNodeID: true,
+    context: true,
+    props: true,
+    refs: true,
+    state: true,
+
+    // These are known instance properties coming from other sources
+    _pendingQueries: true,
+    _queryPropListeners: true,
+    queryParams: true
+
+  };
+
+  var hasWarnedOnComponentType = {};
+
+  var warningStackCounter = 0;
+
+  var issueMembraneWarning = function(instance, key) {
+    var isWhitelisted = unmountedPropertyWhitelist.hasOwnProperty(key);
+    if (warningStackCounter > 0 || isWhitelisted) {
+      return;
+    }
+    var name = instance.constructor.displayName || 'Unknown';
+    var owner = ReactCurrentOwner.current;
+    var ownerName = (owner && owner.constructor.displayName) || 'Unknown';
+    var warningKey = key + '|' + name + '|' + ownerName;
+    if (hasWarnedOnComponentType.hasOwnProperty(warningKey)) {
+      // We have already warned for this combination. Skip it this time.
+      return;
+    }
+    hasWarnedOnComponentType[warningKey] = true;
+
+    var context = owner ? ' in ' + ownerName + '.' : ' at the top level.';
+    var staticMethodExample = '<' + name + ' />.type.' + key + '(...)';
+
+    monitorCodeUse('react_descriptor_property_access', { component: name });
+    console.warn(
+      'Invalid access to component property "' + key + '" on ' + name +
+      context + ' See http://fb.me/react-warning-descriptors .' +
+      ' Use a static method instead: ' + staticMethodExample
+    );
+  };
+
+  var wrapInMembraneFunction = function(fn, thisBinding) {
+    if (fn.__reactMembraneFunction && fn.__reactMembraneSelf === thisBinding) {
+      return fn.__reactMembraneFunction;
+    }
+    return fn.__reactMembraneFunction = function() {
+      /**
+       * By getting this function, you've already received a warning. The
+       * internals of this function will likely cause more warnings. To avoid
+       * Spamming too much we disable any warning triggered inside of this
+       * stack.
+       */
+      warningStackCounter++;
+      try {
+        // If the this binding is unchanged, we defer to the real component.
+        // This is important to keep some referential integrity in the
+        // internals. E.g. owner equality check.
+        var self = this === thisBinding ? this.__realComponentInstance : this;
+        return fn.apply(self, arguments);
+      } finally {
+        warningStackCounter--;
+      }
+    };
+  };
+
+  var defineMembraneProperty = function(membrane, prototype, key) {
+    Object.defineProperty(membrane, key, {
+
+      configurable: false,
+      enumerable: true,
+
+      get: function() {
+        if (this === membrane) {
+          // We're allowed to access the prototype directly.
+          return prototype[key];
+        }
+        issueMembraneWarning(this, key);
+
+        var realValue = this.__realComponentInstance[key];
+        // If the real value is a function, we need to provide a wrapper that
+        // disables nested warnings. The properties type and constructors are
+        // expected to the be constructors and therefore is often use with an
+        // equality check and we shouldn't try to rebind those.
+        if (typeof realValue === 'function' &&
+            key !== 'type' &&
+            key !== 'constructor') {
+          return wrapInMembraneFunction(realValue, this);
+        }
+        return realValue;
+      },
+
+      set: function(value) {
+        if (this === membrane) {
+          // We're allowed to set a value on the prototype directly.
+          prototype[key] = value;
+          return;
+        }
+        issueMembraneWarning(this, key);
+        this.__realComponentInstance[key] = value;
+      }
+
+    });
+  };
+
+  /**
+   * Creates a membrane prototype which wraps the original prototype. If any
+   * property is accessed in an unmounted state, a warning is issued.
+   *
+   * @param {object} prototype Original prototype.
+   * @return {object} The membrane prototype.
+   * @private
+   */
+  var createMountWarningMembrane = function(prototype) {
+    var membrane = {};
+    var key;
+    for (key in prototype) {
+      defineMembraneProperty(membrane, prototype, key);
+    }
+    // These are properties that goes into the instance but not the prototype.
+    // We can create the membrane on the prototype even though this will
+    // result in a faulty hasOwnProperty check it's better perf.
+    for (key in componentInstanceProperties) {
+      if (componentInstanceProperties.hasOwnProperty(key) &&
+          !(key in prototype)) {
+        defineMembraneProperty(membrane, prototype, key);
+      }
+    }
+    return membrane;
+  };
+
+  /**
+   * Creates a membrane constructor which wraps the component that gets mounted.
+   *
+   * @param {function} constructor Original constructor.
+   * @return {function} The membrane constructor.
+   * @private
+   */
+  var createDescriptorProxy = function(constructor) {
+    try {
+      var ProxyConstructor = function() {
+        this.__realComponentInstance = new constructor();
+
+        // We can only safely pass through known instance variables. Unknown
+        // expandos are not safe. Use the real mounted instance to avoid this
+        // problem if it blows something up.
+        Object.freeze(this);
+      };
+
+      ProxyConstructor.prototype = createMountWarningMembrane(
+        constructor.prototype
+      );
+
+      return ProxyConstructor;
+    } catch(x) {
+      // In IE8 define property will fail on non-DOM objects. If anything in
+      // the membrane creation fails, we'll bail out and just use the plain
+      // constructor without warnings.
+      return constructor;
+    }
+  };
+
+}
+
+/**
+ * `ReactCompositeComponent` maintains an auxiliary life cycle state in
+ * `this._compositeLifeCycleState` (which can be null).
+ *
+ * This is different from the life cycle state maintained by `ReactComponent` in
+ * `this._lifeCycleState`. The following diagram shows how the states overlap in
+ * time. There are times when the CompositeLifeCycle is null - at those times it
+ * is only meaningful to look at ComponentLifeCycle alone.
+ *
+ * Top Row: ReactComponent.ComponentLifeCycle
+ * Low Row: ReactComponent.CompositeLifeCycle
+ *
+ * +-------+------------------------------------------------------+--------+
+ * |  UN   |                    MOUNTED                           |   UN   |
+ * |MOUNTED|                                                      | MOUNTED|
+ * +-------+------------------------------------------------------+--------+
+ * |       ^--------+   +------+   +------+   +------+   +--------^        |
+ * |       |        |   |      |   |      |   |      |   |        |        |
+ * |    0--|MOUNTING|-0-|RECEIV|-0-|RECEIV|-0-|RECEIV|-0-|   UN   |--->0   |
+ * |       |        |   |PROPS |   | PROPS|   | STATE|   |MOUNTING|        |
+ * |       |        |   |      |   |      |   |      |   |        |        |
+ * |       |        |   |      |   |      |   |      |   |        |        |
+ * |       +--------+   +------+   +------+   +------+   +--------+        |
+ * |       |                                                      |        |
+ * +-------+------------------------------------------------------+--------+
+ */
+var CompositeLifeCycle = keyMirror({
+  /**
+   * Components in the process of being mounted respond to state changes
+   * differently.
+   */
+  MOUNTING: null,
+  /**
+   * Components in the process of being unmounted are guarded against state
+   * changes.
+   */
+  UNMOUNTING: null,
+  /**
+   * Components that are mounted and receiving new props respond to state
+   * changes differently.
+   */
+  RECEIVING_PROPS: null,
+  /**
+   * Components that are mounted and receiving new state are guarded against
+   * additional state changes.
+   */
+  RECEIVING_STATE: null
+});
+
+/**
+ * @lends {ReactCompositeComponent.prototype}
+ */
+var ReactCompositeComponentMixin = {
+
+  /**
+   * Base constructor for all composite component.
+   *
+   * @param {?object} initialProps
+   * @param {*} children
+   * @final
+   * @internal
+   */
+  construct: function(initialProps, children) {
+    // Children can be either an array or more than one argument
+    ReactComponent.Mixin.construct.apply(this, arguments);
+    ReactOwner.Mixin.construct.apply(this, arguments);
+
+    this.state = null;
+    this._pendingState = null;
+
+    this.context = null;
+    this._currentContext = ReactContext.current;
+    this._pendingContext = null;
+
+    // The descriptor that was used to instantiate this component. Will be
+    // set by the instantiator instead of the constructor since this
+    // constructor is currently used by both instances and descriptors.
+    this._descriptor = null;
+
+    this._compositeLifeCycleState = null;
+  },
+
+  /**
+   * Components in the intermediate state now has cyclic references. To avoid
+   * breaking JSON serialization we expose a custom JSON format.
+   * @return {object} JSON compatible representation.
+   * @internal
+   * @final
+   */
+  toJSON: function() {
+    return { type: this.type, props: this.props };
+  },
+
+  /**
+   * Checks whether or not this composite component is mounted.
+   * @return {boolean} True if mounted, false otherwise.
+   * @protected
+   * @final
+   */
+  isMounted: function() {
+    return ReactComponent.Mixin.isMounted.call(this) &&
+      this._compositeLifeCycleState !== CompositeLifeCycle.MOUNTING;
+  },
+
+  /**
+   * Initializes the component, renders markup, and registers event listeners.
+   *
+   * @param {string} rootID DOM ID of the root node.
+   * @param {ReactReconcileTransaction|ReactServerRenderingTransaction} transaction
+   * @param {number} mountDepth number of components in the owner hierarchy
+   * @return {?string} Rendered markup to be inserted into the DOM.
+   * @final
+   * @internal
+   */
+  mountComponent: ReactPerf.measure(
+    'ReactCompositeComponent',
+    'mountComponent',
+    function(rootID, transaction, mountDepth) {
+      ReactComponent.Mixin.mountComponent.call(
+        this,
+        rootID,
+        transaction,
+        mountDepth
+      );
+      this._compositeLifeCycleState = CompositeLifeCycle.MOUNTING;
+
+      this.context = this._processContext(this._currentContext);
+      this._defaultProps = this.getDefaultProps ? this.getDefaultProps() : null;
+      this.props = this._processProps(this.props);
+
+      if (this.__reactAutoBindMap) {
+        this._bindAutoBindMethods();
+      }
+
+      this.state = this.getInitialState ? this.getInitialState() : null;
+      ("production" !== "development" ? invariant(
+        typeof this.state === 'object' && !Array.isArray(this.state),
+        '%s.getInitialState(): must return an object or null',
+        this.constructor.displayName || 'ReactCompositeComponent'
+      ) : invariant(typeof this.state === 'object' && !Array.isArray(this.state)));
+
+      this._pendingState = null;
+      this._pendingForceUpdate = false;
+
+      if (this.componentWillMount) {
+        this.componentWillMount();
+        // When mounting, calls to `setState` by `componentWillMount` will set
+        // `this._pendingState` without triggering a re-render.
+        if (this._pendingState) {
+          this.state = this._pendingState;
+          this._pendingState = null;
+        }
+      }
+
+      this._renderedComponent = instantiateReactComponent(
+        this._renderValidatedComponent()
+      );
+
+      // Done with mounting, `setState` will now trigger UI changes.
+      this._compositeLifeCycleState = null;
+      var markup = this._renderedComponent.mountComponent(
+        rootID,
+        transaction,
+        mountDepth + 1
+      );
+      if (this.componentDidMount) {
+        transaction.getReactMountReady().enqueue(this, this.componentDidMount);
+      }
+      return markup;
+    }
+  ),
+
+  /**
+   * Releases any resources allocated by `mountComponent`.
+   *
+   * @final
+   * @internal
+   */
+  unmountComponent: function() {
+    this._compositeLifeCycleState = CompositeLifeCycle.UNMOUNTING;
+    if (this.componentWillUnmount) {
+      this.componentWillUnmount();
+    }
+    this._compositeLifeCycleState = null;
+
+    this._defaultProps = null;
+
+    this._renderedComponent.unmountComponent();
+    this._renderedComponent = null;
+
+    ReactComponent.Mixin.unmountComponent.call(this);
+
+    // Some existing components rely on this.props even after they've been
+    // destroyed (in event handlers).
+    // TODO: this.props = null;
+    // TODO: this.state = null;
+  },
+
+  /**
+   * Sets a subset of the state. Always use this or `replaceState` to mutate
+   * state. You should treat `this.state` as immutable.
+   *
+   * There is no guarantee that `this.state` will be immediately updated, so
+   * accessing `this.state` after calling this method may return the old value.
+   *
+   * There is no guarantee that calls to `setState` will run synchronously,
+   * as they may eventually be batched together.  You can provide an optional
+   * callback that will be executed when the call to setState is actually
+   * completed.
+   *
+   * @param {object} partialState Next partial state to be merged with state.
+   * @param {?function} callback Called after state is updated.
+   * @final
+   * @protected
+   */
+  setState: function(partialState, callback) {
+    ("production" !== "development" ? invariant(
+      typeof partialState === 'object' || partialState == null,
+      'setState(...): takes an object of state variables to update.'
+    ) : invariant(typeof partialState === 'object' || partialState == null));
+    if ("production" !== "development") {
+      ("production" !== "development" ? warning(
+        partialState != null,
+        'setState(...): You passed an undefined or null state object; ' +
+        'instead, use forceUpdate().'
+      ) : null);
+    }
+    // Merge with `_pendingState` if it exists, otherwise with existing state.
+    this.replaceState(
+      merge(this._pendingState || this.state, partialState),
+      callback
+    );
+  },
+
+  /**
+   * Replaces all of the state. Always use this or `setState` to mutate state.
+   * You should treat `this.state` as immutable.
+   *
+   * There is no guarantee that `this.state` will be immediately updated, so
+   * accessing `this.state` after calling this method may return the old value.
+   *
+   * @param {object} completeState Next state.
+   * @param {?function} callback Called after state is updated.
+   * @final
+   * @protected
+   */
+  replaceState: function(completeState, callback) {
+    validateLifeCycleOnReplaceState(this);
+    this._pendingState = completeState;
+    ReactUpdates.enqueueUpdate(this, callback);
+  },
+
+  /**
+   * Filters the context object to only contain keys specified in
+   * `contextTypes`, and asserts that they are valid.
+   *
+   * @param {object} context
+   * @return {?object}
+   * @private
+   */
+  _processContext: function(context) {
+    var maskedContext = null;
+    var contextTypes = this.constructor.contextTypes;
+    if (contextTypes) {
+      maskedContext = {};
+      for (var contextName in contextTypes) {
+        maskedContext[contextName] = context[contextName];
+      }
+      if ("production" !== "development") {
+        this._checkPropTypes(
+          contextTypes,
+          maskedContext,
+          ReactPropTypeLocations.context
+        );
+      }
+    }
+    return maskedContext;
+  },
+
+  /**
+   * @param {object} currentContext
+   * @return {object}
+   * @private
+   */
+  _processChildContext: function(currentContext) {
+    var childContext = this.getChildContext && this.getChildContext();
+    var displayName = this.constructor.displayName || 'ReactCompositeComponent';
+    if (childContext) {
+      ("production" !== "development" ? invariant(
+        typeof this.constructor.childContextTypes === 'object',
+        '%s.getChildContext(): childContextTypes must be defined in order to ' +
+        'use getChildContext().',
+        displayName
+      ) : invariant(typeof this.constructor.childContextTypes === 'object'));
+      if ("production" !== "development") {
+        this._checkPropTypes(
+          this.constructor.childContextTypes,
+          childContext,
+          ReactPropTypeLocations.childContext
+        );
+      }
+      for (var name in childContext) {
+        ("production" !== "development" ? invariant(
+          name in this.constructor.childContextTypes,
+          '%s.getChildContext(): key "%s" is not defined in childContextTypes.',
+          displayName,
+          name
+        ) : invariant(name in this.constructor.childContextTypes));
+      }
+      return merge(currentContext, childContext);
+    }
+    return currentContext;
+  },
+
+  /**
+   * Processes props by setting default values for unspecified props and
+   * asserting that the props are valid. Does not mutate its argument; returns
+   * a new props object with defaults merged in.
+   *
+   * @param {object} newProps
+   * @return {object}
+   * @private
+   */
+  _processProps: function(newProps) {
+    var props = merge(newProps);
+    var defaultProps = this._defaultProps;
+    for (var propName in defaultProps) {
+      if (typeof props[propName] === 'undefined') {
+        props[propName] = defaultProps[propName];
+      }
+    }
+    if ("production" !== "development") {
+      var propTypes = this.constructor.propTypes;
+      if (propTypes) {
+        this._checkPropTypes(propTypes, props, ReactPropTypeLocations.prop);
+      }
+    }
+    return props;
+  },
+
+  /**
+   * Assert that the props are valid
+   *
+   * @param {object} propTypes Map of prop name to a ReactPropType
+   * @param {object} props
+   * @param {string} location e.g. "prop", "context", "child context"
+   * @private
+   */
+  _checkPropTypes: function(propTypes, props, location) {
+    var componentName = this.constructor.displayName;
+    for (var propName in propTypes) {
+      if (propTypes.hasOwnProperty(propName)) {
+        propTypes[propName](props, propName, componentName, location);
+      }
+    }
+  },
+
+  performUpdateIfNecessary: function() {
+    var compositeLifeCycleState = this._compositeLifeCycleState;
+    // Do not trigger a state transition if we are in the middle of mounting or
+    // receiving props because both of those will already be doing this.
+    if (compositeLifeCycleState === CompositeLifeCycle.MOUNTING ||
+        compositeLifeCycleState === CompositeLifeCycle.RECEIVING_PROPS) {
+      return;
+    }
+    ReactComponent.Mixin.performUpdateIfNecessary.call(this);
+  },
+
+  /**
+   * If any of `_pendingProps`, `_pendingState`, or `_pendingForceUpdate` is
+   * set, update the component.
+   *
+   * @param {ReactReconcileTransaction} transaction
+   * @internal
+   */
+  _performUpdateIfNecessary: function(transaction) {
+    if (this._pendingProps == null &&
+        this._pendingState == null &&
+        this._pendingContext == null &&
+        !this._pendingForceUpdate) {
+      return;
+    }
+
+    var nextFullContext = this._pendingContext || this._currentContext;
+    var nextContext = this._processContext(nextFullContext);
+    this._pendingContext = null;
+
+    var nextProps = this.props;
+    if (this._pendingProps != null) {
+      nextProps = this._processProps(this._pendingProps);
+      this._pendingProps = null;
+
+      this._compositeLifeCycleState = CompositeLifeCycle.RECEIVING_PROPS;
+      if (this.componentWillReceiveProps) {
+        this.componentWillReceiveProps(nextProps, nextContext);
+      }
+    }
+
+    this._compositeLifeCycleState = CompositeLifeCycle.RECEIVING_STATE;
+
+    // Unlike props, state, and context, we specifically don't want to set
+    // _pendingOwner to null here because it's possible for a component to have
+    // a null owner, so we instead make `this._owner === this._pendingOwner`
+    // mean that there's no owner change pending.
+    var nextOwner = this._pendingOwner;
+
+    var nextState = this._pendingState || this.state;
+    this._pendingState = null;
+
+    try {
+      if (this._pendingForceUpdate ||
+          !this.shouldComponentUpdate ||
+          this.shouldComponentUpdate(nextProps, nextState, nextContext)) {
+        this._pendingForceUpdate = false;
+        // Will set `this.props`, `this.state` and `this.context`.
+        this._performComponentUpdate(
+          nextProps,
+          nextOwner,
+          nextState,
+          nextFullContext,
+          nextContext,
+          transaction
+        );
+      } else {
+        // If it's determined that a component should not update, we still want
+        // to set props and state.
+        this.props = nextProps;
+        this._owner = nextOwner;
+        this.state = nextState;
+        this._currentContext = nextFullContext;
+        this.context = nextContext;
+      }
+    } finally {
+      this._compositeLifeCycleState = null;
+    }
+  },
+
+  /**
+   * Merges new props and state, notifies delegate methods of update and
+   * performs update.
+   *
+   * @param {object} nextProps Next object to set as properties.
+   * @param {?ReactComponent} nextOwner Next component to set as owner
+   * @param {?object} nextState Next object to set as state.
+   * @param {?object} nextFullContext Next object to set as _currentContext.
+   * @param {?object} nextContext Next object to set as context.
+   * @param {ReactReconcileTransaction} transaction
+   * @private
+   */
+  _performComponentUpdate: function(
+    nextProps,
+    nextOwner,
+    nextState,
+    nextFullContext,
+    nextContext,
+    transaction
+  ) {
+    var prevProps = this.props;
+    var prevOwner = this._owner;
+    var prevState = this.state;
+    var prevContext = this.context;
+
+    if (this.componentWillUpdate) {
+      this.componentWillUpdate(nextProps, nextState, nextContext);
+    }
+
+    this.props = nextProps;
+    this._owner = nextOwner;
+    this.state = nextState;
+    this._currentContext = nextFullContext;
+    this.context = nextContext;
+
+    this.updateComponent(
+      transaction,
+      prevProps,
+      prevOwner,
+      prevState,
+      prevContext
+    );
+
+    if (this.componentDidUpdate) {
+      transaction.getReactMountReady().enqueue(
+        this,
+        this.componentDidUpdate.bind(this, prevProps, prevState, prevContext)
+      );
+    }
+  },
+
+  receiveComponent: function(nextComponent, transaction) {
+    if (nextComponent === this._descriptor) {
+      // Since props and context are immutable after the component is
+      // mounted, we can do a cheap identity compare here to determine
+      // if this is a superfluous reconcile.
+      return;
+    }
+
+    // Update the descriptor that was last used by this component instance
+    this._descriptor = nextComponent;
+
+    this._pendingContext = nextComponent._currentContext;
+    ReactComponent.Mixin.receiveComponent.call(
+      this,
+      nextComponent,
+      transaction
+    );
+  },
+
+  /**
+   * Updates the component's currently mounted DOM representation.
+   *
+   * By default, this implements React's rendering and reconciliation algorithm.
+   * Sophisticated clients may wish to override this.
+   *
+   * @param {ReactReconcileTransaction} transaction
+   * @param {object} prevProps
+   * @param {?ReactComponent} prevOwner
+   * @param {?object} prevState
+   * @param {?object} prevContext
+   * @internal
+   * @overridable
+   */
+  updateComponent: ReactPerf.measure(
+    'ReactCompositeComponent',
+    'updateComponent',
+    function(transaction, prevProps, prevOwner, prevState, prevContext) {
+      ReactComponent.Mixin.updateComponent.call(
+        this,
+        transaction,
+        prevProps,
+        prevOwner
+      );
+
+
+      var prevComponentInstance = this._renderedComponent;
+      var nextComponent = this._renderValidatedComponent();
+      if (shouldUpdateReactComponent(prevComponentInstance, nextComponent)) {
+        prevComponentInstance.receiveComponent(nextComponent, transaction);
+      } else {
+        // These two IDs are actually the same! But nothing should rely on that.
+        var thisID = this._rootNodeID;
+        var prevComponentID = prevComponentInstance._rootNodeID;
+        prevComponentInstance.unmountComponent();
+        this._renderedComponent = instantiateReactComponent(nextComponent);
+        var nextMarkup = this._renderedComponent.mountComponent(
+          thisID,
+          transaction,
+          this._mountDepth + 1
+        );
+        ReactComponent.BackendIDOperations.dangerouslyReplaceNodeWithMarkupByID(
+          prevComponentID,
+          nextMarkup
+        );
+      }
+    }
+  ),
+
+  /**
+   * Forces an update. This should only be invoked when it is known with
+   * certainty that we are **not** in a DOM transaction.
+   *
+   * You may want to call this when you know that some deeper aspect of the
+   * component's state has changed but `setState` was not called.
+   *
+   * This will not invoke `shouldUpdateComponent`, but it will invoke
+   * `componentWillUpdate` and `componentDidUpdate`.
+   *
+   * @param {?function} callback Called after update is complete.
+   * @final
+   * @protected
+   */
+  forceUpdate: function(callback) {
+    var compositeLifeCycleState = this._compositeLifeCycleState;
+    ("production" !== "development" ? invariant(
+      this.isMounted() ||
+        compositeLifeCycleState === CompositeLifeCycle.MOUNTING,
+      'forceUpdate(...): Can only force an update on mounted or mounting ' +
+        'components.'
+    ) : invariant(this.isMounted() ||
+      compositeLifeCycleState === CompositeLifeCycle.MOUNTING));
+    ("production" !== "development" ? invariant(
+      compositeLifeCycleState !== CompositeLifeCycle.RECEIVING_STATE &&
+      compositeLifeCycleState !== CompositeLifeCycle.UNMOUNTING,
+      'forceUpdate(...): Cannot force an update while unmounting component ' +
+      'or during an existing state transition (such as within `render`).'
+    ) : invariant(compositeLifeCycleState !== CompositeLifeCycle.RECEIVING_STATE &&
+    compositeLifeCycleState !== CompositeLifeCycle.UNMOUNTING));
+    this._pendingForceUpdate = true;
+    ReactUpdates.enqueueUpdate(this, callback);
+  },
+
+  /**
+   * @private
+   */
+  _renderValidatedComponent: ReactPerf.measure(
+    'ReactCompositeComponent',
+    '_renderValidatedComponent',
+    function() {
+      var renderedComponent;
+      var previousContext = ReactContext.current;
+      ReactContext.current = this._processChildContext(this._currentContext);
+      ReactCurrentOwner.current = this;
+      try {
+        renderedComponent = this.render();
+      } finally {
+        ReactContext.current = previousContext;
+        ReactCurrentOwner.current = null;
+      }
+      ("production" !== "development" ? invariant(
+        ReactComponent.isValidComponent(renderedComponent),
+        '%s.render(): A valid ReactComponent must be returned. You may have ' +
+          'returned null, undefined, an array, or some other invalid object.',
+        this.constructor.displayName || 'ReactCompositeComponent'
+      ) : invariant(ReactComponent.isValidComponent(renderedComponent)));
+      return renderedComponent;
+    }
+  ),
+
+  /**
+   * @private
+   */
+  _bindAutoBindMethods: function() {
+    for (var autoBindKey in this.__reactAutoBindMap) {
+      if (!this.__reactAutoBindMap.hasOwnProperty(autoBindKey)) {
+        continue;
+      }
+      var method = this.__reactAutoBindMap[autoBindKey];
+      this[autoBindKey] = this._bindAutoBindMethod(ReactErrorUtils.guard(
+        method,
+        this.constructor.displayName + '.' + autoBindKey
+      ));
+    }
+  },
+
+  /**
+   * Binds a method to the component.
+   *
+   * @param {function} method Method to be bound.
+   * @private
+   */
+  _bindAutoBindMethod: function(method) {
+    var component = this;
+    var boundMethod = function() {
+      return method.apply(component, arguments);
+    };
+    if ("production" !== "development") {
+      boundMethod.__reactBoundContext = component;
+      boundMethod.__reactBoundMethod = method;
+      boundMethod.__reactBoundArguments = null;
+      var componentName = component.constructor.displayName;
+      var _bind = boundMethod.bind;
+      boundMethod.bind = function(newThis ) {var args=Array.prototype.slice.call(arguments,1);
+        // User is trying to bind() an autobound method; we effectively will
+        // ignore the value of "this" that the user is trying to use, so
+        // let's warn.
+        if (newThis !== component && newThis !== null) {
+          monitorCodeUse('react_bind_warning', { component: componentName });
+          console.warn(
+            'bind(): React component methods may only be bound to the ' +
+            'component instance. See ' + componentName
+          );
+        } else if (!args.length) {
+          monitorCodeUse('react_bind_warning', { component: componentName });
+          console.warn(
+            'bind(): You are binding a component method to the component. ' +
+            'React does this for you automatically in a high-performance ' +
+            'way, so you can safely remove this call. See ' + componentName
+          );
+          return boundMethod;
+        }
+        var reboundMethod = _bind.apply(boundMethod, arguments);
+        reboundMethod.__reactBoundContext = component;
+        reboundMethod.__reactBoundMethod = method;
+        reboundMethod.__reactBoundArguments = args;
+        return reboundMethod;
+      };
+    }
+    return boundMethod;
+  }
+};
+
+var ReactCompositeComponentBase = function() {};
+mixInto(ReactCompositeComponentBase, ReactComponent.Mixin);
+mixInto(ReactCompositeComponentBase, ReactOwner.Mixin);
+mixInto(ReactCompositeComponentBase, ReactPropTransferer.Mixin);
+mixInto(ReactCompositeComponentBase, ReactCompositeComponentMixin);
+
+/**
+ * Checks if a value is a valid component constructor.
+ *
+ * @param {*}
+ * @return {boolean}
+ * @public
+ */
+function isValidClass(componentClass) {
+  return componentClass instanceof Function &&
+         'componentConstructor' in componentClass &&
+         componentClass.componentConstructor instanceof Function;
+}
+/**
+ * Module for creating composite components.
+ *
+ * @class ReactCompositeComponent
+ * @extends ReactComponent
+ * @extends ReactOwner
+ * @extends ReactPropTransferer
+ */
+var ReactCompositeComponent = {
+
+  LifeCycle: CompositeLifeCycle,
+
+  Base: ReactCompositeComponentBase,
+
+  /**
+   * Creates a composite component class given a class specification.
+   *
+   * @param {object} spec Class specification (which must define `render`).
+   * @return {function} Component constructor function.
+   * @public
+   */
+  createClass: function(spec) {
+    var Constructor = function() {};
+    Constructor.prototype = new ReactCompositeComponentBase();
+    Constructor.prototype.constructor = Constructor;
+
+    var DescriptorConstructor = Constructor;
+
+    var ConvenienceConstructor = function(props, children) {
+      var descriptor = new DescriptorConstructor();
+      descriptor.construct.apply(descriptor, arguments);
+      return descriptor;
+    };
+    ConvenienceConstructor.componentConstructor = Constructor;
+    Constructor.ConvenienceConstructor = ConvenienceConstructor;
+    ConvenienceConstructor.originalSpec = spec;
+
+    injectedMixins.forEach(
+      mixSpecIntoComponent.bind(null, ConvenienceConstructor)
+    );
+
+    mixSpecIntoComponent(ConvenienceConstructor, spec);
+
+    ("production" !== "development" ? invariant(
+      Constructor.prototype.render,
+      'createClass(...): Class specification must implement a `render` method.'
+    ) : invariant(Constructor.prototype.render));
+
+    if ("production" !== "development") {
+      if (Constructor.prototype.componentShouldUpdate) {
+        monitorCodeUse(
+          'react_component_should_update_warning',
+          { component: spec.displayName }
+        );
+        console.warn(
+          (spec.displayName || 'A component') + ' has a method called ' +
+          'componentShouldUpdate(). Did you mean shouldComponentUpdate()? ' +
+          'The name is phrased as a question because the function is ' +
+          'expected to return a value.'
+         );
+      }
+    }
+
+    // Expose the convience constructor on the prototype so that it can be
+    // easily accessed on descriptors. E.g. <Foo />.type === Foo.type and for
+    // static methods like <Foo />.type.staticMethod();
+    // This should not be named constructor since this may not be the function
+    // that created the descriptor, and it may not even be a constructor.
+    ConvenienceConstructor.type = Constructor;
+    Constructor.prototype.type = Constructor;
+
+    // Reduce time spent doing lookups by setting these on the prototype.
+    for (var methodName in ReactCompositeComponentInterface) {
+      if (!Constructor.prototype[methodName]) {
+        Constructor.prototype[methodName] = null;
+      }
+    }
+
+    if ("production" !== "development") {
+      // In DEV the convenience constructor generates a proxy to another
+      // instance around it to warn about access to properties on the
+      // descriptor.
+      DescriptorConstructor = createDescriptorProxy(Constructor);
+    }
+
+    return ConvenienceConstructor;
+  },
+
+  isValidClass: isValidClass,
+
+  injection: {
+    injectMixin: function(mixin) {
+      injectedMixins.push(mixin);
+    }
+  }
+};
+
+module.exports = ReactCompositeComponent;
+
+},{"./ReactComponent":31,"./ReactContext":34,"./ReactCurrentOwner":35,"./ReactErrorUtils":51,"./ReactOwner":64,"./ReactPerf":65,"./ReactPropTransferer":66,"./ReactPropTypeLocationNames":67,"./ReactPropTypeLocations":68,"./ReactUpdates":81,"./instantiateReactComponent":124,"./invariant":125,"./keyMirror":131,"./merge":134,"./mixInto":137,"./monitorCodeUse":138,"./objMap":139,"./shouldUpdateReactComponent":144,"./warning":148}],34:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactContext
+ */
+
+"use strict";
+
+var merge = _dereq_("./merge");
+
+/**
+ * Keeps track of the current context.
+ *
+ * The context is automatically passed down the component ownership hierarchy
+ * and is accessible via `this.context` on ReactCompositeComponents.
+ */
+var ReactContext = {
+
+  /**
+   * @internal
+   * @type {object}
+   */
+  current: {},
+
+  /**
+   * Temporarily extends the current context while executing scopedCallback.
+   *
+   * A typical use case might look like
+   *
+   *  render: function() {
+   *    var children = ReactContext.withContext({foo: 'foo'} () => (
+   *
+   *    ));
+   *    return <div>{children}</div>;
+   *  }
+   *
+   * @param {object} newContext New context to merge into the existing context
+   * @param {function} scopedCallback Callback to run with the new context
+   * @return {ReactComponent|array<ReactComponent>}
+   */
+  withContext: function(newContext, scopedCallback) {
+    var result;
+    var previousContext = ReactContext.current;
+    ReactContext.current = merge(previousContext, newContext);
+    try {
+      result = scopedCallback();
+    } finally {
+      ReactContext.current = previousContext;
+    }
+    return result;
+  }
+
+};
+
+module.exports = ReactContext;
+
+},{"./merge":134}],35:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactCurrentOwner
+ */
+
+"use strict";
+
+/**
+ * Keeps track of the current owner.
+ *
+ * The current owner is the component who should own any components that are
+ * currently being constructed.
+ *
+ * The depth indicate how many composite components are above this render level.
+ */
+var ReactCurrentOwner = {
+
+  /**
+   * @internal
+   * @type {ReactComponent}
+   */
+  current: null
+
+};
+
+module.exports = ReactCurrentOwner;
+
+},{}],36:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactDOM
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var ReactDOMComponent = _dereq_("./ReactDOMComponent");
+
+var mergeInto = _dereq_("./mergeInto");
+var objMapKeyVal = _dereq_("./objMapKeyVal");
+
+/**
+ * Creates a new React class that is idempotent and capable of containing other
+ * React components. It accepts event listeners and DOM properties that are
+ * valid according to `DOMProperty`.
+ *
+ *  - Event listeners: `onClick`, `onMouseDown`, etc.
+ *  - DOM properties: `className`, `name`, `title`, etc.
+ *
+ * The `style` property functions differently from the DOM API. It accepts an
+ * object mapping of style properties to values.
+ *
+ * @param {string} tag Tag name (e.g. `div`).
+ * @param {boolean} omitClose True if the close tag should be omitted.
+ * @private
+ */
+function createDOMComponentClass(tag, omitClose) {
+  var Constructor = function() {};
+  Constructor.prototype = new ReactDOMComponent(tag, omitClose);
+  Constructor.prototype.constructor = Constructor;
+  Constructor.displayName = tag;
+
+  var ConvenienceConstructor = function(props, children) {
+    var instance = new Constructor();
+    instance.construct.apply(instance, arguments);
+    return instance;
+  };
+
+  // Expose the constructor on the ConvenienceConstructor and prototype so that
+  // it can be easily easily accessed on descriptors.
+  // E.g. <div />.type === div.type
+  ConvenienceConstructor.type = Constructor;
+  Constructor.prototype.type = Constructor;
+
+  Constructor.ConvenienceConstructor = ConvenienceConstructor;
+  ConvenienceConstructor.componentConstructor = Constructor;
+  return ConvenienceConstructor;
+}
+
+/**
+ * Creates a mapping from supported HTML tags to `ReactDOMComponent` classes.
+ * This is also accessible via `React.DOM`.
+ *
+ * @public
+ */
+var ReactDOM = objMapKeyVal({
+  a: false,
+  abbr: false,
+  address: false,
+  area: true,
+  article: false,
+  aside: false,
+  audio: false,
+  b: false,
+  base: true,
+  bdi: false,
+  bdo: false,
+  big: false,
+  blockquote: false,
+  body: false,
+  br: true,
+  button: false,
+  canvas: false,
+  caption: false,
+  cite: false,
+  code: false,
+  col: true,
+  colgroup: false,
+  data: false,
+  datalist: false,
+  dd: false,
+  del: false,
+  details: false,
+  dfn: false,
+  div: false,
+  dl: false,
+  dt: false,
+  em: false,
+  embed: true,
+  fieldset: false,
+  figcaption: false,
+  figure: false,
+  footer: false,
+  form: false, // NOTE: Injected, see `ReactDOMForm`.
+  h1: false,
+  h2: false,
+  h3: false,
+  h4: false,
+  h5: false,
+  h6: false,
+  head: false,
+  header: false,
+  hr: true,
+  html: false,
+  i: false,
+  iframe: false,
+  img: true,
+  input: true,
+  ins: false,
+  kbd: false,
+  keygen: true,
+  label: false,
+  legend: false,
+  li: false,
+  link: true,
+  main: false,
+  map: false,
+  mark: false,
+  menu: false,
+  menuitem: false, // NOTE: Close tag should be omitted, but causes problems.
+  meta: true,
+  meter: false,
+  nav: false,
+  noscript: false,
+  object: false,
+  ol: false,
+  optgroup: false,
+  option: false,
+  output: false,
+  p: false,
+  param: true,
+  pre: false,
+  progress: false,
+  q: false,
+  rp: false,
+  rt: false,
+  ruby: false,
+  s: false,
+  samp: false,
+  script: false,
+  section: false,
+  select: false,
+  small: false,
+  source: true,
+  span: false,
+  strong: false,
+  style: false,
+  sub: false,
+  summary: false,
+  sup: false,
+  table: false,
+  tbody: false,
+  td: false,
+  textarea: false, // NOTE: Injected, see `ReactDOMTextarea`.
+  tfoot: false,
+  th: false,
+  thead: false,
+  time: false,
+  title: false,
+  tr: false,
+  track: true,
+  u: false,
+  ul: false,
+  'var': false,
+  video: false,
+  wbr: true,
+
+  // SVG
+  circle: false,
+  defs: false,
+  g: false,
+  line: false,
+  linearGradient: false,
+  path: false,
+  polygon: false,
+  polyline: false,
+  radialGradient: false,
+  rect: false,
+  stop: false,
+  svg: false,
+  text: false
+}, createDOMComponentClass);
+
+var injection = {
+  injectComponentClasses: function(componentClasses) {
+    mergeInto(ReactDOM, componentClasses);
+  }
+};
+
+ReactDOM.injection = injection;
+
+module.exports = ReactDOM;
+
+},{"./ReactDOMComponent":38,"./mergeInto":136,"./objMapKeyVal":140}],37:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactDOMButton
+ */
+
+"use strict";
+
+var AutoFocusMixin = _dereq_("./AutoFocusMixin");
+var ReactBrowserComponentMixin = _dereq_("./ReactBrowserComponentMixin");
+var ReactCompositeComponent = _dereq_("./ReactCompositeComponent");
+var ReactDOM = _dereq_("./ReactDOM");
+
+var keyMirror = _dereq_("./keyMirror");
+
+// Store a reference to the <button> `ReactDOMComponent`.
+var button = ReactDOM.button;
+
+var mouseListenerNames = keyMirror({
+  onClick: true,
+  onDoubleClick: true,
+  onMouseDown: true,
+  onMouseMove: true,
+  onMouseUp: true,
+  onClickCapture: true,
+  onDoubleClickCapture: true,
+  onMouseDownCapture: true,
+  onMouseMoveCapture: true,
+  onMouseUpCapture: true
+});
+
+/**
+ * Implements a <button> native component that does not receive mouse events
+ * when `disabled` is set.
+ */
+var ReactDOMButton = ReactCompositeComponent.createClass({
+  displayName: 'ReactDOMButton',
+
+  mixins: [AutoFocusMixin, ReactBrowserComponentMixin],
+
+  render: function() {
+    var props = {};
+
+    // Copy the props; except the mouse listeners if we're disabled
+    for (var key in this.props) {
+      if (this.props.hasOwnProperty(key) &&
+          (!this.props.disabled || !mouseListenerNames[key])) {
+        props[key] = this.props[key];
+      }
+    }
+
+    return button(props, this.props.children);
+  }
+
+});
+
+module.exports = ReactDOMButton;
+
+},{"./AutoFocusMixin":1,"./ReactBrowserComponentMixin":27,"./ReactCompositeComponent":33,"./ReactDOM":36,"./keyMirror":131}],38:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactDOMComponent
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var CSSPropertyOperations = _dereq_("./CSSPropertyOperations");
+var DOMProperty = _dereq_("./DOMProperty");
+var DOMPropertyOperations = _dereq_("./DOMPropertyOperations");
+var ReactBrowserComponentMixin = _dereq_("./ReactBrowserComponentMixin");
+var ReactComponent = _dereq_("./ReactComponent");
+var ReactEventEmitter = _dereq_("./ReactEventEmitter");
+var ReactMount = _dereq_("./ReactMount");
+var ReactMultiChild = _dereq_("./ReactMultiChild");
+var ReactPerf = _dereq_("./ReactPerf");
+
+var escapeTextForBrowser = _dereq_("./escapeTextForBrowser");
+var invariant = _dereq_("./invariant");
+var keyOf = _dereq_("./keyOf");
+var merge = _dereq_("./merge");
+var mixInto = _dereq_("./mixInto");
+
+var deleteListener = ReactEventEmitter.deleteListener;
+var listenTo = ReactEventEmitter.listenTo;
+var registrationNameModules = ReactEventEmitter.registrationNameModules;
+
+// For quickly matching children type, to test if can be treated as content.
+var CONTENT_TYPES = {'string': true, 'number': true};
+
+var STYLE = keyOf({style: null});
+
+var ELEMENT_NODE_TYPE = 1;
+
+/**
+ * @param {?object} props
+ */
+function assertValidProps(props) {
+  if (!props) {
+    return;
+  }
+  // Note the use of `==` which checks for null or undefined.
+  ("production" !== "development" ? invariant(
+    props.children == null || props.dangerouslySetInnerHTML == null,
+    'Can only set one of `children` or `props.dangerouslySetInnerHTML`.'
+  ) : invariant(props.children == null || props.dangerouslySetInnerHTML == null));
+  ("production" !== "development" ? invariant(
+    props.style == null || typeof props.style === 'object',
+    'The `style` prop expects a mapping from style properties to values, ' +
+    'not a string.'
+  ) : invariant(props.style == null || typeof props.style === 'object'));
+}
+
+function putListener(id, registrationName, listener, transaction) {
+  var container = ReactMount.findReactContainerForID(id);
+  if (container) {
+    var doc = container.nodeType === ELEMENT_NODE_TYPE ?
+      container.ownerDocument :
+      container;
+    listenTo(registrationName, doc);
+  }
+  transaction.getPutListenerQueue().enqueuePutListener(
+    id,
+    registrationName,
+    listener
+  );
+}
+
+
+/**
+ * @constructor ReactDOMComponent
+ * @extends ReactComponent
+ * @extends ReactMultiChild
+ */
+function ReactDOMComponent(tag, omitClose) {
+  this._tagOpen = '<' + tag;
+  this._tagClose = omitClose ? '' : '</' + tag + '>';
+  this.tagName = tag.toUpperCase();
+}
+
+ReactDOMComponent.Mixin = {
+
+  /**
+   * Generates root tag markup then recurses. This method has side effects and
+   * is not idempotent.
+   *
+   * @internal
+   * @param {string} rootID The root DOM ID for this node.
+   * @param {ReactReconcileTransaction|ReactServerRenderingTransaction} transaction
+   * @param {number} mountDepth number of components in the owner hierarchy
+   * @return {string} The computed markup.
+   */
+  mountComponent: ReactPerf.measure(
+    'ReactDOMComponent',
+    'mountComponent',
+    function(rootID, transaction, mountDepth) {
+      ReactComponent.Mixin.mountComponent.call(
+        this,
+        rootID,
+        transaction,
+        mountDepth
+      );
+      assertValidProps(this.props);
+      return (
+        this._createOpenTagMarkupAndPutListeners(transaction) +
+        this._createContentMarkup(transaction) +
+        this._tagClose
+      );
+    }
+  ),
+
+  /**
+   * Creates markup for the open tag and all attributes.
+   *
+   * This method has side effects because events get registered.
+   *
+   * Iterating over object properties is faster than iterating over arrays.
+   * @see http://jsperf.com/obj-vs-arr-iteration
+   *
+   * @private
+   * @param {ReactReconcileTransaction|ReactServerRenderingTransaction} transaction
+   * @return {string} Markup of opening tag.
+   */
+  _createOpenTagMarkupAndPutListeners: function(transaction) {
+    var props = this.props;
+    var ret = this._tagOpen;
+
+    for (var propKey in props) {
+      if (!props.hasOwnProperty(propKey)) {
+        continue;
+      }
+      var propValue = props[propKey];
+      if (propValue == null) {
+        continue;
+      }
+      if (registrationNameModules[propKey]) {
+        putListener(this._rootNodeID, propKey, propValue, transaction);
+      } else {
+        if (propKey === STYLE) {
+          if (propValue) {
+            propValue = props.style = merge(props.style);
+          }
+          propValue = CSSPropertyOperations.createMarkupForStyles(propValue);
+        }
+        var markup =
+          DOMPropertyOperations.createMarkupForProperty(propKey, propValue);
+        if (markup) {
+          ret += ' ' + markup;
+        }
+      }
+    }
+
+    // For static pages, no need to put React ID and checksum. Saves lots of
+    // bytes.
+    if (transaction.renderToStaticMarkup) {
+      return ret + '>';
+    }
+
+    var markupForID = DOMPropertyOperations.createMarkupForID(this._rootNodeID);
+    return ret + ' ' + markupForID + '>';
+  },
+
+  /**
+   * Creates markup for the content between the tags.
+   *
+   * @private
+   * @param {ReactReconcileTransaction|ReactServerRenderingTransaction} transaction
+   * @return {string} Content markup.
+   */
+  _createContentMarkup: function(transaction) {
+    // Intentional use of != to avoid catching zero/false.
+    var innerHTML = this.props.dangerouslySetInnerHTML;
+    if (innerHTML != null) {
+      if (innerHTML.__html != null) {
+        return innerHTML.__html;
+      }
+    } else {
+      var contentToUse =
+        CONTENT_TYPES[typeof this.props.children] ? this.props.children : null;
+      var childrenToUse = contentToUse != null ? null : this.props.children;
+      if (contentToUse != null) {
+        return escapeTextForBrowser(contentToUse);
+      } else if (childrenToUse != null) {
+        var mountImages = this.mountChildren(
+          childrenToUse,
+          transaction
+        );
+        return mountImages.join('');
+      }
+    }
+    return '';
+  },
+
+  receiveComponent: function(nextComponent, transaction) {
+    if (nextComponent === this) {
+      // Since props and context are immutable after the component is
+      // mounted, we can do a cheap identity compare here to determine
+      // if this is a superfluous reconcile.
+
+      // TODO: compare the descriptor
+      return;
+    }
+
+    assertValidProps(nextComponent.props);
+    ReactComponent.Mixin.receiveComponent.call(
+      this,
+      nextComponent,
+      transaction
+    );
+  },
+
+  /**
+   * Updates a native DOM component after it has already been allocated and
+   * attached to the DOM. Reconciles the root DOM node, then recurses.
+   *
+   * @param {ReactReconcileTransaction} transaction
+   * @param {object} prevProps
+   * @internal
+   * @overridable
+   */
+  updateComponent: ReactPerf.measure(
+    'ReactDOMComponent',
+    'updateComponent',
+    function(transaction, prevProps, prevOwner) {
+      ReactComponent.Mixin.updateComponent.call(
+        this,
+        transaction,
+        prevProps,
+        prevOwner
+      );
+      this._updateDOMProperties(prevProps, transaction);
+      this._updateDOMChildren(prevProps, transaction);
+    }
+  ),
+
+  /**
+   * Reconciles the properties by detecting differences in property values and
+   * updating the DOM as necessary. This function is probably the single most
+   * critical path for performance optimization.
+   *
+   * TODO: Benchmark whether checking for changed values in memory actually
+   *       improves performance (especially statically positioned elements).
+   * TODO: Benchmark the effects of putting this at the top since 99% of props
+   *       do not change for a given reconciliation.
+   * TODO: Benchmark areas that can be improved with caching.
+   *
+   * @private
+   * @param {object} lastProps
+   * @param {ReactReconcileTransaction} transaction
+   */
+  _updateDOMProperties: function(lastProps, transaction) {
+    var nextProps = this.props;
+    var propKey;
+    var styleName;
+    var styleUpdates;
+    for (propKey in lastProps) {
+      if (nextProps.hasOwnProperty(propKey) ||
+         !lastProps.hasOwnProperty(propKey)) {
+        continue;
+      }
+      if (propKey === STYLE) {
+        var lastStyle = lastProps[propKey];
+        for (styleName in lastStyle) {
+          if (lastStyle.hasOwnProperty(styleName)) {
+            styleUpdates = styleUpdates || {};
+            styleUpdates[styleName] = '';
+          }
+        }
+      } else if (registrationNameModules[propKey]) {
+        deleteListener(this._rootNodeID, propKey);
+      } else if (
+          DOMProperty.isStandardName[propKey] ||
+          DOMProperty.isCustomAttribute(propKey)) {
+        ReactComponent.BackendIDOperations.deletePropertyByID(
+          this._rootNodeID,
+          propKey
+        );
+      }
+    }
+    for (propKey in nextProps) {
+      var nextProp = nextProps[propKey];
+      var lastProp = lastProps[propKey];
+      if (!nextProps.hasOwnProperty(propKey) || nextProp === lastProp) {
+        continue;
+      }
+      if (propKey === STYLE) {
+        if (nextProp) {
+          nextProp = nextProps.style = merge(nextProp);
+        }
+        if (lastProp) {
+          // Unset styles on `lastProp` but not on `nextProp`.
+          for (styleName in lastProp) {
+            if (lastProp.hasOwnProperty(styleName) &&
+                !nextProp.hasOwnProperty(styleName)) {
+              styleUpdates = styleUpdates || {};
+              styleUpdates[styleName] = '';
+            }
+          }
+          // Update styles that changed since `lastProp`.
+          for (styleName in nextProp) {
+            if (nextProp.hasOwnProperty(styleName) &&
+                lastProp[styleName] !== nextProp[styleName]) {
+              styleUpdates = styleUpdates || {};
+              styleUpdates[styleName] = nextProp[styleName];
+            }
+          }
+        } else {
+          // Relies on `updateStylesByID` not mutating `styleUpdates`.
+          styleUpdates = nextProp;
+        }
+      } else if (registrationNameModules[propKey]) {
+        putListener(this._rootNodeID, propKey, nextProp, transaction);
+      } else if (
+          DOMProperty.isStandardName[propKey] ||
+          DOMProperty.isCustomAttribute(propKey)) {
+        ReactComponent.BackendIDOperations.updatePropertyByID(
+          this._rootNodeID,
+          propKey,
+          nextProp
+        );
+      }
+    }
+    if (styleUpdates) {
+      ReactComponent.BackendIDOperations.updateStylesByID(
+        this._rootNodeID,
+        styleUpdates
+      );
+    }
+  },
+
+  /**
+   * Reconciles the children with the various properties that affect the
+   * children content.
+   *
+   * @param {object} lastProps
+   * @param {ReactReconcileTransaction} transaction
+   */
+  _updateDOMChildren: function(lastProps, transaction) {
+    var nextProps = this.props;
+
+    var lastContent =
+      CONTENT_TYPES[typeof lastProps.children] ? lastProps.children : null;
+    var nextContent =
+      CONTENT_TYPES[typeof nextProps.children] ? nextProps.children : null;
+
+    var lastHtml =
+      lastProps.dangerouslySetInnerHTML &&
+      lastProps.dangerouslySetInnerHTML.__html;
+    var nextHtml =
+      nextProps.dangerouslySetInnerHTML &&
+      nextProps.dangerouslySetInnerHTML.__html;
+
+    // Note the use of `!=` which checks for null or undefined.
+    var lastChildren = lastContent != null ? null : lastProps.children;
+    var nextChildren = nextContent != null ? null : nextProps.children;
+
+    // If we're switching from children to content/html or vice versa, remove
+    // the old content
+    var lastHasContentOrHtml = lastContent != null || lastHtml != null;
+    var nextHasContentOrHtml = nextContent != null || nextHtml != null;
+    if (lastChildren != null && nextChildren == null) {
+      this.updateChildren(null, transaction);
+    } else if (lastHasContentOrHtml && !nextHasContentOrHtml) {
+      this.updateTextContent('');
+    }
+
+    if (nextContent != null) {
+      if (lastContent !== nextContent) {
+        this.updateTextContent('' + nextContent);
+      }
+    } else if (nextHtml != null) {
+      if (lastHtml !== nextHtml) {
+        ReactComponent.BackendIDOperations.updateInnerHTMLByID(
+          this._rootNodeID,
+          nextHtml
+        );
+      }
+    } else if (nextChildren != null) {
+      this.updateChildren(nextChildren, transaction);
+    }
+  },
+
+  /**
+   * Destroys all event registrations for this instance. Does not remove from
+   * the DOM. That must be done by the parent.
+   *
+   * @internal
+   */
+  unmountComponent: function() {
+    this.unmountChildren();
+    ReactEventEmitter.deleteAllListeners(this._rootNodeID);
+    ReactComponent.Mixin.unmountComponent.call(this);
+  }
+
+};
+
+mixInto(ReactDOMComponent, ReactComponent.Mixin);
+mixInto(ReactDOMComponent, ReactDOMComponent.Mixin);
+mixInto(ReactDOMComponent, ReactMultiChild.Mixin);
+mixInto(ReactDOMComponent, ReactBrowserComponentMixin);
+
+module.exports = ReactDOMComponent;
+
+},{"./CSSPropertyOperations":4,"./DOMProperty":9,"./DOMPropertyOperations":10,"./ReactBrowserComponentMixin":27,"./ReactComponent":31,"./ReactEventEmitter":52,"./ReactMount":60,"./ReactMultiChild":62,"./ReactPerf":65,"./escapeTextForBrowser":111,"./invariant":125,"./keyOf":132,"./merge":134,"./mixInto":137}],39:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactDOMForm
+ */
+
+"use strict";
+
+var ReactBrowserComponentMixin = _dereq_("./ReactBrowserComponentMixin");
+var ReactCompositeComponent = _dereq_("./ReactCompositeComponent");
+var ReactDOM = _dereq_("./ReactDOM");
+var ReactEventEmitter = _dereq_("./ReactEventEmitter");
+var EventConstants = _dereq_("./EventConstants");
+
+// Store a reference to the <form> `ReactDOMComponent`.
+var form = ReactDOM.form;
+
+/**
+ * Since onSubmit doesn't bubble OR capture on the top level in IE8, we need
+ * to capture it on the <form> element itself. There are lots of hacks we could
+ * do to accomplish this, but the most reliable is to make <form> a
+ * composite component and use `componentDidMount` to attach the event handlers.
+ */
+var ReactDOMForm = ReactCompositeComponent.createClass({
+  displayName: 'ReactDOMForm',
+
+  mixins: [ReactBrowserComponentMixin],
+
+  render: function() {
+    // TODO: Instead of using `ReactDOM` directly, we should use JSX. However,
+    // `jshint` fails to parse JSX so in order for linting to work in the open
+    // source repo, we need to just use `ReactDOM.form`.
+    return this.transferPropsTo(form(null, this.props.children));
+  },
+
+  componentDidMount: function() {
+    ReactEventEmitter.trapBubbledEvent(
+      EventConstants.topLevelTypes.topReset,
+      'reset',
+      this.getDOMNode()
+    );
+    ReactEventEmitter.trapBubbledEvent(
+      EventConstants.topLevelTypes.topSubmit,
+      'submit',
+      this.getDOMNode()
+    );
+  }
+});
+
+module.exports = ReactDOMForm;
+
+},{"./EventConstants":15,"./ReactBrowserComponentMixin":27,"./ReactCompositeComponent":33,"./ReactDOM":36,"./ReactEventEmitter":52}],40:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactDOMIDOperations
+ * @typechecks static-only
+ */
+
+/*jslint evil: true */
+
+"use strict";
+
+var CSSPropertyOperations = _dereq_("./CSSPropertyOperations");
+var DOMChildrenOperations = _dereq_("./DOMChildrenOperations");
+var DOMPropertyOperations = _dereq_("./DOMPropertyOperations");
+var ReactMount = _dereq_("./ReactMount");
+var ReactPerf = _dereq_("./ReactPerf");
+
+var invariant = _dereq_("./invariant");
+
+/**
+ * Errors for properties that should not be updated with `updatePropertyById()`.
+ *
+ * @type {object}
+ * @private
+ */
+var INVALID_PROPERTY_ERRORS = {
+  dangerouslySetInnerHTML:
+    '`dangerouslySetInnerHTML` must be set using `updateInnerHTMLByID()`.',
+  style: '`style` must be set using `updateStylesByID()`.'
+};
+
+var useWhitespaceWorkaround;
+
+/**
+ * Operations used to process updates to DOM nodes. This is made injectable via
+ * `ReactComponent.BackendIDOperations`.
+ */
+var ReactDOMIDOperations = {
+
+  /**
+   * Updates a DOM node with new property values. This should only be used to
+   * update DOM properties in `DOMProperty`.
+   *
+   * @param {string} id ID of the node to update.
+   * @param {string} name A valid property name, see `DOMProperty`.
+   * @param {*} value New value of the property.
+   * @internal
+   */
+  updatePropertyByID: ReactPerf.measure(
+    'ReactDOMIDOperations',
+    'updatePropertyByID',
+    function(id, name, value) {
+      var node = ReactMount.getNode(id);
+      ("production" !== "development" ? invariant(
+        !INVALID_PROPERTY_ERRORS.hasOwnProperty(name),
+        'updatePropertyByID(...): %s',
+        INVALID_PROPERTY_ERRORS[name]
+      ) : invariant(!INVALID_PROPERTY_ERRORS.hasOwnProperty(name)));
+
+      // If we're updating to null or undefined, we should remove the property
+      // from the DOM node instead of inadvertantly setting to a string. This
+      // brings us in line with the same behavior we have on initial render.
+      if (value != null) {
+        DOMPropertyOperations.setValueForProperty(node, name, value);
+      } else {
+        DOMPropertyOperations.deleteValueForProperty(node, name);
+      }
+    }
+  ),
+
+  /**
+   * Updates a DOM node to remove a property. This should only be used to remove
+   * DOM properties in `DOMProperty`.
+   *
+   * @param {string} id ID of the node to update.
+   * @param {string} name A property name to remove, see `DOMProperty`.
+   * @internal
+   */
+  deletePropertyByID: ReactPerf.measure(
+    'ReactDOMIDOperations',
+    'deletePropertyByID',
+    function(id, name, value) {
+      var node = ReactMount.getNode(id);
+      ("production" !== "development" ? invariant(
+        !INVALID_PROPERTY_ERRORS.hasOwnProperty(name),
+        'updatePropertyByID(...): %s',
+        INVALID_PROPERTY_ERRORS[name]
+      ) : invariant(!INVALID_PROPERTY_ERRORS.hasOwnProperty(name)));
+      DOMPropertyOperations.deleteValueForProperty(node, name, value);
+    }
+  ),
+
+  /**
+   * Updates a DOM node with new style values. If a value is specified as '',
+   * the corresponding style property will be unset.
+   *
+   * @param {string} id ID of the node to update.
+   * @param {object} styles Mapping from styles to values.
+   * @internal
+   */
+  updateStylesByID: ReactPerf.measure(
+    'ReactDOMIDOperations',
+    'updateStylesByID',
+    function(id, styles) {
+      var node = ReactMount.getNode(id);
+      CSSPropertyOperations.setValueForStyles(node, styles);
+    }
+  ),
+
+  /**
+   * Updates a DOM node's innerHTML.
+   *
+   * @param {string} id ID of the node to update.
+   * @param {string} html An HTML string.
+   * @internal
+   */
+  updateInnerHTMLByID: ReactPerf.measure(
+    'ReactDOMIDOperations',
+    'updateInnerHTMLByID',
+    function(id, html) {
+      var node = ReactMount.getNode(id);
+
+      // IE8: When updating a just created node with innerHTML only leading
+      // whitespace is removed. When updating an existing node with innerHTML
+      // whitespace in root TextNodes is also collapsed.
+      // @see quirksmode.org/bugreports/archives/2004/11/innerhtml_and_t.html
+
+      if (useWhitespaceWorkaround === undefined) {
+        // Feature detection; only IE8 is known to behave improperly like this.
+        var temp = document.createElement('div');
+        temp.innerHTML = ' ';
+        useWhitespaceWorkaround = temp.innerHTML === '';
+      }
+
+      if (useWhitespaceWorkaround) {
+        // Magic theory: IE8 supposedly differentiates between added and updated
+        // nodes when processing innerHTML, innerHTML on updated nodes suffers
+        // from worse whitespace behavior. Re-adding a node like this triggers
+        // the initial and more favorable whitespace behavior.
+        node.parentNode.replaceChild(node, node);
+      }
+
+      if (useWhitespaceWorkaround && html.match(/^[ \r\n\t\f]/)) {
+        // Recover leading whitespace by temporarily prepending any character.
+        // \uFEFF has the potential advantage of being zero-width/invisible.
+        node.innerHTML = '\uFEFF' + html;
+        node.firstChild.deleteData(0, 1);
+      } else {
+        node.innerHTML = html;
+      }
+    }
+  ),
+
+  /**
+   * Updates a DOM node's text content set by `props.content`.
+   *
+   * @param {string} id ID of the node to update.
+   * @param {string} content Text content.
+   * @internal
+   */
+  updateTextContentByID: ReactPerf.measure(
+    'ReactDOMIDOperations',
+    'updateTextContentByID',
+    function(id, content) {
+      var node = ReactMount.getNode(id);
+      DOMChildrenOperations.updateTextContent(node, content);
+    }
+  ),
+
+  /**
+   * Replaces a DOM node that exists in the document with markup.
+   *
+   * @param {string} id ID of child to be replaced.
+   * @param {string} markup Dangerous markup to inject in place of child.
+   * @internal
+   * @see {Danger.dangerouslyReplaceNodeWithMarkup}
+   */
+  dangerouslyReplaceNodeWithMarkupByID: ReactPerf.measure(
+    'ReactDOMIDOperations',
+    'dangerouslyReplaceNodeWithMarkupByID',
+    function(id, markup) {
+      var node = ReactMount.getNode(id);
+      DOMChildrenOperations.dangerouslyReplaceNodeWithMarkup(node, markup);
+    }
+  ),
+
+  /**
+   * Updates a component's children by processing a series of updates.
+   *
+   * @param {array<object>} updates List of update configurations.
+   * @param {array<string>} markup List of markup strings.
+   * @internal
+   */
+  dangerouslyProcessChildrenUpdates: ReactPerf.measure(
+    'ReactDOMIDOperations',
+    'dangerouslyProcessChildrenUpdates',
+    function(updates, markup) {
+      for (var i = 0; i < updates.length; i++) {
+        updates[i].parentNode = ReactMount.getNode(updates[i].parentID);
+      }
+      DOMChildrenOperations.processUpdates(updates, markup);
+    }
+  )
+};
+
+module.exports = ReactDOMIDOperations;
+
+},{"./CSSPropertyOperations":4,"./DOMChildrenOperations":8,"./DOMPropertyOperations":10,"./ReactMount":60,"./ReactPerf":65,"./invariant":125}],41:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactDOMImg
+ */
+
+"use strict";
+
+var ReactBrowserComponentMixin = _dereq_("./ReactBrowserComponentMixin");
+var ReactCompositeComponent = _dereq_("./ReactCompositeComponent");
+var ReactDOM = _dereq_("./ReactDOM");
+var ReactEventEmitter = _dereq_("./ReactEventEmitter");
+var EventConstants = _dereq_("./EventConstants");
+
+// Store a reference to the <img> `ReactDOMComponent`.
+var img = ReactDOM.img;
+
+/**
+ * Since onLoad doesn't bubble OR capture on the top level in IE8, we need to
+ * capture it on the <img> element itself. There are lots of hacks we could do
+ * to accomplish this, but the most reliable is to make <img> a composite
+ * component and use `componentDidMount` to attach the event handlers.
+ */
+var ReactDOMImg = ReactCompositeComponent.createClass({
+  displayName: 'ReactDOMImg',
+  tagName: 'IMG',
+
+  mixins: [ReactBrowserComponentMixin],
+
+  render: function() {
+    return img(this.props);
+  },
+
+  componentDidMount: function() {
+    var node = this.getDOMNode();
+    ReactEventEmitter.trapBubbledEvent(
+      EventConstants.topLevelTypes.topLoad,
+      'load',
+      node
+    );
+    ReactEventEmitter.trapBubbledEvent(
+      EventConstants.topLevelTypes.topError,
+      'error',
+      node
+    );
+  }
+});
+
+module.exports = ReactDOMImg;
+
+},{"./EventConstants":15,"./ReactBrowserComponentMixin":27,"./ReactCompositeComponent":33,"./ReactDOM":36,"./ReactEventEmitter":52}],42:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactDOMInput
+ */
+
+"use strict";
+
+var AutoFocusMixin = _dereq_("./AutoFocusMixin");
+var DOMPropertyOperations = _dereq_("./DOMPropertyOperations");
+var LinkedValueUtils = _dereq_("./LinkedValueUtils");
+var ReactBrowserComponentMixin = _dereq_("./ReactBrowserComponentMixin");
+var ReactCompositeComponent = _dereq_("./ReactCompositeComponent");
+var ReactDOM = _dereq_("./ReactDOM");
+var ReactMount = _dereq_("./ReactMount");
+
+var invariant = _dereq_("./invariant");
+var merge = _dereq_("./merge");
+
+// Store a reference to the <input> `ReactDOMComponent`.
+var input = ReactDOM.input;
+
+var instancesByReactID = {};
+
+/**
+ * Implements an <input> native component that allows setting these optional
+ * props: `checked`, `value`, `defaultChecked`, and `defaultValue`.
+ *
+ * If `checked` or `value` are not supplied (or null/undefined), user actions
+ * that affect the checked state or value will trigger updates to the element.
+ *
+ * If they are supplied (and not null/undefined), the rendered element will not
+ * trigger updates to the element. Instead, the props must change in order for
+ * the rendered element to be updated.
+ *
+ * The rendered element will be initialized as unchecked (or `defaultChecked`)
+ * with an empty value (or `defaultValue`).
+ *
+ * @see http://www.w3.org/TR/2012/WD-html5-20121025/the-input-element.html
+ */
+var ReactDOMInput = ReactCompositeComponent.createClass({
+  displayName: 'ReactDOMInput',
+
+  mixins: [AutoFocusMixin, LinkedValueUtils.Mixin, ReactBrowserComponentMixin],
+
+  getInitialState: function() {
+    var defaultValue = this.props.defaultValue;
+    return {
+      checked: this.props.defaultChecked || false,
+      value: defaultValue != null ? defaultValue : null
+    };
+  },
+
+  shouldComponentUpdate: function() {
+    // Defer any updates to this component during the `onChange` handler.
+    return !this._isChanging;
+  },
+
+  render: function() {
+    // Clone `this.props` so we don't mutate the input.
+    var props = merge(this.props);
+
+    props.defaultChecked = null;
+    props.defaultValue = null;
+
+    var value = LinkedValueUtils.getValue(this);
+    props.value = value != null ? value : this.state.value;
+
+    var checked = LinkedValueUtils.getChecked(this);
+    props.checked = checked != null ? checked : this.state.checked;
+
+    props.onChange = this._handleChange;
+
+    return input(props, this.props.children);
+  },
+
+  componentDidMount: function() {
+    var id = ReactMount.getID(this.getDOMNode());
+    instancesByReactID[id] = this;
+  },
+
+  componentWillUnmount: function() {
+    var rootNode = this.getDOMNode();
+    var id = ReactMount.getID(rootNode);
+    delete instancesByReactID[id];
+  },
+
+  componentDidUpdate: function(prevProps, prevState, prevContext) {
+    var rootNode = this.getDOMNode();
+    if (this.props.checked != null) {
+      DOMPropertyOperations.setValueForProperty(
+        rootNode,
+        'checked',
+        this.props.checked || false
+      );
+    }
+
+    var value = LinkedValueUtils.getValue(this);
+    if (value != null) {
+      // Cast `value` to a string to ensure the value is set correctly. While
+      // browsers typically do this as necessary, jsdom doesn't.
+      DOMPropertyOperations.setValueForProperty(rootNode, 'value', '' + value);
+    }
+  },
+
+  _handleChange: function(event) {
+    var returnValue;
+    var onChange = LinkedValueUtils.getOnChange(this);
+    if (onChange) {
+      this._isChanging = true;
+      returnValue = onChange.call(this, event);
+      this._isChanging = false;
+    }
+    this.setState({
+      checked: event.target.checked,
+      value: event.target.value
+    });
+
+    var name = this.props.name;
+    if (this.props.type === 'radio' && name != null) {
+      var rootNode = this.getDOMNode();
+      var queryRoot = rootNode;
+
+      while (queryRoot.parentNode) {
+        queryRoot = queryRoot.parentNode;
+      }
+
+      // If `rootNode.form` was non-null, then we could try `form.elements`,
+      // but that sometimes behaves strangely in IE8. We could also try using
+      // `form.getElementsByName`, but that will only return direct children
+      // and won't include inputs that use the HTML5 `form=` attribute. Since
+      // the input might not even be in a form, let's just use the global
+      // `querySelectorAll` to ensure we don't miss anything.
+      var group = queryRoot.querySelectorAll(
+        'input[name=' + JSON.stringify('' + name) + '][type="radio"]');
+
+      for (var i = 0, groupLen = group.length; i < groupLen; i++) {
+        var otherNode = group[i];
+        if (otherNode === rootNode ||
+            otherNode.form !== rootNode.form) {
+          continue;
+        }
+        var otherID = ReactMount.getID(otherNode);
+        ("production" !== "development" ? invariant(
+          otherID,
+          'ReactDOMInput: Mixing React and non-React radio inputs with the ' +
+          'same `name` is not supported.'
+        ) : invariant(otherID));
+        var otherInstance = instancesByReactID[otherID];
+        ("production" !== "development" ? invariant(
+          otherInstance,
+          'ReactDOMInput: Unknown radio button ID %s.',
+          otherID
+        ) : invariant(otherInstance));
+        // In some cases, this will actually change the `checked` state value.
+        // In other cases, there's no change but this forces a reconcile upon
+        // which componentDidUpdate will reset the DOM property to whatever it
+        // should be.
+        otherInstance.setState({
+          checked: false
+        });
+      }
+    }
+
+    return returnValue;
+  }
+
+});
+
+module.exports = ReactDOMInput;
+
+},{"./AutoFocusMixin":1,"./DOMPropertyOperations":10,"./LinkedValueUtils":23,"./ReactBrowserComponentMixin":27,"./ReactCompositeComponent":33,"./ReactDOM":36,"./ReactMount":60,"./invariant":125,"./merge":134}],43:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactDOMOption
+ */
+
+"use strict";
+
+var ReactBrowserComponentMixin = _dereq_("./ReactBrowserComponentMixin");
+var ReactCompositeComponent = _dereq_("./ReactCompositeComponent");
+var ReactDOM = _dereq_("./ReactDOM");
+
+var warning = _dereq_("./warning");
+
+// Store a reference to the <option> `ReactDOMComponent`.
+var option = ReactDOM.option;
+
+/**
+ * Implements an <option> native component that warns when `selected` is set.
+ */
+var ReactDOMOption = ReactCompositeComponent.createClass({
+  displayName: 'ReactDOMOption',
+
+  mixins: [ReactBrowserComponentMixin],
+
+  componentWillMount: function() {
+    // TODO (yungsters): Remove support for `selected` in <option>.
+    if ("production" !== "development") {
+      ("production" !== "development" ? warning(
+        this.props.selected == null,
+        'Use the `defaultValue` or `value` props on <select> instead of ' +
+        'setting `selected` on <option>.'
+      ) : null);
+    }
+  },
+
+  render: function() {
+    return option(this.props, this.props.children);
+  }
+
+});
+
+module.exports = ReactDOMOption;
+
+},{"./ReactBrowserComponentMixin":27,"./ReactCompositeComponent":33,"./ReactDOM":36,"./warning":148}],44:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactDOMSelect
+ */
+
+"use strict";
+
+var AutoFocusMixin = _dereq_("./AutoFocusMixin");
+var LinkedValueUtils = _dereq_("./LinkedValueUtils");
+var ReactBrowserComponentMixin = _dereq_("./ReactBrowserComponentMixin");
+var ReactCompositeComponent = _dereq_("./ReactCompositeComponent");
+var ReactDOM = _dereq_("./ReactDOM");
+
+var invariant = _dereq_("./invariant");
+var merge = _dereq_("./merge");
+
+// Store a reference to the <select> `ReactDOMComponent`.
+var select = ReactDOM.select;
+
+/**
+ * Validation function for `value` and `defaultValue`.
+ * @private
+ */
+function selectValueType(props, propName, componentName) {
+  if (props[propName] == null) {
+    return;
+  }
+  if (props.multiple) {
+    ("production" !== "development" ? invariant(
+      Array.isArray(props[propName]),
+      'The `%s` prop supplied to <select> must be an array if `multiple` is ' +
+      'true.',
+      propName
+    ) : invariant(Array.isArray(props[propName])));
+  } else {
+    ("production" !== "development" ? invariant(
+      !Array.isArray(props[propName]),
+      'The `%s` prop supplied to <select> must be a scalar value if ' +
+      '`multiple` is false.',
+      propName
+    ) : invariant(!Array.isArray(props[propName])));
+  }
+}
+
+/**
+ * If `value` is supplied, updates <option> elements on mount and update.
+ * @param {ReactComponent} component Instance of ReactDOMSelect
+ * @param {?*} propValue For uncontrolled components, null/undefined. For
+ * controlled components, a string (or with `multiple`, a list of strings).
+ * @private
+ */
+function updateOptions(component, propValue) {
+  var multiple = component.props.multiple;
+  var value = propValue != null ? propValue : component.state.value;
+  var options = component.getDOMNode().options;
+  var selectedValue, i, l;
+  if (multiple) {
+    selectedValue = {};
+    for (i = 0, l = value.length; i < l; ++i) {
+      selectedValue['' + value[i]] = true;
+    }
+  } else {
+    selectedValue = '' + value;
+  }
+  for (i = 0, l = options.length; i < l; i++) {
+    var selected = multiple ?
+      selectedValue.hasOwnProperty(options[i].value) :
+      options[i].value === selectedValue;
+
+    if (selected !== options[i].selected) {
+      options[i].selected = selected;
+    }
+  }
+}
+
+/**
+ * Implements a <select> native component that allows optionally setting the
+ * props `value` and `defaultValue`. If `multiple` is false, the prop must be a
+ * string. If `multiple` is true, the prop must be an array of strings.
+ *
+ * If `value` is not supplied (or null/undefined), user actions that change the
+ * selected option will trigger updates to the rendered options.
+ *
+ * If it is supplied (and not null/undefined), the rendered options will not
+ * update in response to user actions. Instead, the `value` prop must change in
+ * order for the rendered options to update.
+ *
+ * If `defaultValue` is provided, any options with the supplied values will be
+ * selected.
+ */
+var ReactDOMSelect = ReactCompositeComponent.createClass({
+  displayName: 'ReactDOMSelect',
+
+  mixins: [AutoFocusMixin, LinkedValueUtils.Mixin, ReactBrowserComponentMixin],
+
+  propTypes: {
+    defaultValue: selectValueType,
+    value: selectValueType
+  },
+
+  getInitialState: function() {
+    return {value: this.props.defaultValue || (this.props.multiple ? [] : '')};
+  },
+
+  componentWillReceiveProps: function(nextProps) {
+    if (!this.props.multiple && nextProps.multiple) {
+      this.setState({value: [this.state.value]});
+    } else if (this.props.multiple && !nextProps.multiple) {
+      this.setState({value: this.state.value[0]});
+    }
+  },
+
+  shouldComponentUpdate: function() {
+    // Defer any updates to this component during the `onChange` handler.
+    return !this._isChanging;
+  },
+
+  render: function() {
+    // Clone `this.props` so we don't mutate the input.
+    var props = merge(this.props);
+
+    props.onChange = this._handleChange;
+    props.value = null;
+
+    return select(props, this.props.children);
+  },
+
+  componentDidMount: function() {
+    updateOptions(this, LinkedValueUtils.getValue(this));
+  },
+
+  componentDidUpdate: function() {
+    var value = LinkedValueUtils.getValue(this);
+    if (value != null) {
+      updateOptions(this, value);
+    }
+  },
+
+  _handleChange: function(event) {
+    var returnValue;
+    var onChange = LinkedValueUtils.getOnChange(this);
+    if (onChange) {
+      this._isChanging = true;
+      returnValue = onChange.call(this, event);
+      this._isChanging = false;
+    }
+
+    var selectedValue;
+    if (this.props.multiple) {
+      selectedValue = [];
+      var options = event.target.options;
+      for (var i = 0, l = options.length; i < l; i++) {
+        if (options[i].selected) {
+          selectedValue.push(options[i].value);
+        }
+      }
+    } else {
+      selectedValue = event.target.value;
+    }
+
+    this.setState({value: selectedValue});
+    return returnValue;
+  }
+
+});
+
+module.exports = ReactDOMSelect;
+
+},{"./AutoFocusMixin":1,"./LinkedValueUtils":23,"./ReactBrowserComponentMixin":27,"./ReactCompositeComponent":33,"./ReactDOM":36,"./invariant":125,"./merge":134}],45:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactDOMSelection
+ */
+
+"use strict";
+
+var getNodeForCharacterOffset = _dereq_("./getNodeForCharacterOffset");
+var getTextContentAccessor = _dereq_("./getTextContentAccessor");
+
+/**
+ * Get the appropriate anchor and focus node/offset pairs for IE.
+ *
+ * The catch here is that IE's selection API doesn't provide information
+ * about whether the selection is forward or backward, so we have to
+ * behave as though it's always forward.
+ *
+ * IE text differs from modern selection in that it behaves as though
+ * block elements end with a new line. This means character offsets will
+ * differ between the two APIs.
+ *
+ * @param {DOMElement} node
+ * @return {object}
+ */
+function getIEOffsets(node) {
+  var selection = document.selection;
+  var selectedRange = selection.createRange();
+  var selectedLength = selectedRange.text.length;
+
+  // Duplicate selection so we can move range without breaking user selection.
+  var fromStart = selectedRange.duplicate();
+  fromStart.moveToElementText(node);
+  fromStart.setEndPoint('EndToStart', selectedRange);
+
+  var startOffset = fromStart.text.length;
+  var endOffset = startOffset + selectedLength;
+
+  return {
+    start: startOffset,
+    end: endOffset
+  };
+}
+
+/**
+ * @param {DOMElement} node
+ * @return {?object}
+ */
+function getModernOffsets(node) {
+  var selection = window.getSelection();
+
+  if (selection.rangeCount === 0) {
+    return null;
+  }
+
+  var anchorNode = selection.anchorNode;
+  var anchorOffset = selection.anchorOffset;
+  var focusNode = selection.focusNode;
+  var focusOffset = selection.focusOffset;
+
+  var currentRange = selection.getRangeAt(0);
+  var rangeLength = currentRange.toString().length;
+
+  var tempRange = currentRange.cloneRange();
+  tempRange.selectNodeContents(node);
+  tempRange.setEnd(currentRange.startContainer, currentRange.startOffset);
+
+  var start = tempRange.toString().length;
+  var end = start + rangeLength;
+
+  // Detect whether the selection is backward.
+  var detectionRange = document.createRange();
+  detectionRange.setStart(anchorNode, anchorOffset);
+  detectionRange.setEnd(focusNode, focusOffset);
+  var isBackward = detectionRange.collapsed;
+  detectionRange.detach();
+
+  return {
+    start: isBackward ? end : start,
+    end: isBackward ? start : end
+  };
+}
+
+/**
+ * @param {DOMElement|DOMTextNode} node
+ * @param {object} offsets
+ */
+function setIEOffsets(node, offsets) {
+  var range = document.selection.createRange().duplicate();
+  var start, end;
+
+  if (typeof offsets.end === 'undefined') {
+    start = offsets.start;
+    end = start;
+  } else if (offsets.start > offsets.end) {
+    start = offsets.end;
+    end = offsets.start;
+  } else {
+    start = offsets.start;
+    end = offsets.end;
+  }
+
+  range.moveToElementText(node);
+  range.moveStart('character', start);
+  range.setEndPoint('EndToStart', range);
+  range.moveEnd('character', end - start);
+  range.select();
+}
+
+/**
+ * In modern non-IE browsers, we can support both forward and backward
+ * selections.
+ *
+ * Note: IE10+ supports the Selection object, but it does not support
+ * the `extend` method, which means that even in modern IE, it's not possible
+ * to programatically create a backward selection. Thus, for all IE
+ * versions, we use the old IE API to create our selections.
+ *
+ * @param {DOMElement|DOMTextNode} node
+ * @param {object} offsets
+ */
+function setModernOffsets(node, offsets) {
+  var selection = window.getSelection();
+
+  var length = node[getTextContentAccessor()].length;
+  var start = Math.min(offsets.start, length);
+  var end = typeof offsets.end === 'undefined' ?
+            start : Math.min(offsets.end, length);
+
+  // IE 11 uses modern selection, but doesn't support the extend method.
+  // Flip backward selections, so we can set with a single range.
+  if (!selection.extend && start > end) {
+    var temp = end;
+    end = start;
+    start = temp;
+  }
+
+  var startMarker = getNodeForCharacterOffset(node, start);
+  var endMarker = getNodeForCharacterOffset(node, end);
+
+  if (startMarker && endMarker) {
+    var range = document.createRange();
+    range.setStart(startMarker.node, startMarker.offset);
+    selection.removeAllRanges();
+
+    if (start > end) {
+      selection.addRange(range);
+      selection.extend(endMarker.node, endMarker.offset);
+    } else {
+      range.setEnd(endMarker.node, endMarker.offset);
+      selection.addRange(range);
+    }
+
+    range.detach();
+  }
+}
+
+var ReactDOMSelection = {
+  /**
+   * @param {DOMElement} node
+   */
+  getOffsets: function(node) {
+    var getOffsets = document.selection ? getIEOffsets : getModernOffsets;
+    return getOffsets(node);
+  },
+
+  /**
+   * @param {DOMElement|DOMTextNode} node
+   * @param {object} offsets
+   */
+  setOffsets: function(node, offsets) {
+    var setOffsets = document.selection ? setIEOffsets : setModernOffsets;
+    setOffsets(node, offsets);
+  }
+};
+
+module.exports = ReactDOMSelection;
+
+},{"./getNodeForCharacterOffset":119,"./getTextContentAccessor":121}],46:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactDOMTextarea
+ */
+
+"use strict";
+
+var AutoFocusMixin = _dereq_("./AutoFocusMixin");
+var DOMPropertyOperations = _dereq_("./DOMPropertyOperations");
+var LinkedValueUtils = _dereq_("./LinkedValueUtils");
+var ReactBrowserComponentMixin = _dereq_("./ReactBrowserComponentMixin");
+var ReactCompositeComponent = _dereq_("./ReactCompositeComponent");
+var ReactDOM = _dereq_("./ReactDOM");
+
+var invariant = _dereq_("./invariant");
+var merge = _dereq_("./merge");
+
+var warning = _dereq_("./warning");
+
+// Store a reference to the <textarea> `ReactDOMComponent`.
+var textarea = ReactDOM.textarea;
+
+/**
+ * Implements a <textarea> native component that allows setting `value`, and
+ * `defaultValue`. This differs from the traditional DOM API because value is
+ * usually set as PCDATA children.
+ *
+ * If `value` is not supplied (or null/undefined), user actions that affect the
+ * value will trigger updates to the element.
+ *
+ * If `value` is supplied (and not null/undefined), the rendered element will
+ * not trigger updates to the element. Instead, the `value` prop must change in
+ * order for the rendered element to be updated.
+ *
+ * The rendered element will be initialized with an empty value, the prop
+ * `defaultValue` if specified, or the children content (deprecated).
+ */
+var ReactDOMTextarea = ReactCompositeComponent.createClass({
+  displayName: 'ReactDOMTextarea',
+
+  mixins: [AutoFocusMixin, LinkedValueUtils.Mixin, ReactBrowserComponentMixin],
+
+  getInitialState: function() {
+    var defaultValue = this.props.defaultValue;
+    // TODO (yungsters): Remove support for children content in <textarea>.
+    var children = this.props.children;
+    if (children != null) {
+      if ("production" !== "development") {
+        ("production" !== "development" ? warning(
+          false,
+          'Use the `defaultValue` or `value` props instead of setting ' +
+          'children on <textarea>.'
+        ) : null);
+      }
+      ("production" !== "development" ? invariant(
+        defaultValue == null,
+        'If you supply `defaultValue` on a <textarea>, do not pass children.'
+      ) : invariant(defaultValue == null));
+      if (Array.isArray(children)) {
+        ("production" !== "development" ? invariant(
+          children.length <= 1,
+          '<textarea> can only have at most one child.'
+        ) : invariant(children.length <= 1));
+        children = children[0];
+      }
+
+      defaultValue = '' + children;
+    }
+    if (defaultValue == null) {
+      defaultValue = '';
+    }
+    var value = LinkedValueUtils.getValue(this);
+    return {
+      // We save the initial value so that `ReactDOMComponent` doesn't update
+      // `textContent` (unnecessary since we update value).
+      // The initial value can be a boolean or object so that's why it's
+      // forced to be a string.
+      initialValue: '' + (value != null ? value : defaultValue),
+      value: defaultValue
+    };
+  },
+
+  shouldComponentUpdate: function() {
+    // Defer any updates to this component during the `onChange` handler.
+    return !this._isChanging;
+  },
+
+  render: function() {
+    // Clone `this.props` so we don't mutate the input.
+    var props = merge(this.props);
+    var value = LinkedValueUtils.getValue(this);
+
+    ("production" !== "development" ? invariant(
+      props.dangerouslySetInnerHTML == null,
+      '`dangerouslySetInnerHTML` does not make sense on <textarea>.'
+    ) : invariant(props.dangerouslySetInnerHTML == null));
+
+    props.defaultValue = null;
+    props.value = value != null ? value : this.state.value;
+    props.onChange = this._handleChange;
+
+    // Always set children to the same thing. In IE9, the selection range will
+    // get reset if `textContent` is mutated.
+    return textarea(props, this.state.initialValue);
+  },
+
+  componentDidUpdate: function(prevProps, prevState, prevContext) {
+    var value = LinkedValueUtils.getValue(this);
+    if (value != null) {
+      var rootNode = this.getDOMNode();
+      // Cast `value` to a string to ensure the value is set correctly. While
+      // browsers typically do this as necessary, jsdom doesn't.
+      DOMPropertyOperations.setValueForProperty(rootNode, 'value', '' + value);
+    }
+  },
+
+  _handleChange: function(event) {
+    var returnValue;
+    var onChange = LinkedValueUtils.getOnChange(this);
+    if (onChange) {
+      this._isChanging = true;
+      returnValue = onChange.call(this, event);
+      this._isChanging = false;
+    }
+    this.setState({value: event.target.value});
+    return returnValue;
+  }
+
+});
+
+module.exports = ReactDOMTextarea;
+
+},{"./AutoFocusMixin":1,"./DOMPropertyOperations":10,"./LinkedValueUtils":23,"./ReactBrowserComponentMixin":27,"./ReactCompositeComponent":33,"./ReactDOM":36,"./invariant":125,"./merge":134,"./warning":148}],47:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactDefaultBatchingStrategy
+ */
+
+"use strict";
+
+var ReactUpdates = _dereq_("./ReactUpdates");
+var Transaction = _dereq_("./Transaction");
+
+var emptyFunction = _dereq_("./emptyFunction");
+var mixInto = _dereq_("./mixInto");
+
+var RESET_BATCHED_UPDATES = {
+  initialize: emptyFunction,
+  close: function() {
+    ReactDefaultBatchingStrategy.isBatchingUpdates = false;
+  }
+};
+
+var FLUSH_BATCHED_UPDATES = {
+  initialize: emptyFunction,
+  close: ReactUpdates.flushBatchedUpdates.bind(ReactUpdates)
+};
+
+var TRANSACTION_WRAPPERS = [FLUSH_BATCHED_UPDATES, RESET_BATCHED_UPDATES];
+
+function ReactDefaultBatchingStrategyTransaction() {
+  this.reinitializeTransaction();
+}
+
+mixInto(ReactDefaultBatchingStrategyTransaction, Transaction.Mixin);
+mixInto(ReactDefaultBatchingStrategyTransaction, {
+  getTransactionWrappers: function() {
+    return TRANSACTION_WRAPPERS;
+  }
+});
+
+var transaction = new ReactDefaultBatchingStrategyTransaction();
+
+var ReactDefaultBatchingStrategy = {
+  isBatchingUpdates: false,
+
+  /**
+   * Call the provided function in a context within which calls to `setState`
+   * and friends are batched such that components aren't updated unnecessarily.
+   */
+  batchedUpdates: function(callback, param) {
+    var alreadyBatchingUpdates = ReactDefaultBatchingStrategy.isBatchingUpdates;
+
+    ReactDefaultBatchingStrategy.isBatchingUpdates = true;
+
+    // The code is written this way to avoid extra allocations
+    if (alreadyBatchingUpdates) {
+      callback(param);
+    } else {
+      transaction.perform(callback, null, param);
+    }
+  }
+};
+
+module.exports = ReactDefaultBatchingStrategy;
+
+},{"./ReactUpdates":81,"./Transaction":96,"./emptyFunction":109,"./mixInto":137}],48:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactDefaultInjection
+ */
+
+"use strict";
+
+var ReactInjection = _dereq_("./ReactInjection");
+
+var ExecutionEnvironment = _dereq_("./ExecutionEnvironment");
+
+var DefaultDOMPropertyConfig = _dereq_("./DefaultDOMPropertyConfig");
+
+var ChangeEventPlugin = _dereq_("./ChangeEventPlugin");
+var ClientReactRootIndex = _dereq_("./ClientReactRootIndex");
+var CompositionEventPlugin = _dereq_("./CompositionEventPlugin");
+var DefaultEventPluginOrder = _dereq_("./DefaultEventPluginOrder");
+var EnterLeaveEventPlugin = _dereq_("./EnterLeaveEventPlugin");
+var MobileSafariClickEventPlugin = _dereq_("./MobileSafariClickEventPlugin");
+var ReactBrowserComponentMixin = _dereq_("./ReactBrowserComponentMixin");
+var ReactComponentBrowserEnvironment =
+  _dereq_("./ReactComponentBrowserEnvironment");
+var ReactEventTopLevelCallback = _dereq_("./ReactEventTopLevelCallback");
+var ReactDOM = _dereq_("./ReactDOM");
+var ReactDOMButton = _dereq_("./ReactDOMButton");
+var ReactDOMForm = _dereq_("./ReactDOMForm");
+var ReactDOMImg = _dereq_("./ReactDOMImg");
+var ReactDOMInput = _dereq_("./ReactDOMInput");
+var ReactDOMOption = _dereq_("./ReactDOMOption");
+var ReactDOMSelect = _dereq_("./ReactDOMSelect");
+var ReactDOMTextarea = _dereq_("./ReactDOMTextarea");
+var ReactInstanceHandles = _dereq_("./ReactInstanceHandles");
+var ReactMount = _dereq_("./ReactMount");
+var SelectEventPlugin = _dereq_("./SelectEventPlugin");
+var ServerReactRootIndex = _dereq_("./ServerReactRootIndex");
+var SimpleEventPlugin = _dereq_("./SimpleEventPlugin");
+
+var ReactDefaultBatchingStrategy = _dereq_("./ReactDefaultBatchingStrategy");
+
+var createFullPageComponent = _dereq_("./createFullPageComponent");
+
+function inject() {
+  ReactInjection.EventEmitter.injectTopLevelCallbackCreator(
+    ReactEventTopLevelCallback
+  );
+
+  /**
+   * Inject modules for resolving DOM hierarchy and plugin ordering.
+   */
+  ReactInjection.EventPluginHub.injectEventPluginOrder(DefaultEventPluginOrder);
+  ReactInjection.EventPluginHub.injectInstanceHandle(ReactInstanceHandles);
+  ReactInjection.EventPluginHub.injectMount(ReactMount);
+
+  /**
+   * Some important event plugins included by default (without having to require
+   * them).
+   */
+  ReactInjection.EventPluginHub.injectEventPluginsByName({
+    SimpleEventPlugin: SimpleEventPlugin,
+    EnterLeaveEventPlugin: EnterLeaveEventPlugin,
+    ChangeEventPlugin: ChangeEventPlugin,
+    CompositionEventPlugin: CompositionEventPlugin,
+    MobileSafariClickEventPlugin: MobileSafariClickEventPlugin,
+    SelectEventPlugin: SelectEventPlugin
+  });
+
+  ReactInjection.DOM.injectComponentClasses({
+    button: ReactDOMButton,
+    form: ReactDOMForm,
+    img: ReactDOMImg,
+    input: ReactDOMInput,
+    option: ReactDOMOption,
+    select: ReactDOMSelect,
+    textarea: ReactDOMTextarea,
+
+    html: createFullPageComponent(ReactDOM.html),
+    head: createFullPageComponent(ReactDOM.head),
+    title: createFullPageComponent(ReactDOM.title),
+    body: createFullPageComponent(ReactDOM.body)
+  });
+
+
+  // This needs to happen after createFullPageComponent() otherwise the mixin
+  // gets double injected.
+  ReactInjection.CompositeComponent.injectMixin(ReactBrowserComponentMixin);
+
+  ReactInjection.DOMProperty.injectDOMPropertyConfig(DefaultDOMPropertyConfig);
+
+  ReactInjection.Updates.injectBatchingStrategy(
+    ReactDefaultBatchingStrategy
+  );
+
+  ReactInjection.RootIndex.injectCreateReactRootIndex(
+    ExecutionEnvironment.canUseDOM ?
+      ClientReactRootIndex.createReactRootIndex :
+      ServerReactRootIndex.createReactRootIndex
+  );
+
+  ReactInjection.Component.injectEnvironment(ReactComponentBrowserEnvironment);
+
+  if ("production" !== "development") {
+    var url = (ExecutionEnvironment.canUseDOM && window.location.href) || '';
+    if ((/[?&]react_perf\b/).test(url)) {
+      var ReactDefaultPerf = _dereq_("./ReactDefaultPerf");
+      ReactDefaultPerf.start();
+    }
+  }
+}
+
+module.exports = {
+  inject: inject
+};
+
+},{"./ChangeEventPlugin":5,"./ClientReactRootIndex":6,"./CompositionEventPlugin":7,"./DefaultDOMPropertyConfig":12,"./DefaultEventPluginOrder":13,"./EnterLeaveEventPlugin":14,"./ExecutionEnvironment":21,"./MobileSafariClickEventPlugin":24,"./ReactBrowserComponentMixin":27,"./ReactComponentBrowserEnvironment":32,"./ReactDOM":36,"./ReactDOMButton":37,"./ReactDOMForm":39,"./ReactDOMImg":41,"./ReactDOMInput":42,"./ReactDOMOption":43,"./ReactDOMSelect":44,"./ReactDOMTextarea":46,"./ReactDefaultBatchingStrategy":47,"./ReactDefaultPerf":49,"./ReactEventTopLevelCallback":54,"./ReactInjection":55,"./ReactInstanceHandles":57,"./ReactMount":60,"./SelectEventPlugin":83,"./ServerReactRootIndex":84,"./SimpleEventPlugin":85,"./createFullPageComponent":104}],49:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactDefaultPerf
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var DOMProperty = _dereq_("./DOMProperty");
+var ReactDefaultPerfAnalysis = _dereq_("./ReactDefaultPerfAnalysis");
+var ReactMount = _dereq_("./ReactMount");
+var ReactPerf = _dereq_("./ReactPerf");
+
+var performanceNow = _dereq_("./performanceNow");
+
+function roundFloat(val) {
+  return Math.floor(val * 100) / 100;
+}
+
+var ReactDefaultPerf = {
+  _allMeasurements: [], // last item in the list is the current one
+  _injected: false,
+
+  start: function() {
+    if (!ReactDefaultPerf._injected) {
+      ReactPerf.injection.injectMeasure(ReactDefaultPerf.measure);
+    }
+
+    ReactDefaultPerf._allMeasurements.length = 0;
+    ReactPerf.enableMeasure = true;
+  },
+
+  stop: function() {
+    ReactPerf.enableMeasure = false;
+  },
+
+  getLastMeasurements: function() {
+    return ReactDefaultPerf._allMeasurements;
+  },
+
+  printExclusive: function(measurements) {
+    measurements = measurements || ReactDefaultPerf._allMeasurements;
+    var summary = ReactDefaultPerfAnalysis.getExclusiveSummary(measurements);
+    console.table(summary.map(function(item) {
+      return {
+        'Component class name': item.componentName,
+        'Total inclusive time (ms)': roundFloat(item.inclusive),
+        'Total exclusive time (ms)': roundFloat(item.exclusive),
+        'Exclusive time per instance (ms)': roundFloat(item.exclusive / item.count),
+        'Instances': item.count
+      };
+    }));
+    console.log(
+      'Total time:',
+      ReactDefaultPerfAnalysis.getTotalTime(measurements).toFixed(2) + ' ms'
+    );
+  },
+
+  printInclusive: function(measurements) {
+    measurements = measurements || ReactDefaultPerf._allMeasurements;
+    var summary = ReactDefaultPerfAnalysis.getInclusiveSummary(measurements);
+    console.table(summary.map(function(item) {
+      return {
+        'Owner > component': item.componentName,
+        'Inclusive time (ms)': roundFloat(item.time),
+        'Instances': item.count
+      };
+    }));
+    console.log(
+      'Total time:',
+      ReactDefaultPerfAnalysis.getTotalTime(measurements).toFixed(2) + ' ms'
+    );
+  },
+
+  printWasted: function(measurements) {
+    measurements = measurements || ReactDefaultPerf._allMeasurements;
+    var summary = ReactDefaultPerfAnalysis.getInclusiveSummary(
+      measurements,
+      true
+    );
+    console.table(summary.map(function(item) {
+      return {
+        'Owner > component': item.componentName,
+        'Wasted time (ms)': item.time,
+        'Instances': item.count
+      };
+    }));
+    console.log(
+      'Total time:',
+      ReactDefaultPerfAnalysis.getTotalTime(measurements).toFixed(2) + ' ms'
+    );
+  },
+
+  printDOM: function(measurements) {
+    measurements = measurements || ReactDefaultPerf._allMeasurements;
+    var summary = ReactDefaultPerfAnalysis.getDOMSummary(measurements);
+    console.table(summary.map(function(item) {
+      var result = {};
+      result[DOMProperty.ID_ATTRIBUTE_NAME] = item.id;
+      result['type'] = item.type;
+      result['args'] = JSON.stringify(item.args);
+      return result;
+    }));
+    console.log(
+      'Total time:',
+      ReactDefaultPerfAnalysis.getTotalTime(measurements).toFixed(2) + ' ms'
+    );
+  },
+
+  _recordWrite: function(id, fnName, totalTime, args) {
+    // TODO: totalTime isn't that useful since it doesn't count paints/reflows
+    var writes =
+      ReactDefaultPerf
+        ._allMeasurements[ReactDefaultPerf._allMeasurements.length - 1]
+        .writes;
+    writes[id] = writes[id] || [];
+    writes[id].push({
+      type: fnName,
+      time: totalTime,
+      args: args
+    });
+  },
+
+  measure: function(moduleName, fnName, func) {
+    return function() {var args=Array.prototype.slice.call(arguments,0);
+      var totalTime;
+      var rv;
+      var start;
+
+      if (fnName === '_renderNewRootComponent' ||
+          fnName === 'flushBatchedUpdates') {
+        // A "measurement" is a set of metrics recorded for each flush. We want
+        // to group the metrics for a given flush together so we can look at the
+        // components that rendered and the DOM operations that actually
+        // happened to determine the amount of "wasted work" performed.
+        ReactDefaultPerf._allMeasurements.push({
+          exclusive: {},
+          inclusive: {},
+          counts: {},
+          writes: {},
+          displayNames: {},
+          totalTime: 0
+        });
+        start = performanceNow();
+        rv = func.apply(this, args);
+        ReactDefaultPerf._allMeasurements[
+          ReactDefaultPerf._allMeasurements.length - 1
+        ].totalTime = performanceNow() - start;
+        return rv;
+      } else if (moduleName === 'ReactDOMIDOperations' ||
+        moduleName === 'ReactComponentBrowserEnvironment') {
+        start = performanceNow();
+        rv = func.apply(this, args);
+        totalTime = performanceNow() - start;
+
+        if (fnName === 'mountImageIntoNode') {
+          var mountID = ReactMount.getID(args[1]);
+          ReactDefaultPerf._recordWrite(mountID, fnName, totalTime, args[0]);
+        } else if (fnName === 'dangerouslyProcessChildrenUpdates') {
+          // special format
+          args[0].forEach(function(update) {
+            var writeArgs = {};
+            if (update.fromIndex !== null) {
+              writeArgs.fromIndex = update.fromIndex;
+            }
+            if (update.toIndex !== null) {
+              writeArgs.toIndex = update.toIndex;
+            }
+            if (update.textContent !== null) {
+              writeArgs.textContent = update.textContent;
+            }
+            if (update.markupIndex !== null) {
+              writeArgs.markup = args[1][update.markupIndex];
+            }
+            ReactDefaultPerf._recordWrite(
+              update.parentID,
+              update.type,
+              totalTime,
+              writeArgs
+            );
+          });
+        } else {
+          // basic format
+          ReactDefaultPerf._recordWrite(
+            args[0],
+            fnName,
+            totalTime,
+            Array.prototype.slice.call(args, 1)
+          );
+        }
+        return rv;
+      } else if (moduleName === 'ReactCompositeComponent' && (
+        fnName === 'mountComponent' ||
+        fnName === 'updateComponent' || // TODO: receiveComponent()?
+        fnName === '_renderValidatedComponent')) {
+
+        var rootNodeID = fnName === 'mountComponent' ?
+          args[0] :
+          this._rootNodeID;
+        var isRender = fnName === '_renderValidatedComponent';
+        var entry = ReactDefaultPerf._allMeasurements[
+          ReactDefaultPerf._allMeasurements.length - 1
+        ];
+
+        if (isRender) {
+          entry.counts[rootNodeID] = entry.counts[rootNodeID] || 0;
+          entry.counts[rootNodeID] += 1;
+        }
+
+        start = performanceNow();
+        rv = func.apply(this, args);
+        totalTime = performanceNow() - start;
+
+        var typeOfLog = isRender ? entry.exclusive : entry.inclusive;
+        typeOfLog[rootNodeID] = typeOfLog[rootNodeID] || 0;
+        typeOfLog[rootNodeID] += totalTime;
+
+        entry.displayNames[rootNodeID] = {
+          current: this.constructor.displayName,
+          owner: this._owner ? this._owner.constructor.displayName : '<root>'
+        };
+
+        return rv;
+      } else {
+        return func.apply(this, args);
+      }
+    };
+  }
+};
+
+module.exports = ReactDefaultPerf;
+
+},{"./DOMProperty":9,"./ReactDefaultPerfAnalysis":50,"./ReactMount":60,"./ReactPerf":65,"./performanceNow":142}],50:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactDefaultPerfAnalysis
+ */
+
+var merge = _dereq_("./merge");
+
+// Don't try to save users less than 1.2ms (a number I made up)
+var DONT_CARE_THRESHOLD = 1.2;
+var DOM_OPERATION_TYPES = {
+  'mountImageIntoNode': 'set innerHTML',
+  INSERT_MARKUP: 'set innerHTML',
+  MOVE_EXISTING: 'move',
+  REMOVE_NODE: 'remove',
+  TEXT_CONTENT: 'set textContent',
+  'updatePropertyByID': 'update attribute',
+  'deletePropertyByID': 'delete attribute',
+  'updateStylesByID': 'update styles',
+  'updateInnerHTMLByID': 'set innerHTML',
+  'dangerouslyReplaceNodeWithMarkupByID': 'replace'
+};
+
+function getTotalTime(measurements) {
+  // TODO: return number of DOM ops? could be misleading.
+  // TODO: measure dropped frames after reconcile?
+  // TODO: log total time of each reconcile and the top-level component
+  // class that triggered it.
+  var totalTime = 0;
+  for (var i = 0; i < measurements.length; i++) {
+    var measurement = measurements[i];
+    totalTime += measurement.totalTime;
+  }
+  return totalTime;
+}
+
+function getDOMSummary(measurements) {
+  var items = [];
+  for (var i = 0; i < measurements.length; i++) {
+    var measurement = measurements[i];
+    var id;
+
+    for (id in measurement.writes) {
+      measurement.writes[id].forEach(function(write) {
+        items.push({
+          id: id,
+          type: DOM_OPERATION_TYPES[write.type] || write.type,
+          args: write.args
+        });
+      });
+    }
+  }
+  return items;
+}
+
+function getExclusiveSummary(measurements) {
+  var candidates = {};
+  var displayName;
+
+  for (var i = 0; i < measurements.length; i++) {
+    var measurement = measurements[i];
+    var allIDs = merge(measurement.exclusive, measurement.inclusive);
+
+    for (var id in allIDs) {
+      displayName = measurement.displayNames[id].current;
+
+      candidates[displayName] = candidates[displayName] || {
+        componentName: displayName,
+        inclusive: 0,
+        exclusive: 0,
+        count: 0
+      };
+      if (measurement.exclusive[id]) {
+        candidates[displayName].exclusive += measurement.exclusive[id];
+      }
+      if (measurement.inclusive[id]) {
+        candidates[displayName].inclusive += measurement.inclusive[id];
+      }
+      if (measurement.counts[id]) {
+        candidates[displayName].count += measurement.counts[id];
+      }
+    }
+  }
+
+  // Now make a sorted array with the results.
+  var arr = [];
+  for (displayName in candidates) {
+    if (candidates[displayName].exclusive >= DONT_CARE_THRESHOLD) {
+      arr.push(candidates[displayName]);
+    }
+  }
+
+  arr.sort(function(a, b) {
+    return b.exclusive - a.exclusive;
+  });
+
+  return arr;
+}
+
+function getInclusiveSummary(measurements, onlyClean) {
+  var candidates = {};
+  var inclusiveKey;
+
+  for (var i = 0; i < measurements.length; i++) {
+    var measurement = measurements[i];
+    var allIDs = merge(measurement.exclusive, measurement.inclusive);
+    var cleanComponents;
+
+    if (onlyClean) {
+      cleanComponents = getUnchangedComponents(measurement);
+    }
+
+    for (var id in allIDs) {
+      if (onlyClean && !cleanComponents[id]) {
+        continue;
+      }
+
+      var displayName = measurement.displayNames[id];
+
+      // Inclusive time is not useful for many components without knowing where
+      // they are instantiated. So we aggregate inclusive time with both the
+      // owner and current displayName as the key.
+      inclusiveKey = displayName.owner + ' > ' + displayName.current;
+
+      candidates[inclusiveKey] = candidates[inclusiveKey] || {
+        componentName: inclusiveKey,
+        time: 0,
+        count: 0
+      };
+
+      if (measurement.inclusive[id]) {
+        candidates[inclusiveKey].time += measurement.inclusive[id];
+      }
+      if (measurement.counts[id]) {
+        candidates[inclusiveKey].count += measurement.counts[id];
+      }
+    }
+  }
+
+  // Now make a sorted array with the results.
+  var arr = [];
+  for (inclusiveKey in candidates) {
+    if (candidates[inclusiveKey].time >= DONT_CARE_THRESHOLD) {
+      arr.push(candidates[inclusiveKey]);
+    }
+  }
+
+  arr.sort(function(a, b) {
+    return b.time - a.time;
+  });
+
+  return arr;
+}
+
+function getUnchangedComponents(measurement) {
+  // For a given reconcile, look at which components did not actually
+  // render anything to the DOM and return a mapping of their ID to
+  // the amount of time it took to render the entire subtree.
+  var cleanComponents = {};
+  var dirtyLeafIDs = Object.keys(measurement.writes);
+  var allIDs = merge(measurement.exclusive, measurement.inclusive);
+
+  for (var id in allIDs) {
+    var isDirty = false;
+    // For each component that rendered, see if a component that triggerd
+    // a DOM op is in its subtree.
+    for (var i = 0; i < dirtyLeafIDs.length; i++) {
+      if (dirtyLeafIDs[i].indexOf(id) === 0) {
+        isDirty = true;
+        break;
+      }
+    }
+    if (!isDirty && measurement.counts[id] > 0) {
+      cleanComponents[id] = true;
+    }
+  }
+  return cleanComponents;
+}
+
+var ReactDefaultPerfAnalysis = {
+  getExclusiveSummary: getExclusiveSummary,
+  getInclusiveSummary: getInclusiveSummary,
+  getDOMSummary: getDOMSummary,
+  getTotalTime: getTotalTime
+};
+
+module.exports = ReactDefaultPerfAnalysis;
+
+},{"./merge":134}],51:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactErrorUtils
+ * @typechecks
+ */
+
+"use strict";
+
+var ReactErrorUtils = {
+  /**
+   * Creates a guarded version of a function. This is supposed to make debugging
+   * of event handlers easier. To aid debugging with the browser's debugger,
+   * this currently simply returns the original function.
+   *
+   * @param {function} func Function to be executed
+   * @param {string} name The name of the guard
+   * @return {function}
+   */
+  guard: function(func, name) {
+    return func;
+  }
+};
+
+module.exports = ReactErrorUtils;
+
+},{}],52:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactEventEmitter
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var EventConstants = _dereq_("./EventConstants");
+var EventListener = _dereq_("./EventListener");
+var EventPluginHub = _dereq_("./EventPluginHub");
+var EventPluginRegistry = _dereq_("./EventPluginRegistry");
+var ExecutionEnvironment = _dereq_("./ExecutionEnvironment");
+var ReactEventEmitterMixin = _dereq_("./ReactEventEmitterMixin");
+var ViewportMetrics = _dereq_("./ViewportMetrics");
+
+var invariant = _dereq_("./invariant");
+var isEventSupported = _dereq_("./isEventSupported");
+var merge = _dereq_("./merge");
+
+/**
+ * Summary of `ReactEventEmitter` event handling:
+ *
+ *  - Top-level delegation is used to trap native browser events. We normalize
+ *    and de-duplicate events to account for browser quirks.
+ *
+ *  - Forward these native events (with the associated top-level type used to
+ *    trap it) to `EventPluginHub`, which in turn will ask plugins if they want
+ *    to extract any synthetic events.
+ *
+ *  - The `EventPluginHub` will then process each event by annotating them with
+ *    "dispatches", a sequence of listeners and IDs that care about that event.
+ *
+ *  - The `EventPluginHub` then dispatches the events.
+ *
+ * Overview of React and the event system:
+ *
+ *                   .
+ * +------------+    .
+ * |    DOM     |    .
+ * +------------+    .                         +-----------+
+ *       +           .               +--------+|SimpleEvent|
+ *       |           .               |         |Plugin     |
+ * +-----|------+    .               v         +-----------+
+ * |     |      |    .    +--------------+                    +------------+
+ * |     +-----------.--->|EventPluginHub|                    |    Event   |
+ * |            |    .    |              |     +-----------+  | Propagators|
+ * | ReactEvent |    .    |              |     |TapEvent   |  |------------|
+ * |  Emitter   |    .    |              |<---+|Plugin     |  |other plugin|
+ * |            |    .    |              |     +-----------+  |  utilities |
+ * |     +-----------.--->|              |                    +------------+
+ * |     |      |    .    +--------------+
+ * +-----|------+    .                ^        +-----------+
+ *       |           .                |        |Enter/Leave|
+ *       +           .                +-------+|Plugin     |
+ * +-------------+   .                         +-----------+
+ * | application |   .
+ * |-------------|   .
+ * |             |   .
+ * |             |   .
+ * +-------------+   .
+ *                   .
+ *    React Core     .  General Purpose Event Plugin System
+ */
+
+var alreadyListeningTo = {};
+var isMonitoringScrollValue = false;
+var reactTopListenersCounter = 0;
+
+// For events like 'submit' which don't consistently bubble (which we trap at a
+// lower node than `document`), binding at `document` would cause duplicate
+// events so we don't include them here
+var topEventMapping = {
+  topBlur: 'blur',
+  topChange: 'change',
+  topClick: 'click',
+  topCompositionEnd: 'compositionend',
+  topCompositionStart: 'compositionstart',
+  topCompositionUpdate: 'compositionupdate',
+  topContextMenu: 'contextmenu',
+  topCopy: 'copy',
+  topCut: 'cut',
+  topDoubleClick: 'dblclick',
+  topDrag: 'drag',
+  topDragEnd: 'dragend',
+  topDragEnter: 'dragenter',
+  topDragExit: 'dragexit',
+  topDragLeave: 'dragleave',
+  topDragOver: 'dragover',
+  topDragStart: 'dragstart',
+  topDrop: 'drop',
+  topFocus: 'focus',
+  topInput: 'input',
+  topKeyDown: 'keydown',
+  topKeyPress: 'keypress',
+  topKeyUp: 'keyup',
+  topMouseDown: 'mousedown',
+  topMouseMove: 'mousemove',
+  topMouseOut: 'mouseout',
+  topMouseOver: 'mouseover',
+  topMouseUp: 'mouseup',
+  topPaste: 'paste',
+  topScroll: 'scroll',
+  topSelectionChange: 'selectionchange',
+  topTouchCancel: 'touchcancel',
+  topTouchEnd: 'touchend',
+  topTouchMove: 'touchmove',
+  topTouchStart: 'touchstart',
+  topWheel: 'wheel'
+};
+
+/**
+ * To ensure no conflicts with other potential React instances on the page
+ */
+var topListenersIDKey = "_reactListenersID" + String(Math.random()).slice(2);
+
+function getListeningForDocument(mountAt) {
+  if (mountAt[topListenersIDKey] == null) {
+    mountAt[topListenersIDKey] = reactTopListenersCounter++;
+    alreadyListeningTo[mountAt[topListenersIDKey]] = {};
+  }
+  return alreadyListeningTo[mountAt[topListenersIDKey]];
+}
+
+/**
+ * Traps top-level events by using event bubbling.
+ *
+ * @param {string} topLevelType Record from `EventConstants`.
+ * @param {string} handlerBaseName Event name (e.g. "click").
+ * @param {DOMEventTarget} element Element on which to attach listener.
+ * @internal
+ */
+function trapBubbledEvent(topLevelType, handlerBaseName, element) {
+  EventListener.listen(
+    element,
+    handlerBaseName,
+    ReactEventEmitter.TopLevelCallbackCreator.createTopLevelCallback(
+      topLevelType
+    )
+  );
+}
+
+/**
+ * Traps a top-level event by using event capturing.
+ *
+ * @param {string} topLevelType Record from `EventConstants`.
+ * @param {string} handlerBaseName Event name (e.g. "click").
+ * @param {DOMEventTarget} element Element on which to attach listener.
+ * @internal
+ */
+function trapCapturedEvent(topLevelType, handlerBaseName, element) {
+  EventListener.capture(
+    element,
+    handlerBaseName,
+    ReactEventEmitter.TopLevelCallbackCreator.createTopLevelCallback(
+      topLevelType
+    )
+  );
+}
+
+/**
+ * `ReactEventEmitter` is used to attach top-level event listeners. For example:
+ *
+ *   ReactEventEmitter.putListener('myID', 'onClick', myFunction);
+ *
+ * This would allocate a "registration" of `('onClick', myFunction)` on 'myID'.
+ *
+ * @internal
+ */
+var ReactEventEmitter = merge(ReactEventEmitterMixin, {
+
+  /**
+   * React references `ReactEventTopLevelCallback` using this property in order
+   * to allow dependency injection.
+   */
+  TopLevelCallbackCreator: null,
+
+  injection: {
+    /**
+     * @param {function} TopLevelCallbackCreator
+     */
+    injectTopLevelCallbackCreator: function(TopLevelCallbackCreator) {
+      ReactEventEmitter.TopLevelCallbackCreator = TopLevelCallbackCreator;
+    }
+  },
+
+  /**
+   * Sets whether or not any created callbacks should be enabled.
+   *
+   * @param {boolean} enabled True if callbacks should be enabled.
+   */
+  setEnabled: function(enabled) {
+    ("production" !== "development" ? invariant(
+      ExecutionEnvironment.canUseDOM,
+      'setEnabled(...): Cannot toggle event listening in a Worker thread. ' +
+      'This is likely a bug in the framework. Please report immediately.'
+    ) : invariant(ExecutionEnvironment.canUseDOM));
+    if (ReactEventEmitter.TopLevelCallbackCreator) {
+      ReactEventEmitter.TopLevelCallbackCreator.setEnabled(enabled);
+    }
+  },
+
+  /**
+   * @return {boolean} True if callbacks are enabled.
+   */
+  isEnabled: function() {
+    return !!(
+      ReactEventEmitter.TopLevelCallbackCreator &&
+      ReactEventEmitter.TopLevelCallbackCreator.isEnabled()
+    );
+  },
+
+  /**
+   * We listen for bubbled touch events on the document object.
+   *
+   * Firefox v8.01 (and possibly others) exhibited strange behavior when
+   * mounting `onmousemove` events at some node that was not the document
+   * element. The symptoms were that if your mouse is not moving over something
+   * contained within that mount point (for example on the background) the
+   * top-level listeners for `onmousemove` won't be called. However, if you
+   * register the `mousemove` on the document object, then it will of course
+   * catch all `mousemove`s. This along with iOS quirks, justifies restricting
+   * top-level listeners to the document object only, at least for these
+   * movement types of events and possibly all events.
+   *
+   * @see http://www.quirksmode.org/blog/archives/2010/09/click_event_del.html
+   *
+   * Also, `keyup`/`keypress`/`keydown` do not bubble to the window on IE, but
+   * they bubble to document.
+   *
+   * @param {string} registrationName Name of listener (e.g. `onClick`).
+   * @param {DOMDocument} contentDocument Document which owns the container
+   */
+  listenTo: function(registrationName, contentDocument) {
+    var mountAt = contentDocument;
+    var isListening = getListeningForDocument(mountAt);
+    var dependencies = EventPluginRegistry.
+      registrationNameDependencies[registrationName];
+
+    var topLevelTypes = EventConstants.topLevelTypes;
+    for (var i = 0, l = dependencies.length; i < l; i++) {
+      var dependency = dependencies[i];
+      if (!isListening[dependency]) {
+        var topLevelType = topLevelTypes[dependency];
+
+        if (topLevelType === topLevelTypes.topWheel) {
+          if (isEventSupported('wheel')) {
+            trapBubbledEvent(topLevelTypes.topWheel, 'wheel', mountAt);
+          } else if (isEventSupported('mousewheel')) {
+            trapBubbledEvent(topLevelTypes.topWheel, 'mousewheel', mountAt);
+          } else {
+            // Firefox needs to capture a different mouse scroll event.
+            // @see http://www.quirksmode.org/dom/events/tests/scroll.html
+            trapBubbledEvent(
+              topLevelTypes.topWheel,
+              'DOMMouseScroll',
+              mountAt);
+          }
+        } else if (topLevelType === topLevelTypes.topScroll) {
+
+          if (isEventSupported('scroll', true)) {
+            trapCapturedEvent(topLevelTypes.topScroll, 'scroll', mountAt);
+          } else {
+            trapBubbledEvent(topLevelTypes.topScroll, 'scroll', window);
+          }
+        } else if (topLevelType === topLevelTypes.topFocus ||
+            topLevelType === topLevelTypes.topBlur) {
+
+          if (isEventSupported('focus', true)) {
+            trapCapturedEvent(topLevelTypes.topFocus, 'focus', mountAt);
+            trapCapturedEvent(topLevelTypes.topBlur, 'blur', mountAt);
+          } else if (isEventSupported('focusin')) {
+            // IE has `focusin` and `focusout` events which bubble.
+            // @see http://www.quirksmode.org/blog/archives/2008/04/delegating_the.html
+            trapBubbledEvent(topLevelTypes.topFocus, 'focusin', mountAt);
+            trapBubbledEvent(topLevelTypes.topBlur, 'focusout', mountAt);
+          }
+
+          // to make sure blur and focus event listeners are only attached once
+          isListening[topLevelTypes.topBlur] = true;
+          isListening[topLevelTypes.topFocus] = true;
+        } else if (topEventMapping[dependency]) {
+          trapBubbledEvent(topLevelType, topEventMapping[dependency], mountAt);
+        }
+
+        isListening[dependency] = true;
+      }
+    }
+  },
+
+  /**
+   * Listens to window scroll and resize events. We cache scroll values so that
+   * application code can access them without triggering reflows.
+   *
+   * NOTE: Scroll events do not bubble.
+   *
+   * @see http://www.quirksmode.org/dom/events/scroll.html
+   */
+  ensureScrollValueMonitoring: function(){
+    if (!isMonitoringScrollValue) {
+      var refresh = ViewportMetrics.refreshScrollValues;
+      EventListener.listen(window, 'scroll', refresh);
+      EventListener.listen(window, 'resize', refresh);
+      isMonitoringScrollValue = true;
+    }
+  },
+
+  eventNameDispatchConfigs: EventPluginHub.eventNameDispatchConfigs,
+
+  registrationNameModules: EventPluginHub.registrationNameModules,
+
+  putListener: EventPluginHub.putListener,
+
+  getListener: EventPluginHub.getListener,
+
+  deleteListener: EventPluginHub.deleteListener,
+
+  deleteAllListeners: EventPluginHub.deleteAllListeners,
+
+  trapBubbledEvent: trapBubbledEvent,
+
+  trapCapturedEvent: trapCapturedEvent
+
+});
+
+module.exports = ReactEventEmitter;
+
+},{"./EventConstants":15,"./EventListener":16,"./EventPluginHub":17,"./EventPluginRegistry":18,"./ExecutionEnvironment":21,"./ReactEventEmitterMixin":53,"./ViewportMetrics":97,"./invariant":125,"./isEventSupported":126,"./merge":134}],53:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactEventEmitterMixin
+ */
+
+"use strict";
+
+var EventPluginHub = _dereq_("./EventPluginHub");
+var ReactUpdates = _dereq_("./ReactUpdates");
+
+function runEventQueueInBatch(events) {
+  EventPluginHub.enqueueEvents(events);
+  EventPluginHub.processEventQueue();
+}
+
+var ReactEventEmitterMixin = {
+
+  /**
+   * Streams a fired top-level event to `EventPluginHub` where plugins have the
+   * opportunity to create `ReactEvent`s to be dispatched.
+   *
+   * @param {string} topLevelType Record from `EventConstants`.
+   * @param {object} topLevelTarget The listening component root node.
+   * @param {string} topLevelTargetID ID of `topLevelTarget`.
+   * @param {object} nativeEvent Native environment event.
+   */
+  handleTopLevel: function(
+      topLevelType,
+      topLevelTarget,
+      topLevelTargetID,
+      nativeEvent) {
+    var events = EventPluginHub.extractEvents(
+      topLevelType,
+      topLevelTarget,
+      topLevelTargetID,
+      nativeEvent
+    );
+
+    // Event queue being processed in the same cycle allows `preventDefault`.
+    ReactUpdates.batchedUpdates(runEventQueueInBatch, events);
+  }
+};
+
+module.exports = ReactEventEmitterMixin;
+
+},{"./EventPluginHub":17,"./ReactUpdates":81}],54:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactEventTopLevelCallback
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var PooledClass = _dereq_("./PooledClass");
+var ReactEventEmitter = _dereq_("./ReactEventEmitter");
+var ReactInstanceHandles = _dereq_("./ReactInstanceHandles");
+var ReactMount = _dereq_("./ReactMount");
+
+var getEventTarget = _dereq_("./getEventTarget");
+var mixInto = _dereq_("./mixInto");
+
+/**
+ * @type {boolean}
+ * @private
+ */
+var _topLevelListenersEnabled = true;
+
+/**
+ * Finds the parent React component of `node`.
+ *
+ * @param {*} node
+ * @return {?DOMEventTarget} Parent container, or `null` if the specified node
+ *                           is not nested.
+ */
+function findParent(node) {
+  // TODO: It may be a good idea to cache this to prevent unnecessary DOM
+  // traversal, but caching is difficult to do correctly without using a
+  // mutation observer to listen for all DOM changes.
+  var nodeID = ReactMount.getID(node);
+  var rootID = ReactInstanceHandles.getReactRootIDFromNodeID(nodeID);
+  var container = ReactMount.findReactContainerForID(rootID);
+  var parent = ReactMount.getFirstReactDOM(container);
+  return parent;
+}
+
+/**
+ * Calls ReactEventEmitter.handleTopLevel for each node stored in bookKeeping's
+ * ancestor list. Separated from createTopLevelCallback to avoid try/finally
+ * deoptimization.
+ *
+ * @param {string} topLevelType
+ * @param {DOMEvent} nativeEvent
+ * @param {TopLevelCallbackBookKeeping} bookKeeping
+ */
+function handleTopLevelImpl(topLevelType, nativeEvent, bookKeeping) {
+  var topLevelTarget = ReactMount.getFirstReactDOM(
+    getEventTarget(nativeEvent)
+  ) || window;
+
+  // Loop through the hierarchy, in case there's any nested components.
+  // It's important that we build the array of ancestors before calling any
+  // event handlers, because event handlers can modify the DOM, leading to
+  // inconsistencies with ReactMount's node cache. See #1105.
+  var ancestor = topLevelTarget;
+  while (ancestor) {
+    bookKeeping.ancestors.push(ancestor);
+    ancestor = findParent(ancestor);
+  }
+
+  for (var i = 0, l = bookKeeping.ancestors.length; i < l; i++) {
+    topLevelTarget = bookKeeping.ancestors[i];
+    var topLevelTargetID = ReactMount.getID(topLevelTarget) || '';
+    ReactEventEmitter.handleTopLevel(
+      topLevelType,
+      topLevelTarget,
+      topLevelTargetID,
+      nativeEvent
+    );
+  }
+}
+
+// Used to store ancestor hierarchy in top level callback
+function TopLevelCallbackBookKeeping() {
+  this.ancestors = [];
+}
+mixInto(TopLevelCallbackBookKeeping, {
+  destructor: function() {
+    this.ancestors.length = 0;
+  }
+});
+PooledClass.addPoolingTo(TopLevelCallbackBookKeeping);
+
+/**
+ * Top-level callback creator used to implement event handling using delegation.
+ * This is used via dependency injection.
+ */
+var ReactEventTopLevelCallback = {
+
+  /**
+   * Sets whether or not any created callbacks should be enabled.
+   *
+   * @param {boolean} enabled True if callbacks should be enabled.
+   */
+  setEnabled: function(enabled) {
+    _topLevelListenersEnabled = !!enabled;
+  },
+
+  /**
+   * @return {boolean} True if callbacks are enabled.
+   */
+  isEnabled: function() {
+    return _topLevelListenersEnabled;
+  },
+
+  /**
+   * Creates a callback for the supplied `topLevelType` that could be added as
+   * a listener to the document. The callback computes a `topLevelTarget` which
+   * should be the root node of a mounted React component where the listener
+   * is attached.
+   *
+   * @param {string} topLevelType Record from `EventConstants`.
+   * @return {function} Callback for handling top-level events.
+   */
+  createTopLevelCallback: function(topLevelType) {
+    return function(nativeEvent) {
+      if (!_topLevelListenersEnabled) {
+        return;
+      }
+
+      var bookKeeping = TopLevelCallbackBookKeeping.getPooled();
+      try {
+        handleTopLevelImpl(topLevelType, nativeEvent, bookKeeping);
+      } finally {
+        TopLevelCallbackBookKeeping.release(bookKeeping);
+      }
+    };
+  }
+
+};
+
+module.exports = ReactEventTopLevelCallback;
+
+},{"./PooledClass":25,"./ReactEventEmitter":52,"./ReactInstanceHandles":57,"./ReactMount":60,"./getEventTarget":117,"./mixInto":137}],55:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactInjection
+ */
+
+"use strict";
+
+var DOMProperty = _dereq_("./DOMProperty");
+var EventPluginHub = _dereq_("./EventPluginHub");
+var ReactComponent = _dereq_("./ReactComponent");
+var ReactCompositeComponent = _dereq_("./ReactCompositeComponent");
+var ReactDOM = _dereq_("./ReactDOM");
+var ReactEventEmitter = _dereq_("./ReactEventEmitter");
+var ReactPerf = _dereq_("./ReactPerf");
+var ReactRootIndex = _dereq_("./ReactRootIndex");
+var ReactUpdates = _dereq_("./ReactUpdates");
+
+var ReactInjection = {
+  Component: ReactComponent.injection,
+  CompositeComponent: ReactCompositeComponent.injection,
+  DOMProperty: DOMProperty.injection,
+  EventPluginHub: EventPluginHub.injection,
+  DOM: ReactDOM.injection,
+  EventEmitter: ReactEventEmitter.injection,
+  Perf: ReactPerf.injection,
+  RootIndex: ReactRootIndex.injection,
+  Updates: ReactUpdates.injection
+};
+
+module.exports = ReactInjection;
+
+},{"./DOMProperty":9,"./EventPluginHub":17,"./ReactComponent":31,"./ReactCompositeComponent":33,"./ReactDOM":36,"./ReactEventEmitter":52,"./ReactPerf":65,"./ReactRootIndex":72,"./ReactUpdates":81}],56:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactInputSelection
+ */
+
+"use strict";
+
+var ReactDOMSelection = _dereq_("./ReactDOMSelection");
+
+var containsNode = _dereq_("./containsNode");
+var focusNode = _dereq_("./focusNode");
+var getActiveElement = _dereq_("./getActiveElement");
+
+function isInDocument(node) {
+  return containsNode(document.documentElement, node);
+}
+
+/**
+ * @ReactInputSelection: React input selection module. Based on Selection.js,
+ * but modified to be suitable for react and has a couple of bug fixes (doesn't
+ * assume buttons have range selections allowed).
+ * Input selection module for React.
+ */
+var ReactInputSelection = {
+
+  hasSelectionCapabilities: function(elem) {
+    return elem && (
+      (elem.nodeName === 'INPUT' && elem.type === 'text') ||
+      elem.nodeName === 'TEXTAREA' ||
+      elem.contentEditable === 'true'
+    );
+  },
+
+  getSelectionInformation: function() {
+    var focusedElem = getActiveElement();
+    return {
+      focusedElem: focusedElem,
+      selectionRange:
+          ReactInputSelection.hasSelectionCapabilities(focusedElem) ?
+          ReactInputSelection.getSelection(focusedElem) :
+          null
+    };
+  },
+
+  /**
+   * @restoreSelection: If any selection information was potentially lost,
+   * restore it. This is useful when performing operations that could remove dom
+   * nodes and place them back in, resulting in focus being lost.
+   */
+  restoreSelection: function(priorSelectionInformation) {
+    var curFocusedElem = getActiveElement();
+    var priorFocusedElem = priorSelectionInformation.focusedElem;
+    var priorSelectionRange = priorSelectionInformation.selectionRange;
+    if (curFocusedElem !== priorFocusedElem &&
+        isInDocument(priorFocusedElem)) {
+      if (ReactInputSelection.hasSelectionCapabilities(priorFocusedElem)) {
+        ReactInputSelection.setSelection(
+          priorFocusedElem,
+          priorSelectionRange
+        );
+      }
+      focusNode(priorFocusedElem);
+    }
+  },
+
+  /**
+   * @getSelection: Gets the selection bounds of a focused textarea, input or
+   * contentEditable node.
+   * -@input: Look up selection bounds of this input
+   * -@return {start: selectionStart, end: selectionEnd}
+   */
+  getSelection: function(input) {
+    var selection;
+
+    if ('selectionStart' in input) {
+      // Modern browser with input or textarea.
+      selection = {
+        start: input.selectionStart,
+        end: input.selectionEnd
+      };
+    } else if (document.selection && input.nodeName === 'INPUT') {
+      // IE8 input.
+      var range = document.selection.createRange();
+      // There can only be one selection per document in IE, so it must
+      // be in our element.
+      if (range.parentElement() === input) {
+        selection = {
+          start: -range.moveStart('character', -input.value.length),
+          end: -range.moveEnd('character', -input.value.length)
+        };
+      }
+    } else {
+      // Content editable or old IE textarea.
+      selection = ReactDOMSelection.getOffsets(input);
+    }
+
+    return selection || {start: 0, end: 0};
+  },
+
+  /**
+   * @setSelection: Sets the selection bounds of a textarea or input and focuses
+   * the input.
+   * -@input     Set selection bounds of this input or textarea
+   * -@offsets   Object of same form that is returned from get*
+   */
+  setSelection: function(input, offsets) {
+    var start = offsets.start;
+    var end = offsets.end;
+    if (typeof end === 'undefined') {
+      end = start;
+    }
+
+    if ('selectionStart' in input) {
+      input.selectionStart = start;
+      input.selectionEnd = Math.min(end, input.value.length);
+    } else if (document.selection && input.nodeName === 'INPUT') {
+      var range = input.createTextRange();
+      range.collapse(true);
+      range.moveStart('character', start);
+      range.moveEnd('character', end - start);
+      range.select();
+    } else {
+      ReactDOMSelection.setOffsets(input, offsets);
+    }
+  }
+};
+
+module.exports = ReactInputSelection;
+
+},{"./ReactDOMSelection":45,"./containsNode":101,"./focusNode":113,"./getActiveElement":115}],57:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactInstanceHandles
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var ReactRootIndex = _dereq_("./ReactRootIndex");
+
+var invariant = _dereq_("./invariant");
+
+var SEPARATOR = '.';
+var SEPARATOR_LENGTH = SEPARATOR.length;
+
+/**
+ * Maximum depth of traversals before we consider the possibility of a bad ID.
+ */
+var MAX_TREE_DEPTH = 100;
+
+/**
+ * Creates a DOM ID prefix to use when mounting React components.
+ *
+ * @param {number} index A unique integer
+ * @return {string} React root ID.
+ * @internal
+ */
+function getReactRootIDString(index) {
+  return SEPARATOR + index.toString(36);
+}
+
+/**
+ * Checks if a character in the supplied ID is a separator or the end.
+ *
+ * @param {string} id A React DOM ID.
+ * @param {number} index Index of the character to check.
+ * @return {boolean} True if the character is a separator or end of the ID.
+ * @private
+ */
+function isBoundary(id, index) {
+  return id.charAt(index) === SEPARATOR || index === id.length;
+}
+
+/**
+ * Checks if the supplied string is a valid React DOM ID.
+ *
+ * @param {string} id A React DOM ID, maybe.
+ * @return {boolean} True if the string is a valid React DOM ID.
+ * @private
+ */
+function isValidID(id) {
+  return id === '' || (
+    id.charAt(0) === SEPARATOR && id.charAt(id.length - 1) !== SEPARATOR
+  );
+}
+
+/**
+ * Checks if the first ID is an ancestor of or equal to the second ID.
+ *
+ * @param {string} ancestorID
+ * @param {string} descendantID
+ * @return {boolean} True if `ancestorID` is an ancestor of `descendantID`.
+ * @internal
+ */
+function isAncestorIDOf(ancestorID, descendantID) {
+  return (
+    descendantID.indexOf(ancestorID) === 0 &&
+    isBoundary(descendantID, ancestorID.length)
+  );
+}
+
+/**
+ * Gets the parent ID of the supplied React DOM ID, `id`.
+ *
+ * @param {string} id ID of a component.
+ * @return {string} ID of the parent, or an empty string.
+ * @private
+ */
+function getParentID(id) {
+  return id ? id.substr(0, id.lastIndexOf(SEPARATOR)) : '';
+}
+
+/**
+ * Gets the next DOM ID on the tree path from the supplied `ancestorID` to the
+ * supplied `destinationID`. If they are equal, the ID is returned.
+ *
+ * @param {string} ancestorID ID of an ancestor node of `destinationID`.
+ * @param {string} destinationID ID of the destination node.
+ * @return {string} Next ID on the path from `ancestorID` to `destinationID`.
+ * @private
+ */
+function getNextDescendantID(ancestorID, destinationID) {
+  ("production" !== "development" ? invariant(
+    isValidID(ancestorID) && isValidID(destinationID),
+    'getNextDescendantID(%s, %s): Received an invalid React DOM ID.',
+    ancestorID,
+    destinationID
+  ) : invariant(isValidID(ancestorID) && isValidID(destinationID)));
+  ("production" !== "development" ? invariant(
+    isAncestorIDOf(ancestorID, destinationID),
+    'getNextDescendantID(...): React has made an invalid assumption about ' +
+    'the DOM hierarchy. Expected `%s` to be an ancestor of `%s`.',
+    ancestorID,
+    destinationID
+  ) : invariant(isAncestorIDOf(ancestorID, destinationID)));
+  if (ancestorID === destinationID) {
+    return ancestorID;
+  }
+  // Skip over the ancestor and the immediate separator. Traverse until we hit
+  // another separator or we reach the end of `destinationID`.
+  var start = ancestorID.length + SEPARATOR_LENGTH;
+  for (var i = start; i < destinationID.length; i++) {
+    if (isBoundary(destinationID, i)) {
+      break;
+    }
+  }
+  return destinationID.substr(0, i);
+}
+
+/**
+ * Gets the nearest common ancestor ID of two IDs.
+ *
+ * Using this ID scheme, the nearest common ancestor ID is the longest common
+ * prefix of the two IDs that immediately preceded a "marker" in both strings.
+ *
+ * @param {string} oneID
+ * @param {string} twoID
+ * @return {string} Nearest common ancestor ID, or the empty string if none.
+ * @private
+ */
+function getFirstCommonAncestorID(oneID, twoID) {
+  var minLength = Math.min(oneID.length, twoID.length);
+  if (minLength === 0) {
+    return '';
+  }
+  var lastCommonMarkerIndex = 0;
+  // Use `<=` to traverse until the "EOL" of the shorter string.
+  for (var i = 0; i <= minLength; i++) {
+    if (isBoundary(oneID, i) && isBoundary(twoID, i)) {
+      lastCommonMarkerIndex = i;
+    } else if (oneID.charAt(i) !== twoID.charAt(i)) {
+      break;
+    }
+  }
+  var longestCommonID = oneID.substr(0, lastCommonMarkerIndex);
+  ("production" !== "development" ? invariant(
+    isValidID(longestCommonID),
+    'getFirstCommonAncestorID(%s, %s): Expected a valid React DOM ID: %s',
+    oneID,
+    twoID,
+    longestCommonID
+  ) : invariant(isValidID(longestCommonID)));
+  return longestCommonID;
+}
+
+/**
+ * Traverses the parent path between two IDs (either up or down). The IDs must
+ * not be the same, and there must exist a parent path between them. If the
+ * callback returns `false`, traversal is stopped.
+ *
+ * @param {?string} start ID at which to start traversal.
+ * @param {?string} stop ID at which to end traversal.
+ * @param {function} cb Callback to invoke each ID with.
+ * @param {?boolean} skipFirst Whether or not to skip the first node.
+ * @param {?boolean} skipLast Whether or not to skip the last node.
+ * @private
+ */
+function traverseParentPath(start, stop, cb, arg, skipFirst, skipLast) {
+  start = start || '';
+  stop = stop || '';
+  ("production" !== "development" ? invariant(
+    start !== stop,
+    'traverseParentPath(...): Cannot traverse from and to the same ID, `%s`.',
+    start
+  ) : invariant(start !== stop));
+  var traverseUp = isAncestorIDOf(stop, start);
+  ("production" !== "development" ? invariant(
+    traverseUp || isAncestorIDOf(start, stop),
+    'traverseParentPath(%s, %s, ...): Cannot traverse from two IDs that do ' +
+    'not have a parent path.',
+    start,
+    stop
+  ) : invariant(traverseUp || isAncestorIDOf(start, stop)));
+  // Traverse from `start` to `stop` one depth at a time.
+  var depth = 0;
+  var traverse = traverseUp ? getParentID : getNextDescendantID;
+  for (var id = start; /* until break */; id = traverse(id, stop)) {
+    var ret;
+    if ((!skipFirst || id !== start) && (!skipLast || id !== stop)) {
+      ret = cb(id, traverseUp, arg);
+    }
+    if (ret === false || id === stop) {
+      // Only break //after// visiting `stop`.
+      break;
+    }
+    ("production" !== "development" ? invariant(
+      depth++ < MAX_TREE_DEPTH,
+      'traverseParentPath(%s, %s, ...): Detected an infinite loop while ' +
+      'traversing the React DOM ID tree. This may be due to malformed IDs: %s',
+      start, stop
+    ) : invariant(depth++ < MAX_TREE_DEPTH));
+  }
+}
+
+/**
+ * Manages the IDs assigned to DOM representations of React components. This
+ * uses a specific scheme in order to traverse the DOM efficiently (e.g. in
+ * order to simulate events).
+ *
+ * @internal
+ */
+var ReactInstanceHandles = {
+
+  /**
+   * Constructs a React root ID
+   * @return {string} A React root ID.
+   */
+  createReactRootID: function() {
+    return getReactRootIDString(ReactRootIndex.createReactRootIndex());
+  },
+
+  /**
+   * Constructs a React ID by joining a root ID with a name.
+   *
+   * @param {string} rootID Root ID of a parent component.
+   * @param {string} name A component's name (as flattened children).
+   * @return {string} A React ID.
+   * @internal
+   */
+  createReactID: function(rootID, name) {
+    return rootID + name;
+  },
+
+  /**
+   * Gets the DOM ID of the React component that is the root of the tree that
+   * contains the React component with the supplied DOM ID.
+   *
+   * @param {string} id DOM ID of a React component.
+   * @return {?string} DOM ID of the React component that is the root.
+   * @internal
+   */
+  getReactRootIDFromNodeID: function(id) {
+    if (id && id.charAt(0) === SEPARATOR && id.length > 1) {
+      var index = id.indexOf(SEPARATOR, 1);
+      return index > -1 ? id.substr(0, index) : id;
+    }
+    return null;
+  },
+
+  /**
+   * Traverses the ID hierarchy and invokes the supplied `cb` on any IDs that
+   * should would receive a `mouseEnter` or `mouseLeave` event.
+   *
+   * NOTE: Does not invoke the callback on the nearest common ancestor because
+   * nothing "entered" or "left" that element.
+   *
+   * @param {string} leaveID ID being left.
+   * @param {string} enterID ID being entered.
+   * @param {function} cb Callback to invoke on each entered/left ID.
+   * @param {*} upArg Argument to invoke the callback with on left IDs.
+   * @param {*} downArg Argument to invoke the callback with on entered IDs.
+   * @internal
+   */
+  traverseEnterLeave: function(leaveID, enterID, cb, upArg, downArg) {
+    var ancestorID = getFirstCommonAncestorID(leaveID, enterID);
+    if (ancestorID !== leaveID) {
+      traverseParentPath(leaveID, ancestorID, cb, upArg, false, true);
+    }
+    if (ancestorID !== enterID) {
+      traverseParentPath(ancestorID, enterID, cb, downArg, true, false);
+    }
+  },
+
+  /**
+   * Simulates the traversal of a two-phase, capture/bubble event dispatch.
+   *
+   * NOTE: This traversal happens on IDs without touching the DOM.
+   *
+   * @param {string} targetID ID of the target node.
+   * @param {function} cb Callback to invoke.
+   * @param {*} arg Argument to invoke the callback with.
+   * @internal
+   */
+  traverseTwoPhase: function(targetID, cb, arg) {
+    if (targetID) {
+      traverseParentPath('', targetID, cb, arg, true, false);
+      traverseParentPath(targetID, '', cb, arg, false, true);
+    }
+  },
+
+  /**
+   * Traverse a node ID, calling the supplied `cb` for each ancestor ID. For
+   * example, passing `.0.$row-0.1` would result in `cb` getting called
+   * with `.0`, `.0.$row-0`, and `.0.$row-0.1`.
+   *
+   * NOTE: This traversal happens on IDs without touching the DOM.
+   *
+   * @param {string} targetID ID of the target node.
+   * @param {function} cb Callback to invoke.
+   * @param {*} arg Argument to invoke the callback with.
+   * @internal
+   */
+  traverseAncestors: function(targetID, cb, arg) {
+    traverseParentPath('', targetID, cb, arg, true, false);
+  },
+
+  /**
+   * Exposed for unit testing.
+   * @private
+   */
+  _getFirstCommonAncestorID: getFirstCommonAncestorID,
+
+  /**
+   * Exposed for unit testing.
+   * @private
+   */
+  _getNextDescendantID: getNextDescendantID,
+
+  isAncestorIDOf: isAncestorIDOf,
+
+  SEPARATOR: SEPARATOR
+
+};
+
+module.exports = ReactInstanceHandles;
+
+},{"./ReactRootIndex":72,"./invariant":125}],58:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactLink
+ * @typechecks static-only
+ */
+
+"use strict";
+
+/**
+ * ReactLink encapsulates a common pattern in which a component wants to modify
+ * a prop received from its parent. ReactLink allows the parent to pass down a
+ * value coupled with a callback that, when invoked, expresses an intent to
+ * modify that value. For example:
+ *
+ * React.createClass({
+ *   getInitialState: function() {
+ *     return {value: ''};
+ *   },
+ *   render: function() {
+ *     var valueLink = new ReactLink(this.state.value, this._handleValueChange);
+ *     return <input valueLink={valueLink} />;
+ *   },
+ *   this._handleValueChange: function(newValue) {
+ *     this.setState({value: newValue});
+ *   }
+ * });
+ *
+ * We have provided some sugary mixins to make the creation and
+ * consumption of ReactLink easier; see LinkedValueUtils and LinkedStateMixin.
+ */
+
+/**
+ * @param {*} value current value of the link
+ * @param {function} requestChange callback to request a change
+ */
+function ReactLink(value, requestChange) {
+  this.value = value;
+  this.requestChange = requestChange;
+}
+
+module.exports = ReactLink;
+
+},{}],59:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactMarkupChecksum
+ */
+
+"use strict";
+
+var adler32 = _dereq_("./adler32");
+
+var ReactMarkupChecksum = {
+  CHECKSUM_ATTR_NAME: 'data-react-checksum',
+
+  /**
+   * @param {string} markup Markup string
+   * @return {string} Markup string with checksum attribute attached
+   */
+  addChecksumToMarkup: function(markup) {
+    var checksum = adler32(markup);
+    return markup.replace(
+      '>',
+      ' ' + ReactMarkupChecksum.CHECKSUM_ATTR_NAME + '="' + checksum + '">'
+    );
+  },
+
+  /**
+   * @param {string} markup to use
+   * @param {DOMElement} element root React element
+   * @returns {boolean} whether or not the markup is the same
+   */
+  canReuseMarkup: function(markup, element) {
+    var existingChecksum = element.getAttribute(
+      ReactMarkupChecksum.CHECKSUM_ATTR_NAME
+    );
+    existingChecksum = existingChecksum && parseInt(existingChecksum, 10);
+    var markupChecksum = adler32(markup);
+    return markupChecksum === existingChecksum;
+  }
+};
+
+module.exports = ReactMarkupChecksum;
+
+},{"./adler32":99}],60:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactMount
+ */
+
+"use strict";
+
+var DOMProperty = _dereq_("./DOMProperty");
+var ReactEventEmitter = _dereq_("./ReactEventEmitter");
+var ReactInstanceHandles = _dereq_("./ReactInstanceHandles");
+var ReactPerf = _dereq_("./ReactPerf");
+
+var containsNode = _dereq_("./containsNode");
+var getReactRootElementInContainer = _dereq_("./getReactRootElementInContainer");
+var instantiateReactComponent = _dereq_("./instantiateReactComponent");
+var invariant = _dereq_("./invariant");
+var shouldUpdateReactComponent = _dereq_("./shouldUpdateReactComponent");
+
+var SEPARATOR = ReactInstanceHandles.SEPARATOR;
+
+var ATTR_NAME = DOMProperty.ID_ATTRIBUTE_NAME;
+var nodeCache = {};
+
+var ELEMENT_NODE_TYPE = 1;
+var DOC_NODE_TYPE = 9;
+
+/** Mapping from reactRootID to React component instance. */
+var instancesByReactRootID = {};
+
+/** Mapping from reactRootID to `container` nodes. */
+var containersByReactRootID = {};
+
+if ("production" !== "development") {
+  /** __DEV__-only mapping from reactRootID to root elements. */
+  var rootElementsByReactRootID = {};
+}
+
+// Used to store breadth-first search state in findComponentRoot.
+var findComponentRootReusableArray = [];
+
+/**
+ * @param {DOMElement} container DOM element that may contain a React component.
+ * @return {?string} A "reactRoot" ID, if a React component is rendered.
+ */
+function getReactRootID(container) {
+  var rootElement = getReactRootElementInContainer(container);
+  return rootElement && ReactMount.getID(rootElement);
+}
+
+/**
+ * Accessing node[ATTR_NAME] or calling getAttribute(ATTR_NAME) on a form
+ * element can return its control whose name or ID equals ATTR_NAME. All
+ * DOM nodes support `getAttributeNode` but this can also get called on
+ * other objects so just return '' if we're given something other than a
+ * DOM node (such as window).
+ *
+ * @param {?DOMElement|DOMWindow|DOMDocument|DOMTextNode} node DOM node.
+ * @return {string} ID of the supplied `domNode`.
+ */
+function getID(node) {
+  var id = internalGetID(node);
+  if (id) {
+    if (nodeCache.hasOwnProperty(id)) {
+      var cached = nodeCache[id];
+      if (cached !== node) {
+        ("production" !== "development" ? invariant(
+          !isValid(cached, id),
+          'ReactMount: Two valid but unequal nodes with the same `%s`: %s',
+          ATTR_NAME, id
+        ) : invariant(!isValid(cached, id)));
+
+        nodeCache[id] = node;
+      }
+    } else {
+      nodeCache[id] = node;
+    }
+  }
+
+  return id;
+}
+
+function internalGetID(node) {
+  // If node is something like a window, document, or text node, none of
+  // which support attributes or a .getAttribute method, gracefully return
+  // the empty string, as if the attribute were missing.
+  return node && node.getAttribute && node.getAttribute(ATTR_NAME) || '';
+}
+
+/**
+ * Sets the React-specific ID of the given node.
+ *
+ * @param {DOMElement} node The DOM node whose ID will be set.
+ * @param {string} id The value of the ID attribute.
+ */
+function setID(node, id) {
+  var oldID = internalGetID(node);
+  if (oldID !== id) {
+    delete nodeCache[oldID];
+  }
+  node.setAttribute(ATTR_NAME, id);
+  nodeCache[id] = node;
+}
+
+/**
+ * Finds the node with the supplied React-generated DOM ID.
+ *
+ * @param {string} id A React-generated DOM ID.
+ * @return {DOMElement} DOM node with the suppled `id`.
+ * @internal
+ */
+function getNode(id) {
+  if (!nodeCache.hasOwnProperty(id) || !isValid(nodeCache[id], id)) {
+    nodeCache[id] = ReactMount.findReactNodeByID(id);
+  }
+  return nodeCache[id];
+}
+
+/**
+ * A node is "valid" if it is contained by a currently mounted container.
+ *
+ * This means that the node does not have to be contained by a document in
+ * order to be considered valid.
+ *
+ * @param {?DOMElement} node The candidate DOM node.
+ * @param {string} id The expected ID of the node.
+ * @return {boolean} Whether the node is contained by a mounted container.
+ */
+function isValid(node, id) {
+  if (node) {
+    ("production" !== "development" ? invariant(
+      internalGetID(node) === id,
+      'ReactMount: Unexpected modification of `%s`',
+      ATTR_NAME
+    ) : invariant(internalGetID(node) === id));
+
+    var container = ReactMount.findReactContainerForID(id);
+    if (container && containsNode(container, node)) {
+      return true;
+    }
+  }
+
+  return false;
+}
+
+/**
+ * Causes the cache to forget about one React-specific ID.
+ *
+ * @param {string} id The ID to forget.
+ */
+function purgeID(id) {
+  delete nodeCache[id];
+}
+
+var deepestNodeSoFar = null;
+function findDeepestCachedAncestorImpl(ancestorID) {
+  var ancestor = nodeCache[ancestorID];
+  if (ancestor && isValid(ancestor, ancestorID)) {
+    deepestNodeSoFar = ancestor;
+  } else {
+    // This node isn't populated in the cache, so presumably none of its
+    // descendants are. Break out of the loop.
+    return false;
+  }
+}
+
+/**
+ * Return the deepest cached node whose ID is a prefix of `targetID`.
+ */
+function findDeepestCachedAncestor(targetID) {
+  deepestNodeSoFar = null;
+  ReactInstanceHandles.traverseAncestors(
+    targetID,
+    findDeepestCachedAncestorImpl
+  );
+
+  var foundNode = deepestNodeSoFar;
+  deepestNodeSoFar = null;
+  return foundNode;
+}
+
+/**
+ * Mounting is the process of initializing a React component by creatings its
+ * representative DOM elements and inserting them into a supplied `container`.
+ * Any prior content inside `container` is destroyed in the process.
+ *
+ *   ReactMount.renderComponent(
+ *     component,
+ *     document.getElementById('container')
+ *   );
+ *
+ *   <div id="container">                   <-- Supplied `container`.
+ *     <div data-reactid=".3">              <-- Rendered reactRoot of React
+ *       // ...                                 component.
+ *     </div>
+ *   </div>
+ *
+ * Inside of `container`, the first element rendered is the "reactRoot".
+ */
+var ReactMount = {
+  /** Time spent generating markup. */
+  totalInstantiationTime: 0,
+
+  /** Time spent inserting markup into the DOM. */
+  totalInjectionTime: 0,
+
+  /** Whether support for touch events should be initialized. */
+  useTouchEvents: false,
+
+  /** Exposed for debugging purposes **/
+  _instancesByReactRootID: instancesByReactRootID,
+
+  /**
+   * This is a hook provided to support rendering React components while
+   * ensuring that the apparent scroll position of its `container` does not
+   * change.
+   *
+   * @param {DOMElement} container The `container` being rendered into.
+   * @param {function} renderCallback This must be called once to do the render.
+   */
+  scrollMonitor: function(container, renderCallback) {
+    renderCallback();
+  },
+
+  /**
+   * Take a component that's already mounted into the DOM and replace its props
+   * @param {ReactComponent} prevComponent component instance already in the DOM
+   * @param {ReactComponent} nextComponent component instance to render
+   * @param {DOMElement} container container to render into
+   * @param {?function} callback function triggered on completion
+   */
+  _updateRootComponent: function(
+      prevComponent,
+      nextComponent,
+      container,
+      callback) {
+    var nextProps = nextComponent.props;
+    ReactMount.scrollMonitor(container, function() {
+      prevComponent.replaceProps(nextProps, callback);
+    });
+
+    if ("production" !== "development") {
+      // Record the root element in case it later gets transplanted.
+      rootElementsByReactRootID[getReactRootID(container)] =
+        getReactRootElementInContainer(container);
+    }
+
+    return prevComponent;
+  },
+
+  /**
+   * Register a component into the instance map and starts scroll value
+   * monitoring
+   * @param {ReactComponent} nextComponent component instance to render
+   * @param {DOMElement} container container to render into
+   * @return {string} reactRoot ID prefix
+   */
+  _registerComponent: function(nextComponent, container) {
+    ("production" !== "development" ? invariant(
+      container && (
+        container.nodeType === ELEMENT_NODE_TYPE ||
+        container.nodeType === DOC_NODE_TYPE
+      ),
+      '_registerComponent(...): Target container is not a DOM element.'
+    ) : invariant(container && (
+      container.nodeType === ELEMENT_NODE_TYPE ||
+      container.nodeType === DOC_NODE_TYPE
+    )));
+
+    ReactEventEmitter.ensureScrollValueMonitoring();
+
+    var reactRootID = ReactMount.registerContainer(container);
+    instancesByReactRootID[reactRootID] = nextComponent;
+    return reactRootID;
+  },
+
+  /**
+   * Render a new component into the DOM.
+   * @param {ReactComponent} nextComponent component instance to render
+   * @param {DOMElement} container container to render into
+   * @param {boolean} shouldReuseMarkup if we should skip the markup insertion
+   * @return {ReactComponent} nextComponent
+   */
+  _renderNewRootComponent: ReactPerf.measure(
+    'ReactMount',
+    '_renderNewRootComponent',
+    function(
+        nextComponent,
+        container,
+        shouldReuseMarkup) {
+
+      var componentInstance = instantiateReactComponent(nextComponent);
+      var reactRootID = ReactMount._registerComponent(
+        componentInstance,
+        container
+      );
+      componentInstance.mountComponentIntoNode(
+        reactRootID,
+        container,
+        shouldReuseMarkup
+      );
+
+      if ("production" !== "development") {
+        // Record the root element in case it later gets transplanted.
+        rootElementsByReactRootID[reactRootID] =
+          getReactRootElementInContainer(container);
+      }
+
+      return componentInstance;
+    }
+  ),
+
+  /**
+   * Renders a React component into the DOM in the supplied `container`.
+   *
+   * If the React component was previously rendered into `container`, this will
+   * perform an update on it and only mutate the DOM as necessary to reflect the
+   * latest React component.
+   *
+   * @param {ReactComponent} nextComponent Component instance to render.
+   * @param {DOMElement} container DOM element to render into.
+   * @param {?function} callback function triggered on completion
+   * @return {ReactComponent} Component instance rendered in `container`.
+   */
+  renderComponent: function(nextComponent, container, callback) {
+    var prevComponent = instancesByReactRootID[getReactRootID(container)];
+
+    if (prevComponent) {
+      if (shouldUpdateReactComponent(prevComponent, nextComponent)) {
+        return ReactMount._updateRootComponent(
+          prevComponent,
+          nextComponent,
+          container,
+          callback
+        );
+      } else {
+        ReactMount.unmountComponentAtNode(container);
+      }
+    }
+
+    var reactRootElement = getReactRootElementInContainer(container);
+    var containerHasReactMarkup =
+      reactRootElement && ReactMount.isRenderedByReact(reactRootElement);
+
+    var shouldReuseMarkup = containerHasReactMarkup && !prevComponent;
+
+    var component = ReactMount._renderNewRootComponent(
+      nextComponent,
+      container,
+      shouldReuseMarkup
+    );
+    callback && callback.call(component);
+    return component;
+  },
+
+  /**
+   * Constructs a component instance of `constructor` with `initialProps` and
+   * renders it into the supplied `container`.
+   *
+   * @param {function} constructor React component constructor.
+   * @param {?object} props Initial props of the component instance.
+   * @param {DOMElement} container DOM element to render into.
+   * @return {ReactComponent} Component instance rendered in `container`.
+   */
+  constructAndRenderComponent: function(constructor, props, container) {
+    return ReactMount.renderComponent(constructor(props), container);
+  },
+
+  /**
+   * Constructs a component instance of `constructor` with `initialProps` and
+   * renders it into a container node identified by supplied `id`.
+   *
+   * @param {function} componentConstructor React component constructor
+   * @param {?object} props Initial props of the component instance.
+   * @param {string} id ID of the DOM element to render into.
+   * @return {ReactComponent} Component instance rendered in the container node.
+   */
+  constructAndRenderComponentByID: function(constructor, props, id) {
+    var domNode = document.getElementById(id);
+    ("production" !== "development" ? invariant(
+      domNode,
+      'Tried to get element with id of "%s" but it is not present on the page.',
+      id
+    ) : invariant(domNode));
+    return ReactMount.constructAndRenderComponent(constructor, props, domNode);
+  },
+
+  /**
+   * Registers a container node into which React components will be rendered.
+   * This also creates the "reactRoot" ID that will be assigned to the element
+   * rendered within.
+   *
+   * @param {DOMElement} container DOM element to register as a container.
+   * @return {string} The "reactRoot" ID of elements rendered within.
+   */
+  registerContainer: function(container) {
+    var reactRootID = getReactRootID(container);
+    if (reactRootID) {
+      // If one exists, make sure it is a valid "reactRoot" ID.
+      reactRootID = ReactInstanceHandles.getReactRootIDFromNodeID(reactRootID);
+    }
+    if (!reactRootID) {
+      // No valid "reactRoot" ID found, create one.
+      reactRootID = ReactInstanceHandles.createReactRootID();
+    }
+    containersByReactRootID[reactRootID] = container;
+    return reactRootID;
+  },
+
+  /**
+   * Unmounts and destroys the React component rendered in the `container`.
+   *
+   * @param {DOMElement} container DOM element containing a React component.
+   * @return {boolean} True if a component was found in and unmounted from
+   *                   `container`
+   */
+  unmountComponentAtNode: function(container) {
+    var reactRootID = getReactRootID(container);
+    var component = instancesByReactRootID[reactRootID];
+    if (!component) {
+      return false;
+    }
+    ReactMount.unmountComponentFromNode(component, container);
+    delete instancesByReactRootID[reactRootID];
+    delete containersByReactRootID[reactRootID];
+    if ("production" !== "development") {
+      delete rootElementsByReactRootID[reactRootID];
+    }
+    return true;
+  },
+
+  /**
+   * Unmounts a component and removes it from the DOM.
+   *
+   * @param {ReactComponent} instance React component instance.
+   * @param {DOMElement} container DOM element to unmount from.
+   * @final
+   * @internal
+   * @see {ReactMount.unmountComponentAtNode}
+   */
+  unmountComponentFromNode: function(instance, container) {
+    instance.unmountComponent();
+
+    if (container.nodeType === DOC_NODE_TYPE) {
+      container = container.documentElement;
+    }
+
+    // http://jsperf.com/emptying-a-node
+    while (container.lastChild) {
+      container.removeChild(container.lastChild);
+    }
+  },
+
+  /**
+   * Finds the container DOM element that contains React component to which the
+   * supplied DOM `id` belongs.
+   *
+   * @param {string} id The ID of an element rendered by a React component.
+   * @return {?DOMElement} DOM element that contains the `id`.
+   */
+  findReactContainerForID: function(id) {
+    var reactRootID = ReactInstanceHandles.getReactRootIDFromNodeID(id);
+    var container = containersByReactRootID[reactRootID];
+
+    if ("production" !== "development") {
+      var rootElement = rootElementsByReactRootID[reactRootID];
+      if (rootElement && rootElement.parentNode !== container) {
+        ("production" !== "development" ? invariant(
+          // Call internalGetID here because getID calls isValid which calls
+          // findReactContainerForID (this function).
+          internalGetID(rootElement) === reactRootID,
+          'ReactMount: Root element ID differed from reactRootID.'
+        ) : invariant(// Call internalGetID here because getID calls isValid which calls
+        // findReactContainerForID (this function).
+        internalGetID(rootElement) === reactRootID));
+
+        var containerChild = container.firstChild;
+        if (containerChild &&
+            reactRootID === internalGetID(containerChild)) {
+          // If the container has a new child with the same ID as the old
+          // root element, then rootElementsByReactRootID[reactRootID] is
+          // just stale and needs to be updated. The case that deserves a
+          // warning is when the container is empty.
+          rootElementsByReactRootID[reactRootID] = containerChild;
+        } else {
+          console.warn(
+            'ReactMount: Root element has been removed from its original ' +
+            'container. New container:', rootElement.parentNode
+          );
+        }
+      }
+    }
+
+    return container;
+  },
+
+  /**
+   * Finds an element rendered by React with the supplied ID.
+   *
+   * @param {string} id ID of a DOM node in the React component.
+   * @return {DOMElement} Root DOM node of the React component.
+   */
+  findReactNodeByID: function(id) {
+    var reactRoot = ReactMount.findReactContainerForID(id);
+    return ReactMount.findComponentRoot(reactRoot, id);
+  },
+
+  /**
+   * True if the supplied `node` is rendered by React.
+   *
+   * @param {*} node DOM Element to check.
+   * @return {boolean} True if the DOM Element appears to be rendered by React.
+   * @internal
+   */
+  isRenderedByReact: function(node) {
+    if (node.nodeType !== 1) {
+      // Not a DOMElement, therefore not a React component
+      return false;
+    }
+    var id = ReactMount.getID(node);
+    return id ? id.charAt(0) === SEPARATOR : false;
+  },
+
+  /**
+   * Traverses up the ancestors of the supplied node to find a node that is a
+   * DOM representation of a React component.
+   *
+   * @param {*} node
+   * @return {?DOMEventTarget}
+   * @internal
+   */
+  getFirstReactDOM: function(node) {
+    var current = node;
+    while (current && current.parentNode !== current) {
+      if (ReactMount.isRenderedByReact(current)) {
+        return current;
+      }
+      current = current.parentNode;
+    }
+    return null;
+  },
+
+  /**
+   * Finds a node with the supplied `targetID` inside of the supplied
+   * `ancestorNode`.  Exploits the ID naming scheme to perform the search
+   * quickly.
+   *
+   * @param {DOMEventTarget} ancestorNode Search from this root.
+   * @pararm {string} targetID ID of the DOM representation of the component.
+   * @return {DOMEventTarget} DOM node with the supplied `targetID`.
+   * @internal
+   */
+  findComponentRoot: function(ancestorNode, targetID) {
+    var firstChildren = findComponentRootReusableArray;
+    var childIndex = 0;
+
+    var deepestAncestor = findDeepestCachedAncestor(targetID) || ancestorNode;
+
+    firstChildren[0] = deepestAncestor.firstChild;
+    firstChildren.length = 1;
+
+    while (childIndex < firstChildren.length) {
+      var child = firstChildren[childIndex++];
+      var targetChild;
+
+      while (child) {
+        var childID = ReactMount.getID(child);
+        if (childID) {
+          // Even if we find the node we're looking for, we finish looping
+          // through its siblings to ensure they're cached so that we don't have
+          // to revisit this node again. Otherwise, we make n^2 calls to getID
+          // when visiting the many children of a single node in order.
+
+          if (targetID === childID) {
+            targetChild = child;
+          } else if (ReactInstanceHandles.isAncestorIDOf(childID, targetID)) {
+            // If we find a child whose ID is an ancestor of the given ID,
+            // then we can be sure that we only want to search the subtree
+            // rooted at this child, so we can throw out the rest of the
+            // search state.
+            firstChildren.length = childIndex = 0;
+            firstChildren.push(child.firstChild);
+          }
+
+        } else {
+          // If this child had no ID, then there's a chance that it was
+          // injected automatically by the browser, as when a `<table>`
+          // element sprouts an extra `<tbody>` child as a side effect of
+          // `.innerHTML` parsing. Optimistically continue down this
+          // branch, but not before examining the other siblings.
+          firstChildren.push(child.firstChild);
+        }
+
+        child = child.nextSibling;
+      }
+
+      if (targetChild) {
+        // Emptying firstChildren/findComponentRootReusableArray is
+        // not necessary for correctness, but it helps the GC reclaim
+        // any nodes that were left at the end of the search.
+        firstChildren.length = 0;
+
+        return targetChild;
+      }
+    }
+
+    firstChildren.length = 0;
+
+    ("production" !== "development" ? invariant(
+      false,
+      'findComponentRoot(..., %s): Unable to find element. This probably ' +
+      'means the DOM was unexpectedly mutated (e.g., by the browser), ' +
+      'usually due to forgetting a <tbody> when using tables or nesting <p> ' +
+      'or <a> tags. Try inspecting the child nodes of the element with React ' +
+      'ID `%s`.',
+      targetID,
+      ReactMount.getID(ancestorNode)
+    ) : invariant(false));
+  },
+
+
+  /**
+   * React ID utilities.
+   */
+
+  getReactRootID: getReactRootID,
+
+  getID: getID,
+
+  setID: setID,
+
+  getNode: getNode,
+
+  purgeID: purgeID
+};
+
+module.exports = ReactMount;
+
+},{"./DOMProperty":9,"./ReactEventEmitter":52,"./ReactInstanceHandles":57,"./ReactPerf":65,"./containsNode":101,"./getReactRootElementInContainer":120,"./instantiateReactComponent":124,"./invariant":125,"./shouldUpdateReactComponent":144}],61:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactMountReady
+ */
+
+"use strict";
+
+var PooledClass = _dereq_("./PooledClass");
+
+var mixInto = _dereq_("./mixInto");
+
+/**
+ * A specialized pseudo-event module to help keep track of components waiting to
+ * be notified when their DOM representations are available for use.
+ *
+ * This implements `PooledClass`, so you should never need to instantiate this.
+ * Instead, use `ReactMountReady.getPooled()`.
+ *
+ * @param {?array<function>} initialCollection
+ * @class ReactMountReady
+ * @implements PooledClass
+ * @internal
+ */
+function ReactMountReady(initialCollection) {
+  this._queue = initialCollection || null;
+}
+
+mixInto(ReactMountReady, {
+
+  /**
+   * Enqueues a callback to be invoked when `notifyAll` is invoked. This is used
+   * to enqueue calls to `componentDidMount` and `componentDidUpdate`.
+   *
+   * @param {ReactComponent} component Component being rendered.
+   * @param {function(DOMElement)} callback Invoked when `notifyAll` is invoked.
+   * @internal
+   */
+  enqueue: function(component, callback) {
+    this._queue = this._queue || [];
+    this._queue.push({component: component, callback: callback});
+  },
+
+  /**
+   * Invokes all enqueued callbacks and clears the queue. This is invoked after
+   * the DOM representation of a component has been created or updated.
+   *
+   * @internal
+   */
+  notifyAll: function() {
+    var queue = this._queue;
+    if (queue) {
+      this._queue = null;
+      for (var i = 0, l = queue.length; i < l; i++) {
+        var component = queue[i].component;
+        var callback = queue[i].callback;
+        callback.call(component);
+      }
+      queue.length = 0;
+    }
+  },
+
+  /**
+   * Resets the internal queue.
+   *
+   * @internal
+   */
+  reset: function() {
+    this._queue = null;
+  },
+
+  /**
+   * `PooledClass` looks for this.
+   */
+  destructor: function() {
+    this.reset();
+  }
+
+});
+
+PooledClass.addPoolingTo(ReactMountReady);
+
+module.exports = ReactMountReady;
+
+},{"./PooledClass":25,"./mixInto":137}],62:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactMultiChild
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var ReactComponent = _dereq_("./ReactComponent");
+var ReactMultiChildUpdateTypes = _dereq_("./ReactMultiChildUpdateTypes");
+
+var flattenChildren = _dereq_("./flattenChildren");
+var instantiateReactComponent = _dereq_("./instantiateReactComponent");
+var shouldUpdateReactComponent = _dereq_("./shouldUpdateReactComponent");
+
+/**
+ * Updating children of a component may trigger recursive updates. The depth is
+ * used to batch recursive updates to render markup more efficiently.
+ *
+ * @type {number}
+ * @private
+ */
+var updateDepth = 0;
+
+/**
+ * Queue of update configuration objects.
+ *
+ * Each object has a `type` property that is in `ReactMultiChildUpdateTypes`.
+ *
+ * @type {array<object>}
+ * @private
+ */
+var updateQueue = [];
+
+/**
+ * Queue of markup to be rendered.
+ *
+ * @type {array<string>}
+ * @private
+ */
+var markupQueue = [];
+
+/**
+ * Enqueues markup to be rendered and inserted at a supplied index.
+ *
+ * @param {string} parentID ID of the parent component.
+ * @param {string} markup Markup that renders into an element.
+ * @param {number} toIndex Destination index.
+ * @private
+ */
+function enqueueMarkup(parentID, markup, toIndex) {
+  // NOTE: Null values reduce hidden classes.
+  updateQueue.push({
+    parentID: parentID,
+    parentNode: null,
+    type: ReactMultiChildUpdateTypes.INSERT_MARKUP,
+    markupIndex: markupQueue.push(markup) - 1,
+    textContent: null,
+    fromIndex: null,
+    toIndex: toIndex
+  });
+}
+
+/**
+ * Enqueues moving an existing element to another index.
+ *
+ * @param {string} parentID ID of the parent component.
+ * @param {number} fromIndex Source index of the existing element.
+ * @param {number} toIndex Destination index of the element.
+ * @private
+ */
+function enqueueMove(parentID, fromIndex, toIndex) {
+  // NOTE: Null values reduce hidden classes.
+  updateQueue.push({
+    parentID: parentID,
+    parentNode: null,
+    type: ReactMultiChildUpdateTypes.MOVE_EXISTING,
+    markupIndex: null,
+    textContent: null,
+    fromIndex: fromIndex,
+    toIndex: toIndex
+  });
+}
+
+/**
+ * Enqueues removing an element at an index.
+ *
+ * @param {string} parentID ID of the parent component.
+ * @param {number} fromIndex Index of the element to remove.
+ * @private
+ */
+function enqueueRemove(parentID, fromIndex) {
+  // NOTE: Null values reduce hidden classes.
+  updateQueue.push({
+    parentID: parentID,
+    parentNode: null,
+    type: ReactMultiChildUpdateTypes.REMOVE_NODE,
+    markupIndex: null,
+    textContent: null,
+    fromIndex: fromIndex,
+    toIndex: null
+  });
+}
+
+/**
+ * Enqueues setting the text content.
+ *
+ * @param {string} parentID ID of the parent component.
+ * @param {string} textContent Text content to set.
+ * @private
+ */
+function enqueueTextContent(parentID, textContent) {
+  // NOTE: Null values reduce hidden classes.
+  updateQueue.push({
+    parentID: parentID,
+    parentNode: null,
+    type: ReactMultiChildUpdateTypes.TEXT_CONTENT,
+    markupIndex: null,
+    textContent: textContent,
+    fromIndex: null,
+    toIndex: null
+  });
+}
+
+/**
+ * Processes any enqueued updates.
+ *
+ * @private
+ */
+function processQueue() {
+  if (updateQueue.length) {
+    ReactComponent.BackendIDOperations.dangerouslyProcessChildrenUpdates(
+      updateQueue,
+      markupQueue
+    );
+    clearQueue();
+  }
+}
+
+/**
+ * Clears any enqueued updates.
+ *
+ * @private
+ */
+function clearQueue() {
+  updateQueue.length = 0;
+  markupQueue.length = 0;
+}
+
+/**
+ * ReactMultiChild are capable of reconciling multiple children.
+ *
+ * @class ReactMultiChild
+ * @internal
+ */
+var ReactMultiChild = {
+
+  /**
+   * Provides common functionality for components that must reconcile multiple
+   * children. This is used by `ReactDOMComponent` to mount, update, and
+   * unmount child components.
+   *
+   * @lends {ReactMultiChild.prototype}
+   */
+  Mixin: {
+
+    /**
+     * Generates a "mount image" for each of the supplied children. In the case
+     * of `ReactDOMComponent`, a mount image is a string of markup.
+     *
+     * @param {?object} nestedChildren Nested child maps.
+     * @return {array} An array of mounted representations.
+     * @internal
+     */
+    mountChildren: function(nestedChildren, transaction) {
+      var children = flattenChildren(nestedChildren);
+      var mountImages = [];
+      var index = 0;
+      this._renderedChildren = children;
+      for (var name in children) {
+        var child = children[name];
+        if (children.hasOwnProperty(name)) {
+          // The rendered children must be turned into instances as they're
+          // mounted.
+          var childInstance = instantiateReactComponent(child);
+          children[name] = childInstance;
+          // Inlined for performance, see `ReactInstanceHandles.createReactID`.
+          var rootID = this._rootNodeID + name;
+          var mountImage = childInstance.mountComponent(
+            rootID,
+            transaction,
+            this._mountDepth + 1
+          );
+          childInstance._mountIndex = index;
+          mountImages.push(mountImage);
+          index++;
+        }
+      }
+      return mountImages;
+    },
+
+    /**
+     * Replaces any rendered children with a text content string.
+     *
+     * @param {string} nextContent String of content.
+     * @internal
+     */
+    updateTextContent: function(nextContent) {
+      updateDepth++;
+      var errorThrown = true;
+      try {
+        var prevChildren = this._renderedChildren;
+        // Remove any rendered children.
+        for (var name in prevChildren) {
+          if (prevChildren.hasOwnProperty(name)) {
+            this._unmountChildByName(prevChildren[name], name);
+          }
+        }
+        // Set new text content.
+        this.setTextContent(nextContent);
+        errorThrown = false;
+      } finally {
+        updateDepth--;
+        if (!updateDepth) {
+          errorThrown ? clearQueue() : processQueue();
+        }
+      }
+    },
+
+    /**
+     * Updates the rendered children with new children.
+     *
+     * @param {?object} nextNestedChildren Nested child maps.
+     * @param {ReactReconcileTransaction} transaction
+     * @internal
+     */
+    updateChildren: function(nextNestedChildren, transaction) {
+      updateDepth++;
+      var errorThrown = true;
+      try {
+        this._updateChildren(nextNestedChildren, transaction);
+        errorThrown = false;
+      } finally {
+        updateDepth--;
+        if (!updateDepth) {
+          errorThrown ? clearQueue() : processQueue();
+        }
+      }
+    },
+
+    /**
+     * Improve performance by isolating this hot code path from the try/catch
+     * block in `updateChildren`.
+     *
+     * @param {?object} nextNestedChildren Nested child maps.
+     * @param {ReactReconcileTransaction} transaction
+     * @final
+     * @protected
+     */
+    _updateChildren: function(nextNestedChildren, transaction) {
+      var nextChildren = flattenChildren(nextNestedChildren);
+      var prevChildren = this._renderedChildren;
+      if (!nextChildren && !prevChildren) {
+        return;
+      }
+      var name;
+      // `nextIndex` will increment for each child in `nextChildren`, but
+      // `lastIndex` will be the last index visited in `prevChildren`.
+      var lastIndex = 0;
+      var nextIndex = 0;
+      for (name in nextChildren) {
+        if (!nextChildren.hasOwnProperty(name)) {
+          continue;
+        }
+        var prevChild = prevChildren && prevChildren[name];
+        var nextChild = nextChildren[name];
+        if (shouldUpdateReactComponent(prevChild, nextChild)) {
+          this.moveChild(prevChild, nextIndex, lastIndex);
+          lastIndex = Math.max(prevChild._mountIndex, lastIndex);
+          prevChild.receiveComponent(nextChild, transaction);
+          prevChild._mountIndex = nextIndex;
+        } else {
+          if (prevChild) {
+            // Update `lastIndex` before `_mountIndex` gets unset by unmounting.
+            lastIndex = Math.max(prevChild._mountIndex, lastIndex);
+            this._unmountChildByName(prevChild, name);
+          }
+          // The child must be instantiated before it's mounted.
+          var nextChildInstance = instantiateReactComponent(nextChild);
+          this._mountChildByNameAtIndex(
+            nextChildInstance, name, nextIndex, transaction
+          );
+        }
+        nextIndex++;
+      }
+      // Remove children that are no longer present.
+      for (name in prevChildren) {
+        if (prevChildren.hasOwnProperty(name) &&
+            !(nextChildren && nextChildren[name])) {
+          this._unmountChildByName(prevChildren[name], name);
+        }
+      }
+    },
+
+    /**
+     * Unmounts all rendered children. This should be used to clean up children
+     * when this component is unmounted.
+     *
+     * @internal
+     */
+    unmountChildren: function() {
+      var renderedChildren = this._renderedChildren;
+      for (var name in renderedChildren) {
+        var renderedChild = renderedChildren[name];
+        // TODO: When is this not true?
+        if (renderedChild.unmountComponent) {
+          renderedChild.unmountComponent();
+        }
+      }
+      this._renderedChildren = null;
+    },
+
+    /**
+     * Moves a child component to the supplied index.
+     *
+     * @param {ReactComponent} child Component to move.
+     * @param {number} toIndex Destination index of the element.
+     * @param {number} lastIndex Last index visited of the siblings of `child`.
+     * @protected
+     */
+    moveChild: function(child, toIndex, lastIndex) {
+      // If the index of `child` is less than `lastIndex`, then it needs to
+      // be moved. Otherwise, we do not need to move it because a child will be
+      // inserted or moved before `child`.
+      if (child._mountIndex < lastIndex) {
+        enqueueMove(this._rootNodeID, child._mountIndex, toIndex);
+      }
+    },
+
+    /**
+     * Creates a child component.
+     *
+     * @param {ReactComponent} child Component to create.
+     * @param {string} mountImage Markup to insert.
+     * @protected
+     */
+    createChild: function(child, mountImage) {
+      enqueueMarkup(this._rootNodeID, mountImage, child._mountIndex);
+    },
+
+    /**
+     * Removes a child component.
+     *
+     * @param {ReactComponent} child Child to remove.
+     * @protected
+     */
+    removeChild: function(child) {
+      enqueueRemove(this._rootNodeID, child._mountIndex);
+    },
+
+    /**
+     * Sets this text content string.
+     *
+     * @param {string} textContent Text content to set.
+     * @protected
+     */
+    setTextContent: function(textContent) {
+      enqueueTextContent(this._rootNodeID, textContent);
+    },
+
+    /**
+     * Mounts a child with the supplied name.
+     *
+     * NOTE: This is part of `updateChildren` and is here for readability.
+     *
+     * @param {ReactComponent} child Component to mount.
+     * @param {string} name Name of the child.
+     * @param {number} index Index at which to insert the child.
+     * @param {ReactReconcileTransaction} transaction
+     * @private
+     */
+    _mountChildByNameAtIndex: function(child, name, index, transaction) {
+      // Inlined for performance, see `ReactInstanceHandles.createReactID`.
+      var rootID = this._rootNodeID + name;
+      var mountImage = child.mountComponent(
+        rootID,
+        transaction,
+        this._mountDepth + 1
+      );
+      child._mountIndex = index;
+      this.createChild(child, mountImage);
+      this._renderedChildren = this._renderedChildren || {};
+      this._renderedChildren[name] = child;
+    },
+
+    /**
+     * Unmounts a rendered child by name.
+     *
+     * NOTE: This is part of `updateChildren` and is here for readability.
+     *
+     * @param {ReactComponent} child Component to unmount.
+     * @param {string} name Name of the child in `this._renderedChildren`.
+     * @private
+     */
+    _unmountChildByName: function(child, name) {
+      // TODO: When is this not true?
+      if (ReactComponent.isValidComponent(child)) {
+        this.removeChild(child);
+        child._mountIndex = null;
+        child.unmountComponent();
+        delete this._renderedChildren[name];
+      }
+    }
+
+  }
+
+};
+
+module.exports = ReactMultiChild;
+
+},{"./ReactComponent":31,"./ReactMultiChildUpdateTypes":63,"./flattenChildren":112,"./instantiateReactComponent":124,"./shouldUpdateReactComponent":144}],63:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactMultiChildUpdateTypes
+ */
+
+"use strict";
+
+var keyMirror = _dereq_("./keyMirror");
+
+/**
+ * When a component's children are updated, a series of update configuration
+ * objects are created in order to batch and serialize the required changes.
+ *
+ * Enumerates all the possible types of update configurations.
+ *
+ * @internal
+ */
+var ReactMultiChildUpdateTypes = keyMirror({
+  INSERT_MARKUP: null,
+  MOVE_EXISTING: null,
+  REMOVE_NODE: null,
+  TEXT_CONTENT: null
+});
+
+module.exports = ReactMultiChildUpdateTypes;
+
+},{"./keyMirror":131}],64:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactOwner
+ */
+
+"use strict";
+
+var emptyObject = _dereq_("./emptyObject");
+var invariant = _dereq_("./invariant");
+
+/**
+ * ReactOwners are capable of storing references to owned components.
+ *
+ * All components are capable of //being// referenced by owner components, but
+ * only ReactOwner components are capable of //referencing// owned components.
+ * The named reference is known as a "ref".
+ *
+ * Refs are available when mounted and updated during reconciliation.
+ *
+ *   var MyComponent = React.createClass({
+ *     render: function() {
+ *       return (
+ *         <div onClick={this.handleClick}>
+ *           <CustomComponent ref="custom" />
+ *         </div>
+ *       );
+ *     },
+ *     handleClick: function() {
+ *       this.refs.custom.handleClick();
+ *     },
+ *     componentDidMount: function() {
+ *       this.refs.custom.initialize();
+ *     }
+ *   });
+ *
+ * Refs should rarely be used. When refs are used, they should only be done to
+ * control data that is not handled by React's data flow.
+ *
+ * @class ReactOwner
+ */
+var ReactOwner = {
+
+  /**
+   * @param {?object} object
+   * @return {boolean} True if `object` is a valid owner.
+   * @final
+   */
+  isValidOwner: function(object) {
+    return !!(
+      object &&
+      typeof object.attachRef === 'function' &&
+      typeof object.detachRef === 'function'
+    );
+  },
+
+  /**
+   * Adds a component by ref to an owner component.
+   *
+   * @param {ReactComponent} component Component to reference.
+   * @param {string} ref Name by which to refer to the component.
+   * @param {ReactOwner} owner Component on which to record the ref.
+   * @final
+   * @internal
+   */
+  addComponentAsRefTo: function(component, ref, owner) {
+    ("production" !== "development" ? invariant(
+      ReactOwner.isValidOwner(owner),
+      'addComponentAsRefTo(...): Only a ReactOwner can have refs. This ' +
+      'usually means that you\'re trying to add a ref to a component that ' +
+      'doesn\'t have an owner (that is, was not created inside of another ' +
+      'component\'s `render` method). Try rendering this component inside of ' +
+      'a new top-level component which will hold the ref.'
+    ) : invariant(ReactOwner.isValidOwner(owner)));
+    owner.attachRef(ref, component);
+  },
+
+  /**
+   * Removes a component by ref from an owner component.
+   *
+   * @param {ReactComponent} component Component to dereference.
+   * @param {string} ref Name of the ref to remove.
+   * @param {ReactOwner} owner Component on which the ref is recorded.
+   * @final
+   * @internal
+   */
+  removeComponentAsRefFrom: function(component, ref, owner) {
+    ("production" !== "development" ? invariant(
+      ReactOwner.isValidOwner(owner),
+      'removeComponentAsRefFrom(...): Only a ReactOwner can have refs. This ' +
+      'usually means that you\'re trying to remove a ref to a component that ' +
+      'doesn\'t have an owner (that is, was not created inside of another ' +
+      'component\'s `render` method). Try rendering this component inside of ' +
+      'a new top-level component which will hold the ref.'
+    ) : invariant(ReactOwner.isValidOwner(owner)));
+    // Check that `component` is still the current ref because we do not want to
+    // detach the ref if another component stole it.
+    if (owner.refs[ref] === component) {
+      owner.detachRef(ref);
+    }
+  },
+
+  /**
+   * A ReactComponent must mix this in to have refs.
+   *
+   * @lends {ReactOwner.prototype}
+   */
+  Mixin: {
+
+    construct: function() {
+      this.refs = emptyObject;
+    },
+
+    /**
+     * Lazily allocates the refs object and stores `component` as `ref`.
+     *
+     * @param {string} ref Reference name.
+     * @param {component} component Component to store as `ref`.
+     * @final
+     * @private
+     */
+    attachRef: function(ref, component) {
+      ("production" !== "development" ? invariant(
+        component.isOwnedBy(this),
+        'attachRef(%s, ...): Only a component\'s owner can store a ref to it.',
+        ref
+      ) : invariant(component.isOwnedBy(this)));
+      var refs = this.refs === emptyObject ? (this.refs = {}) : this.refs;
+      refs[ref] = component;
+    },
+
+    /**
+     * Detaches a reference name.
+     *
+     * @param {string} ref Name to dereference.
+     * @final
+     * @private
+     */
+    detachRef: function(ref) {
+      delete this.refs[ref];
+    }
+
+  }
+
+};
+
+module.exports = ReactOwner;
+
+},{"./emptyObject":110,"./invariant":125}],65:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactPerf
+ * @typechecks static-only
+ */
+
+"use strict";
+
+/**
+ * ReactPerf is a general AOP system designed to measure performance. This
+ * module only has the hooks: see ReactDefaultPerf for the analysis tool.
+ */
+var ReactPerf = {
+  /**
+   * Boolean to enable/disable measurement. Set to false by default to prevent
+   * accidental logging and perf loss.
+   */
+  enableMeasure: false,
+
+  /**
+   * Holds onto the measure function in use. By default, don't measure
+   * anything, but we'll override this if we inject a measure function.
+   */
+  storedMeasure: _noMeasure,
+
+  /**
+   * Use this to wrap methods you want to measure. Zero overhead in production.
+   *
+   * @param {string} objName
+   * @param {string} fnName
+   * @param {function} func
+   * @return {function}
+   */
+  measure: function(objName, fnName, func) {
+    if ("production" !== "development") {
+      var measuredFunc = null;
+      return function() {
+        if (ReactPerf.enableMeasure) {
+          if (!measuredFunc) {
+            measuredFunc = ReactPerf.storedMeasure(objName, fnName, func);
+          }
+          return measuredFunc.apply(this, arguments);
+        }
+        return func.apply(this, arguments);
+      };
+    }
+    return func;
+  },
+
+  injection: {
+    /**
+     * @param {function} measure
+     */
+    injectMeasure: function(measure) {
+      ReactPerf.storedMeasure = measure;
+    }
+  }
+};
+
+/**
+ * Simply passes through the measured function, without measuring it.
+ *
+ * @param {string} objName
+ * @param {string} fnName
+ * @param {function} func
+ * @return {function}
+ */
+function _noMeasure(objName, fnName, func) {
+  return func;
+}
+
+module.exports = ReactPerf;
+
+},{}],66:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactPropTransferer
+ */
+
+"use strict";
+
+var emptyFunction = _dereq_("./emptyFunction");
+var invariant = _dereq_("./invariant");
+var joinClasses = _dereq_("./joinClasses");
+var merge = _dereq_("./merge");
+
+/**
+ * Creates a transfer strategy that will merge prop values using the supplied
+ * `mergeStrategy`. If a prop was previously unset, this just sets it.
+ *
+ * @param {function} mergeStrategy
+ * @return {function}
+ */
+function createTransferStrategy(mergeStrategy) {
+  return function(props, key, value) {
+    if (!props.hasOwnProperty(key)) {
+      props[key] = value;
+    } else {
+      props[key] = mergeStrategy(props[key], value);
+    }
+  };
+}
+
+/**
+ * Transfer strategies dictate how props are transferred by `transferPropsTo`.
+ * NOTE: if you add any more exceptions to this list you should be sure to
+ * update `cloneWithProps()` accordingly.
+ */
+var TransferStrategies = {
+  /**
+   * Never transfer `children`.
+   */
+  children: emptyFunction,
+  /**
+   * Transfer the `className` prop by merging them.
+   */
+  className: createTransferStrategy(joinClasses),
+  /**
+   * Never transfer the `key` prop.
+   */
+  key: emptyFunction,
+  /**
+   * Never transfer the `ref` prop.
+   */
+  ref: emptyFunction,
+  /**
+   * Transfer the `style` prop (which is an object) by merging them.
+   */
+  style: createTransferStrategy(merge)
+};
+
+/**
+ * ReactPropTransferer are capable of transferring props to another component
+ * using a `transferPropsTo` method.
+ *
+ * @class ReactPropTransferer
+ */
+var ReactPropTransferer = {
+
+  TransferStrategies: TransferStrategies,
+
+  /**
+   * Merge two props objects using TransferStrategies.
+   *
+   * @param {object} oldProps original props (they take precedence)
+   * @param {object} newProps new props to merge in
+   * @return {object} a new object containing both sets of props merged.
+   */
+  mergeProps: function(oldProps, newProps) {
+    var props = merge(oldProps);
+
+    for (var thisKey in newProps) {
+      if (!newProps.hasOwnProperty(thisKey)) {
+        continue;
+      }
+
+      var transferStrategy = TransferStrategies[thisKey];
+
+      if (transferStrategy && TransferStrategies.hasOwnProperty(thisKey)) {
+        transferStrategy(props, thisKey, newProps[thisKey]);
+      } else if (!props.hasOwnProperty(thisKey)) {
+        props[thisKey] = newProps[thisKey];
+      }
+    }
+
+    return props;
+  },
+
+  /**
+   * @lends {ReactPropTransferer.prototype}
+   */
+  Mixin: {
+
+    /**
+     * Transfer props from this component to a target component.
+     *
+     * Props that do not have an explicit transfer strategy will be transferred
+     * only if the target component does not already have the prop set.
+     *
+     * This is usually used to pass down props to a returned root component.
+     *
+     * @param {ReactComponent} component Component receiving the properties.
+     * @return {ReactComponent} The supplied `component`.
+     * @final
+     * @protected
+     */
+    transferPropsTo: function(component) {
+      ("production" !== "development" ? invariant(
+        component._owner === this,
+        '%s: You can\'t call transferPropsTo() on a component that you ' +
+        'don\'t own, %s. This usually means you are calling ' +
+        'transferPropsTo() on a component passed in as props or children.',
+        this.constructor.displayName,
+        component.constructor.displayName
+      ) : invariant(component._owner === this));
+
+      component.props = ReactPropTransferer.mergeProps(
+        component.props,
+        this.props
+      );
+
+      return component;
+    }
+
+  }
+};
+
+module.exports = ReactPropTransferer;
+
+},{"./emptyFunction":109,"./invariant":125,"./joinClasses":130,"./merge":134}],67:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactPropTypeLocationNames
+ */
+
+"use strict";
+
+var ReactPropTypeLocationNames = {};
+
+if ("production" !== "development") {
+  ReactPropTypeLocationNames = {
+    prop: 'prop',
+    context: 'context',
+    childContext: 'child context'
+  };
+}
+
+module.exports = ReactPropTypeLocationNames;
+
+},{}],68:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactPropTypeLocations
+ */
+
+"use strict";
+
+var keyMirror = _dereq_("./keyMirror");
+
+var ReactPropTypeLocations = keyMirror({
+  prop: null,
+  context: null,
+  childContext: null
+});
+
+module.exports = ReactPropTypeLocations;
+
+},{"./keyMirror":131}],69:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactPropTypes
+ */
+
+"use strict";
+
+var ReactComponent = _dereq_("./ReactComponent");
+var ReactPropTypeLocationNames = _dereq_("./ReactPropTypeLocationNames");
+
+var warning = _dereq_("./warning");
+var createObjectFrom = _dereq_("./createObjectFrom");
+
+/**
+ * Collection of methods that allow declaration and validation of props that are
+ * supplied to React components. Example usage:
+ *
+ *   var Props = require('ReactPropTypes');
+ *   var MyArticle = React.createClass({
+ *     propTypes: {
+ *       // An optional string prop named "description".
+ *       description: Props.string,
+ *
+ *       // A required enum prop named "category".
+ *       category: Props.oneOf(['News','Photos']).isRequired,
+ *
+ *       // A prop named "dialog" that requires an instance of Dialog.
+ *       dialog: Props.instanceOf(Dialog).isRequired
+ *     },
+ *     render: function() { ... }
+ *   });
+ *
+ * A more formal specification of how these methods are used:
+ *
+ *   type := array|bool|func|object|number|string|oneOf([...])|instanceOf(...)
+ *   decl := ReactPropTypes.{type}(.isRequired)?
+ *
+ * Each and every declaration produces a function with the same signature. This
+ * allows the creation of custom validation functions. For example:
+ *
+ *   var Props = require('ReactPropTypes');
+ *   var MyLink = React.createClass({
+ *     propTypes: {
+ *       // An optional string or URI prop named "href".
+ *       href: function(props, propName, componentName) {
+ *         var propValue = props[propName];
+ *         warning(
+ *           propValue == null ||
+ *           typeof propValue === 'string' ||
+ *           propValue instanceof URI,
+ *           'Invalid `%s` supplied to `%s`, expected string or URI.',
+ *           propName,
+ *           componentName
+ *         );
+ *       }
+ *     },
+ *     render: function() { ... }
+ *   });
+ *
+ * @internal
+ */
+var Props = {
+
+  array: createPrimitiveTypeChecker('array'),
+  bool: createPrimitiveTypeChecker('boolean'),
+  func: createPrimitiveTypeChecker('function'),
+  number: createPrimitiveTypeChecker('number'),
+  object: createPrimitiveTypeChecker('object'),
+  string: createPrimitiveTypeChecker('string'),
+
+  shape: createShapeTypeChecker,
+  oneOf: createEnumTypeChecker,
+  oneOfType: createUnionTypeChecker,
+  arrayOf: createArrayOfTypeChecker,
+
+  instanceOf: createInstanceTypeChecker,
+
+  renderable: createRenderableTypeChecker(),
+
+  component: createComponentTypeChecker(),
+
+  any: createAnyTypeChecker()
+};
+
+var ANONYMOUS = '<<anonymous>>';
+
+function isRenderable(propValue) {
+  switch(typeof propValue) {
+    case 'number':
+    case 'string':
+      return true;
+    case 'object':
+      if (Array.isArray(propValue)) {
+        return propValue.every(isRenderable);
+      }
+      if (ReactComponent.isValidComponent(propValue)) {
+        return true;
+      }
+      for (var k in propValue) {
+        if (!isRenderable(propValue[k])) {
+          return false;
+        }
+      }
+      return true;
+    default:
+      return false;
+  }
+}
+
+// Equivalent of typeof but with special handling for arrays
+function getPropType(propValue) {
+  var propType = typeof propValue;
+  if (propType === 'object' && Array.isArray(propValue)) {
+    return 'array';
+  }
+  return propType;
+}
+
+function createAnyTypeChecker() {
+  function validateAnyType(
+    shouldWarn, propValue, propName, componentName, location
+  ) {
+    return true; // is always valid
+  }
+  return createChainableTypeChecker(validateAnyType);
+}
+
+function createPrimitiveTypeChecker(expectedType) {
+  function validatePrimitiveType(
+    shouldWarn, propValue, propName, componentName, location
+  ) {
+    var propType = getPropType(propValue);
+    var isValid = propType === expectedType;
+    if (shouldWarn) {
+      ("production" !== "development" ? warning(
+        isValid,
+        'Invalid %s `%s` of type `%s` supplied to `%s`, expected `%s`.',
+        ReactPropTypeLocationNames[location],
+        propName,
+        propType,
+        componentName,
+        expectedType
+      ) : null);
+    }
+    return isValid;
+  }
+  return createChainableTypeChecker(validatePrimitiveType);
+}
+
+function createEnumTypeChecker(expectedValues) {
+  var expectedEnum = createObjectFrom(expectedValues);
+  function validateEnumType(
+    shouldWarn, propValue, propName, componentName, location
+  ) {
+    var isValid = expectedEnum[propValue];
+    if (shouldWarn) {
+      ("production" !== "development" ? warning(
+        isValid,
+        'Invalid %s `%s` supplied to `%s`, expected one of %s.',
+        ReactPropTypeLocationNames[location],
+        propName,
+        componentName,
+        JSON.stringify(Object.keys(expectedEnum))
+      ) : null);
+    }
+    return isValid;
+  }
+  return createChainableTypeChecker(validateEnumType);
+}
+
+function createShapeTypeChecker(shapeTypes) {
+  function validateShapeType(
+    shouldWarn, propValue, propName, componentName, location
+  ) {
+    var propType = getPropType(propValue);
+    var isValid = propType === 'object';
+    if (isValid) {
+      for (var key in shapeTypes) {
+        var checker = shapeTypes[key];
+        if (checker && !checker(propValue, key, componentName, location)) {
+          return false;
+        }
+      }
+    }
+    if (shouldWarn) {
+      ("production" !== "development" ? warning(
+        isValid,
+        'Invalid %s `%s` of type `%s` supplied to `%s`, expected `object`.',
+        ReactPropTypeLocationNames[location],
+        propName,
+        propType,
+        componentName
+      ) : null);
+    }
+    return isValid;
+  }
+  return createChainableTypeChecker(validateShapeType);
+}
+
+function createInstanceTypeChecker(expectedClass) {
+  function validateInstanceType(
+    shouldWarn, propValue, propName, componentName, location
+  ) {
+    var isValid = propValue instanceof expectedClass;
+    if (shouldWarn) {
+      ("production" !== "development" ? warning(
+        isValid,
+        'Invalid %s `%s` supplied to `%s`, expected instance of `%s`.',
+        ReactPropTypeLocationNames[location],
+        propName,
+        componentName,
+        expectedClass.name || ANONYMOUS
+      ) : null);
+    }
+    return isValid;
+  }
+  return createChainableTypeChecker(validateInstanceType);
+}
+
+function createArrayOfTypeChecker(propTypeChecker) {
+  function validateArrayType(
+    shouldWarn, propValue, propName, componentName, location
+  ) {
+    var isValid = Array.isArray(propValue);
+    if (isValid) {
+      for (var i = 0; i < propValue.length; i++) {
+        if (!propTypeChecker(propValue, i, componentName, location)) {
+          return false;
+        }
+      }
+    }
+    if (shouldWarn) {
+      ("production" !== "development" ? warning(
+        isValid,
+        'Invalid %s `%s` supplied to `%s`, expected an array.',
+        ReactPropTypeLocationNames[location],
+        propName,
+        componentName
+      ) : null);
+    }
+    return isValid;
+  }
+  return createChainableTypeChecker(validateArrayType);
+}
+
+function createRenderableTypeChecker() {
+  function validateRenderableType(
+    shouldWarn, propValue, propName, componentName, location
+  ) {
+    var isValid = isRenderable(propValue);
+    if (shouldWarn) {
+      ("production" !== "development" ? warning(
+        isValid,
+        'Invalid %s `%s` supplied to `%s`, expected a renderable prop.',
+        ReactPropTypeLocationNames[location],
+        propName,
+        componentName
+      ) : null);
+    }
+    return isValid;
+  }
+  return createChainableTypeChecker(validateRenderableType);
+}
+
+function createComponentTypeChecker() {
+  function validateComponentType(
+    shouldWarn, propValue, propName, componentName, location
+  ) {
+    var isValid = ReactComponent.isValidComponent(propValue);
+    if (shouldWarn) {
+      ("production" !== "development" ? warning(
+        isValid,
+        'Invalid %s `%s` supplied to `%s`, expected a React component.',
+        ReactPropTypeLocationNames[location],
+        propName,
+        componentName
+      ) : null);
+    }
+    return isValid;
+  }
+  return createChainableTypeChecker(validateComponentType);
+}
+
+function createUnionTypeChecker(arrayOfValidators) {
+  return function(props, propName, componentName, location) {
+    var isValid = false;
+    for (var ii = 0; ii < arrayOfValidators.length; ii++) {
+      var validate = arrayOfValidators[ii];
+      if (typeof validate.weak === 'function') {
+        validate = validate.weak;
+      }
+      if (validate(props, propName, componentName, location)) {
+        isValid = true;
+        break;
+      }
+    }
+    ("production" !== "development" ? warning(
+      isValid,
+      'Invalid %s `%s` supplied to `%s`.',
+      ReactPropTypeLocationNames[location],
+      propName,
+      componentName || ANONYMOUS
+    ) : null);
+    return isValid;
+  };
+}
+
+function createChainableTypeChecker(validate) {
+  function checkType(
+    isRequired, shouldWarn, props, propName, componentName, location
+  ) {
+    var propValue = props[propName];
+    if (propValue != null) {
+      // Only validate if there is a value to check.
+      return validate(
+        shouldWarn,
+        propValue,
+        propName,
+        componentName || ANONYMOUS,
+        location
+      );
+    } else {
+      var isValid = !isRequired;
+      if (shouldWarn) {
+        ("production" !== "development" ? warning(
+          isValid,
+          'Required %s `%s` was not specified in `%s`.',
+          ReactPropTypeLocationNames[location],
+          propName,
+          componentName || ANONYMOUS
+        ) : null);
+      }
+      return isValid;
+    }
+  }
+
+  var checker = checkType.bind(null, false, true);
+  checker.weak = checkType.bind(null, false, false);
+  checker.isRequired = checkType.bind(null, true, true);
+  checker.weak.isRequired = checkType.bind(null, true, false);
+  checker.isRequired.weak = checker.weak.isRequired;
+
+  return checker;
+}
+
+module.exports = Props;
+
+},{"./ReactComponent":31,"./ReactPropTypeLocationNames":67,"./createObjectFrom":106,"./warning":148}],70:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactPutListenerQueue
+ */
+
+"use strict";
+
+var PooledClass = _dereq_("./PooledClass");
+var ReactEventEmitter = _dereq_("./ReactEventEmitter");
+
+var mixInto = _dereq_("./mixInto");
+
+function ReactPutListenerQueue() {
+  this.listenersToPut = [];
+}
+
+mixInto(ReactPutListenerQueue, {
+  enqueuePutListener: function(rootNodeID, propKey, propValue) {
+    this.listenersToPut.push({
+      rootNodeID: rootNodeID,
+      propKey: propKey,
+      propValue: propValue
+    });
+  },
+
+  putListeners: function() {
+    for (var i = 0; i < this.listenersToPut.length; i++) {
+      var listenerToPut = this.listenersToPut[i];
+      ReactEventEmitter.putListener(
+        listenerToPut.rootNodeID,
+        listenerToPut.propKey,
+        listenerToPut.propValue
+      );
+    }
+  },
+
+  reset: function() {
+    this.listenersToPut.length = 0;
+  },
+
+  destructor: function() {
+    this.reset();
+  }
+});
+
+PooledClass.addPoolingTo(ReactPutListenerQueue);
+
+module.exports = ReactPutListenerQueue;
+
+},{"./PooledClass":25,"./ReactEventEmitter":52,"./mixInto":137}],71:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactReconcileTransaction
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var PooledClass = _dereq_("./PooledClass");
+var ReactEventEmitter = _dereq_("./ReactEventEmitter");
+var ReactInputSelection = _dereq_("./ReactInputSelection");
+var ReactMountReady = _dereq_("./ReactMountReady");
+var ReactPutListenerQueue = _dereq_("./ReactPutListenerQueue");
+var Transaction = _dereq_("./Transaction");
+
+var mixInto = _dereq_("./mixInto");
+
+/**
+ * Ensures that, when possible, the selection range (currently selected text
+ * input) is not disturbed by performing the transaction.
+ */
+var SELECTION_RESTORATION = {
+  /**
+   * @return {Selection} Selection information.
+   */
+  initialize: ReactInputSelection.getSelectionInformation,
+  /**
+   * @param {Selection} sel Selection information returned from `initialize`.
+   */
+  close: ReactInputSelection.restoreSelection
+};
+
+/**
+ * Suppresses events (blur/focus) that could be inadvertently dispatched due to
+ * high level DOM manipulations (like temporarily removing a text input from the
+ * DOM).
+ */
+var EVENT_SUPPRESSION = {
+  /**
+   * @return {boolean} The enabled status of `ReactEventEmitter` before the
+   * reconciliation.
+   */
+  initialize: function() {
+    var currentlyEnabled = ReactEventEmitter.isEnabled();
+    ReactEventEmitter.setEnabled(false);
+    return currentlyEnabled;
+  },
+
+  /**
+   * @param {boolean} previouslyEnabled Enabled status of `ReactEventEmitter`
+   *   before the reconciliation occured. `close` restores the previous value.
+   */
+  close: function(previouslyEnabled) {
+    ReactEventEmitter.setEnabled(previouslyEnabled);
+  }
+};
+
+/**
+ * Provides a `ReactMountReady` queue for collecting `onDOMReady` callbacks
+ * during the performing of the transaction.
+ */
+var ON_DOM_READY_QUEUEING = {
+  /**
+   * Initializes the internal `onDOMReady` queue.
+   */
+  initialize: function() {
+    this.reactMountReady.reset();
+  },
+
+  /**
+   * After DOM is flushed, invoke all registered `onDOMReady` callbacks.
+   */
+  close: function() {
+    this.reactMountReady.notifyAll();
+  }
+};
+
+var PUT_LISTENER_QUEUEING = {
+  initialize: function() {
+    this.putListenerQueue.reset();
+  },
+
+  close: function() {
+    this.putListenerQueue.putListeners();
+  }
+};
+
+/**
+ * Executed within the scope of the `Transaction` instance. Consider these as
+ * being member methods, but with an implied ordering while being isolated from
+ * each other.
+ */
+var TRANSACTION_WRAPPERS = [
+  PUT_LISTENER_QUEUEING,
+  SELECTION_RESTORATION,
+  EVENT_SUPPRESSION,
+  ON_DOM_READY_QUEUEING
+];
+
+/**
+ * Currently:
+ * - The order that these are listed in the transaction is critical:
+ * - Suppresses events.
+ * - Restores selection range.
+ *
+ * Future:
+ * - Restore document/overflow scroll positions that were unintentionally
+ *   modified via DOM insertions above the top viewport boundary.
+ * - Implement/integrate with customized constraint based layout system and keep
+ *   track of which dimensions must be remeasured.
+ *
+ * @class ReactReconcileTransaction
+ */
+function ReactReconcileTransaction() {
+  this.reinitializeTransaction();
+  // Only server-side rendering really needs this option (see
+  // `ReactServerRendering`), but server-side uses
+  // `ReactServerRenderingTransaction` instead. This option is here so that it's
+  // accessible and defaults to false when `ReactDOMComponent` and
+  // `ReactTextComponent` checks it in `mountComponent`.`
+  this.renderToStaticMarkup = false;
+  this.reactMountReady = ReactMountReady.getPooled(null);
+  this.putListenerQueue = ReactPutListenerQueue.getPooled();
+}
+
+var Mixin = {
+  /**
+   * @see Transaction
+   * @abstract
+   * @final
+   * @return {array<object>} List of operation wrap proceedures.
+   *   TODO: convert to array<TransactionWrapper>
+   */
+  getTransactionWrappers: function() {
+    return TRANSACTION_WRAPPERS;
+  },
+
+  /**
+   * @return {object} The queue to collect `onDOMReady` callbacks with.
+   *   TODO: convert to ReactMountReady
+   */
+  getReactMountReady: function() {
+    return this.reactMountReady;
+  },
+
+  getPutListenerQueue: function() {
+    return this.putListenerQueue;
+  },
+
+  /**
+   * `PooledClass` looks for this, and will invoke this before allowing this
+   * instance to be resused.
+   */
+  destructor: function() {
+    ReactMountReady.release(this.reactMountReady);
+    this.reactMountReady = null;
+
+    ReactPutListenerQueue.release(this.putListenerQueue);
+    this.putListenerQueue = null;
+  }
+};
+
+
+mixInto(ReactReconcileTransaction, Transaction.Mixin);
+mixInto(ReactReconcileTransaction, Mixin);
+
+PooledClass.addPoolingTo(ReactReconcileTransaction);
+
+module.exports = ReactReconcileTransaction;
+
+},{"./PooledClass":25,"./ReactEventEmitter":52,"./ReactInputSelection":56,"./ReactMountReady":61,"./ReactPutListenerQueue":70,"./Transaction":96,"./mixInto":137}],72:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactRootIndex
+ * @typechecks
+ */
+
+"use strict";
+
+var ReactRootIndexInjection = {
+  /**
+   * @param {function} _createReactRootIndex
+   */
+  injectCreateReactRootIndex: function(_createReactRootIndex) {
+    ReactRootIndex.createReactRootIndex = _createReactRootIndex;
+  }
+};
+
+var ReactRootIndex = {
+  createReactRootIndex: null,
+  injection: ReactRootIndexInjection
+};
+
+module.exports = ReactRootIndex;
+
+},{}],73:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @typechecks static-only
+ * @providesModule ReactServerRendering
+ */
+"use strict";
+
+var ReactComponent = _dereq_("./ReactComponent");
+var ReactInstanceHandles = _dereq_("./ReactInstanceHandles");
+var ReactMarkupChecksum = _dereq_("./ReactMarkupChecksum");
+var ReactServerRenderingTransaction =
+  _dereq_("./ReactServerRenderingTransaction");
+
+var instantiateReactComponent = _dereq_("./instantiateReactComponent");
+var invariant = _dereq_("./invariant");
+
+/**
+ * @param {ReactComponent} component
+ * @return {string} the HTML markup
+ */
+function renderComponentToString(component) {
+  ("production" !== "development" ? invariant(
+    ReactComponent.isValidComponent(component),
+    'renderComponentToString(): You must pass a valid ReactComponent.'
+  ) : invariant(ReactComponent.isValidComponent(component)));
+
+  ("production" !== "development" ? invariant(
+    !(arguments.length === 2 && typeof arguments[1] === 'function'),
+    'renderComponentToString(): This function became synchronous and now ' +
+    'returns the generated markup. Please remove the second parameter.'
+  ) : invariant(!(arguments.length === 2 && typeof arguments[1] === 'function')));
+
+  var transaction;
+  try {
+    var id = ReactInstanceHandles.createReactRootID();
+    transaction = ReactServerRenderingTransaction.getPooled(false);
+
+    return transaction.perform(function() {
+      var componentInstance = instantiateReactComponent(component);
+      var markup = componentInstance.mountComponent(id, transaction, 0);
+      return ReactMarkupChecksum.addChecksumToMarkup(markup);
+    }, null);
+  } finally {
+    ReactServerRenderingTransaction.release(transaction);
+  }
+}
+
+/**
+ * @param {ReactComponent} component
+ * @return {string} the HTML markup, without the extra React ID and checksum
+* (for generating static pages)
+ */
+function renderComponentToStaticMarkup(component) {
+  ("production" !== "development" ? invariant(
+    ReactComponent.isValidComponent(component),
+    'renderComponentToStaticMarkup(): You must pass a valid ReactComponent.'
+  ) : invariant(ReactComponent.isValidComponent(component)));
+
+  var transaction;
+  try {
+    var id = ReactInstanceHandles.createReactRootID();
+    transaction = ReactServerRenderingTransaction.getPooled(true);
+
+    return transaction.perform(function() {
+      var componentInstance = instantiateReactComponent(component);
+      return componentInstance.mountComponent(id, transaction, 0);
+    }, null);
+  } finally {
+    ReactServerRenderingTransaction.release(transaction);
+  }
+}
+
+module.exports = {
+  renderComponentToString: renderComponentToString,
+  renderComponentToStaticMarkup: renderComponentToStaticMarkup
+};
+
+},{"./ReactComponent":31,"./ReactInstanceHandles":57,"./ReactMarkupChecksum":59,"./ReactServerRenderingTransaction":74,"./instantiateReactComponent":124,"./invariant":125}],74:[function(_dereq_,module,exports){
+/**
+ * Copyright 2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactServerRenderingTransaction
+ * @typechecks
+ */
+
+"use strict";
+
+var PooledClass = _dereq_("./PooledClass");
+var ReactMountReady = _dereq_("./ReactMountReady");
+var ReactPutListenerQueue = _dereq_("./ReactPutListenerQueue");
+var Transaction = _dereq_("./Transaction");
+
+var emptyFunction = _dereq_("./emptyFunction");
+var mixInto = _dereq_("./mixInto");
+
+/**
+ * Provides a `ReactMountReady` queue for collecting `onDOMReady` callbacks
+ * during the performing of the transaction.
+ */
+var ON_DOM_READY_QUEUEING = {
+  /**
+   * Initializes the internal `onDOMReady` queue.
+   */
+  initialize: function() {
+    this.reactMountReady.reset();
+  },
+
+  close: emptyFunction
+};
+
+var PUT_LISTENER_QUEUEING = {
+  initialize: function() {
+    this.putListenerQueue.reset();
+  },
+
+  close: emptyFunction
+};
+
+/**
+ * Executed within the scope of the `Transaction` instance. Consider these as
+ * being member methods, but with an implied ordering while being isolated from
+ * each other.
+ */
+var TRANSACTION_WRAPPERS = [
+  PUT_LISTENER_QUEUEING,
+  ON_DOM_READY_QUEUEING
+];
+
+/**
+ * @class ReactServerRenderingTransaction
+ * @param {boolean} renderToStaticMarkup
+ */
+function ReactServerRenderingTransaction(renderToStaticMarkup) {
+  this.reinitializeTransaction();
+  this.renderToStaticMarkup = renderToStaticMarkup;
+  this.reactMountReady = ReactMountReady.getPooled(null);
+  this.putListenerQueue = ReactPutListenerQueue.getPooled();
+}
+
+var Mixin = {
+  /**
+   * @see Transaction
+   * @abstract
+   * @final
+   * @return {array} Empty list of operation wrap proceedures.
+   */
+  getTransactionWrappers: function() {
+    return TRANSACTION_WRAPPERS;
+  },
+
+  /**
+   * @return {object} The queue to collect `onDOMReady` callbacks with.
+   *   TODO: convert to ReactMountReady
+   */
+  getReactMountReady: function() {
+    return this.reactMountReady;
+  },
+
+  getPutListenerQueue: function() {
+    return this.putListenerQueue;
+  },
+
+  /**
+   * `PooledClass` looks for this, and will invoke this before allowing this
+   * instance to be resused.
+   */
+  destructor: function() {
+    ReactMountReady.release(this.reactMountReady);
+    this.reactMountReady = null;
+
+    ReactPutListenerQueue.release(this.putListenerQueue);
+    this.putListenerQueue = null;
+  }
+};
+
+
+mixInto(ReactServerRenderingTransaction, Transaction.Mixin);
+mixInto(ReactServerRenderingTransaction, Mixin);
+
+PooledClass.addPoolingTo(ReactServerRenderingTransaction);
+
+module.exports = ReactServerRenderingTransaction;
+
+},{"./PooledClass":25,"./ReactMountReady":61,"./ReactPutListenerQueue":70,"./Transaction":96,"./emptyFunction":109,"./mixInto":137}],75:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactStateSetters
+ */
+
+"use strict";
+
+var ReactStateSetters = {
+  /**
+   * Returns a function that calls the provided function, and uses the result
+   * of that to set the component's state.
+   *
+   * @param {ReactCompositeComponent} component
+   * @param {function} funcReturningState Returned callback uses this to
+   *                                      determine how to update state.
+   * @return {function} callback that when invoked uses funcReturningState to
+   *                    determined the object literal to setState.
+   */
+  createStateSetter: function(component, funcReturningState) {
+    return function(a, b, c, d, e, f) {
+      var partialState = funcReturningState.call(component, a, b, c, d, e, f);
+      if (partialState) {
+        component.setState(partialState);
+      }
+    };
+  },
+
+  /**
+   * Returns a single-argument callback that can be used to update a single
+   * key in the component's state.
+   *
+   * Note: this is memoized function, which makes it inexpensive to call.
+   *
+   * @param {ReactCompositeComponent} component
+   * @param {string} key The key in the state that you should update.
+   * @return {function} callback of 1 argument which calls setState() with
+   *                    the provided keyName and callback argument.
+   */
+  createStateKeySetter: function(component, key) {
+    // Memoize the setters.
+    var cache = component.__keySetters || (component.__keySetters = {});
+    return cache[key] || (cache[key] = createStateKeySetter(component, key));
+  }
+};
+
+function createStateKeySetter(component, key) {
+  // Partial state is allocated outside of the function closure so it can be
+  // reused with every call, avoiding memory allocation when this function
+  // is called.
+  var partialState = {};
+  return function stateKeySetter(value) {
+    partialState[key] = value;
+    component.setState(partialState);
+  };
+}
+
+ReactStateSetters.Mixin = {
+  /**
+   * Returns a function that calls the provided function, and uses the result
+   * of that to set the component's state.
+   *
+   * For example, these statements are equivalent:
+   *
+   *   this.setState({x: 1});
+   *   this.createStateSetter(function(xValue) {
+   *     return {x: xValue};
+   *   })(1);
+   *
+   * @param {function} funcReturningState Returned callback uses this to
+   *                                      determine how to update state.
+   * @return {function} callback that when invoked uses funcReturningState to
+   *                    determined the object literal to setState.
+   */
+  createStateSetter: function(funcReturningState) {
+    return ReactStateSetters.createStateSetter(this, funcReturningState);
+  },
+
+  /**
+   * Returns a single-argument callback that can be used to update a single
+   * key in the component's state.
+   *
+   * For example, these statements are equivalent:
+   *
+   *   this.setState({x: 1});
+   *   this.createStateKeySetter('x')(1);
+   *
+   * Note: this is memoized function, which makes it inexpensive to call.
+   *
+   * @param {string} key The key in the state that you should update.
+   * @return {function} callback of 1 argument which calls setState() with
+   *                    the provided keyName and callback argument.
+   */
+  createStateKeySetter: function(key) {
+    return ReactStateSetters.createStateKeySetter(this, key);
+  }
+};
+
+module.exports = ReactStateSetters;
+
+},{}],76:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactTestUtils
+ */
+
+"use strict";
+
+var EventConstants = _dereq_("./EventConstants");
+var EventPluginHub = _dereq_("./EventPluginHub");
+var EventPropagators = _dereq_("./EventPropagators");
+var React = _dereq_("./React");
+var ReactComponent = _dereq_("./ReactComponent");
+var ReactDOM = _dereq_("./ReactDOM");
+var ReactEventEmitter = _dereq_("./ReactEventEmitter");
+var ReactMount = _dereq_("./ReactMount");
+var ReactTextComponent = _dereq_("./ReactTextComponent");
+var ReactUpdates = _dereq_("./ReactUpdates");
+var SyntheticEvent = _dereq_("./SyntheticEvent");
+
+var mergeInto = _dereq_("./mergeInto");
+var copyProperties = _dereq_("./copyProperties");
+
+var topLevelTypes = EventConstants.topLevelTypes;
+
+function Event(suffix) {}
+
+/**
+ * @class ReactTestUtils
+ */
+
+/**
+ * Todo: Support the entire DOM.scry query syntax. For now, these simple
+ * utilities will suffice for testing purposes.
+ * @lends ReactTestUtils
+ */
+var ReactTestUtils = {
+  renderIntoDocument: function(instance) {
+    var div = document.createElement('div');
+    // None of our tests actually require attaching the container to the
+    // DOM, and doing so creates a mess that we rely on test isolation to
+    // clean up, so we're going to stop honoring the name of this method
+    // (and probably rename it eventually) if no problems arise.
+    // document.documentElement.appendChild(div);
+    return React.renderComponent(instance, div);
+  },
+
+  isComponentOfType: function(inst, convenienceConstructor) {
+    return (
+      ReactComponent.isValidComponent(inst) &&
+      inst.type === convenienceConstructor.type
+    );
+  },
+
+  isDOMComponent: function(inst) {
+    return !!(inst &&
+              ReactComponent.isValidComponent(inst) &&
+              !!inst.tagName);
+  },
+
+  isCompositeComponent: function(inst) {
+    if (!ReactComponent.isValidComponent(inst)) {
+      return false;
+    }
+    // We check the prototype of the type that will get mounted, not the
+    // instance itself. This is a future proof way of duck typing.
+    var prototype = inst.type.prototype;
+    return (
+      typeof prototype.render === 'function' &&
+      typeof prototype.setState === 'function' &&
+      typeof prototype.updateComponent === 'function'
+    );
+  },
+
+  isCompositeComponentWithType: function(inst, type) {
+    return !!(ReactTestUtils.isCompositeComponent(inst) &&
+             (inst.constructor === type.componentConstructor ||
+              inst.constructor === type));
+  },
+
+  isTextComponent: function(inst) {
+    return inst instanceof ReactTextComponent;
+  },
+
+  findAllInRenderedTree: function(inst, test) {
+    if (!inst) {
+      return [];
+    }
+    var ret = test(inst) ? [inst] : [];
+    if (ReactTestUtils.isDOMComponent(inst)) {
+      var renderedChildren = inst._renderedChildren;
+      var key;
+      for (key in renderedChildren) {
+        if (!renderedChildren.hasOwnProperty(key)) {
+          continue;
+        }
+        ret = ret.concat(
+          ReactTestUtils.findAllInRenderedTree(renderedChildren[key], test)
+        );
+      }
+    } else if (ReactTestUtils.isCompositeComponent(inst)) {
+      ret = ret.concat(
+        ReactTestUtils.findAllInRenderedTree(inst._renderedComponent, test)
+      );
+    }
+    return ret;
+  },
+
+  /**
+   * Finds all instance of components in the rendered tree that are DOM
+   * components with the class name matching `className`.
+   * @return an array of all the matches.
+   */
+  scryRenderedDOMComponentsWithClass: function(root, className) {
+    return ReactTestUtils.findAllInRenderedTree(root, function(inst) {
+      var instClassName = inst.props.className;
+      return ReactTestUtils.isDOMComponent(inst) && (
+        instClassName &&
+        (' ' + instClassName + ' ').indexOf(' ' + className + ' ') !== -1
+      );
+    });
+  },
+
+  /**
+   * Like scryRenderedDOMComponentsWithClass but expects there to be one result,
+   * and returns that one result, or throws exception if there is any other
+   * number of matches besides one.
+   * @return {!ReactDOMComponent} The one match.
+   */
+  findRenderedDOMComponentWithClass: function(root, className) {
+    var all =
+      ReactTestUtils.scryRenderedDOMComponentsWithClass(root, className);
+    if (all.length !== 1) {
+      throw new Error('Did not find exactly one match for class:' + className);
+    }
+    return all[0];
+  },
+
+
+  /**
+   * Finds all instance of components in the rendered tree that are DOM
+   * components with the tag name matching `tagName`.
+   * @return an array of all the matches.
+   */
+  scryRenderedDOMComponentsWithTag: function(root, tagName) {
+    return ReactTestUtils.findAllInRenderedTree(root, function(inst) {
+      return ReactTestUtils.isDOMComponent(inst) &&
+            inst.tagName === tagName.toUpperCase();
+    });
+  },
+
+  /**
+   * Like scryRenderedDOMComponentsWithTag but expects there to be one result,
+   * and returns that one result, or throws exception if there is any other
+   * number of matches besides one.
+   * @return {!ReactDOMComponent} The one match.
+   */
+  findRenderedDOMComponentWithTag: function(root, tagName) {
+    var all = ReactTestUtils.scryRenderedDOMComponentsWithTag(root, tagName);
+    if (all.length !== 1) {
+      throw new Error('Did not find exactly one match for tag:' + tagName);
+    }
+    return all[0];
+  },
+
+
+  /**
+   * Finds all instances of components with type equal to `componentType`.
+   * @return an array of all the matches.
+   */
+  scryRenderedComponentsWithType: function(root, componentType) {
+    return ReactTestUtils.findAllInRenderedTree(root, function(inst) {
+      return ReactTestUtils.isCompositeComponentWithType(inst, componentType);
+    });
+  },
+
+  /**
+   * Same as `scryRenderedComponentsWithType` but expects there to be one result
+   * and returns that one result, or throws exception if there is any other
+   * number of matches besides one.
+   * @return {!ReactComponent} The one match.
+   */
+  findRenderedComponentWithType: function(root, componentType) {
+    var all = ReactTestUtils.scryRenderedComponentsWithType(
+      root,
+      componentType
+    );
+    if (all.length !== 1) {
+      throw new Error(
+        'Did not find exactly one match for componentType:' + componentType
+      );
+    }
+    return all[0];
+  },
+
+  /**
+   * Pass a mocked component module to this method to augment it with
+   * useful methods that allow it to be used as a dummy React component.
+   * Instead of rendering as usual, the component will become a simple
+   * <div> containing any provided children.
+   *
+   * @param {object} module the mock function object exported from a
+   *                        module that defines the component to be mocked
+   * @param {?string} mockTagName optional dummy root tag name to return
+   *                              from render method (overrides
+   *                              module.mockTagName if provided)
+   * @return {object} the ReactTestUtils object (for chaining)
+   */
+  mockComponent: function(module, mockTagName) {
+    var ConvenienceConstructor = React.createClass({
+      render: function() {
+        var mockTagName = mockTagName || module.mockTagName || "div";
+        return ReactDOM[mockTagName](null, this.props.children);
+      }
+    });
+
+    copyProperties(module, ConvenienceConstructor);
+    module.mockImplementation(ConvenienceConstructor);
+
+    return this;
+  },
+
+  /**
+   * Simulates a top level event being dispatched from a raw event that occured
+   * on an `Element` node.
+   * @param topLevelType {Object} A type from `EventConstants.topLevelTypes`
+   * @param {!Element} node The dom to simulate an event occurring on.
+   * @param {?Event} fakeNativeEvent Fake native event to use in SyntheticEvent.
+   */
+  simulateNativeEventOnNode: function(topLevelType, node, fakeNativeEvent) {
+    var virtualHandler =
+      ReactEventEmitter.TopLevelCallbackCreator.createTopLevelCallback(
+        topLevelType
+      );
+    fakeNativeEvent.target = node;
+    virtualHandler(fakeNativeEvent);
+  },
+
+  /**
+   * Simulates a top level event being dispatched from a raw event that occured
+   * on the `ReactDOMComponent` `comp`.
+   * @param topLevelType {Object} A type from `EventConstants.topLevelTypes`.
+   * @param comp {!ReactDOMComponent}
+   * @param {?Event} fakeNativeEvent Fake native event to use in SyntheticEvent.
+   */
+  simulateNativeEventOnDOMComponent: function(
+      topLevelType,
+      comp,
+      fakeNativeEvent) {
+    ReactTestUtils.simulateNativeEventOnNode(
+      topLevelType,
+      comp.getDOMNode(),
+      fakeNativeEvent
+    );
+  },
+
+  nativeTouchData: function(x, y) {
+    return {
+      touches: [
+        {pageX: x, pageY: y}
+      ]
+    };
+  },
+
+  Simulate: null,
+  SimulateNative: {}
+};
+
+/**
+ * Exports:
+ *
+ * - `ReactTestUtils.Simulate.click(Element/ReactDOMComponent)`
+ * - `ReactTestUtils.Simulate.mouseMove(Element/ReactDOMComponent)`
+ * - `ReactTestUtils.Simulate.change(Element/ReactDOMComponent)`
+ * - ... (All keys from event plugin `eventTypes` objects)
+ */
+function makeSimulator(eventType) {
+  return function(domComponentOrNode, eventData) {
+    var node;
+    if (ReactTestUtils.isDOMComponent(domComponentOrNode)) {
+      node = domComponentOrNode.getDOMNode();
+    } else if (domComponentOrNode.tagName) {
+      node = domComponentOrNode;
+    }
+
+    var fakeNativeEvent = new Event();
+    fakeNativeEvent.target = node;
+    // We don't use SyntheticEvent.getPooled in order to not have to worry about
+    // properly destroying any properties assigned from `eventData` upon release
+    var event = new SyntheticEvent(
+      ReactEventEmitter.eventNameDispatchConfigs[eventType],
+      ReactMount.getID(node),
+      fakeNativeEvent
+    );
+    mergeInto(event, eventData);
+    EventPropagators.accumulateTwoPhaseDispatches(event);
+
+    ReactUpdates.batchedUpdates(function() {
+      EventPluginHub.enqueueEvents(event);
+      EventPluginHub.processEventQueue();
+    });
+  };
+}
+
+function buildSimulators() {
+  ReactTestUtils.Simulate = {};
+
+  var eventType;
+  for (eventType in ReactEventEmitter.eventNameDispatchConfigs) {
+    /**
+     * @param {!Element || ReactDOMComponent} domComponentOrNode
+     * @param {?object} eventData Fake event data to use in SyntheticEvent.
+     */
+    ReactTestUtils.Simulate[eventType] = makeSimulator(eventType);
+  }
+}
+
+// Rebuild ReactTestUtils.Simulate whenever event plugins are injected
+var oldInjectEventPluginOrder = EventPluginHub.injection.injectEventPluginOrder;
+EventPluginHub.injection.injectEventPluginOrder = function() {
+  oldInjectEventPluginOrder.apply(this, arguments);
+  buildSimulators();
+};
+var oldInjectEventPlugins = EventPluginHub.injection.injectEventPluginsByName;
+EventPluginHub.injection.injectEventPluginsByName = function() {
+  oldInjectEventPlugins.apply(this, arguments);
+  buildSimulators();
+};
+
+buildSimulators();
+
+/**
+ * Exports:
+ *
+ * - `ReactTestUtils.SimulateNative.click(Element/ReactDOMComponent)`
+ * - `ReactTestUtils.SimulateNative.mouseMove(Element/ReactDOMComponent)`
+ * - `ReactTestUtils.SimulateNative.mouseIn/ReactDOMComponent)`
+ * - `ReactTestUtils.SimulateNative.mouseOut(Element/ReactDOMComponent)`
+ * - ... (All keys from `EventConstants.topLevelTypes`)
+ *
+ * Note: Top level event types are a subset of the entire set of handler types
+ * (which include a broader set of "synthetic" events). For example, onDragDone
+ * is a synthetic event. Except when testing an event plugin or React's event
+ * handling code specifically, you probably want to use ReactTestUtils.Simulate
+ * to dispatch synthetic events.
+ */
+
+function makeNativeSimulator(eventType) {
+  return function(domComponentOrNode, nativeEventData) {
+    var fakeNativeEvent = new Event(eventType);
+    mergeInto(fakeNativeEvent, nativeEventData);
+    if (ReactTestUtils.isDOMComponent(domComponentOrNode)) {
+      ReactTestUtils.simulateNativeEventOnDOMComponent(
+        eventType,
+        domComponentOrNode,
+        fakeNativeEvent
+      );
+    } else if (!!domComponentOrNode.tagName) {
+      // Will allow on actual dom nodes.
+      ReactTestUtils.simulateNativeEventOnNode(
+        eventType,
+        domComponentOrNode,
+        fakeNativeEvent
+      );
+    }
+  };
+}
+
+var eventType;
+for (eventType in topLevelTypes) {
+  // Event type is stored as 'topClick' - we transform that to 'click'
+  var convenienceName = eventType.indexOf('top') === 0 ?
+    eventType.charAt(3).toLowerCase() + eventType.substr(4) : eventType;
+  /**
+   * @param {!Element || ReactDOMComponent} domComponentOrNode
+   * @param {?Event} nativeEventData Fake native event to use in SyntheticEvent.
+   */
+  ReactTestUtils.SimulateNative[convenienceName] =
+    makeNativeSimulator(eventType);
+}
+
+module.exports = ReactTestUtils;
+
+},{"./EventConstants":15,"./EventPluginHub":17,"./EventPropagators":20,"./React":26,"./ReactComponent":31,"./ReactDOM":36,"./ReactEventEmitter":52,"./ReactMount":60,"./ReactTextComponent":77,"./ReactUpdates":81,"./SyntheticEvent":89,"./copyProperties":102,"./mergeInto":136}],77:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactTextComponent
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var DOMPropertyOperations = _dereq_("./DOMPropertyOperations");
+var ReactBrowserComponentMixin = _dereq_("./ReactBrowserComponentMixin");
+var ReactComponent = _dereq_("./ReactComponent");
+
+var escapeTextForBrowser = _dereq_("./escapeTextForBrowser");
+var mixInto = _dereq_("./mixInto");
+
+/**
+ * Text nodes violate a couple assumptions that React makes about components:
+ *
+ *  - When mounting text into the DOM, adjacent text nodes are merged.
+ *  - Text nodes cannot be assigned a React root ID.
+ *
+ * This component is used to wrap strings in elements so that they can undergo
+ * the same reconciliation that is applied to elements.
+ *
+ * TODO: Investigate representing React components in the DOM with text nodes.
+ *
+ * @class ReactTextComponent
+ * @extends ReactComponent
+ * @internal
+ */
+var ReactTextComponent = function(initialText) {
+  this.construct({text: initialText});
+};
+
+/**
+ * Used to clone the text descriptor object before it's mounted.
+ *
+ * @param {object} props
+ * @return {object} A new ReactTextComponent instance
+ */
+ReactTextComponent.ConvenienceConstructor = function(props) {
+  return new ReactTextComponent(props.text);
+};
+
+mixInto(ReactTextComponent, ReactComponent.Mixin);
+mixInto(ReactTextComponent, ReactBrowserComponentMixin);
+mixInto(ReactTextComponent, {
+
+  /**
+   * Creates the markup for this text node. This node is not intended to have
+   * any features besides containing text content.
+   *
+   * @param {string} rootID DOM ID of the root node.
+   * @param {ReactReconcileTransaction|ReactServerRenderingTransaction} transaction
+   * @param {number} mountDepth number of components in the owner hierarchy
+   * @return {string} Markup for this text node.
+   * @internal
+   */
+  mountComponent: function(rootID, transaction, mountDepth) {
+    ReactComponent.Mixin.mountComponent.call(
+      this,
+      rootID,
+      transaction,
+      mountDepth
+    );
+
+    var escapedText = escapeTextForBrowser(this.props.text);
+
+    if (transaction.renderToStaticMarkup) {
+      // Normally we'd wrap this in a `span` for the reasons stated above, but
+      // since this is a situation where React won't take over (static pages),
+      // we can simply return the text as it is.
+      return escapedText;
+    }
+
+    return (
+      '<span ' + DOMPropertyOperations.createMarkupForID(rootID) + '>' +
+        escapedText +
+      '</span>'
+    );
+  },
+
+  /**
+   * Updates this component by updating the text content.
+   *
+   * @param {object} nextComponent Contains the next text content.
+   * @param {ReactReconcileTransaction} transaction
+   * @internal
+   */
+  receiveComponent: function(nextComponent, transaction) {
+    var nextProps = nextComponent.props;
+    if (nextProps.text !== this.props.text) {
+      this.props.text = nextProps.text;
+      ReactComponent.BackendIDOperations.updateTextContentByID(
+        this._rootNodeID,
+        nextProps.text
+      );
+    }
+  }
+
+});
+
+// Expose the constructor on itself and the prototype for consistency with other
+// descriptors.
+ReactTextComponent.type = ReactTextComponent;
+ReactTextComponent.prototype.type = ReactTextComponent;
+
+module.exports = ReactTextComponent;
+
+},{"./DOMPropertyOperations":10,"./ReactBrowserComponentMixin":27,"./ReactComponent":31,"./escapeTextForBrowser":111,"./mixInto":137}],78:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @typechecks static-only
+ * @providesModule ReactTransitionChildMapping
+ */
+
+"use strict";
+
+var ReactChildren = _dereq_("./ReactChildren");
+
+var ReactTransitionChildMapping = {
+  /**
+   * Given `this.props.children`, return an object mapping key to child. Just
+   * simple syntactic sugar around ReactChildren.map().
+   *
+   * @param {*} children `this.props.children`
+   * @return {object} Mapping of key to child
+   */
+  getChildMapping: function(children) {
+    return ReactChildren.map(children, function(child) {
+      return child;
+    });
+  },
+
+  /**
+   * When you're adding or removing children some may be added or removed in the
+   * same render pass. We want ot show *both* since we want to simultaneously
+   * animate elements in and out. This function takes a previous set of keys
+   * and a new set of keys and merges them with its best guess of the correct
+   * ordering. In the future we may expose some of the utilities in
+   * ReactMultiChild to make this easy, but for now React itself does not
+   * directly have this concept of the union of prevChildren and nextChildren
+   * so we implement it here.
+   *
+   * @param {object} prev prev children as returned from
+   * `ReactTransitionChildMapping.getChildMapping()`.
+   * @param {object} next next children as returned from
+   * `ReactTransitionChildMapping.getChildMapping()`.
+   * @return {object} a key set that contains all keys in `prev` and all keys
+   * in `next` in a reasonable order.
+   */
+  mergeChildMappings: function(prev, next) {
+    prev = prev || {};
+    next = next || {};
+
+    function getValueForKey(key) {
+      if (next.hasOwnProperty(key)) {
+        return next[key];
+      } else {
+        return prev[key];
+      }
+    }
+
+    // For each key of `next`, the list of keys to insert before that key in
+    // the combined list
+    var nextKeysPending = {};
+
+    var pendingKeys = [];
+    for (var prevKey in prev) {
+      if (next[prevKey]) {
+        if (pendingKeys.length) {
+          nextKeysPending[prevKey] = pendingKeys;
+          pendingKeys = [];
+        }
+      } else {
+        pendingKeys.push(prevKey);
+      }
+    }
+
+    var i;
+    var childMapping = {};
+    for (var nextKey in next) {
+      if (nextKeysPending[nextKey]) {
+        for (i = 0; i < nextKeysPending[nextKey].length; i++) {
+          var pendingNextKey = nextKeysPending[nextKey][i];
+          childMapping[nextKeysPending[nextKey][i]] = getValueForKey(
+            pendingNextKey
+          );
+        }
+      }
+      childMapping[nextKey] = getValueForKey(nextKey);
+    }
+
+    // Finally, add the keys which didn't appear before any key in `next`
+    for (i = 0; i < pendingKeys.length; i++) {
+      childMapping[pendingKeys[i]] = getValueForKey(pendingKeys[i]);
+    }
+
+    return childMapping;
+  }
+};
+
+module.exports = ReactTransitionChildMapping;
+
+},{"./ReactChildren":30}],79:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactTransitionEvents
+ */
+
+"use strict";
+
+var ExecutionEnvironment = _dereq_("./ExecutionEnvironment");
+
+var EVENT_NAME_MAP = {
+  transitionend: {
+    'transition': 'transitionend',
+    'WebkitTransition': 'webkitTransitionEnd',
+    'MozTransition': 'mozTransitionEnd',
+    'OTransition': 'oTransitionEnd',
+    'msTransition': 'MSTransitionEnd'
+  },
+
+  animationend: {
+    'animation': 'animationend',
+    'WebkitAnimation': 'webkitAnimationEnd',
+    'MozAnimation': 'mozAnimationEnd',
+    'OAnimation': 'oAnimationEnd',
+    'msAnimation': 'MSAnimationEnd'
+  }
+};
+
+var endEvents = [];
+
+function detectEvents() {
+  var testEl = document.createElement('div');
+  var style = testEl.style;
+  for (var baseEventName in EVENT_NAME_MAP) {
+    var baseEvents = EVENT_NAME_MAP[baseEventName];
+    for (var styleName in baseEvents) {
+      if (styleName in style) {
+        endEvents.push(baseEvents[styleName]);
+        break;
+      }
+    }
+  }
+}
+
+if (ExecutionEnvironment.canUseDOM) {
+  detectEvents();
+}
+
+// We use the raw {add|remove}EventListener() call because EventListener
+// does not know how to remove event listeners and we really should
+// clean up. Also, these events are not triggered in older browsers
+// so we should be A-OK here.
+
+function addEventListener(node, eventName, eventListener) {
+  node.addEventListener(eventName, eventListener, false);
+}
+
+function removeEventListener(node, eventName, eventListener) {
+  node.removeEventListener(eventName, eventListener, false);
+}
+
+var ReactTransitionEvents = {
+  addEndEventListener: function(node, eventListener) {
+    if (endEvents.length === 0) {
+      // If CSS transitions are not supported, trigger an "end animation"
+      // event immediately.
+      window.setTimeout(eventListener, 0);
+      return;
+    }
+    endEvents.forEach(function(endEvent) {
+      addEventListener(node, endEvent, eventListener);
+    });
+  },
+
+  removeEndEventListener: function(node, eventListener) {
+    if (endEvents.length === 0) {
+      return;
+    }
+    endEvents.forEach(function(endEvent) {
+      removeEventListener(node, endEvent, eventListener);
+    });
+  }
+};
+
+module.exports = ReactTransitionEvents;
+
+},{"./ExecutionEnvironment":21}],80:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactTransitionGroup
+ */
+
+"use strict";
+
+var React = _dereq_("./React");
+var ReactTransitionChildMapping = _dereq_("./ReactTransitionChildMapping");
+
+var cloneWithProps = _dereq_("./cloneWithProps");
+var emptyFunction = _dereq_("./emptyFunction");
+var merge = _dereq_("./merge");
+
+var ReactTransitionGroup = React.createClass({
+
+  propTypes: {
+    component: React.PropTypes.func,
+    childFactory: React.PropTypes.func
+  },
+
+  getDefaultProps: function() {
+    return {
+      component: React.DOM.span,
+      childFactory: emptyFunction.thatReturnsArgument
+    };
+  },
+
+  getInitialState: function() {
+    return {
+      children: ReactTransitionChildMapping.getChildMapping(this.props.children)
+    };
+  },
+
+  componentWillReceiveProps: function(nextProps) {
+    var nextChildMapping = ReactTransitionChildMapping.getChildMapping(
+      nextProps.children
+    );
+    var prevChildMapping = this.state.children;
+
+    this.setState({
+      children: ReactTransitionChildMapping.mergeChildMappings(
+        prevChildMapping,
+        nextChildMapping
+      )
+    });
+
+    var key;
+
+    for (key in nextChildMapping) {
+      if (!prevChildMapping.hasOwnProperty(key) &&
+        !this.currentlyTransitioningKeys[key]) {
+        this.keysToEnter.push(key);
+      }
+    }
+
+    for (key in prevChildMapping) {
+      if (!nextChildMapping.hasOwnProperty(key) &&
+        !this.currentlyTransitioningKeys[key]) {
+        this.keysToLeave.push(key);
+      }
+    }
+
+    // If we want to someday check for reordering, we could do it here.
+  },
+
+  componentWillMount: function() {
+    this.currentlyTransitioningKeys = {};
+    this.keysToEnter = [];
+    this.keysToLeave = [];
+  },
+
+  componentDidUpdate: function() {
+    var keysToEnter = this.keysToEnter;
+    this.keysToEnter = [];
+    keysToEnter.forEach(this.performEnter);
+
+    var keysToLeave = this.keysToLeave;
+    this.keysToLeave = [];
+    keysToLeave.forEach(this.performLeave);
+  },
+
+  performEnter: function(key) {
+    this.currentlyTransitioningKeys[key] = true;
+
+    var component = this.refs[key];
+
+    if (component.componentWillEnter) {
+      component.componentWillEnter(
+        this._handleDoneEntering.bind(this, key)
+      );
+    } else {
+      this._handleDoneEntering(key);
+    }
+  },
+
+  _handleDoneEntering: function(key) {
+    var component = this.refs[key];
+    if (component.componentDidEnter) {
+      component.componentDidEnter();
+    }
+
+    delete this.currentlyTransitioningKeys[key];
+
+    var currentChildMapping = ReactTransitionChildMapping.getChildMapping(
+      this.props.children
+    );
+
+    if (!currentChildMapping.hasOwnProperty(key)) {
+      // This was removed before it had fully entered. Remove it.
+      this.performLeave(key);
+    }
+  },
+
+  performLeave: function(key) {
+    this.currentlyTransitioningKeys[key] = true;
+
+    var component = this.refs[key];
+    if (component.componentWillLeave) {
+      component.componentWillLeave(this._handleDoneLeaving.bind(this, key));
+    } else {
+      // Note that this is somewhat dangerous b/c it calls setState()
+      // again, effectively mutating the component before all the work
+      // is done.
+      this._handleDoneLeaving(key);
+    }
+  },
+
+  _handleDoneLeaving: function(key) {
+    var component = this.refs[key];
+
+    if (component.componentDidLeave) {
+      component.componentDidLeave();
+    }
+
+    delete this.currentlyTransitioningKeys[key];
+
+    var currentChildMapping = ReactTransitionChildMapping.getChildMapping(
+      this.props.children
+    );
+
+    if (currentChildMapping.hasOwnProperty(key)) {
+      // This entered again before it fully left. Add it again.
+      this.performEnter(key);
+    } else {
+      var newChildren = merge(this.state.children);
+      delete newChildren[key];
+      this.setState({children: newChildren});
+    }
+  },
+
+  render: function() {
+    // TODO: we could get rid of the need for the wrapper node
+    // by cloning a single child
+    var childrenToRender = {};
+    for (var key in this.state.children) {
+      var child = this.state.children[key];
+      if (child) {
+        // You may need to apply reactive updates to a child as it is leaving.
+        // The normal React way to do it won't work since the child will have
+        // already been removed. In case you need this behavior you can provide
+        // a childFactory function to wrap every child, even the ones that are
+        // leaving.
+        childrenToRender[key] = cloneWithProps(
+          this.props.childFactory(child),
+          {ref: key}
+        );
+      }
+    }
+    return this.transferPropsTo(this.props.component(null, childrenToRender));
+  }
+});
+
+module.exports = ReactTransitionGroup;
+
+},{"./React":26,"./ReactTransitionChildMapping":78,"./cloneWithProps":100,"./emptyFunction":109,"./merge":134}],81:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactUpdates
+ */
+
+"use strict";
+
+var ReactPerf = _dereq_("./ReactPerf");
+
+var invariant = _dereq_("./invariant");
+
+var dirtyComponents = [];
+
+var batchingStrategy = null;
+
+function ensureBatchingStrategy() {
+  ("production" !== "development" ? invariant(batchingStrategy, 'ReactUpdates: must inject a batching strategy') : invariant(batchingStrategy));
+}
+
+function batchedUpdates(callback, param) {
+  ensureBatchingStrategy();
+  batchingStrategy.batchedUpdates(callback, param);
+}
+
+/**
+ * Array comparator for ReactComponents by owner depth
+ *
+ * @param {ReactComponent} c1 first component you're comparing
+ * @param {ReactComponent} c2 second component you're comparing
+ * @return {number} Return value usable by Array.prototype.sort().
+ */
+function mountDepthComparator(c1, c2) {
+  return c1._mountDepth - c2._mountDepth;
+}
+
+function runBatchedUpdates() {
+  // Since reconciling a component higher in the owner hierarchy usually (not
+  // always -- see shouldComponentUpdate()) will reconcile children, reconcile
+  // them before their children by sorting the array.
+
+  dirtyComponents.sort(mountDepthComparator);
+
+  for (var i = 0; i < dirtyComponents.length; i++) {
+    // If a component is unmounted before pending changes apply, ignore them
+    // TODO: Queue unmounts in the same list to avoid this happening at all
+    var component = dirtyComponents[i];
+    if (component.isMounted()) {
+      // If performUpdateIfNecessary happens to enqueue any new updates, we
+      // shouldn't execute the callbacks until the next render happens, so
+      // stash the callbacks first
+      var callbacks = component._pendingCallbacks;
+      component._pendingCallbacks = null;
+      component.performUpdateIfNecessary();
+      if (callbacks) {
+        for (var j = 0; j < callbacks.length; j++) {
+          callbacks[j].call(component);
+        }
+      }
+    }
+  }
+}
+
+function clearDirtyComponents() {
+  dirtyComponents.length = 0;
+}
+
+var flushBatchedUpdates = ReactPerf.measure(
+  'ReactUpdates',
+  'flushBatchedUpdates',
+  function() {
+    // Run these in separate functions so the JIT can optimize
+    try {
+      runBatchedUpdates();
+    } finally {
+      clearDirtyComponents();
+    }
+  }
+);
+
+/**
+ * Mark a component as needing a rerender, adding an optional callback to a
+ * list of functions which will be executed once the rerender occurs.
+ */
+function enqueueUpdate(component, callback) {
+  ("production" !== "development" ? invariant(
+    !callback || typeof callback === "function",
+    'enqueueUpdate(...): You called `setProps`, `replaceProps`, ' +
+    '`setState`, `replaceState`, or `forceUpdate` with a callback that ' +
+    'isn\'t callable.'
+  ) : invariant(!callback || typeof callback === "function"));
+  ensureBatchingStrategy();
+
+  if (!batchingStrategy.isBatchingUpdates) {
+    component.performUpdateIfNecessary();
+    callback && callback.call(component);
+    return;
+  }
+
+  dirtyComponents.push(component);
+
+  if (callback) {
+    if (component._pendingCallbacks) {
+      component._pendingCallbacks.push(callback);
+    } else {
+      component._pendingCallbacks = [callback];
+    }
+  }
+}
+
+var ReactUpdatesInjection = {
+  injectBatchingStrategy: function(_batchingStrategy) {
+    ("production" !== "development" ? invariant(
+      _batchingStrategy,
+      'ReactUpdates: must provide a batching strategy'
+    ) : invariant(_batchingStrategy));
+    ("production" !== "development" ? invariant(
+      typeof _batchingStrategy.batchedUpdates === 'function',
+      'ReactUpdates: must provide a batchedUpdates() function'
+    ) : invariant(typeof _batchingStrategy.batchedUpdates === 'function'));
+    ("production" !== "development" ? invariant(
+      typeof _batchingStrategy.isBatchingUpdates === 'boolean',
+      'ReactUpdates: must provide an isBatchingUpdates boolean attribute'
+    ) : invariant(typeof _batchingStrategy.isBatchingUpdates === 'boolean'));
+    batchingStrategy = _batchingStrategy;
+  }
+};
+
+var ReactUpdates = {
+  batchedUpdates: batchedUpdates,
+  enqueueUpdate: enqueueUpdate,
+  flushBatchedUpdates: flushBatchedUpdates,
+  injection: ReactUpdatesInjection
+};
+
+module.exports = ReactUpdates;
+
+},{"./ReactPerf":65,"./invariant":125}],82:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactWithAddons
+ */
+
+/**
+ * This module exists purely in the open source project, and is meant as a way
+ * to create a separate standalone build of React. This build has "addons", or
+ * functionality we've built and think might be useful but doesn't have a good
+ * place to live inside React core.
+ */
+
+"use strict";
+
+var LinkedStateMixin = _dereq_("./LinkedStateMixin");
+var React = _dereq_("./React");
+var ReactCSSTransitionGroup = _dereq_("./ReactCSSTransitionGroup");
+var ReactTransitionGroup = _dereq_("./ReactTransitionGroup");
+var ReactCSSTransitionGroup = _dereq_("./ReactCSSTransitionGroup");
+
+var cx = _dereq_("./cx");
+var cloneWithProps = _dereq_("./cloneWithProps");
+var update = _dereq_("./update");
+
+React.addons = {
+  LinkedStateMixin: LinkedStateMixin,
+  CSSTransitionGroup: ReactCSSTransitionGroup,
+  TransitionGroup: ReactTransitionGroup,
+
+  classSet: cx,
+  cloneWithProps: cloneWithProps,
+  update: update
+};
+
+if ("production" !== "development") {
+  React.addons.TestUtils = _dereq_("./ReactTestUtils");
+}
+
+module.exports = React;
+
+
+},{"./LinkedStateMixin":22,"./React":26,"./ReactCSSTransitionGroup":28,"./ReactTestUtils":76,"./ReactTransitionGroup":80,"./cloneWithProps":100,"./cx":107,"./update":147}],83:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule SelectEventPlugin
+ */
+
+"use strict";
+
+var EventConstants = _dereq_("./EventConstants");
+var EventPropagators = _dereq_("./EventPropagators");
+var ReactInputSelection = _dereq_("./ReactInputSelection");
+var SyntheticEvent = _dereq_("./SyntheticEvent");
+
+var getActiveElement = _dereq_("./getActiveElement");
+var isTextInputElement = _dereq_("./isTextInputElement");
+var keyOf = _dereq_("./keyOf");
+var shallowEqual = _dereq_("./shallowEqual");
+
+var topLevelTypes = EventConstants.topLevelTypes;
+
+var eventTypes = {
+  select: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onSelect: null}),
+      captured: keyOf({onSelectCapture: null})
+    },
+    dependencies: [
+      topLevelTypes.topBlur,
+      topLevelTypes.topContextMenu,
+      topLevelTypes.topFocus,
+      topLevelTypes.topKeyDown,
+      topLevelTypes.topMouseDown,
+      topLevelTypes.topMouseUp,
+      topLevelTypes.topSelectionChange
+    ]
+  }
+};
+
+var activeElement = null;
+var activeElementID = null;
+var lastSelection = null;
+var mouseDown = false;
+
+/**
+ * Get an object which is a unique representation of the current selection.
+ *
+ * The return value will not be consistent across nodes or browsers, but
+ * two identical selections on the same node will return identical objects.
+ *
+ * @param {DOMElement} node
+ * @param {object}
+ */
+function getSelection(node) {
+  if ('selectionStart' in node &&
+      ReactInputSelection.hasSelectionCapabilities(node)) {
+    return {
+      start: node.selectionStart,
+      end: node.selectionEnd
+    };
+  } else if (document.selection) {
+    var range = document.selection.createRange();
+    return {
+      parentElement: range.parentElement(),
+      text: range.text,
+      top: range.boundingTop,
+      left: range.boundingLeft
+    };
+  } else {
+    var selection = window.getSelection();
+    return {
+      anchorNode: selection.anchorNode,
+      anchorOffset: selection.anchorOffset,
+      focusNode: selection.focusNode,
+      focusOffset: selection.focusOffset
+    };
+  }
+}
+
+/**
+ * Poll selection to see whether it's changed.
+ *
+ * @param {object} nativeEvent
+ * @return {?SyntheticEvent}
+ */
+function constructSelectEvent(nativeEvent) {
+  // Ensure we have the right element, and that the user is not dragging a
+  // selection (this matches native `select` event behavior). In HTML5, select
+  // fires only on input and textarea thus if there's no focused element we
+  // won't dispatch.
+  if (mouseDown ||
+      activeElement == null ||
+      activeElement != getActiveElement()) {
+    return;
+  }
+
+  // Only fire when selection has actually changed.
+  var currentSelection = getSelection(activeElement);
+  if (!lastSelection || !shallowEqual(lastSelection, currentSelection)) {
+    lastSelection = currentSelection;
+
+    var syntheticEvent = SyntheticEvent.getPooled(
+      eventTypes.select,
+      activeElementID,
+      nativeEvent
+    );
+
+    syntheticEvent.type = 'select';
+    syntheticEvent.target = activeElement;
+
+    EventPropagators.accumulateTwoPhaseDispatches(syntheticEvent);
+
+    return syntheticEvent;
+  }
+}
+
+/**
+ * This plugin creates an `onSelect` event that normalizes select events
+ * across form elements.
+ *
+ * Supported elements are:
+ * - input (see `isTextInputElement`)
+ * - textarea
+ * - contentEditable
+ *
+ * This differs from native browser implementations in the following ways:
+ * - Fires on contentEditable fields as well as inputs.
+ * - Fires for collapsed selection.
+ * - Fires after user input.
+ */
+var SelectEventPlugin = {
+
+  eventTypes: eventTypes,
+
+  /**
+   * @param {string} topLevelType Record from `EventConstants`.
+   * @param {DOMEventTarget} topLevelTarget The listening component root node.
+   * @param {string} topLevelTargetID ID of `topLevelTarget`.
+   * @param {object} nativeEvent Native browser event.
+   * @return {*} An accumulation of synthetic events.
+   * @see {EventPluginHub.extractEvents}
+   */
+  extractEvents: function(
+      topLevelType,
+      topLevelTarget,
+      topLevelTargetID,
+      nativeEvent) {
+
+    switch (topLevelType) {
+      // Track the input node that has focus.
+      case topLevelTypes.topFocus:
+        if (isTextInputElement(topLevelTarget) ||
+            topLevelTarget.contentEditable === 'true') {
+          activeElement = topLevelTarget;
+          activeElementID = topLevelTargetID;
+          lastSelection = null;
+        }
+        break;
+      case topLevelTypes.topBlur:
+        activeElement = null;
+        activeElementID = null;
+        lastSelection = null;
+        break;
+
+      // Don't fire the event while the user is dragging. This matches the
+      // semantics of the native select event.
+      case topLevelTypes.topMouseDown:
+        mouseDown = true;
+        break;
+      case topLevelTypes.topContextMenu:
+      case topLevelTypes.topMouseUp:
+        mouseDown = false;
+        return constructSelectEvent(nativeEvent);
+
+      // Chrome and IE fire non-standard event when selection is changed (and
+      // sometimes when it hasn't).
+      // Firefox doesn't support selectionchange, so check selection status
+      // after each key entry. The selection changes after keydown and before
+      // keyup, but we check on keydown as well in the case of holding down a
+      // key, when multiple keydown events are fired but only one keyup is.
+      case topLevelTypes.topSelectionChange:
+      case topLevelTypes.topKeyDown:
+      case topLevelTypes.topKeyUp:
+        return constructSelectEvent(nativeEvent);
+    }
+  }
+};
+
+module.exports = SelectEventPlugin;
+
+},{"./EventConstants":15,"./EventPropagators":20,"./ReactInputSelection":56,"./SyntheticEvent":89,"./getActiveElement":115,"./isTextInputElement":128,"./keyOf":132,"./shallowEqual":143}],84:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ServerReactRootIndex
+ * @typechecks
+ */
+
+"use strict";
+
+/**
+ * Size of the reactRoot ID space. We generate random numbers for React root
+ * IDs and if there's a collision the events and DOM update system will
+ * get confused. In the future we need a way to generate GUIDs but for
+ * now this will work on a smaller scale.
+ */
+var GLOBAL_MOUNT_POINT_MAX = Math.pow(2, 53);
+
+var ServerReactRootIndex = {
+  createReactRootIndex: function() {
+    return Math.ceil(Math.random() * GLOBAL_MOUNT_POINT_MAX);
+  }
+};
+
+module.exports = ServerReactRootIndex;
+
+},{}],85:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule SimpleEventPlugin
+ */
+
+"use strict";
+
+var EventConstants = _dereq_("./EventConstants");
+var EventPluginUtils = _dereq_("./EventPluginUtils");
+var EventPropagators = _dereq_("./EventPropagators");
+var SyntheticClipboardEvent = _dereq_("./SyntheticClipboardEvent");
+var SyntheticEvent = _dereq_("./SyntheticEvent");
+var SyntheticFocusEvent = _dereq_("./SyntheticFocusEvent");
+var SyntheticKeyboardEvent = _dereq_("./SyntheticKeyboardEvent");
+var SyntheticMouseEvent = _dereq_("./SyntheticMouseEvent");
+var SyntheticDragEvent = _dereq_("./SyntheticDragEvent");
+var SyntheticTouchEvent = _dereq_("./SyntheticTouchEvent");
+var SyntheticUIEvent = _dereq_("./SyntheticUIEvent");
+var SyntheticWheelEvent = _dereq_("./SyntheticWheelEvent");
+
+var invariant = _dereq_("./invariant");
+var keyOf = _dereq_("./keyOf");
+
+var topLevelTypes = EventConstants.topLevelTypes;
+
+var eventTypes = {
+  blur: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onBlur: true}),
+      captured: keyOf({onBlurCapture: true})
+    }
+  },
+  click: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onClick: true}),
+      captured: keyOf({onClickCapture: true})
+    }
+  },
+  contextMenu: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onContextMenu: true}),
+      captured: keyOf({onContextMenuCapture: true})
+    }
+  },
+  copy: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onCopy: true}),
+      captured: keyOf({onCopyCapture: true})
+    }
+  },
+  cut: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onCut: true}),
+      captured: keyOf({onCutCapture: true})
+    }
+  },
+  doubleClick: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onDoubleClick: true}),
+      captured: keyOf({onDoubleClickCapture: true})
+    }
+  },
+  drag: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onDrag: true}),
+      captured: keyOf({onDragCapture: true})
+    }
+  },
+  dragEnd: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onDragEnd: true}),
+      captured: keyOf({onDragEndCapture: true})
+    }
+  },
+  dragEnter: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onDragEnter: true}),
+      captured: keyOf({onDragEnterCapture: true})
+    }
+  },
+  dragExit: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onDragExit: true}),
+      captured: keyOf({onDragExitCapture: true})
+    }
+  },
+  dragLeave: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onDragLeave: true}),
+      captured: keyOf({onDragLeaveCapture: true})
+    }
+  },
+  dragOver: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onDragOver: true}),
+      captured: keyOf({onDragOverCapture: true})
+    }
+  },
+  dragStart: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onDragStart: true}),
+      captured: keyOf({onDragStartCapture: true})
+    }
+  },
+  drop: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onDrop: true}),
+      captured: keyOf({onDropCapture: true})
+    }
+  },
+  focus: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onFocus: true}),
+      captured: keyOf({onFocusCapture: true})
+    }
+  },
+  input: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onInput: true}),
+      captured: keyOf({onInputCapture: true})
+    }
+  },
+  keyDown: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onKeyDown: true}),
+      captured: keyOf({onKeyDownCapture: true})
+    }
+  },
+  keyPress: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onKeyPress: true}),
+      captured: keyOf({onKeyPressCapture: true})
+    }
+  },
+  keyUp: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onKeyUp: true}),
+      captured: keyOf({onKeyUpCapture: true})
+    }
+  },
+  load: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onLoad: true}),
+      captured: keyOf({onLoadCapture: true})
+    }
+  },
+  error: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onError: true}),
+      captured: keyOf({onErrorCapture: true})
+    }
+  },
+  // Note: We do not allow listening to mouseOver events. Instead, use the
+  // onMouseEnter/onMouseLeave created by `EnterLeaveEventPlugin`.
+  mouseDown: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onMouseDown: true}),
+      captured: keyOf({onMouseDownCapture: true})
+    }
+  },
+  mouseMove: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onMouseMove: true}),
+      captured: keyOf({onMouseMoveCapture: true})
+    }
+  },
+  mouseOut: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onMouseOut: true}),
+      captured: keyOf({onMouseOutCapture: true})
+    }
+  },
+  mouseOver: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onMouseOver: true}),
+      captured: keyOf({onMouseOverCapture: true})
+    }
+  },
+  mouseUp: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onMouseUp: true}),
+      captured: keyOf({onMouseUpCapture: true})
+    }
+  },
+  paste: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onPaste: true}),
+      captured: keyOf({onPasteCapture: true})
+    }
+  },
+  reset: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onReset: true}),
+      captured: keyOf({onResetCapture: true})
+    }
+  },
+  scroll: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onScroll: true}),
+      captured: keyOf({onScrollCapture: true})
+    }
+  },
+  submit: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onSubmit: true}),
+      captured: keyOf({onSubmitCapture: true})
+    }
+  },
+  touchCancel: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onTouchCancel: true}),
+      captured: keyOf({onTouchCancelCapture: true})
+    }
+  },
+  touchEnd: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onTouchEnd: true}),
+      captured: keyOf({onTouchEndCapture: true})
+    }
+  },
+  touchMove: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onTouchMove: true}),
+      captured: keyOf({onTouchMoveCapture: true})
+    }
+  },
+  touchStart: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onTouchStart: true}),
+      captured: keyOf({onTouchStartCapture: true})
+    }
+  },
+  wheel: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onWheel: true}),
+      captured: keyOf({onWheelCapture: true})
+    }
+  }
+};
+
+var topLevelEventsToDispatchConfig = {
+  topBlur:        eventTypes.blur,
+  topClick:       eventTypes.click,
+  topContextMenu: eventTypes.contextMenu,
+  topCopy:        eventTypes.copy,
+  topCut:         eventTypes.cut,
+  topDoubleClick: eventTypes.doubleClick,
+  topDrag:        eventTypes.drag,
+  topDragEnd:     eventTypes.dragEnd,
+  topDragEnter:   eventTypes.dragEnter,
+  topDragExit:    eventTypes.dragExit,
+  topDragLeave:   eventTypes.dragLeave,
+  topDragOver:    eventTypes.dragOver,
+  topDragStart:   eventTypes.dragStart,
+  topDrop:        eventTypes.drop,
+  topError:       eventTypes.error,
+  topFocus:       eventTypes.focus,
+  topInput:       eventTypes.input,
+  topKeyDown:     eventTypes.keyDown,
+  topKeyPress:    eventTypes.keyPress,
+  topKeyUp:       eventTypes.keyUp,
+  topLoad:        eventTypes.load,
+  topMouseDown:   eventTypes.mouseDown,
+  topMouseMove:   eventTypes.mouseMove,
+  topMouseOut:    eventTypes.mouseOut,
+  topMouseOver:   eventTypes.mouseOver,
+  topMouseUp:     eventTypes.mouseUp,
+  topPaste:       eventTypes.paste,
+  topReset:       eventTypes.reset,
+  topScroll:      eventTypes.scroll,
+  topSubmit:      eventTypes.submit,
+  topTouchCancel: eventTypes.touchCancel,
+  topTouchEnd:    eventTypes.touchEnd,
+  topTouchMove:   eventTypes.touchMove,
+  topTouchStart:  eventTypes.touchStart,
+  topWheel:       eventTypes.wheel
+};
+
+for (var topLevelType in topLevelEventsToDispatchConfig) {
+  topLevelEventsToDispatchConfig[topLevelType].dependencies = [topLevelType];
+}
+
+var SimpleEventPlugin = {
+
+  eventTypes: eventTypes,
+
+  /**
+   * Same as the default implementation, except cancels the event when return
+   * value is false.
+   *
+   * @param {object} Event to be dispatched.
+   * @param {function} Application-level callback.
+   * @param {string} domID DOM ID to pass to the callback.
+   */
+  executeDispatch: function(event, listener, domID) {
+    var returnValue = EventPluginUtils.executeDispatch(event, listener, domID);
+    if (returnValue === false) {
+      event.stopPropagation();
+      event.preventDefault();
+    }
+  },
+
+  /**
+   * @param {string} topLevelType Record from `EventConstants`.
+   * @param {DOMEventTarget} topLevelTarget The listening component root node.
+   * @param {string} topLevelTargetID ID of `topLevelTarget`.
+   * @param {object} nativeEvent Native browser event.
+   * @return {*} An accumulation of synthetic events.
+   * @see {EventPluginHub.extractEvents}
+   */
+  extractEvents: function(
+      topLevelType,
+      topLevelTarget,
+      topLevelTargetID,
+      nativeEvent) {
+    var dispatchConfig = topLevelEventsToDispatchConfig[topLevelType];
+    if (!dispatchConfig) {
+      return null;
+    }
+    var EventConstructor;
+    switch (topLevelType) {
+      case topLevelTypes.topInput:
+      case topLevelTypes.topLoad:
+      case topLevelTypes.topError:
+      case topLevelTypes.topReset:
+      case topLevelTypes.topSubmit:
+        // HTML Events
+        // @see http://www.w3.org/TR/html5/index.html#events-0
+        EventConstructor = SyntheticEvent;
+        break;
+      case topLevelTypes.topKeyDown:
+      case topLevelTypes.topKeyPress:
+      case topLevelTypes.topKeyUp:
+        EventConstructor = SyntheticKeyboardEvent;
+        break;
+      case topLevelTypes.topBlur:
+      case topLevelTypes.topFocus:
+        EventConstructor = SyntheticFocusEvent;
+        break;
+      case topLevelTypes.topClick:
+        // Firefox creates a click event on right mouse clicks. This removes the
+        // unwanted click events.
+        if (nativeEvent.button === 2) {
+          return null;
+        }
+        /* falls through */
+      case topLevelTypes.topContextMenu:
+      case topLevelTypes.topDoubleClick:
+      case topLevelTypes.topMouseDown:
+      case topLevelTypes.topMouseMove:
+      case topLevelTypes.topMouseOut:
+      case topLevelTypes.topMouseOver:
+      case topLevelTypes.topMouseUp:
+        EventConstructor = SyntheticMouseEvent;
+        break;
+      case topLevelTypes.topDrag:
+      case topLevelTypes.topDragEnd:
+      case topLevelTypes.topDragEnter:
+      case topLevelTypes.topDragExit:
+      case topLevelTypes.topDragLeave:
+      case topLevelTypes.topDragOver:
+      case topLevelTypes.topDragStart:
+      case topLevelTypes.topDrop:
+        EventConstructor = SyntheticDragEvent;
+        break;
+      case topLevelTypes.topTouchCancel:
+      case topLevelTypes.topTouchEnd:
+      case topLevelTypes.topTouchMove:
+      case topLevelTypes.topTouchStart:
+        EventConstructor = SyntheticTouchEvent;
+        break;
+      case topLevelTypes.topScroll:
+        EventConstructor = SyntheticUIEvent;
+        break;
+      case topLevelTypes.topWheel:
+        EventConstructor = SyntheticWheelEvent;
+        break;
+      case topLevelTypes.topCopy:
+      case topLevelTypes.topCut:
+      case topLevelTypes.topPaste:
+        EventConstructor = SyntheticClipboardEvent;
+        break;
+    }
+    ("production" !== "development" ? invariant(
+      EventConstructor,
+      'SimpleEventPlugin: Unhandled event type, `%s`.',
+      topLevelType
+    ) : invariant(EventConstructor));
+    var event = EventConstructor.getPooled(
+      dispatchConfig,
+      topLevelTargetID,
+      nativeEvent
+    );
+    EventPropagators.accumulateTwoPhaseDispatches(event);
+    return event;
+  }
+
+};
+
+module.exports = SimpleEventPlugin;
+
+},{"./EventConstants":15,"./EventPluginUtils":19,"./EventPropagators":20,"./SyntheticClipboardEvent":86,"./SyntheticDragEvent":88,"./SyntheticEvent":89,"./SyntheticFocusEvent":90,"./SyntheticKeyboardEvent":91,"./SyntheticMouseEvent":92,"./SyntheticTouchEvent":93,"./SyntheticUIEvent":94,"./SyntheticWheelEvent":95,"./invariant":125,"./keyOf":132}],86:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule SyntheticClipboardEvent
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var SyntheticEvent = _dereq_("./SyntheticEvent");
+
+/**
+ * @interface Event
+ * @see http://www.w3.org/TR/clipboard-apis/
+ */
+var ClipboardEventInterface = {
+  clipboardData: function(event) {
+    return (
+      'clipboardData' in event ?
+        event.clipboardData :
+        window.clipboardData
+    );
+  }
+};
+
+/**
+ * @param {object} dispatchConfig Configuration used to dispatch this event.
+ * @param {string} dispatchMarker Marker identifying the event target.
+ * @param {object} nativeEvent Native browser event.
+ * @extends {SyntheticUIEvent}
+ */
+function SyntheticClipboardEvent(dispatchConfig, dispatchMarker, nativeEvent) {
+  SyntheticEvent.call(this, dispatchConfig, dispatchMarker, nativeEvent);
+}
+
+SyntheticEvent.augmentClass(SyntheticClipboardEvent, ClipboardEventInterface);
+
+module.exports = SyntheticClipboardEvent;
+
+
+},{"./SyntheticEvent":89}],87:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule SyntheticCompositionEvent
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var SyntheticEvent = _dereq_("./SyntheticEvent");
+
+/**
+ * @interface Event
+ * @see http://www.w3.org/TR/DOM-Level-3-Events/#events-compositionevents
+ */
+var CompositionEventInterface = {
+  data: null
+};
+
+/**
+ * @param {object} dispatchConfig Configuration used to dispatch this event.
+ * @param {string} dispatchMarker Marker identifying the event target.
+ * @param {object} nativeEvent Native browser event.
+ * @extends {SyntheticUIEvent}
+ */
+function SyntheticCompositionEvent(
+  dispatchConfig,
+  dispatchMarker,
+  nativeEvent) {
+  SyntheticEvent.call(this, dispatchConfig, dispatchMarker, nativeEvent);
+}
+
+SyntheticEvent.augmentClass(
+  SyntheticCompositionEvent,
+  CompositionEventInterface
+);
+
+module.exports = SyntheticCompositionEvent;
+
+
+},{"./SyntheticEvent":89}],88:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule SyntheticDragEvent
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var SyntheticMouseEvent = _dereq_("./SyntheticMouseEvent");
+
+/**
+ * @interface DragEvent
+ * @see http://www.w3.org/TR/DOM-Level-3-Events/
+ */
+var DragEventInterface = {
+  dataTransfer: null
+};
+
+/**
+ * @param {object} dispatchConfig Configuration used to dispatch this event.
+ * @param {string} dispatchMarker Marker identifying the event target.
+ * @param {object} nativeEvent Native browser event.
+ * @extends {SyntheticUIEvent}
+ */
+function SyntheticDragEvent(dispatchConfig, dispatchMarker, nativeEvent) {
+  SyntheticMouseEvent.call(this, dispatchConfig, dispatchMarker, nativeEvent);
+}
+
+SyntheticMouseEvent.augmentClass(SyntheticDragEvent, DragEventInterface);
+
+module.exports = SyntheticDragEvent;
+
+},{"./SyntheticMouseEvent":92}],89:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule SyntheticEvent
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var PooledClass = _dereq_("./PooledClass");
+
+var emptyFunction = _dereq_("./emptyFunction");
+var getEventTarget = _dereq_("./getEventTarget");
+var merge = _dereq_("./merge");
+var mergeInto = _dereq_("./mergeInto");
+
+/**
+ * @interface Event
+ * @see http://www.w3.org/TR/DOM-Level-3-Events/
+ */
+var EventInterface = {
+  type: null,
+  target: getEventTarget,
+  // currentTarget is set when dispatching; no use in copying it here
+  currentTarget: emptyFunction.thatReturnsNull,
+  eventPhase: null,
+  bubbles: null,
+  cancelable: null,
+  timeStamp: function(event) {
+    return event.timeStamp || Date.now();
+  },
+  defaultPrevented: null,
+  isTrusted: null
+};
+
+/**
+ * Synthetic events are dispatched by event plugins, typically in response to a
+ * top-level event delegation handler.
+ *
+ * These systems should generally use pooling to reduce the frequency of garbage
+ * collection. The system should check `isPersistent` to determine whether the
+ * event should be released into the pool after being dispatched. Users that
+ * need a persisted event should invoke `persist`.
+ *
+ * Synthetic events (and subclasses) implement the DOM Level 3 Events API by
+ * normalizing browser quirks. Subclasses do not necessarily have to implement a
+ * DOM interface; custom application-specific events can also subclass this.
+ *
+ * @param {object} dispatchConfig Configuration used to dispatch this event.
+ * @param {string} dispatchMarker Marker identifying the event target.
+ * @param {object} nativeEvent Native browser event.
+ */
+function SyntheticEvent(dispatchConfig, dispatchMarker, nativeEvent) {
+  this.dispatchConfig = dispatchConfig;
+  this.dispatchMarker = dispatchMarker;
+  this.nativeEvent = nativeEvent;
+
+  var Interface = this.constructor.Interface;
+  for (var propName in Interface) {
+    if (!Interface.hasOwnProperty(propName)) {
+      continue;
+    }
+    var normalize = Interface[propName];
+    if (normalize) {
+      this[propName] = normalize(nativeEvent);
+    } else {
+      this[propName] = nativeEvent[propName];
+    }
+  }
+
+  var defaultPrevented = nativeEvent.defaultPrevented != null ?
+    nativeEvent.defaultPrevented :
+    nativeEvent.returnValue === false;
+  if (defaultPrevented) {
+    this.isDefaultPrevented = emptyFunction.thatReturnsTrue;
+  } else {
+    this.isDefaultPrevented = emptyFunction.thatReturnsFalse;
+  }
+  this.isPropagationStopped = emptyFunction.thatReturnsFalse;
+}
+
+mergeInto(SyntheticEvent.prototype, {
+
+  preventDefault: function() {
+    this.defaultPrevented = true;
+    var event = this.nativeEvent;
+    event.preventDefault ? event.preventDefault() : event.returnValue = false;
+    this.isDefaultPrevented = emptyFunction.thatReturnsTrue;
+  },
+
+  stopPropagation: function() {
+    var event = this.nativeEvent;
+    event.stopPropagation ? event.stopPropagation() : event.cancelBubble = true;
+    this.isPropagationStopped = emptyFunction.thatReturnsTrue;
+  },
+
+  /**
+   * We release all dispatched `SyntheticEvent`s after each event loop, adding
+   * them back into the pool. This allows a way to hold onto a reference that
+   * won't be added back into the pool.
+   */
+  persist: function() {
+    this.isPersistent = emptyFunction.thatReturnsTrue;
+  },
+
+  /**
+   * Checks if this event should be released back into the pool.
+   *
+   * @return {boolean} True if this should not be released, false otherwise.
+   */
+  isPersistent: emptyFunction.thatReturnsFalse,
+
+  /**
+   * `PooledClass` looks for `destructor` on each instance it releases.
+   */
+  destructor: function() {
+    var Interface = this.constructor.Interface;
+    for (var propName in Interface) {
+      this[propName] = null;
+    }
+    this.dispatchConfig = null;
+    this.dispatchMarker = null;
+    this.nativeEvent = null;
+  }
+
+});
+
+SyntheticEvent.Interface = EventInterface;
+
+/**
+ * Helper to reduce boilerplate when creating subclasses.
+ *
+ * @param {function} Class
+ * @param {?object} Interface
+ */
+SyntheticEvent.augmentClass = function(Class, Interface) {
+  var Super = this;
+
+  var prototype = Object.create(Super.prototype);
+  mergeInto(prototype, Class.prototype);
+  Class.prototype = prototype;
+  Class.prototype.constructor = Class;
+
+  Class.Interface = merge(Super.Interface, Interface);
+  Class.augmentClass = Super.augmentClass;
+
+  PooledClass.addPoolingTo(Class, PooledClass.threeArgumentPooler);
+};
+
+PooledClass.addPoolingTo(SyntheticEvent, PooledClass.threeArgumentPooler);
+
+module.exports = SyntheticEvent;
+
+},{"./PooledClass":25,"./emptyFunction":109,"./getEventTarget":117,"./merge":134,"./mergeInto":136}],90:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule SyntheticFocusEvent
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var SyntheticUIEvent = _dereq_("./SyntheticUIEvent");
+
+/**
+ * @interface FocusEvent
+ * @see http://www.w3.org/TR/DOM-Level-3-Events/
+ */
+var FocusEventInterface = {
+  relatedTarget: null
+};
+
+/**
+ * @param {object} dispatchConfig Configuration used to dispatch this event.
+ * @param {string} dispatchMarker Marker identifying the event target.
+ * @param {object} nativeEvent Native browser event.
+ * @extends {SyntheticUIEvent}
+ */
+function SyntheticFocusEvent(dispatchConfig, dispatchMarker, nativeEvent) {
+  SyntheticUIEvent.call(this, dispatchConfig, dispatchMarker, nativeEvent);
+}
+
+SyntheticUIEvent.augmentClass(SyntheticFocusEvent, FocusEventInterface);
+
+module.exports = SyntheticFocusEvent;
+
+},{"./SyntheticUIEvent":94}],91:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule SyntheticKeyboardEvent
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var SyntheticUIEvent = _dereq_("./SyntheticUIEvent");
+
+var getEventKey = _dereq_("./getEventKey");
+
+/**
+ * @interface KeyboardEvent
+ * @see http://www.w3.org/TR/DOM-Level-3-Events/
+ */
+var KeyboardEventInterface = {
+  key: getEventKey,
+  location: null,
+  ctrlKey: null,
+  shiftKey: null,
+  altKey: null,
+  metaKey: null,
+  repeat: null,
+  locale: null,
+  // Legacy Interface
+  'char': null,
+  charCode: null,
+  keyCode: null,
+  which: null
+};
+
+/**
+ * @param {object} dispatchConfig Configuration used to dispatch this event.
+ * @param {string} dispatchMarker Marker identifying the event target.
+ * @param {object} nativeEvent Native browser event.
+ * @extends {SyntheticUIEvent}
+ */
+function SyntheticKeyboardEvent(dispatchConfig, dispatchMarker, nativeEvent) {
+  SyntheticUIEvent.call(this, dispatchConfig, dispatchMarker, nativeEvent);
+}
+
+SyntheticUIEvent.augmentClass(SyntheticKeyboardEvent, KeyboardEventInterface);
+
+module.exports = SyntheticKeyboardEvent;
+
+},{"./SyntheticUIEvent":94,"./getEventKey":116}],92:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule SyntheticMouseEvent
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var SyntheticUIEvent = _dereq_("./SyntheticUIEvent");
+var ViewportMetrics = _dereq_("./ViewportMetrics");
+
+/**
+ * @interface MouseEvent
+ * @see http://www.w3.org/TR/DOM-Level-3-Events/
+ */
+var MouseEventInterface = {
+  screenX: null,
+  screenY: null,
+  clientX: null,
+  clientY: null,
+  ctrlKey: null,
+  shiftKey: null,
+  altKey: null,
+  metaKey: null,
+  button: function(event) {
+    // Webkit, Firefox, IE9+
+    // which:  1 2 3
+    // button: 0 1 2 (standard)
+    var button = event.button;
+    if ('which' in event) {
+      return button;
+    }
+    // IE<9
+    // which:  undefined
+    // button: 0 0 0
+    // button: 1 4 2 (onmouseup)
+    return button === 2 ? 2 : button === 4 ? 1 : 0;
+  },
+  buttons: null,
+  relatedTarget: function(event) {
+    return event.relatedTarget || (
+      event.fromElement === event.srcElement ?
+        event.toElement :
+        event.fromElement
+    );
+  },
+  // "Proprietary" Interface.
+  pageX: function(event) {
+    return 'pageX' in event ?
+      event.pageX :
+      event.clientX + ViewportMetrics.currentScrollLeft;
+  },
+  pageY: function(event) {
+    return 'pageY' in event ?
+      event.pageY :
+      event.clientY + ViewportMetrics.currentScrollTop;
+  }
+};
+
+/**
+ * @param {object} dispatchConfig Configuration used to dispatch this event.
+ * @param {string} dispatchMarker Marker identifying the event target.
+ * @param {object} nativeEvent Native browser event.
+ * @extends {SyntheticUIEvent}
+ */
+function SyntheticMouseEvent(dispatchConfig, dispatchMarker, nativeEvent) {
+  SyntheticUIEvent.call(this, dispatchConfig, dispatchMarker, nativeEvent);
+}
+
+SyntheticUIEvent.augmentClass(SyntheticMouseEvent, MouseEventInterface);
+
+module.exports = SyntheticMouseEvent;
+
+},{"./SyntheticUIEvent":94,"./ViewportMetrics":97}],93:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule SyntheticTouchEvent
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var SyntheticUIEvent = _dereq_("./SyntheticUIEvent");
+
+/**
+ * @interface TouchEvent
+ * @see http://www.w3.org/TR/touch-events/
+ */
+var TouchEventInterface = {
+  touches: null,
+  targetTouches: null,
+  changedTouches: null,
+  altKey: null,
+  metaKey: null,
+  ctrlKey: null,
+  shiftKey: null
+};
+
+/**
+ * @param {object} dispatchConfig Configuration used to dispatch this event.
+ * @param {string} dispatchMarker Marker identifying the event target.
+ * @param {object} nativeEvent Native browser event.
+ * @extends {SyntheticUIEvent}
+ */
+function SyntheticTouchEvent(dispatchConfig, dispatchMarker, nativeEvent) {
+  SyntheticUIEvent.call(this, dispatchConfig, dispatchMarker, nativeEvent);
+}
+
+SyntheticUIEvent.augmentClass(SyntheticTouchEvent, TouchEventInterface);
+
+module.exports = SyntheticTouchEvent;
+
+},{"./SyntheticUIEvent":94}],94:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule SyntheticUIEvent
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var SyntheticEvent = _dereq_("./SyntheticEvent");
+
+/**
+ * @interface UIEvent
+ * @see http://www.w3.org/TR/DOM-Level-3-Events/
+ */
+var UIEventInterface = {
+  view: null,
+  detail: null
+};
+
+/**
+ * @param {object} dispatchConfig Configuration used to dispatch this event.
+ * @param {string} dispatchMarker Marker identifying the event target.
+ * @param {object} nativeEvent Native browser event.
+ * @extends {SyntheticEvent}
+ */
+function SyntheticUIEvent(dispatchConfig, dispatchMarker, nativeEvent) {
+  SyntheticEvent.call(this, dispatchConfig, dispatchMarker, nativeEvent);
+}
+
+SyntheticEvent.augmentClass(SyntheticUIEvent, UIEventInterface);
+
+module.exports = SyntheticUIEvent;
+
+},{"./SyntheticEvent":89}],95:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule SyntheticWheelEvent
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var SyntheticMouseEvent = _dereq_("./SyntheticMouseEvent");
+
+/**
+ * @interface WheelEvent
+ * @see http://www.w3.org/TR/DOM-Level-3-Events/
+ */
+var WheelEventInterface = {
+  deltaX: function(event) {
+    return (
+      'deltaX' in event ? event.deltaX :
+      // Fallback to `wheelDeltaX` for Webkit and normalize (right is positive).
+      'wheelDeltaX' in event ? -event.wheelDeltaX : 0
+    );
+  },
+  deltaY: function(event) {
+    return (
+      'deltaY' in event ? event.deltaY :
+      // Fallback to `wheelDeltaY` for Webkit and normalize (down is positive).
+      'wheelDeltaY' in event ? -event.wheelDeltaY :
+      // Fallback to `wheelDelta` for IE<9 and normalize (down is positive).
+      'wheelDelta' in event ? -event.wheelDelta : 0
+    );
+  },
+  deltaZ: null,
+
+  // Browsers without "deltaMode" is reporting in raw wheel delta where one
+  // notch on the scroll is always +/- 120, roughly equivalent to pixels.
+  // A good approximation of DOM_DELTA_LINE (1) is 5% of viewport size or
+  // ~40 pixels, for DOM_DELTA_SCREEN (2) it is 87.5% of viewport size.
+  deltaMode: null
+};
+
+/**
+ * @param {object} dispatchConfig Configuration used to dispatch this event.
+ * @param {string} dispatchMarker Marker identifying the event target.
+ * @param {object} nativeEvent Native browser event.
+ * @extends {SyntheticMouseEvent}
+ */
+function SyntheticWheelEvent(dispatchConfig, dispatchMarker, nativeEvent) {
+  SyntheticMouseEvent.call(this, dispatchConfig, dispatchMarker, nativeEvent);
+}
+
+SyntheticMouseEvent.augmentClass(SyntheticWheelEvent, WheelEventInterface);
+
+module.exports = SyntheticWheelEvent;
+
+},{"./SyntheticMouseEvent":92}],96:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule Transaction
+ */
+
+"use strict";
+
+var invariant = _dereq_("./invariant");
+
+/**
+ * `Transaction` creates a black box that is able to wrap any method such that
+ * certain invariants are maintained before and after the method is invoked
+ * (Even if an exception is thrown while invoking the wrapped method). Whoever
+ * instantiates a transaction can provide enforcers of the invariants at
+ * creation time. The `Transaction` class itself will supply one additional
+ * automatic invariant for you - the invariant that any transaction instance
+ * should not be run while it is already being run. You would typically create a
+ * single instance of a `Transaction` for reuse multiple times, that potentially
+ * is used to wrap several different methods. Wrappers are extremely simple -
+ * they only require implementing two methods.
+ *
+ * <pre>
+ *                       wrappers (injected at creation time)
+ *                                      +        +
+ *                                      |        |
+ *                    +-----------------|--------|--------------+
+ *                    |                 v        |              |
+ *                    |      +---------------+   |              |
+ *                    |   +--|    wrapper1   |---|----+         |
+ *                    |   |  +---------------+   v    |         |
+ *                    |   |          +-------------+  |         |
+ *                    |   |     +----|   wrapper2  |--------+   |
+ *                    |   |     |    +-------------+  |     |   |
+ *                    |   |     |                     |     |   |
+ *                    |   v     v                     v     v   | wrapper
+ *                    | +---+ +---+   +---------+   +---+ +---+ | invariants
+ * perform(anyMethod) | |   | |   |   |         |   |   | |   | | maintained
+ * +----------------->|-|---|-|---|-->|anyMethod|---|---|-|---|-|-------->
+ *                    | |   | |   |   |         |   |   | |   | |
+ *                    | |   | |   |   |         |   |   | |   | |
+ *                    | |   | |   |   |         |   |   | |   | |
+ *                    | +---+ +---+   +---------+   +---+ +---+ |
+ *                    |  initialize                    close    |
+ *                    +-----------------------------------------+
+ * </pre>
+ *
+ * Bonus:
+ * - Reports timing metrics by method name and wrapper index.
+ *
+ * Use cases:
+ * - Preserving the input selection ranges before/after reconciliation.
+ *   Restoring selection even in the event of an unexpected error.
+ * - Deactivating events while rearranging the DOM, preventing blurs/focuses,
+ *   while guaranteeing that afterwards, the event system is reactivated.
+ * - Flushing a queue of collected DOM mutations to the main UI thread after a
+ *   reconciliation takes place in a worker thread.
+ * - Invoking any collected `componentDidUpdate` callbacks after rendering new
+ *   content.
+ * - (Future use case): Wrapping particular flushes of the `ReactWorker` queue
+ *   to preserve the `scrollTop` (an automatic scroll aware DOM).
+ * - (Future use case): Layout calculations before and after DOM upates.
+ *
+ * Transactional plugin API:
+ * - A module that has an `initialize` method that returns any precomputation.
+ * - and a `close` method that accepts the precomputation. `close` is invoked
+ *   when the wrapped process is completed, or has failed.
+ *
+ * @param {Array<TransactionalWrapper>} transactionWrapper Wrapper modules
+ * that implement `initialize` and `close`.
+ * @return {Transaction} Single transaction for reuse in thread.
+ *
+ * @class Transaction
+ */
+var Mixin = {
+  /**
+   * Sets up this instance so that it is prepared for collecting metrics. Does
+   * so such that this setup method may be used on an instance that is already
+   * initialized, in a way that does not consume additional memory upon reuse.
+   * That can be useful if you decide to make your subclass of this mixin a
+   * "PooledClass".
+   */
+  reinitializeTransaction: function() {
+    this.transactionWrappers = this.getTransactionWrappers();
+    if (!this.wrapperInitData) {
+      this.wrapperInitData = [];
+    } else {
+      this.wrapperInitData.length = 0;
+    }
+    if (!this.timingMetrics) {
+      this.timingMetrics = {};
+    }
+    this.timingMetrics.methodInvocationTime = 0;
+    if (!this.timingMetrics.wrapperInitTimes) {
+      this.timingMetrics.wrapperInitTimes = [];
+    } else {
+      this.timingMetrics.wrapperInitTimes.length = 0;
+    }
+    if (!this.timingMetrics.wrapperCloseTimes) {
+      this.timingMetrics.wrapperCloseTimes = [];
+    } else {
+      this.timingMetrics.wrapperCloseTimes.length = 0;
+    }
+    this._isInTransaction = false;
+  },
+
+  _isInTransaction: false,
+
+  /**
+   * @abstract
+   * @return {Array<TransactionWrapper>} Array of transaction wrappers.
+   */
+  getTransactionWrappers: null,
+
+  isInTransaction: function() {
+    return !!this._isInTransaction;
+  },
+
+  /**
+   * Executes the function within a safety window. Use this for the top level
+   * methods that result in large amounts of computation/mutations that would
+   * need to be safety checked.
+   *
+   * @param {function} method Member of scope to call.
+   * @param {Object} scope Scope to invoke from.
+   * @param {Object?=} args... Arguments to pass to the method (optional).
+   *                           Helps prevent need to bind in many cases.
+   * @return Return value from `method`.
+   */
+  perform: function(method, scope, a, b, c, d, e, f) {
+    ("production" !== "development" ? invariant(
+      !this.isInTransaction(),
+      'Transaction.perform(...): Cannot initialize a transaction when there ' +
+      'is already an outstanding transaction.'
+    ) : invariant(!this.isInTransaction()));
+    var memberStart = Date.now();
+    var errorThrown;
+    var ret;
+    try {
+      this._isInTransaction = true;
+      // Catching errors makes debugging more difficult, so we start with
+      // errorThrown set to true before setting it to false after calling
+      // close -- if it's still set to true in the finally block, it means
+      // one of these calls threw.
+      errorThrown = true;
+      this.initializeAll(0);
+      ret = method.call(scope, a, b, c, d, e, f);
+      errorThrown = false;
+    } finally {
+      var memberEnd = Date.now();
+      this.methodInvocationTime += (memberEnd - memberStart);
+      try {
+        if (errorThrown) {
+          // If `method` throws, prefer to show that stack trace over any thrown
+          // by invoking `closeAll`.
+          try {
+            this.closeAll(0);
+          } catch (err) {
+          }
+        } else {
+          // Since `method` didn't throw, we don't want to silence the exception
+          // here.
+          this.closeAll(0);
+        }
+      } finally {
+        this._isInTransaction = false;
+      }
+    }
+    return ret;
+  },
+
+  initializeAll: function(startIndex) {
+    var transactionWrappers = this.transactionWrappers;
+    var wrapperInitTimes = this.timingMetrics.wrapperInitTimes;
+    for (var i = startIndex; i < transactionWrappers.length; i++) {
+      var initStart = Date.now();
+      var wrapper = transactionWrappers[i];
+      try {
+        // Catching errors makes debugging more difficult, so we start with the
+        // OBSERVED_ERROR state before overwriting it with the real return value
+        // of initialize -- if it's still set to OBSERVED_ERROR in the finally
+        // block, it means wrapper.initialize threw.
+        this.wrapperInitData[i] = Transaction.OBSERVED_ERROR;
+        this.wrapperInitData[i] = wrapper.initialize ?
+          wrapper.initialize.call(this) :
+          null;
+      } finally {
+        var curInitTime = wrapperInitTimes[i];
+        var initEnd = Date.now();
+        wrapperInitTimes[i] = (curInitTime || 0) + (initEnd - initStart);
+
+        if (this.wrapperInitData[i] === Transaction.OBSERVED_ERROR) {
+          // The initializer for wrapper i threw an error; initialize the
+          // remaining wrappers but silence any exceptions from them to ensure
+          // that the first error is the one to bubble up.
+          try {
+            this.initializeAll(i + 1);
+          } catch (err) {
+          }
+        }
+      }
+    }
+  },
+
+  /**
+   * Invokes each of `this.transactionWrappers.close[i]` functions, passing into
+   * them the respective return values of `this.transactionWrappers.init[i]`
+   * (`close`rs that correspond to initializers that failed will not be
+   * invoked).
+   */
+  closeAll: function(startIndex) {
+    ("production" !== "development" ? invariant(
+      this.isInTransaction(),
+      'Transaction.closeAll(): Cannot close transaction when none are open.'
+    ) : invariant(this.isInTransaction()));
+    var transactionWrappers = this.transactionWrappers;
+    var wrapperCloseTimes = this.timingMetrics.wrapperCloseTimes;
+    for (var i = startIndex; i < transactionWrappers.length; i++) {
+      var wrapper = transactionWrappers[i];
+      var closeStart = Date.now();
+      var initData = this.wrapperInitData[i];
+      var errorThrown;
+      try {
+        // Catching errors makes debugging more difficult, so we start with
+        // errorThrown set to true before setting it to false after calling
+        // close -- if it's still set to true in the finally block, it means
+        // wrapper.close threw.
+        errorThrown = true;
+        if (initData !== Transaction.OBSERVED_ERROR) {
+          wrapper.close && wrapper.close.call(this, initData);
+        }
+        errorThrown = false;
+      } finally {
+        var closeEnd = Date.now();
+        var curCloseTime = wrapperCloseTimes[i];
+        wrapperCloseTimes[i] = (curCloseTime || 0) + (closeEnd - closeStart);
+
+        if (errorThrown) {
+          // The closer for wrapper i threw an error; close the remaining
+          // wrappers but silence any exceptions from them to ensure that the
+          // first error is the one to bubble up.
+          try {
+            this.closeAll(i + 1);
+          } catch (e) {
+          }
+        }
+      }
+    }
+    this.wrapperInitData.length = 0;
+  }
+};
+
+var Transaction = {
+
+  Mixin: Mixin,
+
+  /**
+   * Token to look for to determine if an error occured.
+   */
+  OBSERVED_ERROR: {}
+
+};
+
+module.exports = Transaction;
+
+},{"./invariant":125}],97:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ViewportMetrics
+ */
+
+"use strict";
+
+var getUnboundedScrollPosition = _dereq_("./getUnboundedScrollPosition");
+
+var ViewportMetrics = {
+
+  currentScrollLeft: 0,
+
+  currentScrollTop: 0,
+
+  refreshScrollValues: function() {
+    var scrollPosition = getUnboundedScrollPosition(window);
+    ViewportMetrics.currentScrollLeft = scrollPosition.x;
+    ViewportMetrics.currentScrollTop = scrollPosition.y;
+  }
+
+};
+
+module.exports = ViewportMetrics;
+
+},{"./getUnboundedScrollPosition":122}],98:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule accumulate
+ */
+
+"use strict";
+
+var invariant = _dereq_("./invariant");
+
+/**
+ * Accumulates items that must not be null or undefined.
+ *
+ * This is used to conserve memory by avoiding array allocations.
+ *
+ * @return {*|array<*>} An accumulation of items.
+ */
+function accumulate(current, next) {
+  ("production" !== "development" ? invariant(
+    next != null,
+    'accumulate(...): Accumulated items must be not be null or undefined.'
+  ) : invariant(next != null));
+  if (current == null) {
+    return next;
+  } else {
+    // Both are not empty. Warning: Never call x.concat(y) when you are not
+    // certain that x is an Array (x could be a string with concat method).
+    var currentIsArray = Array.isArray(current);
+    var nextIsArray = Array.isArray(next);
+    if (currentIsArray) {
+      return current.concat(next);
+    } else {
+      if (nextIsArray) {
+        return [current].concat(next);
+      } else {
+        return [current, next];
+      }
+    }
+  }
+}
+
+module.exports = accumulate;
+
+},{"./invariant":125}],99:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule adler32
+ */
+
+/* jslint bitwise:true */
+
+"use strict";
+
+var MOD = 65521;
+
+// This is a clean-room implementation of adler32 designed for detecting
+// if markup is not what we expect it to be. It does not need to be
+// cryptographically strong, only reasonable good at detecting if markup
+// generated on the server is different than that on the client.
+function adler32(data) {
+  var a = 1;
+  var b = 0;
+  for (var i = 0; i < data.length; i++) {
+    a = (a + data.charCodeAt(i)) % MOD;
+    b = (b + a) % MOD;
+  }
+  return a | (b << 16);
+}
+
+module.exports = adler32;
+
+},{}],100:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @typechecks
+ * @providesModule cloneWithProps
+ */
+
+"use strict";
+
+var ReactPropTransferer = _dereq_("./ReactPropTransferer");
+
+var keyOf = _dereq_("./keyOf");
+var warning = _dereq_("./warning");
+
+var CHILDREN_PROP = keyOf({children: null});
+
+/**
+ * Sometimes you want to change the props of a child passed to you. Usually
+ * this is to add a CSS class.
+ *
+ * @param {object} child child component you'd like to clone
+ * @param {object} props props you'd like to modify. They will be merged
+ * as if you used `transferPropsTo()`.
+ * @return {object} a clone of child with props merged in.
+ */
+function cloneWithProps(child, props) {
+  if ("production" !== "development") {
+    ("production" !== "development" ? warning(
+      !child.props.ref,
+      'You are calling cloneWithProps() on a child with a ref. This is ' +
+      'dangerous because you\'re creating a new child which will not be ' +
+      'added as a ref to its parent.'
+    ) : null);
+  }
+
+  var newProps = ReactPropTransferer.mergeProps(props, child.props);
+
+  // Use `child.props.children` if it is provided.
+  if (!newProps.hasOwnProperty(CHILDREN_PROP) &&
+      child.props.hasOwnProperty(CHILDREN_PROP)) {
+    newProps.children = child.props.children;
+  }
+
+  return child.constructor.ConvenienceConstructor(newProps);
+}
+
+module.exports = cloneWithProps;
+
+},{"./ReactPropTransferer":66,"./keyOf":132,"./warning":148}],101:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule containsNode
+ * @typechecks
+ */
+
+var isTextNode = _dereq_("./isTextNode");
+
+/*jslint bitwise:true */
+
+/**
+ * Checks if a given DOM node contains or is another DOM node.
+ *
+ * @param {?DOMNode} outerNode Outer DOM node.
+ * @param {?DOMNode} innerNode Inner DOM node.
+ * @return {boolean} True if `outerNode` contains or is `innerNode`.
+ */
+function containsNode(outerNode, innerNode) {
+  if (!outerNode || !innerNode) {
+    return false;
+  } else if (outerNode === innerNode) {
+    return true;
+  } else if (isTextNode(outerNode)) {
+    return false;
+  } else if (isTextNode(innerNode)) {
+    return containsNode(outerNode, innerNode.parentNode);
+  } else if (outerNode.contains) {
+    return outerNode.contains(innerNode);
+  } else if (outerNode.compareDocumentPosition) {
+    return !!(outerNode.compareDocumentPosition(innerNode) & 16);
+  } else {
+    return false;
+  }
+}
+
+module.exports = containsNode;
+
+},{"./isTextNode":129}],102:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule copyProperties
+ */
+
+/**
+ * Copy properties from one or more objects (up to 5) into the first object.
+ * This is a shallow copy. It mutates the first object and also returns it.
+ *
+ * NOTE: `arguments` has a very significant performance penalty, which is why
+ * we don't support unlimited arguments.
+ */
+function copyProperties(obj, a, b, c, d, e, f) {
+  obj = obj || {};
+
+  if ("production" !== "development") {
+    if (f) {
+      throw new Error('Too many arguments passed to copyProperties');
+    }
+  }
+
+  var args = [a, b, c, d, e];
+  var ii = 0, v;
+  while (args[ii]) {
+    v = args[ii++];
+    for (var k in v) {
+      obj[k] = v[k];
+    }
+
+    // IE ignores toString in object iteration.. See:
+    // webreflection.blogspot.com/2007/07/quick-fix-internet-explorer-and.html
+    if (v.hasOwnProperty && v.hasOwnProperty('toString') &&
+        (typeof v.toString != 'undefined') && (obj.toString !== v.toString)) {
+      obj.toString = v.toString;
+    }
+  }
+
+  return obj;
+}
+
+module.exports = copyProperties;
+
+},{}],103:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule createArrayFrom
+ * @typechecks
+ */
+
+var toArray = _dereq_("./toArray");
+
+/**
+ * Perform a heuristic test to determine if an object is "array-like".
+ *
+ *   A monk asked Joshu, a Zen master, "Has a dog Buddha nature?"
+ *   Joshu replied: "Mu."
+ *
+ * This function determines if its argument has "array nature": it returns
+ * true if the argument is an actual array, an `arguments' object, or an
+ * HTMLCollection (e.g. node.childNodes or node.getElementsByTagName()).
+ *
+ * It will return false for other array-like objects like Filelist.
+ *
+ * @param {*} obj
+ * @return {boolean}
+ */
+function hasArrayNature(obj) {
+  return (
+    // not null/false
+    !!obj &&
+    // arrays are objects, NodeLists are functions in Safari
+    (typeof obj == 'object' || typeof obj == 'function') &&
+    // quacks like an array
+    ('length' in obj) &&
+    // not window
+    !('setInterval' in obj) &&
+    // no DOM node should be considered an array-like
+    // a 'select' element has 'length' and 'item' properties on IE8
+    (typeof obj.nodeType != 'number') &&
+    (
+      // a real array
+      (// HTMLCollection/NodeList
+      (Array.isArray(obj) ||
+      // arguments
+      ('callee' in obj) || 'item' in obj))
+    )
+  );
+}
+
+/**
+ * Ensure that the argument is an array by wrapping it in an array if it is not.
+ * Creates a copy of the argument if it is already an array.
+ *
+ * This is mostly useful idiomatically:
+ *
+ *   var createArrayFrom = require('createArrayFrom');
+ *
+ *   function takesOneOrMoreThings(things) {
+ *     things = createArrayFrom(things);
+ *     ...
+ *   }
+ *
+ * This allows you to treat `things' as an array, but accept scalars in the API.
+ *
+ * If you need to convert an array-like object, like `arguments`, into an array
+ * use toArray instead.
+ *
+ * @param {*} obj
+ * @return {array}
+ */
+function createArrayFrom(obj) {
+  if (!hasArrayNature(obj)) {
+    return [obj];
+  } else if (Array.isArray(obj)) {
+    return obj.slice();
+  } else {
+    return toArray(obj);
+  }
+}
+
+module.exports = createArrayFrom;
+
+},{"./toArray":145}],104:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule createFullPageComponent
+ * @typechecks
+ */
+
+"use strict";
+
+// Defeat circular references by requiring this directly.
+var ReactCompositeComponent = _dereq_("./ReactCompositeComponent");
+
+var invariant = _dereq_("./invariant");
+
+/**
+ * Create a component that will throw an exception when unmounted.
+ *
+ * Components like <html> <head> and <body> can't be removed or added
+ * easily in a cross-browser way, however it's valuable to be able to
+ * take advantage of React's reconciliation for styling and <title>
+ * management. So we just document it and throw in dangerous cases.
+ *
+ * @param {function} componentClass convenience constructor to wrap
+ * @return {function} convenience constructor of new component
+ */
+function createFullPageComponent(componentClass) {
+  var FullPageComponent = ReactCompositeComponent.createClass({
+    displayName: 'ReactFullPageComponent' + (
+      componentClass.componentConstructor.displayName || ''
+    ),
+
+    componentWillUnmount: function() {
+      ("production" !== "development" ? invariant(
+        false,
+        '%s tried to unmount. Because of cross-browser quirks it is ' +
+        'impossible to unmount some top-level components (eg <html>, <head>, ' +
+        'and <body>) reliably and efficiently. To fix this, have a single ' +
+        'top-level component that never unmounts render these elements.',
+        this.constructor.displayName
+      ) : invariant(false));
+    },
+
+    render: function() {
+      return this.transferPropsTo(componentClass(null, this.props.children));
+    }
+  });
+
+  return FullPageComponent;
+}
+
+module.exports = createFullPageComponent;
+
+},{"./ReactCompositeComponent":33,"./invariant":125}],105:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule createNodesFromMarkup
+ * @typechecks
+ */
+
+/*jslint evil: true, sub: true */
+
+var ExecutionEnvironment = _dereq_("./ExecutionEnvironment");
+
+var createArrayFrom = _dereq_("./createArrayFrom");
+var getMarkupWrap = _dereq_("./getMarkupWrap");
+var invariant = _dereq_("./invariant");
+
+/**
+ * Dummy container used to render all markup.
+ */
+var dummyNode =
+  ExecutionEnvironment.canUseDOM ? document.createElement('div') : null;
+
+/**
+ * Pattern used by `getNodeName`.
+ */
+var nodeNamePattern = /^\s*<(\w+)/;
+
+/**
+ * Extracts the `nodeName` of the first element in a string of markup.
+ *
+ * @param {string} markup String of markup.
+ * @return {?string} Node name of the supplied markup.
+ */
+function getNodeName(markup) {
+  var nodeNameMatch = markup.match(nodeNamePattern);
+  return nodeNameMatch && nodeNameMatch[1].toLowerCase();
+}
+
+/**
+ * Creates an array containing the nodes rendered from the supplied markup. The
+ * optionally supplied `handleScript` function will be invoked once for each
+ * <script> element that is rendered. If no `handleScript` function is supplied,
+ * an exception is thrown if any <script> elements are rendered.
+ *
+ * @param {string} markup A string of valid HTML markup.
+ * @param {?function} handleScript Invoked once for each rendered <script>.
+ * @return {array<DOMElement|DOMTextNode>} An array of rendered nodes.
+ */
+function createNodesFromMarkup(markup, handleScript) {
+  var node = dummyNode;
+  ("production" !== "development" ? invariant(!!dummyNode, 'createNodesFromMarkup dummy not initialized') : invariant(!!dummyNode));
+  var nodeName = getNodeName(markup);
+
+  var wrap = nodeName && getMarkupWrap(nodeName);
+  if (wrap) {
+    node.innerHTML = wrap[1] + markup + wrap[2];
+
+    var wrapDepth = wrap[0];
+    while (wrapDepth--) {
+      node = node.lastChild;
+    }
+  } else {
+    node.innerHTML = markup;
+  }
+
+  var scripts = node.getElementsByTagName('script');
+  if (scripts.length) {
+    ("production" !== "development" ? invariant(
+      handleScript,
+      'createNodesFromMarkup(...): Unexpected <script> element rendered.'
+    ) : invariant(handleScript));
+    createArrayFrom(scripts).forEach(handleScript);
+  }
+
+  var nodes = createArrayFrom(node.childNodes);
+  while (node.lastChild) {
+    node.removeChild(node.lastChild);
+  }
+  return nodes;
+}
+
+module.exports = createNodesFromMarkup;
+
+},{"./ExecutionEnvironment":21,"./createArrayFrom":103,"./getMarkupWrap":118,"./invariant":125}],106:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule createObjectFrom
+ */
+
+/**
+ * Construct an object from an array of keys
+ * and optionally specified value or list of values.
+ *
+ *  >>> createObjectFrom(['a','b','c']);
+ *  {a: true, b: true, c: true}
+ *
+ *  >>> createObjectFrom(['a','b','c'], false);
+ *  {a: false, b: false, c: false}
+ *
+ *  >>> createObjectFrom(['a','b','c'], 'monkey');
+ *  {c:'monkey', b:'monkey' c:'monkey'}
+ *
+ *  >>> createObjectFrom(['a','b','c'], [1,2,3]);
+ *  {a: 1, b: 2, c: 3}
+ *
+ *  >>> createObjectFrom(['women', 'men'], [true, false]);
+ *  {women: true, men: false}
+ *
+ * @param   Array   list of keys
+ * @param   mixed   optional value or value array.  defaults true.
+ * @returns object
+ */
+function createObjectFrom(keys, values /* = true */) {
+  if ("production" !== "development") {
+    if (!Array.isArray(keys)) {
+      throw new TypeError('Must pass an array of keys.');
+    }
+  }
+
+  var object = {};
+  var isArray = Array.isArray(values);
+  if (typeof values == 'undefined') {
+    values = true;
+  }
+
+  for (var ii = keys.length; ii--;) {
+    object[keys[ii]] = isArray ? values[ii] : values;
+  }
+  return object;
+}
+
+module.exports = createObjectFrom;
+
+},{}],107:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule cx
+ */
+
+/**
+ * This function is used to mark string literals representing CSS class names
+ * so that they can be transformed statically. This allows for modularization
+ * and minification of CSS class names.
+ *
+ * In static_upstream, this function is actually implemented, but it should
+ * eventually be replaced with something more descriptive, and the transform
+ * that is used in the main stack should be ported for use elsewhere.
+ *
+ * @param string|object className to modularize, or an object of key/values.
+ *                      In the object case, the values are conditions that
+ *                      determine if the className keys should be included.
+ * @param [string ...]  Variable list of classNames in the string case.
+ * @return string       Renderable space-separated CSS className.
+ */
+function cx(classNames) {
+  if (typeof classNames == 'object') {
+    return Object.keys(classNames).filter(function(className) {
+      return classNames[className];
+    }).join(' ');
+  } else {
+    return Array.prototype.join.call(arguments, ' ');
+  }
+}
+
+module.exports = cx;
+
+},{}],108:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule dangerousStyleValue
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var CSSProperty = _dereq_("./CSSProperty");
+
+/**
+ * Convert a value into the proper css writable value. The `styleName` name
+ * name should be logical (no hyphens), as specified
+ * in `CSSProperty.isUnitlessNumber`.
+ *
+ * @param {string} styleName CSS property name such as `topMargin`.
+ * @param {*} value CSS property value such as `10px`.
+ * @return {string} Normalized style value with dimensions applied.
+ */
+function dangerousStyleValue(styleName, value) {
+  // Note that we've removed escapeTextForBrowser() calls here since the
+  // whole string will be escaped when the attribute is injected into
+  // the markup. If you provide unsafe user data here they can inject
+  // arbitrary CSS which may be problematic (I couldn't repro this):
+  // https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet
+  // http://www.thespanner.co.uk/2007/11/26/ultimate-xss-css-injection/
+  // This is not an XSS hole but instead a potential CSS injection issue
+  // which has lead to a greater discussion about how we're going to
+  // trust URLs moving forward. See #2115901
+
+  var isEmpty = value == null || typeof value === 'boolean' || value === '';
+  if (isEmpty) {
+    return '';
+  }
+
+  var isNonNumeric = isNaN(value);
+  if (isNonNumeric || value === 0 || CSSProperty.isUnitlessNumber[styleName]) {
+    return '' + value; // cast to string
+  }
+
+  return value + 'px';
+}
+
+module.exports = dangerousStyleValue;
+
+},{"./CSSProperty":3}],109:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule emptyFunction
+ */
+
+var copyProperties = _dereq_("./copyProperties");
+
+function makeEmptyFunction(arg) {
+  return function() {
+    return arg;
+  };
+}
+
+/**
+ * This function accepts and discards inputs; it has no side effects. This is
+ * primarily useful idiomatically for overridable function endpoints which
+ * always need to be callable, since JS lacks a null-call idiom ala Cocoa.
+ */
+function emptyFunction() {}
+
+copyProperties(emptyFunction, {
+  thatReturns: makeEmptyFunction,
+  thatReturnsFalse: makeEmptyFunction(false),
+  thatReturnsTrue: makeEmptyFunction(true),
+  thatReturnsNull: makeEmptyFunction(null),
+  thatReturnsThis: function() { return this; },
+  thatReturnsArgument: function(arg) { return arg; }
+});
+
+module.exports = emptyFunction;
+
+},{"./copyProperties":102}],110:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule emptyObject
+ */
+
+"use strict";
+
+var emptyObject = {};
+
+if ("production" !== "development") {
+  Object.freeze(emptyObject);
+}
+
+module.exports = emptyObject;
+
+},{}],111:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule escapeTextForBrowser
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var ESCAPE_LOOKUP = {
+  "&": "&amp;",
+  ">": "&gt;",
+  "<": "&lt;",
+  "\"": "&quot;",
+  "'": "&#x27;",
+  "/": "&#x2f;"
+};
+
+var ESCAPE_REGEX = /[&><"'\/]/g;
+
+function escaper(match) {
+  return ESCAPE_LOOKUP[match];
+}
+
+/**
+ * Escapes text to prevent scripting attacks.
+ *
+ * @param {*} text Text value to escape.
+ * @return {string} An escaped string.
+ */
+function escapeTextForBrowser(text) {
+  return ('' + text).replace(ESCAPE_REGEX, escaper);
+}
+
+module.exports = escapeTextForBrowser;
+
+},{}],112:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule flattenChildren
+ */
+
+"use strict";
+
+var invariant = _dereq_("./invariant");
+var traverseAllChildren = _dereq_("./traverseAllChildren");
+
+/**
+ * @param {function} traverseContext Context passed through traversal.
+ * @param {?ReactComponent} child React child component.
+ * @param {!string} name String name of key path to child.
+ */
+function flattenSingleChildIntoContext(traverseContext, child, name) {
+  // We found a component instance.
+  var result = traverseContext;
+  ("production" !== "development" ? invariant(
+    !result.hasOwnProperty(name),
+    'flattenChildren(...): Encountered two children with the same key, `%s`. ' +
+    'Children keys must be unique.',
+    name
+  ) : invariant(!result.hasOwnProperty(name)));
+  if (child != null) {
+    result[name] = child;
+  }
+}
+
+/**
+ * Flattens children that are typically specified as `props.children`. Any null
+ * children will not be included in the resulting object.
+ * @return {!object} flattened children keyed by name.
+ */
+function flattenChildren(children) {
+  if (children == null) {
+    return children;
+  }
+  var result = {};
+  traverseAllChildren(children, flattenSingleChildIntoContext, result);
+  return result;
+}
+
+module.exports = flattenChildren;
+
+},{"./invariant":125,"./traverseAllChildren":146}],113:[function(_dereq_,module,exports){
+/**
+ * Copyright 2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule focusNode
+ */
+
+"use strict";
+
+/**
+ * IE8 throws if an input/textarea is disabled and we try to focus it.
+ * Focus only when necessary.
+ *
+ * @param {DOMElement} node input/textarea to focus
+ */
+function focusNode(node) {
+  if (!node.disabled) {
+    node.focus();
+  }
+}
+
+module.exports = focusNode;
+
+},{}],114:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule forEachAccumulated
+ */
+
+"use strict";
+
+/**
+ * @param {array} an "accumulation" of items which is either an Array or
+ * a single item. Useful when paired with the `accumulate` module. This is a
+ * simple utility that allows us to reason about a collection of items, but
+ * handling the case when there is exactly one item (and we do not need to
+ * allocate an array).
+ */
+var forEachAccumulated = function(arr, cb, scope) {
+  if (Array.isArray(arr)) {
+    arr.forEach(cb, scope);
+  } else if (arr) {
+    cb.call(scope, arr);
+  }
+};
+
+module.exports = forEachAccumulated;
+
+},{}],115:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule getActiveElement
+ * @typechecks
+ */
+
+/**
+ * Same as document.activeElement but wraps in a try-catch block. In IE it is
+ * not safe to call document.activeElement if there is nothing focused.
+ *
+ * The activeElement will be null only if the document body is not yet defined.
+ */
+function getActiveElement() /*?DOMElement*/ {
+  try {
+    return document.activeElement || document.body;
+  } catch (e) {
+    return document.body;
+  }
+}
+
+module.exports = getActiveElement;
+
+},{}],116:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule getEventKey
+ * @typechecks static-only
+ */
+
+"use strict";
+
+/**
+ * Normalization of deprecated HTML5 "key" values
+ * @see https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent#Key_names
+ */
+var normalizeKey = {
+  'Esc': 'Escape',
+  'Spacebar': ' ',
+  'Left': 'ArrowLeft',
+  'Up': 'ArrowUp',
+  'Right': 'ArrowRight',
+  'Down': 'ArrowDown',
+  'Del': 'Delete',
+  'Win': 'OS',
+  'Menu': 'ContextMenu',
+  'Apps': 'ContextMenu',
+  'Scroll': 'ScrollLock',
+  'MozPrintableKey': 'Unidentified'
+};
+
+/**
+ * Translation from legacy "which/keyCode" to HTML5 "key"
+ * Only special keys supported, all others depend on keyboard layout or browser
+ * @see https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent#Key_names
+ */
+var translateToKey = {
+  8: 'Backspace',
+  9: 'Tab',
+  12: 'Clear',
+  13: 'Enter',
+  16: 'Shift',
+  17: 'Control',
+  18: 'Alt',
+  19: 'Pause',
+  20: 'CapsLock',
+  27: 'Escape',
+  32: ' ',
+  33: 'PageUp',
+  34: 'PageDown',
+  35: 'End',
+  36: 'Home',
+  37: 'ArrowLeft',
+  38: 'ArrowUp',
+  39: 'ArrowRight',
+  40: 'ArrowDown',
+  45: 'Insert',
+  46: 'Delete',
+  112: 'F1', 113: 'F2', 114: 'F3', 115: 'F4', 116: 'F5', 117: 'F6',
+  118: 'F7', 119: 'F8', 120: 'F9', 121: 'F10', 122: 'F11', 123: 'F12',
+  144: 'NumLock',
+  145: 'ScrollLock',
+  224: 'Meta'
+};
+
+/**
+ * @param {object} nativeEvent Native browser event.
+ * @return {string} Normalized `key` property.
+ */
+function getEventKey(nativeEvent) {
+  return 'key' in nativeEvent ?
+    normalizeKey[nativeEvent.key] || nativeEvent.key :
+    translateToKey[nativeEvent.which || nativeEvent.keyCode] || 'Unidentified';
+}
+
+module.exports = getEventKey;
+
+},{}],117:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule getEventTarget
+ * @typechecks static-only
+ */
+
+"use strict";
+
+/**
+ * Gets the target node from a native browser event by accounting for
+ * inconsistencies in browser DOM APIs.
+ *
+ * @param {object} nativeEvent Native browser event.
+ * @return {DOMEventTarget} Target node.
+ */
+function getEventTarget(nativeEvent) {
+  var target = nativeEvent.target || nativeEvent.srcElement || window;
+  // Safari may fire events on text nodes (Node.TEXT_NODE is 3).
+  // @see http://www.quirksmode.org/js/events_properties.html
+  return target.nodeType === 3 ? target.parentNode : target;
+}
+
+module.exports = getEventTarget;
+
+},{}],118:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule getMarkupWrap
+ */
+
+var ExecutionEnvironment = _dereq_("./ExecutionEnvironment");
+
+var invariant = _dereq_("./invariant");
+
+/**
+ * Dummy container used to detect which wraps are necessary.
+ */
+var dummyNode =
+  ExecutionEnvironment.canUseDOM ? document.createElement('div') : null;
+
+/**
+ * Some browsers cannot use `innerHTML` to render certain elements standalone,
+ * so we wrap them, render the wrapped nodes, then extract the desired node.
+ *
+ * In IE8, certain elements cannot render alone, so wrap all elements ('*').
+ */
+var shouldWrap = {
+  // Force wrapping for SVG elements because if they get created inside a <div>,
+  // they will be initialized in the wrong namespace (and will not display).
+  'circle': true,
+  'defs': true,
+  'g': true,
+  'line': true,
+  'linearGradient': true,
+  'path': true,
+  'polygon': true,
+  'polyline': true,
+  'radialGradient': true,
+  'rect': true,
+  'stop': true,
+  'text': true
+};
+
+var selectWrap = [1, '<select multiple="true">', '</select>'];
+var tableWrap = [1, '<table>', '</table>'];
+var trWrap = [3, '<table><tbody><tr>', '</tr></tbody></table>'];
+
+var svgWrap = [1, '<svg>', '</svg>'];
+
+var markupWrap = {
+  '*': [1, '?<div>', '</div>'],
+
+  'area': [1, '<map>', '</map>'],
+  'col': [2, '<table><tbody></tbody><colgroup>', '</colgroup></table>'],
+  'legend': [1, '<fieldset>', '</fieldset>'],
+  'param': [1, '<object>', '</object>'],
+  'tr': [2, '<table><tbody>', '</tbody></table>'],
+
+  'optgroup': selectWrap,
+  'option': selectWrap,
+
+  'caption': tableWrap,
+  'colgroup': tableWrap,
+  'tbody': tableWrap,
+  'tfoot': tableWrap,
+  'thead': tableWrap,
+
+  'td': trWrap,
+  'th': trWrap,
+
+  'circle': svgWrap,
+  'defs': svgWrap,
+  'g': svgWrap,
+  'line': svgWrap,
+  'linearGradient': svgWrap,
+  'path': svgWrap,
+  'polygon': svgWrap,
+  'polyline': svgWrap,
+  'radialGradient': svgWrap,
+  'rect': svgWrap,
+  'stop': svgWrap,
+  'text': svgWrap
+};
+
+/**
+ * Gets the markup wrap configuration for the supplied `nodeName`.
+ *
+ * NOTE: This lazily detects which wraps are necessary for the current browser.
+ *
+ * @param {string} nodeName Lowercase `nodeName`.
+ * @return {?array} Markup wrap configuration, if applicable.
+ */
+function getMarkupWrap(nodeName) {
+  ("production" !== "development" ? invariant(!!dummyNode, 'Markup wrapping node not initialized') : invariant(!!dummyNode));
+  if (!markupWrap.hasOwnProperty(nodeName)) {
+    nodeName = '*';
+  }
+  if (!shouldWrap.hasOwnProperty(nodeName)) {
+    if (nodeName === '*') {
+      dummyNode.innerHTML = '<link />';
+    } else {
+      dummyNode.innerHTML = '<' + nodeName + '></' + nodeName + '>';
+    }
+    shouldWrap[nodeName] = !dummyNode.firstChild;
+  }
+  return shouldWrap[nodeName] ? markupWrap[nodeName] : null;
+}
+
+
+module.exports = getMarkupWrap;
+
+},{"./ExecutionEnvironment":21,"./invariant":125}],119:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule getNodeForCharacterOffset
+ */
+
+"use strict";
+
+/**
+ * Given any node return the first leaf node without children.
+ *
+ * @param {DOMElement|DOMTextNode} node
+ * @return {DOMElement|DOMTextNode}
+ */
+function getLeafNode(node) {
+  while (node && node.firstChild) {
+    node = node.firstChild;
+  }
+  return node;
+}
+
+/**
+ * Get the next sibling within a container. This will walk up the
+ * DOM if a node's siblings have been exhausted.
+ *
+ * @param {DOMElement|DOMTextNode} node
+ * @return {?DOMElement|DOMTextNode}
+ */
+function getSiblingNode(node) {
+  while (node) {
+    if (node.nextSibling) {
+      return node.nextSibling;
+    }
+    node = node.parentNode;
+  }
+}
+
+/**
+ * Get object describing the nodes which contain characters at offset.
+ *
+ * @param {DOMElement|DOMTextNode} root
+ * @param {number} offset
+ * @return {?object}
+ */
+function getNodeForCharacterOffset(root, offset) {
+  var node = getLeafNode(root);
+  var nodeStart = 0;
+  var nodeEnd = 0;
+
+  while (node) {
+    if (node.nodeType == 3) {
+      nodeEnd = nodeStart + node.textContent.length;
+
+      if (nodeStart <= offset && nodeEnd >= offset) {
+        return {
+          node: node,
+          offset: offset - nodeStart
+        };
+      }
+
+      nodeStart = nodeEnd;
+    }
+
+    node = getLeafNode(getSiblingNode(node));
+  }
+}
+
+module.exports = getNodeForCharacterOffset;
+
+},{}],120:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule getReactRootElementInContainer
+ */
+
+"use strict";
+
+var DOC_NODE_TYPE = 9;
+
+/**
+ * @param {DOMElement|DOMDocument} container DOM element that may contain
+ *                                           a React component
+ * @return {?*} DOM element that may have the reactRoot ID, or null.
+ */
+function getReactRootElementInContainer(container) {
+  if (!container) {
+    return null;
+  }
+
+  if (container.nodeType === DOC_NODE_TYPE) {
+    return container.documentElement;
+  } else {
+    return container.firstChild;
+  }
+}
+
+module.exports = getReactRootElementInContainer;
+
+},{}],121:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule getTextContentAccessor
+ */
+
+"use strict";
+
+var ExecutionEnvironment = _dereq_("./ExecutionEnvironment");
+
+var contentKey = null;
+
+/**
+ * Gets the key used to access text content on a DOM node.
+ *
+ * @return {?string} Key used to access text content.
+ * @internal
+ */
+function getTextContentAccessor() {
+  if (!contentKey && ExecutionEnvironment.canUseDOM) {
+    // Prefer textContent to innerText because many browsers support both but
+    // SVG <text> elements don't support innerText even when <div> does.
+    contentKey = 'textContent' in document.createElement('div') ?
+      'textContent' :
+      'innerText';
+  }
+  return contentKey;
+}
+
+module.exports = getTextContentAccessor;
+
+},{"./ExecutionEnvironment":21}],122:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule getUnboundedScrollPosition
+ * @typechecks
+ */
+
+"use strict";
+
+/**
+ * Gets the scroll position of the supplied element or window.
+ *
+ * The return values are unbounded, unlike `getScrollPosition`. This means they
+ * may be negative or exceed the element boundaries (which is possible using
+ * inertial scrolling).
+ *
+ * @param {DOMWindow|DOMElement} scrollable
+ * @return {object} Map with `x` and `y` keys.
+ */
+function getUnboundedScrollPosition(scrollable) {
+  if (scrollable === window) {
+    return {
+      x: window.pageXOffset || document.documentElement.scrollLeft,
+      y: window.pageYOffset || document.documentElement.scrollTop
+    };
+  }
+  return {
+    x: scrollable.scrollLeft,
+    y: scrollable.scrollTop
+  };
+}
+
+module.exports = getUnboundedScrollPosition;
+
+},{}],123:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule hyphenate
+ * @typechecks
+ */
+
+var _uppercasePattern = /([A-Z])/g;
+
+/**
+ * Hyphenates a camelcased string, for example:
+ *
+ *   > hyphenate('backgroundColor')
+ *   < "background-color"
+ *
+ * @param {string} string
+ * @return {string}
+ */
+function hyphenate(string) {
+  return string.replace(_uppercasePattern, '-$1').toLowerCase();
+}
+
+module.exports = hyphenate;
+
+},{}],124:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule instantiateReactComponent
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var warning = _dereq_("./warning");
+
+/**
+ * Validate a `componentDescriptor`. This should be exposed publicly in a follow
+ * up diff.
+ *
+ * @param {object} descriptor
+ * @return {boolean} Returns true if this is a valid descriptor of a Component.
+ */
+function isValidComponentDescriptor(descriptor) {
+  return (
+    typeof descriptor.constructor === 'function' &&
+    typeof descriptor.constructor.prototype.construct === 'function' &&
+    typeof descriptor.constructor.prototype.mountComponent === 'function' &&
+    typeof descriptor.constructor.prototype.receiveComponent === 'function'
+  );
+}
+
+/**
+ * Given a `componentDescriptor` create an instance that will actually be
+ * mounted. Currently it just extracts an existing clone from composite
+ * components but this is an implementation detail which will change.
+ *
+ * @param {object} descriptor
+ * @return {object} A new instance of componentDescriptor's constructor.
+ * @protected
+ */
+function instantiateReactComponent(descriptor) {
+  if ("production" !== "development") {
+    ("production" !== "development" ? warning(
+      isValidComponentDescriptor(descriptor),
+      'Only React Components are valid for mounting.'
+    ) : null);
+    // We use the clone of a composite component instead of the original
+    // instance. This allows us to warn you if you're are accessing the wrong
+    // instance.
+    var instance = descriptor.__realComponentInstance || descriptor;
+    instance._descriptor = descriptor;
+    return instance;
+  }
+  // In prod we don't clone, we simply use the same instance for unaffected
+  // behavior. We have to keep the descriptor around for comparison later on.
+  // This should ideally be accepted in the constructor of the instance but
+  // since that is currently overloaded, we just manually attach it here.
+  descriptor._descriptor = descriptor;
+  return descriptor;
+}
+
+module.exports = instantiateReactComponent;
+
+},{"./warning":148}],125:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule invariant
+ */
+
+"use strict";
+
+/**
+ * Use invariant() to assert state which your program assumes to be true.
+ *
+ * Provide sprintf-style format (only %s is supported) and arguments
+ * to provide information about what broke and what you were
+ * expecting.
+ *
+ * The invariant message will be stripped in production, but the invariant
+ * will remain to ensure logic does not differ in production.
+ */
+
+var invariant = function(condition) {
+  if (!condition) {
+    var error = new Error(
+      'Minified exception occured; use the non-minified dev environment for ' +
+      'the full error message and additional helpful warnings.'
+    );
+    error.framesToPop = 1;
+    throw error;
+  }
+};
+
+if ("production" !== "development") {
+  invariant = function(condition, format, a, b, c, d, e, f) {
+    if (format === undefined) {
+      throw new Error('invariant requires an error message argument');
+    }
+
+    if (!condition) {
+      var args = [a, b, c, d, e, f];
+      var argIndex = 0;
+      var error = new Error(
+        'Invariant Violation: ' +
+        format.replace(/%s/g, function() { return args[argIndex++]; })
+      );
+      error.framesToPop = 1; // we don't care about invariant's own frame
+      throw error;
+    }
+  };
+}
+
+module.exports = invariant;
+
+},{}],126:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule isEventSupported
+ */
+
+"use strict";
+
+var ExecutionEnvironment = _dereq_("./ExecutionEnvironment");
+
+var useHasFeature;
+if (ExecutionEnvironment.canUseDOM) {
+  useHasFeature =
+    document.implementation &&
+    document.implementation.hasFeature &&
+    // always returns true in newer browsers as per the standard.
+    // @see http://dom.spec.whatwg.org/#dom-domimplementation-hasfeature
+    document.implementation.hasFeature('', '') !== true;
+}
+
+/**
+ * Checks if an event is supported in the current execution environment.
+ *
+ * NOTE: This will not work correctly for non-generic events such as `change`,
+ * `reset`, `load`, `error`, and `select`.
+ *
+ * Borrows from Modernizr.
+ *
+ * @param {string} eventNameSuffix Event name, e.g. "click".
+ * @param {?boolean} capture Check if the capture phase is supported.
+ * @return {boolean} True if the event is supported.
+ * @internal
+ * @license Modernizr 3.0.0pre (Custom Build) | MIT
+ */
+function isEventSupported(eventNameSuffix, capture) {
+  if (!ExecutionEnvironment.canUseDOM ||
+      capture && !('addEventListener' in document)) {
+    return false;
+  }
+
+  var eventName = 'on' + eventNameSuffix;
+  var isSupported = eventName in document;
+
+  if (!isSupported) {
+    var element = document.createElement('div');
+    element.setAttribute(eventName, 'return;');
+    isSupported = typeof element[eventName] === 'function';
+  }
+
+  if (!isSupported && useHasFeature && eventNameSuffix === 'wheel') {
+    // This is the only way to test support for the `wheel` event in IE9+.
+    isSupported = document.implementation.hasFeature('Events.wheel', '3.0');
+  }
+
+  return isSupported;
+}
+
+module.exports = isEventSupported;
+
+},{"./ExecutionEnvironment":21}],127:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule isNode
+ * @typechecks
+ */
+
+/**
+ * @param {*} object The object to check.
+ * @return {boolean} Whether or not the object is a DOM node.
+ */
+function isNode(object) {
+  return !!(object && (
+    typeof Node === 'function' ? object instanceof Node :
+      typeof object === 'object' &&
+      typeof object.nodeType === 'number' &&
+      typeof object.nodeName === 'string'
+  ));
+}
+
+module.exports = isNode;
+
+},{}],128:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule isTextInputElement
+ */
+
+"use strict";
+
+/**
+ * @see http://www.whatwg.org/specs/web-apps/current-work/multipage/the-input-element.html#input-type-attr-summary
+ */
+var supportedInputTypes = {
+  'color': true,
+  'date': true,
+  'datetime': true,
+  'datetime-local': true,
+  'email': true,
+  'month': true,
+  'number': true,
+  'password': true,
+  'range': true,
+  'search': true,
+  'tel': true,
+  'text': true,
+  'time': true,
+  'url': true,
+  'week': true
+};
+
+function isTextInputElement(elem) {
+  return elem && (
+    (elem.nodeName === 'INPUT' && supportedInputTypes[elem.type]) ||
+    elem.nodeName === 'TEXTAREA'
+  );
+}
+
+module.exports = isTextInputElement;
+
+},{}],129:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule isTextNode
+ * @typechecks
+ */
+
+var isNode = _dereq_("./isNode");
+
+/**
+ * @param {*} object The object to check.
+ * @return {boolean} Whether or not the object is a DOM text node.
+ */
+function isTextNode(object) {
+  return isNode(object) && object.nodeType == 3;
+}
+
+module.exports = isTextNode;
+
+},{"./isNode":127}],130:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule joinClasses
+ * @typechecks static-only
+ */
+
+"use strict";
+
+/**
+ * Combines multiple className strings into one.
+ * http://jsperf.com/joinclasses-args-vs-array
+ *
+ * @param {...?string} classes
+ * @return {string}
+ */
+function joinClasses(className/*, ... */) {
+  if (!className) {
+    className = '';
+  }
+  var nextClass;
+  var argLength = arguments.length;
+  if (argLength > 1) {
+    for (var ii = 1; ii < argLength; ii++) {
+      nextClass = arguments[ii];
+      nextClass && (className += ' ' + nextClass);
+    }
+  }
+  return className;
+}
+
+module.exports = joinClasses;
+
+},{}],131:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule keyMirror
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var invariant = _dereq_("./invariant");
+
+/**
+ * Constructs an enumeration with keys equal to their value.
+ *
+ * For example:
+ *
+ *   var COLORS = keyMirror({blue: null, red: null});
+ *   var myColor = COLORS.blue;
+ *   var isColorValid = !!COLORS[myColor];
+ *
+ * The last line could not be performed if the values of the generated enum were
+ * not equal to their keys.
+ *
+ *   Input:  {key1: val1, key2: val2}
+ *   Output: {key1: key1, key2: key2}
+ *
+ * @param {object} obj
+ * @return {object}
+ */
+var keyMirror = function(obj) {
+  var ret = {};
+  var key;
+  ("production" !== "development" ? invariant(
+    obj instanceof Object && !Array.isArray(obj),
+    'keyMirror(...): Argument must be an object.'
+  ) : invariant(obj instanceof Object && !Array.isArray(obj)));
+  for (key in obj) {
+    if (!obj.hasOwnProperty(key)) {
+      continue;
+    }
+    ret[key] = key;
+  }
+  return ret;
+};
+
+module.exports = keyMirror;
+
+},{"./invariant":125}],132:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule keyOf
+ */
+
+/**
+ * Allows extraction of a minified key. Let's the build system minify keys
+ * without loosing the ability to dynamically use key strings as values
+ * themselves. Pass in an object with a single key/val pair and it will return
+ * you the string key of that single record. Suppose you want to grab the
+ * value for a key 'className' inside of an object. Key/val minification may
+ * have aliased that key to be 'xa12'. keyOf({className: null}) will return
+ * 'xa12' in that case. Resolve keys you want to use once at startup time, then
+ * reuse those resolutions.
+ */
+var keyOf = function(oneKeyObj) {
+  var key;
+  for (key in oneKeyObj) {
+    if (!oneKeyObj.hasOwnProperty(key)) {
+      continue;
+    }
+    return key;
+  }
+  return null;
+};
+
+
+module.exports = keyOf;
+
+},{}],133:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule memoizeStringOnly
+ * @typechecks static-only
+ */
+
+"use strict";
+
+/**
+ * Memoizes the return value of a function that accepts one string argument.
+ *
+ * @param {function} callback
+ * @return {function}
+ */
+function memoizeStringOnly(callback) {
+  var cache = {};
+  return function(string) {
+    if (cache.hasOwnProperty(string)) {
+      return cache[string];
+    } else {
+      return cache[string] = callback.call(this, string);
+    }
+  };
+}
+
+module.exports = memoizeStringOnly;
+
+},{}],134:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule merge
+ */
+
+"use strict";
+
+var mergeInto = _dereq_("./mergeInto");
+
+/**
+ * Shallow merges two structures into a return value, without mutating either.
+ *
+ * @param {?object} one Optional object with properties to merge from.
+ * @param {?object} two Optional object with properties to merge from.
+ * @return {object} The shallow extension of one by two.
+ */
+var merge = function(one, two) {
+  var result = {};
+  mergeInto(result, one);
+  mergeInto(result, two);
+  return result;
+};
+
+module.exports = merge;
+
+},{"./mergeInto":136}],135:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule mergeHelpers
+ *
+ * requiresPolyfills: Array.isArray
+ */
+
+"use strict";
+
+var invariant = _dereq_("./invariant");
+var keyMirror = _dereq_("./keyMirror");
+
+/**
+ * Maximum number of levels to traverse. Will catch circular structures.
+ * @const
+ */
+var MAX_MERGE_DEPTH = 36;
+
+/**
+ * We won't worry about edge cases like new String('x') or new Boolean(true).
+ * Functions are considered terminals, and arrays are not.
+ * @param {*} o The item/object/value to test.
+ * @return {boolean} true iff the argument is a terminal.
+ */
+var isTerminal = function(o) {
+  return typeof o !== 'object' || o === null;
+};
+
+var mergeHelpers = {
+
+  MAX_MERGE_DEPTH: MAX_MERGE_DEPTH,
+
+  isTerminal: isTerminal,
+
+  /**
+   * Converts null/undefined values into empty object.
+   *
+   * @param {?Object=} arg Argument to be normalized (nullable optional)
+   * @return {!Object}
+   */
+  normalizeMergeArg: function(arg) {
+    return arg === undefined || arg === null ? {} : arg;
+  },
+
+  /**
+   * If merging Arrays, a merge strategy *must* be supplied. If not, it is
+   * likely the caller's fault. If this function is ever called with anything
+   * but `one` and `two` being `Array`s, it is the fault of the merge utilities.
+   *
+   * @param {*} one Array to merge into.
+   * @param {*} two Array to merge from.
+   */
+  checkMergeArrayArgs: function(one, two) {
+    ("production" !== "development" ? invariant(
+      Array.isArray(one) && Array.isArray(two),
+      'Tried to merge arrays, instead got %s and %s.',
+      one,
+      two
+    ) : invariant(Array.isArray(one) && Array.isArray(two)));
+  },
+
+  /**
+   * @param {*} one Object to merge into.
+   * @param {*} two Object to merge from.
+   */
+  checkMergeObjectArgs: function(one, two) {
+    mergeHelpers.checkMergeObjectArg(one);
+    mergeHelpers.checkMergeObjectArg(two);
+  },
+
+  /**
+   * @param {*} arg
+   */
+  checkMergeObjectArg: function(arg) {
+    ("production" !== "development" ? invariant(
+      !isTerminal(arg) && !Array.isArray(arg),
+      'Tried to merge an object, instead got %s.',
+      arg
+    ) : invariant(!isTerminal(arg) && !Array.isArray(arg)));
+  },
+
+  /**
+   * Checks that a merge was not given a circular object or an object that had
+   * too great of depth.
+   *
+   * @param {number} Level of recursion to validate against maximum.
+   */
+  checkMergeLevel: function(level) {
+    ("production" !== "development" ? invariant(
+      level < MAX_MERGE_DEPTH,
+      'Maximum deep merge depth exceeded. You may be attempting to merge ' +
+      'circular structures in an unsupported way.'
+    ) : invariant(level < MAX_MERGE_DEPTH));
+  },
+
+  /**
+   * Checks that the supplied merge strategy is valid.
+   *
+   * @param {string} Array merge strategy.
+   */
+  checkArrayStrategy: function(strategy) {
+    ("production" !== "development" ? invariant(
+      strategy === undefined || strategy in mergeHelpers.ArrayStrategies,
+      'You must provide an array strategy to deep merge functions to ' +
+      'instruct the deep merge how to resolve merging two arrays.'
+    ) : invariant(strategy === undefined || strategy in mergeHelpers.ArrayStrategies));
+  },
+
+  /**
+   * Set of possible behaviors of merge algorithms when encountering two Arrays
+   * that must be merged together.
+   * - `clobber`: The left `Array` is ignored.
+   * - `indexByIndex`: The result is achieved by recursively deep merging at
+   *   each index. (not yet supported.)
+   */
+  ArrayStrategies: keyMirror({
+    Clobber: true,
+    IndexByIndex: true
+  })
+
+};
+
+module.exports = mergeHelpers;
+
+},{"./invariant":125,"./keyMirror":131}],136:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule mergeInto
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var mergeHelpers = _dereq_("./mergeHelpers");
+
+var checkMergeObjectArg = mergeHelpers.checkMergeObjectArg;
+
+/**
+ * Shallow merges two structures by mutating the first parameter.
+ *
+ * @param {object} one Object to be merged into.
+ * @param {?object} two Optional object with properties to merge from.
+ */
+function mergeInto(one, two) {
+  checkMergeObjectArg(one);
+  if (two != null) {
+    checkMergeObjectArg(two);
+    for (var key in two) {
+      if (!two.hasOwnProperty(key)) {
+        continue;
+      }
+      one[key] = two[key];
+    }
+  }
+}
+
+module.exports = mergeInto;
+
+},{"./mergeHelpers":135}],137:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule mixInto
+ */
+
+"use strict";
+
+/**
+ * Simply copies properties to the prototype.
+ */
+var mixInto = function(constructor, methodBag) {
+  var methodName;
+  for (methodName in methodBag) {
+    if (!methodBag.hasOwnProperty(methodName)) {
+      continue;
+    }
+    constructor.prototype[methodName] = methodBag[methodName];
+  }
+};
+
+module.exports = mixInto;
+
+},{}],138:[function(_dereq_,module,exports){
+/**
+ * Copyright 2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule monitorCodeUse
+ */
+
+"use strict";
+
+var invariant = _dereq_("./invariant");
+
+/**
+ * Provides open-source compatible instrumentation for monitoring certain API
+ * uses before we're ready to issue a warning or refactor. It accepts an event
+ * name which may only contain the characters [a-z0-9_] and an optional data
+ * object with further information.
+ */
+
+function monitorCodeUse(eventName, data) {
+  ("production" !== "development" ? invariant(
+    eventName && !/[^a-z0-9_]/.test(eventName),
+    'You must provide an eventName using only the characters [a-z0-9_]'
+  ) : invariant(eventName && !/[^a-z0-9_]/.test(eventName)));
+}
+
+module.exports = monitorCodeUse;
+
+},{"./invariant":125}],139:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule objMap
+ */
+
+"use strict";
+
+/**
+ * For each key/value pair, invokes callback func and constructs a resulting
+ * object which contains, for every key in obj, values that are the result of
+ * of invoking the function:
+ *
+ *   func(value, key, iteration)
+ *
+ * @param {?object} obj Object to map keys over
+ * @param {function} func Invoked for each key/val pair.
+ * @param {?*} context
+ * @return {?object} Result of mapping or null if obj is falsey
+ */
+function objMap(obj, func, context) {
+  if (!obj) {
+    return null;
+  }
+  var i = 0;
+  var ret = {};
+  for (var key in obj) {
+    if (obj.hasOwnProperty(key)) {
+      ret[key] = func.call(context, obj[key], key, i++);
+    }
+  }
+  return ret;
+}
+
+module.exports = objMap;
+
+},{}],140:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule objMapKeyVal
+ */
+
+"use strict";
+
+/**
+ * Behaves the same as `objMap` but invokes func with the key first, and value
+ * second. Use `objMap` unless you need this special case.
+ * Invokes func as:
+ *
+ *   func(key, value, iteration)
+ *
+ * @param {?object} obj Object to map keys over
+ * @param {!function} func Invoked for each key/val pair.
+ * @param {?*} context
+ * @return {?object} Result of mapping or null if obj is falsey
+ */
+function objMapKeyVal(obj, func, context) {
+  if (!obj) {
+    return null;
+  }
+  var i = 0;
+  var ret = {};
+  for (var key in obj) {
+    if (obj.hasOwnProperty(key)) {
+      ret[key] = func.call(context, key, obj[key], i++);
+    }
+  }
+  return ret;
+}
+
+module.exports = objMapKeyVal;
+
+},{}],141:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule onlyChild
+ */
+"use strict";
+
+var ReactComponent = _dereq_("./ReactComponent");
+
+var invariant = _dereq_("./invariant");
+
+/**
+ * Returns the first child in a collection of children and verifies that there
+ * is only one child in the collection. The current implementation of this
+ * function assumes that a single child gets passed without a wrapper, but the
+ * purpose of this helper function is to abstract away the particular structure
+ * of children.
+ *
+ * @param {?object} children Child collection structure.
+ * @return {ReactComponent} The first and only `ReactComponent` contained in the
+ * structure.
+ */
+function onlyChild(children) {
+  ("production" !== "development" ? invariant(
+    ReactComponent.isValidComponent(children),
+    'onlyChild must be passed a children with exactly one child.'
+  ) : invariant(ReactComponent.isValidComponent(children)));
+  return children;
+}
+
+module.exports = onlyChild;
+
+},{"./ReactComponent":31,"./invariant":125}],142:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule performanceNow
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var ExecutionEnvironment = _dereq_("./ExecutionEnvironment");
+
+/**
+ * Detect if we can use window.performance.now() and gracefully
+ * fallback to Date.now() if it doesn't exist.
+ * We need to support Firefox < 15 for now due to Facebook's webdriver
+ * infrastructure.
+ */
+var performance = null;
+
+if (ExecutionEnvironment.canUseDOM) {
+  performance = window.performance || window.webkitPerformance;
+}
+
+if (!performance || !performance.now) {
+  performance = Date;
+}
+
+var performanceNow = performance.now.bind(performance);
+
+module.exports = performanceNow;
+
+},{"./ExecutionEnvironment":21}],143:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule shallowEqual
+ */
+
+"use strict";
+
+/**
+ * Performs equality by iterating through keys on an object and returning
+ * false when any key has values which are not strictly equal between
+ * objA and objB. Returns true when the values of all keys are strictly equal.
+ *
+ * @return {boolean}
+ */
+function shallowEqual(objA, objB) {
+  if (objA === objB) {
+    return true;
+  }
+  var key;
+  // Test for A's keys different from B.
+  for (key in objA) {
+    if (objA.hasOwnProperty(key) &&
+        (!objB.hasOwnProperty(key) || objA[key] !== objB[key])) {
+      return false;
+    }
+  }
+  // Test for B'a keys missing from A.
+  for (key in objB) {
+    if (objB.hasOwnProperty(key) && !objA.hasOwnProperty(key)) {
+      return false;
+    }
+  }
+  return true;
+}
+
+module.exports = shallowEqual;
+
+},{}],144:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule shouldUpdateReactComponent
+ * @typechecks static-only
+ */
+
+"use strict";
+
+/**
+ * Given a `prevComponentInstance` and `nextComponent`, determines if
+ * `prevComponentInstance` should be updated as opposed to being destroyed or
+ * replaced by a new instance. The second argument is a descriptor. Future
+ * versions of the reconciler should only compare descriptors to other
+ * descriptors.
+ *
+ * @param {?object} prevComponentInstance
+ * @param {?object} nextDescriptor
+ * @return {boolean} True if `prevComponentInstance` should be updated.
+ * @protected
+ */
+function shouldUpdateReactComponent(prevComponentInstance, nextDescriptor) {
+  // TODO: Remove warning after a release.
+  if (prevComponentInstance && nextDescriptor &&
+      prevComponentInstance.constructor === nextDescriptor.constructor && (
+        (prevComponentInstance.props && prevComponentInstance.props.key) ===
+        (nextDescriptor.props && nextDescriptor.props.key)
+      )) {
+    if (prevComponentInstance._owner === nextDescriptor._owner) {
+      return true;
+    } else {
+      if ("production" !== "development") {
+        if (prevComponentInstance.state) {
+          console.warn(
+            'A recent change to React has been found to impact your code. ' +
+            'A mounted component will now be unmounted and replaced by a ' +
+            'component (of the same class) if their owners are different. ' +
+            'Previously, ownership was not considered when updating.',
+            prevComponentInstance,
+            nextDescriptor
+          );
+        }
+      }
+    }
+  }
+  return false;
+}
+
+module.exports = shouldUpdateReactComponent;
+
+},{}],145:[function(_dereq_,module,exports){
+/**
+ * Copyright 2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule toArray
+ * @typechecks
+ */
+
+var invariant = _dereq_("./invariant");
+
+/**
+ * Convert array-like objects to arrays.
+ *
+ * This API assumes the caller knows the contents of the data type. For less
+ * well defined inputs use createArrayFrom.
+ *
+ * @param {object|function} obj
+ * @return {array}
+ */
+function toArray(obj) {
+  var length = obj.length;
+
+  // Some browse builtin objects can report typeof 'function' (e.g. NodeList in
+  // old versions of Safari).
+  ("production" !== "development" ? invariant(
+    !Array.isArray(obj) &&
+    (typeof obj === 'object' || typeof obj === 'function'),
+    'toArray: Array-like object expected'
+  ) : invariant(!Array.isArray(obj) &&
+  (typeof obj === 'object' || typeof obj === 'function')));
+
+  ("production" !== "development" ? invariant(
+    typeof length === 'number',
+    'toArray: Object needs a length property'
+  ) : invariant(typeof length === 'number'));
+
+  ("production" !== "development" ? invariant(
+    length === 0 ||
+    (length - 1) in obj,
+    'toArray: Object should have keys for indices'
+  ) : invariant(length === 0 ||
+  (length - 1) in obj));
+
+  // Old IE doesn't give collections access to hasOwnProperty. Assume inputs
+  // without method will throw during the slice call and skip straight to the
+  // fallback.
+  if (obj.hasOwnProperty) {
+    try {
+      return Array.prototype.slice.call(obj);
+    } catch (e) {
+      // IE < 9 does not support Array#slice on collections objects
+    }
+  }
+
+  // Fall back to copying key by key. This assumes all keys have a value,
+  // so will not preserve sparsely populated inputs.
+  var ret = Array(length);
+  for (var ii = 0; ii < length; ii++) {
+    ret[ii] = obj[ii];
+  }
+  return ret;
+}
+
+module.exports = toArray;
+
+},{"./invariant":125}],146:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule traverseAllChildren
+ */
+
+"use strict";
+
+var ReactInstanceHandles = _dereq_("./ReactInstanceHandles");
+var ReactTextComponent = _dereq_("./ReactTextComponent");
+
+var invariant = _dereq_("./invariant");
+
+var SEPARATOR = ReactInstanceHandles.SEPARATOR;
+var SUBSEPARATOR = ':';
+
+/**
+ * TODO: Test that:
+ * 1. `mapChildren` transforms strings and numbers into `ReactTextComponent`.
+ * 2. it('should fail when supplied duplicate key', function() {
+ * 3. That a single child and an array with one item have the same key pattern.
+ * });
+ */
+
+var userProvidedKeyEscaperLookup = {
+  '=': '=0',
+  '.': '=1',
+  ':': '=2'
+};
+
+var userProvidedKeyEscapeRegex = /[=.:]/g;
+
+function userProvidedKeyEscaper(match) {
+  return userProvidedKeyEscaperLookup[match];
+}
+
+/**
+ * Generate a key string that identifies a component within a set.
+ *
+ * @param {*} component A component that could contain a manual key.
+ * @param {number} index Index that is used if a manual key is not provided.
+ * @return {string}
+ */
+function getComponentKey(component, index) {
+  if (component && component.props && component.props.key != null) {
+    // Explicit key
+    return wrapUserProvidedKey(component.props.key);
+  }
+  // Implicit key determined by the index in the set
+  return index.toString(36);
+}
+
+/**
+ * Escape a component key so that it is safe to use in a reactid.
+ *
+ * @param {*} key Component key to be escaped.
+ * @return {string} An escaped string.
+ */
+function escapeUserProvidedKey(text) {
+  return ('' + text).replace(
+    userProvidedKeyEscapeRegex,
+    userProvidedKeyEscaper
+  );
+}
+
+/**
+ * Wrap a `key` value explicitly provided by the user to distinguish it from
+ * implicitly-generated keys generated by a component's index in its parent.
+ *
+ * @param {string} key Value of a user-provided `key` attribute
+ * @return {string}
+ */
+function wrapUserProvidedKey(key) {
+  return '$' + escapeUserProvidedKey(key);
+}
+
+/**
+ * @param {?*} children Children tree container.
+ * @param {!string} nameSoFar Name of the key path so far.
+ * @param {!number} indexSoFar Number of children encountered until this point.
+ * @param {!function} callback Callback to invoke with each child found.
+ * @param {?*} traverseContext Used to pass information throughout the traversal
+ * process.
+ * @return {!number} The number of children in this subtree.
+ */
+var traverseAllChildrenImpl =
+  function(children, nameSoFar, indexSoFar, callback, traverseContext) {
+    var subtreeCount = 0;  // Count of children found in the current subtree.
+    if (Array.isArray(children)) {
+      for (var i = 0; i < children.length; i++) {
+        var child = children[i];
+        var nextName = (
+          nameSoFar +
+          (nameSoFar ? SUBSEPARATOR : SEPARATOR) +
+          getComponentKey(child, i)
+        );
+        var nextIndex = indexSoFar + subtreeCount;
+        subtreeCount += traverseAllChildrenImpl(
+          child,
+          nextName,
+          nextIndex,
+          callback,
+          traverseContext
+        );
+      }
+    } else {
+      var type = typeof children;
+      var isOnlyChild = nameSoFar === '';
+      // If it's the only child, treat the name as if it was wrapped in an array
+      // so that it's consistent if the number of children grows
+      var storageName =
+        isOnlyChild ? SEPARATOR + getComponentKey(children, 0) : nameSoFar;
+      if (children == null || type === 'boolean') {
+        // All of the above are perceived as null.
+        callback(traverseContext, null, storageName, indexSoFar);
+        subtreeCount = 1;
+      } else if (children.type && children.type.prototype &&
+                 children.type.prototype.mountComponentIntoNode) {
+        callback(traverseContext, children, storageName, indexSoFar);
+        subtreeCount = 1;
+      } else {
+        if (type === 'object') {
+          ("production" !== "development" ? invariant(
+            !children || children.nodeType !== 1,
+            'traverseAllChildren(...): Encountered an invalid child; DOM ' +
+            'elements are not valid children of React components.'
+          ) : invariant(!children || children.nodeType !== 1));
+          for (var key in children) {
+            if (children.hasOwnProperty(key)) {
+              subtreeCount += traverseAllChildrenImpl(
+                children[key],
+                (
+                  nameSoFar + (nameSoFar ? SUBSEPARATOR : SEPARATOR) +
+                  wrapUserProvidedKey(key) + SUBSEPARATOR +
+                  getComponentKey(children[key], 0)
+                ),
+                indexSoFar + subtreeCount,
+                callback,
+                traverseContext
+              );
+            }
+          }
+        } else if (type === 'string') {
+          var normalizedText = new ReactTextComponent(children);
+          callback(traverseContext, normalizedText, storageName, indexSoFar);
+          subtreeCount += 1;
+        } else if (type === 'number') {
+          var normalizedNumber = new ReactTextComponent('' + children);
+          callback(traverseContext, normalizedNumber, storageName, indexSoFar);
+          subtreeCount += 1;
+        }
+      }
+    }
+    return subtreeCount;
+  };
+
+/**
+ * Traverses children that are typically specified as `props.children`, but
+ * might also be specified through attributes:
+ *
+ * - `traverseAllChildren(this.props.children, ...)`
+ * - `traverseAllChildren(this.props.leftPanelChildren, ...)`
+ *
+ * The `traverseContext` is an optional argument that is passed through the
+ * entire traversal. It can be used to store accumulations or anything else that
+ * the callback might find relevant.
+ *
+ * @param {?*} children Children tree object.
+ * @param {!function} callback To invoke upon traversing each child.
+ * @param {?*} traverseContext Context for traversal.
+ */
+function traverseAllChildren(children, callback, traverseContext) {
+  if (children !== null && children !== undefined) {
+    traverseAllChildrenImpl(children, '', 0, callback, traverseContext);
+  }
+}
+
+module.exports = traverseAllChildren;
+
+},{"./ReactInstanceHandles":57,"./ReactTextComponent":77,"./invariant":125}],147:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule update
+ */
+
+"use strict";
+
+var copyProperties = _dereq_("./copyProperties");
+var keyOf = _dereq_("./keyOf");
+var invariant = _dereq_("./invariant");
+
+function shallowCopy(x) {
+  if (Array.isArray(x)) {
+    return x.concat();
+  } else if (x && typeof x === 'object') {
+    return copyProperties(new x.constructor(), x);
+  } else {
+    return x;
+  }
+}
+
+var DIRECTIVE_PUSH = keyOf({$push: null});
+var DIRECTIVE_UNSHIFT = keyOf({$unshift: null});
+var DIRECTIVE_SPLICE = keyOf({$splice: null});
+var DIRECTIVE_SET = keyOf({$set: null});
+var DIRECTIVE_MERGE = keyOf({$merge: null});
+
+var ALL_DIRECTIVES_LIST = [
+  DIRECTIVE_PUSH,
+  DIRECTIVE_UNSHIFT,
+  DIRECTIVE_SPLICE,
+  DIRECTIVE_SET,
+  DIRECTIVE_MERGE
+];
+
+var ALL_DIRECTIVES_SET = {};
+
+ALL_DIRECTIVES_LIST.forEach(function(directive) {
+  ALL_DIRECTIVES_SET[directive] = true;
+});
+
+function invariantArrayCase(value, spec, directive) {
+  ("production" !== "development" ? invariant(
+    Array.isArray(value),
+    'update(): expected target of %s to be an array; got %s.',
+    directive,
+    value
+  ) : invariant(Array.isArray(value)));
+  var specValue = spec[directive];
+  ("production" !== "development" ? invariant(
+    Array.isArray(specValue),
+    'update(): expected spec of %s to be an array; got %s. ' +
+    'Did you forget to wrap your parameter in an array?',
+    directive,
+    specValue
+  ) : invariant(Array.isArray(specValue)));
+}
+
+function update(value, spec) {
+  ("production" !== "development" ? invariant(
+    typeof spec === 'object',
+    'update(): You provided a key path to update() that did not contain one ' +
+    'of %s. Did you forget to include {%s: ...}?',
+    ALL_DIRECTIVES_LIST.join(', '),
+    DIRECTIVE_SET
+  ) : invariant(typeof spec === 'object'));
+
+  if (spec.hasOwnProperty(DIRECTIVE_SET)) {
+    ("production" !== "development" ? invariant(
+      Object.keys(spec).length === 1,
+      'Cannot have more than one key in an object with %s',
+      DIRECTIVE_SET
+    ) : invariant(Object.keys(spec).length === 1));
+
+    return spec[DIRECTIVE_SET];
+  }
+
+  var nextValue = shallowCopy(value);
+
+  if (spec.hasOwnProperty(DIRECTIVE_MERGE)) {
+    var mergeObj = spec[DIRECTIVE_MERGE];
+    ("production" !== "development" ? invariant(
+      mergeObj && typeof mergeObj === 'object',
+      'update(): %s expects a spec of type \'object\'; got %s',
+      DIRECTIVE_MERGE,
+      mergeObj
+    ) : invariant(mergeObj && typeof mergeObj === 'object'));
+    ("production" !== "development" ? invariant(
+      nextValue && typeof nextValue === 'object',
+      'update(): %s expects a target of type \'object\'; got %s',
+      DIRECTIVE_MERGE,
+      nextValue
+    ) : invariant(nextValue && typeof nextValue === 'object'));
+    copyProperties(nextValue, spec[DIRECTIVE_MERGE]);
+  }
+
+  if (spec.hasOwnProperty(DIRECTIVE_PUSH)) {
+    invariantArrayCase(value, spec, DIRECTIVE_PUSH);
+    spec[DIRECTIVE_PUSH].forEach(function(item) {
+      nextValue.push(item);
+    });
+  }
+
+  if (spec.hasOwnProperty(DIRECTIVE_UNSHIFT)) {
+    invariantArrayCase(value, spec, DIRECTIVE_UNSHIFT);
+    spec[DIRECTIVE_UNSHIFT].forEach(function(item) {
+      nextValue.unshift(item);
+    });
+  }
+
+  if (spec.hasOwnProperty(DIRECTIVE_SPLICE)) {
+    ("production" !== "development" ? invariant(
+      Array.isArray(value),
+      'Expected %s target to be an array; got %s',
+      DIRECTIVE_SPLICE,
+      value
+    ) : invariant(Array.isArray(value)));
+    ("production" !== "development" ? invariant(
+      Array.isArray(spec[DIRECTIVE_SPLICE]),
+      'update(): expected spec of %s to be an array of arrays; got %s. ' +
+      'Did you forget to wrap your parameters in an array?',
+      DIRECTIVE_SPLICE,
+      spec[DIRECTIVE_SPLICE]
+    ) : invariant(Array.isArray(spec[DIRECTIVE_SPLICE])));
+    spec[DIRECTIVE_SPLICE].forEach(function(args) {
+      ("production" !== "development" ? invariant(
+        Array.isArray(args),
+        'update(): expected spec of %s to be an array of arrays; got %s. ' +
+        'Did you forget to wrap your parameters in an array?',
+        DIRECTIVE_SPLICE,
+        spec[DIRECTIVE_SPLICE]
+      ) : invariant(Array.isArray(args)));
+      nextValue.splice.apply(nextValue, args);
+    });
+  }
+
+  for (var k in spec) {
+    if (!ALL_DIRECTIVES_SET[k]) {
+      nextValue[k] = update(value[k], spec[k]);
+    }
+  }
+
+  return nextValue;
+}
+
+module.exports = update;
+
+},{"./copyProperties":102,"./invariant":125,"./keyOf":132}],148:[function(_dereq_,module,exports){
+/**
+ * Copyright 2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule warning
+ */
+
+"use strict";
+
+var emptyFunction = _dereq_("./emptyFunction");
+
+/**
+ * Similar to invariant but only logs a warning if the condition is not met.
+ * This can be used to log issues in development environments in critical
+ * paths. Removing the logging code for production environments will keep the
+ * same logic and follow the same code paths.
+ */
+
+var warning = emptyFunction;
+
+if ("production" !== "development") {
+  warning = function(condition, format ) {var args=Array.prototype.slice.call(arguments,2);
+    if (format === undefined) {
+      throw new Error(
+        '`warning(condition, format, ...args)` requires a warning ' +
+        'message argument'
+      );
+    }
+
+    if (!condition) {
+      var argIndex = 0;
+      console.warn('Warning: ' + format.replace(/%s/g, function()  {return args[argIndex++];}));
+    }
+  };
+}
+
+module.exports = warning;
+
+},{"./emptyFunction":109}]},{},[82])
+(82)
+});
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/js/react/react-with-addons.min.js elefant-elefant_1_3_10_beta/apps/user/js/react/react-with-addons.min.js
--- elefant-elefant_1_3_9_beta/apps/user/js/react/react-with-addons.min.js	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/js/react/react-with-addons.min.js	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,21 @@
+/**
+ * React (with addons) v0.10.0
+ *
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+!function(t){if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.React=t()}}(function(){return function t(e,n,o){function r(a,s){if(!n[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);throw new Error("Cannot find module '"+a+"'")}var c=n[a]={exports:{}};e[a][0].call(c.exports,function(t){var n=e[a][1][t];return r(n?n:t)},c,c.exports,t,e,n,o)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}({1:[function(t,e){"use strict";var n=t("./focusNode"),o={componentDidMount:function(){this.props.autoFocus&&n(this.getDOMNode())}};e.exports=o},{"./focusNode":110}],2:[function(t,e){var n=t("./invariant"),o={addClass:function(t,e){return n(!/\s/.test(e)),e&&(t.classList?t.classList.add(e):o.hasClass(t,e)||(t.className=t.className+" "+e)),t},removeClass:function(t,e){return n(!/\s/.test(e)),e&&(t.classList?t.classList.remove(e):o.hasClass(t,e)&&(t.className=t.className.replace(new RegExp("(^|\\s)"+e+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,""))),t},conditionClass:function(t,e,n){return(n?o.addClass:o.removeClass)(t,e)},hasClass:function(t,e){return n(!/\s/.test(e)),t.classList?!!e&&t.classList.contains(e):(" "+t.className+" ").indexOf(" "+e+" ")>-1}};e.exports=o},{"./invariant":122}],3:[function(t,e){"use strict";function n(t,e){return t+e.charAt(0).toUpperCase()+e.substring(1)}var o={columnCount:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},r=["Webkit","ms","Moz","O"];Object.keys(o).forEach(function(t){r.forEach(function(e){o[n(e,t)]=o[t]})});var i={background:{backgroundImage:!0,backgroundPosition:!0,backgroundRepeat:!0,backgroundColor:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0}},a={isUnitlessNumber:o,shorthandPropertyExpansions:i};e.exports=a},{}],4:[function(t,e){"use strict";var n=t("./CSSProperty"),o=t("./dangerousStyleValue"),r=t("./escapeTextForBrowser"),i=t("./hyphenate"),a=t("./memoizeStringOnly"),s=a(function(t){return r(i(t))}),u={createMarkupForStyles:function(t){var e="";for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];null!=r&&(e+=s(n)+":",e+=o(n,r)+";")}return e||null},setValueForStyles:function(t,e){var r=t.style;for(var i in e)if(e.hasOwnProperty(i)){var a=o(i,e[i]);if(a)r[i]=a;else{var s=n.shorthandPropertyExpansions[i];if(s)for(var u in s)r[u]="";else r[i]=""}}}};e.exports=u},{"./CSSProperty":3,"./dangerousStyleValue":105,"./escapeTextForBrowser":108,"./hyphenate":120,"./memoizeStringOnly":130}],5:[function(t,e){"use strict";function n(t){return"SELECT"===t.nodeName||"INPUT"===t.nodeName&&"file"===t.type}function o(t){var e=M.getPooled(b.change,S,t);C.accumulateTwoPhaseDispatches(e),R.batchedUpdates(r,e)}function r(t){y.enqueueEvents(t),y.processEventQueue()}function i(t,e){O=t,S=e,O.attachEvent("onchange",o)}function a(){O&&(O.detachEvent("onchange",o),O=null,S=null)}function s(t,e,n){return t===T.topChange?n:void 0}function u(t,e,n){t===T.topFocus?(a(),i(e,n)):t===T.topBlur&&a()}function c(t,e){O=t,S=e,N=t.value,I=Object.getOwnPropertyDescriptor(t.constructor.prototype,"value"),Object.defineProperty(O,"value",A),O.attachEvent("onpropertychange",p)}function l(){O&&(delete O.value,O.detachEvent("onpropertychange",p),O=null,S=null,N=null,I=null)}function p(t){if("value"===t.propertyName){var e=t.srcElement.value;e!==N&&(N=e,o(t))}}function d(t,e,n){return t===T.topInput?n:void 0}function h(t,e,n){t===T.topFocus?(l(),c(e,n)):t===T.topBlur&&l()}function f(t){return t!==T.topSelectionChange&&t!==T.topKeyUp&&t!==T.topKeyDown||!O||O.value===N?void 0:(N=O.value,S)}function m(t){return"INPUT"===t.nodeName&&("checkbox"===t.type||"radio"===t.type)}function v(t,e,n){return t===T.topClick?n:void 0}var g=t("./EventConstants"),y=t("./EventPluginHub"),C=t("./EventPropagators"),E=t("./ExecutionEnvironment"),R=t("./ReactUpdates"),M=t("./SyntheticEvent"),D=t("./isEventSupported"),x=t("./isTextInputElement"),P=t("./keyOf"),T=g.topLevelTypes,b={change:{phasedRegistrationNames:{bubbled:P({onChange:null}),captured:P({onChangeCapture:null})},dependencies:[T.topBlur,T.topChange,T.topClick,T.topFocus,T.topInput,T.topKeyDown,T.topKeyUp,T.topSelectionChange]}},O=null,S=null,N=null,I=null,_=!1;E.canUseDOM&&(_=D("change")&&(!("documentMode"in document)||document.documentMode>8));var w=!1;E.canUseDOM&&(w=D("input")&&(!("documentMode"in document)||document.documentMode>9));var A={get:function(){return I.get.call(this)},set:function(t){N=""+t,I.set.call(this,t)}},k={eventTypes:b,extractEvents:function(t,e,o,r){var i,a;if(n(e)?_?i=s:a=u:x(e)?w?i=d:(i=f,a=h):m(e)&&(i=v),i){var c=i(t,e,o);if(c){var l=M.getPooled(b.change,c,r);return C.accumulateTwoPhaseDispatches(l),l}}a&&a(t,e,o)}};e.exports=k},{"./EventConstants":15,"./EventPluginHub":17,"./EventPropagators":20,"./ExecutionEnvironment":21,"./ReactUpdates":78,"./SyntheticEvent":86,"./isEventSupported":123,"./isTextInputElement":125,"./keyOf":129}],6:[function(t,e){"use strict";var n=0,o={createReactRootIndex:function(){return n++}};e.exports=o},{}],7:[function(t,e){"use strict";function n(t){switch(t){case g.topCompositionStart:return C.compositionStart;case g.topCompositionEnd:return C.compositionEnd;case g.topCompositionUpdate:return C.compositionUpdate}}function o(t,e){return t===g.topKeyDown&&e.keyCode===f}function r(t,e){switch(t){case g.topKeyUp:return-1!==h.indexOf(e.keyCode);case g.topKeyDown:return e.keyCode!==f;case g.topKeyPress:case g.topMouseDown:case g.topBlur:return!0;default:return!1}}function i(t){this.root=t,this.startSelection=c.getSelection(t),this.startValue=this.getText()}var a=t("./EventConstants"),s=t("./EventPropagators"),u=t("./ExecutionEnvironment"),c=t("./ReactInputSelection"),l=t("./SyntheticCompositionEvent"),p=t("./getTextContentAccessor"),d=t("./keyOf"),h=[9,13,27,32],f=229,m=u.canUseDOM&&"CompositionEvent"in window,v=!m||"documentMode"in document&&document.documentMode>8,g=a.topLevelTypes,y=null,C={compositionEnd:{phasedRegistrationNames:{bubbled:d({onCompositionEnd:null}),captured:d({onCompositionEndCapture:null})},dependencies:[g.topBlur,g.topCompositionEnd,g.topKeyDown,g.topKeyPress,g.topKeyUp,g.topMouseDown]},compositionStart:{phasedRegistrationNames:{bubbled:d({onCompositionStart:null}),captured:d({onCompositionStartCapture:null})},dependencies:[g.topBlur,g.topCompositionStart,g.topKeyDown,g.topKeyPress,g.topKeyUp,g.topMouseDown]},compositionUpdate:{phasedRegistrationNames:{bubbled:d({onCompositionUpdate:null}),captured:d({onCompositionUpdateCapture:null})},dependencies:[g.topBlur,g.topCompositionUpdate,g.topKeyDown,g.topKeyPress,g.topKeyUp,g.topMouseDown]}};i.prototype.getText=function(){return this.root.value||this.root[p()]},i.prototype.getData=function(){var t=this.getText(),e=this.startSelection.start,n=this.startValue.length-this.startSelection.end;return t.substr(e,t.length-n-e)};var E={eventTypes:C,extractEvents:function(t,e,a,u){var c,p;if(m?c=n(t):y?r(t,u)&&(c=C.compositionEnd):o(t,u)&&(c=C.compositionStart),v&&(y||c!==C.compositionStart?c===C.compositionEnd&&y&&(p=y.getData(),y=null):y=new i(e)),c){var d=l.getPooled(c,a,u);return p&&(d.data=p),s.accumulateTwoPhaseDispatches(d),d}}};e.exports=E},{"./EventConstants":15,"./EventPropagators":20,"./ExecutionEnvironment":21,"./ReactInputSelection":54,"./SyntheticCompositionEvent":84,"./getTextContentAccessor":118,"./keyOf":129}],8:[function(t,e){"use strict";function n(t,e,n){var o=t.childNodes;o[n]!==e&&(e.parentNode===t&&t.removeChild(e),n>=o.length?t.appendChild(e):t.insertBefore(e,o[n]))}var o,r=t("./Danger"),i=t("./ReactMultiChildUpdateTypes"),a=t("./getTextContentAccessor"),s=a();o="textContent"===s?function(t,e){t.textContent=e}:function(t,e){for(;t.firstChild;)t.removeChild(t.firstChild);if(e){var n=t.ownerDocument||document;t.appendChild(n.createTextNode(e))}};var u={dangerouslyReplaceNodeWithMarkup:r.dangerouslyReplaceNodeWithMarkup,updateTextContent:o,processUpdates:function(t,e){for(var a,s=null,u=null,c=0;a=t[c];c++)if(a.type===i.MOVE_EXISTING||a.type===i.REMOVE_NODE){var l=a.fromIndex,p=a.parentNode.childNodes[l],d=a.parentID;s=s||{},s[d]=s[d]||[],s[d][l]=p,u=u||[],u.push(p)}var h=r.dangerouslyRenderMarkup(e);if(u)for(var f=0;f<u.length;f++)u[f].parentNode.removeChild(u[f]);for(var m=0;a=t[m];m++)switch(a.type){case i.INSERT_MARKUP:n(a.parentNode,h[a.markupIndex],a.toIndex);break;case i.MOVE_EXISTING:n(a.parentNode,s[a.parentID][a.fromIndex],a.toIndex);break;case i.TEXT_CONTENT:o(a.parentNode,a.textContent);break;case i.REMOVE_NODE:}}};e.exports=u},{"./Danger":11,"./ReactMultiChildUpdateTypes":61,"./getTextContentAccessor":118}],9:[function(t,e){"use strict";var n=t("./invariant"),o={MUST_USE_ATTRIBUTE:1,MUST_USE_PROPERTY:2,HAS_SIDE_EFFECTS:4,HAS_BOOLEAN_VALUE:8,HAS_POSITIVE_NUMERIC_VALUE:16,injectDOMPropertyConfig:function(t){var e=t.Properties||{},r=t.DOMAttributeNames||{},a=t.DOMPropertyNames||{},s=t.DOMMutationMethods||{};t.isCustomAttribute&&i._isCustomAttributeFunctions.push(t.isCustomAttribute);for(var u in e){n(!i.isStandardName[u]),i.isStandardName[u]=!0;var c=u.toLowerCase();i.getPossibleStandardName[c]=u;var l=r[u];l&&(i.getPossibleStandardName[l]=u),i.getAttributeName[u]=l||c,i.getPropertyName[u]=a[u]||u;var p=s[u];p&&(i.getMutationMethod[u]=p);var d=e[u];i.mustUseAttribute[u]=d&o.MUST_USE_ATTRIBUTE,i.mustUseProperty[u]=d&o.MUST_USE_PROPERTY,i.hasSideEffects[u]=d&o.HAS_SIDE_EFFECTS,i.hasBooleanValue[u]=d&o.HAS_BOOLEAN_VALUE,i.hasPositiveNumericValue[u]=d&o.HAS_POSITIVE_NUMERIC_VALUE,n(!i.mustUseAttribute[u]||!i.mustUseProperty[u]),n(i.mustUseProperty[u]||!i.hasSideEffects[u]),n(!i.hasBooleanValue[u]||!i.hasPositiveNumericValue[u])}}},r={},i={ID_ATTRIBUTE_NAME:"data-reactid",isStandardName:{},getPossibleStandardName:{},getAttributeName:{},getPropertyName:{},getMutationMethod:{},mustUseAttribute:{},mustUseProperty:{},hasSideEffects:{},hasBooleanValue:{},hasPositiveNumericValue:{},_isCustomAttributeFunctions:[],isCustomAttribute:function(t){for(var e=0;e<i._isCustomAttributeFunctions.length;e++){var n=i._isCustomAttributeFunctions[e];if(n(t))return!0}return!1},getDefaultValueForProperty:function(t,e){var n,o=r[t];return o||(r[t]=o={}),e in o||(n=document.createElement(t),o[e]=n[e]),o[e]},injection:o};e.exports=i},{"./invariant":122}],10:[function(t,e){"use strict";function n(t,e){return null==e||o.hasBooleanValue[t]&&!e||o.hasPositiveNumericValue[t]&&(isNaN(e)||1>e)}var o=t("./DOMProperty"),r=t("./escapeTextForBrowser"),i=t("./memoizeStringOnly"),a=(t("./warning"),i(function(t){return r(t)+'="'})),s={createMarkupForID:function(t){return a(o.ID_ATTRIBUTE_NAME)+r(t)+'"'},createMarkupForProperty:function(t,e){if(o.isStandardName[t]){if(n(t,e))return"";var i=o.getAttributeName[t];return o.hasBooleanValue[t]?r(i):a(i)+r(e)+'"'}return o.isCustomAttribute(t)?null==e?"":a(t)+r(e)+'"':null},setValueForProperty:function(t,e,r){if(o.isStandardName[e]){var i=o.getMutationMethod[e];if(i)i(t,r);else if(n(e,r))this.deleteValueForProperty(t,e);else if(o.mustUseAttribute[e])t.setAttribute(o.getAttributeName[e],""+r);else{var a=o.getPropertyName[e];o.hasSideEffects[e]&&t[a]===r||(t[a]=r)}}else o.isCustomAttribute(e)&&(null==r?t.removeAttribute(o.getAttributeName[e]):t.setAttribute(e,""+r))},deleteValueForProperty:function(t,e){if(o.isStandardName[e]){var n=o.getMutationMethod[e];if(n)n(t,void 0);else if(o.mustUseAttribute[e])t.removeAttribute(o.getAttributeName[e]);else{var r=o.getPropertyName[e],i=o.getDefaultValueForProperty(t.nodeName,r);o.hasSideEffects[e]&&t[r]===i||(t[r]=i)}}else o.isCustomAttribute(e)&&t.removeAttribute(e)}};e.exports=s},{"./DOMProperty":9,"./escapeTextForBrowser":108,"./memoizeStringOnly":130,"./warning":144}],11:[function(t,e){"use strict";function n(t){return t.substring(1,t.indexOf(" "))}var o=t("./ExecutionEnvironment"),r=t("./createNodesFromMarkup"),i=t("./emptyFunction"),a=t("./getMarkupWrap"),s=t("./invariant"),u=/^(<[^ \/>]+)/,c="data-danger-index",l={dangerouslyRenderMarkup:function(t){s(o.canUseDOM);for(var e,l={},p=0;p<t.length;p++)s(t[p]),e=n(t[p]),e=a(e)?e:"*",l[e]=l[e]||[],l[e][p]=t[p];var d=[],h=0;for(e in l)if(l.hasOwnProperty(e)){var f=l[e];for(var m in f)if(f.hasOwnProperty(m)){var v=f[m];f[m]=v.replace(u,"$1 "+c+'="'+m+'" ')}var g=r(f.join(""),i);for(p=0;p<g.length;++p){var y=g[p];y.hasAttribute&&y.hasAttribute(c)&&(m=+y.getAttribute(c),y.removeAttribute(c),s(!d.hasOwnProperty(m)),d[m]=y,h+=1)}}return s(h===d.length),s(d.length===t.length),d},dangerouslyReplaceNodeWithMarkup:function(t,e){s(o.canUseDOM),s(e),s("html"!==t.tagName.toLowerCase());var n=r(e,i)[0];t.parentNode.replaceChild(n,t)}};e.exports=l},{"./ExecutionEnvironment":21,"./createNodesFromMarkup":102,"./emptyFunction":106,"./getMarkupWrap":115,"./invariant":122}],12:[function(t,e){"use strict";var n=t("./DOMProperty"),o=n.injection.MUST_USE_ATTRIBUTE,r=n.injection.MUST_USE_PROPERTY,i=n.injection.HAS_BOOLEAN_VALUE,a=n.injection.HAS_SIDE_EFFECTS,s=n.injection.HAS_POSITIVE_NUMERIC_VALUE,u={isCustomAttribute:RegExp.prototype.test.bind(/^(data|aria)-[a-z_][a-z\d_.\-]*$/),Properties:{accept:null,accessKey:null,action:null,allowFullScreen:o|i,allowTransparency:o,alt:null,async:i,autoComplete:null,autoPlay:i,cellPadding:null,cellSpacing:null,charSet:o,checked:r|i,className:r,cols:o|s,colSpan:null,content:null,contentEditable:null,contextMenu:o,controls:r|i,crossOrigin:null,data:null,dateTime:o,defer:i,dir:null,disabled:o|i,download:null,draggable:null,encType:null,form:o,formNoValidate:i,frameBorder:o,height:o,hidden:o|i,href:null,hrefLang:null,htmlFor:null,httpEquiv:null,icon:null,id:r,label:null,lang:null,list:null,loop:r|i,max:null,maxLength:o,mediaGroup:null,method:null,min:null,multiple:r|i,muted:r|i,name:null,noValidate:i,pattern:null,placeholder:null,poster:null,preload:null,radioGroup:null,readOnly:r|i,rel:null,required:i,role:o,rows:o|s,rowSpan:null,sandbox:null,scope:null,scrollLeft:r,scrollTop:r,seamless:o|i,selected:r|i,size:o|s,span:s,spellCheck:null,src:null,srcDoc:r,srcSet:null,step:null,style:null,tabIndex:null,target:null,title:null,type:null,value:r|a,width:o,wmode:o,autoCapitalize:null,autoCorrect:null,property:null,cx:o,cy:o,d:o,fill:o,fx:o,fy:o,gradientTransform:o,gradientUnits:o,offset:o,points:o,r:o,rx:o,ry:o,spreadMethod:o,stopColor:o,stopOpacity:o,stroke:o,strokeLinecap:o,strokeWidth:o,textAnchor:o,transform:o,version:o,viewBox:o,x1:o,x2:o,x:o,y1:o,y2:o,y:o},DOMAttributeNames:{className:"class",gradientTransform:"gradientTransform",gradientUnits:"gradientUnits",htmlFor:"for",spreadMethod:"spreadMethod",stopColor:"stop-color",stopOpacity:"stop-opacity",strokeLinecap:"stroke-linecap",strokeWidth:"stroke-width",textAnchor:"text-anchor",viewBox:"viewBox"},DOMPropertyNames:{autoCapitalize:"autocapitalize",autoComplete:"autocomplete",autoCorrect:"autocorrect",autoFocus:"autofocus",autoPlay:"autoplay",encType:"enctype",hrefLang:"hreflang",radioGroup:"radiogroup",spellCheck:"spellcheck",srcDoc:"srcdoc",srcSet:"srcset"}};e.exports=u},{"./DOMProperty":9}],13:[function(t,e){"use strict";var n=t("./keyOf"),o=[n({ResponderEventPlugin:null}),n({SimpleEventPlugin:null}),n({TapEventPlugin:null}),n({EnterLeaveEventPlugin:null}),n({ChangeEventPlugin:null}),n({SelectEventPlugin:null}),n({CompositionEventPlugin:null}),n({AnalyticsEventPlugin:null}),n({MobileSafariClickEventPlugin:null})];e.exports=o},{"./keyOf":129}],14:[function(t,e){"use strict";var n=t("./EventConstants"),o=t("./EventPropagators"),r=t("./SyntheticMouseEvent"),i=t("./ReactMount"),a=t("./keyOf"),s=n.topLevelTypes,u=i.getFirstReactDOM,c={mouseEnter:{registrationName:a({onMouseEnter:null}),dependencies:[s.topMouseOut,s.topMouseOver]},mouseLeave:{registrationName:a({onMouseLeave:null}),dependencies:[s.topMouseOut,s.topMouseOver]}},l=[null,null],p={eventTypes:c,extractEvents:function(t,e,n,a){if(t===s.topMouseOver&&(a.relatedTarget||a.fromElement))return null;if(t!==s.topMouseOut&&t!==s.topMouseOver)return null;var p;if(e.window===e)p=e;else{var d=e.ownerDocument;p=d?d.defaultView||d.parentWindow:window}var h,f;if(t===s.topMouseOut?(h=e,f=u(a.relatedTarget||a.toElement)||p):(h=p,f=e),h===f)return null;var m=h?i.getID(h):"",v=f?i.getID(f):"",g=r.getPooled(c.mouseLeave,m,a);g.type="mouseleave",g.target=h,g.relatedTarget=f;var y=r.getPooled(c.mouseEnter,v,a);return y.type="mouseenter",y.target=f,y.relatedTarget=h,o.accumulateEnterLeaveDispatches(g,y,m,v),l[0]=g,l[1]=y,l}};e.exports=p},{"./EventConstants":15,"./EventPropagators":20,"./ReactMount":58,"./SyntheticMouseEvent":89,"./keyOf":129}],15:[function(t,e){"use strict";var n=t("./keyMirror"),o=n({bubbled:null,captured:null}),r=n({topBlur:null,topChange:null,topClick:null,topCompositionEnd:null,topCompositionStart:null,topCompositionUpdate:null,topContextMenu:null,topCopy:null,topCut:null,topDoubleClick:null,topDrag:null,topDragEnd:null,topDragEnter:null,topDragExit:null,topDragLeave:null,topDragOver:null,topDragStart:null,topDrop:null,topError:null,topFocus:null,topInput:null,topKeyDown:null,topKeyPress:null,topKeyUp:null,topLoad:null,topMouseDown:null,topMouseMove:null,topMouseOut:null,topMouseOver:null,topMouseUp:null,topPaste:null,topReset:null,topScroll:null,topSelectionChange:null,topSubmit:null,topTouchCancel:null,topTouchEnd:null,topTouchMove:null,topTouchStart:null,topWheel:null}),i={topLevelTypes:r,PropagationPhases:o};e.exports=i},{"./keyMirror":128}],16:[function(t,e){var n=t("./emptyFunction"),o={listen:function(t,e,n){return t.addEventListener?(t.addEventListener(e,n,!1),{remove:function(){t.removeEventListener(e,n,!1)}}):t.attachEvent?(t.attachEvent("on"+e,n),{remove:function(){t.detachEvent(e,n)}}):void 0},capture:function(t,e,o){return t.addEventListener?(t.addEventListener(e,o,!0),{remove:function(){t.removeEventListener(e,o,!0)}}):{remove:n}}};e.exports=o},{"./emptyFunction":106}],17:[function(t,e){"use strict";var n=t("./EventPluginRegistry"),o=t("./EventPluginUtils"),r=t("./ExecutionEnvironment"),i=t("./accumulate"),a=t("./forEachAccumulated"),s=t("./invariant"),u=(t("./isEventSupported"),t("./monitorCodeUse"),{}),c=null,l=function(t){if(t){var e=o.executeDispatch,r=n.getPluginModuleForEvent(t);r&&r.executeDispatch&&(e=r.executeDispatch),o.executeDispatchesInOrder(t,e),t.isPersistent()||t.constructor.release(t)}},p=null,d={injection:{injectMount:o.injection.injectMount,injectInstanceHandle:function(t){p=t},getInstanceHandle:function(){return p},injectEventPluginOrder:n.injectEventPluginOrder,injectEventPluginsByName:n.injectEventPluginsByName},eventNameDispatchConfigs:n.eventNameDispatchConfigs,registrationNameModules:n.registrationNameModules,putListener:function(t,e,n){s(r.canUseDOM),s(!n||"function"==typeof n);var o=u[e]||(u[e]={});o[t]=n},getListener:function(t,e){var n=u[e];return n&&n[t]},deleteListener:function(t,e){var n=u[e];n&&delete n[t]},deleteAllListeners:function(t){for(var e in u)delete u[e][t]},extractEvents:function(t,e,o,r){for(var a,s=n.plugins,u=0,c=s.length;c>u;u++){var l=s[u];if(l){var p=l.extractEvents(t,e,o,r);p&&(a=i(a,p))}}return a},enqueueEvents:function(t){t&&(c=i(c,t))},processEventQueue:function(){var t=c;c=null,a(t,l),s(!c)},__purge:function(){u={}},__getListenerBank:function(){return u}};e.exports=d},{"./EventPluginRegistry":18,"./EventPluginUtils":19,"./ExecutionEnvironment":21,"./accumulate":95,"./forEachAccumulated":111,"./invariant":122,"./isEventSupported":123,"./monitorCodeUse":135}],18:[function(t,e){"use strict";function n(){if(a)for(var t in s){var e=s[t],n=a.indexOf(t);if(i(n>-1),!u.plugins[n]){i(e.extractEvents),u.plugins[n]=e;var r=e.eventTypes;for(var c in r)i(o(r[c],e,c))}}}function o(t,e,n){i(!u.eventNameDispatchConfigs[n]),u.eventNameDispatchConfigs[n]=t;var o=t.phasedRegistrationNames;if(o){for(var a in o)if(o.hasOwnProperty(a)){var s=o[a];r(s,e,n)}return!0}return t.registrationName?(r(t.registrationName,e,n),!0):!1}function r(t,e,n){i(!u.registrationNameModules[t]),u.registrationNameModules[t]=e,u.registrationNameDependencies[t]=e.eventTypes[n].dependencies}var i=t("./invariant"),a=null,s={},u={plugins:[],eventNameDispatchConfigs:{},registrationNameModules:{},registrationNameDependencies:{},injectEventPluginOrder:function(t){i(!a),a=Array.prototype.slice.call(t),n()},injectEventPluginsByName:function(t){var e=!1;for(var o in t)if(t.hasOwnProperty(o)){var r=t[o];s[o]!==r&&(i(!s[o]),s[o]=r,e=!0)}e&&n()},getPluginModuleForEvent:function(t){var e=t.dispatchConfig;if(e.registrationName)return u.registrationNameModules[e.registrationName]||null;for(var n in e.phasedRegistrationNames)if(e.phasedRegistrationNames.hasOwnProperty(n)){var o=u.registrationNameModules[e.phasedRegistrationNames[n]];if(o)return o}return null},_resetEventPlugins:function(){a=null;for(var t in s)s.hasOwnProperty(t)&&delete s[t];u.plugins.length=0;var e=u.eventNameDispatchConfigs;for(var n in e)e.hasOwnProperty(n)&&delete e[n];var o=u.registrationNameModules;for(var r in o)o.hasOwnProperty(r)&&delete o[r]}};e.exports=u},{"./invariant":122}],19:[function(t,e){"use strict";function n(t){return t===f.topMouseUp||t===f.topTouchEnd||t===f.topTouchCancel}function o(t){return t===f.topMouseMove||t===f.topTouchMove}function r(t){return t===f.topMouseDown||t===f.topTouchStart}function i(t,e){var n=t._dispatchListeners,o=t._dispatchIDs;if(Array.isArray(n))for(var r=0;r<n.length&&!t.isPropagationStopped();r++)e(t,n[r],o[r]);else n&&e(t,n,o)}function a(t,e,n){t.currentTarget=h.Mount.getNode(n);var o=e(t,n);return t.currentTarget=null,o}function s(t,e){i(t,e),t._dispatchListeners=null,t._dispatchIDs=null}function u(t){var e=t._dispatchListeners,n=t._dispatchIDs;if(Array.isArray(e)){for(var o=0;o<e.length&&!t.isPropagationStopped();o++)if(e[o](t,n[o]))return n[o]}else if(e&&e(t,n))return n;return null}function c(t){var e=t._dispatchListeners,n=t._dispatchIDs;d(!Array.isArray(e));var o=e?e(t,n):null;return t._dispatchListeners=null,t._dispatchIDs=null,o}function l(t){return!!t._dispatchListeners}var p=t("./EventConstants"),d=t("./invariant"),h={Mount:null,injectMount:function(t){h.Mount=t}},f=p.topLevelTypes,m={isEndish:n,isMoveish:o,isStartish:r,executeDirectDispatch:c,executeDispatch:a,executeDispatchesInOrder:s,executeDispatchesInOrderStopAtTrue:u,hasDispatches:l,injection:h,useTouchEvents:!1};e.exports=m},{"./EventConstants":15,"./invariant":122}],20:[function(t,e){"use strict";function n(t,e,n){var o=e.dispatchConfig.phasedRegistrationNames[n];return m(t,o)}function o(t,e,o){var r=e?f.bubbled:f.captured,i=n(t,o,r);i&&(o._dispatchListeners=d(o._dispatchListeners,i),o._dispatchIDs=d(o._dispatchIDs,t))}function r(t){t&&t.dispatchConfig.phasedRegistrationNames&&p.injection.getInstanceHandle().traverseTwoPhase(t.dispatchMarker,o,t)}function i(t,e,n){if(n&&n.dispatchConfig.registrationName){var o=n.dispatchConfig.registrationName,r=m(t,o);r&&(n._dispatchListeners=d(n._dispatchListeners,r),n._dispatchIDs=d(n._dispatchIDs,t))}}function a(t){t&&t.dispatchConfig.registrationName&&i(t.dispatchMarker,null,t)}function s(t){h(t,r)}function u(t,e,n,o){p.injection.getInstanceHandle().traverseEnterLeave(n,o,i,t,e)}function c(t){h(t,a)}var l=t("./EventConstants"),p=t("./EventPluginHub"),d=t("./accumulate"),h=t("./forEachAccumulated"),f=l.PropagationPhases,m=p.getListener,v={accumulateTwoPhaseDispatches:s,accumulateDirectDispatches:c,accumulateEnterLeaveDispatches:u};e.exports=v},{"./EventConstants":15,"./EventPluginHub":17,"./accumulate":95,"./forEachAccumulated":111}],21:[function(t,e){"use strict";var n="undefined"!=typeof window,o={canUseDOM:n,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:n&&(window.addEventListener||window.attachEvent),isInWorker:!n};e.exports=o},{}],22:[function(t,e){"use strict";var n=t("./ReactLink"),o=t("./ReactStateSetters"),r={linkState:function(t){return new n(this.state[t],o.createStateKeySetter(this,t))}};e.exports=r},{"./ReactLink":56,"./ReactStateSetters":73}],23:[function(t,e){"use strict";function n(t){u(null==t.props.checkedLink||null==t.props.valueLink)}function o(t){n(t),u(null==t.props.value&&null==t.props.onChange)}function r(t){n(t),u(null==t.props.checked&&null==t.props.onChange)}function i(t){this.props.valueLink.requestChange(t.target.value)}function a(t){this.props.checkedLink.requestChange(t.target.checked)}var s=t("./ReactPropTypes"),u=t("./invariant"),c=(t("./warning"),{Mixin:{propTypes:{value:function(){},checked:function(){},onChange:s.func}},getValue:function(t){return t.props.valueLink?(o(t),t.props.valueLink.value):t.props.value},getChecked:function(t){return t.props.checkedLink?(r(t),t.props.checkedLink.value):t.props.checked},getOnChange:function(t){return t.props.valueLink?(o(t),i):t.props.checkedLink?(r(t),a):t.props.onChange}});e.exports=c},{"./ReactPropTypes":67,"./invariant":122,"./warning":144}],24:[function(t,e){"use strict";var n=t("./EventConstants"),o=t("./emptyFunction"),r=n.topLevelTypes,i={eventTypes:null,extractEvents:function(t,e,n,i){if(t===r.topTouchStart){var a=i.target;a&&!a.onclick&&(a.onclick=o)}}};e.exports=i},{"./EventConstants":15,"./emptyFunction":106}],25:[function(t,e){"use strict";var n=t("./invariant"),o=function(t){var e=this;if(e.instancePool.length){var n=e.instancePool.pop();return e.call(n,t),n}return new e(t)},r=function(t,e){var n=this;if(n.instancePool.length){var o=n.instancePool.pop();return n.call(o,t,e),o}return new n(t,e)},i=function(t,e,n){var o=this;if(o.instancePool.length){var r=o.instancePool.pop();return o.call(r,t,e,n),r}return new o(t,e,n)},a=function(t,e,n,o,r){var i=this;if(i.instancePool.length){var a=i.instancePool.pop();return i.call(a,t,e,n,o,r),a}return new i(t,e,n,o,r)},s=function(t){var e=this;n(t instanceof e),t.destructor&&t.destructor(),e.instancePool.length<e.poolSize&&e.instancePool.push(t)},u=10,c=o,l=function(t,e){var n=t;return n.instancePool=[],n.getPooled=e||c,n.poolSize||(n.poolSize=u),n.release=s,n},p={addPoolingTo:l,oneArgumentPooler:o,twoArgumentPooler:r,threeArgumentPooler:i,fiveArgumentPooler:a};e.exports=p},{"./invariant":122}],26:[function(t,e){"use strict";var n=t("./DOMPropertyOperations"),o=t("./EventPluginUtils"),r=t("./ReactChildren"),i=t("./ReactComponent"),a=t("./ReactCompositeComponent"),s=t("./ReactContext"),u=t("./ReactCurrentOwner"),c=t("./ReactDOM"),l=t("./ReactDOMComponent"),p=t("./ReactDefaultInjection"),d=t("./ReactInstanceHandles"),h=t("./ReactMount"),f=t("./ReactMultiChild"),m=t("./ReactPerf"),v=t("./ReactPropTypes"),g=t("./ReactServerRendering"),y=t("./ReactTextComponent"),C=t("./onlyChild");p.inject();var E={Children:{map:r.map,forEach:r.forEach,only:C},DOM:c,PropTypes:v,initializeTouchEvents:function(t){o.useTouchEvents=t},createClass:a.createClass,constructAndRenderComponent:h.constructAndRenderComponent,constructAndRenderComponentByID:h.constructAndRenderComponentByID,renderComponent:m.measure("React","renderComponent",h.renderComponent),renderComponentToString:g.renderComponentToString,renderComponentToStaticMarkup:g.renderComponentToStaticMarkup,unmountComponentAtNode:h.unmountComponentAtNode,isValidClass:a.isValidClass,isValidComponent:i.isValidComponent,withContext:s.withContext,__internals:{Component:i,CurrentOwner:u,DOMComponent:l,DOMPropertyOperations:n,InstanceHandles:d,Mount:h,MultiChild:f,TextComponent:y}};E.version="0.10.0",e.exports=E},{"./DOMPropertyOperations":10,"./EventPluginUtils":19,"./ReactChildren":30,"./ReactComponent":31,"./ReactCompositeComponent":33,"./ReactContext":34,"./ReactCurrentOwner":35,"./ReactDOM":36,"./ReactDOMComponent":38,"./ReactDefaultInjection":48,"./ReactInstanceHandles":55,"./ReactMount":58,"./ReactMultiChild":60,"./ReactPerf":63,"./ReactPropTypes":67,"./ReactServerRendering":71,"./ReactTextComponent":74,"./onlyChild":138}],27:[function(t,e){"use strict";var n=t("./ReactMount"),o=t("./invariant"),r={getDOMNode:function(){return o(this.isMounted()),n.getNode(this._rootNodeID)}};e.exports=r},{"./ReactMount":58,"./invariant":122}],28:[function(t,e){"use strict";var n=t("./React"),o=t("./ReactTransitionGroup"),r=t("./ReactCSSTransitionGroupChild"),i=n.createClass({propTypes:{transitionName:n.PropTypes.string.isRequired,transitionEnter:n.PropTypes.bool,transitionLeave:n.PropTypes.bool},getDefaultProps:function(){return{transitionEnter:!0,transitionLeave:!0}},_wrapChild:function(t){return r({name:this.props.transitionName,enter:this.props.transitionEnter,leave:this.props.transitionLeave},t)},render:function(){return this.transferPropsTo(o({childFactory:this._wrapChild},this.props.children))}});e.exports=i},{"./React":26,"./ReactCSSTransitionGroupChild":29,"./ReactTransitionGroup":77}],29:[function(t,e){"use strict";var n=t("./React"),o=t("./CSSCore"),r=t("./ReactTransitionEvents"),i=t("./onlyChild"),a=17,s=n.createClass({transition:function(t,e){var n=this.getDOMNode(),i=this.props.name+"-"+t,a=i+"-active",s=function(){o.removeClass(n,i),o.removeClass(n,a),r.removeEndEventListener(n,s),e&&e()};r.addEndEventListener(n,s),o.addClass(n,i),this.queueClass(a)},queueClass:function(t){return this.classNameQueue.push(t),this.props.runNextTick?void this.props.runNextTick(this.flushClassNameQueue):void(this.timeout||(this.timeout=setTimeout(this.flushClassNameQueue,a)))},flushClassNameQueue:function(){this.isMounted()&&this.classNameQueue.forEach(o.addClass.bind(o,this.getDOMNode())),this.classNameQueue.length=0,this.timeout=null},componentWillMount:function(){this.classNameQueue=[]},componentWillUnmount:function(){this.timeout&&clearTimeout(this.timeout)},componentWillEnter:function(t){this.props.enter?this.transition("enter",t):t()},componentWillLeave:function(t){this.props.leave?this.transition("leave",t):t()},render:function(){return i(this.props.children)}});e.exports=s},{"./CSSCore":2,"./React":26,"./ReactTransitionEvents":76,"./onlyChild":138}],30:[function(t,e){"use strict";function n(t,e){this.forEachFunction=t,this.forEachContext=e}function o(t,e,n,o){var r=t;r.forEachFunction.call(r.forEachContext,e,o)}function r(t,e,r){if(null==t)return t;var i=n.getPooled(e,r);l(t,o,i),n.release(i)}function i(t,e,n){this.mapResult=t,this.mapFunction=e,this.mapContext=n}function a(t,e,n,o){var r=t,i=r.mapResult,a=r.mapFunction.call(r.mapContext,e,o);c(!i.hasOwnProperty(n)),i[n]=a}function s(t,e,n){if(null==t)return t;var o={},r=i.getPooled(o,e,n);return l(t,a,r),i.release(r),o}var u=t("./PooledClass"),c=t("./invariant"),l=t("./traverseAllChildren"),p=u.twoArgumentPooler,d=u.threeArgumentPooler;u.addPoolingTo(n,p),u.addPoolingTo(i,d);var h={forEach:r,map:s};e.exports=h},{"./PooledClass":25,"./invariant":122,"./traverseAllChildren":142}],31:[function(t,e){"use strict";var n=t("./ReactCurrentOwner"),o=t("./ReactOwner"),r=t("./ReactUpdates"),i=t("./invariant"),a=t("./keyMirror"),s=t("./merge"),u=(t("./monitorCodeUse"),a({MOUNTED:null,UNMOUNTED:null})),c=!1,l=null,p=null,d={injection:{injectEnvironment:function(t){i(!c),p=t.mountImageIntoNode,l=t.unmountIDFromEnvironment,d.BackendIDOperations=t.BackendIDOperations,d.ReactReconcileTransaction=t.ReactReconcileTransaction,c=!0}},isValidComponent:function(t){if(!t||!t.type||!t.type.prototype)return!1;var e=t.type.prototype;return"function"==typeof e.mountComponentIntoNode&&"function"==typeof e.receiveComponent},LifeCycle:u,BackendIDOperations:null,ReactReconcileTransaction:null,Mixin:{isMounted:function(){return this._lifeCycleState===u.MOUNTED},setProps:function(t,e){this.replaceProps(s(this._pendingProps||this.props,t),e)},replaceProps:function(t,e){i(this.isMounted()),i(0===this._mountDepth),this._pendingProps=t,r.enqueueUpdate(this,e)
+},construct:function(t,e){this.props=t||{},this._owner=n.current,this._lifeCycleState=u.UNMOUNTED,this._pendingProps=null,this._pendingCallbacks=null,this._pendingOwner=this._owner;var o=arguments.length-1;if(1===o)this.props.children=e;else if(o>1){for(var r=Array(o),i=0;o>i;i++)r[i]=arguments[i+1];this.props.children=r}},mountComponent:function(t,e,n){i(!this.isMounted());var r=this.props;null!=r.ref&&o.addComponentAsRefTo(this,r.ref,this._owner),this._rootNodeID=t,this._lifeCycleState=u.MOUNTED,this._mountDepth=n},unmountComponent:function(){i(this.isMounted());var t=this.props;null!=t.ref&&o.removeComponentAsRefFrom(this,t.ref,this._owner),l(this._rootNodeID),this._rootNodeID=null,this._lifeCycleState=u.UNMOUNTED},receiveComponent:function(t,e){i(this.isMounted()),this._pendingOwner=t._owner,this._pendingProps=t.props,this._performUpdateIfNecessary(e)},performUpdateIfNecessary:function(){var t=d.ReactReconcileTransaction.getPooled();t.perform(this._performUpdateIfNecessary,this,t),d.ReactReconcileTransaction.release(t)},_performUpdateIfNecessary:function(t){if(null!=this._pendingProps){var e=this.props,n=this._owner;this.props=this._pendingProps,this._owner=this._pendingOwner,this._pendingProps=null,this.updateComponent(t,e,n)}},updateComponent:function(t,e,n){var r=this.props;(this._owner!==n||r.ref!==e.ref)&&(null!=e.ref&&o.removeComponentAsRefFrom(this,e.ref,n),null!=r.ref&&o.addComponentAsRefTo(this,r.ref,this._owner))},mountComponentIntoNode:function(t,e,n){var o=d.ReactReconcileTransaction.getPooled();o.perform(this._mountComponentIntoNode,this,t,e,o,n),d.ReactReconcileTransaction.release(o)},_mountComponentIntoNode:function(t,e,n,o){var r=this.mountComponent(t,n,0);p(r,e,o)},isOwnedBy:function(t){return this._owner===t},getSiblingByRef:function(t){var e=this._owner;return e&&e.refs?e.refs[t]:null}}};e.exports=d},{"./ReactCurrentOwner":35,"./ReactOwner":62,"./ReactUpdates":78,"./invariant":122,"./keyMirror":128,"./merge":131,"./monitorCodeUse":135}],32:[function(t,e){"use strict";var n=t("./ReactDOMIDOperations"),o=t("./ReactMarkupChecksum"),r=t("./ReactMount"),i=t("./ReactPerf"),a=t("./ReactReconcileTransaction"),s=t("./getReactRootElementInContainer"),u=t("./invariant"),c=1,l=9,p={ReactReconcileTransaction:a,BackendIDOperations:n,unmountIDFromEnvironment:function(t){r.purgeID(t)},mountImageIntoNode:i.measure("ReactComponentBrowserEnvironment","mountImageIntoNode",function(t,e,n){if(u(e&&(e.nodeType===c||e.nodeType===l)),n){if(o.canReuseMarkup(t,s(e)))return;u(e.nodeType!==l)}u(e.nodeType!==l),e.innerHTML=t})};e.exports=p},{"./ReactDOMIDOperations":40,"./ReactMarkupChecksum":57,"./ReactMount":58,"./ReactPerf":63,"./ReactReconcileTransaction":69,"./getReactRootElementInContainer":117,"./invariant":122}],33:[function(t,e){"use strict";function n(t,e){for(var n in e)e.hasOwnProperty(n)&&R("function"==typeof e[n])}function o(t,e){var n=S[e];_.hasOwnProperty(e)&&R(n===b.OVERRIDE_BASE),t.hasOwnProperty(e)&&R(n===b.DEFINE_MANY||n===b.DEFINE_MANY_MERGED)}function r(t){var e=t._compositeLifeCycleState;R(t.isMounted()||e===I.MOUNTING),R(e!==I.RECEIVING_STATE),R(e!==I.UNMOUNTING)}function i(t,e){R(!l(e)),R(!p.isValidComponent(e));var n=t.componentConstructor,r=n.prototype;for(var i in e){var a=e[i];if(e.hasOwnProperty(i))if(o(r,i),N.hasOwnProperty(i))N[i](t,a);else{var s=i in S,d=i in r,h=a&&a.__reactDontBind,f="function"==typeof a,m=f&&!s&&!d&&!h;m?(r.__reactAutoBindMap||(r.__reactAutoBindMap={}),r.__reactAutoBindMap[i]=a,r[i]=a):r[i]=d?S[i]===b.DEFINE_MANY_MERGED?u(r[i],a):c(r[i],a):a}}}function a(t,e){if(e)for(var n in e){var o=e[n];if(!e.hasOwnProperty(n))return;var r=n in t,i=o;if(r){var a=t[n],s=typeof a,u=typeof o;R("function"===s&&"function"===u),i=c(a,o)}t[n]=i,t.componentConstructor[n]=i}}function s(t,e){return R(t&&e&&"object"==typeof t&&"object"==typeof e),P(e,function(e,n){R(void 0===t[n]),t[n]=e}),t}function u(t,e){return function(){var n=t.apply(this,arguments),o=e.apply(this,arguments);return null==n?o:null==o?n:s(n,o)}}function c(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function l(t){return t instanceof Function&&"componentConstructor"in t&&t.componentConstructor instanceof Function}var p=t("./ReactComponent"),d=t("./ReactContext"),h=t("./ReactCurrentOwner"),f=t("./ReactErrorUtils"),m=t("./ReactOwner"),v=t("./ReactPerf"),g=t("./ReactPropTransferer"),y=t("./ReactPropTypeLocations"),C=(t("./ReactPropTypeLocationNames"),t("./ReactUpdates")),E=t("./instantiateReactComponent"),R=t("./invariant"),M=t("./keyMirror"),D=t("./merge"),x=t("./mixInto"),P=(t("./monitorCodeUse"),t("./objMap")),T=t("./shouldUpdateReactComponent"),b=(t("./warning"),M({DEFINE_ONCE:null,DEFINE_MANY:null,OVERRIDE_BASE:null,DEFINE_MANY_MERGED:null})),O=[],S={mixins:b.DEFINE_MANY,statics:b.DEFINE_MANY,propTypes:b.DEFINE_MANY,contextTypes:b.DEFINE_MANY,childContextTypes:b.DEFINE_MANY,getDefaultProps:b.DEFINE_MANY_MERGED,getInitialState:b.DEFINE_MANY_MERGED,getChildContext:b.DEFINE_MANY_MERGED,render:b.DEFINE_ONCE,componentWillMount:b.DEFINE_MANY,componentDidMount:b.DEFINE_MANY,componentWillReceiveProps:b.DEFINE_MANY,shouldComponentUpdate:b.DEFINE_ONCE,componentWillUpdate:b.DEFINE_MANY,componentDidUpdate:b.DEFINE_MANY,componentWillUnmount:b.DEFINE_MANY,updateComponent:b.OVERRIDE_BASE},N={displayName:function(t,e){t.componentConstructor.displayName=e},mixins:function(t,e){if(e)for(var n=0;n<e.length;n++)i(t,e[n])},childContextTypes:function(t,e){var o=t.componentConstructor;n(o,e,y.childContext),o.childContextTypes=D(o.childContextTypes,e)},contextTypes:function(t,e){var o=t.componentConstructor;n(o,e,y.context),o.contextTypes=D(o.contextTypes,e)},propTypes:function(t,e){var o=t.componentConstructor;n(o,e,y.prop),o.propTypes=D(o.propTypes,e)},statics:function(t,e){a(t,e)}},I=M({MOUNTING:null,UNMOUNTING:null,RECEIVING_PROPS:null,RECEIVING_STATE:null}),_={construct:function(){p.Mixin.construct.apply(this,arguments),m.Mixin.construct.apply(this,arguments),this.state=null,this._pendingState=null,this.context=null,this._currentContext=d.current,this._pendingContext=null,this._descriptor=null,this._compositeLifeCycleState=null},toJSON:function(){return{type:this.type,props:this.props}},isMounted:function(){return p.Mixin.isMounted.call(this)&&this._compositeLifeCycleState!==I.MOUNTING},mountComponent:v.measure("ReactCompositeComponent","mountComponent",function(t,e,n){p.Mixin.mountComponent.call(this,t,e,n),this._compositeLifeCycleState=I.MOUNTING,this.context=this._processContext(this._currentContext),this._defaultProps=this.getDefaultProps?this.getDefaultProps():null,this.props=this._processProps(this.props),this.__reactAutoBindMap&&this._bindAutoBindMethods(),this.state=this.getInitialState?this.getInitialState():null,R("object"==typeof this.state&&!Array.isArray(this.state)),this._pendingState=null,this._pendingForceUpdate=!1,this.componentWillMount&&(this.componentWillMount(),this._pendingState&&(this.state=this._pendingState,this._pendingState=null)),this._renderedComponent=E(this._renderValidatedComponent()),this._compositeLifeCycleState=null;var o=this._renderedComponent.mountComponent(t,e,n+1);return this.componentDidMount&&e.getReactMountReady().enqueue(this,this.componentDidMount),o}),unmountComponent:function(){this._compositeLifeCycleState=I.UNMOUNTING,this.componentWillUnmount&&this.componentWillUnmount(),this._compositeLifeCycleState=null,this._defaultProps=null,this._renderedComponent.unmountComponent(),this._renderedComponent=null,p.Mixin.unmountComponent.call(this)},setState:function(t,e){R("object"==typeof t||null==t),this.replaceState(D(this._pendingState||this.state,t),e)},replaceState:function(t,e){r(this),this._pendingState=t,C.enqueueUpdate(this,e)},_processContext:function(t){var e=null,n=this.constructor.contextTypes;if(n){e={};for(var o in n)e[o]=t[o]}return e},_processChildContext:function(t){var e=this.getChildContext&&this.getChildContext();if(this.constructor.displayName||"ReactCompositeComponent",e){R("object"==typeof this.constructor.childContextTypes);for(var n in e)R(n in this.constructor.childContextTypes);return D(t,e)}return t},_processProps:function(t){var e=D(t),n=this._defaultProps;for(var o in n)"undefined"==typeof e[o]&&(e[o]=n[o]);return e},_checkPropTypes:function(t,e,n){var o=this.constructor.displayName;for(var r in t)t.hasOwnProperty(r)&&t[r](e,r,o,n)},performUpdateIfNecessary:function(){var t=this._compositeLifeCycleState;t!==I.MOUNTING&&t!==I.RECEIVING_PROPS&&p.Mixin.performUpdateIfNecessary.call(this)},_performUpdateIfNecessary:function(t){if(null!=this._pendingProps||null!=this._pendingState||null!=this._pendingContext||this._pendingForceUpdate){var e=this._pendingContext||this._currentContext,n=this._processContext(e);this._pendingContext=null;var o=this.props;null!=this._pendingProps&&(o=this._processProps(this._pendingProps),this._pendingProps=null,this._compositeLifeCycleState=I.RECEIVING_PROPS,this.componentWillReceiveProps&&this.componentWillReceiveProps(o,n)),this._compositeLifeCycleState=I.RECEIVING_STATE;var r=this._pendingOwner,i=this._pendingState||this.state;this._pendingState=null;try{this._pendingForceUpdate||!this.shouldComponentUpdate||this.shouldComponentUpdate(o,i,n)?(this._pendingForceUpdate=!1,this._performComponentUpdate(o,r,i,e,n,t)):(this.props=o,this._owner=r,this.state=i,this._currentContext=e,this.context=n)}finally{this._compositeLifeCycleState=null}}},_performComponentUpdate:function(t,e,n,o,r,i){var a=this.props,s=this._owner,u=this.state,c=this.context;this.componentWillUpdate&&this.componentWillUpdate(t,n,r),this.props=t,this._owner=e,this.state=n,this._currentContext=o,this.context=r,this.updateComponent(i,a,s,u,c),this.componentDidUpdate&&i.getReactMountReady().enqueue(this,this.componentDidUpdate.bind(this,a,u,c))},receiveComponent:function(t,e){t!==this._descriptor&&(this._descriptor=t,this._pendingContext=t._currentContext,p.Mixin.receiveComponent.call(this,t,e))},updateComponent:v.measure("ReactCompositeComponent","updateComponent",function(t,e,n){p.Mixin.updateComponent.call(this,t,e,n);var o=this._renderedComponent,r=this._renderValidatedComponent();if(T(o,r))o.receiveComponent(r,t);else{var i=this._rootNodeID,a=o._rootNodeID;o.unmountComponent(),this._renderedComponent=E(r);var s=this._renderedComponent.mountComponent(i,t,this._mountDepth+1);p.BackendIDOperations.dangerouslyReplaceNodeWithMarkupByID(a,s)}}),forceUpdate:function(t){var e=this._compositeLifeCycleState;R(this.isMounted()||e===I.MOUNTING),R(e!==I.RECEIVING_STATE&&e!==I.UNMOUNTING),this._pendingForceUpdate=!0,C.enqueueUpdate(this,t)},_renderValidatedComponent:v.measure("ReactCompositeComponent","_renderValidatedComponent",function(){var t,e=d.current;d.current=this._processChildContext(this._currentContext),h.current=this;try{t=this.render()}finally{d.current=e,h.current=null}return R(p.isValidComponent(t)),t}),_bindAutoBindMethods:function(){for(var t in this.__reactAutoBindMap)if(this.__reactAutoBindMap.hasOwnProperty(t)){var e=this.__reactAutoBindMap[t];this[t]=this._bindAutoBindMethod(f.guard(e,this.constructor.displayName+"."+t))}},_bindAutoBindMethod:function(t){var e=this,n=function(){return t.apply(e,arguments)};return n}},w=function(){};x(w,p.Mixin),x(w,m.Mixin),x(w,g.Mixin),x(w,_);var A={LifeCycle:I,Base:w,createClass:function(t){var e=function(){};e.prototype=new w,e.prototype.constructor=e;var n=e,o=function(){var t=new n;return t.construct.apply(t,arguments),t};o.componentConstructor=e,e.ConvenienceConstructor=o,o.originalSpec=t,O.forEach(i.bind(null,o)),i(o,t),R(e.prototype.render),o.type=e,e.prototype.type=e;for(var r in S)e.prototype[r]||(e.prototype[r]=null);return o},isValidClass:l,injection:{injectMixin:function(t){O.push(t)}}};e.exports=A},{"./ReactComponent":31,"./ReactContext":34,"./ReactCurrentOwner":35,"./ReactErrorUtils":49,"./ReactOwner":62,"./ReactPerf":63,"./ReactPropTransferer":64,"./ReactPropTypeLocationNames":65,"./ReactPropTypeLocations":66,"./ReactUpdates":78,"./instantiateReactComponent":121,"./invariant":122,"./keyMirror":128,"./merge":131,"./mixInto":134,"./monitorCodeUse":135,"./objMap":136,"./shouldUpdateReactComponent":140,"./warning":144}],34:[function(t,e){"use strict";var n=t("./merge"),o={current:{},withContext:function(t,e){var r,i=o.current;o.current=n(i,t);try{r=e()}finally{o.current=i}return r}};e.exports=o},{"./merge":131}],35:[function(t,e){"use strict";var n={current:null};e.exports=n},{}],36:[function(t,e){"use strict";function n(t,e){var n=function(){};n.prototype=new o(t,e),n.prototype.constructor=n,n.displayName=t;var r=function(){var t=new n;return t.construct.apply(t,arguments),t};return r.type=n,n.prototype.type=n,n.ConvenienceConstructor=r,r.componentConstructor=n,r}var o=t("./ReactDOMComponent"),r=t("./mergeInto"),i=t("./objMapKeyVal"),a=i({a:!1,abbr:!1,address:!1,area:!0,article:!1,aside:!1,audio:!1,b:!1,base:!0,bdi:!1,bdo:!1,big:!1,blockquote:!1,body:!1,br:!0,button:!1,canvas:!1,caption:!1,cite:!1,code:!1,col:!0,colgroup:!1,data:!1,datalist:!1,dd:!1,del:!1,details:!1,dfn:!1,div:!1,dl:!1,dt:!1,em:!1,embed:!0,fieldset:!1,figcaption:!1,figure:!1,footer:!1,form:!1,h1:!1,h2:!1,h3:!1,h4:!1,h5:!1,h6:!1,head:!1,header:!1,hr:!0,html:!1,i:!1,iframe:!1,img:!0,input:!0,ins:!1,kbd:!1,keygen:!0,label:!1,legend:!1,li:!1,link:!0,main:!1,map:!1,mark:!1,menu:!1,menuitem:!1,meta:!0,meter:!1,nav:!1,noscript:!1,object:!1,ol:!1,optgroup:!1,option:!1,output:!1,p:!1,param:!0,pre:!1,progress:!1,q:!1,rp:!1,rt:!1,ruby:!1,s:!1,samp:!1,script:!1,section:!1,select:!1,small:!1,source:!0,span:!1,strong:!1,style:!1,sub:!1,summary:!1,sup:!1,table:!1,tbody:!1,td:!1,textarea:!1,tfoot:!1,th:!1,thead:!1,time:!1,title:!1,tr:!1,track:!0,u:!1,ul:!1,"var":!1,video:!1,wbr:!0,circle:!1,defs:!1,g:!1,line:!1,linearGradient:!1,path:!1,polygon:!1,polyline:!1,radialGradient:!1,rect:!1,stop:!1,svg:!1,text:!1},n),s={injectComponentClasses:function(t){r(a,t)}};a.injection=s,e.exports=a},{"./ReactDOMComponent":38,"./mergeInto":133,"./objMapKeyVal":137}],37:[function(t,e){"use strict";var n=t("./AutoFocusMixin"),o=t("./ReactBrowserComponentMixin"),r=t("./ReactCompositeComponent"),i=t("./ReactDOM"),a=t("./keyMirror"),s=i.button,u=a({onClick:!0,onDoubleClick:!0,onMouseDown:!0,onMouseMove:!0,onMouseUp:!0,onClickCapture:!0,onDoubleClickCapture:!0,onMouseDownCapture:!0,onMouseMoveCapture:!0,onMouseUpCapture:!0}),c=r.createClass({displayName:"ReactDOMButton",mixins:[n,o],render:function(){var t={};for(var e in this.props)!this.props.hasOwnProperty(e)||this.props.disabled&&u[e]||(t[e]=this.props[e]);return s(t,this.props.children)}});e.exports=c},{"./AutoFocusMixin":1,"./ReactBrowserComponentMixin":27,"./ReactCompositeComponent":33,"./ReactDOM":36,"./keyMirror":128}],38:[function(t,e){"use strict";function n(t){t&&(m(null==t.children||null==t.dangerouslySetInnerHTML),m(null==t.style||"object"==typeof t.style))}function o(t,e,n,o){var r=p.findReactContainerForID(t);if(r){var i=r.nodeType===x?r.ownerDocument:r;E(e,i)}o.getPutListenerQueue().enqueuePutListener(t,e,n)}function r(t,e){this._tagOpen="<"+t,this._tagClose=e?"":"</"+t+">",this.tagName=t.toUpperCase()}var i=t("./CSSPropertyOperations"),a=t("./DOMProperty"),s=t("./DOMPropertyOperations"),u=t("./ReactBrowserComponentMixin"),c=t("./ReactComponent"),l=t("./ReactEventEmitter"),p=t("./ReactMount"),d=t("./ReactMultiChild"),h=t("./ReactPerf"),f=t("./escapeTextForBrowser"),m=t("./invariant"),v=t("./keyOf"),g=t("./merge"),y=t("./mixInto"),C=l.deleteListener,E=l.listenTo,R=l.registrationNameModules,M={string:!0,number:!0},D=v({style:null}),x=1;r.Mixin={mountComponent:h.measure("ReactDOMComponent","mountComponent",function(t,e,o){return c.Mixin.mountComponent.call(this,t,e,o),n(this.props),this._createOpenTagMarkupAndPutListeners(e)+this._createContentMarkup(e)+this._tagClose}),_createOpenTagMarkupAndPutListeners:function(t){var e=this.props,n=this._tagOpen;for(var r in e)if(e.hasOwnProperty(r)){var a=e[r];if(null!=a)if(R[r])o(this._rootNodeID,r,a,t);else{r===D&&(a&&(a=e.style=g(e.style)),a=i.createMarkupForStyles(a));var u=s.createMarkupForProperty(r,a);u&&(n+=" "+u)}}if(t.renderToStaticMarkup)return n+">";var c=s.createMarkupForID(this._rootNodeID);return n+" "+c+">"},_createContentMarkup:function(t){var e=this.props.dangerouslySetInnerHTML;if(null!=e){if(null!=e.__html)return e.__html}else{var n=M[typeof this.props.children]?this.props.children:null,o=null!=n?null:this.props.children;if(null!=n)return f(n);if(null!=o){var r=this.mountChildren(o,t);return r.join("")}}return""},receiveComponent:function(t,e){t!==this&&(n(t.props),c.Mixin.receiveComponent.call(this,t,e))},updateComponent:h.measure("ReactDOMComponent","updateComponent",function(t,e,n){c.Mixin.updateComponent.call(this,t,e,n),this._updateDOMProperties(e,t),this._updateDOMChildren(e,t)}),_updateDOMProperties:function(t,e){var n,r,i,s=this.props;for(n in t)if(!s.hasOwnProperty(n)&&t.hasOwnProperty(n))if(n===D){var u=t[n];for(r in u)u.hasOwnProperty(r)&&(i=i||{},i[r]="")}else R[n]?C(this._rootNodeID,n):(a.isStandardName[n]||a.isCustomAttribute(n))&&c.BackendIDOperations.deletePropertyByID(this._rootNodeID,n);for(n in s){var l=s[n],p=t[n];if(s.hasOwnProperty(n)&&l!==p)if(n===D)if(l&&(l=s.style=g(l)),p){for(r in p)p.hasOwnProperty(r)&&!l.hasOwnProperty(r)&&(i=i||{},i[r]="");for(r in l)l.hasOwnProperty(r)&&p[r]!==l[r]&&(i=i||{},i[r]=l[r])}else i=l;else R[n]?o(this._rootNodeID,n,l,e):(a.isStandardName[n]||a.isCustomAttribute(n))&&c.BackendIDOperations.updatePropertyByID(this._rootNodeID,n,l)}i&&c.BackendIDOperations.updateStylesByID(this._rootNodeID,i)},_updateDOMChildren:function(t,e){var n=this.props,o=M[typeof t.children]?t.children:null,r=M[typeof n.children]?n.children:null,i=t.dangerouslySetInnerHTML&&t.dangerouslySetInnerHTML.__html,a=n.dangerouslySetInnerHTML&&n.dangerouslySetInnerHTML.__html,s=null!=o?null:t.children,u=null!=r?null:n.children,l=null!=o||null!=i,p=null!=r||null!=a;null!=s&&null==u?this.updateChildren(null,e):l&&!p&&this.updateTextContent(""),null!=r?o!==r&&this.updateTextContent(""+r):null!=a?i!==a&&c.BackendIDOperations.updateInnerHTMLByID(this._rootNodeID,a):null!=u&&this.updateChildren(u,e)},unmountComponent:function(){this.unmountChildren(),l.deleteAllListeners(this._rootNodeID),c.Mixin.unmountComponent.call(this)}},y(r,c.Mixin),y(r,r.Mixin),y(r,d.Mixin),y(r,u),e.exports=r},{"./CSSPropertyOperations":4,"./DOMProperty":9,"./DOMPropertyOperations":10,"./ReactBrowserComponentMixin":27,"./ReactComponent":31,"./ReactEventEmitter":50,"./ReactMount":58,"./ReactMultiChild":60,"./ReactPerf":63,"./escapeTextForBrowser":108,"./invariant":122,"./keyOf":129,"./merge":131,"./mixInto":134}],39:[function(t,e){"use strict";var n=t("./ReactBrowserComponentMixin"),o=t("./ReactCompositeComponent"),r=t("./ReactDOM"),i=t("./ReactEventEmitter"),a=t("./EventConstants"),s=r.form,u=o.createClass({displayName:"ReactDOMForm",mixins:[n],render:function(){return this.transferPropsTo(s(null,this.props.children))},componentDidMount:function(){i.trapBubbledEvent(a.topLevelTypes.topReset,"reset",this.getDOMNode()),i.trapBubbledEvent(a.topLevelTypes.topSubmit,"submit",this.getDOMNode())}});e.exports=u},{"./EventConstants":15,"./ReactBrowserComponentMixin":27,"./ReactCompositeComponent":33,"./ReactDOM":36,"./ReactEventEmitter":50}],40:[function(t,e){"use strict";var n,o=t("./CSSPropertyOperations"),r=t("./DOMChildrenOperations"),i=t("./DOMPropertyOperations"),a=t("./ReactMount"),s=t("./ReactPerf"),u=t("./invariant"),c={dangerouslySetInnerHTML:"`dangerouslySetInnerHTML` must be set using `updateInnerHTMLByID()`.",style:"`style` must be set using `updateStylesByID()`."},l={updatePropertyByID:s.measure("ReactDOMIDOperations","updatePropertyByID",function(t,e,n){var o=a.getNode(t);u(!c.hasOwnProperty(e)),null!=n?i.setValueForProperty(o,e,n):i.deleteValueForProperty(o,e)}),deletePropertyByID:s.measure("ReactDOMIDOperations","deletePropertyByID",function(t,e,n){var o=a.getNode(t);u(!c.hasOwnProperty(e)),i.deleteValueForProperty(o,e,n)}),updateStylesByID:s.measure("ReactDOMIDOperations","updateStylesByID",function(t,e){var n=a.getNode(t);o.setValueForStyles(n,e)}),updateInnerHTMLByID:s.measure("ReactDOMIDOperations","updateInnerHTMLByID",function(t,e){var o=a.getNode(t);if(void 0===n){var r=document.createElement("div");r.innerHTML=" ",n=""===r.innerHTML}n&&o.parentNode.replaceChild(o,o),n&&e.match(/^[ \r\n\t\f]/)?(o.innerHTML=""+e,o.firstChild.deleteData(0,1)):o.innerHTML=e}),updateTextContentByID:s.measure("ReactDOMIDOperations","updateTextContentByID",function(t,e){var n=a.getNode(t);r.updateTextContent(n,e)}),dangerouslyReplaceNodeWithMarkupByID:s.measure("ReactDOMIDOperations","dangerouslyReplaceNodeWithMarkupByID",function(t,e){var n=a.getNode(t);r.dangerouslyReplaceNodeWithMarkup(n,e)}),dangerouslyProcessChildrenUpdates:s.measure("ReactDOMIDOperations","dangerouslyProcessChildrenUpdates",function(t,e){for(var n=0;n<t.length;n++)t[n].parentNode=a.getNode(t[n].parentID);r.processUpdates(t,e)})};e.exports=l},{"./CSSPropertyOperations":4,"./DOMChildrenOperations":8,"./DOMPropertyOperations":10,"./ReactMount":58,"./ReactPerf":63,"./invariant":122}],41:[function(t,e){"use strict";var n=t("./ReactBrowserComponentMixin"),o=t("./ReactCompositeComponent"),r=t("./ReactDOM"),i=t("./ReactEventEmitter"),a=t("./EventConstants"),s=r.img,u=o.createClass({displayName:"ReactDOMImg",tagName:"IMG",mixins:[n],render:function(){return s(this.props)},componentDidMount:function(){var t=this.getDOMNode();i.trapBubbledEvent(a.topLevelTypes.topLoad,"load",t),i.trapBubbledEvent(a.topLevelTypes.topError,"error",t)}});e.exports=u},{"./EventConstants":15,"./ReactBrowserComponentMixin":27,"./ReactCompositeComponent":33,"./ReactDOM":36,"./ReactEventEmitter":50}],42:[function(t,e){"use strict";var n=t("./AutoFocusMixin"),o=t("./DOMPropertyOperations"),r=t("./LinkedValueUtils"),i=t("./ReactBrowserComponentMixin"),a=t("./ReactCompositeComponent"),s=t("./ReactDOM"),u=t("./ReactMount"),c=t("./invariant"),l=t("./merge"),p=s.input,d={},h=a.createClass({displayName:"ReactDOMInput",mixins:[n,r.Mixin,i],getInitialState:function(){var t=this.props.defaultValue;return{checked:this.props.defaultChecked||!1,value:null!=t?t:null}},shouldComponentUpdate:function(){return!this._isChanging},render:function(){var t=l(this.props);t.defaultChecked=null,t.defaultValue=null;var e=r.getValue(this);t.value=null!=e?e:this.state.value;var n=r.getChecked(this);return t.checked=null!=n?n:this.state.checked,t.onChange=this._handleChange,p(t,this.props.children)},componentDidMount:function(){var t=u.getID(this.getDOMNode());d[t]=this},componentWillUnmount:function(){var t=this.getDOMNode(),e=u.getID(t);delete d[e]},componentDidUpdate:function(){var t=this.getDOMNode();null!=this.props.checked&&o.setValueForProperty(t,"checked",this.props.checked||!1);var e=r.getValue(this);null!=e&&o.setValueForProperty(t,"value",""+e)},_handleChange:function(t){var e,n=r.getOnChange(this);n&&(this._isChanging=!0,e=n.call(this,t),this._isChanging=!1),this.setState({checked:t.target.checked,value:t.target.value});var o=this.props.name;if("radio"===this.props.type&&null!=o){for(var i=this.getDOMNode(),a=i;a.parentNode;)a=a.parentNode;for(var s=a.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),l=0,p=s.length;p>l;l++){var h=s[l];if(h!==i&&h.form===i.form){var f=u.getID(h);c(f);var m=d[f];c(m),m.setState({checked:!1})}}}return e}});e.exports=h},{"./AutoFocusMixin":1,"./DOMPropertyOperations":10,"./LinkedValueUtils":23,"./ReactBrowserComponentMixin":27,"./ReactCompositeComponent":33,"./ReactDOM":36,"./ReactMount":58,"./invariant":122,"./merge":131}],43:[function(t,e){"use strict";var n=t("./ReactBrowserComponentMixin"),o=t("./ReactCompositeComponent"),r=t("./ReactDOM"),i=(t("./warning"),r.option),a=o.createClass({displayName:"ReactDOMOption",mixins:[n],componentWillMount:function(){},render:function(){return i(this.props,this.props.children)}});e.exports=a},{"./ReactBrowserComponentMixin":27,"./ReactCompositeComponent":33,"./ReactDOM":36,"./warning":144}],44:[function(t,e){"use strict";function n(t,e){null!=t[e]&&c(t.multiple?Array.isArray(t[e]):!Array.isArray(t[e]))}function o(t,e){var n,o,r,i=t.props.multiple,a=null!=e?e:t.state.value,s=t.getDOMNode().options;if(i)for(n={},o=0,r=a.length;r>o;++o)n[""+a[o]]=!0;else n=""+a;for(o=0,r=s.length;r>o;o++){var u=i?n.hasOwnProperty(s[o].value):s[o].value===n;u!==s[o].selected&&(s[o].selected=u)}}var r=t("./AutoFocusMixin"),i=t("./LinkedValueUtils"),a=t("./ReactBrowserComponentMixin"),s=t("./ReactCompositeComponent"),u=t("./ReactDOM"),c=t("./invariant"),l=t("./merge"),p=u.select,d=s.createClass({displayName:"ReactDOMSelect",mixins:[r,i.Mixin,a],propTypes:{defaultValue:n,value:n},getInitialState:function(){return{value:this.props.defaultValue||(this.props.multiple?[]:"")}},componentWillReceiveProps:function(t){!this.props.multiple&&t.multiple?this.setState({value:[this.state.value]}):this.props.multiple&&!t.multiple&&this.setState({value:this.state.value[0]})},shouldComponentUpdate:function(){return!this._isChanging},render:function(){var t=l(this.props);return t.onChange=this._handleChange,t.value=null,p(t,this.props.children)},componentDidMount:function(){o(this,i.getValue(this))},componentDidUpdate:function(){var t=i.getValue(this);null!=t&&o(this,t)},_handleChange:function(t){var e,n=i.getOnChange(this);n&&(this._isChanging=!0,e=n.call(this,t),this._isChanging=!1);var o;if(this.props.multiple){o=[];for(var r=t.target.options,a=0,s=r.length;s>a;a++)r[a].selected&&o.push(r[a].value)}else o=t.target.value;return this.setState({value:o}),e}});e.exports=d},{"./AutoFocusMixin":1,"./LinkedValueUtils":23,"./ReactBrowserComponentMixin":27,"./ReactCompositeComponent":33,"./ReactDOM":36,"./invariant":122,"./merge":131}],45:[function(t,e){"use strict";function n(t){var e=document.selection,n=e.createRange(),o=n.text.length,r=n.duplicate();r.moveToElementText(t),r.setEndPoint("EndToStart",n);var i=r.text.length,a=i+o;return{start:i,end:a}}function o(t){var e=window.getSelection();if(0===e.rangeCount)return null;var n=e.anchorNode,o=e.anchorOffset,r=e.focusNode,i=e.focusOffset,a=e.getRangeAt(0),s=a.toString().length,u=a.cloneRange();u.selectNodeContents(t),u.setEnd(a.startContainer,a.startOffset);var c=u.toString().length,l=c+s,p=document.createRange();p.setStart(n,o),p.setEnd(r,i);var d=p.collapsed;return p.detach(),{start:d?l:c,end:d?c:l}}function r(t,e){var n,o,r=document.selection.createRange().duplicate();"undefined"==typeof e.end?(n=e.start,o=n):e.start>e.end?(n=e.end,o=e.start):(n=e.start,o=e.end),r.moveToElementText(t),r.moveStart("character",n),r.setEndPoint("EndToStart",r),r.moveEnd("character",o-n),r.select()}function i(t,e){var n=window.getSelection(),o=t[s()].length,r=Math.min(e.start,o),i="undefined"==typeof e.end?r:Math.min(e.end,o);if(!n.extend&&r>i){var u=i;i=r,r=u}var c=a(t,r),l=a(t,i);if(c&&l){var p=document.createRange();p.setStart(c.node,c.offset),n.removeAllRanges(),r>i?(n.addRange(p),n.extend(l.node,l.offset)):(p.setEnd(l.node,l.offset),n.addRange(p)),p.detach()}}var a=t("./getNodeForCharacterOffset"),s=t("./getTextContentAccessor"),u={getOffsets:function(t){var e=document.selection?n:o;return e(t)},setOffsets:function(t,e){var n=document.selection?r:i;n(t,e)}};e.exports=u},{"./getNodeForCharacterOffset":116,"./getTextContentAccessor":118}],46:[function(t,e){"use strict";var n=t("./AutoFocusMixin"),o=t("./DOMPropertyOperations"),r=t("./LinkedValueUtils"),i=t("./ReactBrowserComponentMixin"),a=t("./ReactCompositeComponent"),s=t("./ReactDOM"),u=t("./invariant"),c=t("./merge"),l=(t("./warning"),s.textarea),p=a.createClass({displayName:"ReactDOMTextarea",mixins:[n,r.Mixin,i],getInitialState:function(){var t=this.props.defaultValue,e=this.props.children;null!=e&&(u(null==t),Array.isArray(e)&&(u(e.length<=1),e=e[0]),t=""+e),null==t&&(t="");var n=r.getValue(this);return{initialValue:""+(null!=n?n:t),value:t}},shouldComponentUpdate:function(){return!this._isChanging},render:function(){var t=c(this.props),e=r.getValue(this);return u(null==t.dangerouslySetInnerHTML),t.defaultValue=null,t.value=null!=e?e:this.state.value,t.onChange=this._handleChange,l(t,this.state.initialValue)},componentDidUpdate:function(){var t=r.getValue(this);if(null!=t){var e=this.getDOMNode();o.setValueForProperty(e,"value",""+t)}},_handleChange:function(t){var e,n=r.getOnChange(this);return n&&(this._isChanging=!0,e=n.call(this,t),this._isChanging=!1),this.setState({value:t.target.value}),e}});e.exports=p},{"./AutoFocusMixin":1,"./DOMPropertyOperations":10,"./LinkedValueUtils":23,"./ReactBrowserComponentMixin":27,"./ReactCompositeComponent":33,"./ReactDOM":36,"./invariant":122,"./merge":131,"./warning":144}],47:[function(t,e){"use strict";function n(){this.reinitializeTransaction()}var o=t("./ReactUpdates"),r=t("./Transaction"),i=t("./emptyFunction"),a=t("./mixInto"),s={initialize:i,close:function(){p.isBatchingUpdates=!1}},u={initialize:i,close:o.flushBatchedUpdates.bind(o)},c=[u,s];a(n,r.Mixin),a(n,{getTransactionWrappers:function(){return c}});var l=new n,p={isBatchingUpdates:!1,batchedUpdates:function(t,e){var n=p.isBatchingUpdates;p.isBatchingUpdates=!0,n?t(e):l.perform(t,null,e)}};e.exports=p},{"./ReactUpdates":78,"./Transaction":93,"./emptyFunction":106,"./mixInto":134}],48:[function(t,e){"use strict";function n(){o.EventEmitter.injectTopLevelCallbackCreator(f),o.EventPluginHub.injectEventPluginOrder(c),o.EventPluginHub.injectInstanceHandle(D),o.EventPluginHub.injectMount(x),o.EventPluginHub.injectEventPluginsByName({SimpleEventPlugin:b,EnterLeaveEventPlugin:l,ChangeEventPlugin:a,CompositionEventPlugin:u,MobileSafariClickEventPlugin:p,SelectEventPlugin:P}),o.DOM.injectComponentClasses({button:v,form:g,img:y,input:C,option:E,select:R,textarea:M,html:S(m.html),head:S(m.head),title:S(m.title),body:S(m.body)}),o.CompositeComponent.injectMixin(d),o.DOMProperty.injectDOMPropertyConfig(i),o.Updates.injectBatchingStrategy(O),o.RootIndex.injectCreateReactRootIndex(r.canUseDOM?s.createReactRootIndex:T.createReactRootIndex),o.Component.injectEnvironment(h)}var o=t("./ReactInjection"),r=t("./ExecutionEnvironment"),i=t("./DefaultDOMPropertyConfig"),a=t("./ChangeEventPlugin"),s=t("./ClientReactRootIndex"),u=t("./CompositionEventPlugin"),c=t("./DefaultEventPluginOrder"),l=t("./EnterLeaveEventPlugin"),p=t("./MobileSafariClickEventPlugin"),d=t("./ReactBrowserComponentMixin"),h=t("./ReactComponentBrowserEnvironment"),f=t("./ReactEventTopLevelCallback"),m=t("./ReactDOM"),v=t("./ReactDOMButton"),g=t("./ReactDOMForm"),y=t("./ReactDOMImg"),C=t("./ReactDOMInput"),E=t("./ReactDOMOption"),R=t("./ReactDOMSelect"),M=t("./ReactDOMTextarea"),D=t("./ReactInstanceHandles"),x=t("./ReactMount"),P=t("./SelectEventPlugin"),T=t("./ServerReactRootIndex"),b=t("./SimpleEventPlugin"),O=t("./ReactDefaultBatchingStrategy"),S=t("./createFullPageComponent");e.exports={inject:n}},{"./ChangeEventPlugin":5,"./ClientReactRootIndex":6,"./CompositionEventPlugin":7,"./DefaultDOMPropertyConfig":12,"./DefaultEventPluginOrder":13,"./EnterLeaveEventPlugin":14,"./ExecutionEnvironment":21,"./MobileSafariClickEventPlugin":24,"./ReactBrowserComponentMixin":27,"./ReactComponentBrowserEnvironment":32,"./ReactDOM":36,"./ReactDOMButton":37,"./ReactDOMForm":39,"./ReactDOMImg":41,"./ReactDOMInput":42,"./ReactDOMOption":43,"./ReactDOMSelect":44,"./ReactDOMTextarea":46,"./ReactDefaultBatchingStrategy":47,"./ReactEventTopLevelCallback":52,"./ReactInjection":53,"./ReactInstanceHandles":55,"./ReactMount":58,"./SelectEventPlugin":80,"./ServerReactRootIndex":81,"./SimpleEventPlugin":82,"./createFullPageComponent":101}],49:[function(t,e){"use strict";var n={guard:function(t){return t}};e.exports=n},{}],50:[function(t,e){"use strict";function n(t){return null==t[C]&&(t[C]=g++,m[t[C]]={}),m[t[C]]}function o(t,e,n){a.listen(n,e,E.TopLevelCallbackCreator.createTopLevelCallback(t))}function r(t,e,n){a.capture(n,e,E.TopLevelCallbackCreator.createTopLevelCallback(t))}var i=t("./EventConstants"),a=t("./EventListener"),s=t("./EventPluginHub"),u=t("./EventPluginRegistry"),c=t("./ExecutionEnvironment"),l=t("./ReactEventEmitterMixin"),p=t("./ViewportMetrics"),d=t("./invariant"),h=t("./isEventSupported"),f=t("./merge"),m={},v=!1,g=0,y={topBlur:"blur",topChange:"change",topClick:"click",topCompositionEnd:"compositionend",topCompositionStart:"compositionstart",topCompositionUpdate:"compositionupdate",topContextMenu:"contextmenu",topCopy:"copy",topCut:"cut",topDoubleClick:"dblclick",topDrag:"drag",topDragEnd:"dragend",topDragEnter:"dragenter",topDragExit:"dragexit",topDragLeave:"dragleave",topDragOver:"dragover",topDragStart:"dragstart",topDrop:"drop",topFocus:"focus",topInput:"input",topKeyDown:"keydown",topKeyPress:"keypress",topKeyUp:"keyup",topMouseDown:"mousedown",topMouseMove:"mousemove",topMouseOut:"mouseout",topMouseOver:"mouseover",topMouseUp:"mouseup",topPaste:"paste",topScroll:"scroll",topSelectionChange:"selectionchange",topTouchCancel:"touchcancel",topTouchEnd:"touchend",topTouchMove:"touchmove",topTouchStart:"touchstart",topWheel:"wheel"},C="_reactListenersID"+String(Math.random()).slice(2),E=f(l,{TopLevelCallbackCreator:null,injection:{injectTopLevelCallbackCreator:function(t){E.TopLevelCallbackCreator=t
+}},setEnabled:function(t){d(c.canUseDOM),E.TopLevelCallbackCreator&&E.TopLevelCallbackCreator.setEnabled(t)},isEnabled:function(){return!(!E.TopLevelCallbackCreator||!E.TopLevelCallbackCreator.isEnabled())},listenTo:function(t,e){for(var a=e,s=n(a),c=u.registrationNameDependencies[t],l=i.topLevelTypes,p=0,d=c.length;d>p;p++){var f=c[p];if(!s[f]){var m=l[f];m===l.topWheel?h("wheel")?o(l.topWheel,"wheel",a):h("mousewheel")?o(l.topWheel,"mousewheel",a):o(l.topWheel,"DOMMouseScroll",a):m===l.topScroll?h("scroll",!0)?r(l.topScroll,"scroll",a):o(l.topScroll,"scroll",window):m===l.topFocus||m===l.topBlur?(h("focus",!0)?(r(l.topFocus,"focus",a),r(l.topBlur,"blur",a)):h("focusin")&&(o(l.topFocus,"focusin",a),o(l.topBlur,"focusout",a)),s[l.topBlur]=!0,s[l.topFocus]=!0):y[f]&&o(m,y[f],a),s[f]=!0}}},ensureScrollValueMonitoring:function(){if(!v){var t=p.refreshScrollValues;a.listen(window,"scroll",t),a.listen(window,"resize",t),v=!0}},eventNameDispatchConfigs:s.eventNameDispatchConfigs,registrationNameModules:s.registrationNameModules,putListener:s.putListener,getListener:s.getListener,deleteListener:s.deleteListener,deleteAllListeners:s.deleteAllListeners,trapBubbledEvent:o,trapCapturedEvent:r});e.exports=E},{"./EventConstants":15,"./EventListener":16,"./EventPluginHub":17,"./EventPluginRegistry":18,"./ExecutionEnvironment":21,"./ReactEventEmitterMixin":51,"./ViewportMetrics":94,"./invariant":122,"./isEventSupported":123,"./merge":131}],51:[function(t,e){"use strict";function n(t){o.enqueueEvents(t),o.processEventQueue()}var o=t("./EventPluginHub"),r=t("./ReactUpdates"),i={handleTopLevel:function(t,e,i,a){var s=o.extractEvents(t,e,i,a);r.batchedUpdates(n,s)}};e.exports=i},{"./EventPluginHub":17,"./ReactUpdates":78}],52:[function(t,e){"use strict";function n(t){var e=u.getID(t),n=s.getReactRootIDFromNodeID(e),o=u.findReactContainerForID(n),r=u.getFirstReactDOM(o);return r}function o(t,e,o){for(var r=u.getFirstReactDOM(c(e))||window,i=r;i;)o.ancestors.push(i),i=n(i);for(var s=0,l=o.ancestors.length;l>s;s++){r=o.ancestors[s];var p=u.getID(r)||"";a.handleTopLevel(t,r,p,e)}}function r(){this.ancestors=[]}var i=t("./PooledClass"),a=t("./ReactEventEmitter"),s=t("./ReactInstanceHandles"),u=t("./ReactMount"),c=t("./getEventTarget"),l=t("./mixInto"),p=!0;l(r,{destructor:function(){this.ancestors.length=0}}),i.addPoolingTo(r);var d={setEnabled:function(t){p=!!t},isEnabled:function(){return p},createTopLevelCallback:function(t){return function(e){if(p){var n=r.getPooled();try{o(t,e,n)}finally{r.release(n)}}}}};e.exports=d},{"./PooledClass":25,"./ReactEventEmitter":50,"./ReactInstanceHandles":55,"./ReactMount":58,"./getEventTarget":114,"./mixInto":134}],53:[function(t,e){"use strict";var n=t("./DOMProperty"),o=t("./EventPluginHub"),r=t("./ReactComponent"),i=t("./ReactCompositeComponent"),a=t("./ReactDOM"),s=t("./ReactEventEmitter"),u=t("./ReactPerf"),c=t("./ReactRootIndex"),l=t("./ReactUpdates"),p={Component:r.injection,CompositeComponent:i.injection,DOMProperty:n.injection,EventPluginHub:o.injection,DOM:a.injection,EventEmitter:s.injection,Perf:u.injection,RootIndex:c.injection,Updates:l.injection};e.exports=p},{"./DOMProperty":9,"./EventPluginHub":17,"./ReactComponent":31,"./ReactCompositeComponent":33,"./ReactDOM":36,"./ReactEventEmitter":50,"./ReactPerf":63,"./ReactRootIndex":70,"./ReactUpdates":78}],54:[function(t,e){"use strict";function n(t){return r(document.documentElement,t)}var o=t("./ReactDOMSelection"),r=t("./containsNode"),i=t("./focusNode"),a=t("./getActiveElement"),s={hasSelectionCapabilities:function(t){return t&&("INPUT"===t.nodeName&&"text"===t.type||"TEXTAREA"===t.nodeName||"true"===t.contentEditable)},getSelectionInformation:function(){var t=a();return{focusedElem:t,selectionRange:s.hasSelectionCapabilities(t)?s.getSelection(t):null}},restoreSelection:function(t){var e=a(),o=t.focusedElem,r=t.selectionRange;e!==o&&n(o)&&(s.hasSelectionCapabilities(o)&&s.setSelection(o,r),i(o))},getSelection:function(t){var e;if("selectionStart"in t)e={start:t.selectionStart,end:t.selectionEnd};else if(document.selection&&"INPUT"===t.nodeName){var n=document.selection.createRange();n.parentElement()===t&&(e={start:-n.moveStart("character",-t.value.length),end:-n.moveEnd("character",-t.value.length)})}else e=o.getOffsets(t);return e||{start:0,end:0}},setSelection:function(t,e){var n=e.start,r=e.end;if("undefined"==typeof r&&(r=n),"selectionStart"in t)t.selectionStart=n,t.selectionEnd=Math.min(r,t.value.length);else if(document.selection&&"INPUT"===t.nodeName){var i=t.createTextRange();i.collapse(!0),i.moveStart("character",n),i.moveEnd("character",r-n),i.select()}else o.setOffsets(t,e)}};e.exports=s},{"./ReactDOMSelection":45,"./containsNode":98,"./focusNode":110,"./getActiveElement":112}],55:[function(t,e){"use strict";function n(t){return d+t.toString(36)}function o(t,e){return t.charAt(e)===d||e===t.length}function r(t){return""===t||t.charAt(0)===d&&t.charAt(t.length-1)!==d}function i(t,e){return 0===e.indexOf(t)&&o(e,t.length)}function a(t){return t?t.substr(0,t.lastIndexOf(d)):""}function s(t,e){if(p(r(t)&&r(e)),p(i(t,e)),t===e)return t;for(var n=t.length+h,a=n;a<e.length&&!o(e,a);a++);return e.substr(0,a)}function u(t,e){var n=Math.min(t.length,e.length);if(0===n)return"";for(var i=0,a=0;n>=a;a++)if(o(t,a)&&o(e,a))i=a;else if(t.charAt(a)!==e.charAt(a))break;var s=t.substr(0,i);return p(r(s)),s}function c(t,e,n,o,r,u){t=t||"",e=e||"",p(t!==e);var c=i(e,t);p(c||i(t,e));for(var l=0,d=c?a:s,h=t;;h=d(h,e)){var m;if(r&&h===t||u&&h===e||(m=n(h,c,o)),m===!1||h===e)break;p(l++<f)}}var l=t("./ReactRootIndex"),p=t("./invariant"),d=".",h=d.length,f=100,m={createReactRootID:function(){return n(l.createReactRootIndex())},createReactID:function(t,e){return t+e},getReactRootIDFromNodeID:function(t){if(t&&t.charAt(0)===d&&t.length>1){var e=t.indexOf(d,1);return e>-1?t.substr(0,e):t}return null},traverseEnterLeave:function(t,e,n,o,r){var i=u(t,e);i!==t&&c(t,i,n,o,!1,!0),i!==e&&c(i,e,n,r,!0,!1)},traverseTwoPhase:function(t,e,n){t&&(c("",t,e,n,!0,!1),c(t,"",e,n,!1,!0))},traverseAncestors:function(t,e,n){c("",t,e,n,!0,!1)},_getFirstCommonAncestorID:u,_getNextDescendantID:s,isAncestorIDOf:i,SEPARATOR:d};e.exports=m},{"./ReactRootIndex":70,"./invariant":122}],56:[function(t,e){"use strict";function n(t,e){this.value=t,this.requestChange=e}e.exports=n},{}],57:[function(t,e){"use strict";var n=t("./adler32"),o={CHECKSUM_ATTR_NAME:"data-react-checksum",addChecksumToMarkup:function(t){var e=n(t);return t.replace(">"," "+o.CHECKSUM_ATTR_NAME+'="'+e+'">')},canReuseMarkup:function(t,e){var r=e.getAttribute(o.CHECKSUM_ATTR_NAME);r=r&&parseInt(r,10);var i=n(t);return i===r}};e.exports=o},{"./adler32":96}],58:[function(t,e){"use strict";function n(t){var e=v(t);return e&&S.getID(e)}function o(t){var e=r(t);if(e)if(M.hasOwnProperty(e)){var n=M[e];n!==t&&(y(!s(n,e)),M[e]=t)}else M[e]=t;return e}function r(t){return t&&t.getAttribute&&t.getAttribute(R)||""}function i(t,e){var n=r(t);n!==e&&delete M[n],t.setAttribute(R,e),M[e]=t}function a(t){return M.hasOwnProperty(t)&&s(M[t],t)||(M[t]=S.findReactNodeByID(t)),M[t]}function s(t,e){if(t){y(r(t)===e);var n=S.findReactContainerForID(e);if(n&&m(n,t))return!0}return!1}function u(t){delete M[t]}function c(t){var e=M[t];return e&&s(e,t)?void(O=e):!1}function l(t){O=null,h.traverseAncestors(t,c);var e=O;return O=null,e}var p=t("./DOMProperty"),d=t("./ReactEventEmitter"),h=t("./ReactInstanceHandles"),f=t("./ReactPerf"),m=t("./containsNode"),v=t("./getReactRootElementInContainer"),g=t("./instantiateReactComponent"),y=t("./invariant"),C=t("./shouldUpdateReactComponent"),E=h.SEPARATOR,R=p.ID_ATTRIBUTE_NAME,M={},D=1,x=9,P={},T={},b=[],O=null,S={totalInstantiationTime:0,totalInjectionTime:0,useTouchEvents:!1,_instancesByReactRootID:P,scrollMonitor:function(t,e){e()},_updateRootComponent:function(t,e,n,o){var r=e.props;return S.scrollMonitor(n,function(){t.replaceProps(r,o)}),t},_registerComponent:function(t,e){y(e&&(e.nodeType===D||e.nodeType===x)),d.ensureScrollValueMonitoring();var n=S.registerContainer(e);return P[n]=t,n},_renderNewRootComponent:f.measure("ReactMount","_renderNewRootComponent",function(t,e,n){var o=g(t),r=S._registerComponent(o,e);return o.mountComponentIntoNode(r,e,n),o}),renderComponent:function(t,e,o){var r=P[n(e)];if(r){if(C(r,t))return S._updateRootComponent(r,t,e,o);S.unmountComponentAtNode(e)}var i=v(e),a=i&&S.isRenderedByReact(i),s=a&&!r,u=S._renderNewRootComponent(t,e,s);return o&&o.call(u),u},constructAndRenderComponent:function(t,e,n){return S.renderComponent(t(e),n)},constructAndRenderComponentByID:function(t,e,n){var o=document.getElementById(n);return y(o),S.constructAndRenderComponent(t,e,o)},registerContainer:function(t){var e=n(t);return e&&(e=h.getReactRootIDFromNodeID(e)),e||(e=h.createReactRootID()),T[e]=t,e},unmountComponentAtNode:function(t){var e=n(t),o=P[e];return o?(S.unmountComponentFromNode(o,t),delete P[e],delete T[e],!0):!1},unmountComponentFromNode:function(t,e){for(t.unmountComponent(),e.nodeType===x&&(e=e.documentElement);e.lastChild;)e.removeChild(e.lastChild)},findReactContainerForID:function(t){var e=h.getReactRootIDFromNodeID(t),n=T[e];return n},findReactNodeByID:function(t){var e=S.findReactContainerForID(t);return S.findComponentRoot(e,t)},isRenderedByReact:function(t){if(1!==t.nodeType)return!1;var e=S.getID(t);return e?e.charAt(0)===E:!1},getFirstReactDOM:function(t){for(var e=t;e&&e.parentNode!==e;){if(S.isRenderedByReact(e))return e;e=e.parentNode}return null},findComponentRoot:function(t,e){var n=b,o=0,r=l(e)||t;for(n[0]=r.firstChild,n.length=1;o<n.length;){for(var i,a=n[o++];a;){var s=S.getID(a);s?e===s?i=a:h.isAncestorIDOf(s,e)&&(n.length=o=0,n.push(a.firstChild)):n.push(a.firstChild),a=a.nextSibling}if(i)return n.length=0,i}n.length=0,y(!1)},getReactRootID:n,getID:o,setID:i,getNode:a,purgeID:u};e.exports=S},{"./DOMProperty":9,"./ReactEventEmitter":50,"./ReactInstanceHandles":55,"./ReactPerf":63,"./containsNode":98,"./getReactRootElementInContainer":117,"./instantiateReactComponent":121,"./invariant":122,"./shouldUpdateReactComponent":140}],59:[function(t,e){"use strict";function n(t){this._queue=t||null}var o=t("./PooledClass"),r=t("./mixInto");r(n,{enqueue:function(t,e){this._queue=this._queue||[],this._queue.push({component:t,callback:e})},notifyAll:function(){var t=this._queue;if(t){this._queue=null;for(var e=0,n=t.length;n>e;e++){var o=t[e].component,r=t[e].callback;r.call(o)}t.length=0}},reset:function(){this._queue=null},destructor:function(){this.reset()}}),o.addPoolingTo(n),e.exports=n},{"./PooledClass":25,"./mixInto":134}],60:[function(t,e){"use strict";function n(t,e,n){f.push({parentID:t,parentNode:null,type:c.INSERT_MARKUP,markupIndex:m.push(e)-1,textContent:null,fromIndex:null,toIndex:n})}function o(t,e,n){f.push({parentID:t,parentNode:null,type:c.MOVE_EXISTING,markupIndex:null,textContent:null,fromIndex:e,toIndex:n})}function r(t,e){f.push({parentID:t,parentNode:null,type:c.REMOVE_NODE,markupIndex:null,textContent:null,fromIndex:e,toIndex:null})}function i(t,e){f.push({parentID:t,parentNode:null,type:c.TEXT_CONTENT,markupIndex:null,textContent:e,fromIndex:null,toIndex:null})}function a(){f.length&&(u.BackendIDOperations.dangerouslyProcessChildrenUpdates(f,m),s())}function s(){f.length=0,m.length=0}var u=t("./ReactComponent"),c=t("./ReactMultiChildUpdateTypes"),l=t("./flattenChildren"),p=t("./instantiateReactComponent"),d=t("./shouldUpdateReactComponent"),h=0,f=[],m=[],v={Mixin:{mountChildren:function(t,e){var n=l(t),o=[],r=0;this._renderedChildren=n;for(var i in n){var a=n[i];if(n.hasOwnProperty(i)){var s=p(a);n[i]=s;var u=this._rootNodeID+i,c=s.mountComponent(u,e,this._mountDepth+1);s._mountIndex=r,o.push(c),r++}}return o},updateTextContent:function(t){h++;var e=!0;try{var n=this._renderedChildren;for(var o in n)n.hasOwnProperty(o)&&this._unmountChildByName(n[o],o);this.setTextContent(t),e=!1}finally{h--,h||(e?s():a())}},updateChildren:function(t,e){h++;var n=!0;try{this._updateChildren(t,e),n=!1}finally{h--,h||(n?s():a())}},_updateChildren:function(t,e){var n=l(t),o=this._renderedChildren;if(n||o){var r,i=0,a=0;for(r in n)if(n.hasOwnProperty(r)){var s=o&&o[r],u=n[r];if(d(s,u))this.moveChild(s,a,i),i=Math.max(s._mountIndex,i),s.receiveComponent(u,e),s._mountIndex=a;else{s&&(i=Math.max(s._mountIndex,i),this._unmountChildByName(s,r));var c=p(u);this._mountChildByNameAtIndex(c,r,a,e)}a++}for(r in o)!o.hasOwnProperty(r)||n&&n[r]||this._unmountChildByName(o[r],r)}},unmountChildren:function(){var t=this._renderedChildren;for(var e in t){var n=t[e];n.unmountComponent&&n.unmountComponent()}this._renderedChildren=null},moveChild:function(t,e,n){t._mountIndex<n&&o(this._rootNodeID,t._mountIndex,e)},createChild:function(t,e){n(this._rootNodeID,e,t._mountIndex)},removeChild:function(t){r(this._rootNodeID,t._mountIndex)},setTextContent:function(t){i(this._rootNodeID,t)},_mountChildByNameAtIndex:function(t,e,n,o){var r=this._rootNodeID+e,i=t.mountComponent(r,o,this._mountDepth+1);t._mountIndex=n,this.createChild(t,i),this._renderedChildren=this._renderedChildren||{},this._renderedChildren[e]=t},_unmountChildByName:function(t,e){u.isValidComponent(t)&&(this.removeChild(t),t._mountIndex=null,t.unmountComponent(),delete this._renderedChildren[e])}}};e.exports=v},{"./ReactComponent":31,"./ReactMultiChildUpdateTypes":61,"./flattenChildren":109,"./instantiateReactComponent":121,"./shouldUpdateReactComponent":140}],61:[function(t,e){"use strict";var n=t("./keyMirror"),o=n({INSERT_MARKUP:null,MOVE_EXISTING:null,REMOVE_NODE:null,TEXT_CONTENT:null});e.exports=o},{"./keyMirror":128}],62:[function(t,e){"use strict";var n=t("./emptyObject"),o=t("./invariant"),r={isValidOwner:function(t){return!(!t||"function"!=typeof t.attachRef||"function"!=typeof t.detachRef)},addComponentAsRefTo:function(t,e,n){o(r.isValidOwner(n)),n.attachRef(e,t)},removeComponentAsRefFrom:function(t,e,n){o(r.isValidOwner(n)),n.refs[e]===t&&n.detachRef(e)},Mixin:{construct:function(){this.refs=n},attachRef:function(t,e){o(e.isOwnedBy(this));var r=this.refs===n?this.refs={}:this.refs;r[t]=e},detachRef:function(t){delete this.refs[t]}}};e.exports=r},{"./emptyObject":107,"./invariant":122}],63:[function(t,e){"use strict";function n(t,e,n){return n}var o={enableMeasure:!1,storedMeasure:n,measure:function(t,e,n){return n},injection:{injectMeasure:function(t){o.storedMeasure=t}}};e.exports=o},{}],64:[function(t,e){"use strict";function n(t){return function(e,n,o){e[n]=e.hasOwnProperty(n)?t(e[n],o):o}}var o=t("./emptyFunction"),r=t("./invariant"),i=t("./joinClasses"),a=t("./merge"),s={children:o,className:n(i),key:o,ref:o,style:n(a)},u={TransferStrategies:s,mergeProps:function(t,e){var n=a(t);for(var o in e)if(e.hasOwnProperty(o)){var r=s[o];r&&s.hasOwnProperty(o)?r(n,o,e[o]):n.hasOwnProperty(o)||(n[o]=e[o])}return n},Mixin:{transferPropsTo:function(t){return r(t._owner===this),t.props=u.mergeProps(t.props,this.props),t}}};e.exports=u},{"./emptyFunction":106,"./invariant":122,"./joinClasses":127,"./merge":131}],65:[function(t,e){"use strict";var n={};e.exports=n},{}],66:[function(t,e){"use strict";var n=t("./keyMirror"),o=n({prop:null,context:null,childContext:null});e.exports=o},{"./keyMirror":128}],67:[function(t,e){"use strict";function n(t){switch(typeof t){case"number":case"string":return!0;case"object":if(Array.isArray(t))return t.every(n);if(f.isValidComponent(t))return!0;for(var e in t)if(!n(t[e]))return!1;return!0;default:return!1}}function o(t){var e=typeof t;return"object"===e&&Array.isArray(t)?"array":e}function r(){function t(){return!0}return h(t)}function i(t){function e(e,n){var r=o(n),i=r===t;return i}return h(e)}function a(t){function e(t,e){var o=n[e];return o}var n=m(t);return h(e)}function s(t){function e(e,n,r,i,a){var s=o(n),u="object"===s;if(u)for(var c in t){var l=t[c];if(l&&!l(n,c,i,a))return!1}return u}return h(e)}function u(t){function e(e,n){var o=n instanceof t;return o}return h(e)}function c(t){function e(e,n,o,r,i){var a=Array.isArray(n);if(a)for(var s=0;s<n.length;s++)if(!t(n,s,r,i))return!1;return a}return h(e)}function l(){function t(t,e){var o=n(e);return o}return h(t)}function p(){function t(t,e){var n=f.isValidComponent(e);return n}return h(t)}function d(t){return function(e,n,o,r){for(var i=!1,a=0;a<t.length;a++){var s=t[a];if("function"==typeof s.weak&&(s=s.weak),s(e,n,o,r)){i=!0;break}}return i}}function h(t){function e(e,n,o,r,i,a){var s=o[r];if(null!=s)return t(n,s,r,i||g,a);var u=!e;return u}var n=e.bind(null,!1,!0);return n.weak=e.bind(null,!1,!1),n.isRequired=e.bind(null,!0,!0),n.weak.isRequired=e.bind(null,!0,!1),n.isRequired.weak=n.weak.isRequired,n}var f=t("./ReactComponent"),m=(t("./ReactPropTypeLocationNames"),t("./warning"),t("./createObjectFrom")),v={array:i("array"),bool:i("boolean"),func:i("function"),number:i("number"),object:i("object"),string:i("string"),shape:s,oneOf:a,oneOfType:d,arrayOf:c,instanceOf:u,renderable:l(),component:p(),any:r()},g="<<anonymous>>";e.exports=v},{"./ReactComponent":31,"./ReactPropTypeLocationNames":65,"./createObjectFrom":103,"./warning":144}],68:[function(t,e){"use strict";function n(){this.listenersToPut=[]}var o=t("./PooledClass"),r=t("./ReactEventEmitter"),i=t("./mixInto");i(n,{enqueuePutListener:function(t,e,n){this.listenersToPut.push({rootNodeID:t,propKey:e,propValue:n})},putListeners:function(){for(var t=0;t<this.listenersToPut.length;t++){var e=this.listenersToPut[t];r.putListener(e.rootNodeID,e.propKey,e.propValue)}},reset:function(){this.listenersToPut.length=0},destructor:function(){this.reset()}}),o.addPoolingTo(n),e.exports=n},{"./PooledClass":25,"./ReactEventEmitter":50,"./mixInto":134}],69:[function(t,e){"use strict";function n(){this.reinitializeTransaction(),this.renderToStaticMarkup=!1,this.reactMountReady=a.getPooled(null),this.putListenerQueue=s.getPooled()}var o=t("./PooledClass"),r=t("./ReactEventEmitter"),i=t("./ReactInputSelection"),a=t("./ReactMountReady"),s=t("./ReactPutListenerQueue"),u=t("./Transaction"),c=t("./mixInto"),l={initialize:i.getSelectionInformation,close:i.restoreSelection},p={initialize:function(){var t=r.isEnabled();return r.setEnabled(!1),t},close:function(t){r.setEnabled(t)}},d={initialize:function(){this.reactMountReady.reset()},close:function(){this.reactMountReady.notifyAll()}},h={initialize:function(){this.putListenerQueue.reset()},close:function(){this.putListenerQueue.putListeners()}},f=[h,l,p,d],m={getTransactionWrappers:function(){return f},getReactMountReady:function(){return this.reactMountReady},getPutListenerQueue:function(){return this.putListenerQueue},destructor:function(){a.release(this.reactMountReady),this.reactMountReady=null,s.release(this.putListenerQueue),this.putListenerQueue=null}};c(n,u.Mixin),c(n,m),o.addPoolingTo(n),e.exports=n},{"./PooledClass":25,"./ReactEventEmitter":50,"./ReactInputSelection":54,"./ReactMountReady":59,"./ReactPutListenerQueue":68,"./Transaction":93,"./mixInto":134}],70:[function(t,e){"use strict";var n={injectCreateReactRootIndex:function(t){o.createReactRootIndex=t}},o={createReactRootIndex:null,injection:n};e.exports=o},{}],71:[function(t,e){"use strict";function n(t){c(r.isValidComponent(t)),c(!(2===arguments.length&&"function"==typeof arguments[1]));var e;try{var n=i.createReactRootID();return e=s.getPooled(!1),e.perform(function(){var o=u(t),r=o.mountComponent(n,e,0);return a.addChecksumToMarkup(r)},null)}finally{s.release(e)}}function o(t){c(r.isValidComponent(t));var e;try{var n=i.createReactRootID();return e=s.getPooled(!0),e.perform(function(){var o=u(t);return o.mountComponent(n,e,0)},null)}finally{s.release(e)}}var r=t("./ReactComponent"),i=t("./ReactInstanceHandles"),a=t("./ReactMarkupChecksum"),s=t("./ReactServerRenderingTransaction"),u=t("./instantiateReactComponent"),c=t("./invariant");e.exports={renderComponentToString:n,renderComponentToStaticMarkup:o}},{"./ReactComponent":31,"./ReactInstanceHandles":55,"./ReactMarkupChecksum":57,"./ReactServerRenderingTransaction":72,"./instantiateReactComponent":121,"./invariant":122}],72:[function(t,e){"use strict";function n(t){this.reinitializeTransaction(),this.renderToStaticMarkup=t,this.reactMountReady=r.getPooled(null),this.putListenerQueue=i.getPooled()}var o=t("./PooledClass"),r=t("./ReactMountReady"),i=t("./ReactPutListenerQueue"),a=t("./Transaction"),s=t("./emptyFunction"),u=t("./mixInto"),c={initialize:function(){this.reactMountReady.reset()},close:s},l={initialize:function(){this.putListenerQueue.reset()},close:s},p=[l,c],d={getTransactionWrappers:function(){return p},getReactMountReady:function(){return this.reactMountReady},getPutListenerQueue:function(){return this.putListenerQueue},destructor:function(){r.release(this.reactMountReady),this.reactMountReady=null,i.release(this.putListenerQueue),this.putListenerQueue=null}};u(n,a.Mixin),u(n,d),o.addPoolingTo(n),e.exports=n},{"./PooledClass":25,"./ReactMountReady":59,"./ReactPutListenerQueue":68,"./Transaction":93,"./emptyFunction":106,"./mixInto":134}],73:[function(t,e){"use strict";function n(t,e){var n={};return function(o){n[e]=o,t.setState(n)}}var o={createStateSetter:function(t,e){return function(n,o,r,i,a,s){var u=e.call(t,n,o,r,i,a,s);u&&t.setState(u)}},createStateKeySetter:function(t,e){var o=t.__keySetters||(t.__keySetters={});return o[e]||(o[e]=n(t,e))}};o.Mixin={createStateSetter:function(t){return o.createStateSetter(this,t)},createStateKeySetter:function(t){return o.createStateKeySetter(this,t)}},e.exports=o},{}],74:[function(t,e){"use strict";var n=t("./DOMPropertyOperations"),o=t("./ReactBrowserComponentMixin"),r=t("./ReactComponent"),i=t("./escapeTextForBrowser"),a=t("./mixInto"),s=function(t){this.construct({text:t})};s.ConvenienceConstructor=function(t){return new s(t.text)},a(s,r.Mixin),a(s,o),a(s,{mountComponent:function(t,e,o){r.Mixin.mountComponent.call(this,t,e,o);var a=i(this.props.text);return e.renderToStaticMarkup?a:"<span "+n.createMarkupForID(t)+">"+a+"</span>"},receiveComponent:function(t){var e=t.props;e.text!==this.props.text&&(this.props.text=e.text,r.BackendIDOperations.updateTextContentByID(this._rootNodeID,e.text))}}),s.type=s,s.prototype.type=s,e.exports=s},{"./DOMPropertyOperations":10,"./ReactBrowserComponentMixin":27,"./ReactComponent":31,"./escapeTextForBrowser":108,"./mixInto":134}],75:[function(t,e){"use strict";var n=t("./ReactChildren"),o={getChildMapping:function(t){return n.map(t,function(t){return t})},mergeChildMappings:function(t,e){function n(n){return e.hasOwnProperty(n)?e[n]:t[n]}t=t||{},e=e||{};var o={},r=[];for(var i in t)e[i]?r.length&&(o[i]=r,r=[]):r.push(i);var a,s={};for(var u in e){if(o[u])for(a=0;a<o[u].length;a++){var c=o[u][a];s[o[u][a]]=n(c)}s[u]=n(u)}for(a=0;a<r.length;a++)s[r[a]]=n(r[a]);return s}};e.exports=o},{"./ReactChildren":30}],76:[function(t,e){"use strict";function n(){var t=document.createElement("div"),e=t.style;for(var n in a){var o=a[n];for(var r in o)if(r in e){s.push(o[r]);break}}}function o(t,e,n){t.addEventListener(e,n,!1)}function r(t,e,n){t.removeEventListener(e,n,!1)}var i=t("./ExecutionEnvironment"),a={transitionend:{transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"mozTransitionEnd",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd"},animationend:{animation:"animationend",WebkitAnimation:"webkitAnimationEnd",MozAnimation:"mozAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd"}},s=[];i.canUseDOM&&n();var u={addEndEventListener:function(t,e){return 0===s.length?void window.setTimeout(e,0):void s.forEach(function(n){o(t,n,e)})},removeEndEventListener:function(t,e){0!==s.length&&s.forEach(function(n){r(t,n,e)})}};e.exports=u},{"./ExecutionEnvironment":21}],77:[function(t,e){"use strict";var n=t("./React"),o=t("./ReactTransitionChildMapping"),r=t("./cloneWithProps"),i=t("./emptyFunction"),a=t("./merge"),s=n.createClass({propTypes:{component:n.PropTypes.func,childFactory:n.PropTypes.func},getDefaultProps:function(){return{component:n.DOM.span,childFactory:i.thatReturnsArgument}},getInitialState:function(){return{children:o.getChildMapping(this.props.children)}},componentWillReceiveProps:function(t){var e=o.getChildMapping(t.children),n=this.state.children;this.setState({children:o.mergeChildMappings(n,e)});var r;for(r in e)n.hasOwnProperty(r)||this.currentlyTransitioningKeys[r]||this.keysToEnter.push(r);for(r in n)e.hasOwnProperty(r)||this.currentlyTransitioningKeys[r]||this.keysToLeave.push(r)},componentWillMount:function(){this.currentlyTransitioningKeys={},this.keysToEnter=[],this.keysToLeave=[]},componentDidUpdate:function(){var t=this.keysToEnter;this.keysToEnter=[],t.forEach(this.performEnter);var e=this.keysToLeave;this.keysToLeave=[],e.forEach(this.performLeave)},performEnter:function(t){this.currentlyTransitioningKeys[t]=!0;var e=this.refs[t];e.componentWillEnter?e.componentWillEnter(this._handleDoneEntering.bind(this,t)):this._handleDoneEntering(t)},_handleDoneEntering:function(t){var e=this.refs[t];e.componentDidEnter&&e.componentDidEnter(),delete this.currentlyTransitioningKeys[t];var n=o.getChildMapping(this.props.children);n.hasOwnProperty(t)||this.performLeave(t)},performLeave:function(t){this.currentlyTransitioningKeys[t]=!0;var e=this.refs[t];e.componentWillLeave?e.componentWillLeave(this._handleDoneLeaving.bind(this,t)):this._handleDoneLeaving(t)},_handleDoneLeaving:function(t){var e=this.refs[t];e.componentDidLeave&&e.componentDidLeave(),delete this.currentlyTransitioningKeys[t];var n=o.getChildMapping(this.props.children);if(n.hasOwnProperty(t))this.performEnter(t);else{var r=a(this.state.children);delete r[t],this.setState({children:r})}},render:function(){var t={};for(var e in this.state.children){var n=this.state.children[e];n&&(t[e]=r(this.props.childFactory(n),{ref:e}))}return this.transferPropsTo(this.props.component(null,t))}});e.exports=s},{"./React":26,"./ReactTransitionChildMapping":75,"./cloneWithProps":97,"./emptyFunction":106,"./merge":131}],78:[function(t,e){"use strict";function n(){c(p)}function o(t,e){n(),p.batchedUpdates(t,e)}function r(t,e){return t._mountDepth-e._mountDepth}function i(){l.sort(r);for(var t=0;t<l.length;t++){var e=l[t];if(e.isMounted()){var n=e._pendingCallbacks;if(e._pendingCallbacks=null,e.performUpdateIfNecessary(),n)for(var o=0;o<n.length;o++)n[o].call(e)}}}function a(){l.length=0}function s(t,e){return c(!e||"function"==typeof e),n(),p.isBatchingUpdates?(l.push(t),void(e&&(t._pendingCallbacks?t._pendingCallbacks.push(e):t._pendingCallbacks=[e]))):(t.performUpdateIfNecessary(),void(e&&e.call(t)))}var u=t("./ReactPerf"),c=t("./invariant"),l=[],p=null,d=u.measure("ReactUpdates","flushBatchedUpdates",function(){try{i()}finally{a()}}),h={injectBatchingStrategy:function(t){c(t),c("function"==typeof t.batchedUpdates),c("boolean"==typeof t.isBatchingUpdates),p=t}},f={batchedUpdates:o,enqueueUpdate:s,flushBatchedUpdates:d,injection:h};e.exports=f},{"./ReactPerf":63,"./invariant":122}],79:[function(t,e){"use strict";var n=t("./LinkedStateMixin"),o=t("./React"),r=t("./ReactCSSTransitionGroup"),i=t("./ReactTransitionGroup"),r=t("./ReactCSSTransitionGroup"),a=t("./cx"),s=t("./cloneWithProps"),u=t("./update");o.addons={LinkedStateMixin:n,CSSTransitionGroup:r,TransitionGroup:i,classSet:a,cloneWithProps:s,update:u},e.exports=o},{"./LinkedStateMixin":22,"./React":26,"./ReactCSSTransitionGroup":28,"./ReactTransitionGroup":77,"./cloneWithProps":97,"./cx":104,"./update":143}],80:[function(t,e){"use strict";function n(t){if("selectionStart"in t&&a.hasSelectionCapabilities(t))return{start:t.selectionStart,end:t.selectionEnd};if(document.selection){var e=document.selection.createRange();return{parentElement:e.parentElement(),text:e.text,top:e.boundingTop,left:e.boundingLeft}}var n=window.getSelection();return{anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}}function o(t){if(!g&&null!=f&&f==u()){var e=n(f);if(!v||!p(v,e)){v=e;var o=s.getPooled(h.select,m,t);return o.type="select",o.target=f,i.accumulateTwoPhaseDispatches(o),o}}}var r=t("./EventConstants"),i=t("./EventPropagators"),a=t("./ReactInputSelection"),s=t("./SyntheticEvent"),u=t("./getActiveElement"),c=t("./isTextInputElement"),l=t("./keyOf"),p=t("./shallowEqual"),d=r.topLevelTypes,h={select:{phasedRegistrationNames:{bubbled:l({onSelect:null}),captured:l({onSelectCapture:null})},dependencies:[d.topBlur,d.topContextMenu,d.topFocus,d.topKeyDown,d.topMouseDown,d.topMouseUp,d.topSelectionChange]}},f=null,m=null,v=null,g=!1,y={eventTypes:h,extractEvents:function(t,e,n,r){switch(t){case d.topFocus:(c(e)||"true"===e.contentEditable)&&(f=e,m=n,v=null);break;case d.topBlur:f=null,m=null,v=null;break;case d.topMouseDown:g=!0;break;case d.topContextMenu:case d.topMouseUp:return g=!1,o(r);case d.topSelectionChange:case d.topKeyDown:case d.topKeyUp:return o(r)}}};e.exports=y},{"./EventConstants":15,"./EventPropagators":20,"./ReactInputSelection":54,"./SyntheticEvent":86,"./getActiveElement":112,"./isTextInputElement":125,"./keyOf":129,"./shallowEqual":139}],81:[function(t,e){"use strict";var n=Math.pow(2,53),o={createReactRootIndex:function(){return Math.ceil(Math.random()*n)}};e.exports=o},{}],82:[function(t,e){"use strict";var n=t("./EventConstants"),o=t("./EventPluginUtils"),r=t("./EventPropagators"),i=t("./SyntheticClipboardEvent"),a=t("./SyntheticEvent"),s=t("./SyntheticFocusEvent"),u=t("./SyntheticKeyboardEvent"),c=t("./SyntheticMouseEvent"),l=t("./SyntheticDragEvent"),p=t("./SyntheticTouchEvent"),d=t("./SyntheticUIEvent"),h=t("./SyntheticWheelEvent"),f=t("./invariant"),m=t("./keyOf"),v=n.topLevelTypes,g={blur:{phasedRegistrationNames:{bubbled:m({onBlur:!0}),captured:m({onBlurCapture:!0})}},click:{phasedRegistrationNames:{bubbled:m({onClick:!0}),captured:m({onClickCapture:!0})}},contextMenu:{phasedRegistrationNames:{bubbled:m({onContextMenu:!0}),captured:m({onContextMenuCapture:!0})}},copy:{phasedRegistrationNames:{bubbled:m({onCopy:!0}),captured:m({onCopyCapture:!0})}},cut:{phasedRegistrationNames:{bubbled:m({onCut:!0}),captured:m({onCutCapture:!0})}},doubleClick:{phasedRegistrationNames:{bubbled:m({onDoubleClick:!0}),captured:m({onDoubleClickCapture:!0})}},drag:{phasedRegistrationNames:{bubbled:m({onDrag:!0}),captured:m({onDragCapture:!0})}},dragEnd:{phasedRegistrationNames:{bubbled:m({onDragEnd:!0}),captured:m({onDragEndCapture:!0})}},dragEnter:{phasedRegistrationNames:{bubbled:m({onDragEnter:!0}),captured:m({onDragEnterCapture:!0})}},dragExit:{phasedRegistrationNames:{bubbled:m({onDragExit:!0}),captured:m({onDragExitCapture:!0})}},dragLeave:{phasedRegistrationNames:{bubbled:m({onDragLeave:!0}),captured:m({onDragLeaveCapture:!0})}},dragOver:{phasedRegistrationNames:{bubbled:m({onDragOver:!0}),captured:m({onDragOverCapture:!0})}},dragStart:{phasedRegistrationNames:{bubbled:m({onDragStart:!0}),captured:m({onDragStartCapture:!0})}},drop:{phasedRegistrationNames:{bubbled:m({onDrop:!0}),captured:m({onDropCapture:!0})}},focus:{phasedRegistrationNames:{bubbled:m({onFocus:!0}),captured:m({onFocusCapture:!0})}},input:{phasedRegistrationNames:{bubbled:m({onInput:!0}),captured:m({onInputCapture:!0})}},keyDown:{phasedRegistrationNames:{bubbled:m({onKeyDown:!0}),captured:m({onKeyDownCapture:!0})}},keyPress:{phasedRegistrationNames:{bubbled:m({onKeyPress:!0}),captured:m({onKeyPressCapture:!0})}},keyUp:{phasedRegistrationNames:{bubbled:m({onKeyUp:!0}),captured:m({onKeyUpCapture:!0})}},load:{phasedRegistrationNames:{bubbled:m({onLoad:!0}),captured:m({onLoadCapture:!0})}},error:{phasedRegistrationNames:{bubbled:m({onError:!0}),captured:m({onErrorCapture:!0})}},mouseDown:{phasedRegistrationNames:{bubbled:m({onMouseDown:!0}),captured:m({onMouseDownCapture:!0})}},mouseMove:{phasedRegistrationNames:{bubbled:m({onMouseMove:!0}),captured:m({onMouseMoveCapture:!0})}},mouseOut:{phasedRegistrationNames:{bubbled:m({onMouseOut:!0}),captured:m({onMouseOutCapture:!0})}},mouseOver:{phasedRegistrationNames:{bubbled:m({onMouseOver:!0}),captured:m({onMouseOverCapture:!0})}},mouseUp:{phasedRegistrationNames:{bubbled:m({onMouseUp:!0}),captured:m({onMouseUpCapture:!0})}},paste:{phasedRegistrationNames:{bubbled:m({onPaste:!0}),captured:m({onPasteCapture:!0})}},reset:{phasedRegistrationNames:{bubbled:m({onReset:!0}),captured:m({onResetCapture:!0})}},scroll:{phasedRegistrationNames:{bubbled:m({onScroll:!0}),captured:m({onScrollCapture:!0})}},submit:{phasedRegistrationNames:{bubbled:m({onSubmit:!0}),captured:m({onSubmitCapture:!0})}},touchCancel:{phasedRegistrationNames:{bubbled:m({onTouchCancel:!0}),captured:m({onTouchCancelCapture:!0})}},touchEnd:{phasedRegistrationNames:{bubbled:m({onTouchEnd:!0}),captured:m({onTouchEndCapture:!0})}},touchMove:{phasedRegistrationNames:{bubbled:m({onTouchMove:!0}),captured:m({onTouchMoveCapture:!0})}},touchStart:{phasedRegistrationNames:{bubbled:m({onTouchStart:!0}),captured:m({onTouchStartCapture:!0})}},wheel:{phasedRegistrationNames:{bubbled:m({onWheel:!0}),captured:m({onWheelCapture:!0})}}},y={topBlur:g.blur,topClick:g.click,topContextMenu:g.contextMenu,topCopy:g.copy,topCut:g.cut,topDoubleClick:g.doubleClick,topDrag:g.drag,topDragEnd:g.dragEnd,topDragEnter:g.dragEnter,topDragExit:g.dragExit,topDragLeave:g.dragLeave,topDragOver:g.dragOver,topDragStart:g.dragStart,topDrop:g.drop,topError:g.error,topFocus:g.focus,topInput:g.input,topKeyDown:g.keyDown,topKeyPress:g.keyPress,topKeyUp:g.keyUp,topLoad:g.load,topMouseDown:g.mouseDown,topMouseMove:g.mouseMove,topMouseOut:g.mouseOut,topMouseOver:g.mouseOver,topMouseUp:g.mouseUp,topPaste:g.paste,topReset:g.reset,topScroll:g.scroll,topSubmit:g.submit,topTouchCancel:g.touchCancel,topTouchEnd:g.touchEnd,topTouchMove:g.touchMove,topTouchStart:g.touchStart,topWheel:g.wheel};
+for(var C in y)y[C].dependencies=[C];var E={eventTypes:g,executeDispatch:function(t,e,n){var r=o.executeDispatch(t,e,n);r===!1&&(t.stopPropagation(),t.preventDefault())},extractEvents:function(t,e,n,o){var m=y[t];if(!m)return null;var g;switch(t){case v.topInput:case v.topLoad:case v.topError:case v.topReset:case v.topSubmit:g=a;break;case v.topKeyDown:case v.topKeyPress:case v.topKeyUp:g=u;break;case v.topBlur:case v.topFocus:g=s;break;case v.topClick:if(2===o.button)return null;case v.topContextMenu:case v.topDoubleClick:case v.topMouseDown:case v.topMouseMove:case v.topMouseOut:case v.topMouseOver:case v.topMouseUp:g=c;break;case v.topDrag:case v.topDragEnd:case v.topDragEnter:case v.topDragExit:case v.topDragLeave:case v.topDragOver:case v.topDragStart:case v.topDrop:g=l;break;case v.topTouchCancel:case v.topTouchEnd:case v.topTouchMove:case v.topTouchStart:g=p;break;case v.topScroll:g=d;break;case v.topWheel:g=h;break;case v.topCopy:case v.topCut:case v.topPaste:g=i}f(g);var C=g.getPooled(m,n,o);return r.accumulateTwoPhaseDispatches(C),C}};e.exports=E},{"./EventConstants":15,"./EventPluginUtils":19,"./EventPropagators":20,"./SyntheticClipboardEvent":83,"./SyntheticDragEvent":85,"./SyntheticEvent":86,"./SyntheticFocusEvent":87,"./SyntheticKeyboardEvent":88,"./SyntheticMouseEvent":89,"./SyntheticTouchEvent":90,"./SyntheticUIEvent":91,"./SyntheticWheelEvent":92,"./invariant":122,"./keyOf":129}],83:[function(t,e){"use strict";function n(t,e,n){o.call(this,t,e,n)}var o=t("./SyntheticEvent"),r={clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}};o.augmentClass(n,r),e.exports=n},{"./SyntheticEvent":86}],84:[function(t,e){"use strict";function n(t,e,n){o.call(this,t,e,n)}var o=t("./SyntheticEvent"),r={data:null};o.augmentClass(n,r),e.exports=n},{"./SyntheticEvent":86}],85:[function(t,e){"use strict";function n(t,e,n){o.call(this,t,e,n)}var o=t("./SyntheticMouseEvent"),r={dataTransfer:null};o.augmentClass(n,r),e.exports=n},{"./SyntheticMouseEvent":89}],86:[function(t,e){"use strict";function n(t,e,n){this.dispatchConfig=t,this.dispatchMarker=e,this.nativeEvent=n;var o=this.constructor.Interface;for(var i in o)if(o.hasOwnProperty(i)){var a=o[i];this[i]=a?a(n):n[i]}var s=null!=n.defaultPrevented?n.defaultPrevented:n.returnValue===!1;this.isDefaultPrevented=s?r.thatReturnsTrue:r.thatReturnsFalse,this.isPropagationStopped=r.thatReturnsFalse}var o=t("./PooledClass"),r=t("./emptyFunction"),i=t("./getEventTarget"),a=t("./merge"),s=t("./mergeInto"),u={type:null,target:i,currentTarget:r.thatReturnsNull,eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null};s(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t.preventDefault?t.preventDefault():t.returnValue=!1,this.isDefaultPrevented=r.thatReturnsTrue},stopPropagation:function(){var t=this.nativeEvent;t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,this.isPropagationStopped=r.thatReturnsTrue},persist:function(){this.isPersistent=r.thatReturnsTrue},isPersistent:r.thatReturnsFalse,destructor:function(){var t=this.constructor.Interface;for(var e in t)this[e]=null;this.dispatchConfig=null,this.dispatchMarker=null,this.nativeEvent=null}}),n.Interface=u,n.augmentClass=function(t,e){var n=this,r=Object.create(n.prototype);s(r,t.prototype),t.prototype=r,t.prototype.constructor=t,t.Interface=a(n.Interface,e),t.augmentClass=n.augmentClass,o.addPoolingTo(t,o.threeArgumentPooler)},o.addPoolingTo(n,o.threeArgumentPooler),e.exports=n},{"./PooledClass":25,"./emptyFunction":106,"./getEventTarget":114,"./merge":131,"./mergeInto":133}],87:[function(t,e){"use strict";function n(t,e,n){o.call(this,t,e,n)}var o=t("./SyntheticUIEvent"),r={relatedTarget:null};o.augmentClass(n,r),e.exports=n},{"./SyntheticUIEvent":91}],88:[function(t,e){"use strict";function n(t,e,n){o.call(this,t,e,n)}var o=t("./SyntheticUIEvent"),r=t("./getEventKey"),i={key:r,location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,"char":null,charCode:null,keyCode:null,which:null};o.augmentClass(n,i),e.exports=n},{"./SyntheticUIEvent":91,"./getEventKey":113}],89:[function(t,e){"use strict";function n(t,e,n){o.call(this,t,e,n)}var o=t("./SyntheticUIEvent"),r=t("./ViewportMetrics"),i={screenX:null,screenY:null,clientX:null,clientY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,button:function(t){var e=t.button;return"which"in t?e:2===e?2:4===e?1:0},buttons:null,relatedTarget:function(t){return t.relatedTarget||(t.fromElement===t.srcElement?t.toElement:t.fromElement)},pageX:function(t){return"pageX"in t?t.pageX:t.clientX+r.currentScrollLeft},pageY:function(t){return"pageY"in t?t.pageY:t.clientY+r.currentScrollTop}};o.augmentClass(n,i),e.exports=n},{"./SyntheticUIEvent":91,"./ViewportMetrics":94}],90:[function(t,e){"use strict";function n(t,e,n){o.call(this,t,e,n)}var o=t("./SyntheticUIEvent"),r={touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null};o.augmentClass(n,r),e.exports=n},{"./SyntheticUIEvent":91}],91:[function(t,e){"use strict";function n(t,e,n){o.call(this,t,e,n)}var o=t("./SyntheticEvent"),r={view:null,detail:null};o.augmentClass(n,r),e.exports=n},{"./SyntheticEvent":86}],92:[function(t,e){"use strict";function n(t,e,n){o.call(this,t,e,n)}var o=t("./SyntheticMouseEvent"),r={deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:null,deltaMode:null};o.augmentClass(n,r),e.exports=n},{"./SyntheticMouseEvent":89}],93:[function(t,e){"use strict";var n=t("./invariant"),o={reinitializeTransaction:function(){this.transactionWrappers=this.getTransactionWrappers(),this.wrapperInitData?this.wrapperInitData.length=0:this.wrapperInitData=[],this.timingMetrics||(this.timingMetrics={}),this.timingMetrics.methodInvocationTime=0,this.timingMetrics.wrapperInitTimes?this.timingMetrics.wrapperInitTimes.length=0:this.timingMetrics.wrapperInitTimes=[],this.timingMetrics.wrapperCloseTimes?this.timingMetrics.wrapperCloseTimes.length=0:this.timingMetrics.wrapperCloseTimes=[],this._isInTransaction=!1},_isInTransaction:!1,getTransactionWrappers:null,isInTransaction:function(){return!!this._isInTransaction},perform:function(t,e,o,r,i,a,s,u){n(!this.isInTransaction());var c,l,p=Date.now();try{this._isInTransaction=!0,c=!0,this.initializeAll(0),l=t.call(e,o,r,i,a,s,u),c=!1}finally{var d=Date.now();this.methodInvocationTime+=d-p;try{if(c)try{this.closeAll(0)}catch(h){}else this.closeAll(0)}finally{this._isInTransaction=!1}}return l},initializeAll:function(t){for(var e=this.transactionWrappers,n=this.timingMetrics.wrapperInitTimes,o=t;o<e.length;o++){var i=Date.now(),a=e[o];try{this.wrapperInitData[o]=r.OBSERVED_ERROR,this.wrapperInitData[o]=a.initialize?a.initialize.call(this):null}finally{var s=n[o],u=Date.now();if(n[o]=(s||0)+(u-i),this.wrapperInitData[o]===r.OBSERVED_ERROR)try{this.initializeAll(o+1)}catch(c){}}}},closeAll:function(t){n(this.isInTransaction());for(var e=this.transactionWrappers,o=this.timingMetrics.wrapperCloseTimes,i=t;i<e.length;i++){var a,s=e[i],u=Date.now(),c=this.wrapperInitData[i];try{a=!0,c!==r.OBSERVED_ERROR&&s.close&&s.close.call(this,c),a=!1}finally{var l=Date.now(),p=o[i];if(o[i]=(p||0)+(l-u),a)try{this.closeAll(i+1)}catch(d){}}}this.wrapperInitData.length=0}},r={Mixin:o,OBSERVED_ERROR:{}};e.exports=r},{"./invariant":122}],94:[function(t,e){"use strict";var n=t("./getUnboundedScrollPosition"),o={currentScrollLeft:0,currentScrollTop:0,refreshScrollValues:function(){var t=n(window);o.currentScrollLeft=t.x,o.currentScrollTop=t.y}};e.exports=o},{"./getUnboundedScrollPosition":119}],95:[function(t,e){"use strict";function n(t,e){if(o(null!=e),null==t)return e;var n=Array.isArray(t),r=Array.isArray(e);return n?t.concat(e):r?[t].concat(e):[t,e]}var o=t("./invariant");e.exports=n},{"./invariant":122}],96:[function(t,e){"use strict";function n(t){for(var e=1,n=0,r=0;r<t.length;r++)e=(e+t.charCodeAt(r))%o,n=(n+e)%o;return e|n<<16}var o=65521;e.exports=n},{}],97:[function(t,e){"use strict";function n(t,e){var n=o.mergeProps(e,t.props);return!n.hasOwnProperty(i)&&t.props.hasOwnProperty(i)&&(n.children=t.props.children),t.constructor.ConvenienceConstructor(n)}var o=t("./ReactPropTransferer"),r=t("./keyOf"),i=(t("./warning"),r({children:null}));e.exports=n},{"./ReactPropTransferer":64,"./keyOf":129,"./warning":144}],98:[function(t,e){function n(t,e){return t&&e?t===e?!0:o(t)?!1:o(e)?n(t,e.parentNode):t.contains?t.contains(e):t.compareDocumentPosition?!!(16&t.compareDocumentPosition(e)):!1:!1}var o=t("./isTextNode");e.exports=n},{"./isTextNode":126}],99:[function(t,e){function n(t,e,n,o,r,i){t=t||{};for(var a,s=[e,n,o,r,i],u=0;s[u];){a=s[u++];for(var c in a)t[c]=a[c];a.hasOwnProperty&&a.hasOwnProperty("toString")&&"undefined"!=typeof a.toString&&t.toString!==a.toString&&(t.toString=a.toString)}return t}e.exports=n},{}],100:[function(t,e){function n(t){return!!t&&("object"==typeof t||"function"==typeof t)&&"length"in t&&!("setInterval"in t)&&"number"!=typeof t.nodeType&&(Array.isArray(t)||"callee"in t||"item"in t)}function o(t){return n(t)?Array.isArray(t)?t.slice():r(t):[t]}var r=t("./toArray");e.exports=o},{"./toArray":141}],101:[function(t,e){"use strict";function n(t){var e=o.createClass({displayName:"ReactFullPageComponent"+(t.componentConstructor.displayName||""),componentWillUnmount:function(){r(!1)},render:function(){return this.transferPropsTo(t(null,this.props.children))}});return e}var o=t("./ReactCompositeComponent"),r=t("./invariant");e.exports=n},{"./ReactCompositeComponent":33,"./invariant":122}],102:[function(t,e){function n(t){var e=t.match(c);return e&&e[1].toLowerCase()}function o(t,e){var o=u;s(!!u);var r=n(t),c=r&&a(r);if(c){o.innerHTML=c[1]+t+c[2];for(var l=c[0];l--;)o=o.lastChild}else o.innerHTML=t;var p=o.getElementsByTagName("script");p.length&&(s(e),i(p).forEach(e));for(var d=i(o.childNodes);o.lastChild;)o.removeChild(o.lastChild);return d}var r=t("./ExecutionEnvironment"),i=t("./createArrayFrom"),a=t("./getMarkupWrap"),s=t("./invariant"),u=r.canUseDOM?document.createElement("div"):null,c=/^\s*<(\w+)/;e.exports=o},{"./ExecutionEnvironment":21,"./createArrayFrom":100,"./getMarkupWrap":115,"./invariant":122}],103:[function(t,e){function n(t,e){var n={},o=Array.isArray(e);"undefined"==typeof e&&(e=!0);for(var r=t.length;r--;)n[t[r]]=o?e[r]:e;return n}e.exports=n},{}],104:[function(t,e){function n(t){return"object"==typeof t?Object.keys(t).filter(function(e){return t[e]}).join(" "):Array.prototype.join.call(arguments," ")}e.exports=n},{}],105:[function(t,e){"use strict";function n(t,e){var n=null==e||"boolean"==typeof e||""===e;if(n)return"";var r=isNaN(e);return r||0===e||o.isUnitlessNumber[t]?""+e:e+"px"}var o=t("./CSSProperty");e.exports=n},{"./CSSProperty":3}],106:[function(t,e){function n(t){return function(){return t}}function o(){}var r=t("./copyProperties");r(o,{thatReturns:n,thatReturnsFalse:n(!1),thatReturnsTrue:n(!0),thatReturnsNull:n(null),thatReturnsThis:function(){return this},thatReturnsArgument:function(t){return t}}),e.exports=o},{"./copyProperties":99}],107:[function(t,e){"use strict";var n={};e.exports=n},{}],108:[function(t,e){"use strict";function n(t){return r[t]}function o(t){return(""+t).replace(i,n)}var r={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;","/":"&#x2f;"},i=/[&><"'\/]/g;e.exports=o},{}],109:[function(t,e){"use strict";function n(t,e,n){var o=t;r(!o.hasOwnProperty(n)),null!=e&&(o[n]=e)}function o(t){if(null==t)return t;var e={};return i(t,n,e),e}var r=t("./invariant"),i=t("./traverseAllChildren");e.exports=o},{"./invariant":122,"./traverseAllChildren":142}],110:[function(t,e){"use strict";function n(t){t.disabled||t.focus()}e.exports=n},{}],111:[function(t,e){"use strict";var n=function(t,e,n){Array.isArray(t)?t.forEach(e,n):t&&e.call(n,t)};e.exports=n},{}],112:[function(t,e){function n(){try{return document.activeElement||document.body}catch(t){return document.body}}e.exports=n},{}],113:[function(t,e){"use strict";function n(t){return"key"in t?o[t.key]||t.key:r[t.which||t.keyCode]||"Unidentified"}var o={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},r={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"};e.exports=n},{}],114:[function(t,e){"use strict";function n(t){var e=t.target||t.srcElement||window;return 3===e.nodeType?e.parentNode:e}e.exports=n},{}],115:[function(t,e){function n(t){return r(!!i),p.hasOwnProperty(t)||(t="*"),a.hasOwnProperty(t)||(i.innerHTML="*"===t?"<link />":"<"+t+"></"+t+">",a[t]=!i.firstChild),a[t]?p[t]:null}var o=t("./ExecutionEnvironment"),r=t("./invariant"),i=o.canUseDOM?document.createElement("div"):null,a={circle:!0,defs:!0,g:!0,line:!0,linearGradient:!0,path:!0,polygon:!0,polyline:!0,radialGradient:!0,rect:!0,stop:!0,text:!0},s=[1,'<select multiple="true">',"</select>"],u=[1,"<table>","</table>"],c=[3,"<table><tbody><tr>","</tr></tbody></table>"],l=[1,"<svg>","</svg>"],p={"*":[1,"?<div>","</div>"],area:[1,"<map>","</map>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],legend:[1,"<fieldset>","</fieldset>"],param:[1,"<object>","</object>"],tr:[2,"<table><tbody>","</tbody></table>"],optgroup:s,option:s,caption:u,colgroup:u,tbody:u,tfoot:u,thead:u,td:c,th:c,circle:l,defs:l,g:l,line:l,linearGradient:l,path:l,polygon:l,polyline:l,radialGradient:l,rect:l,stop:l,text:l};e.exports=n},{"./ExecutionEnvironment":21,"./invariant":122}],116:[function(t,e){"use strict";function n(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function o(t){for(;t;){if(t.nextSibling)return t.nextSibling;t=t.parentNode}}function r(t,e){for(var r=n(t),i=0,a=0;r;){if(3==r.nodeType){if(a=i+r.textContent.length,e>=i&&a>=e)return{node:r,offset:e-i};i=a}r=n(o(r))}}e.exports=r},{}],117:[function(t,e){"use strict";function n(t){return t?t.nodeType===o?t.documentElement:t.firstChild:null}var o=9;e.exports=n},{}],118:[function(t,e){"use strict";function n(){return!r&&o.canUseDOM&&(r="textContent"in document.createElement("div")?"textContent":"innerText"),r}var o=t("./ExecutionEnvironment"),r=null;e.exports=n},{"./ExecutionEnvironment":21}],119:[function(t,e){"use strict";function n(t){return t===window?{x:window.pageXOffset||document.documentElement.scrollLeft,y:window.pageYOffset||document.documentElement.scrollTop}:{x:t.scrollLeft,y:t.scrollTop}}e.exports=n},{}],120:[function(t,e){function n(t){return t.replace(o,"-$1").toLowerCase()}var o=/([A-Z])/g;e.exports=n},{}],121:[function(t,e){"use strict";function n(t){return t._descriptor=t,t}t("./warning");e.exports=n},{"./warning":144}],122:[function(t,e){"use strict";var n=function(t){if(!t){var e=new Error("Minified exception occured; use the non-minified dev environment for the full error message and additional helpful warnings.");throw e.framesToPop=1,e}};e.exports=n},{}],123:[function(t,e){"use strict";function n(t,e){if(!r.canUseDOM||e&&!("addEventListener"in document))return!1;var n="on"+t,i=n in document;if(!i){var a=document.createElement("div");a.setAttribute(n,"return;"),i="function"==typeof a[n]}return!i&&o&&"wheel"===t&&(i=document.implementation.hasFeature("Events.wheel","3.0")),i}var o,r=t("./ExecutionEnvironment");r.canUseDOM&&(o=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0),e.exports=n},{"./ExecutionEnvironment":21}],124:[function(t,e){function n(t){return!(!t||!("function"==typeof Node?t instanceof Node:"object"==typeof t&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName))}e.exports=n},{}],125:[function(t,e){"use strict";function n(t){return t&&("INPUT"===t.nodeName&&o[t.type]||"TEXTAREA"===t.nodeName)}var o={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};e.exports=n},{}],126:[function(t,e){function n(t){return o(t)&&3==t.nodeType}var o=t("./isNode");e.exports=n},{"./isNode":124}],127:[function(t,e){"use strict";function n(t){t||(t="");var e,n=arguments.length;if(n>1)for(var o=1;n>o;o++)e=arguments[o],e&&(t+=" "+e);return t}e.exports=n},{}],128:[function(t,e){"use strict";var n=t("./invariant"),o=function(t){var e,o={};n(t instanceof Object&&!Array.isArray(t));for(e in t)t.hasOwnProperty(e)&&(o[e]=e);return o};e.exports=o},{"./invariant":122}],129:[function(t,e){var n=function(t){var e;for(e in t)if(t.hasOwnProperty(e))return e;return null};e.exports=n},{}],130:[function(t,e){"use strict";function n(t){var e={};return function(n){return e.hasOwnProperty(n)?e[n]:e[n]=t.call(this,n)}}e.exports=n},{}],131:[function(t,e){"use strict";var n=t("./mergeInto"),o=function(t,e){var o={};return n(o,t),n(o,e),o};e.exports=o},{"./mergeInto":133}],132:[function(t,e){"use strict";var n=t("./invariant"),o=t("./keyMirror"),r=36,i=function(t){return"object"!=typeof t||null===t},a={MAX_MERGE_DEPTH:r,isTerminal:i,normalizeMergeArg:function(t){return void 0===t||null===t?{}:t},checkMergeArrayArgs:function(t,e){n(Array.isArray(t)&&Array.isArray(e))},checkMergeObjectArgs:function(t,e){a.checkMergeObjectArg(t),a.checkMergeObjectArg(e)},checkMergeObjectArg:function(t){n(!i(t)&&!Array.isArray(t))},checkMergeLevel:function(t){n(r>t)},checkArrayStrategy:function(t){n(void 0===t||t in a.ArrayStrategies)},ArrayStrategies:o({Clobber:!0,IndexByIndex:!0})};e.exports=a},{"./invariant":122,"./keyMirror":128}],133:[function(t,e){"use strict";function n(t,e){if(r(t),null!=e){r(e);for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}}var o=t("./mergeHelpers"),r=o.checkMergeObjectArg;e.exports=n},{"./mergeHelpers":132}],134:[function(t,e){"use strict";var n=function(t,e){var n;for(n in e)e.hasOwnProperty(n)&&(t.prototype[n]=e[n])};e.exports=n},{}],135:[function(t,e){"use strict";function n(t){o(t&&!/[^a-z0-9_]/.test(t))}var o=t("./invariant");e.exports=n},{"./invariant":122}],136:[function(t,e){"use strict";function n(t,e,n){if(!t)return null;var o=0,r={};for(var i in t)t.hasOwnProperty(i)&&(r[i]=e.call(n,t[i],i,o++));return r}e.exports=n},{}],137:[function(t,e){"use strict";function n(t,e,n){if(!t)return null;var o=0,r={};for(var i in t)t.hasOwnProperty(i)&&(r[i]=e.call(n,i,t[i],o++));return r}e.exports=n},{}],138:[function(t,e){"use strict";function n(t){return r(o.isValidComponent(t)),t}var o=t("./ReactComponent"),r=t("./invariant");e.exports=n},{"./ReactComponent":31,"./invariant":122}],139:[function(t,e){"use strict";function n(t,e){if(t===e)return!0;var n;for(n in t)if(t.hasOwnProperty(n)&&(!e.hasOwnProperty(n)||t[n]!==e[n]))return!1;for(n in e)if(e.hasOwnProperty(n)&&!t.hasOwnProperty(n))return!1;return!0}e.exports=n},{}],140:[function(t,e){"use strict";function n(t,e){return t&&e&&t.constructor===e.constructor&&(t.props&&t.props.key)===(e.props&&e.props.key)&&t._owner===e._owner?!0:!1}e.exports=n},{}],141:[function(t,e){function n(t){var e=t.length;if(o(!Array.isArray(t)&&("object"==typeof t||"function"==typeof t)),o("number"==typeof e),o(0===e||e-1 in t),t.hasOwnProperty)try{return Array.prototype.slice.call(t)}catch(n){}for(var r=Array(e),i=0;e>i;i++)r[i]=t[i];return r}var o=t("./invariant");e.exports=n},{"./invariant":122}],142:[function(t,e){"use strict";function n(t){return d[t]}function o(t,e){return t&&t.props&&null!=t.props.key?i(t.props.key):e.toString(36)}function r(t){return(""+t).replace(h,n)}function i(t){return"$"+r(t)}function a(t,e,n){null!==t&&void 0!==t&&f(t,"",0,e,n)}var s=t("./ReactInstanceHandles"),u=t("./ReactTextComponent"),c=t("./invariant"),l=s.SEPARATOR,p=":",d={"=":"=0",".":"=1",":":"=2"},h=/[=.:]/g,f=function(t,e,n,r,a){var s=0;if(Array.isArray(t))for(var d=0;d<t.length;d++){var h=t[d],m=e+(e?p:l)+o(h,d),v=n+s;s+=f(h,m,v,r,a)}else{var g=typeof t,y=""===e,C=y?l+o(t,0):e;if(null==t||"boolean"===g)r(a,null,C,n),s=1;else if(t.type&&t.type.prototype&&t.type.prototype.mountComponentIntoNode)r(a,t,C,n),s=1;else if("object"===g){c(!t||1!==t.nodeType);for(var E in t)t.hasOwnProperty(E)&&(s+=f(t[E],e+(e?p:l)+i(E)+p+o(t[E],0),n+s,r,a))}else if("string"===g){var R=new u(t);r(a,R,C,n),s+=1}else if("number"===g){var M=new u(""+t);r(a,M,C,n),s+=1}}return s};e.exports=a},{"./ReactInstanceHandles":55,"./ReactTextComponent":74,"./invariant":122}],143:[function(t,e){"use strict";function n(t){return Array.isArray(t)?t.concat():t&&"object"==typeof t?i(new t.constructor,t):t}function o(t,e,n){s(Array.isArray(t));var o=e[n];s(Array.isArray(o))}function r(t,e){if(s("object"==typeof e),e.hasOwnProperty(p))return s(1===Object.keys(e).length),e[p];var a=n(t);if(e.hasOwnProperty(d)){var h=e[d];s(h&&"object"==typeof h),s(a&&"object"==typeof a),i(a,e[d])}e.hasOwnProperty(u)&&(o(t,e,u),e[u].forEach(function(t){a.push(t)})),e.hasOwnProperty(c)&&(o(t,e,c),e[c].forEach(function(t){a.unshift(t)})),e.hasOwnProperty(l)&&(s(Array.isArray(t)),s(Array.isArray(e[l])),e[l].forEach(function(t){s(Array.isArray(t)),a.splice.apply(a,t)}));for(var m in e)f[m]||(a[m]=r(t[m],e[m]));return a}var i=t("./copyProperties"),a=t("./keyOf"),s=t("./invariant"),u=a({$push:null}),c=a({$unshift:null}),l=a({$splice:null}),p=a({$set:null}),d=a({$merge:null}),h=[u,c,l,p,d],f={};h.forEach(function(t){f[t]=!0}),e.exports=r},{"./copyProperties":99,"./invariant":122,"./keyOf":129}],144:[function(t,e){"use strict";var n=t("./emptyFunction"),o=n;e.exports=o},{"./emptyFunction":106}]},{},[79])(79)});
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/js/react/react.js elefant-elefant_1_3_10_beta/apps/user/js/react/react.js
--- elefant-elefant_1_3_9_beta/apps/user/js/react/react.js	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/js/react/react.js	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,17228 @@
+/**
+ * React v0.10.0
+ */
+!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.React=e()}}(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule AutoFocusMixin
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var focusNode = _dereq_("./focusNode");
+
+var AutoFocusMixin = {
+  componentDidMount: function() {
+    if (this.props.autoFocus) {
+      focusNode(this.getDOMNode());
+    }
+  }
+};
+
+module.exports = AutoFocusMixin;
+
+},{"./focusNode":100}],2:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule CSSProperty
+ */
+
+"use strict";
+
+/**
+ * CSS properties which accept numbers but are not in units of "px".
+ */
+var isUnitlessNumber = {
+  columnCount: true,
+  fillOpacity: true,
+  flex: true,
+  flexGrow: true,
+  flexShrink: true,
+  fontWeight: true,
+  lineClamp: true,
+  lineHeight: true,
+  opacity: true,
+  order: true,
+  orphans: true,
+  widows: true,
+  zIndex: true,
+  zoom: true
+};
+
+/**
+ * @param {string} prefix vendor-specific prefix, eg: Webkit
+ * @param {string} key style name, eg: transitionDuration
+ * @return {string} style name prefixed with `prefix`, properly camelCased, eg:
+ * WebkitTransitionDuration
+ */
+function prefixKey(prefix, key) {
+  return prefix + key.charAt(0).toUpperCase() + key.substring(1);
+}
+
+/**
+ * Support style names that may come passed in prefixed by adding permutations
+ * of vendor prefixes.
+ */
+var prefixes = ['Webkit', 'ms', 'Moz', 'O'];
+
+// Using Object.keys here, or else the vanilla for-in loop makes IE8 go into an
+// infinite loop, because it iterates over the newly added props too.
+Object.keys(isUnitlessNumber).forEach(function(prop) {
+  prefixes.forEach(function(prefix) {
+    isUnitlessNumber[prefixKey(prefix, prop)] = isUnitlessNumber[prop];
+  });
+});
+
+/**
+ * Most style properties can be unset by doing .style[prop] = '' but IE8
+ * doesn't like doing that with shorthand properties so for the properties that
+ * IE8 breaks on, which are listed here, we instead unset each of the
+ * individual properties. See http://bugs.jquery.com/ticket/12385.
+ * The 4-value 'clock' properties like margin, padding, border-width seem to
+ * behave without any problems. Curiously, list-style works too without any
+ * special prodding.
+ */
+var shorthandPropertyExpansions = {
+  background: {
+    backgroundImage: true,
+    backgroundPosition: true,
+    backgroundRepeat: true,
+    backgroundColor: true
+  },
+  border: {
+    borderWidth: true,
+    borderStyle: true,
+    borderColor: true
+  },
+  borderBottom: {
+    borderBottomWidth: true,
+    borderBottomStyle: true,
+    borderBottomColor: true
+  },
+  borderLeft: {
+    borderLeftWidth: true,
+    borderLeftStyle: true,
+    borderLeftColor: true
+  },
+  borderRight: {
+    borderRightWidth: true,
+    borderRightStyle: true,
+    borderRightColor: true
+  },
+  borderTop: {
+    borderTopWidth: true,
+    borderTopStyle: true,
+    borderTopColor: true
+  },
+  font: {
+    fontStyle: true,
+    fontVariant: true,
+    fontWeight: true,
+    fontSize: true,
+    lineHeight: true,
+    fontFamily: true
+  }
+};
+
+var CSSProperty = {
+  isUnitlessNumber: isUnitlessNumber,
+  shorthandPropertyExpansions: shorthandPropertyExpansions
+};
+
+module.exports = CSSProperty;
+
+},{}],3:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule CSSPropertyOperations
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var CSSProperty = _dereq_("./CSSProperty");
+
+var dangerousStyleValue = _dereq_("./dangerousStyleValue");
+var escapeTextForBrowser = _dereq_("./escapeTextForBrowser");
+var hyphenate = _dereq_("./hyphenate");
+var memoizeStringOnly = _dereq_("./memoizeStringOnly");
+
+var processStyleName = memoizeStringOnly(function(styleName) {
+  return escapeTextForBrowser(hyphenate(styleName));
+});
+
+/**
+ * Operations for dealing with CSS properties.
+ */
+var CSSPropertyOperations = {
+
+  /**
+   * Serializes a mapping of style properties for use as inline styles:
+   *
+   *   > createMarkupForStyles({width: '200px', height: 0})
+   *   "width:200px;height:0;"
+   *
+   * Undefined values are ignored so that declarative programming is easier.
+   *
+   * @param {object} styles
+   * @return {?string}
+   */
+  createMarkupForStyles: function(styles) {
+    var serialized = '';
+    for (var styleName in styles) {
+      if (!styles.hasOwnProperty(styleName)) {
+        continue;
+      }
+      var styleValue = styles[styleName];
+      if (styleValue != null) {
+        serialized += processStyleName(styleName) + ':';
+        serialized += dangerousStyleValue(styleName, styleValue) + ';';
+      }
+    }
+    return serialized || null;
+  },
+
+  /**
+   * Sets the value for multiple styles on a node.  If a value is specified as
+   * '' (empty string), the corresponding style property will be unset.
+   *
+   * @param {DOMElement} node
+   * @param {object} styles
+   */
+  setValueForStyles: function(node, styles) {
+    var style = node.style;
+    for (var styleName in styles) {
+      if (!styles.hasOwnProperty(styleName)) {
+        continue;
+      }
+      var styleValue = dangerousStyleValue(styleName, styles[styleName]);
+      if (styleValue) {
+        style[styleName] = styleValue;
+      } else {
+        var expansion = CSSProperty.shorthandPropertyExpansions[styleName];
+        if (expansion) {
+          // Shorthand property that IE8 won't like unsetting, so unset each
+          // component to placate it
+          for (var individualStyleName in expansion) {
+            style[individualStyleName] = '';
+          }
+        } else {
+          style[styleName] = '';
+        }
+      }
+    }
+  }
+
+};
+
+module.exports = CSSPropertyOperations;
+
+},{"./CSSProperty":2,"./dangerousStyleValue":95,"./escapeTextForBrowser":98,"./hyphenate":110,"./memoizeStringOnly":120}],4:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ChangeEventPlugin
+ */
+
+"use strict";
+
+var EventConstants = _dereq_("./EventConstants");
+var EventPluginHub = _dereq_("./EventPluginHub");
+var EventPropagators = _dereq_("./EventPropagators");
+var ExecutionEnvironment = _dereq_("./ExecutionEnvironment");
+var ReactUpdates = _dereq_("./ReactUpdates");
+var SyntheticEvent = _dereq_("./SyntheticEvent");
+
+var isEventSupported = _dereq_("./isEventSupported");
+var isTextInputElement = _dereq_("./isTextInputElement");
+var keyOf = _dereq_("./keyOf");
+
+var topLevelTypes = EventConstants.topLevelTypes;
+
+var eventTypes = {
+  change: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onChange: null}),
+      captured: keyOf({onChangeCapture: null})
+    },
+    dependencies: [
+      topLevelTypes.topBlur,
+      topLevelTypes.topChange,
+      topLevelTypes.topClick,
+      topLevelTypes.topFocus,
+      topLevelTypes.topInput,
+      topLevelTypes.topKeyDown,
+      topLevelTypes.topKeyUp,
+      topLevelTypes.topSelectionChange
+    ]
+  }
+};
+
+/**
+ * For IE shims
+ */
+var activeElement = null;
+var activeElementID = null;
+var activeElementValue = null;
+var activeElementValueProp = null;
+
+/**
+ * SECTION: handle `change` event
+ */
+function shouldUseChangeEvent(elem) {
+  return (
+    elem.nodeName === 'SELECT' ||
+    (elem.nodeName === 'INPUT' && elem.type === 'file')
+  );
+}
+
+var doesChangeEventBubble = false;
+if (ExecutionEnvironment.canUseDOM) {
+  // See `handleChange` comment below
+  doesChangeEventBubble = isEventSupported('change') && (
+    !('documentMode' in document) || document.documentMode > 8
+  );
+}
+
+function manualDispatchChangeEvent(nativeEvent) {
+  var event = SyntheticEvent.getPooled(
+    eventTypes.change,
+    activeElementID,
+    nativeEvent
+  );
+  EventPropagators.accumulateTwoPhaseDispatches(event);
+
+  // If change and propertychange bubbled, we'd just bind to it like all the
+  // other events and have it go through ReactEventTopLevelCallback. Since it
+  // doesn't, we manually listen for the events and so we have to enqueue and
+  // process the abstract event manually.
+  //
+  // Batching is necessary here in order to ensure that all event handlers run
+  // before the next rerender (including event handlers attached to ancestor
+  // elements instead of directly on the input). Without this, controlled
+  // components don't work properly in conjunction with event bubbling because
+  // the component is rerendered and the value reverted before all the event
+  // handlers can run. See https://github.com/facebook/react/issues/708.
+  ReactUpdates.batchedUpdates(runEventInBatch, event);
+}
+
+function runEventInBatch(event) {
+  EventPluginHub.enqueueEvents(event);
+  EventPluginHub.processEventQueue();
+}
+
+function startWatchingForChangeEventIE8(target, targetID) {
+  activeElement = target;
+  activeElementID = targetID;
+  activeElement.attachEvent('onchange', manualDispatchChangeEvent);
+}
+
+function stopWatchingForChangeEventIE8() {
+  if (!activeElement) {
+    return;
+  }
+  activeElement.detachEvent('onchange', manualDispatchChangeEvent);
+  activeElement = null;
+  activeElementID = null;
+}
+
+function getTargetIDForChangeEvent(
+    topLevelType,
+    topLevelTarget,
+    topLevelTargetID) {
+  if (topLevelType === topLevelTypes.topChange) {
+    return topLevelTargetID;
+  }
+}
+function handleEventsForChangeEventIE8(
+    topLevelType,
+    topLevelTarget,
+    topLevelTargetID) {
+  if (topLevelType === topLevelTypes.topFocus) {
+    // stopWatching() should be a noop here but we call it just in case we
+    // missed a blur event somehow.
+    stopWatchingForChangeEventIE8();
+    startWatchingForChangeEventIE8(topLevelTarget, topLevelTargetID);
+  } else if (topLevelType === topLevelTypes.topBlur) {
+    stopWatchingForChangeEventIE8();
+  }
+}
+
+
+/**
+ * SECTION: handle `input` event
+ */
+var isInputEventSupported = false;
+if (ExecutionEnvironment.canUseDOM) {
+  // IE9 claims to support the input event but fails to trigger it when
+  // deleting text, so we ignore its input events
+  isInputEventSupported = isEventSupported('input') && (
+    !('documentMode' in document) || document.documentMode > 9
+  );
+}
+
+/**
+ * (For old IE.) Replacement getter/setter for the `value` property that gets
+ * set on the active element.
+ */
+var newValueProp =  {
+  get: function() {
+    return activeElementValueProp.get.call(this);
+  },
+  set: function(val) {
+    // Cast to a string so we can do equality checks.
+    activeElementValue = '' + val;
+    activeElementValueProp.set.call(this, val);
+  }
+};
+
+/**
+ * (For old IE.) Starts tracking propertychange events on the passed-in element
+ * and override the value property so that we can distinguish user events from
+ * value changes in JS.
+ */
+function startWatchingForValueChange(target, targetID) {
+  activeElement = target;
+  activeElementID = targetID;
+  activeElementValue = target.value;
+  activeElementValueProp = Object.getOwnPropertyDescriptor(
+    target.constructor.prototype,
+    'value'
+  );
+
+  Object.defineProperty(activeElement, 'value', newValueProp);
+  activeElement.attachEvent('onpropertychange', handlePropertyChange);
+}
+
+/**
+ * (For old IE.) Removes the event listeners from the currently-tracked element,
+ * if any exists.
+ */
+function stopWatchingForValueChange() {
+  if (!activeElement) {
+    return;
+  }
+
+  // delete restores the original property definition
+  delete activeElement.value;
+  activeElement.detachEvent('onpropertychange', handlePropertyChange);
+
+  activeElement = null;
+  activeElementID = null;
+  activeElementValue = null;
+  activeElementValueProp = null;
+}
+
+/**
+ * (For old IE.) Handles a propertychange event, sending a `change` event if
+ * the value of the active element has changed.
+ */
+function handlePropertyChange(nativeEvent) {
+  if (nativeEvent.propertyName !== 'value') {
+    return;
+  }
+  var value = nativeEvent.srcElement.value;
+  if (value === activeElementValue) {
+    return;
+  }
+  activeElementValue = value;
+
+  manualDispatchChangeEvent(nativeEvent);
+}
+
+/**
+ * If a `change` event should be fired, returns the target's ID.
+ */
+function getTargetIDForInputEvent(
+    topLevelType,
+    topLevelTarget,
+    topLevelTargetID) {
+  if (topLevelType === topLevelTypes.topInput) {
+    // In modern browsers (i.e., not IE8 or IE9), the input event is exactly
+    // what we want so fall through here and trigger an abstract event
+    return topLevelTargetID;
+  }
+}
+
+// For IE8 and IE9.
+function handleEventsForInputEventIE(
+    topLevelType,
+    topLevelTarget,
+    topLevelTargetID) {
+  if (topLevelType === topLevelTypes.topFocus) {
+    // In IE8, we can capture almost all .value changes by adding a
+    // propertychange handler and looking for events with propertyName
+    // equal to 'value'
+    // In IE9, propertychange fires for most input events but is buggy and
+    // doesn't fire when text is deleted, but conveniently, selectionchange
+    // appears to fire in all of the remaining cases so we catch those and
+    // forward the event if the value has changed
+    // In either case, we don't want to call the event handler if the value
+    // is changed from JS so we redefine a setter for `.value` that updates
+    // our activeElementValue variable, allowing us to ignore those changes
+    //
+    // stopWatching() should be a noop here but we call it just in case we
+    // missed a blur event somehow.
+    stopWatchingForValueChange();
+    startWatchingForValueChange(topLevelTarget, topLevelTargetID);
+  } else if (topLevelType === topLevelTypes.topBlur) {
+    stopWatchingForValueChange();
+  }
+}
+
+// For IE8 and IE9.
+function getTargetIDForInputEventIE(
+    topLevelType,
+    topLevelTarget,
+    topLevelTargetID) {
+  if (topLevelType === topLevelTypes.topSelectionChange ||
+      topLevelType === topLevelTypes.topKeyUp ||
+      topLevelType === topLevelTypes.topKeyDown) {
+    // On the selectionchange event, the target is just document which isn't
+    // helpful for us so just check activeElement instead.
+    //
+    // 99% of the time, keydown and keyup aren't necessary. IE8 fails to fire
+    // propertychange on the first input event after setting `value` from a
+    // script and fires only keydown, keypress, keyup. Catching keyup usually
+    // gets it and catching keydown lets us fire an event for the first
+    // keystroke if user does a key repeat (it'll be a little delayed: right
+    // before the second keystroke). Other input methods (e.g., paste) seem to
+    // fire selectionchange normally.
+    if (activeElement && activeElement.value !== activeElementValue) {
+      activeElementValue = activeElement.value;
+      return activeElementID;
+    }
+  }
+}
+
+
+/**
+ * SECTION: handle `click` event
+ */
+function shouldUseClickEvent(elem) {
+  // Use the `click` event to detect changes to checkbox and radio inputs.
+  // This approach works across all browsers, whereas `change` does not fire
+  // until `blur` in IE8.
+  return (
+    elem.nodeName === 'INPUT' &&
+    (elem.type === 'checkbox' || elem.type === 'radio')
+  );
+}
+
+function getTargetIDForClickEvent(
+    topLevelType,
+    topLevelTarget,
+    topLevelTargetID) {
+  if (topLevelType === topLevelTypes.topClick) {
+    return topLevelTargetID;
+  }
+}
+
+/**
+ * This plugin creates an `onChange` event that normalizes change events
+ * across form elements. This event fires at a time when it's possible to
+ * change the element's value without seeing a flicker.
+ *
+ * Supported elements are:
+ * - input (see `isTextInputElement`)
+ * - textarea
+ * - select
+ */
+var ChangeEventPlugin = {
+
+  eventTypes: eventTypes,
+
+  /**
+   * @param {string} topLevelType Record from `EventConstants`.
+   * @param {DOMEventTarget} topLevelTarget The listening component root node.
+   * @param {string} topLevelTargetID ID of `topLevelTarget`.
+   * @param {object} nativeEvent Native browser event.
+   * @return {*} An accumulation of synthetic events.
+   * @see {EventPluginHub.extractEvents}
+   */
+  extractEvents: function(
+      topLevelType,
+      topLevelTarget,
+      topLevelTargetID,
+      nativeEvent) {
+
+    var getTargetIDFunc, handleEventFunc;
+    if (shouldUseChangeEvent(topLevelTarget)) {
+      if (doesChangeEventBubble) {
+        getTargetIDFunc = getTargetIDForChangeEvent;
+      } else {
+        handleEventFunc = handleEventsForChangeEventIE8;
+      }
+    } else if (isTextInputElement(topLevelTarget)) {
+      if (isInputEventSupported) {
+        getTargetIDFunc = getTargetIDForInputEvent;
+      } else {
+        getTargetIDFunc = getTargetIDForInputEventIE;
+        handleEventFunc = handleEventsForInputEventIE;
+      }
+    } else if (shouldUseClickEvent(topLevelTarget)) {
+      getTargetIDFunc = getTargetIDForClickEvent;
+    }
+
+    if (getTargetIDFunc) {
+      var targetID = getTargetIDFunc(
+        topLevelType,
+        topLevelTarget,
+        topLevelTargetID
+      );
+      if (targetID) {
+        var event = SyntheticEvent.getPooled(
+          eventTypes.change,
+          targetID,
+          nativeEvent
+        );
+        EventPropagators.accumulateTwoPhaseDispatches(event);
+        return event;
+      }
+    }
+
+    if (handleEventFunc) {
+      handleEventFunc(
+        topLevelType,
+        topLevelTarget,
+        topLevelTargetID
+      );
+    }
+  }
+
+};
+
+module.exports = ChangeEventPlugin;
+
+},{"./EventConstants":14,"./EventPluginHub":16,"./EventPropagators":19,"./ExecutionEnvironment":20,"./ReactUpdates":71,"./SyntheticEvent":78,"./isEventSupported":113,"./isTextInputElement":115,"./keyOf":119}],5:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ClientReactRootIndex
+ * @typechecks
+ */
+
+"use strict";
+
+var nextReactRootIndex = 0;
+
+var ClientReactRootIndex = {
+  createReactRootIndex: function() {
+    return nextReactRootIndex++;
+  }
+};
+
+module.exports = ClientReactRootIndex;
+
+},{}],6:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule CompositionEventPlugin
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var EventConstants = _dereq_("./EventConstants");
+var EventPropagators = _dereq_("./EventPropagators");
+var ExecutionEnvironment = _dereq_("./ExecutionEnvironment");
+var ReactInputSelection = _dereq_("./ReactInputSelection");
+var SyntheticCompositionEvent = _dereq_("./SyntheticCompositionEvent");
+
+var getTextContentAccessor = _dereq_("./getTextContentAccessor");
+var keyOf = _dereq_("./keyOf");
+
+var END_KEYCODES = [9, 13, 27, 32]; // Tab, Return, Esc, Space
+var START_KEYCODE = 229;
+
+var useCompositionEvent = (
+  ExecutionEnvironment.canUseDOM &&
+  'CompositionEvent' in window
+);
+
+// In IE9+, we have access to composition events, but the data supplied
+// by the native compositionend event may be incorrect. In Korean, for example,
+// the compositionend event contains only one character regardless of
+// how many characters have been composed since compositionstart.
+// We therefore use the fallback data while still using the native
+// events as triggers.
+var useFallbackData = (
+  !useCompositionEvent ||
+  'documentMode' in document && document.documentMode > 8
+);
+
+var topLevelTypes = EventConstants.topLevelTypes;
+var currentComposition = null;
+
+// Events and their corresponding property names.
+var eventTypes = {
+  compositionEnd: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onCompositionEnd: null}),
+      captured: keyOf({onCompositionEndCapture: null})
+    },
+    dependencies: [
+      topLevelTypes.topBlur,
+      topLevelTypes.topCompositionEnd,
+      topLevelTypes.topKeyDown,
+      topLevelTypes.topKeyPress,
+      topLevelTypes.topKeyUp,
+      topLevelTypes.topMouseDown
+    ]
+  },
+  compositionStart: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onCompositionStart: null}),
+      captured: keyOf({onCompositionStartCapture: null})
+    },
+    dependencies: [
+      topLevelTypes.topBlur,
+      topLevelTypes.topCompositionStart,
+      topLevelTypes.topKeyDown,
+      topLevelTypes.topKeyPress,
+      topLevelTypes.topKeyUp,
+      topLevelTypes.topMouseDown
+    ]
+  },
+  compositionUpdate: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onCompositionUpdate: null}),
+      captured: keyOf({onCompositionUpdateCapture: null})
+    },
+    dependencies: [
+      topLevelTypes.topBlur,
+      topLevelTypes.topCompositionUpdate,
+      topLevelTypes.topKeyDown,
+      topLevelTypes.topKeyPress,
+      topLevelTypes.topKeyUp,
+      topLevelTypes.topMouseDown
+    ]
+  }
+};
+
+/**
+ * Translate native top level events into event types.
+ *
+ * @param {string} topLevelType
+ * @return {object}
+ */
+function getCompositionEventType(topLevelType) {
+  switch (topLevelType) {
+    case topLevelTypes.topCompositionStart:
+      return eventTypes.compositionStart;
+    case topLevelTypes.topCompositionEnd:
+      return eventTypes.compositionEnd;
+    case topLevelTypes.topCompositionUpdate:
+      return eventTypes.compositionUpdate;
+  }
+}
+
+/**
+ * Does our fallback best-guess model think this event signifies that
+ * composition has begun?
+ *
+ * @param {string} topLevelType
+ * @param {object} nativeEvent
+ * @return {boolean}
+ */
+function isFallbackStart(topLevelType, nativeEvent) {
+  return (
+    topLevelType === topLevelTypes.topKeyDown &&
+    nativeEvent.keyCode === START_KEYCODE
+  );
+}
+
+/**
+ * Does our fallback mode think that this event is the end of composition?
+ *
+ * @param {string} topLevelType
+ * @param {object} nativeEvent
+ * @return {boolean}
+ */
+function isFallbackEnd(topLevelType, nativeEvent) {
+  switch (topLevelType) {
+    case topLevelTypes.topKeyUp:
+      // Command keys insert or clear IME input.
+      return (END_KEYCODES.indexOf(nativeEvent.keyCode) !== -1);
+    case topLevelTypes.topKeyDown:
+      // Expect IME keyCode on each keydown. If we get any other
+      // code we must have exited earlier.
+      return (nativeEvent.keyCode !== START_KEYCODE);
+    case topLevelTypes.topKeyPress:
+    case topLevelTypes.topMouseDown:
+    case topLevelTypes.topBlur:
+      // Events are not possible without cancelling IME.
+      return true;
+    default:
+      return false;
+  }
+}
+
+/**
+ * Helper class stores information about selection and document state
+ * so we can figure out what changed at a later date.
+ *
+ * @param {DOMEventTarget} root
+ */
+function FallbackCompositionState(root) {
+  this.root = root;
+  this.startSelection = ReactInputSelection.getSelection(root);
+  this.startValue = this.getText();
+}
+
+/**
+ * Get current text of input.
+ *
+ * @return {string}
+ */
+FallbackCompositionState.prototype.getText = function() {
+  return this.root.value || this.root[getTextContentAccessor()];
+};
+
+/**
+ * Text that has changed since the start of composition.
+ *
+ * @return {string}
+ */
+FallbackCompositionState.prototype.getData = function() {
+  var endValue = this.getText();
+  var prefixLength = this.startSelection.start;
+  var suffixLength = this.startValue.length - this.startSelection.end;
+
+  return endValue.substr(
+    prefixLength,
+    endValue.length - suffixLength - prefixLength
+  );
+};
+
+/**
+ * This plugin creates `onCompositionStart`, `onCompositionUpdate` and
+ * `onCompositionEnd` events on inputs, textareas and contentEditable
+ * nodes.
+ */
+var CompositionEventPlugin = {
+
+  eventTypes: eventTypes,
+
+  /**
+   * @param {string} topLevelType Record from `EventConstants`.
+   * @param {DOMEventTarget} topLevelTarget The listening component root node.
+   * @param {string} topLevelTargetID ID of `topLevelTarget`.
+   * @param {object} nativeEvent Native browser event.
+   * @return {*} An accumulation of synthetic events.
+   * @see {EventPluginHub.extractEvents}
+   */
+  extractEvents: function(
+      topLevelType,
+      topLevelTarget,
+      topLevelTargetID,
+      nativeEvent) {
+
+    var eventType;
+    var data;
+
+    if (useCompositionEvent) {
+      eventType = getCompositionEventType(topLevelType);
+    } else if (!currentComposition) {
+      if (isFallbackStart(topLevelType, nativeEvent)) {
+        eventType = eventTypes.compositionStart;
+      }
+    } else if (isFallbackEnd(topLevelType, nativeEvent)) {
+      eventType = eventTypes.compositionEnd;
+    }
+
+    if (useFallbackData) {
+      // The current composition is stored statically and must not be
+      // overwritten while composition continues.
+      if (!currentComposition && eventType === eventTypes.compositionStart) {
+        currentComposition = new FallbackCompositionState(topLevelTarget);
+      } else if (eventType === eventTypes.compositionEnd) {
+        if (currentComposition) {
+          data = currentComposition.getData();
+          currentComposition = null;
+        }
+      }
+    }
+
+    if (eventType) {
+      var event = SyntheticCompositionEvent.getPooled(
+        eventType,
+        topLevelTargetID,
+        nativeEvent
+      );
+      if (data) {
+        // Inject data generated from fallback path into the synthetic event.
+        // This matches the property of native CompositionEventInterface.
+        event.data = data;
+      }
+      EventPropagators.accumulateTwoPhaseDispatches(event);
+      return event;
+    }
+  }
+};
+
+module.exports = CompositionEventPlugin;
+
+},{"./EventConstants":14,"./EventPropagators":19,"./ExecutionEnvironment":20,"./ReactInputSelection":52,"./SyntheticCompositionEvent":76,"./getTextContentAccessor":108,"./keyOf":119}],7:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule DOMChildrenOperations
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var Danger = _dereq_("./Danger");
+var ReactMultiChildUpdateTypes = _dereq_("./ReactMultiChildUpdateTypes");
+
+var getTextContentAccessor = _dereq_("./getTextContentAccessor");
+
+/**
+ * The DOM property to use when setting text content.
+ *
+ * @type {string}
+ * @private
+ */
+var textContentAccessor = getTextContentAccessor();
+
+/**
+ * Inserts `childNode` as a child of `parentNode` at the `index`.
+ *
+ * @param {DOMElement} parentNode Parent node in which to insert.
+ * @param {DOMElement} childNode Child node to insert.
+ * @param {number} index Index at which to insert the child.
+ * @internal
+ */
+function insertChildAt(parentNode, childNode, index) {
+  var childNodes = parentNode.childNodes;
+  if (childNodes[index] === childNode) {
+    return;
+  }
+  // If `childNode` is already a child of `parentNode`, remove it so that
+  // computing `childNodes[index]` takes into account the removal.
+  if (childNode.parentNode === parentNode) {
+    parentNode.removeChild(childNode);
+  }
+  if (index >= childNodes.length) {
+    parentNode.appendChild(childNode);
+  } else {
+    parentNode.insertBefore(childNode, childNodes[index]);
+  }
+}
+
+var updateTextContent;
+if (textContentAccessor === 'textContent') {
+  /**
+   * Sets the text content of `node` to `text`.
+   *
+   * @param {DOMElement} node Node to change
+   * @param {string} text New text content
+   */
+  updateTextContent = function(node, text) {
+    node.textContent = text;
+  };
+} else {
+  /**
+   * Sets the text content of `node` to `text`.
+   *
+   * @param {DOMElement} node Node to change
+   * @param {string} text New text content
+   */
+  updateTextContent = function(node, text) {
+    // In order to preserve newlines correctly, we can't use .innerText to set
+    // the contents (see #1080), so we empty the element then append a text node
+    while (node.firstChild) {
+      node.removeChild(node.firstChild);
+    }
+    if (text) {
+      var doc = node.ownerDocument || document;
+      node.appendChild(doc.createTextNode(text));
+    }
+  };
+}
+
+/**
+ * Operations for updating with DOM children.
+ */
+var DOMChildrenOperations = {
+
+  dangerouslyReplaceNodeWithMarkup: Danger.dangerouslyReplaceNodeWithMarkup,
+
+  updateTextContent: updateTextContent,
+
+  /**
+   * Updates a component's children by processing a series of updates. The
+   * update configurations are each expected to have a `parentNode` property.
+   *
+   * @param {array<object>} updates List of update configurations.
+   * @param {array<string>} markupList List of markup strings.
+   * @internal
+   */
+  processUpdates: function(updates, markupList) {
+    var update;
+    // Mapping from parent IDs to initial child orderings.
+    var initialChildren = null;
+    // List of children that will be moved or removed.
+    var updatedChildren = null;
+
+    for (var i = 0; update = updates[i]; i++) {
+      if (update.type === ReactMultiChildUpdateTypes.MOVE_EXISTING ||
+          update.type === ReactMultiChildUpdateTypes.REMOVE_NODE) {
+        var updatedIndex = update.fromIndex;
+        var updatedChild = update.parentNode.childNodes[updatedIndex];
+        var parentID = update.parentID;
+
+        initialChildren = initialChildren || {};
+        initialChildren[parentID] = initialChildren[parentID] || [];
+        initialChildren[parentID][updatedIndex] = updatedChild;
+
+        updatedChildren = updatedChildren || [];
+        updatedChildren.push(updatedChild);
+      }
+    }
+
+    var renderedMarkup = Danger.dangerouslyRenderMarkup(markupList);
+
+    // Remove updated children first so that `toIndex` is consistent.
+    if (updatedChildren) {
+      for (var j = 0; j < updatedChildren.length; j++) {
+        updatedChildren[j].parentNode.removeChild(updatedChildren[j]);
+      }
+    }
+
+    for (var k = 0; update = updates[k]; k++) {
+      switch (update.type) {
+        case ReactMultiChildUpdateTypes.INSERT_MARKUP:
+          insertChildAt(
+            update.parentNode,
+            renderedMarkup[update.markupIndex],
+            update.toIndex
+          );
+          break;
+        case ReactMultiChildUpdateTypes.MOVE_EXISTING:
+          insertChildAt(
+            update.parentNode,
+            initialChildren[update.parentID][update.fromIndex],
+            update.toIndex
+          );
+          break;
+        case ReactMultiChildUpdateTypes.TEXT_CONTENT:
+          updateTextContent(
+            update.parentNode,
+            update.textContent
+          );
+          break;
+        case ReactMultiChildUpdateTypes.REMOVE_NODE:
+          // Already removed by the for-loop above.
+          break;
+      }
+    }
+  }
+
+};
+
+module.exports = DOMChildrenOperations;
+
+},{"./Danger":10,"./ReactMultiChildUpdateTypes":58,"./getTextContentAccessor":108}],8:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule DOMProperty
+ * @typechecks static-only
+ */
+
+/*jslint bitwise: true */
+
+"use strict";
+
+var invariant = _dereq_("./invariant");
+
+var DOMPropertyInjection = {
+  /**
+   * Mapping from normalized, camelcased property names to a configuration that
+   * specifies how the associated DOM property should be accessed or rendered.
+   */
+  MUST_USE_ATTRIBUTE: 0x1,
+  MUST_USE_PROPERTY: 0x2,
+  HAS_SIDE_EFFECTS: 0x4,
+  HAS_BOOLEAN_VALUE: 0x8,
+  HAS_POSITIVE_NUMERIC_VALUE: 0x10,
+
+  /**
+   * Inject some specialized knowledge about the DOM. This takes a config object
+   * with the following properties:
+   *
+   * isCustomAttribute: function that given an attribute name will return true
+   * if it can be inserted into the DOM verbatim. Useful for data-* or aria-*
+   * attributes where it's impossible to enumerate all of the possible
+   * attribute names,
+   *
+   * Properties: object mapping DOM property name to one of the
+   * DOMPropertyInjection constants or null. If your attribute isn't in here,
+   * it won't get written to the DOM.
+   *
+   * DOMAttributeNames: object mapping React attribute name to the DOM
+   * attribute name. Attribute names not specified use the **lowercase**
+   * normalized name.
+   *
+   * DOMPropertyNames: similar to DOMAttributeNames but for DOM properties.
+   * Property names not specified use the normalized name.
+   *
+   * DOMMutationMethods: Properties that require special mutation methods. If
+   * `value` is undefined, the mutation method should unset the property.
+   *
+   * @param {object} domPropertyConfig the config as described above.
+   */
+  injectDOMPropertyConfig: function(domPropertyConfig) {
+    var Properties = domPropertyConfig.Properties || {};
+    var DOMAttributeNames = domPropertyConfig.DOMAttributeNames || {};
+    var DOMPropertyNames = domPropertyConfig.DOMPropertyNames || {};
+    var DOMMutationMethods = domPropertyConfig.DOMMutationMethods || {};
+
+    if (domPropertyConfig.isCustomAttribute) {
+      DOMProperty._isCustomAttributeFunctions.push(
+        domPropertyConfig.isCustomAttribute
+      );
+    }
+
+    for (var propName in Properties) {
+      ("production" !== "development" ? invariant(
+        !DOMProperty.isStandardName[propName],
+        'injectDOMPropertyConfig(...): You\'re trying to inject DOM property ' +
+        '\'%s\' which has already been injected. You may be accidentally ' +
+        'injecting the same DOM property config twice, or you may be ' +
+        'injecting two configs that have conflicting property names.',
+        propName
+      ) : invariant(!DOMProperty.isStandardName[propName]));
+
+      DOMProperty.isStandardName[propName] = true;
+
+      var lowerCased = propName.toLowerCase();
+      DOMProperty.getPossibleStandardName[lowerCased] = propName;
+
+      var attributeName = DOMAttributeNames[propName];
+      if (attributeName) {
+        DOMProperty.getPossibleStandardName[attributeName] = propName;
+      }
+
+      DOMProperty.getAttributeName[propName] = attributeName || lowerCased;
+
+      DOMProperty.getPropertyName[propName] =
+        DOMPropertyNames[propName] || propName;
+
+      var mutationMethod = DOMMutationMethods[propName];
+      if (mutationMethod) {
+        DOMProperty.getMutationMethod[propName] = mutationMethod;
+      }
+
+      var propConfig = Properties[propName];
+      DOMProperty.mustUseAttribute[propName] =
+        propConfig & DOMPropertyInjection.MUST_USE_ATTRIBUTE;
+      DOMProperty.mustUseProperty[propName] =
+        propConfig & DOMPropertyInjection.MUST_USE_PROPERTY;
+      DOMProperty.hasSideEffects[propName] =
+        propConfig & DOMPropertyInjection.HAS_SIDE_EFFECTS;
+      DOMProperty.hasBooleanValue[propName] =
+        propConfig & DOMPropertyInjection.HAS_BOOLEAN_VALUE;
+      DOMProperty.hasPositiveNumericValue[propName] =
+        propConfig & DOMPropertyInjection.HAS_POSITIVE_NUMERIC_VALUE;
+
+      ("production" !== "development" ? invariant(
+        !DOMProperty.mustUseAttribute[propName] ||
+          !DOMProperty.mustUseProperty[propName],
+        'DOMProperty: Cannot require using both attribute and property: %s',
+        propName
+      ) : invariant(!DOMProperty.mustUseAttribute[propName] ||
+        !DOMProperty.mustUseProperty[propName]));
+      ("production" !== "development" ? invariant(
+        DOMProperty.mustUseProperty[propName] ||
+          !DOMProperty.hasSideEffects[propName],
+        'DOMProperty: Properties that have side effects must use property: %s',
+        propName
+      ) : invariant(DOMProperty.mustUseProperty[propName] ||
+        !DOMProperty.hasSideEffects[propName]));
+      ("production" !== "development" ? invariant(
+        !DOMProperty.hasBooleanValue[propName] ||
+          !DOMProperty.hasPositiveNumericValue[propName],
+        'DOMProperty: Cannot have both boolean and positive numeric value: %s',
+        propName
+      ) : invariant(!DOMProperty.hasBooleanValue[propName] ||
+        !DOMProperty.hasPositiveNumericValue[propName]));
+    }
+  }
+};
+var defaultValueCache = {};
+
+/**
+ * DOMProperty exports lookup objects that can be used like functions:
+ *
+ *   > DOMProperty.isValid['id']
+ *   true
+ *   > DOMProperty.isValid['foobar']
+ *   undefined
+ *
+ * Although this may be confusing, it performs better in general.
+ *
+ * @see http://jsperf.com/key-exists
+ * @see http://jsperf.com/key-missing
+ */
+var DOMProperty = {
+
+  ID_ATTRIBUTE_NAME: 'data-reactid',
+
+  /**
+   * Checks whether a property name is a standard property.
+   * @type {Object}
+   */
+  isStandardName: {},
+
+  /**
+   * Mapping from lowercase property names to the properly cased version, used
+   * to warn in the case of missing properties.
+   * @type {Object}
+   */
+  getPossibleStandardName: {},
+
+  /**
+   * Mapping from normalized names to attribute names that differ. Attribute
+   * names are used when rendering markup or with `*Attribute()`.
+   * @type {Object}
+   */
+  getAttributeName: {},
+
+  /**
+   * Mapping from normalized names to properties on DOM node instances.
+   * (This includes properties that mutate due to external factors.)
+   * @type {Object}
+   */
+  getPropertyName: {},
+
+  /**
+   * Mapping from normalized names to mutation methods. This will only exist if
+   * mutation cannot be set simply by the property or `setAttribute()`.
+   * @type {Object}
+   */
+  getMutationMethod: {},
+
+  /**
+   * Whether the property must be accessed and mutated as an object property.
+   * @type {Object}
+   */
+  mustUseAttribute: {},
+
+  /**
+   * Whether the property must be accessed and mutated using `*Attribute()`.
+   * (This includes anything that fails `<propName> in <element>`.)
+   * @type {Object}
+   */
+  mustUseProperty: {},
+
+  /**
+   * Whether or not setting a value causes side effects such as triggering
+   * resources to be loaded or text selection changes. We must ensure that
+   * the value is only set if it has changed.
+   * @type {Object}
+   */
+  hasSideEffects: {},
+
+  /**
+   * Whether the property should be removed when set to a falsey value.
+   * @type {Object}
+   */
+  hasBooleanValue: {},
+
+  /**
+   * Whether the property must be positive numeric or parse as a positive
+   * numeric and should be removed when set to a falsey value.
+   * @type {Object}
+   */
+  hasPositiveNumericValue: {},
+
+  /**
+   * All of the isCustomAttribute() functions that have been injected.
+   */
+  _isCustomAttributeFunctions: [],
+
+  /**
+   * Checks whether a property name is a custom attribute.
+   * @method
+   */
+  isCustomAttribute: function(attributeName) {
+    for (var i = 0; i < DOMProperty._isCustomAttributeFunctions.length; i++) {
+      var isCustomAttributeFn = DOMProperty._isCustomAttributeFunctions[i];
+      if (isCustomAttributeFn(attributeName)) {
+        return true;
+      }
+    }
+    return false;
+  },
+
+  /**
+   * Returns the default property value for a DOM property (i.e., not an
+   * attribute). Most default values are '' or false, but not all. Worse yet,
+   * some (in particular, `type`) vary depending on the type of element.
+   *
+   * TODO: Is it better to grab all the possible properties when creating an
+   * element to avoid having to create the same element twice?
+   */
+  getDefaultValueForProperty: function(nodeName, prop) {
+    var nodeDefaults = defaultValueCache[nodeName];
+    var testElement;
+    if (!nodeDefaults) {
+      defaultValueCache[nodeName] = nodeDefaults = {};
+    }
+    if (!(prop in nodeDefaults)) {
+      testElement = document.createElement(nodeName);
+      nodeDefaults[prop] = testElement[prop];
+    }
+    return nodeDefaults[prop];
+  },
+
+  injection: DOMPropertyInjection
+};
+
+module.exports = DOMProperty;
+
+},{"./invariant":112}],9:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule DOMPropertyOperations
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var DOMProperty = _dereq_("./DOMProperty");
+
+var escapeTextForBrowser = _dereq_("./escapeTextForBrowser");
+var memoizeStringOnly = _dereq_("./memoizeStringOnly");
+var warning = _dereq_("./warning");
+
+function shouldIgnoreValue(name, value) {
+  return value == null ||
+    DOMProperty.hasBooleanValue[name] && !value ||
+    DOMProperty.hasPositiveNumericValue[name] && (isNaN(value) || value < 1);
+}
+
+var processAttributeNameAndPrefix = memoizeStringOnly(function(name) {
+  return escapeTextForBrowser(name) + '="';
+});
+
+if ("production" !== "development") {
+  var reactProps = {
+    children: true,
+    dangerouslySetInnerHTML: true,
+    key: true,
+    ref: true
+  };
+  var warnedProperties = {};
+
+  var warnUnknownProperty = function(name) {
+    if (reactProps[name] || warnedProperties[name]) {
+      return;
+    }
+
+    warnedProperties[name] = true;
+    var lowerCasedName = name.toLowerCase();
+
+    // data-* attributes should be lowercase; suggest the lowercase version
+    var standardName = DOMProperty.isCustomAttribute(lowerCasedName) ?
+      lowerCasedName : DOMProperty.getPossibleStandardName[lowerCasedName];
+
+    // For now, only warn when we have a suggested correction. This prevents
+    // logging too much when using transferPropsTo.
+    ("production" !== "development" ? warning(
+      standardName == null,
+      'Unknown DOM property ' + name + '. Did you mean ' + standardName + '?'
+    ) : null);
+
+  };
+}
+
+/**
+ * Operations for dealing with DOM properties.
+ */
+var DOMPropertyOperations = {
+
+  /**
+   * Creates markup for the ID property.
+   *
+   * @param {string} id Unescaped ID.
+   * @return {string} Markup string.
+   */
+  createMarkupForID: function(id) {
+    return processAttributeNameAndPrefix(DOMProperty.ID_ATTRIBUTE_NAME) +
+      escapeTextForBrowser(id) + '"';
+  },
+
+  /**
+   * Creates markup for a property.
+   *
+   * @param {string} name
+   * @param {*} value
+   * @return {?string} Markup string, or null if the property was invalid.
+   */
+  createMarkupForProperty: function(name, value) {
+    if (DOMProperty.isStandardName[name]) {
+      if (shouldIgnoreValue(name, value)) {
+        return '';
+      }
+      var attributeName = DOMProperty.getAttributeName[name];
+      if (DOMProperty.hasBooleanValue[name]) {
+        return escapeTextForBrowser(attributeName);
+      }
+      return processAttributeNameAndPrefix(attributeName) +
+        escapeTextForBrowser(value) + '"';
+    } else if (DOMProperty.isCustomAttribute(name)) {
+      if (value == null) {
+        return '';
+      }
+      return processAttributeNameAndPrefix(name) +
+        escapeTextForBrowser(value) + '"';
+    } else if ("production" !== "development") {
+      warnUnknownProperty(name);
+    }
+    return null;
+  },
+
+  /**
+   * Sets the value for a property on a node.
+   *
+   * @param {DOMElement} node
+   * @param {string} name
+   * @param {*} value
+   */
+  setValueForProperty: function(node, name, value) {
+    if (DOMProperty.isStandardName[name]) {
+      var mutationMethod = DOMProperty.getMutationMethod[name];
+      if (mutationMethod) {
+        mutationMethod(node, value);
+      } else if (shouldIgnoreValue(name, value)) {
+        this.deleteValueForProperty(node, name);
+      } else if (DOMProperty.mustUseAttribute[name]) {
+        node.setAttribute(DOMProperty.getAttributeName[name], '' + value);
+      } else {
+        var propName = DOMProperty.getPropertyName[name];
+        if (!DOMProperty.hasSideEffects[name] || node[propName] !== value) {
+          node[propName] = value;
+        }
+      }
+    } else if (DOMProperty.isCustomAttribute(name)) {
+      if (value == null) {
+        node.removeAttribute(DOMProperty.getAttributeName[name]);
+      } else {
+        node.setAttribute(name, '' + value);
+      }
+    } else if ("production" !== "development") {
+      warnUnknownProperty(name);
+    }
+  },
+
+  /**
+   * Deletes the value for a property on a node.
+   *
+   * @param {DOMElement} node
+   * @param {string} name
+   */
+  deleteValueForProperty: function(node, name) {
+    if (DOMProperty.isStandardName[name]) {
+      var mutationMethod = DOMProperty.getMutationMethod[name];
+      if (mutationMethod) {
+        mutationMethod(node, undefined);
+      } else if (DOMProperty.mustUseAttribute[name]) {
+        node.removeAttribute(DOMProperty.getAttributeName[name]);
+      } else {
+        var propName = DOMProperty.getPropertyName[name];
+        var defaultValue = DOMProperty.getDefaultValueForProperty(
+          node.nodeName,
+          propName
+        );
+        if (!DOMProperty.hasSideEffects[name] ||
+            node[propName] !== defaultValue) {
+          node[propName] = defaultValue;
+        }
+      }
+    } else if (DOMProperty.isCustomAttribute(name)) {
+      node.removeAttribute(name);
+    } else if ("production" !== "development") {
+      warnUnknownProperty(name);
+    }
+  }
+
+};
+
+module.exports = DOMPropertyOperations;
+
+},{"./DOMProperty":8,"./escapeTextForBrowser":98,"./memoizeStringOnly":120,"./warning":134}],10:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule Danger
+ * @typechecks static-only
+ */
+
+/*jslint evil: true, sub: true */
+
+"use strict";
+
+var ExecutionEnvironment = _dereq_("./ExecutionEnvironment");
+
+var createNodesFromMarkup = _dereq_("./createNodesFromMarkup");
+var emptyFunction = _dereq_("./emptyFunction");
+var getMarkupWrap = _dereq_("./getMarkupWrap");
+var invariant = _dereq_("./invariant");
+
+var OPEN_TAG_NAME_EXP = /^(<[^ \/>]+)/;
+var RESULT_INDEX_ATTR = 'data-danger-index';
+
+/**
+ * Extracts the `nodeName` from a string of markup.
+ *
+ * NOTE: Extracting the `nodeName` does not require a regular expression match
+ * because we make assumptions about React-generated markup (i.e. there are no
+ * spaces surrounding the opening tag and there is at least one attribute).
+ *
+ * @param {string} markup String of markup.
+ * @return {string} Node name of the supplied markup.
+ * @see http://jsperf.com/extract-nodename
+ */
+function getNodeName(markup) {
+  return markup.substring(1, markup.indexOf(' '));
+}
+
+var Danger = {
+
+  /**
+   * Renders markup into an array of nodes. The markup is expected to render
+   * into a list of root nodes. Also, the length of `resultList` and
+   * `markupList` should be the same.
+   *
+   * @param {array<string>} markupList List of markup strings to render.
+   * @return {array<DOMElement>} List of rendered nodes.
+   * @internal
+   */
+  dangerouslyRenderMarkup: function(markupList) {
+    ("production" !== "development" ? invariant(
+      ExecutionEnvironment.canUseDOM,
+      'dangerouslyRenderMarkup(...): Cannot render markup in a Worker ' +
+      'thread. This is likely a bug in the framework. Please report ' +
+      'immediately.'
+    ) : invariant(ExecutionEnvironment.canUseDOM));
+    var nodeName;
+    var markupByNodeName = {};
+    // Group markup by `nodeName` if a wrap is necessary, else by '*'.
+    for (var i = 0; i < markupList.length; i++) {
+      ("production" !== "development" ? invariant(
+        markupList[i],
+        'dangerouslyRenderMarkup(...): Missing markup.'
+      ) : invariant(markupList[i]));
+      nodeName = getNodeName(markupList[i]);
+      nodeName = getMarkupWrap(nodeName) ? nodeName : '*';
+      markupByNodeName[nodeName] = markupByNodeName[nodeName] || [];
+      markupByNodeName[nodeName][i] = markupList[i];
+    }
+    var resultList = [];
+    var resultListAssignmentCount = 0;
+    for (nodeName in markupByNodeName) {
+      if (!markupByNodeName.hasOwnProperty(nodeName)) {
+        continue;
+      }
+      var markupListByNodeName = markupByNodeName[nodeName];
+
+      // This for-in loop skips the holes of the sparse array. The order of
+      // iteration should follow the order of assignment, which happens to match
+      // numerical index order, but we don't rely on that.
+      for (var resultIndex in markupListByNodeName) {
+        if (markupListByNodeName.hasOwnProperty(resultIndex)) {
+          var markup = markupListByNodeName[resultIndex];
+
+          // Push the requested markup with an additional RESULT_INDEX_ATTR
+          // attribute.  If the markup does not start with a < character, it
+          // will be discarded below (with an appropriate console.error).
+          markupListByNodeName[resultIndex] = markup.replace(
+            OPEN_TAG_NAME_EXP,
+            // This index will be parsed back out below.
+            '$1 ' + RESULT_INDEX_ATTR + '="' + resultIndex + '" '
+          );
+        }
+      }
+
+      // Render each group of markup with similar wrapping `nodeName`.
+      var renderNodes = createNodesFromMarkup(
+        markupListByNodeName.join(''),
+        emptyFunction // Do nothing special with <script> tags.
+      );
+
+      for (i = 0; i < renderNodes.length; ++i) {
+        var renderNode = renderNodes[i];
+        if (renderNode.hasAttribute &&
+            renderNode.hasAttribute(RESULT_INDEX_ATTR)) {
+
+          resultIndex = +renderNode.getAttribute(RESULT_INDEX_ATTR);
+          renderNode.removeAttribute(RESULT_INDEX_ATTR);
+
+          ("production" !== "development" ? invariant(
+            !resultList.hasOwnProperty(resultIndex),
+            'Danger: Assigning to an already-occupied result index.'
+          ) : invariant(!resultList.hasOwnProperty(resultIndex)));
+
+          resultList[resultIndex] = renderNode;
+
+          // This should match resultList.length and markupList.length when
+          // we're done.
+          resultListAssignmentCount += 1;
+
+        } else if ("production" !== "development") {
+          console.error(
+            "Danger: Discarding unexpected node:",
+            renderNode
+          );
+        }
+      }
+    }
+
+    // Although resultList was populated out of order, it should now be a dense
+    // array.
+    ("production" !== "development" ? invariant(
+      resultListAssignmentCount === resultList.length,
+      'Danger: Did not assign to every index of resultList.'
+    ) : invariant(resultListAssignmentCount === resultList.length));
+
+    ("production" !== "development" ? invariant(
+      resultList.length === markupList.length,
+      'Danger: Expected markup to render %s nodes, but rendered %s.',
+      markupList.length,
+      resultList.length
+    ) : invariant(resultList.length === markupList.length));
+
+    return resultList;
+  },
+
+  /**
+   * Replaces a node with a string of markup at its current position within its
+   * parent. The markup must render into a single root node.
+   *
+   * @param {DOMElement} oldChild Child node to replace.
+   * @param {string} markup Markup to render in place of the child node.
+   * @internal
+   */
+  dangerouslyReplaceNodeWithMarkup: function(oldChild, markup) {
+    ("production" !== "development" ? invariant(
+      ExecutionEnvironment.canUseDOM,
+      'dangerouslyReplaceNodeWithMarkup(...): Cannot render markup in a ' +
+      'worker thread. This is likely a bug in the framework. Please report ' +
+      'immediately.'
+    ) : invariant(ExecutionEnvironment.canUseDOM));
+    ("production" !== "development" ? invariant(markup, 'dangerouslyReplaceNodeWithMarkup(...): Missing markup.') : invariant(markup));
+    ("production" !== "development" ? invariant(
+      oldChild.tagName.toLowerCase() !== 'html',
+      'dangerouslyReplaceNodeWithMarkup(...): Cannot replace markup of the ' +
+      '<html> node. This is because browser quirks make this unreliable ' +
+      'and/or slow. If you want to render to the root you must use ' +
+      'server rendering. See renderComponentToString().'
+    ) : invariant(oldChild.tagName.toLowerCase() !== 'html'));
+
+    var newChild = createNodesFromMarkup(markup, emptyFunction)[0];
+    oldChild.parentNode.replaceChild(newChild, oldChild);
+  }
+
+};
+
+module.exports = Danger;
+
+},{"./ExecutionEnvironment":20,"./createNodesFromMarkup":93,"./emptyFunction":96,"./getMarkupWrap":105,"./invariant":112}],11:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule DefaultDOMPropertyConfig
+ */
+
+/*jslint bitwise: true*/
+
+"use strict";
+
+var DOMProperty = _dereq_("./DOMProperty");
+
+var MUST_USE_ATTRIBUTE = DOMProperty.injection.MUST_USE_ATTRIBUTE;
+var MUST_USE_PROPERTY = DOMProperty.injection.MUST_USE_PROPERTY;
+var HAS_BOOLEAN_VALUE = DOMProperty.injection.HAS_BOOLEAN_VALUE;
+var HAS_SIDE_EFFECTS = DOMProperty.injection.HAS_SIDE_EFFECTS;
+var HAS_POSITIVE_NUMERIC_VALUE =
+  DOMProperty.injection.HAS_POSITIVE_NUMERIC_VALUE;
+
+var DefaultDOMPropertyConfig = {
+  isCustomAttribute: RegExp.prototype.test.bind(
+    /^(data|aria)-[a-z_][a-z\d_.\-]*$/
+  ),
+  Properties: {
+    /**
+     * Standard Properties
+     */
+    accept: null,
+    accessKey: null,
+    action: null,
+    allowFullScreen: MUST_USE_ATTRIBUTE | HAS_BOOLEAN_VALUE,
+    allowTransparency: MUST_USE_ATTRIBUTE,
+    alt: null,
+    async: HAS_BOOLEAN_VALUE,
+    autoComplete: null,
+    // autoFocus is polyfilled/normalized by AutoFocusMixin
+    // autoFocus: HAS_BOOLEAN_VALUE,
+    autoPlay: HAS_BOOLEAN_VALUE,
+    cellPadding: null,
+    cellSpacing: null,
+    charSet: MUST_USE_ATTRIBUTE,
+    checked: MUST_USE_PROPERTY | HAS_BOOLEAN_VALUE,
+    className: MUST_USE_PROPERTY,
+    cols: MUST_USE_ATTRIBUTE | HAS_POSITIVE_NUMERIC_VALUE,
+    colSpan: null,
+    content: null,
+    contentEditable: null,
+    contextMenu: MUST_USE_ATTRIBUTE,
+    controls: MUST_USE_PROPERTY | HAS_BOOLEAN_VALUE,
+    crossOrigin: null,
+    data: null, // For `<object />` acts as `src`.
+    dateTime: MUST_USE_ATTRIBUTE,
+    defer: HAS_BOOLEAN_VALUE,
+    dir: null,
+    disabled: MUST_USE_ATTRIBUTE | HAS_BOOLEAN_VALUE,
+    download: null,
+    draggable: null,
+    encType: null,
+    form: MUST_USE_ATTRIBUTE,
+    formNoValidate: HAS_BOOLEAN_VALUE,
+    frameBorder: MUST_USE_ATTRIBUTE,
+    height: MUST_USE_ATTRIBUTE,
+    hidden: MUST_USE_ATTRIBUTE | HAS_BOOLEAN_VALUE,
+    href: null,
+    hrefLang: null,
+    htmlFor: null,
+    httpEquiv: null,
+    icon: null,
+    id: MUST_USE_PROPERTY,
+    label: null,
+    lang: null,
+    list: null,
+    loop: MUST_USE_PROPERTY | HAS_BOOLEAN_VALUE,
+    max: null,
+    maxLength: MUST_USE_ATTRIBUTE,
+    mediaGroup: null,
+    method: null,
+    min: null,
+    multiple: MUST_USE_PROPERTY | HAS_BOOLEAN_VALUE,
+    muted: MUST_USE_PROPERTY | HAS_BOOLEAN_VALUE,
+    name: null,
+    noValidate: HAS_BOOLEAN_VALUE,
+    pattern: null,
+    placeholder: null,
+    poster: null,
+    preload: null,
+    radioGroup: null,
+    readOnly: MUST_USE_PROPERTY | HAS_BOOLEAN_VALUE,
+    rel: null,
+    required: HAS_BOOLEAN_VALUE,
+    role: MUST_USE_ATTRIBUTE,
+    rows: MUST_USE_ATTRIBUTE | HAS_POSITIVE_NUMERIC_VALUE,
+    rowSpan: null,
+    sandbox: null,
+    scope: null,
+    scrollLeft: MUST_USE_PROPERTY,
+    scrollTop: MUST_USE_PROPERTY,
+    seamless: MUST_USE_ATTRIBUTE | HAS_BOOLEAN_VALUE,
+    selected: MUST_USE_PROPERTY | HAS_BOOLEAN_VALUE,
+    size: MUST_USE_ATTRIBUTE | HAS_POSITIVE_NUMERIC_VALUE,
+    span: HAS_POSITIVE_NUMERIC_VALUE,
+    spellCheck: null,
+    src: null,
+    srcDoc: MUST_USE_PROPERTY,
+    srcSet: null,
+    step: null,
+    style: null,
+    tabIndex: null,
+    target: null,
+    title: null,
+    type: null,
+    value: MUST_USE_PROPERTY | HAS_SIDE_EFFECTS,
+    width: MUST_USE_ATTRIBUTE,
+    wmode: MUST_USE_ATTRIBUTE,
+
+    /**
+     * Non-standard Properties
+     */
+    autoCapitalize: null, // Supported in Mobile Safari for keyboard hints
+    autoCorrect: null, // Supported in Mobile Safari for keyboard hints
+    property: null, // Supports OG in meta tags
+
+    /**
+     * SVG Properties
+     */
+    cx: MUST_USE_ATTRIBUTE,
+    cy: MUST_USE_ATTRIBUTE,
+    d: MUST_USE_ATTRIBUTE,
+    fill: MUST_USE_ATTRIBUTE,
+    fx: MUST_USE_ATTRIBUTE,
+    fy: MUST_USE_ATTRIBUTE,
+    gradientTransform: MUST_USE_ATTRIBUTE,
+    gradientUnits: MUST_USE_ATTRIBUTE,
+    offset: MUST_USE_ATTRIBUTE,
+    points: MUST_USE_ATTRIBUTE,
+    r: MUST_USE_ATTRIBUTE,
+    rx: MUST_USE_ATTRIBUTE,
+    ry: MUST_USE_ATTRIBUTE,
+    spreadMethod: MUST_USE_ATTRIBUTE,
+    stopColor: MUST_USE_ATTRIBUTE,
+    stopOpacity: MUST_USE_ATTRIBUTE,
+    stroke: MUST_USE_ATTRIBUTE,
+    strokeLinecap: MUST_USE_ATTRIBUTE,
+    strokeWidth: MUST_USE_ATTRIBUTE,
+    textAnchor: MUST_USE_ATTRIBUTE,
+    transform: MUST_USE_ATTRIBUTE,
+    version: MUST_USE_ATTRIBUTE,
+    viewBox: MUST_USE_ATTRIBUTE,
+    x1: MUST_USE_ATTRIBUTE,
+    x2: MUST_USE_ATTRIBUTE,
+    x: MUST_USE_ATTRIBUTE,
+    y1: MUST_USE_ATTRIBUTE,
+    y2: MUST_USE_ATTRIBUTE,
+    y: MUST_USE_ATTRIBUTE
+  },
+  DOMAttributeNames: {
+    className: 'class',
+    gradientTransform: 'gradientTransform',
+    gradientUnits: 'gradientUnits',
+    htmlFor: 'for',
+    spreadMethod: 'spreadMethod',
+    stopColor: 'stop-color',
+    stopOpacity: 'stop-opacity',
+    strokeLinecap: 'stroke-linecap',
+    strokeWidth: 'stroke-width',
+    textAnchor: 'text-anchor',
+    viewBox: 'viewBox'
+  },
+  DOMPropertyNames: {
+    autoCapitalize: 'autocapitalize',
+    autoComplete: 'autocomplete',
+    autoCorrect: 'autocorrect',
+    autoFocus: 'autofocus',
+    autoPlay: 'autoplay',
+    encType: 'enctype',
+    hrefLang: 'hreflang',
+    radioGroup: 'radiogroup',
+    spellCheck: 'spellcheck',
+    srcDoc: 'srcdoc',
+    srcSet: 'srcset'
+  }
+};
+
+module.exports = DefaultDOMPropertyConfig;
+
+},{"./DOMProperty":8}],12:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule DefaultEventPluginOrder
+ */
+
+"use strict";
+
+ var keyOf = _dereq_("./keyOf");
+
+/**
+ * Module that is injectable into `EventPluginHub`, that specifies a
+ * deterministic ordering of `EventPlugin`s. A convenient way to reason about
+ * plugins, without having to package every one of them. This is better than
+ * having plugins be ordered in the same order that they are injected because
+ * that ordering would be influenced by the packaging order.
+ * `ResponderEventPlugin` must occur before `SimpleEventPlugin` so that
+ * preventing default on events is convenient in `SimpleEventPlugin` handlers.
+ */
+var DefaultEventPluginOrder = [
+  keyOf({ResponderEventPlugin: null}),
+  keyOf({SimpleEventPlugin: null}),
+  keyOf({TapEventPlugin: null}),
+  keyOf({EnterLeaveEventPlugin: null}),
+  keyOf({ChangeEventPlugin: null}),
+  keyOf({SelectEventPlugin: null}),
+  keyOf({CompositionEventPlugin: null}),
+  keyOf({AnalyticsEventPlugin: null}),
+  keyOf({MobileSafariClickEventPlugin: null})
+];
+
+module.exports = DefaultEventPluginOrder;
+
+},{"./keyOf":119}],13:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule EnterLeaveEventPlugin
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var EventConstants = _dereq_("./EventConstants");
+var EventPropagators = _dereq_("./EventPropagators");
+var SyntheticMouseEvent = _dereq_("./SyntheticMouseEvent");
+
+var ReactMount = _dereq_("./ReactMount");
+var keyOf = _dereq_("./keyOf");
+
+var topLevelTypes = EventConstants.topLevelTypes;
+var getFirstReactDOM = ReactMount.getFirstReactDOM;
+
+var eventTypes = {
+  mouseEnter: {
+    registrationName: keyOf({onMouseEnter: null}),
+    dependencies: [
+      topLevelTypes.topMouseOut,
+      topLevelTypes.topMouseOver
+    ]
+  },
+  mouseLeave: {
+    registrationName: keyOf({onMouseLeave: null}),
+    dependencies: [
+      topLevelTypes.topMouseOut,
+      topLevelTypes.topMouseOver
+    ]
+  }
+};
+
+var extractedEvents = [null, null];
+
+var EnterLeaveEventPlugin = {
+
+  eventTypes: eventTypes,
+
+  /**
+   * For almost every interaction we care about, there will be both a top-level
+   * `mouseover` and `mouseout` event that occurs. Only use `mouseout` so that
+   * we do not extract duplicate events. However, moving the mouse into the
+   * browser from outside will not fire a `mouseout` event. In this case, we use
+   * the `mouseover` top-level event.
+   *
+   * @param {string} topLevelType Record from `EventConstants`.
+   * @param {DOMEventTarget} topLevelTarget The listening component root node.
+   * @param {string} topLevelTargetID ID of `topLevelTarget`.
+   * @param {object} nativeEvent Native browser event.
+   * @return {*} An accumulation of synthetic events.
+   * @see {EventPluginHub.extractEvents}
+   */
+  extractEvents: function(
+      topLevelType,
+      topLevelTarget,
+      topLevelTargetID,
+      nativeEvent) {
+    if (topLevelType === topLevelTypes.topMouseOver &&
+        (nativeEvent.relatedTarget || nativeEvent.fromElement)) {
+      return null;
+    }
+    if (topLevelType !== topLevelTypes.topMouseOut &&
+        topLevelType !== topLevelTypes.topMouseOver) {
+      // Must not be a mouse in or mouse out - ignoring.
+      return null;
+    }
+
+    var win;
+    if (topLevelTarget.window === topLevelTarget) {
+      // `topLevelTarget` is probably a window object.
+      win = topLevelTarget;
+    } else {
+      // TODO: Figure out why `ownerDocument` is sometimes undefined in IE8.
+      var doc = topLevelTarget.ownerDocument;
+      if (doc) {
+        win = doc.defaultView || doc.parentWindow;
+      } else {
+        win = window;
+      }
+    }
+
+    var from, to;
+    if (topLevelType === topLevelTypes.topMouseOut) {
+      from = topLevelTarget;
+      to =
+        getFirstReactDOM(nativeEvent.relatedTarget || nativeEvent.toElement) ||
+        win;
+    } else {
+      from = win;
+      to = topLevelTarget;
+    }
+
+    if (from === to) {
+      // Nothing pertains to our managed components.
+      return null;
+    }
+
+    var fromID = from ? ReactMount.getID(from) : '';
+    var toID = to ? ReactMount.getID(to) : '';
+
+    var leave = SyntheticMouseEvent.getPooled(
+      eventTypes.mouseLeave,
+      fromID,
+      nativeEvent
+    );
+    leave.type = 'mouseleave';
+    leave.target = from;
+    leave.relatedTarget = to;
+
+    var enter = SyntheticMouseEvent.getPooled(
+      eventTypes.mouseEnter,
+      toID,
+      nativeEvent
+    );
+    enter.type = 'mouseenter';
+    enter.target = to;
+    enter.relatedTarget = from;
+
+    EventPropagators.accumulateEnterLeaveDispatches(leave, enter, fromID, toID);
+
+    extractedEvents[0] = leave;
+    extractedEvents[1] = enter;
+
+    return extractedEvents;
+  }
+
+};
+
+module.exports = EnterLeaveEventPlugin;
+
+},{"./EventConstants":14,"./EventPropagators":19,"./ReactMount":55,"./SyntheticMouseEvent":81,"./keyOf":119}],14:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule EventConstants
+ */
+
+"use strict";
+
+var keyMirror = _dereq_("./keyMirror");
+
+var PropagationPhases = keyMirror({bubbled: null, captured: null});
+
+/**
+ * Types of raw signals from the browser caught at the top level.
+ */
+var topLevelTypes = keyMirror({
+  topBlur: null,
+  topChange: null,
+  topClick: null,
+  topCompositionEnd: null,
+  topCompositionStart: null,
+  topCompositionUpdate: null,
+  topContextMenu: null,
+  topCopy: null,
+  topCut: null,
+  topDoubleClick: null,
+  topDrag: null,
+  topDragEnd: null,
+  topDragEnter: null,
+  topDragExit: null,
+  topDragLeave: null,
+  topDragOver: null,
+  topDragStart: null,
+  topDrop: null,
+  topError: null,
+  topFocus: null,
+  topInput: null,
+  topKeyDown: null,
+  topKeyPress: null,
+  topKeyUp: null,
+  topLoad: null,
+  topMouseDown: null,
+  topMouseMove: null,
+  topMouseOut: null,
+  topMouseOver: null,
+  topMouseUp: null,
+  topPaste: null,
+  topReset: null,
+  topScroll: null,
+  topSelectionChange: null,
+  topSubmit: null,
+  topTouchCancel: null,
+  topTouchEnd: null,
+  topTouchMove: null,
+  topTouchStart: null,
+  topWheel: null
+});
+
+var EventConstants = {
+  topLevelTypes: topLevelTypes,
+  PropagationPhases: PropagationPhases
+};
+
+module.exports = EventConstants;
+
+},{"./keyMirror":118}],15:[function(_dereq_,module,exports){
+/**
+ * @providesModule EventListener
+ */
+
+var emptyFunction = _dereq_("./emptyFunction");
+
+/**
+ * Upstream version of event listener. Does not take into account specific
+ * nature of platform.
+ */
+var EventListener = {
+  /**
+   * Listen to DOM events during the bubble phase.
+   *
+   * @param {DOMEventTarget} target DOM element to register listener on.
+   * @param {string} eventType Event type, e.g. 'click' or 'mouseover'.
+   * @param {function} callback Callback function.
+   * @return {object} Object with a `remove` method.
+   */
+  listen: function(target, eventType, callback) {
+    if (target.addEventListener) {
+      target.addEventListener(eventType, callback, false);
+      return {
+        remove: function() {
+          target.removeEventListener(eventType, callback, false);
+        }
+      };
+    } else if (target.attachEvent) {
+      target.attachEvent('on' + eventType, callback);
+      return {
+        remove: function() {
+          target.detachEvent(eventType, callback);
+        }
+      };
+    }
+  },
+
+  /**
+   * Listen to DOM events during the capture phase.
+   *
+   * @param {DOMEventTarget} target DOM element to register listener on.
+   * @param {string} eventType Event type, e.g. 'click' or 'mouseover'.
+   * @param {function} callback Callback function.
+   * @return {object} Object with a `remove` method.
+   */
+  capture: function(target, eventType, callback) {
+    if (!target.addEventListener) {
+      if ("production" !== "development") {
+        console.error(
+          'Attempted to listen to events during the capture phase on a ' +
+          'browser that does not support the capture phase. Your application ' +
+          'will not receive some events.'
+        );
+      }
+      return {
+        remove: emptyFunction
+      };
+    } else {
+      target.addEventListener(eventType, callback, true);
+      return {
+        remove: function() {
+          target.removeEventListener(eventType, callback, true);
+        }
+      };
+    }
+  }
+};
+
+module.exports = EventListener;
+
+},{"./emptyFunction":96}],16:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule EventPluginHub
+ */
+
+"use strict";
+
+var EventPluginRegistry = _dereq_("./EventPluginRegistry");
+var EventPluginUtils = _dereq_("./EventPluginUtils");
+var ExecutionEnvironment = _dereq_("./ExecutionEnvironment");
+
+var accumulate = _dereq_("./accumulate");
+var forEachAccumulated = _dereq_("./forEachAccumulated");
+var invariant = _dereq_("./invariant");
+var isEventSupported = _dereq_("./isEventSupported");
+var monitorCodeUse = _dereq_("./monitorCodeUse");
+
+/**
+ * Internal store for event listeners
+ */
+var listenerBank = {};
+
+/**
+ * Internal queue of events that have accumulated their dispatches and are
+ * waiting to have their dispatches executed.
+ */
+var eventQueue = null;
+
+/**
+ * Dispatches an event and releases it back into the pool, unless persistent.
+ *
+ * @param {?object} event Synthetic event to be dispatched.
+ * @private
+ */
+var executeDispatchesAndRelease = function(event) {
+  if (event) {
+    var executeDispatch = EventPluginUtils.executeDispatch;
+    // Plugins can provide custom behavior when dispatching events.
+    var PluginModule = EventPluginRegistry.getPluginModuleForEvent(event);
+    if (PluginModule && PluginModule.executeDispatch) {
+      executeDispatch = PluginModule.executeDispatch;
+    }
+    EventPluginUtils.executeDispatchesInOrder(event, executeDispatch);
+
+    if (!event.isPersistent()) {
+      event.constructor.release(event);
+    }
+  }
+};
+
+/**
+ * - `InstanceHandle`: [required] Module that performs logical traversals of DOM
+ *   hierarchy given ids of the logical DOM elements involved.
+ */
+var InstanceHandle = null;
+
+function validateInstanceHandle() {
+  var invalid = !InstanceHandle||
+    !InstanceHandle.traverseTwoPhase ||
+    !InstanceHandle.traverseEnterLeave;
+  if (invalid) {
+    throw new Error('InstanceHandle not injected before use!');
+  }
+}
+
+/**
+ * This is a unified interface for event plugins to be installed and configured.
+ *
+ * Event plugins can implement the following properties:
+ *
+ *   `extractEvents` {function(string, DOMEventTarget, string, object): *}
+ *     Required. When a top-level event is fired, this method is expected to
+ *     extract synthetic events that will in turn be queued and dispatched.
+ *
+ *   `eventTypes` {object}
+ *     Optional, plugins that fire events must publish a mapping of registration
+ *     names that are used to register listeners. Values of this mapping must
+ *     be objects that contain `registrationName` or `phasedRegistrationNames`.
+ *
+ *   `executeDispatch` {function(object, function, string)}
+ *     Optional, allows plugins to override how an event gets dispatched. By
+ *     default, the listener is simply invoked.
+ *
+ * Each plugin that is injected into `EventsPluginHub` is immediately operable.
+ *
+ * @public
+ */
+var EventPluginHub = {
+
+  /**
+   * Methods for injecting dependencies.
+   */
+  injection: {
+
+    /**
+     * @param {object} InjectedMount
+     * @public
+     */
+    injectMount: EventPluginUtils.injection.injectMount,
+
+    /**
+     * @param {object} InjectedInstanceHandle
+     * @public
+     */
+    injectInstanceHandle: function(InjectedInstanceHandle) {
+      InstanceHandle = InjectedInstanceHandle;
+      if ("production" !== "development") {
+        validateInstanceHandle();
+      }
+    },
+
+    getInstanceHandle: function() {
+      if ("production" !== "development") {
+        validateInstanceHandle();
+      }
+      return InstanceHandle;
+    },
+
+    /**
+     * @param {array} InjectedEventPluginOrder
+     * @public
+     */
+    injectEventPluginOrder: EventPluginRegistry.injectEventPluginOrder,
+
+    /**
+     * @param {object} injectedNamesToPlugins Map from names to plugin modules.
+     */
+    injectEventPluginsByName: EventPluginRegistry.injectEventPluginsByName
+
+  },
+
+  eventNameDispatchConfigs: EventPluginRegistry.eventNameDispatchConfigs,
+
+  registrationNameModules: EventPluginRegistry.registrationNameModules,
+
+  /**
+   * Stores `listener` at `listenerBank[registrationName][id]`. Is idempotent.
+   *
+   * @param {string} id ID of the DOM element.
+   * @param {string} registrationName Name of listener (e.g. `onClick`).
+   * @param {?function} listener The callback to store.
+   */
+  putListener: function(id, registrationName, listener) {
+    ("production" !== "development" ? invariant(
+      ExecutionEnvironment.canUseDOM,
+      'Cannot call putListener() in a non-DOM environment.'
+    ) : invariant(ExecutionEnvironment.canUseDOM));
+    ("production" !== "development" ? invariant(
+      !listener || typeof listener === 'function',
+      'Expected %s listener to be a function, instead got type %s',
+      registrationName, typeof listener
+    ) : invariant(!listener || typeof listener === 'function'));
+
+    if ("production" !== "development") {
+      // IE8 has no API for event capturing and the `onScroll` event doesn't
+      // bubble.
+      if (registrationName === 'onScroll' &&
+          !isEventSupported('scroll', true)) {
+        monitorCodeUse('react_no_scroll_event');
+        console.warn('This browser doesn\'t support the `onScroll` event');
+      }
+    }
+    var bankForRegistrationName =
+      listenerBank[registrationName] || (listenerBank[registrationName] = {});
+    bankForRegistrationName[id] = listener;
+  },
+
+  /**
+   * @param {string} id ID of the DOM element.
+   * @param {string} registrationName Name of listener (e.g. `onClick`).
+   * @return {?function} The stored callback.
+   */
+  getListener: function(id, registrationName) {
+    var bankForRegistrationName = listenerBank[registrationName];
+    return bankForRegistrationName && bankForRegistrationName[id];
+  },
+
+  /**
+   * Deletes a listener from the registration bank.
+   *
+   * @param {string} id ID of the DOM element.
+   * @param {string} registrationName Name of listener (e.g. `onClick`).
+   */
+  deleteListener: function(id, registrationName) {
+    var bankForRegistrationName = listenerBank[registrationName];
+    if (bankForRegistrationName) {
+      delete bankForRegistrationName[id];
+    }
+  },
+
+  /**
+   * Deletes all listeners for the DOM element with the supplied ID.
+   *
+   * @param {string} id ID of the DOM element.
+   */
+  deleteAllListeners: function(id) {
+    for (var registrationName in listenerBank) {
+      delete listenerBank[registrationName][id];
+    }
+  },
+
+  /**
+   * Allows registered plugins an opportunity to extract events from top-level
+   * native browser events.
+   *
+   * @param {string} topLevelType Record from `EventConstants`.
+   * @param {DOMEventTarget} topLevelTarget The listening component root node.
+   * @param {string} topLevelTargetID ID of `topLevelTarget`.
+   * @param {object} nativeEvent Native browser event.
+   * @return {*} An accumulation of synthetic events.
+   * @internal
+   */
+  extractEvents: function(
+      topLevelType,
+      topLevelTarget,
+      topLevelTargetID,
+      nativeEvent) {
+    var events;
+    var plugins = EventPluginRegistry.plugins;
+    for (var i = 0, l = plugins.length; i < l; i++) {
+      // Not every plugin in the ordering may be loaded at runtime.
+      var possiblePlugin = plugins[i];
+      if (possiblePlugin) {
+        var extractedEvents = possiblePlugin.extractEvents(
+          topLevelType,
+          topLevelTarget,
+          topLevelTargetID,
+          nativeEvent
+        );
+        if (extractedEvents) {
+          events = accumulate(events, extractedEvents);
+        }
+      }
+    }
+    return events;
+  },
+
+  /**
+   * Enqueues a synthetic event that should be dispatched when
+   * `processEventQueue` is invoked.
+   *
+   * @param {*} events An accumulation of synthetic events.
+   * @internal
+   */
+  enqueueEvents: function(events) {
+    if (events) {
+      eventQueue = accumulate(eventQueue, events);
+    }
+  },
+
+  /**
+   * Dispatches all synthetic events on the event queue.
+   *
+   * @internal
+   */
+  processEventQueue: function() {
+    // Set `eventQueue` to null before processing it so that we can tell if more
+    // events get enqueued while processing.
+    var processingEventQueue = eventQueue;
+    eventQueue = null;
+    forEachAccumulated(processingEventQueue, executeDispatchesAndRelease);
+    ("production" !== "development" ? invariant(
+      !eventQueue,
+      'processEventQueue(): Additional events were enqueued while processing ' +
+      'an event queue. Support for this has not yet been implemented.'
+    ) : invariant(!eventQueue));
+  },
+
+  /**
+   * These are needed for tests only. Do not use!
+   */
+  __purge: function() {
+    listenerBank = {};
+  },
+
+  __getListenerBank: function() {
+    return listenerBank;
+  }
+
+};
+
+module.exports = EventPluginHub;
+
+},{"./EventPluginRegistry":17,"./EventPluginUtils":18,"./ExecutionEnvironment":20,"./accumulate":87,"./forEachAccumulated":101,"./invariant":112,"./isEventSupported":113,"./monitorCodeUse":125}],17:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule EventPluginRegistry
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var invariant = _dereq_("./invariant");
+
+/**
+ * Injectable ordering of event plugins.
+ */
+var EventPluginOrder = null;
+
+/**
+ * Injectable mapping from names to event plugin modules.
+ */
+var namesToPlugins = {};
+
+/**
+ * Recomputes the plugin list using the injected plugins and plugin ordering.
+ *
+ * @private
+ */
+function recomputePluginOrdering() {
+  if (!EventPluginOrder) {
+    // Wait until an `EventPluginOrder` is injected.
+    return;
+  }
+  for (var pluginName in namesToPlugins) {
+    var PluginModule = namesToPlugins[pluginName];
+    var pluginIndex = EventPluginOrder.indexOf(pluginName);
+    ("production" !== "development" ? invariant(
+      pluginIndex > -1,
+      'EventPluginRegistry: Cannot inject event plugins that do not exist in ' +
+      'the plugin ordering, `%s`.',
+      pluginName
+    ) : invariant(pluginIndex > -1));
+    if (EventPluginRegistry.plugins[pluginIndex]) {
+      continue;
+    }
+    ("production" !== "development" ? invariant(
+      PluginModule.extractEvents,
+      'EventPluginRegistry: Event plugins must implement an `extractEvents` ' +
+      'method, but `%s` does not.',
+      pluginName
+    ) : invariant(PluginModule.extractEvents));
+    EventPluginRegistry.plugins[pluginIndex] = PluginModule;
+    var publishedEvents = PluginModule.eventTypes;
+    for (var eventName in publishedEvents) {
+      ("production" !== "development" ? invariant(
+        publishEventForPlugin(
+          publishedEvents[eventName],
+          PluginModule,
+          eventName
+        ),
+        'EventPluginRegistry: Failed to publish event `%s` for plugin `%s`.',
+        eventName,
+        pluginName
+      ) : invariant(publishEventForPlugin(
+        publishedEvents[eventName],
+        PluginModule,
+        eventName
+      )));
+    }
+  }
+}
+
+/**
+ * Publishes an event so that it can be dispatched by the supplied plugin.
+ *
+ * @param {object} dispatchConfig Dispatch configuration for the event.
+ * @param {object} PluginModule Plugin publishing the event.
+ * @return {boolean} True if the event was successfully published.
+ * @private
+ */
+function publishEventForPlugin(dispatchConfig, PluginModule, eventName) {
+  ("production" !== "development" ? invariant(
+    !EventPluginRegistry.eventNameDispatchConfigs[eventName],
+    'EventPluginHub: More than one plugin attempted to publish the same ' +
+    'event name, `%s`.',
+    eventName
+  ) : invariant(!EventPluginRegistry.eventNameDispatchConfigs[eventName]));
+  EventPluginRegistry.eventNameDispatchConfigs[eventName] = dispatchConfig;
+
+  var phasedRegistrationNames = dispatchConfig.phasedRegistrationNames;
+  if (phasedRegistrationNames) {
+    for (var phaseName in phasedRegistrationNames) {
+      if (phasedRegistrationNames.hasOwnProperty(phaseName)) {
+        var phasedRegistrationName = phasedRegistrationNames[phaseName];
+        publishRegistrationName(
+          phasedRegistrationName,
+          PluginModule,
+          eventName
+        );
+      }
+    }
+    return true;
+  } else if (dispatchConfig.registrationName) {
+    publishRegistrationName(
+      dispatchConfig.registrationName,
+      PluginModule,
+      eventName
+    );
+    return true;
+  }
+  return false;
+}
+
+/**
+ * Publishes a registration name that is used to identify dispatched events and
+ * can be used with `EventPluginHub.putListener` to register listeners.
+ *
+ * @param {string} registrationName Registration name to add.
+ * @param {object} PluginModule Plugin publishing the event.
+ * @private
+ */
+function publishRegistrationName(registrationName, PluginModule, eventName) {
+  ("production" !== "development" ? invariant(
+    !EventPluginRegistry.registrationNameModules[registrationName],
+    'EventPluginHub: More than one plugin attempted to publish the same ' +
+    'registration name, `%s`.',
+    registrationName
+  ) : invariant(!EventPluginRegistry.registrationNameModules[registrationName]));
+  EventPluginRegistry.registrationNameModules[registrationName] = PluginModule;
+  EventPluginRegistry.registrationNameDependencies[registrationName] =
+    PluginModule.eventTypes[eventName].dependencies;
+}
+
+/**
+ * Registers plugins so that they can extract and dispatch events.
+ *
+ * @see {EventPluginHub}
+ */
+var EventPluginRegistry = {
+
+  /**
+   * Ordered list of injected plugins.
+   */
+  plugins: [],
+
+  /**
+   * Mapping from event name to dispatch config
+   */
+  eventNameDispatchConfigs: {},
+
+  /**
+   * Mapping from registration name to plugin module
+   */
+  registrationNameModules: {},
+
+  /**
+   * Mapping from registration name to event name
+   */
+  registrationNameDependencies: {},
+
+  /**
+   * Injects an ordering of plugins (by plugin name). This allows the ordering
+   * to be decoupled from injection of the actual plugins so that ordering is
+   * always deterministic regardless of packaging, on-the-fly injection, etc.
+   *
+   * @param {array} InjectedEventPluginOrder
+   * @internal
+   * @see {EventPluginHub.injection.injectEventPluginOrder}
+   */
+  injectEventPluginOrder: function(InjectedEventPluginOrder) {
+    ("production" !== "development" ? invariant(
+      !EventPluginOrder,
+      'EventPluginRegistry: Cannot inject event plugin ordering more than once.'
+    ) : invariant(!EventPluginOrder));
+    // Clone the ordering so it cannot be dynamically mutated.
+    EventPluginOrder = Array.prototype.slice.call(InjectedEventPluginOrder);
+    recomputePluginOrdering();
+  },
+
+  /**
+   * Injects plugins to be used by `EventPluginHub`. The plugin names must be
+   * in the ordering injected by `injectEventPluginOrder`.
+   *
+   * Plugins can be injected as part of page initialization or on-the-fly.
+   *
+   * @param {object} injectedNamesToPlugins Map from names to plugin modules.
+   * @internal
+   * @see {EventPluginHub.injection.injectEventPluginsByName}
+   */
+  injectEventPluginsByName: function(injectedNamesToPlugins) {
+    var isOrderingDirty = false;
+    for (var pluginName in injectedNamesToPlugins) {
+      if (!injectedNamesToPlugins.hasOwnProperty(pluginName)) {
+        continue;
+      }
+      var PluginModule = injectedNamesToPlugins[pluginName];
+      if (namesToPlugins[pluginName] !== PluginModule) {
+        ("production" !== "development" ? invariant(
+          !namesToPlugins[pluginName],
+          'EventPluginRegistry: Cannot inject two different event plugins ' +
+          'using the same name, `%s`.',
+          pluginName
+        ) : invariant(!namesToPlugins[pluginName]));
+        namesToPlugins[pluginName] = PluginModule;
+        isOrderingDirty = true;
+      }
+    }
+    if (isOrderingDirty) {
+      recomputePluginOrdering();
+    }
+  },
+
+  /**
+   * Looks up the plugin for the supplied event.
+   *
+   * @param {object} event A synthetic event.
+   * @return {?object} The plugin that created the supplied event.
+   * @internal
+   */
+  getPluginModuleForEvent: function(event) {
+    var dispatchConfig = event.dispatchConfig;
+    if (dispatchConfig.registrationName) {
+      return EventPluginRegistry.registrationNameModules[
+        dispatchConfig.registrationName
+      ] || null;
+    }
+    for (var phase in dispatchConfig.phasedRegistrationNames) {
+      if (!dispatchConfig.phasedRegistrationNames.hasOwnProperty(phase)) {
+        continue;
+      }
+      var PluginModule = EventPluginRegistry.registrationNameModules[
+        dispatchConfig.phasedRegistrationNames[phase]
+      ];
+      if (PluginModule) {
+        return PluginModule;
+      }
+    }
+    return null;
+  },
+
+  /**
+   * Exposed for unit testing.
+   * @private
+   */
+  _resetEventPlugins: function() {
+    EventPluginOrder = null;
+    for (var pluginName in namesToPlugins) {
+      if (namesToPlugins.hasOwnProperty(pluginName)) {
+        delete namesToPlugins[pluginName];
+      }
+    }
+    EventPluginRegistry.plugins.length = 0;
+
+    var eventNameDispatchConfigs = EventPluginRegistry.eventNameDispatchConfigs;
+    for (var eventName in eventNameDispatchConfigs) {
+      if (eventNameDispatchConfigs.hasOwnProperty(eventName)) {
+        delete eventNameDispatchConfigs[eventName];
+      }
+    }
+
+    var registrationNameModules = EventPluginRegistry.registrationNameModules;
+    for (var registrationName in registrationNameModules) {
+      if (registrationNameModules.hasOwnProperty(registrationName)) {
+        delete registrationNameModules[registrationName];
+      }
+    }
+  }
+
+};
+
+module.exports = EventPluginRegistry;
+
+},{"./invariant":112}],18:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule EventPluginUtils
+ */
+
+"use strict";
+
+var EventConstants = _dereq_("./EventConstants");
+
+var invariant = _dereq_("./invariant");
+
+/**
+ * Injected dependencies:
+ */
+
+/**
+ * - `Mount`: [required] Module that can convert between React dom IDs and
+ *   actual node references.
+ */
+var injection = {
+  Mount: null,
+  injectMount: function(InjectedMount) {
+    injection.Mount = InjectedMount;
+    if ("production" !== "development") {
+      ("production" !== "development" ? invariant(
+        InjectedMount && InjectedMount.getNode,
+        'EventPluginUtils.injection.injectMount(...): Injected Mount module ' +
+        'is missing getNode.'
+      ) : invariant(InjectedMount && InjectedMount.getNode));
+    }
+  }
+};
+
+var topLevelTypes = EventConstants.topLevelTypes;
+
+function isEndish(topLevelType) {
+  return topLevelType === topLevelTypes.topMouseUp ||
+         topLevelType === topLevelTypes.topTouchEnd ||
+         topLevelType === topLevelTypes.topTouchCancel;
+}
+
+function isMoveish(topLevelType) {
+  return topLevelType === topLevelTypes.topMouseMove ||
+         topLevelType === topLevelTypes.topTouchMove;
+}
+function isStartish(topLevelType) {
+  return topLevelType === topLevelTypes.topMouseDown ||
+         topLevelType === topLevelTypes.topTouchStart;
+}
+
+
+var validateEventDispatches;
+if ("production" !== "development") {
+  validateEventDispatches = function(event) {
+    var dispatchListeners = event._dispatchListeners;
+    var dispatchIDs = event._dispatchIDs;
+
+    var listenersIsArr = Array.isArray(dispatchListeners);
+    var idsIsArr = Array.isArray(dispatchIDs);
+    var IDsLen = idsIsArr ? dispatchIDs.length : dispatchIDs ? 1 : 0;
+    var listenersLen = listenersIsArr ?
+      dispatchListeners.length :
+      dispatchListeners ? 1 : 0;
+
+    ("production" !== "development" ? invariant(
+      idsIsArr === listenersIsArr && IDsLen === listenersLen,
+      'EventPluginUtils: Invalid `event`.'
+    ) : invariant(idsIsArr === listenersIsArr && IDsLen === listenersLen));
+  };
+}
+
+/**
+ * Invokes `cb(event, listener, id)`. Avoids using call if no scope is
+ * provided. The `(listener,id)` pair effectively forms the "dispatch" but are
+ * kept separate to conserve memory.
+ */
+function forEachEventDispatch(event, cb) {
+  var dispatchListeners = event._dispatchListeners;
+  var dispatchIDs = event._dispatchIDs;
+  if ("production" !== "development") {
+    validateEventDispatches(event);
+  }
+  if (Array.isArray(dispatchListeners)) {
+    for (var i = 0; i < dispatchListeners.length; i++) {
+      if (event.isPropagationStopped()) {
+        break;
+      }
+      // Listeners and IDs are two parallel arrays that are always in sync.
+      cb(event, dispatchListeners[i], dispatchIDs[i]);
+    }
+  } else if (dispatchListeners) {
+    cb(event, dispatchListeners, dispatchIDs);
+  }
+}
+
+/**
+ * Default implementation of PluginModule.executeDispatch().
+ * @param {SyntheticEvent} SyntheticEvent to handle
+ * @param {function} Application-level callback
+ * @param {string} domID DOM id to pass to the callback.
+ */
+function executeDispatch(event, listener, domID) {
+  event.currentTarget = injection.Mount.getNode(domID);
+  var returnValue = listener(event, domID);
+  event.currentTarget = null;
+  return returnValue;
+}
+
+/**
+ * Standard/simple iteration through an event's collected dispatches.
+ */
+function executeDispatchesInOrder(event, executeDispatch) {
+  forEachEventDispatch(event, executeDispatch);
+  event._dispatchListeners = null;
+  event._dispatchIDs = null;
+}
+
+/**
+ * Standard/simple iteration through an event's collected dispatches, but stops
+ * at the first dispatch execution returning true, and returns that id.
+ *
+ * @return id of the first dispatch execution who's listener returns true, or
+ * null if no listener returned true.
+ */
+function executeDispatchesInOrderStopAtTrue(event) {
+  var dispatchListeners = event._dispatchListeners;
+  var dispatchIDs = event._dispatchIDs;
+  if ("production" !== "development") {
+    validateEventDispatches(event);
+  }
+  if (Array.isArray(dispatchListeners)) {
+    for (var i = 0; i < dispatchListeners.length; i++) {
+      if (event.isPropagationStopped()) {
+        break;
+      }
+      // Listeners and IDs are two parallel arrays that are always in sync.
+      if (dispatchListeners[i](event, dispatchIDs[i])) {
+        return dispatchIDs[i];
+      }
+    }
+  } else if (dispatchListeners) {
+    if (dispatchListeners(event, dispatchIDs)) {
+      return dispatchIDs;
+    }
+  }
+  return null;
+}
+
+/**
+ * Execution of a "direct" dispatch - there must be at most one dispatch
+ * accumulated on the event or it is considered an error. It doesn't really make
+ * sense for an event with multiple dispatches (bubbled) to keep track of the
+ * return values at each dispatch execution, but it does tend to make sense when
+ * dealing with "direct" dispatches.
+ *
+ * @return The return value of executing the single dispatch.
+ */
+function executeDirectDispatch(event) {
+  if ("production" !== "development") {
+    validateEventDispatches(event);
+  }
+  var dispatchListener = event._dispatchListeners;
+  var dispatchID = event._dispatchIDs;
+  ("production" !== "development" ? invariant(
+    !Array.isArray(dispatchListener),
+    'executeDirectDispatch(...): Invalid `event`.'
+  ) : invariant(!Array.isArray(dispatchListener)));
+  var res = dispatchListener ?
+    dispatchListener(event, dispatchID) :
+    null;
+  event._dispatchListeners = null;
+  event._dispatchIDs = null;
+  return res;
+}
+
+/**
+ * @param {SyntheticEvent} event
+ * @return {bool} True iff number of dispatches accumulated is greater than 0.
+ */
+function hasDispatches(event) {
+  return !!event._dispatchListeners;
+}
+
+/**
+ * General utilities that are useful in creating custom Event Plugins.
+ */
+var EventPluginUtils = {
+  isEndish: isEndish,
+  isMoveish: isMoveish,
+  isStartish: isStartish,
+
+  executeDirectDispatch: executeDirectDispatch,
+  executeDispatch: executeDispatch,
+  executeDispatchesInOrder: executeDispatchesInOrder,
+  executeDispatchesInOrderStopAtTrue: executeDispatchesInOrderStopAtTrue,
+  hasDispatches: hasDispatches,
+  injection: injection,
+  useTouchEvents: false
+};
+
+module.exports = EventPluginUtils;
+
+},{"./EventConstants":14,"./invariant":112}],19:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule EventPropagators
+ */
+
+"use strict";
+
+var EventConstants = _dereq_("./EventConstants");
+var EventPluginHub = _dereq_("./EventPluginHub");
+
+var accumulate = _dereq_("./accumulate");
+var forEachAccumulated = _dereq_("./forEachAccumulated");
+
+var PropagationPhases = EventConstants.PropagationPhases;
+var getListener = EventPluginHub.getListener;
+
+/**
+ * Some event types have a notion of different registration names for different
+ * "phases" of propagation. This finds listeners by a given phase.
+ */
+function listenerAtPhase(id, event, propagationPhase) {
+  var registrationName =
+    event.dispatchConfig.phasedRegistrationNames[propagationPhase];
+  return getListener(id, registrationName);
+}
+
+/**
+ * Tags a `SyntheticEvent` with dispatched listeners. Creating this function
+ * here, allows us to not have to bind or create functions for each event.
+ * Mutating the event's members allows us to not have to create a wrapping
+ * "dispatch" object that pairs the event with the listener.
+ */
+function accumulateDirectionalDispatches(domID, upwards, event) {
+  if ("production" !== "development") {
+    if (!domID) {
+      throw new Error('Dispatching id must not be null');
+    }
+  }
+  var phase = upwards ? PropagationPhases.bubbled : PropagationPhases.captured;
+  var listener = listenerAtPhase(domID, event, phase);
+  if (listener) {
+    event._dispatchListeners = accumulate(event._dispatchListeners, listener);
+    event._dispatchIDs = accumulate(event._dispatchIDs, domID);
+  }
+}
+
+/**
+ * Collect dispatches (must be entirely collected before dispatching - see unit
+ * tests). Lazily allocate the array to conserve memory.  We must loop through
+ * each event and perform the traversal for each one. We can not perform a
+ * single traversal for the entire collection of events because each event may
+ * have a different target.
+ */
+function accumulateTwoPhaseDispatchesSingle(event) {
+  if (event && event.dispatchConfig.phasedRegistrationNames) {
+    EventPluginHub.injection.getInstanceHandle().traverseTwoPhase(
+      event.dispatchMarker,
+      accumulateDirectionalDispatches,
+      event
+    );
+  }
+}
+
+
+/**
+ * Accumulates without regard to direction, does not look for phased
+ * registration names. Same as `accumulateDirectDispatchesSingle` but without
+ * requiring that the `dispatchMarker` be the same as the dispatched ID.
+ */
+function accumulateDispatches(id, ignoredDirection, event) {
+  if (event && event.dispatchConfig.registrationName) {
+    var registrationName = event.dispatchConfig.registrationName;
+    var listener = getListener(id, registrationName);
+    if (listener) {
+      event._dispatchListeners = accumulate(event._dispatchListeners, listener);
+      event._dispatchIDs = accumulate(event._dispatchIDs, id);
+    }
+  }
+}
+
+/**
+ * Accumulates dispatches on an `SyntheticEvent`, but only for the
+ * `dispatchMarker`.
+ * @param {SyntheticEvent} event
+ */
+function accumulateDirectDispatchesSingle(event) {
+  if (event && event.dispatchConfig.registrationName) {
+    accumulateDispatches(event.dispatchMarker, null, event);
+  }
+}
+
+function accumulateTwoPhaseDispatches(events) {
+  forEachAccumulated(events, accumulateTwoPhaseDispatchesSingle);
+}
+
+function accumulateEnterLeaveDispatches(leave, enter, fromID, toID) {
+  EventPluginHub.injection.getInstanceHandle().traverseEnterLeave(
+    fromID,
+    toID,
+    accumulateDispatches,
+    leave,
+    enter
+  );
+}
+
+
+function accumulateDirectDispatches(events) {
+  forEachAccumulated(events, accumulateDirectDispatchesSingle);
+}
+
+
+
+/**
+ * A small set of propagation patterns, each of which will accept a small amount
+ * of information, and generate a set of "dispatch ready event objects" - which
+ * are sets of events that have already been annotated with a set of dispatched
+ * listener functions/ids. The API is designed this way to discourage these
+ * propagation strategies from actually executing the dispatches, since we
+ * always want to collect the entire set of dispatches before executing event a
+ * single one.
+ *
+ * @constructor EventPropagators
+ */
+var EventPropagators = {
+  accumulateTwoPhaseDispatches: accumulateTwoPhaseDispatches,
+  accumulateDirectDispatches: accumulateDirectDispatches,
+  accumulateEnterLeaveDispatches: accumulateEnterLeaveDispatches
+};
+
+module.exports = EventPropagators;
+
+},{"./EventConstants":14,"./EventPluginHub":16,"./accumulate":87,"./forEachAccumulated":101}],20:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ExecutionEnvironment
+ */
+
+/*jslint evil: true */
+
+"use strict";
+
+var canUseDOM = typeof window !== 'undefined';
+
+/**
+ * Simple, lightweight module assisting with the detection and context of
+ * Worker. Helps avoid circular dependencies and allows code to reason about
+ * whether or not they are in a Worker, even if they never include the main
+ * `ReactWorker` dependency.
+ */
+var ExecutionEnvironment = {
+
+  canUseDOM: canUseDOM,
+
+  canUseWorkers: typeof Worker !== 'undefined',
+
+  canUseEventListeners:
+    canUseDOM && (window.addEventListener || window.attachEvent),
+
+  isInWorker: !canUseDOM // For now, this is true - might change in the future.
+
+};
+
+module.exports = ExecutionEnvironment;
+
+},{}],21:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule LinkedValueUtils
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var ReactPropTypes = _dereq_("./ReactPropTypes");
+
+var invariant = _dereq_("./invariant");
+var warning = _dereq_("./warning");
+
+var hasReadOnlyValue = {
+  'button': true,
+  'checkbox': true,
+  'image': true,
+  'hidden': true,
+  'radio': true,
+  'reset': true,
+  'submit': true
+};
+
+function _assertSingleLink(input) {
+  ("production" !== "development" ? invariant(
+      input.props.checkedLink == null || input.props.valueLink == null,
+      'Cannot provide a checkedLink and a valueLink. If you want to use ' +
+      'checkedLink, you probably don\'t want to use valueLink and vice versa.'
+  ) : invariant(input.props.checkedLink == null || input.props.valueLink == null));
+}
+function _assertValueLink(input) {
+  _assertSingleLink(input);
+  ("production" !== "development" ? invariant(
+    input.props.value == null && input.props.onChange == null,
+    'Cannot provide a valueLink and a value or onChange event. If you want ' +
+    'to use value or onChange, you probably don\'t want to use valueLink.'
+  ) : invariant(input.props.value == null && input.props.onChange == null));
+}
+
+function _assertCheckedLink(input) {
+  _assertSingleLink(input);
+  ("production" !== "development" ? invariant(
+    input.props.checked == null && input.props.onChange == null,
+    'Cannot provide a checkedLink and a checked property or onChange event. ' +
+    'If you want to use checked or onChange, you probably don\'t want to ' +
+    'use checkedLink'
+  ) : invariant(input.props.checked == null && input.props.onChange == null));
+}
+
+/**
+ * @param {SyntheticEvent} e change event to handle
+ */
+function _handleLinkedValueChange(e) {
+  /*jshint validthis:true */
+  this.props.valueLink.requestChange(e.target.value);
+}
+
+/**
+  * @param {SyntheticEvent} e change event to handle
+  */
+function _handleLinkedCheckChange(e) {
+  /*jshint validthis:true */
+  this.props.checkedLink.requestChange(e.target.checked);
+}
+
+/**
+ * Provide a linked `value` attribute for controlled forms. You should not use
+ * this outside of the ReactDOM controlled form components.
+ */
+var LinkedValueUtils = {
+  Mixin: {
+    propTypes: {
+      value: function(props, propName, componentName) {
+        if ("production" !== "development") {
+          ("production" !== "development" ? warning(
+            !props[propName] ||
+            hasReadOnlyValue[props.type] ||
+            props.onChange ||
+            props.readOnly ||
+            props.disabled,
+            'You provided a `value` prop to a form field without an ' +
+            '`onChange` handler. This will render a read-only field. If ' +
+            'the field should be mutable use `defaultValue`. Otherwise, ' +
+            'set either `onChange` or `readOnly`.'
+          ) : null);
+        }
+      },
+      checked: function(props, propName, componentName) {
+        if ("production" !== "development") {
+          ("production" !== "development" ? warning(
+            !props[propName] ||
+            props.onChange ||
+            props.readOnly ||
+            props.disabled,
+            'You provided a `checked` prop to a form field without an ' +
+            '`onChange` handler. This will render a read-only field. If ' +
+            'the field should be mutable use `defaultChecked`. Otherwise, ' +
+            'set either `onChange` or `readOnly`.'
+          ) : null);
+        }
+      },
+      onChange: ReactPropTypes.func
+    }
+  },
+
+  /**
+   * @param {ReactComponent} input Form component
+   * @return {*} current value of the input either from value prop or link.
+   */
+  getValue: function(input) {
+    if (input.props.valueLink) {
+      _assertValueLink(input);
+      return input.props.valueLink.value;
+    }
+    return input.props.value;
+  },
+
+  /**
+   * @param {ReactComponent} input Form component
+   * @return {*} current checked status of the input either from checked prop
+   *             or link.
+   */
+  getChecked: function(input) {
+    if (input.props.checkedLink) {
+      _assertCheckedLink(input);
+      return input.props.checkedLink.value;
+    }
+    return input.props.checked;
+  },
+
+  /**
+   * @param {ReactComponent} input Form component
+   * @return {function} change callback either from onChange prop or link.
+   */
+  getOnChange: function(input) {
+    if (input.props.valueLink) {
+      _assertValueLink(input);
+      return _handleLinkedValueChange;
+    } else if (input.props.checkedLink) {
+      _assertCheckedLink(input);
+      return _handleLinkedCheckChange;
+    }
+    return input.props.onChange;
+  }
+};
+
+module.exports = LinkedValueUtils;
+
+},{"./ReactPropTypes":64,"./invariant":112,"./warning":134}],22:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule MobileSafariClickEventPlugin
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var EventConstants = _dereq_("./EventConstants");
+
+var emptyFunction = _dereq_("./emptyFunction");
+
+var topLevelTypes = EventConstants.topLevelTypes;
+
+/**
+ * Mobile Safari does not fire properly bubble click events on non-interactive
+ * elements, which means delegated click listeners do not fire. The workaround
+ * for this bug involves attaching an empty click listener on the target node.
+ *
+ * This particular plugin works around the bug by attaching an empty click
+ * listener on `touchstart` (which does fire on every element).
+ */
+var MobileSafariClickEventPlugin = {
+
+  eventTypes: null,
+
+  /**
+   * @param {string} topLevelType Record from `EventConstants`.
+   * @param {DOMEventTarget} topLevelTarget The listening component root node.
+   * @param {string} topLevelTargetID ID of `topLevelTarget`.
+   * @param {object} nativeEvent Native browser event.
+   * @return {*} An accumulation of synthetic events.
+   * @see {EventPluginHub.extractEvents}
+   */
+  extractEvents: function(
+      topLevelType,
+      topLevelTarget,
+      topLevelTargetID,
+      nativeEvent) {
+    if (topLevelType === topLevelTypes.topTouchStart) {
+      var target = nativeEvent.target;
+      if (target && !target.onclick) {
+        target.onclick = emptyFunction;
+      }
+    }
+  }
+
+};
+
+module.exports = MobileSafariClickEventPlugin;
+
+},{"./EventConstants":14,"./emptyFunction":96}],23:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule PooledClass
+ */
+
+"use strict";
+
+var invariant = _dereq_("./invariant");
+
+/**
+ * Static poolers. Several custom versions for each potential number of
+ * arguments. A completely generic pooler is easy to implement, but would
+ * require accessing the `arguments` object. In each of these, `this` refers to
+ * the Class itself, not an instance. If any others are needed, simply add them
+ * here, or in their own files.
+ */
+var oneArgumentPooler = function(copyFieldsFrom) {
+  var Klass = this;
+  if (Klass.instancePool.length) {
+    var instance = Klass.instancePool.pop();
+    Klass.call(instance, copyFieldsFrom);
+    return instance;
+  } else {
+    return new Klass(copyFieldsFrom);
+  }
+};
+
+var twoArgumentPooler = function(a1, a2) {
+  var Klass = this;
+  if (Klass.instancePool.length) {
+    var instance = Klass.instancePool.pop();
+    Klass.call(instance, a1, a2);
+    return instance;
+  } else {
+    return new Klass(a1, a2);
+  }
+};
+
+var threeArgumentPooler = function(a1, a2, a3) {
+  var Klass = this;
+  if (Klass.instancePool.length) {
+    var instance = Klass.instancePool.pop();
+    Klass.call(instance, a1, a2, a3);
+    return instance;
+  } else {
+    return new Klass(a1, a2, a3);
+  }
+};
+
+var fiveArgumentPooler = function(a1, a2, a3, a4, a5) {
+  var Klass = this;
+  if (Klass.instancePool.length) {
+    var instance = Klass.instancePool.pop();
+    Klass.call(instance, a1, a2, a3, a4, a5);
+    return instance;
+  } else {
+    return new Klass(a1, a2, a3, a4, a5);
+  }
+};
+
+var standardReleaser = function(instance) {
+  var Klass = this;
+  ("production" !== "development" ? invariant(
+    instance instanceof Klass,
+    'Trying to release an instance into a pool of a different type.'
+  ) : invariant(instance instanceof Klass));
+  if (instance.destructor) {
+    instance.destructor();
+  }
+  if (Klass.instancePool.length < Klass.poolSize) {
+    Klass.instancePool.push(instance);
+  }
+};
+
+var DEFAULT_POOL_SIZE = 10;
+var DEFAULT_POOLER = oneArgumentPooler;
+
+/**
+ * Augments `CopyConstructor` to be a poolable class, augmenting only the class
+ * itself (statically) not adding any prototypical fields. Any CopyConstructor
+ * you give this may have a `poolSize` property, and will look for a
+ * prototypical `destructor` on instances (optional).
+ *
+ * @param {Function} CopyConstructor Constructor that can be used to reset.
+ * @param {Function} pooler Customizable pooler.
+ */
+var addPoolingTo = function(CopyConstructor, pooler) {
+  var NewKlass = CopyConstructor;
+  NewKlass.instancePool = [];
+  NewKlass.getPooled = pooler || DEFAULT_POOLER;
+  if (!NewKlass.poolSize) {
+    NewKlass.poolSize = DEFAULT_POOL_SIZE;
+  }
+  NewKlass.release = standardReleaser;
+  return NewKlass;
+};
+
+var PooledClass = {
+  addPoolingTo: addPoolingTo,
+  oneArgumentPooler: oneArgumentPooler,
+  twoArgumentPooler: twoArgumentPooler,
+  threeArgumentPooler: threeArgumentPooler,
+  fiveArgumentPooler: fiveArgumentPooler
+};
+
+module.exports = PooledClass;
+
+},{"./invariant":112}],24:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule React
+ */
+
+"use strict";
+
+var DOMPropertyOperations = _dereq_("./DOMPropertyOperations");
+var EventPluginUtils = _dereq_("./EventPluginUtils");
+var ReactChildren = _dereq_("./ReactChildren");
+var ReactComponent = _dereq_("./ReactComponent");
+var ReactCompositeComponent = _dereq_("./ReactCompositeComponent");
+var ReactContext = _dereq_("./ReactContext");
+var ReactCurrentOwner = _dereq_("./ReactCurrentOwner");
+var ReactDOM = _dereq_("./ReactDOM");
+var ReactDOMComponent = _dereq_("./ReactDOMComponent");
+var ReactDefaultInjection = _dereq_("./ReactDefaultInjection");
+var ReactInstanceHandles = _dereq_("./ReactInstanceHandles");
+var ReactMount = _dereq_("./ReactMount");
+var ReactMultiChild = _dereq_("./ReactMultiChild");
+var ReactPerf = _dereq_("./ReactPerf");
+var ReactPropTypes = _dereq_("./ReactPropTypes");
+var ReactServerRendering = _dereq_("./ReactServerRendering");
+var ReactTextComponent = _dereq_("./ReactTextComponent");
+
+var onlyChild = _dereq_("./onlyChild");
+
+ReactDefaultInjection.inject();
+
+var React = {
+  Children: {
+    map: ReactChildren.map,
+    forEach: ReactChildren.forEach,
+    only: onlyChild
+  },
+  DOM: ReactDOM,
+  PropTypes: ReactPropTypes,
+  initializeTouchEvents: function(shouldUseTouch) {
+    EventPluginUtils.useTouchEvents = shouldUseTouch;
+  },
+  createClass: ReactCompositeComponent.createClass,
+  constructAndRenderComponent: ReactMount.constructAndRenderComponent,
+  constructAndRenderComponentByID: ReactMount.constructAndRenderComponentByID,
+  renderComponent: ReactPerf.measure(
+    'React',
+    'renderComponent',
+    ReactMount.renderComponent
+  ),
+  renderComponentToString: ReactServerRendering.renderComponentToString,
+  renderComponentToStaticMarkup:
+    ReactServerRendering.renderComponentToStaticMarkup,
+  unmountComponentAtNode: ReactMount.unmountComponentAtNode,
+  isValidClass: ReactCompositeComponent.isValidClass,
+  isValidComponent: ReactComponent.isValidComponent,
+  withContext: ReactContext.withContext,
+  __internals: {
+    Component: ReactComponent,
+    CurrentOwner: ReactCurrentOwner,
+    DOMComponent: ReactDOMComponent,
+    DOMPropertyOperations: DOMPropertyOperations,
+    InstanceHandles: ReactInstanceHandles,
+    Mount: ReactMount,
+    MultiChild: ReactMultiChild,
+    TextComponent: ReactTextComponent
+  }
+};
+
+if ("production" !== "development") {
+  var ExecutionEnvironment = _dereq_("./ExecutionEnvironment");
+  if (ExecutionEnvironment.canUseDOM &&
+      window.top === window.self &&
+      navigator.userAgent.indexOf('Chrome') > -1) {
+    console.debug(
+      'Download the React DevTools for a better development experience: ' +
+      'http://fb.me/react-devtools'
+    );
+  }
+}
+
+// Version exists only in the open-source version of React, not in Facebook's
+// internal version.
+React.version = '0.10.0';
+
+module.exports = React;
+
+},{"./DOMPropertyOperations":9,"./EventPluginUtils":18,"./ExecutionEnvironment":20,"./ReactChildren":26,"./ReactComponent":27,"./ReactCompositeComponent":29,"./ReactContext":30,"./ReactCurrentOwner":31,"./ReactDOM":32,"./ReactDOMComponent":34,"./ReactDefaultInjection":44,"./ReactInstanceHandles":53,"./ReactMount":55,"./ReactMultiChild":57,"./ReactPerf":60,"./ReactPropTypes":64,"./ReactServerRendering":68,"./ReactTextComponent":70,"./onlyChild":128}],25:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactBrowserComponentMixin
+ */
+
+"use strict";
+
+var ReactMount = _dereq_("./ReactMount");
+
+var invariant = _dereq_("./invariant");
+
+var ReactBrowserComponentMixin = {
+  /**
+   * Returns the DOM node rendered by this component.
+   *
+   * @return {DOMElement} The root node of this component.
+   * @final
+   * @protected
+   */
+  getDOMNode: function() {
+    ("production" !== "development" ? invariant(
+      this.isMounted(),
+      'getDOMNode(): A component must be mounted to have a DOM node.'
+    ) : invariant(this.isMounted()));
+    return ReactMount.getNode(this._rootNodeID);
+  }
+};
+
+module.exports = ReactBrowserComponentMixin;
+
+},{"./ReactMount":55,"./invariant":112}],26:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactChildren
+ */
+
+"use strict";
+
+var PooledClass = _dereq_("./PooledClass");
+
+var invariant = _dereq_("./invariant");
+var traverseAllChildren = _dereq_("./traverseAllChildren");
+
+var twoArgumentPooler = PooledClass.twoArgumentPooler;
+var threeArgumentPooler = PooledClass.threeArgumentPooler;
+
+/**
+ * PooledClass representing the bookkeeping associated with performing a child
+ * traversal. Allows avoiding binding callbacks.
+ *
+ * @constructor ForEachBookKeeping
+ * @param {!function} forEachFunction Function to perform traversal with.
+ * @param {?*} forEachContext Context to perform context with.
+ */
+function ForEachBookKeeping(forEachFunction, forEachContext) {
+  this.forEachFunction = forEachFunction;
+  this.forEachContext = forEachContext;
+}
+PooledClass.addPoolingTo(ForEachBookKeeping, twoArgumentPooler);
+
+function forEachSingleChild(traverseContext, child, name, i) {
+  var forEachBookKeeping = traverseContext;
+  forEachBookKeeping.forEachFunction.call(
+    forEachBookKeeping.forEachContext, child, i);
+}
+
+/**
+ * Iterates through children that are typically specified as `props.children`.
+ *
+ * The provided forEachFunc(child, index) will be called for each
+ * leaf child.
+ *
+ * @param {?*} children Children tree container.
+ * @param {function(*, int)} forEachFunc.
+ * @param {*} forEachContext Context for forEachContext.
+ */
+function forEachChildren(children, forEachFunc, forEachContext) {
+  if (children == null) {
+    return children;
+  }
+
+  var traverseContext =
+    ForEachBookKeeping.getPooled(forEachFunc, forEachContext);
+  traverseAllChildren(children, forEachSingleChild, traverseContext);
+  ForEachBookKeeping.release(traverseContext);
+}
+
+/**
+ * PooledClass representing the bookkeeping associated with performing a child
+ * mapping. Allows avoiding binding callbacks.
+ *
+ * @constructor MapBookKeeping
+ * @param {!*} mapResult Object containing the ordered map of results.
+ * @param {!function} mapFunction Function to perform mapping with.
+ * @param {?*} mapContext Context to perform mapping with.
+ */
+function MapBookKeeping(mapResult, mapFunction, mapContext) {
+  this.mapResult = mapResult;
+  this.mapFunction = mapFunction;
+  this.mapContext = mapContext;
+}
+PooledClass.addPoolingTo(MapBookKeeping, threeArgumentPooler);
+
+function mapSingleChildIntoContext(traverseContext, child, name, i) {
+  var mapBookKeeping = traverseContext;
+  var mapResult = mapBookKeeping.mapResult;
+  var mappedChild =
+    mapBookKeeping.mapFunction.call(mapBookKeeping.mapContext, child, i);
+  // We found a component instance
+  ("production" !== "development" ? invariant(
+    !mapResult.hasOwnProperty(name),
+    'ReactChildren.map(...): Encountered two children with the same key, ' +
+    '`%s`. Children keys must be unique.',
+    name
+  ) : invariant(!mapResult.hasOwnProperty(name)));
+  mapResult[name] = mappedChild;
+}
+
+/**
+ * Maps children that are typically specified as `props.children`.
+ *
+ * The provided mapFunction(child, key, index) will be called for each
+ * leaf child.
+ *
+ * TODO: This may likely break any calls to `ReactChildren.map` that were
+ * previously relying on the fact that we guarded against null children.
+ *
+ * @param {?*} children Children tree container.
+ * @param {function(*, int)} mapFunction.
+ * @param {*} mapContext Context for mapFunction.
+ * @return {object} Object containing the ordered map of results.
+ */
+function mapChildren(children, func, context) {
+  if (children == null) {
+    return children;
+  }
+
+  var mapResult = {};
+  var traverseContext = MapBookKeeping.getPooled(mapResult, func, context);
+  traverseAllChildren(children, mapSingleChildIntoContext, traverseContext);
+  MapBookKeeping.release(traverseContext);
+  return mapResult;
+}
+
+var ReactChildren = {
+  forEach: forEachChildren,
+  map: mapChildren
+};
+
+module.exports = ReactChildren;
+
+},{"./PooledClass":23,"./invariant":112,"./traverseAllChildren":133}],27:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactComponent
+ */
+
+"use strict";
+
+var ReactCurrentOwner = _dereq_("./ReactCurrentOwner");
+var ReactOwner = _dereq_("./ReactOwner");
+var ReactUpdates = _dereq_("./ReactUpdates");
+
+var invariant = _dereq_("./invariant");
+var keyMirror = _dereq_("./keyMirror");
+var merge = _dereq_("./merge");
+var monitorCodeUse = _dereq_("./monitorCodeUse");
+
+/**
+ * Every React component is in one of these life cycles.
+ */
+var ComponentLifeCycle = keyMirror({
+  /**
+   * Mounted components have a DOM node representation and are capable of
+   * receiving new props.
+   */
+  MOUNTED: null,
+  /**
+   * Unmounted components are inactive and cannot receive new props.
+   */
+  UNMOUNTED: null
+});
+
+/**
+ * Warn if there's no key explicitly set on dynamic arrays of children or
+ * object keys are not valid. This allows us to keep track of children between
+ * updates.
+ */
+
+var ownerHasExplicitKeyWarning = {};
+var ownerHasPropertyWarning = {};
+var ownerHasMonitoredObjectMap = {};
+
+var NUMERIC_PROPERTY_REGEX = /^\d+$/;
+
+var injected = false;
+
+/**
+ * Optionally injectable environment dependent cleanup hook. (server vs.
+ * browser etc). Example: A browser system caches DOM nodes based on component
+ * ID and must remove that cache entry when this instance is unmounted.
+ *
+ * @private
+ */
+var unmountIDFromEnvironment = null;
+
+/**
+ * The "image" of a component tree, is the platform specific (typically
+ * serialized) data that represents a tree of lower level UI building blocks.
+ * On the web, this "image" is HTML markup which describes a construction of
+ * low level `div` and `span` nodes. Other platforms may have different
+ * encoding of this "image". This must be injected.
+ *
+ * @private
+ */
+var mountImageIntoNode = null;
+
+/**
+ * Warn if the component doesn't have an explicit key assigned to it.
+ * This component is in an array. The array could grow and shrink or be
+ * reordered. All children that haven't already been validated are required to
+ * have a "key" property assigned to it.
+ *
+ * @internal
+ * @param {ReactComponent} component Component that requires a key.
+ */
+function validateExplicitKey(component) {
+  if (component.__keyValidated__ || component.props.key != null) {
+    return;
+  }
+  component.__keyValidated__ = true;
+
+  // We can't provide friendly warnings for top level components.
+  if (!ReactCurrentOwner.current) {
+    return;
+  }
+
+  // Name of the component whose render method tried to pass children.
+  var currentName = ReactCurrentOwner.current.constructor.displayName;
+  if (ownerHasExplicitKeyWarning.hasOwnProperty(currentName)) {
+    return;
+  }
+  ownerHasExplicitKeyWarning[currentName] = true;
+
+  var message = 'Each child in an array should have a unique "key" prop. ' +
+                'Check the render method of ' + currentName + '.';
+
+  var childOwnerName = null;
+  if (!component.isOwnedBy(ReactCurrentOwner.current)) {
+    // Name of the component that originally created this child.
+    childOwnerName =
+      component._owner &&
+      component._owner.constructor.displayName;
+
+    // Usually the current owner is the offender, but if it accepts
+    // children as a property, it may be the creator of the child that's
+    // responsible for assigning it a key.
+    message += ' It was passed a child from ' + childOwnerName + '.';
+  }
+
+  message += ' See http://fb.me/react-warning-keys for more information.';
+  monitorCodeUse('react_key_warning', {
+    component: currentName,
+    componentOwner: childOwnerName
+  });
+  console.warn(message);
+}
+
+/**
+ * Warn if the key is being defined as an object property but has an incorrect
+ * value.
+ *
+ * @internal
+ * @param {string} name Property name of the key.
+ * @param {ReactComponent} component Component that requires a key.
+ */
+function validatePropertyKey(name) {
+  if (NUMERIC_PROPERTY_REGEX.test(name)) {
+    // Name of the component whose render method tried to pass children.
+    var currentName = ReactCurrentOwner.current.constructor.displayName;
+    if (ownerHasPropertyWarning.hasOwnProperty(currentName)) {
+      return;
+    }
+    ownerHasPropertyWarning[currentName] = true;
+
+    monitorCodeUse('react_numeric_key_warning');
+    console.warn(
+      'Child objects should have non-numeric keys so ordering is preserved. ' +
+      'Check the render method of ' + currentName + '. ' +
+      'See http://fb.me/react-warning-keys for more information.'
+    );
+  }
+}
+
+/**
+ * Log that we're using an object map. We're considering deprecating this
+ * feature and replace it with proper Map and ImmutableMap data structures.
+ *
+ * @internal
+ */
+function monitorUseOfObjectMap() {
+  // Name of the component whose render method tried to pass children.
+  // We only use this to avoid spewing the logs. We lose additional
+  // owner stacks but hopefully one level is enough to trace the source.
+  var currentName = (ReactCurrentOwner.current &&
+                    ReactCurrentOwner.current.constructor.displayName) || '';
+  if (ownerHasMonitoredObjectMap.hasOwnProperty(currentName)) {
+    return;
+  }
+  ownerHasMonitoredObjectMap[currentName] = true;
+  monitorCodeUse('react_object_map_children');
+}
+
+/**
+ * Ensure that every component either is passed in a static location, in an
+ * array with an explicit keys property defined, or in an object literal
+ * with valid key property.
+ *
+ * @internal
+ * @param {*} component Statically passed child of any type.
+ * @return {boolean}
+ */
+function validateChildKeys(component) {
+  if (Array.isArray(component)) {
+    for (var i = 0; i < component.length; i++) {
+      var child = component[i];
+      if (ReactComponent.isValidComponent(child)) {
+        validateExplicitKey(child);
+      }
+    }
+  } else if (ReactComponent.isValidComponent(component)) {
+    // This component was passed in a valid location.
+    component.__keyValidated__ = true;
+  } else if (component && typeof component === 'object') {
+    monitorUseOfObjectMap();
+    for (var name in component) {
+      validatePropertyKey(name, component);
+    }
+  }
+}
+
+/**
+ * Components are the basic units of composition in React.
+ *
+ * Every component accepts a set of keyed input parameters known as "props" that
+ * are initialized by the constructor. Once a component is mounted, the props
+ * can be mutated using `setProps` or `replaceProps`.
+ *
+ * Every component is capable of the following operations:
+ *
+ *   `mountComponent`
+ *     Initializes the component, renders markup, and registers event listeners.
+ *
+ *   `receiveComponent`
+ *     Updates the rendered DOM nodes to match the given component.
+ *
+ *   `unmountComponent`
+ *     Releases any resources allocated by this component.
+ *
+ * Components can also be "owned" by other components. Being owned by another
+ * component means being constructed by that component. This is different from
+ * being the child of a component, which means having a DOM representation that
+ * is a child of the DOM representation of that component.
+ *
+ * @class ReactComponent
+ */
+var ReactComponent = {
+
+  injection: {
+    injectEnvironment: function(ReactComponentEnvironment) {
+      ("production" !== "development" ? invariant(
+        !injected,
+        'ReactComponent: injectEnvironment() can only be called once.'
+      ) : invariant(!injected));
+      mountImageIntoNode = ReactComponentEnvironment.mountImageIntoNode;
+      unmountIDFromEnvironment =
+        ReactComponentEnvironment.unmountIDFromEnvironment;
+      ReactComponent.BackendIDOperations =
+        ReactComponentEnvironment.BackendIDOperations;
+      ReactComponent.ReactReconcileTransaction =
+        ReactComponentEnvironment.ReactReconcileTransaction;
+      injected = true;
+    }
+  },
+
+  /**
+   * @param {?object} object
+   * @return {boolean} True if `object` is a valid component.
+   * @final
+   */
+  isValidComponent: function(object) {
+    if (!object || !object.type || !object.type.prototype) {
+      return false;
+    }
+    // This is the safer way of duck checking the type of instance this is.
+    // The object can be a generic descriptor but the type property refers to
+    // the constructor and it's prototype can be used to inspect the type that
+    // will actually get mounted.
+    var prototype = object.type.prototype;
+    return (
+      typeof prototype.mountComponentIntoNode === 'function' &&
+      typeof prototype.receiveComponent === 'function'
+    );
+  },
+
+  /**
+   * @internal
+   */
+  LifeCycle: ComponentLifeCycle,
+
+  /**
+   * Injected module that provides ability to mutate individual properties.
+   * Injected into the base class because many different subclasses need access
+   * to this.
+   *
+   * @internal
+   */
+  BackendIDOperations: null,
+
+  /**
+   * React references `ReactReconcileTransaction` using this property in order
+   * to allow dependency injection.
+   *
+   * @internal
+   */
+  ReactReconcileTransaction: null,
+
+  /**
+   * Base functionality for every ReactComponent constructor. Mixed into the
+   * `ReactComponent` prototype, but exposed statically for easy access.
+   *
+   * @lends {ReactComponent.prototype}
+   */
+  Mixin: {
+
+    /**
+     * Checks whether or not this component is mounted.
+     *
+     * @return {boolean} True if mounted, false otherwise.
+     * @final
+     * @protected
+     */
+    isMounted: function() {
+      return this._lifeCycleState === ComponentLifeCycle.MOUNTED;
+    },
+
+    /**
+     * Sets a subset of the props.
+     *
+     * @param {object} partialProps Subset of the next props.
+     * @param {?function} callback Called after props are updated.
+     * @final
+     * @public
+     */
+    setProps: function(partialProps, callback) {
+      // Merge with `_pendingProps` if it exists, otherwise with existing props.
+      this.replaceProps(
+        merge(this._pendingProps || this.props, partialProps),
+        callback
+      );
+    },
+
+    /**
+     * Replaces all of the props.
+     *
+     * @param {object} props New props.
+     * @param {?function} callback Called after props are updated.
+     * @final
+     * @public
+     */
+    replaceProps: function(props, callback) {
+      ("production" !== "development" ? invariant(
+        this.isMounted(),
+        'replaceProps(...): Can only update a mounted component.'
+      ) : invariant(this.isMounted()));
+      ("production" !== "development" ? invariant(
+        this._mountDepth === 0,
+        'replaceProps(...): You called `setProps` or `replaceProps` on a ' +
+        'component with a parent. This is an anti-pattern since props will ' +
+        'get reactively updated when rendered. Instead, change the owner\'s ' +
+        '`render` method to pass the correct value as props to the component ' +
+        'where it is created.'
+      ) : invariant(this._mountDepth === 0));
+      this._pendingProps = props;
+      ReactUpdates.enqueueUpdate(this, callback);
+    },
+
+    /**
+     * Base constructor for all React components.
+     *
+     * Subclasses that override this method should make sure to invoke
+     * `ReactComponent.Mixin.construct.call(this, ...)`.
+     *
+     * @param {?object} initialProps
+     * @param {*} children
+     * @internal
+     */
+    construct: function(initialProps, children) {
+      this.props = initialProps || {};
+      // Record the component responsible for creating this component.
+      this._owner = ReactCurrentOwner.current;
+      // All components start unmounted.
+      this._lifeCycleState = ComponentLifeCycle.UNMOUNTED;
+
+      this._pendingProps = null;
+      this._pendingCallbacks = null;
+
+      // Unlike _pendingProps and _pendingCallbacks, we won't use null to
+      // indicate that nothing is pending because it's possible for a component
+      // to have a null owner. Instead, an owner change is pending when
+      // this._owner !== this._pendingOwner.
+      this._pendingOwner = this._owner;
+
+      // Children can be more than one argument
+      var childrenLength = arguments.length - 1;
+      if (childrenLength === 1) {
+        if ("production" !== "development") {
+          validateChildKeys(children);
+        }
+        this.props.children = children;
+      } else if (childrenLength > 1) {
+        var childArray = Array(childrenLength);
+        for (var i = 0; i < childrenLength; i++) {
+          if ("production" !== "development") {
+            validateChildKeys(arguments[i + 1]);
+          }
+          childArray[i] = arguments[i + 1];
+        }
+        this.props.children = childArray;
+      }
+    },
+
+    /**
+     * Initializes the component, renders markup, and registers event listeners.
+     *
+     * NOTE: This does not insert any nodes into the DOM.
+     *
+     * Subclasses that override this method should make sure to invoke
+     * `ReactComponent.Mixin.mountComponent.call(this, ...)`.
+     *
+     * @param {string} rootID DOM ID of the root node.
+     * @param {ReactReconcileTransaction|ReactServerRenderingTransaction} transaction
+     * @param {number} mountDepth number of components in the owner hierarchy.
+     * @return {?string} Rendered markup to be inserted into the DOM.
+     * @internal
+     */
+    mountComponent: function(rootID, transaction, mountDepth) {
+      ("production" !== "development" ? invariant(
+        !this.isMounted(),
+        'mountComponent(%s, ...): Can only mount an unmounted component. ' +
+        'Make sure to avoid storing components between renders or reusing a ' +
+        'single component instance in multiple places.',
+        rootID
+      ) : invariant(!this.isMounted()));
+      var props = this.props;
+      if (props.ref != null) {
+        ReactOwner.addComponentAsRefTo(this, props.ref, this._owner);
+      }
+      this._rootNodeID = rootID;
+      this._lifeCycleState = ComponentLifeCycle.MOUNTED;
+      this._mountDepth = mountDepth;
+      // Effectively: return '';
+    },
+
+    /**
+     * Releases any resources allocated by `mountComponent`.
+     *
+     * NOTE: This does not remove any nodes from the DOM.
+     *
+     * Subclasses that override this method should make sure to invoke
+     * `ReactComponent.Mixin.unmountComponent.call(this)`.
+     *
+     * @internal
+     */
+    unmountComponent: function() {
+      ("production" !== "development" ? invariant(
+        this.isMounted(),
+        'unmountComponent(): Can only unmount a mounted component.'
+      ) : invariant(this.isMounted()));
+      var props = this.props;
+      if (props.ref != null) {
+        ReactOwner.removeComponentAsRefFrom(this, props.ref, this._owner);
+      }
+      unmountIDFromEnvironment(this._rootNodeID);
+      this._rootNodeID = null;
+      this._lifeCycleState = ComponentLifeCycle.UNMOUNTED;
+    },
+
+    /**
+     * Given a new instance of this component, updates the rendered DOM nodes
+     * as if that instance was rendered instead.
+     *
+     * Subclasses that override this method should make sure to invoke
+     * `ReactComponent.Mixin.receiveComponent.call(this, ...)`.
+     *
+     * @param {object} nextComponent Next set of properties.
+     * @param {ReactReconcileTransaction} transaction
+     * @internal
+     */
+    receiveComponent: function(nextComponent, transaction) {
+      ("production" !== "development" ? invariant(
+        this.isMounted(),
+        'receiveComponent(...): Can only update a mounted component.'
+      ) : invariant(this.isMounted()));
+      this._pendingOwner = nextComponent._owner;
+      this._pendingProps = nextComponent.props;
+      this._performUpdateIfNecessary(transaction);
+    },
+
+    /**
+     * Call `_performUpdateIfNecessary` within a new transaction.
+     *
+     * @internal
+     */
+    performUpdateIfNecessary: function() {
+      var transaction = ReactComponent.ReactReconcileTransaction.getPooled();
+      transaction.perform(this._performUpdateIfNecessary, this, transaction);
+      ReactComponent.ReactReconcileTransaction.release(transaction);
+    },
+
+    /**
+     * If `_pendingProps` is set, update the component.
+     *
+     * @param {ReactReconcileTransaction} transaction
+     * @internal
+     */
+    _performUpdateIfNecessary: function(transaction) {
+      if (this._pendingProps == null) {
+        return;
+      }
+      var prevProps = this.props;
+      var prevOwner = this._owner;
+      this.props = this._pendingProps;
+      this._owner = this._pendingOwner;
+      this._pendingProps = null;
+      this.updateComponent(transaction, prevProps, prevOwner);
+    },
+
+    /**
+     * Updates the component's currently mounted representation.
+     *
+     * @param {ReactReconcileTransaction} transaction
+     * @param {object} prevProps
+     * @internal
+     */
+    updateComponent: function(transaction, prevProps, prevOwner) {
+      var props = this.props;
+      // If either the owner or a `ref` has changed, make sure the newest owner
+      // has stored a reference to `this`, and the previous owner (if different)
+      // has forgotten the reference to `this`.
+      if (this._owner !== prevOwner || props.ref !== prevProps.ref) {
+        if (prevProps.ref != null) {
+          ReactOwner.removeComponentAsRefFrom(
+            this, prevProps.ref, prevOwner
+          );
+        }
+        // Correct, even if the owner is the same, and only the ref has changed.
+        if (props.ref != null) {
+          ReactOwner.addComponentAsRefTo(this, props.ref, this._owner);
+        }
+      }
+    },
+
+    /**
+     * Mounts this component and inserts it into the DOM.
+     *
+     * @param {string} rootID DOM ID of the root node.
+     * @param {DOMElement} container DOM element to mount into.
+     * @param {boolean} shouldReuseMarkup If true, do not insert markup
+     * @final
+     * @internal
+     * @see {ReactMount.renderComponent}
+     */
+    mountComponentIntoNode: function(rootID, container, shouldReuseMarkup) {
+      var transaction = ReactComponent.ReactReconcileTransaction.getPooled();
+      transaction.perform(
+        this._mountComponentIntoNode,
+        this,
+        rootID,
+        container,
+        transaction,
+        shouldReuseMarkup
+      );
+      ReactComponent.ReactReconcileTransaction.release(transaction);
+    },
+
+    /**
+     * @param {string} rootID DOM ID of the root node.
+     * @param {DOMElement} container DOM element to mount into.
+     * @param {ReactReconcileTransaction} transaction
+     * @param {boolean} shouldReuseMarkup If true, do not insert markup
+     * @final
+     * @private
+     */
+    _mountComponentIntoNode: function(
+        rootID,
+        container,
+        transaction,
+        shouldReuseMarkup) {
+      var markup = this.mountComponent(rootID, transaction, 0);
+      mountImageIntoNode(markup, container, shouldReuseMarkup);
+    },
+
+    /**
+     * Checks if this component is owned by the supplied `owner` component.
+     *
+     * @param {ReactComponent} owner Component to check.
+     * @return {boolean} True if `owners` owns this component.
+     * @final
+     * @internal
+     */
+    isOwnedBy: function(owner) {
+      return this._owner === owner;
+    },
+
+    /**
+     * Gets another component, that shares the same owner as this one, by ref.
+     *
+     * @param {string} ref of a sibling Component.
+     * @return {?ReactComponent} the actual sibling Component.
+     * @final
+     * @internal
+     */
+    getSiblingByRef: function(ref) {
+      var owner = this._owner;
+      if (!owner || !owner.refs) {
+        return null;
+      }
+      return owner.refs[ref];
+    }
+  }
+};
+
+module.exports = ReactComponent;
+
+},{"./ReactCurrentOwner":31,"./ReactOwner":59,"./ReactUpdates":71,"./invariant":112,"./keyMirror":118,"./merge":121,"./monitorCodeUse":125}],28:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactComponentBrowserEnvironment
+ */
+
+/*jslint evil: true */
+
+"use strict";
+
+var ReactDOMIDOperations = _dereq_("./ReactDOMIDOperations");
+var ReactMarkupChecksum = _dereq_("./ReactMarkupChecksum");
+var ReactMount = _dereq_("./ReactMount");
+var ReactPerf = _dereq_("./ReactPerf");
+var ReactReconcileTransaction = _dereq_("./ReactReconcileTransaction");
+
+var getReactRootElementInContainer = _dereq_("./getReactRootElementInContainer");
+var invariant = _dereq_("./invariant");
+
+
+var ELEMENT_NODE_TYPE = 1;
+var DOC_NODE_TYPE = 9;
+
+
+/**
+ * Abstracts away all functionality of `ReactComponent` requires knowledge of
+ * the browser context.
+ */
+var ReactComponentBrowserEnvironment = {
+  ReactReconcileTransaction: ReactReconcileTransaction,
+
+  BackendIDOperations: ReactDOMIDOperations,
+
+  /**
+   * If a particular environment requires that some resources be cleaned up,
+   * specify this in the injected Mixin. In the DOM, we would likely want to
+   * purge any cached node ID lookups.
+   *
+   * @private
+   */
+  unmountIDFromEnvironment: function(rootNodeID) {
+    ReactMount.purgeID(rootNodeID);
+  },
+
+  /**
+   * @param {string} markup Markup string to place into the DOM Element.
+   * @param {DOMElement} container DOM Element to insert markup into.
+   * @param {boolean} shouldReuseMarkup Should reuse the existing markup in the
+   * container if possible.
+   */
+  mountImageIntoNode: ReactPerf.measure(
+    'ReactComponentBrowserEnvironment',
+    'mountImageIntoNode',
+    function(markup, container, shouldReuseMarkup) {
+      ("production" !== "development" ? invariant(
+        container && (
+          container.nodeType === ELEMENT_NODE_TYPE ||
+            container.nodeType === DOC_NODE_TYPE
+        ),
+        'mountComponentIntoNode(...): Target container is not valid.'
+      ) : invariant(container && (
+        container.nodeType === ELEMENT_NODE_TYPE ||
+          container.nodeType === DOC_NODE_TYPE
+      )));
+
+      if (shouldReuseMarkup) {
+        if (ReactMarkupChecksum.canReuseMarkup(
+          markup,
+          getReactRootElementInContainer(container))) {
+          return;
+        } else {
+          ("production" !== "development" ? invariant(
+            container.nodeType !== DOC_NODE_TYPE,
+            'You\'re trying to render a component to the document using ' +
+            'server rendering but the checksum was invalid. This usually ' +
+            'means you rendered a different component type or props on ' +
+            'the client from the one on the server, or your render() ' +
+            'methods are impure. React cannot handle this case due to ' +
+            'cross-browser quirks by rendering at the document root. You ' +
+            'should look for environment dependent code in your components ' +
+            'and ensure the props are the same client and server side.'
+          ) : invariant(container.nodeType !== DOC_NODE_TYPE));
+
+          if ("production" !== "development") {
+            console.warn(
+              'React attempted to use reuse markup in a container but the ' +
+              'checksum was invalid. This generally means that you are ' +
+              'using server rendering and the markup generated on the ' +
+              'server was not what the client was expecting. React injected' +
+              'new markup to compensate which works but you have lost many ' +
+              'of the benefits of server rendering. Instead, figure out ' +
+              'why the markup being generated is different on the client ' +
+              'or server.'
+            );
+          }
+        }
+      }
+
+      ("production" !== "development" ? invariant(
+        container.nodeType !== DOC_NODE_TYPE,
+        'You\'re trying to render a component to the document but ' +
+          'you didn\'t use server rendering. We can\'t do this ' +
+          'without using server rendering due to cross-browser quirks. ' +
+          'See renderComponentToString() for server rendering.'
+      ) : invariant(container.nodeType !== DOC_NODE_TYPE));
+
+      container.innerHTML = markup;
+    }
+  )
+};
+
+module.exports = ReactComponentBrowserEnvironment;
+
+},{"./ReactDOMIDOperations":36,"./ReactMarkupChecksum":54,"./ReactMount":55,"./ReactPerf":60,"./ReactReconcileTransaction":66,"./getReactRootElementInContainer":107,"./invariant":112}],29:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactCompositeComponent
+ */
+
+"use strict";
+
+var ReactComponent = _dereq_("./ReactComponent");
+var ReactContext = _dereq_("./ReactContext");
+var ReactCurrentOwner = _dereq_("./ReactCurrentOwner");
+var ReactErrorUtils = _dereq_("./ReactErrorUtils");
+var ReactOwner = _dereq_("./ReactOwner");
+var ReactPerf = _dereq_("./ReactPerf");
+var ReactPropTransferer = _dereq_("./ReactPropTransferer");
+var ReactPropTypeLocations = _dereq_("./ReactPropTypeLocations");
+var ReactPropTypeLocationNames = _dereq_("./ReactPropTypeLocationNames");
+var ReactUpdates = _dereq_("./ReactUpdates");
+
+var instantiateReactComponent = _dereq_("./instantiateReactComponent");
+var invariant = _dereq_("./invariant");
+var keyMirror = _dereq_("./keyMirror");
+var merge = _dereq_("./merge");
+var mixInto = _dereq_("./mixInto");
+var monitorCodeUse = _dereq_("./monitorCodeUse");
+var objMap = _dereq_("./objMap");
+var shouldUpdateReactComponent = _dereq_("./shouldUpdateReactComponent");
+var warning = _dereq_("./warning");
+
+/**
+ * Policies that describe methods in `ReactCompositeComponentInterface`.
+ */
+var SpecPolicy = keyMirror({
+  /**
+   * These methods may be defined only once by the class specification or mixin.
+   */
+  DEFINE_ONCE: null,
+  /**
+   * These methods may be defined by both the class specification and mixins.
+   * Subsequent definitions will be chained. These methods must return void.
+   */
+  DEFINE_MANY: null,
+  /**
+   * These methods are overriding the base ReactCompositeComponent class.
+   */
+  OVERRIDE_BASE: null,
+  /**
+   * These methods are similar to DEFINE_MANY, except we assume they return
+   * objects. We try to merge the keys of the return values of all the mixed in
+   * functions. If there is a key conflict we throw.
+   */
+  DEFINE_MANY_MERGED: null
+});
+
+
+var injectedMixins = [];
+
+/**
+ * Composite components are higher-level components that compose other composite
+ * or native components.
+ *
+ * To create a new type of `ReactCompositeComponent`, pass a specification of
+ * your new class to `React.createClass`. The only requirement of your class
+ * specification is that you implement a `render` method.
+ *
+ *   var MyComponent = React.createClass({
+ *     render: function() {
+ *       return <div>Hello World</div>;
+ *     }
+ *   });
+ *
+ * The class specification supports a specific protocol of methods that have
+ * special meaning (e.g. `render`). See `ReactCompositeComponentInterface` for
+ * more the comprehensive protocol. Any other properties and methods in the
+ * class specification will available on the prototype.
+ *
+ * @interface ReactCompositeComponentInterface
+ * @internal
+ */
+var ReactCompositeComponentInterface = {
+
+  /**
+   * An array of Mixin objects to include when defining your component.
+   *
+   * @type {array}
+   * @optional
+   */
+  mixins: SpecPolicy.DEFINE_MANY,
+
+  /**
+   * An object containing properties and methods that should be defined on
+   * the component's constructor instead of its prototype (static methods).
+   *
+   * @type {object}
+   * @optional
+   */
+  statics: SpecPolicy.DEFINE_MANY,
+
+  /**
+   * Definition of prop types for this component.
+   *
+   * @type {object}
+   * @optional
+   */
+  propTypes: SpecPolicy.DEFINE_MANY,
+
+  /**
+   * Definition of context types for this component.
+   *
+   * @type {object}
+   * @optional
+   */
+  contextTypes: SpecPolicy.DEFINE_MANY,
+
+  /**
+   * Definition of context types this component sets for its children.
+   *
+   * @type {object}
+   * @optional
+   */
+  childContextTypes: SpecPolicy.DEFINE_MANY,
+
+  // ==== Definition methods ====
+
+  /**
+   * Invoked when the component is mounted. Values in the mapping will be set on
+   * `this.props` if that prop is not specified (i.e. using an `in` check).
+   *
+   * This method is invoked before `getInitialState` and therefore cannot rely
+   * on `this.state` or use `this.setState`.
+   *
+   * @return {object}
+   * @optional
+   */
+  getDefaultProps: SpecPolicy.DEFINE_MANY_MERGED,
+
+  /**
+   * Invoked once before the component is mounted. The return value will be used
+   * as the initial value of `this.state`.
+   *
+   *   getInitialState: function() {
+   *     return {
+   *       isOn: false,
+   *       fooBaz: new BazFoo()
+   *     }
+   *   }
+   *
+   * @return {object}
+   * @optional
+   */
+  getInitialState: SpecPolicy.DEFINE_MANY_MERGED,
+
+  /**
+   * @return {object}
+   * @optional
+   */
+  getChildContext: SpecPolicy.DEFINE_MANY_MERGED,
+
+  /**
+   * Uses props from `this.props` and state from `this.state` to render the
+   * structure of the component.
+   *
+   * No guarantees are made about when or how often this method is invoked, so
+   * it must not have side effects.
+   *
+   *   render: function() {
+   *     var name = this.props.name;
+   *     return <div>Hello, {name}!</div>;
+   *   }
+   *
+   * @return {ReactComponent}
+   * @nosideeffects
+   * @required
+   */
+  render: SpecPolicy.DEFINE_ONCE,
+
+
+
+  // ==== Delegate methods ====
+
+  /**
+   * Invoked when the component is initially created and about to be mounted.
+   * This may have side effects, but any external subscriptions or data created
+   * by this method must be cleaned up in `componentWillUnmount`.
+   *
+   * @optional
+   */
+  componentWillMount: SpecPolicy.DEFINE_MANY,
+
+  /**
+   * Invoked when the component has been mounted and has a DOM representation.
+   * However, there is no guarantee that the DOM node is in the document.
+   *
+   * Use this as an opportunity to operate on the DOM when the component has
+   * been mounted (initialized and rendered) for the first time.
+   *
+   * @param {DOMElement} rootNode DOM element representing the component.
+   * @optional
+   */
+  componentDidMount: SpecPolicy.DEFINE_MANY,
+
+  /**
+   * Invoked before the component receives new props.
+   *
+   * Use this as an opportunity to react to a prop transition by updating the
+   * state using `this.setState`. Current props are accessed via `this.props`.
+   *
+   *   componentWillReceiveProps: function(nextProps, nextContext) {
+   *     this.setState({
+   *       likesIncreasing: nextProps.likeCount > this.props.likeCount
+   *     });
+   *   }
+   *
+   * NOTE: There is no equivalent `componentWillReceiveState`. An incoming prop
+   * transition may cause a state change, but the opposite is not true. If you
+   * need it, you are probably looking for `componentWillUpdate`.
+   *
+   * @param {object} nextProps
+   * @optional
+   */
+  componentWillReceiveProps: SpecPolicy.DEFINE_MANY,
+
+  /**
+   * Invoked while deciding if the component should be updated as a result of
+   * receiving new props, state and/or context.
+   *
+   * Use this as an opportunity to `return false` when you're certain that the
+   * transition to the new props/state/context will not require a component
+   * update.
+   *
+   *   shouldComponentUpdate: function(nextProps, nextState, nextContext) {
+   *     return !equal(nextProps, this.props) ||
+   *       !equal(nextState, this.state) ||
+   *       !equal(nextContext, this.context);
+   *   }
+   *
+   * @param {object} nextProps
+   * @param {?object} nextState
+   * @param {?object} nextContext
+   * @return {boolean} True if the component should update.
+   * @optional
+   */
+  shouldComponentUpdate: SpecPolicy.DEFINE_ONCE,
+
+  /**
+   * Invoked when the component is about to update due to a transition from
+   * `this.props`, `this.state` and `this.context` to `nextProps`, `nextState`
+   * and `nextContext`.
+   *
+   * Use this as an opportunity to perform preparation before an update occurs.
+   *
+   * NOTE: You **cannot** use `this.setState()` in this method.
+   *
+   * @param {object} nextProps
+   * @param {?object} nextState
+   * @param {?object} nextContext
+   * @param {ReactReconcileTransaction} transaction
+   * @optional
+   */
+  componentWillUpdate: SpecPolicy.DEFINE_MANY,
+
+  /**
+   * Invoked when the component's DOM representation has been updated.
+   *
+   * Use this as an opportunity to operate on the DOM when the component has
+   * been updated.
+   *
+   * @param {object} prevProps
+   * @param {?object} prevState
+   * @param {?object} prevContext
+   * @param {DOMElement} rootNode DOM element representing the component.
+   * @optional
+   */
+  componentDidUpdate: SpecPolicy.DEFINE_MANY,
+
+  /**
+   * Invoked when the component is about to be removed from its parent and have
+   * its DOM representation destroyed.
+   *
+   * Use this as an opportunity to deallocate any external resources.
+   *
+   * NOTE: There is no `componentDidUnmount` since your component will have been
+   * destroyed by that point.
+   *
+   * @optional
+   */
+  componentWillUnmount: SpecPolicy.DEFINE_MANY,
+
+
+
+  // ==== Advanced methods ====
+
+  /**
+   * Updates the component's currently mounted DOM representation.
+   *
+   * By default, this implements React's rendering and reconciliation algorithm.
+   * Sophisticated clients may wish to override this.
+   *
+   * @param {ReactReconcileTransaction} transaction
+   * @internal
+   * @overridable
+   */
+  updateComponent: SpecPolicy.OVERRIDE_BASE
+
+};
+
+/**
+ * Mapping from class specification keys to special processing functions.
+ *
+ * Although these are declared like instance properties in the specification
+ * when defining classes using `React.createClass`, they are actually static
+ * and are accessible on the constructor instead of the prototype. Despite
+ * being static, they must be defined outside of the "statics" key under
+ * which all other static methods are defined.
+ */
+var RESERVED_SPEC_KEYS = {
+  displayName: function(ConvenienceConstructor, displayName) {
+    ConvenienceConstructor.componentConstructor.displayName = displayName;
+  },
+  mixins: function(ConvenienceConstructor, mixins) {
+    if (mixins) {
+      for (var i = 0; i < mixins.length; i++) {
+        mixSpecIntoComponent(ConvenienceConstructor, mixins[i]);
+      }
+    }
+  },
+  childContextTypes: function(ConvenienceConstructor, childContextTypes) {
+    var Constructor = ConvenienceConstructor.componentConstructor;
+    validateTypeDef(
+      Constructor,
+      childContextTypes,
+      ReactPropTypeLocations.childContext
+    );
+    Constructor.childContextTypes = merge(
+      Constructor.childContextTypes,
+      childContextTypes
+    );
+  },
+  contextTypes: function(ConvenienceConstructor, contextTypes) {
+    var Constructor = ConvenienceConstructor.componentConstructor;
+    validateTypeDef(
+      Constructor,
+      contextTypes,
+      ReactPropTypeLocations.context
+    );
+    Constructor.contextTypes = merge(Constructor.contextTypes, contextTypes);
+  },
+  propTypes: function(ConvenienceConstructor, propTypes) {
+    var Constructor = ConvenienceConstructor.componentConstructor;
+    validateTypeDef(
+      Constructor,
+      propTypes,
+      ReactPropTypeLocations.prop
+    );
+    Constructor.propTypes = merge(Constructor.propTypes, propTypes);
+  },
+  statics: function(ConvenienceConstructor, statics) {
+    mixStaticSpecIntoComponent(ConvenienceConstructor, statics);
+  }
+};
+
+function validateTypeDef(Constructor, typeDef, location) {
+  for (var propName in typeDef) {
+    if (typeDef.hasOwnProperty(propName)) {
+      ("production" !== "development" ? invariant(
+        typeof typeDef[propName] == 'function',
+        '%s: %s type `%s` is invalid; it must be a function, usually from ' +
+        'React.PropTypes.',
+        Constructor.displayName || 'ReactCompositeComponent',
+        ReactPropTypeLocationNames[location],
+        propName
+      ) : invariant(typeof typeDef[propName] == 'function'));
+    }
+  }
+}
+
+function validateMethodOverride(proto, name) {
+  var specPolicy = ReactCompositeComponentInterface[name];
+
+  // Disallow overriding of base class methods unless explicitly allowed.
+  if (ReactCompositeComponentMixin.hasOwnProperty(name)) {
+    ("production" !== "development" ? invariant(
+      specPolicy === SpecPolicy.OVERRIDE_BASE,
+      'ReactCompositeComponentInterface: You are attempting to override ' +
+      '`%s` from your class specification. Ensure that your method names ' +
+      'do not overlap with React methods.',
+      name
+    ) : invariant(specPolicy === SpecPolicy.OVERRIDE_BASE));
+  }
+
+  // Disallow defining methods more than once unless explicitly allowed.
+  if (proto.hasOwnProperty(name)) {
+    ("production" !== "development" ? invariant(
+      specPolicy === SpecPolicy.DEFINE_MANY ||
+      specPolicy === SpecPolicy.DEFINE_MANY_MERGED,
+      'ReactCompositeComponentInterface: You are attempting to define ' +
+      '`%s` on your component more than once. This conflict may be due ' +
+      'to a mixin.',
+      name
+    ) : invariant(specPolicy === SpecPolicy.DEFINE_MANY ||
+    specPolicy === SpecPolicy.DEFINE_MANY_MERGED));
+  }
+}
+
+function validateLifeCycleOnReplaceState(instance) {
+  var compositeLifeCycleState = instance._compositeLifeCycleState;
+  ("production" !== "development" ? invariant(
+    instance.isMounted() ||
+      compositeLifeCycleState === CompositeLifeCycle.MOUNTING,
+    'replaceState(...): Can only update a mounted or mounting component.'
+  ) : invariant(instance.isMounted() ||
+    compositeLifeCycleState === CompositeLifeCycle.MOUNTING));
+  ("production" !== "development" ? invariant(compositeLifeCycleState !== CompositeLifeCycle.RECEIVING_STATE,
+    'replaceState(...): Cannot update during an existing state transition ' +
+    '(such as within `render`). This could potentially cause an infinite ' +
+    'loop so it is forbidden.'
+  ) : invariant(compositeLifeCycleState !== CompositeLifeCycle.RECEIVING_STATE));
+  ("production" !== "development" ? invariant(compositeLifeCycleState !== CompositeLifeCycle.UNMOUNTING,
+    'replaceState(...): Cannot update while unmounting component. This ' +
+    'usually means you called setState() on an unmounted component.'
+  ) : invariant(compositeLifeCycleState !== CompositeLifeCycle.UNMOUNTING));
+}
+
+/**
+ * Custom version of `mixInto` which handles policy validation and reserved
+ * specification keys when building `ReactCompositeComponent` classses.
+ */
+function mixSpecIntoComponent(ConvenienceConstructor, spec) {
+  ("production" !== "development" ? invariant(
+    !isValidClass(spec),
+    'ReactCompositeComponent: You\'re attempting to ' +
+    'use a component class as a mixin. Instead, just use a regular object.'
+  ) : invariant(!isValidClass(spec)));
+  ("production" !== "development" ? invariant(
+    !ReactComponent.isValidComponent(spec),
+    'ReactCompositeComponent: You\'re attempting to ' +
+    'use a component as a mixin. Instead, just use a regular object.'
+  ) : invariant(!ReactComponent.isValidComponent(spec)));
+
+  var Constructor = ConvenienceConstructor.componentConstructor;
+  var proto = Constructor.prototype;
+  for (var name in spec) {
+    var property = spec[name];
+    if (!spec.hasOwnProperty(name)) {
+      continue;
+    }
+
+    validateMethodOverride(proto, name);
+
+    if (RESERVED_SPEC_KEYS.hasOwnProperty(name)) {
+      RESERVED_SPEC_KEYS[name](ConvenienceConstructor, property);
+    } else {
+      // Setup methods on prototype:
+      // The following member methods should not be automatically bound:
+      // 1. Expected ReactCompositeComponent methods (in the "interface").
+      // 2. Overridden methods (that were mixed in).
+      var isCompositeComponentMethod = name in ReactCompositeComponentInterface;
+      var isInherited = name in proto;
+      var markedDontBind = property && property.__reactDontBind;
+      var isFunction = typeof property === 'function';
+      var shouldAutoBind =
+        isFunction &&
+        !isCompositeComponentMethod &&
+        !isInherited &&
+        !markedDontBind;
+
+      if (shouldAutoBind) {
+        if (!proto.__reactAutoBindMap) {
+          proto.__reactAutoBindMap = {};
+        }
+        proto.__reactAutoBindMap[name] = property;
+        proto[name] = property;
+      } else {
+        if (isInherited) {
+          // For methods which are defined more than once, call the existing
+          // methods before calling the new property.
+          if (ReactCompositeComponentInterface[name] ===
+              SpecPolicy.DEFINE_MANY_MERGED) {
+            proto[name] = createMergedResultFunction(proto[name], property);
+          } else {
+            proto[name] = createChainedFunction(proto[name], property);
+          }
+        } else {
+          proto[name] = property;
+        }
+      }
+    }
+  }
+}
+
+function mixStaticSpecIntoComponent(ConvenienceConstructor, statics) {
+  if (!statics) {
+    return;
+  }
+  for (var name in statics) {
+    var property = statics[name];
+    if (!statics.hasOwnProperty(name)) {
+      return;
+    }
+
+    var isInherited = name in ConvenienceConstructor;
+    var result = property;
+    if (isInherited) {
+      var existingProperty = ConvenienceConstructor[name];
+      var existingType = typeof existingProperty;
+      var propertyType = typeof property;
+      ("production" !== "development" ? invariant(
+        existingType === 'function' && propertyType === 'function',
+        'ReactCompositeComponent: You are attempting to define ' +
+        '`%s` on your component more than once, but that is only supported ' +
+        'for functions, which are chained together. This conflict may be ' +
+        'due to a mixin.',
+        name
+      ) : invariant(existingType === 'function' && propertyType === 'function'));
+      result = createChainedFunction(existingProperty, property);
+    }
+    ConvenienceConstructor[name] = result;
+    ConvenienceConstructor.componentConstructor[name] = result;
+  }
+}
+
+/**
+ * Merge two objects, but throw if both contain the same key.
+ *
+ * @param {object} one The first object, which is mutated.
+ * @param {object} two The second object
+ * @return {object} one after it has been mutated to contain everything in two.
+ */
+function mergeObjectsWithNoDuplicateKeys(one, two) {
+  ("production" !== "development" ? invariant(
+    one && two && typeof one === 'object' && typeof two === 'object',
+    'mergeObjectsWithNoDuplicateKeys(): Cannot merge non-objects'
+  ) : invariant(one && two && typeof one === 'object' && typeof two === 'object'));
+
+  objMap(two, function(value, key) {
+    ("production" !== "development" ? invariant(
+      one[key] === undefined,
+      'mergeObjectsWithNoDuplicateKeys(): ' +
+      'Tried to merge two objects with the same key: %s',
+      key
+    ) : invariant(one[key] === undefined));
+    one[key] = value;
+  });
+  return one;
+}
+
+/**
+ * Creates a function that invokes two functions and merges their return values.
+ *
+ * @param {function} one Function to invoke first.
+ * @param {function} two Function to invoke second.
+ * @return {function} Function that invokes the two argument functions.
+ * @private
+ */
+function createMergedResultFunction(one, two) {
+  return function mergedResult() {
+    var a = one.apply(this, arguments);
+    var b = two.apply(this, arguments);
+    if (a == null) {
+      return b;
+    } else if (b == null) {
+      return a;
+    }
+    return mergeObjectsWithNoDuplicateKeys(a, b);
+  };
+}
+
+/**
+ * Creates a function that invokes two functions and ignores their return vales.
+ *
+ * @param {function} one Function to invoke first.
+ * @param {function} two Function to invoke second.
+ * @return {function} Function that invokes the two argument functions.
+ * @private
+ */
+function createChainedFunction(one, two) {
+  return function chainedFunction() {
+    one.apply(this, arguments);
+    two.apply(this, arguments);
+  };
+}
+
+if ("production" !== "development") {
+
+  var unmountedPropertyWhitelist = {
+    constructor: true,
+    construct: true,
+    isOwnedBy: true, // should be deprecated but can have code mod (internal)
+    type: true,
+    props: true,
+    // currently private but belong on the descriptor and are valid for use
+    // inside the framework:
+    __keyValidated__: true,
+    _owner: true,
+    _currentContext: true
+  };
+
+  var componentInstanceProperties = {
+    __keyValidated__: true,
+    __keySetters: true,
+    _compositeLifeCycleState: true,
+    _currentContext: true,
+    _defaultProps: true,
+    _instance: true,
+    _lifeCycleState: true,
+    _mountDepth: true,
+    _owner: true,
+    _pendingCallbacks: true,
+    _pendingContext: true,
+    _pendingForceUpdate: true,
+    _pendingOwner: true,
+    _pendingProps: true,
+    _pendingState: true,
+    _renderedComponent: true,
+    _rootNodeID: true,
+    context: true,
+    props: true,
+    refs: true,
+    state: true,
+
+    // These are known instance properties coming from other sources
+    _pendingQueries: true,
+    _queryPropListeners: true,
+    queryParams: true
+
+  };
+
+  var hasWarnedOnComponentType = {};
+
+  var warningStackCounter = 0;
+
+  var issueMembraneWarning = function(instance, key) {
+    var isWhitelisted = unmountedPropertyWhitelist.hasOwnProperty(key);
+    if (warningStackCounter > 0 || isWhitelisted) {
+      return;
+    }
+    var name = instance.constructor.displayName || 'Unknown';
+    var owner = ReactCurrentOwner.current;
+    var ownerName = (owner && owner.constructor.displayName) || 'Unknown';
+    var warningKey = key + '|' + name + '|' + ownerName;
+    if (hasWarnedOnComponentType.hasOwnProperty(warningKey)) {
+      // We have already warned for this combination. Skip it this time.
+      return;
+    }
+    hasWarnedOnComponentType[warningKey] = true;
+
+    var context = owner ? ' in ' + ownerName + '.' : ' at the top level.';
+    var staticMethodExample = '<' + name + ' />.type.' + key + '(...)';
+
+    monitorCodeUse('react_descriptor_property_access', { component: name });
+    console.warn(
+      'Invalid access to component property "' + key + '" on ' + name +
+      context + ' See http://fb.me/react-warning-descriptors .' +
+      ' Use a static method instead: ' + staticMethodExample
+    );
+  };
+
+  var wrapInMembraneFunction = function(fn, thisBinding) {
+    if (fn.__reactMembraneFunction && fn.__reactMembraneSelf === thisBinding) {
+      return fn.__reactMembraneFunction;
+    }
+    return fn.__reactMembraneFunction = function() {
+      /**
+       * By getting this function, you've already received a warning. The
+       * internals of this function will likely cause more warnings. To avoid
+       * Spamming too much we disable any warning triggered inside of this
+       * stack.
+       */
+      warningStackCounter++;
+      try {
+        // If the this binding is unchanged, we defer to the real component.
+        // This is important to keep some referential integrity in the
+        // internals. E.g. owner equality check.
+        var self = this === thisBinding ? this.__realComponentInstance : this;
+        return fn.apply(self, arguments);
+      } finally {
+        warningStackCounter--;
+      }
+    };
+  };
+
+  var defineMembraneProperty = function(membrane, prototype, key) {
+    Object.defineProperty(membrane, key, {
+
+      configurable: false,
+      enumerable: true,
+
+      get: function() {
+        if (this === membrane) {
+          // We're allowed to access the prototype directly.
+          return prototype[key];
+        }
+        issueMembraneWarning(this, key);
+
+        var realValue = this.__realComponentInstance[key];
+        // If the real value is a function, we need to provide a wrapper that
+        // disables nested warnings. The properties type and constructors are
+        // expected to the be constructors and therefore is often use with an
+        // equality check and we shouldn't try to rebind those.
+        if (typeof realValue === 'function' &&
+            key !== 'type' &&
+            key !== 'constructor') {
+          return wrapInMembraneFunction(realValue, this);
+        }
+        return realValue;
+      },
+
+      set: function(value) {
+        if (this === membrane) {
+          // We're allowed to set a value on the prototype directly.
+          prototype[key] = value;
+          return;
+        }
+        issueMembraneWarning(this, key);
+        this.__realComponentInstance[key] = value;
+      }
+
+    });
+  };
+
+  /**
+   * Creates a membrane prototype which wraps the original prototype. If any
+   * property is accessed in an unmounted state, a warning is issued.
+   *
+   * @param {object} prototype Original prototype.
+   * @return {object} The membrane prototype.
+   * @private
+   */
+  var createMountWarningMembrane = function(prototype) {
+    var membrane = {};
+    var key;
+    for (key in prototype) {
+      defineMembraneProperty(membrane, prototype, key);
+    }
+    // These are properties that goes into the instance but not the prototype.
+    // We can create the membrane on the prototype even though this will
+    // result in a faulty hasOwnProperty check it's better perf.
+    for (key in componentInstanceProperties) {
+      if (componentInstanceProperties.hasOwnProperty(key) &&
+          !(key in prototype)) {
+        defineMembraneProperty(membrane, prototype, key);
+      }
+    }
+    return membrane;
+  };
+
+  /**
+   * Creates a membrane constructor which wraps the component that gets mounted.
+   *
+   * @param {function} constructor Original constructor.
+   * @return {function} The membrane constructor.
+   * @private
+   */
+  var createDescriptorProxy = function(constructor) {
+    try {
+      var ProxyConstructor = function() {
+        this.__realComponentInstance = new constructor();
+
+        // We can only safely pass through known instance variables. Unknown
+        // expandos are not safe. Use the real mounted instance to avoid this
+        // problem if it blows something up.
+        Object.freeze(this);
+      };
+
+      ProxyConstructor.prototype = createMountWarningMembrane(
+        constructor.prototype
+      );
+
+      return ProxyConstructor;
+    } catch(x) {
+      // In IE8 define property will fail on non-DOM objects. If anything in
+      // the membrane creation fails, we'll bail out and just use the plain
+      // constructor without warnings.
+      return constructor;
+    }
+  };
+
+}
+
+/**
+ * `ReactCompositeComponent` maintains an auxiliary life cycle state in
+ * `this._compositeLifeCycleState` (which can be null).
+ *
+ * This is different from the life cycle state maintained by `ReactComponent` in
+ * `this._lifeCycleState`. The following diagram shows how the states overlap in
+ * time. There are times when the CompositeLifeCycle is null - at those times it
+ * is only meaningful to look at ComponentLifeCycle alone.
+ *
+ * Top Row: ReactComponent.ComponentLifeCycle
+ * Low Row: ReactComponent.CompositeLifeCycle
+ *
+ * +-------+------------------------------------------------------+--------+
+ * |  UN   |                    MOUNTED                           |   UN   |
+ * |MOUNTED|                                                      | MOUNTED|
+ * +-------+------------------------------------------------------+--------+
+ * |       ^--------+   +------+   +------+   +------+   +--------^        |
+ * |       |        |   |      |   |      |   |      |   |        |        |
+ * |    0--|MOUNTING|-0-|RECEIV|-0-|RECEIV|-0-|RECEIV|-0-|   UN   |--->0   |
+ * |       |        |   |PROPS |   | PROPS|   | STATE|   |MOUNTING|        |
+ * |       |        |   |      |   |      |   |      |   |        |        |
+ * |       |        |   |      |   |      |   |      |   |        |        |
+ * |       +--------+   +------+   +------+   +------+   +--------+        |
+ * |       |                                                      |        |
+ * +-------+------------------------------------------------------+--------+
+ */
+var CompositeLifeCycle = keyMirror({
+  /**
+   * Components in the process of being mounted respond to state changes
+   * differently.
+   */
+  MOUNTING: null,
+  /**
+   * Components in the process of being unmounted are guarded against state
+   * changes.
+   */
+  UNMOUNTING: null,
+  /**
+   * Components that are mounted and receiving new props respond to state
+   * changes differently.
+   */
+  RECEIVING_PROPS: null,
+  /**
+   * Components that are mounted and receiving new state are guarded against
+   * additional state changes.
+   */
+  RECEIVING_STATE: null
+});
+
+/**
+ * @lends {ReactCompositeComponent.prototype}
+ */
+var ReactCompositeComponentMixin = {
+
+  /**
+   * Base constructor for all composite component.
+   *
+   * @param {?object} initialProps
+   * @param {*} children
+   * @final
+   * @internal
+   */
+  construct: function(initialProps, children) {
+    // Children can be either an array or more than one argument
+    ReactComponent.Mixin.construct.apply(this, arguments);
+    ReactOwner.Mixin.construct.apply(this, arguments);
+
+    this.state = null;
+    this._pendingState = null;
+
+    this.context = null;
+    this._currentContext = ReactContext.current;
+    this._pendingContext = null;
+
+    // The descriptor that was used to instantiate this component. Will be
+    // set by the instantiator instead of the constructor since this
+    // constructor is currently used by both instances and descriptors.
+    this._descriptor = null;
+
+    this._compositeLifeCycleState = null;
+  },
+
+  /**
+   * Components in the intermediate state now has cyclic references. To avoid
+   * breaking JSON serialization we expose a custom JSON format.
+   * @return {object} JSON compatible representation.
+   * @internal
+   * @final
+   */
+  toJSON: function() {
+    return { type: this.type, props: this.props };
+  },
+
+  /**
+   * Checks whether or not this composite component is mounted.
+   * @return {boolean} True if mounted, false otherwise.
+   * @protected
+   * @final
+   */
+  isMounted: function() {
+    return ReactComponent.Mixin.isMounted.call(this) &&
+      this._compositeLifeCycleState !== CompositeLifeCycle.MOUNTING;
+  },
+
+  /**
+   * Initializes the component, renders markup, and registers event listeners.
+   *
+   * @param {string} rootID DOM ID of the root node.
+   * @param {ReactReconcileTransaction|ReactServerRenderingTransaction} transaction
+   * @param {number} mountDepth number of components in the owner hierarchy
+   * @return {?string} Rendered markup to be inserted into the DOM.
+   * @final
+   * @internal
+   */
+  mountComponent: ReactPerf.measure(
+    'ReactCompositeComponent',
+    'mountComponent',
+    function(rootID, transaction, mountDepth) {
+      ReactComponent.Mixin.mountComponent.call(
+        this,
+        rootID,
+        transaction,
+        mountDepth
+      );
+      this._compositeLifeCycleState = CompositeLifeCycle.MOUNTING;
+
+      this.context = this._processContext(this._currentContext);
+      this._defaultProps = this.getDefaultProps ? this.getDefaultProps() : null;
+      this.props = this._processProps(this.props);
+
+      if (this.__reactAutoBindMap) {
+        this._bindAutoBindMethods();
+      }
+
+      this.state = this.getInitialState ? this.getInitialState() : null;
+      ("production" !== "development" ? invariant(
+        typeof this.state === 'object' && !Array.isArray(this.state),
+        '%s.getInitialState(): must return an object or null',
+        this.constructor.displayName || 'ReactCompositeComponent'
+      ) : invariant(typeof this.state === 'object' && !Array.isArray(this.state)));
+
+      this._pendingState = null;
+      this._pendingForceUpdate = false;
+
+      if (this.componentWillMount) {
+        this.componentWillMount();
+        // When mounting, calls to `setState` by `componentWillMount` will set
+        // `this._pendingState` without triggering a re-render.
+        if (this._pendingState) {
+          this.state = this._pendingState;
+          this._pendingState = null;
+        }
+      }
+
+      this._renderedComponent = instantiateReactComponent(
+        this._renderValidatedComponent()
+      );
+
+      // Done with mounting, `setState` will now trigger UI changes.
+      this._compositeLifeCycleState = null;
+      var markup = this._renderedComponent.mountComponent(
+        rootID,
+        transaction,
+        mountDepth + 1
+      );
+      if (this.componentDidMount) {
+        transaction.getReactMountReady().enqueue(this, this.componentDidMount);
+      }
+      return markup;
+    }
+  ),
+
+  /**
+   * Releases any resources allocated by `mountComponent`.
+   *
+   * @final
+   * @internal
+   */
+  unmountComponent: function() {
+    this._compositeLifeCycleState = CompositeLifeCycle.UNMOUNTING;
+    if (this.componentWillUnmount) {
+      this.componentWillUnmount();
+    }
+    this._compositeLifeCycleState = null;
+
+    this._defaultProps = null;
+
+    this._renderedComponent.unmountComponent();
+    this._renderedComponent = null;
+
+    ReactComponent.Mixin.unmountComponent.call(this);
+
+    // Some existing components rely on this.props even after they've been
+    // destroyed (in event handlers).
+    // TODO: this.props = null;
+    // TODO: this.state = null;
+  },
+
+  /**
+   * Sets a subset of the state. Always use this or `replaceState` to mutate
+   * state. You should treat `this.state` as immutable.
+   *
+   * There is no guarantee that `this.state` will be immediately updated, so
+   * accessing `this.state` after calling this method may return the old value.
+   *
+   * There is no guarantee that calls to `setState` will run synchronously,
+   * as they may eventually be batched together.  You can provide an optional
+   * callback that will be executed when the call to setState is actually
+   * completed.
+   *
+   * @param {object} partialState Next partial state to be merged with state.
+   * @param {?function} callback Called after state is updated.
+   * @final
+   * @protected
+   */
+  setState: function(partialState, callback) {
+    ("production" !== "development" ? invariant(
+      typeof partialState === 'object' || partialState == null,
+      'setState(...): takes an object of state variables to update.'
+    ) : invariant(typeof partialState === 'object' || partialState == null));
+    if ("production" !== "development") {
+      ("production" !== "development" ? warning(
+        partialState != null,
+        'setState(...): You passed an undefined or null state object; ' +
+        'instead, use forceUpdate().'
+      ) : null);
+    }
+    // Merge with `_pendingState` if it exists, otherwise with existing state.
+    this.replaceState(
+      merge(this._pendingState || this.state, partialState),
+      callback
+    );
+  },
+
+  /**
+   * Replaces all of the state. Always use this or `setState` to mutate state.
+   * You should treat `this.state` as immutable.
+   *
+   * There is no guarantee that `this.state` will be immediately updated, so
+   * accessing `this.state` after calling this method may return the old value.
+   *
+   * @param {object} completeState Next state.
+   * @param {?function} callback Called after state is updated.
+   * @final
+   * @protected
+   */
+  replaceState: function(completeState, callback) {
+    validateLifeCycleOnReplaceState(this);
+    this._pendingState = completeState;
+    ReactUpdates.enqueueUpdate(this, callback);
+  },
+
+  /**
+   * Filters the context object to only contain keys specified in
+   * `contextTypes`, and asserts that they are valid.
+   *
+   * @param {object} context
+   * @return {?object}
+   * @private
+   */
+  _processContext: function(context) {
+    var maskedContext = null;
+    var contextTypes = this.constructor.contextTypes;
+    if (contextTypes) {
+      maskedContext = {};
+      for (var contextName in contextTypes) {
+        maskedContext[contextName] = context[contextName];
+      }
+      if ("production" !== "development") {
+        this._checkPropTypes(
+          contextTypes,
+          maskedContext,
+          ReactPropTypeLocations.context
+        );
+      }
+    }
+    return maskedContext;
+  },
+
+  /**
+   * @param {object} currentContext
+   * @return {object}
+   * @private
+   */
+  _processChildContext: function(currentContext) {
+    var childContext = this.getChildContext && this.getChildContext();
+    var displayName = this.constructor.displayName || 'ReactCompositeComponent';
+    if (childContext) {
+      ("production" !== "development" ? invariant(
+        typeof this.constructor.childContextTypes === 'object',
+        '%s.getChildContext(): childContextTypes must be defined in order to ' +
+        'use getChildContext().',
+        displayName
+      ) : invariant(typeof this.constructor.childContextTypes === 'object'));
+      if ("production" !== "development") {
+        this._checkPropTypes(
+          this.constructor.childContextTypes,
+          childContext,
+          ReactPropTypeLocations.childContext
+        );
+      }
+      for (var name in childContext) {
+        ("production" !== "development" ? invariant(
+          name in this.constructor.childContextTypes,
+          '%s.getChildContext(): key "%s" is not defined in childContextTypes.',
+          displayName,
+          name
+        ) : invariant(name in this.constructor.childContextTypes));
+      }
+      return merge(currentContext, childContext);
+    }
+    return currentContext;
+  },
+
+  /**
+   * Processes props by setting default values for unspecified props and
+   * asserting that the props are valid. Does not mutate its argument; returns
+   * a new props object with defaults merged in.
+   *
+   * @param {object} newProps
+   * @return {object}
+   * @private
+   */
+  _processProps: function(newProps) {
+    var props = merge(newProps);
+    var defaultProps = this._defaultProps;
+    for (var propName in defaultProps) {
+      if (typeof props[propName] === 'undefined') {
+        props[propName] = defaultProps[propName];
+      }
+    }
+    if ("production" !== "development") {
+      var propTypes = this.constructor.propTypes;
+      if (propTypes) {
+        this._checkPropTypes(propTypes, props, ReactPropTypeLocations.prop);
+      }
+    }
+    return props;
+  },
+
+  /**
+   * Assert that the props are valid
+   *
+   * @param {object} propTypes Map of prop name to a ReactPropType
+   * @param {object} props
+   * @param {string} location e.g. "prop", "context", "child context"
+   * @private
+   */
+  _checkPropTypes: function(propTypes, props, location) {
+    var componentName = this.constructor.displayName;
+    for (var propName in propTypes) {
+      if (propTypes.hasOwnProperty(propName)) {
+        propTypes[propName](props, propName, componentName, location);
+      }
+    }
+  },
+
+  performUpdateIfNecessary: function() {
+    var compositeLifeCycleState = this._compositeLifeCycleState;
+    // Do not trigger a state transition if we are in the middle of mounting or
+    // receiving props because both of those will already be doing this.
+    if (compositeLifeCycleState === CompositeLifeCycle.MOUNTING ||
+        compositeLifeCycleState === CompositeLifeCycle.RECEIVING_PROPS) {
+      return;
+    }
+    ReactComponent.Mixin.performUpdateIfNecessary.call(this);
+  },
+
+  /**
+   * If any of `_pendingProps`, `_pendingState`, or `_pendingForceUpdate` is
+   * set, update the component.
+   *
+   * @param {ReactReconcileTransaction} transaction
+   * @internal
+   */
+  _performUpdateIfNecessary: function(transaction) {
+    if (this._pendingProps == null &&
+        this._pendingState == null &&
+        this._pendingContext == null &&
+        !this._pendingForceUpdate) {
+      return;
+    }
+
+    var nextFullContext = this._pendingContext || this._currentContext;
+    var nextContext = this._processContext(nextFullContext);
+    this._pendingContext = null;
+
+    var nextProps = this.props;
+    if (this._pendingProps != null) {
+      nextProps = this._processProps(this._pendingProps);
+      this._pendingProps = null;
+
+      this._compositeLifeCycleState = CompositeLifeCycle.RECEIVING_PROPS;
+      if (this.componentWillReceiveProps) {
+        this.componentWillReceiveProps(nextProps, nextContext);
+      }
+    }
+
+    this._compositeLifeCycleState = CompositeLifeCycle.RECEIVING_STATE;
+
+    // Unlike props, state, and context, we specifically don't want to set
+    // _pendingOwner to null here because it's possible for a component to have
+    // a null owner, so we instead make `this._owner === this._pendingOwner`
+    // mean that there's no owner change pending.
+    var nextOwner = this._pendingOwner;
+
+    var nextState = this._pendingState || this.state;
+    this._pendingState = null;
+
+    try {
+      if (this._pendingForceUpdate ||
+          !this.shouldComponentUpdate ||
+          this.shouldComponentUpdate(nextProps, nextState, nextContext)) {
+        this._pendingForceUpdate = false;
+        // Will set `this.props`, `this.state` and `this.context`.
+        this._performComponentUpdate(
+          nextProps,
+          nextOwner,
+          nextState,
+          nextFullContext,
+          nextContext,
+          transaction
+        );
+      } else {
+        // If it's determined that a component should not update, we still want
+        // to set props and state.
+        this.props = nextProps;
+        this._owner = nextOwner;
+        this.state = nextState;
+        this._currentContext = nextFullContext;
+        this.context = nextContext;
+      }
+    } finally {
+      this._compositeLifeCycleState = null;
+    }
+  },
+
+  /**
+   * Merges new props and state, notifies delegate methods of update and
+   * performs update.
+   *
+   * @param {object} nextProps Next object to set as properties.
+   * @param {?ReactComponent} nextOwner Next component to set as owner
+   * @param {?object} nextState Next object to set as state.
+   * @param {?object} nextFullContext Next object to set as _currentContext.
+   * @param {?object} nextContext Next object to set as context.
+   * @param {ReactReconcileTransaction} transaction
+   * @private
+   */
+  _performComponentUpdate: function(
+    nextProps,
+    nextOwner,
+    nextState,
+    nextFullContext,
+    nextContext,
+    transaction
+  ) {
+    var prevProps = this.props;
+    var prevOwner = this._owner;
+    var prevState = this.state;
+    var prevContext = this.context;
+
+    if (this.componentWillUpdate) {
+      this.componentWillUpdate(nextProps, nextState, nextContext);
+    }
+
+    this.props = nextProps;
+    this._owner = nextOwner;
+    this.state = nextState;
+    this._currentContext = nextFullContext;
+    this.context = nextContext;
+
+    this.updateComponent(
+      transaction,
+      prevProps,
+      prevOwner,
+      prevState,
+      prevContext
+    );
+
+    if (this.componentDidUpdate) {
+      transaction.getReactMountReady().enqueue(
+        this,
+        this.componentDidUpdate.bind(this, prevProps, prevState, prevContext)
+      );
+    }
+  },
+
+  receiveComponent: function(nextComponent, transaction) {
+    if (nextComponent === this._descriptor) {
+      // Since props and context are immutable after the component is
+      // mounted, we can do a cheap identity compare here to determine
+      // if this is a superfluous reconcile.
+      return;
+    }
+
+    // Update the descriptor that was last used by this component instance
+    this._descriptor = nextComponent;
+
+    this._pendingContext = nextComponent._currentContext;
+    ReactComponent.Mixin.receiveComponent.call(
+      this,
+      nextComponent,
+      transaction
+    );
+  },
+
+  /**
+   * Updates the component's currently mounted DOM representation.
+   *
+   * By default, this implements React's rendering and reconciliation algorithm.
+   * Sophisticated clients may wish to override this.
+   *
+   * @param {ReactReconcileTransaction} transaction
+   * @param {object} prevProps
+   * @param {?ReactComponent} prevOwner
+   * @param {?object} prevState
+   * @param {?object} prevContext
+   * @internal
+   * @overridable
+   */
+  updateComponent: ReactPerf.measure(
+    'ReactCompositeComponent',
+    'updateComponent',
+    function(transaction, prevProps, prevOwner, prevState, prevContext) {
+      ReactComponent.Mixin.updateComponent.call(
+        this,
+        transaction,
+        prevProps,
+        prevOwner
+      );
+
+
+      var prevComponentInstance = this._renderedComponent;
+      var nextComponent = this._renderValidatedComponent();
+      if (shouldUpdateReactComponent(prevComponentInstance, nextComponent)) {
+        prevComponentInstance.receiveComponent(nextComponent, transaction);
+      } else {
+        // These two IDs are actually the same! But nothing should rely on that.
+        var thisID = this._rootNodeID;
+        var prevComponentID = prevComponentInstance._rootNodeID;
+        prevComponentInstance.unmountComponent();
+        this._renderedComponent = instantiateReactComponent(nextComponent);
+        var nextMarkup = this._renderedComponent.mountComponent(
+          thisID,
+          transaction,
+          this._mountDepth + 1
+        );
+        ReactComponent.BackendIDOperations.dangerouslyReplaceNodeWithMarkupByID(
+          prevComponentID,
+          nextMarkup
+        );
+      }
+    }
+  ),
+
+  /**
+   * Forces an update. This should only be invoked when it is known with
+   * certainty that we are **not** in a DOM transaction.
+   *
+   * You may want to call this when you know that some deeper aspect of the
+   * component's state has changed but `setState` was not called.
+   *
+   * This will not invoke `shouldUpdateComponent`, but it will invoke
+   * `componentWillUpdate` and `componentDidUpdate`.
+   *
+   * @param {?function} callback Called after update is complete.
+   * @final
+   * @protected
+   */
+  forceUpdate: function(callback) {
+    var compositeLifeCycleState = this._compositeLifeCycleState;
+    ("production" !== "development" ? invariant(
+      this.isMounted() ||
+        compositeLifeCycleState === CompositeLifeCycle.MOUNTING,
+      'forceUpdate(...): Can only force an update on mounted or mounting ' +
+        'components.'
+    ) : invariant(this.isMounted() ||
+      compositeLifeCycleState === CompositeLifeCycle.MOUNTING));
+    ("production" !== "development" ? invariant(
+      compositeLifeCycleState !== CompositeLifeCycle.RECEIVING_STATE &&
+      compositeLifeCycleState !== CompositeLifeCycle.UNMOUNTING,
+      'forceUpdate(...): Cannot force an update while unmounting component ' +
+      'or during an existing state transition (such as within `render`).'
+    ) : invariant(compositeLifeCycleState !== CompositeLifeCycle.RECEIVING_STATE &&
+    compositeLifeCycleState !== CompositeLifeCycle.UNMOUNTING));
+    this._pendingForceUpdate = true;
+    ReactUpdates.enqueueUpdate(this, callback);
+  },
+
+  /**
+   * @private
+   */
+  _renderValidatedComponent: ReactPerf.measure(
+    'ReactCompositeComponent',
+    '_renderValidatedComponent',
+    function() {
+      var renderedComponent;
+      var previousContext = ReactContext.current;
+      ReactContext.current = this._processChildContext(this._currentContext);
+      ReactCurrentOwner.current = this;
+      try {
+        renderedComponent = this.render();
+      } finally {
+        ReactContext.current = previousContext;
+        ReactCurrentOwner.current = null;
+      }
+      ("production" !== "development" ? invariant(
+        ReactComponent.isValidComponent(renderedComponent),
+        '%s.render(): A valid ReactComponent must be returned. You may have ' +
+          'returned null, undefined, an array, or some other invalid object.',
+        this.constructor.displayName || 'ReactCompositeComponent'
+      ) : invariant(ReactComponent.isValidComponent(renderedComponent)));
+      return renderedComponent;
+    }
+  ),
+
+  /**
+   * @private
+   */
+  _bindAutoBindMethods: function() {
+    for (var autoBindKey in this.__reactAutoBindMap) {
+      if (!this.__reactAutoBindMap.hasOwnProperty(autoBindKey)) {
+        continue;
+      }
+      var method = this.__reactAutoBindMap[autoBindKey];
+      this[autoBindKey] = this._bindAutoBindMethod(ReactErrorUtils.guard(
+        method,
+        this.constructor.displayName + '.' + autoBindKey
+      ));
+    }
+  },
+
+  /**
+   * Binds a method to the component.
+   *
+   * @param {function} method Method to be bound.
+   * @private
+   */
+  _bindAutoBindMethod: function(method) {
+    var component = this;
+    var boundMethod = function() {
+      return method.apply(component, arguments);
+    };
+    if ("production" !== "development") {
+      boundMethod.__reactBoundContext = component;
+      boundMethod.__reactBoundMethod = method;
+      boundMethod.__reactBoundArguments = null;
+      var componentName = component.constructor.displayName;
+      var _bind = boundMethod.bind;
+      boundMethod.bind = function(newThis ) {var args=Array.prototype.slice.call(arguments,1);
+        // User is trying to bind() an autobound method; we effectively will
+        // ignore the value of "this" that the user is trying to use, so
+        // let's warn.
+        if (newThis !== component && newThis !== null) {
+          monitorCodeUse('react_bind_warning', { component: componentName });
+          console.warn(
+            'bind(): React component methods may only be bound to the ' +
+            'component instance. See ' + componentName
+          );
+        } else if (!args.length) {
+          monitorCodeUse('react_bind_warning', { component: componentName });
+          console.warn(
+            'bind(): You are binding a component method to the component. ' +
+            'React does this for you automatically in a high-performance ' +
+            'way, so you can safely remove this call. See ' + componentName
+          );
+          return boundMethod;
+        }
+        var reboundMethod = _bind.apply(boundMethod, arguments);
+        reboundMethod.__reactBoundContext = component;
+        reboundMethod.__reactBoundMethod = method;
+        reboundMethod.__reactBoundArguments = args;
+        return reboundMethod;
+      };
+    }
+    return boundMethod;
+  }
+};
+
+var ReactCompositeComponentBase = function() {};
+mixInto(ReactCompositeComponentBase, ReactComponent.Mixin);
+mixInto(ReactCompositeComponentBase, ReactOwner.Mixin);
+mixInto(ReactCompositeComponentBase, ReactPropTransferer.Mixin);
+mixInto(ReactCompositeComponentBase, ReactCompositeComponentMixin);
+
+/**
+ * Checks if a value is a valid component constructor.
+ *
+ * @param {*}
+ * @return {boolean}
+ * @public
+ */
+function isValidClass(componentClass) {
+  return componentClass instanceof Function &&
+         'componentConstructor' in componentClass &&
+         componentClass.componentConstructor instanceof Function;
+}
+/**
+ * Module for creating composite components.
+ *
+ * @class ReactCompositeComponent
+ * @extends ReactComponent
+ * @extends ReactOwner
+ * @extends ReactPropTransferer
+ */
+var ReactCompositeComponent = {
+
+  LifeCycle: CompositeLifeCycle,
+
+  Base: ReactCompositeComponentBase,
+
+  /**
+   * Creates a composite component class given a class specification.
+   *
+   * @param {object} spec Class specification (which must define `render`).
+   * @return {function} Component constructor function.
+   * @public
+   */
+  createClass: function(spec) {
+    var Constructor = function() {};
+    Constructor.prototype = new ReactCompositeComponentBase();
+    Constructor.prototype.constructor = Constructor;
+
+    var DescriptorConstructor = Constructor;
+
+    var ConvenienceConstructor = function(props, children) {
+      var descriptor = new DescriptorConstructor();
+      descriptor.construct.apply(descriptor, arguments);
+      return descriptor;
+    };
+    ConvenienceConstructor.componentConstructor = Constructor;
+    Constructor.ConvenienceConstructor = ConvenienceConstructor;
+    ConvenienceConstructor.originalSpec = spec;
+
+    injectedMixins.forEach(
+      mixSpecIntoComponent.bind(null, ConvenienceConstructor)
+    );
+
+    mixSpecIntoComponent(ConvenienceConstructor, spec);
+
+    ("production" !== "development" ? invariant(
+      Constructor.prototype.render,
+      'createClass(...): Class specification must implement a `render` method.'
+    ) : invariant(Constructor.prototype.render));
+
+    if ("production" !== "development") {
+      if (Constructor.prototype.componentShouldUpdate) {
+        monitorCodeUse(
+          'react_component_should_update_warning',
+          { component: spec.displayName }
+        );
+        console.warn(
+          (spec.displayName || 'A component') + ' has a method called ' +
+          'componentShouldUpdate(). Did you mean shouldComponentUpdate()? ' +
+          'The name is phrased as a question because the function is ' +
+          'expected to return a value.'
+         );
+      }
+    }
+
+    // Expose the convience constructor on the prototype so that it can be
+    // easily accessed on descriptors. E.g. <Foo />.type === Foo.type and for
+    // static methods like <Foo />.type.staticMethod();
+    // This should not be named constructor since this may not be the function
+    // that created the descriptor, and it may not even be a constructor.
+    ConvenienceConstructor.type = Constructor;
+    Constructor.prototype.type = Constructor;
+
+    // Reduce time spent doing lookups by setting these on the prototype.
+    for (var methodName in ReactCompositeComponentInterface) {
+      if (!Constructor.prototype[methodName]) {
+        Constructor.prototype[methodName] = null;
+      }
+    }
+
+    if ("production" !== "development") {
+      // In DEV the convenience constructor generates a proxy to another
+      // instance around it to warn about access to properties on the
+      // descriptor.
+      DescriptorConstructor = createDescriptorProxy(Constructor);
+    }
+
+    return ConvenienceConstructor;
+  },
+
+  isValidClass: isValidClass,
+
+  injection: {
+    injectMixin: function(mixin) {
+      injectedMixins.push(mixin);
+    }
+  }
+};
+
+module.exports = ReactCompositeComponent;
+
+},{"./ReactComponent":27,"./ReactContext":30,"./ReactCurrentOwner":31,"./ReactErrorUtils":47,"./ReactOwner":59,"./ReactPerf":60,"./ReactPropTransferer":61,"./ReactPropTypeLocationNames":62,"./ReactPropTypeLocations":63,"./ReactUpdates":71,"./instantiateReactComponent":111,"./invariant":112,"./keyMirror":118,"./merge":121,"./mixInto":124,"./monitorCodeUse":125,"./objMap":126,"./shouldUpdateReactComponent":131,"./warning":134}],30:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactContext
+ */
+
+"use strict";
+
+var merge = _dereq_("./merge");
+
+/**
+ * Keeps track of the current context.
+ *
+ * The context is automatically passed down the component ownership hierarchy
+ * and is accessible via `this.context` on ReactCompositeComponents.
+ */
+var ReactContext = {
+
+  /**
+   * @internal
+   * @type {object}
+   */
+  current: {},
+
+  /**
+   * Temporarily extends the current context while executing scopedCallback.
+   *
+   * A typical use case might look like
+   *
+   *  render: function() {
+   *    var children = ReactContext.withContext({foo: 'foo'} () => (
+   *
+   *    ));
+   *    return <div>{children}</div>;
+   *  }
+   *
+   * @param {object} newContext New context to merge into the existing context
+   * @param {function} scopedCallback Callback to run with the new context
+   * @return {ReactComponent|array<ReactComponent>}
+   */
+  withContext: function(newContext, scopedCallback) {
+    var result;
+    var previousContext = ReactContext.current;
+    ReactContext.current = merge(previousContext, newContext);
+    try {
+      result = scopedCallback();
+    } finally {
+      ReactContext.current = previousContext;
+    }
+    return result;
+  }
+
+};
+
+module.exports = ReactContext;
+
+},{"./merge":121}],31:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactCurrentOwner
+ */
+
+"use strict";
+
+/**
+ * Keeps track of the current owner.
+ *
+ * The current owner is the component who should own any components that are
+ * currently being constructed.
+ *
+ * The depth indicate how many composite components are above this render level.
+ */
+var ReactCurrentOwner = {
+
+  /**
+   * @internal
+   * @type {ReactComponent}
+   */
+  current: null
+
+};
+
+module.exports = ReactCurrentOwner;
+
+},{}],32:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactDOM
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var ReactDOMComponent = _dereq_("./ReactDOMComponent");
+
+var mergeInto = _dereq_("./mergeInto");
+var objMapKeyVal = _dereq_("./objMapKeyVal");
+
+/**
+ * Creates a new React class that is idempotent and capable of containing other
+ * React components. It accepts event listeners and DOM properties that are
+ * valid according to `DOMProperty`.
+ *
+ *  - Event listeners: `onClick`, `onMouseDown`, etc.
+ *  - DOM properties: `className`, `name`, `title`, etc.
+ *
+ * The `style` property functions differently from the DOM API. It accepts an
+ * object mapping of style properties to values.
+ *
+ * @param {string} tag Tag name (e.g. `div`).
+ * @param {boolean} omitClose True if the close tag should be omitted.
+ * @private
+ */
+function createDOMComponentClass(tag, omitClose) {
+  var Constructor = function() {};
+  Constructor.prototype = new ReactDOMComponent(tag, omitClose);
+  Constructor.prototype.constructor = Constructor;
+  Constructor.displayName = tag;
+
+  var ConvenienceConstructor = function(props, children) {
+    var instance = new Constructor();
+    instance.construct.apply(instance, arguments);
+    return instance;
+  };
+
+  // Expose the constructor on the ConvenienceConstructor and prototype so that
+  // it can be easily easily accessed on descriptors.
+  // E.g. <div />.type === div.type
+  ConvenienceConstructor.type = Constructor;
+  Constructor.prototype.type = Constructor;
+
+  Constructor.ConvenienceConstructor = ConvenienceConstructor;
+  ConvenienceConstructor.componentConstructor = Constructor;
+  return ConvenienceConstructor;
+}
+
+/**
+ * Creates a mapping from supported HTML tags to `ReactDOMComponent` classes.
+ * This is also accessible via `React.DOM`.
+ *
+ * @public
+ */
+var ReactDOM = objMapKeyVal({
+  a: false,
+  abbr: false,
+  address: false,
+  area: true,
+  article: false,
+  aside: false,
+  audio: false,
+  b: false,
+  base: true,
+  bdi: false,
+  bdo: false,
+  big: false,
+  blockquote: false,
+  body: false,
+  br: true,
+  button: false,
+  canvas: false,
+  caption: false,
+  cite: false,
+  code: false,
+  col: true,
+  colgroup: false,
+  data: false,
+  datalist: false,
+  dd: false,
+  del: false,
+  details: false,
+  dfn: false,
+  div: false,
+  dl: false,
+  dt: false,
+  em: false,
+  embed: true,
+  fieldset: false,
+  figcaption: false,
+  figure: false,
+  footer: false,
+  form: false, // NOTE: Injected, see `ReactDOMForm`.
+  h1: false,
+  h2: false,
+  h3: false,
+  h4: false,
+  h5: false,
+  h6: false,
+  head: false,
+  header: false,
+  hr: true,
+  html: false,
+  i: false,
+  iframe: false,
+  img: true,
+  input: true,
+  ins: false,
+  kbd: false,
+  keygen: true,
+  label: false,
+  legend: false,
+  li: false,
+  link: true,
+  main: false,
+  map: false,
+  mark: false,
+  menu: false,
+  menuitem: false, // NOTE: Close tag should be omitted, but causes problems.
+  meta: true,
+  meter: false,
+  nav: false,
+  noscript: false,
+  object: false,
+  ol: false,
+  optgroup: false,
+  option: false,
+  output: false,
+  p: false,
+  param: true,
+  pre: false,
+  progress: false,
+  q: false,
+  rp: false,
+  rt: false,
+  ruby: false,
+  s: false,
+  samp: false,
+  script: false,
+  section: false,
+  select: false,
+  small: false,
+  source: true,
+  span: false,
+  strong: false,
+  style: false,
+  sub: false,
+  summary: false,
+  sup: false,
+  table: false,
+  tbody: false,
+  td: false,
+  textarea: false, // NOTE: Injected, see `ReactDOMTextarea`.
+  tfoot: false,
+  th: false,
+  thead: false,
+  time: false,
+  title: false,
+  tr: false,
+  track: true,
+  u: false,
+  ul: false,
+  'var': false,
+  video: false,
+  wbr: true,
+
+  // SVG
+  circle: false,
+  defs: false,
+  g: false,
+  line: false,
+  linearGradient: false,
+  path: false,
+  polygon: false,
+  polyline: false,
+  radialGradient: false,
+  rect: false,
+  stop: false,
+  svg: false,
+  text: false
+}, createDOMComponentClass);
+
+var injection = {
+  injectComponentClasses: function(componentClasses) {
+    mergeInto(ReactDOM, componentClasses);
+  }
+};
+
+ReactDOM.injection = injection;
+
+module.exports = ReactDOM;
+
+},{"./ReactDOMComponent":34,"./mergeInto":123,"./objMapKeyVal":127}],33:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactDOMButton
+ */
+
+"use strict";
+
+var AutoFocusMixin = _dereq_("./AutoFocusMixin");
+var ReactBrowserComponentMixin = _dereq_("./ReactBrowserComponentMixin");
+var ReactCompositeComponent = _dereq_("./ReactCompositeComponent");
+var ReactDOM = _dereq_("./ReactDOM");
+
+var keyMirror = _dereq_("./keyMirror");
+
+// Store a reference to the <button> `ReactDOMComponent`.
+var button = ReactDOM.button;
+
+var mouseListenerNames = keyMirror({
+  onClick: true,
+  onDoubleClick: true,
+  onMouseDown: true,
+  onMouseMove: true,
+  onMouseUp: true,
+  onClickCapture: true,
+  onDoubleClickCapture: true,
+  onMouseDownCapture: true,
+  onMouseMoveCapture: true,
+  onMouseUpCapture: true
+});
+
+/**
+ * Implements a <button> native component that does not receive mouse events
+ * when `disabled` is set.
+ */
+var ReactDOMButton = ReactCompositeComponent.createClass({
+  displayName: 'ReactDOMButton',
+
+  mixins: [AutoFocusMixin, ReactBrowserComponentMixin],
+
+  render: function() {
+    var props = {};
+
+    // Copy the props; except the mouse listeners if we're disabled
+    for (var key in this.props) {
+      if (this.props.hasOwnProperty(key) &&
+          (!this.props.disabled || !mouseListenerNames[key])) {
+        props[key] = this.props[key];
+      }
+    }
+
+    return button(props, this.props.children);
+  }
+
+});
+
+module.exports = ReactDOMButton;
+
+},{"./AutoFocusMixin":1,"./ReactBrowserComponentMixin":25,"./ReactCompositeComponent":29,"./ReactDOM":32,"./keyMirror":118}],34:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactDOMComponent
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var CSSPropertyOperations = _dereq_("./CSSPropertyOperations");
+var DOMProperty = _dereq_("./DOMProperty");
+var DOMPropertyOperations = _dereq_("./DOMPropertyOperations");
+var ReactBrowserComponentMixin = _dereq_("./ReactBrowserComponentMixin");
+var ReactComponent = _dereq_("./ReactComponent");
+var ReactEventEmitter = _dereq_("./ReactEventEmitter");
+var ReactMount = _dereq_("./ReactMount");
+var ReactMultiChild = _dereq_("./ReactMultiChild");
+var ReactPerf = _dereq_("./ReactPerf");
+
+var escapeTextForBrowser = _dereq_("./escapeTextForBrowser");
+var invariant = _dereq_("./invariant");
+var keyOf = _dereq_("./keyOf");
+var merge = _dereq_("./merge");
+var mixInto = _dereq_("./mixInto");
+
+var deleteListener = ReactEventEmitter.deleteListener;
+var listenTo = ReactEventEmitter.listenTo;
+var registrationNameModules = ReactEventEmitter.registrationNameModules;
+
+// For quickly matching children type, to test if can be treated as content.
+var CONTENT_TYPES = {'string': true, 'number': true};
+
+var STYLE = keyOf({style: null});
+
+var ELEMENT_NODE_TYPE = 1;
+
+/**
+ * @param {?object} props
+ */
+function assertValidProps(props) {
+  if (!props) {
+    return;
+  }
+  // Note the use of `==` which checks for null or undefined.
+  ("production" !== "development" ? invariant(
+    props.children == null || props.dangerouslySetInnerHTML == null,
+    'Can only set one of `children` or `props.dangerouslySetInnerHTML`.'
+  ) : invariant(props.children == null || props.dangerouslySetInnerHTML == null));
+  ("production" !== "development" ? invariant(
+    props.style == null || typeof props.style === 'object',
+    'The `style` prop expects a mapping from style properties to values, ' +
+    'not a string.'
+  ) : invariant(props.style == null || typeof props.style === 'object'));
+}
+
+function putListener(id, registrationName, listener, transaction) {
+  var container = ReactMount.findReactContainerForID(id);
+  if (container) {
+    var doc = container.nodeType === ELEMENT_NODE_TYPE ?
+      container.ownerDocument :
+      container;
+    listenTo(registrationName, doc);
+  }
+  transaction.getPutListenerQueue().enqueuePutListener(
+    id,
+    registrationName,
+    listener
+  );
+}
+
+
+/**
+ * @constructor ReactDOMComponent
+ * @extends ReactComponent
+ * @extends ReactMultiChild
+ */
+function ReactDOMComponent(tag, omitClose) {
+  this._tagOpen = '<' + tag;
+  this._tagClose = omitClose ? '' : '</' + tag + '>';
+  this.tagName = tag.toUpperCase();
+}
+
+ReactDOMComponent.Mixin = {
+
+  /**
+   * Generates root tag markup then recurses. This method has side effects and
+   * is not idempotent.
+   *
+   * @internal
+   * @param {string} rootID The root DOM ID for this node.
+   * @param {ReactReconcileTransaction|ReactServerRenderingTransaction} transaction
+   * @param {number} mountDepth number of components in the owner hierarchy
+   * @return {string} The computed markup.
+   */
+  mountComponent: ReactPerf.measure(
+    'ReactDOMComponent',
+    'mountComponent',
+    function(rootID, transaction, mountDepth) {
+      ReactComponent.Mixin.mountComponent.call(
+        this,
+        rootID,
+        transaction,
+        mountDepth
+      );
+      assertValidProps(this.props);
+      return (
+        this._createOpenTagMarkupAndPutListeners(transaction) +
+        this._createContentMarkup(transaction) +
+        this._tagClose
+      );
+    }
+  ),
+
+  /**
+   * Creates markup for the open tag and all attributes.
+   *
+   * This method has side effects because events get registered.
+   *
+   * Iterating over object properties is faster than iterating over arrays.
+   * @see http://jsperf.com/obj-vs-arr-iteration
+   *
+   * @private
+   * @param {ReactReconcileTransaction|ReactServerRenderingTransaction} transaction
+   * @return {string} Markup of opening tag.
+   */
+  _createOpenTagMarkupAndPutListeners: function(transaction) {
+    var props = this.props;
+    var ret = this._tagOpen;
+
+    for (var propKey in props) {
+      if (!props.hasOwnProperty(propKey)) {
+        continue;
+      }
+      var propValue = props[propKey];
+      if (propValue == null) {
+        continue;
+      }
+      if (registrationNameModules[propKey]) {
+        putListener(this._rootNodeID, propKey, propValue, transaction);
+      } else {
+        if (propKey === STYLE) {
+          if (propValue) {
+            propValue = props.style = merge(props.style);
+          }
+          propValue = CSSPropertyOperations.createMarkupForStyles(propValue);
+        }
+        var markup =
+          DOMPropertyOperations.createMarkupForProperty(propKey, propValue);
+        if (markup) {
+          ret += ' ' + markup;
+        }
+      }
+    }
+
+    // For static pages, no need to put React ID and checksum. Saves lots of
+    // bytes.
+    if (transaction.renderToStaticMarkup) {
+      return ret + '>';
+    }
+
+    var markupForID = DOMPropertyOperations.createMarkupForID(this._rootNodeID);
+    return ret + ' ' + markupForID + '>';
+  },
+
+  /**
+   * Creates markup for the content between the tags.
+   *
+   * @private
+   * @param {ReactReconcileTransaction|ReactServerRenderingTransaction} transaction
+   * @return {string} Content markup.
+   */
+  _createContentMarkup: function(transaction) {
+    // Intentional use of != to avoid catching zero/false.
+    var innerHTML = this.props.dangerouslySetInnerHTML;
+    if (innerHTML != null) {
+      if (innerHTML.__html != null) {
+        return innerHTML.__html;
+      }
+    } else {
+      var contentToUse =
+        CONTENT_TYPES[typeof this.props.children] ? this.props.children : null;
+      var childrenToUse = contentToUse != null ? null : this.props.children;
+      if (contentToUse != null) {
+        return escapeTextForBrowser(contentToUse);
+      } else if (childrenToUse != null) {
+        var mountImages = this.mountChildren(
+          childrenToUse,
+          transaction
+        );
+        return mountImages.join('');
+      }
+    }
+    return '';
+  },
+
+  receiveComponent: function(nextComponent, transaction) {
+    if (nextComponent === this) {
+      // Since props and context are immutable after the component is
+      // mounted, we can do a cheap identity compare here to determine
+      // if this is a superfluous reconcile.
+
+      // TODO: compare the descriptor
+      return;
+    }
+
+    assertValidProps(nextComponent.props);
+    ReactComponent.Mixin.receiveComponent.call(
+      this,
+      nextComponent,
+      transaction
+    );
+  },
+
+  /**
+   * Updates a native DOM component after it has already been allocated and
+   * attached to the DOM. Reconciles the root DOM node, then recurses.
+   *
+   * @param {ReactReconcileTransaction} transaction
+   * @param {object} prevProps
+   * @internal
+   * @overridable
+   */
+  updateComponent: ReactPerf.measure(
+    'ReactDOMComponent',
+    'updateComponent',
+    function(transaction, prevProps, prevOwner) {
+      ReactComponent.Mixin.updateComponent.call(
+        this,
+        transaction,
+        prevProps,
+        prevOwner
+      );
+      this._updateDOMProperties(prevProps, transaction);
+      this._updateDOMChildren(prevProps, transaction);
+    }
+  ),
+
+  /**
+   * Reconciles the properties by detecting differences in property values and
+   * updating the DOM as necessary. This function is probably the single most
+   * critical path for performance optimization.
+   *
+   * TODO: Benchmark whether checking for changed values in memory actually
+   *       improves performance (especially statically positioned elements).
+   * TODO: Benchmark the effects of putting this at the top since 99% of props
+   *       do not change for a given reconciliation.
+   * TODO: Benchmark areas that can be improved with caching.
+   *
+   * @private
+   * @param {object} lastProps
+   * @param {ReactReconcileTransaction} transaction
+   */
+  _updateDOMProperties: function(lastProps, transaction) {
+    var nextProps = this.props;
+    var propKey;
+    var styleName;
+    var styleUpdates;
+    for (propKey in lastProps) {
+      if (nextProps.hasOwnProperty(propKey) ||
+         !lastProps.hasOwnProperty(propKey)) {
+        continue;
+      }
+      if (propKey === STYLE) {
+        var lastStyle = lastProps[propKey];
+        for (styleName in lastStyle) {
+          if (lastStyle.hasOwnProperty(styleName)) {
+            styleUpdates = styleUpdates || {};
+            styleUpdates[styleName] = '';
+          }
+        }
+      } else if (registrationNameModules[propKey]) {
+        deleteListener(this._rootNodeID, propKey);
+      } else if (
+          DOMProperty.isStandardName[propKey] ||
+          DOMProperty.isCustomAttribute(propKey)) {
+        ReactComponent.BackendIDOperations.deletePropertyByID(
+          this._rootNodeID,
+          propKey
+        );
+      }
+    }
+    for (propKey in nextProps) {
+      var nextProp = nextProps[propKey];
+      var lastProp = lastProps[propKey];
+      if (!nextProps.hasOwnProperty(propKey) || nextProp === lastProp) {
+        continue;
+      }
+      if (propKey === STYLE) {
+        if (nextProp) {
+          nextProp = nextProps.style = merge(nextProp);
+        }
+        if (lastProp) {
+          // Unset styles on `lastProp` but not on `nextProp`.
+          for (styleName in lastProp) {
+            if (lastProp.hasOwnProperty(styleName) &&
+                !nextProp.hasOwnProperty(styleName)) {
+              styleUpdates = styleUpdates || {};
+              styleUpdates[styleName] = '';
+            }
+          }
+          // Update styles that changed since `lastProp`.
+          for (styleName in nextProp) {
+            if (nextProp.hasOwnProperty(styleName) &&
+                lastProp[styleName] !== nextProp[styleName]) {
+              styleUpdates = styleUpdates || {};
+              styleUpdates[styleName] = nextProp[styleName];
+            }
+          }
+        } else {
+          // Relies on `updateStylesByID` not mutating `styleUpdates`.
+          styleUpdates = nextProp;
+        }
+      } else if (registrationNameModules[propKey]) {
+        putListener(this._rootNodeID, propKey, nextProp, transaction);
+      } else if (
+          DOMProperty.isStandardName[propKey] ||
+          DOMProperty.isCustomAttribute(propKey)) {
+        ReactComponent.BackendIDOperations.updatePropertyByID(
+          this._rootNodeID,
+          propKey,
+          nextProp
+        );
+      }
+    }
+    if (styleUpdates) {
+      ReactComponent.BackendIDOperations.updateStylesByID(
+        this._rootNodeID,
+        styleUpdates
+      );
+    }
+  },
+
+  /**
+   * Reconciles the children with the various properties that affect the
+   * children content.
+   *
+   * @param {object} lastProps
+   * @param {ReactReconcileTransaction} transaction
+   */
+  _updateDOMChildren: function(lastProps, transaction) {
+    var nextProps = this.props;
+
+    var lastContent =
+      CONTENT_TYPES[typeof lastProps.children] ? lastProps.children : null;
+    var nextContent =
+      CONTENT_TYPES[typeof nextProps.children] ? nextProps.children : null;
+
+    var lastHtml =
+      lastProps.dangerouslySetInnerHTML &&
+      lastProps.dangerouslySetInnerHTML.__html;
+    var nextHtml =
+      nextProps.dangerouslySetInnerHTML &&
+      nextProps.dangerouslySetInnerHTML.__html;
+
+    // Note the use of `!=` which checks for null or undefined.
+    var lastChildren = lastContent != null ? null : lastProps.children;
+    var nextChildren = nextContent != null ? null : nextProps.children;
+
+    // If we're switching from children to content/html or vice versa, remove
+    // the old content
+    var lastHasContentOrHtml = lastContent != null || lastHtml != null;
+    var nextHasContentOrHtml = nextContent != null || nextHtml != null;
+    if (lastChildren != null && nextChildren == null) {
+      this.updateChildren(null, transaction);
+    } else if (lastHasContentOrHtml && !nextHasContentOrHtml) {
+      this.updateTextContent('');
+    }
+
+    if (nextContent != null) {
+      if (lastContent !== nextContent) {
+        this.updateTextContent('' + nextContent);
+      }
+    } else if (nextHtml != null) {
+      if (lastHtml !== nextHtml) {
+        ReactComponent.BackendIDOperations.updateInnerHTMLByID(
+          this._rootNodeID,
+          nextHtml
+        );
+      }
+    } else if (nextChildren != null) {
+      this.updateChildren(nextChildren, transaction);
+    }
+  },
+
+  /**
+   * Destroys all event registrations for this instance. Does not remove from
+   * the DOM. That must be done by the parent.
+   *
+   * @internal
+   */
+  unmountComponent: function() {
+    this.unmountChildren();
+    ReactEventEmitter.deleteAllListeners(this._rootNodeID);
+    ReactComponent.Mixin.unmountComponent.call(this);
+  }
+
+};
+
+mixInto(ReactDOMComponent, ReactComponent.Mixin);
+mixInto(ReactDOMComponent, ReactDOMComponent.Mixin);
+mixInto(ReactDOMComponent, ReactMultiChild.Mixin);
+mixInto(ReactDOMComponent, ReactBrowserComponentMixin);
+
+module.exports = ReactDOMComponent;
+
+},{"./CSSPropertyOperations":3,"./DOMProperty":8,"./DOMPropertyOperations":9,"./ReactBrowserComponentMixin":25,"./ReactComponent":27,"./ReactEventEmitter":48,"./ReactMount":55,"./ReactMultiChild":57,"./ReactPerf":60,"./escapeTextForBrowser":98,"./invariant":112,"./keyOf":119,"./merge":121,"./mixInto":124}],35:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactDOMForm
+ */
+
+"use strict";
+
+var ReactBrowserComponentMixin = _dereq_("./ReactBrowserComponentMixin");
+var ReactCompositeComponent = _dereq_("./ReactCompositeComponent");
+var ReactDOM = _dereq_("./ReactDOM");
+var ReactEventEmitter = _dereq_("./ReactEventEmitter");
+var EventConstants = _dereq_("./EventConstants");
+
+// Store a reference to the <form> `ReactDOMComponent`.
+var form = ReactDOM.form;
+
+/**
+ * Since onSubmit doesn't bubble OR capture on the top level in IE8, we need
+ * to capture it on the <form> element itself. There are lots of hacks we could
+ * do to accomplish this, but the most reliable is to make <form> a
+ * composite component and use `componentDidMount` to attach the event handlers.
+ */
+var ReactDOMForm = ReactCompositeComponent.createClass({
+  displayName: 'ReactDOMForm',
+
+  mixins: [ReactBrowserComponentMixin],
+
+  render: function() {
+    // TODO: Instead of using `ReactDOM` directly, we should use JSX. However,
+    // `jshint` fails to parse JSX so in order for linting to work in the open
+    // source repo, we need to just use `ReactDOM.form`.
+    return this.transferPropsTo(form(null, this.props.children));
+  },
+
+  componentDidMount: function() {
+    ReactEventEmitter.trapBubbledEvent(
+      EventConstants.topLevelTypes.topReset,
+      'reset',
+      this.getDOMNode()
+    );
+    ReactEventEmitter.trapBubbledEvent(
+      EventConstants.topLevelTypes.topSubmit,
+      'submit',
+      this.getDOMNode()
+    );
+  }
+});
+
+module.exports = ReactDOMForm;
+
+},{"./EventConstants":14,"./ReactBrowserComponentMixin":25,"./ReactCompositeComponent":29,"./ReactDOM":32,"./ReactEventEmitter":48}],36:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactDOMIDOperations
+ * @typechecks static-only
+ */
+
+/*jslint evil: true */
+
+"use strict";
+
+var CSSPropertyOperations = _dereq_("./CSSPropertyOperations");
+var DOMChildrenOperations = _dereq_("./DOMChildrenOperations");
+var DOMPropertyOperations = _dereq_("./DOMPropertyOperations");
+var ReactMount = _dereq_("./ReactMount");
+var ReactPerf = _dereq_("./ReactPerf");
+
+var invariant = _dereq_("./invariant");
+
+/**
+ * Errors for properties that should not be updated with `updatePropertyById()`.
+ *
+ * @type {object}
+ * @private
+ */
+var INVALID_PROPERTY_ERRORS = {
+  dangerouslySetInnerHTML:
+    '`dangerouslySetInnerHTML` must be set using `updateInnerHTMLByID()`.',
+  style: '`style` must be set using `updateStylesByID()`.'
+};
+
+var useWhitespaceWorkaround;
+
+/**
+ * Operations used to process updates to DOM nodes. This is made injectable via
+ * `ReactComponent.BackendIDOperations`.
+ */
+var ReactDOMIDOperations = {
+
+  /**
+   * Updates a DOM node with new property values. This should only be used to
+   * update DOM properties in `DOMProperty`.
+   *
+   * @param {string} id ID of the node to update.
+   * @param {string} name A valid property name, see `DOMProperty`.
+   * @param {*} value New value of the property.
+   * @internal
+   */
+  updatePropertyByID: ReactPerf.measure(
+    'ReactDOMIDOperations',
+    'updatePropertyByID',
+    function(id, name, value) {
+      var node = ReactMount.getNode(id);
+      ("production" !== "development" ? invariant(
+        !INVALID_PROPERTY_ERRORS.hasOwnProperty(name),
+        'updatePropertyByID(...): %s',
+        INVALID_PROPERTY_ERRORS[name]
+      ) : invariant(!INVALID_PROPERTY_ERRORS.hasOwnProperty(name)));
+
+      // If we're updating to null or undefined, we should remove the property
+      // from the DOM node instead of inadvertantly setting to a string. This
+      // brings us in line with the same behavior we have on initial render.
+      if (value != null) {
+        DOMPropertyOperations.setValueForProperty(node, name, value);
+      } else {
+        DOMPropertyOperations.deleteValueForProperty(node, name);
+      }
+    }
+  ),
+
+  /**
+   * Updates a DOM node to remove a property. This should only be used to remove
+   * DOM properties in `DOMProperty`.
+   *
+   * @param {string} id ID of the node to update.
+   * @param {string} name A property name to remove, see `DOMProperty`.
+   * @internal
+   */
+  deletePropertyByID: ReactPerf.measure(
+    'ReactDOMIDOperations',
+    'deletePropertyByID',
+    function(id, name, value) {
+      var node = ReactMount.getNode(id);
+      ("production" !== "development" ? invariant(
+        !INVALID_PROPERTY_ERRORS.hasOwnProperty(name),
+        'updatePropertyByID(...): %s',
+        INVALID_PROPERTY_ERRORS[name]
+      ) : invariant(!INVALID_PROPERTY_ERRORS.hasOwnProperty(name)));
+      DOMPropertyOperations.deleteValueForProperty(node, name, value);
+    }
+  ),
+
+  /**
+   * Updates a DOM node with new style values. If a value is specified as '',
+   * the corresponding style property will be unset.
+   *
+   * @param {string} id ID of the node to update.
+   * @param {object} styles Mapping from styles to values.
+   * @internal
+   */
+  updateStylesByID: ReactPerf.measure(
+    'ReactDOMIDOperations',
+    'updateStylesByID',
+    function(id, styles) {
+      var node = ReactMount.getNode(id);
+      CSSPropertyOperations.setValueForStyles(node, styles);
+    }
+  ),
+
+  /**
+   * Updates a DOM node's innerHTML.
+   *
+   * @param {string} id ID of the node to update.
+   * @param {string} html An HTML string.
+   * @internal
+   */
+  updateInnerHTMLByID: ReactPerf.measure(
+    'ReactDOMIDOperations',
+    'updateInnerHTMLByID',
+    function(id, html) {
+      var node = ReactMount.getNode(id);
+
+      // IE8: When updating a just created node with innerHTML only leading
+      // whitespace is removed. When updating an existing node with innerHTML
+      // whitespace in root TextNodes is also collapsed.
+      // @see quirksmode.org/bugreports/archives/2004/11/innerhtml_and_t.html
+
+      if (useWhitespaceWorkaround === undefined) {
+        // Feature detection; only IE8 is known to behave improperly like this.
+        var temp = document.createElement('div');
+        temp.innerHTML = ' ';
+        useWhitespaceWorkaround = temp.innerHTML === '';
+      }
+
+      if (useWhitespaceWorkaround) {
+        // Magic theory: IE8 supposedly differentiates between added and updated
+        // nodes when processing innerHTML, innerHTML on updated nodes suffers
+        // from worse whitespace behavior. Re-adding a node like this triggers
+        // the initial and more favorable whitespace behavior.
+        node.parentNode.replaceChild(node, node);
+      }
+
+      if (useWhitespaceWorkaround && html.match(/^[ \r\n\t\f]/)) {
+        // Recover leading whitespace by temporarily prepending any character.
+        // \uFEFF has the potential advantage of being zero-width/invisible.
+        node.innerHTML = '\uFEFF' + html;
+        node.firstChild.deleteData(0, 1);
+      } else {
+        node.innerHTML = html;
+      }
+    }
+  ),
+
+  /**
+   * Updates a DOM node's text content set by `props.content`.
+   *
+   * @param {string} id ID of the node to update.
+   * @param {string} content Text content.
+   * @internal
+   */
+  updateTextContentByID: ReactPerf.measure(
+    'ReactDOMIDOperations',
+    'updateTextContentByID',
+    function(id, content) {
+      var node = ReactMount.getNode(id);
+      DOMChildrenOperations.updateTextContent(node, content);
+    }
+  ),
+
+  /**
+   * Replaces a DOM node that exists in the document with markup.
+   *
+   * @param {string} id ID of child to be replaced.
+   * @param {string} markup Dangerous markup to inject in place of child.
+   * @internal
+   * @see {Danger.dangerouslyReplaceNodeWithMarkup}
+   */
+  dangerouslyReplaceNodeWithMarkupByID: ReactPerf.measure(
+    'ReactDOMIDOperations',
+    'dangerouslyReplaceNodeWithMarkupByID',
+    function(id, markup) {
+      var node = ReactMount.getNode(id);
+      DOMChildrenOperations.dangerouslyReplaceNodeWithMarkup(node, markup);
+    }
+  ),
+
+  /**
+   * Updates a component's children by processing a series of updates.
+   *
+   * @param {array<object>} updates List of update configurations.
+   * @param {array<string>} markup List of markup strings.
+   * @internal
+   */
+  dangerouslyProcessChildrenUpdates: ReactPerf.measure(
+    'ReactDOMIDOperations',
+    'dangerouslyProcessChildrenUpdates',
+    function(updates, markup) {
+      for (var i = 0; i < updates.length; i++) {
+        updates[i].parentNode = ReactMount.getNode(updates[i].parentID);
+      }
+      DOMChildrenOperations.processUpdates(updates, markup);
+    }
+  )
+};
+
+module.exports = ReactDOMIDOperations;
+
+},{"./CSSPropertyOperations":3,"./DOMChildrenOperations":7,"./DOMPropertyOperations":9,"./ReactMount":55,"./ReactPerf":60,"./invariant":112}],37:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactDOMImg
+ */
+
+"use strict";
+
+var ReactBrowserComponentMixin = _dereq_("./ReactBrowserComponentMixin");
+var ReactCompositeComponent = _dereq_("./ReactCompositeComponent");
+var ReactDOM = _dereq_("./ReactDOM");
+var ReactEventEmitter = _dereq_("./ReactEventEmitter");
+var EventConstants = _dereq_("./EventConstants");
+
+// Store a reference to the <img> `ReactDOMComponent`.
+var img = ReactDOM.img;
+
+/**
+ * Since onLoad doesn't bubble OR capture on the top level in IE8, we need to
+ * capture it on the <img> element itself. There are lots of hacks we could do
+ * to accomplish this, but the most reliable is to make <img> a composite
+ * component and use `componentDidMount` to attach the event handlers.
+ */
+var ReactDOMImg = ReactCompositeComponent.createClass({
+  displayName: 'ReactDOMImg',
+  tagName: 'IMG',
+
+  mixins: [ReactBrowserComponentMixin],
+
+  render: function() {
+    return img(this.props);
+  },
+
+  componentDidMount: function() {
+    var node = this.getDOMNode();
+    ReactEventEmitter.trapBubbledEvent(
+      EventConstants.topLevelTypes.topLoad,
+      'load',
+      node
+    );
+    ReactEventEmitter.trapBubbledEvent(
+      EventConstants.topLevelTypes.topError,
+      'error',
+      node
+    );
+  }
+});
+
+module.exports = ReactDOMImg;
+
+},{"./EventConstants":14,"./ReactBrowserComponentMixin":25,"./ReactCompositeComponent":29,"./ReactDOM":32,"./ReactEventEmitter":48}],38:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactDOMInput
+ */
+
+"use strict";
+
+var AutoFocusMixin = _dereq_("./AutoFocusMixin");
+var DOMPropertyOperations = _dereq_("./DOMPropertyOperations");
+var LinkedValueUtils = _dereq_("./LinkedValueUtils");
+var ReactBrowserComponentMixin = _dereq_("./ReactBrowserComponentMixin");
+var ReactCompositeComponent = _dereq_("./ReactCompositeComponent");
+var ReactDOM = _dereq_("./ReactDOM");
+var ReactMount = _dereq_("./ReactMount");
+
+var invariant = _dereq_("./invariant");
+var merge = _dereq_("./merge");
+
+// Store a reference to the <input> `ReactDOMComponent`.
+var input = ReactDOM.input;
+
+var instancesByReactID = {};
+
+/**
+ * Implements an <input> native component that allows setting these optional
+ * props: `checked`, `value`, `defaultChecked`, and `defaultValue`.
+ *
+ * If `checked` or `value` are not supplied (or null/undefined), user actions
+ * that affect the checked state or value will trigger updates to the element.
+ *
+ * If they are supplied (and not null/undefined), the rendered element will not
+ * trigger updates to the element. Instead, the props must change in order for
+ * the rendered element to be updated.
+ *
+ * The rendered element will be initialized as unchecked (or `defaultChecked`)
+ * with an empty value (or `defaultValue`).
+ *
+ * @see http://www.w3.org/TR/2012/WD-html5-20121025/the-input-element.html
+ */
+var ReactDOMInput = ReactCompositeComponent.createClass({
+  displayName: 'ReactDOMInput',
+
+  mixins: [AutoFocusMixin, LinkedValueUtils.Mixin, ReactBrowserComponentMixin],
+
+  getInitialState: function() {
+    var defaultValue = this.props.defaultValue;
+    return {
+      checked: this.props.defaultChecked || false,
+      value: defaultValue != null ? defaultValue : null
+    };
+  },
+
+  shouldComponentUpdate: function() {
+    // Defer any updates to this component during the `onChange` handler.
+    return !this._isChanging;
+  },
+
+  render: function() {
+    // Clone `this.props` so we don't mutate the input.
+    var props = merge(this.props);
+
+    props.defaultChecked = null;
+    props.defaultValue = null;
+
+    var value = LinkedValueUtils.getValue(this);
+    props.value = value != null ? value : this.state.value;
+
+    var checked = LinkedValueUtils.getChecked(this);
+    props.checked = checked != null ? checked : this.state.checked;
+
+    props.onChange = this._handleChange;
+
+    return input(props, this.props.children);
+  },
+
+  componentDidMount: function() {
+    var id = ReactMount.getID(this.getDOMNode());
+    instancesByReactID[id] = this;
+  },
+
+  componentWillUnmount: function() {
+    var rootNode = this.getDOMNode();
+    var id = ReactMount.getID(rootNode);
+    delete instancesByReactID[id];
+  },
+
+  componentDidUpdate: function(prevProps, prevState, prevContext) {
+    var rootNode = this.getDOMNode();
+    if (this.props.checked != null) {
+      DOMPropertyOperations.setValueForProperty(
+        rootNode,
+        'checked',
+        this.props.checked || false
+      );
+    }
+
+    var value = LinkedValueUtils.getValue(this);
+    if (value != null) {
+      // Cast `value` to a string to ensure the value is set correctly. While
+      // browsers typically do this as necessary, jsdom doesn't.
+      DOMPropertyOperations.setValueForProperty(rootNode, 'value', '' + value);
+    }
+  },
+
+  _handleChange: function(event) {
+    var returnValue;
+    var onChange = LinkedValueUtils.getOnChange(this);
+    if (onChange) {
+      this._isChanging = true;
+      returnValue = onChange.call(this, event);
+      this._isChanging = false;
+    }
+    this.setState({
+      checked: event.target.checked,
+      value: event.target.value
+    });
+
+    var name = this.props.name;
+    if (this.props.type === 'radio' && name != null) {
+      var rootNode = this.getDOMNode();
+      var queryRoot = rootNode;
+
+      while (queryRoot.parentNode) {
+        queryRoot = queryRoot.parentNode;
+      }
+
+      // If `rootNode.form` was non-null, then we could try `form.elements`,
+      // but that sometimes behaves strangely in IE8. We could also try using
+      // `form.getElementsByName`, but that will only return direct children
+      // and won't include inputs that use the HTML5 `form=` attribute. Since
+      // the input might not even be in a form, let's just use the global
+      // `querySelectorAll` to ensure we don't miss anything.
+      var group = queryRoot.querySelectorAll(
+        'input[name=' + JSON.stringify('' + name) + '][type="radio"]');
+
+      for (var i = 0, groupLen = group.length; i < groupLen; i++) {
+        var otherNode = group[i];
+        if (otherNode === rootNode ||
+            otherNode.form !== rootNode.form) {
+          continue;
+        }
+        var otherID = ReactMount.getID(otherNode);
+        ("production" !== "development" ? invariant(
+          otherID,
+          'ReactDOMInput: Mixing React and non-React radio inputs with the ' +
+          'same `name` is not supported.'
+        ) : invariant(otherID));
+        var otherInstance = instancesByReactID[otherID];
+        ("production" !== "development" ? invariant(
+          otherInstance,
+          'ReactDOMInput: Unknown radio button ID %s.',
+          otherID
+        ) : invariant(otherInstance));
+        // In some cases, this will actually change the `checked` state value.
+        // In other cases, there's no change but this forces a reconcile upon
+        // which componentDidUpdate will reset the DOM property to whatever it
+        // should be.
+        otherInstance.setState({
+          checked: false
+        });
+      }
+    }
+
+    return returnValue;
+  }
+
+});
+
+module.exports = ReactDOMInput;
+
+},{"./AutoFocusMixin":1,"./DOMPropertyOperations":9,"./LinkedValueUtils":21,"./ReactBrowserComponentMixin":25,"./ReactCompositeComponent":29,"./ReactDOM":32,"./ReactMount":55,"./invariant":112,"./merge":121}],39:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactDOMOption
+ */
+
+"use strict";
+
+var ReactBrowserComponentMixin = _dereq_("./ReactBrowserComponentMixin");
+var ReactCompositeComponent = _dereq_("./ReactCompositeComponent");
+var ReactDOM = _dereq_("./ReactDOM");
+
+var warning = _dereq_("./warning");
+
+// Store a reference to the <option> `ReactDOMComponent`.
+var option = ReactDOM.option;
+
+/**
+ * Implements an <option> native component that warns when `selected` is set.
+ */
+var ReactDOMOption = ReactCompositeComponent.createClass({
+  displayName: 'ReactDOMOption',
+
+  mixins: [ReactBrowserComponentMixin],
+
+  componentWillMount: function() {
+    // TODO (yungsters): Remove support for `selected` in <option>.
+    if ("production" !== "development") {
+      ("production" !== "development" ? warning(
+        this.props.selected == null,
+        'Use the `defaultValue` or `value` props on <select> instead of ' +
+        'setting `selected` on <option>.'
+      ) : null);
+    }
+  },
+
+  render: function() {
+    return option(this.props, this.props.children);
+  }
+
+});
+
+module.exports = ReactDOMOption;
+
+},{"./ReactBrowserComponentMixin":25,"./ReactCompositeComponent":29,"./ReactDOM":32,"./warning":134}],40:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactDOMSelect
+ */
+
+"use strict";
+
+var AutoFocusMixin = _dereq_("./AutoFocusMixin");
+var LinkedValueUtils = _dereq_("./LinkedValueUtils");
+var ReactBrowserComponentMixin = _dereq_("./ReactBrowserComponentMixin");
+var ReactCompositeComponent = _dereq_("./ReactCompositeComponent");
+var ReactDOM = _dereq_("./ReactDOM");
+
+var invariant = _dereq_("./invariant");
+var merge = _dereq_("./merge");
+
+// Store a reference to the <select> `ReactDOMComponent`.
+var select = ReactDOM.select;
+
+/**
+ * Validation function for `value` and `defaultValue`.
+ * @private
+ */
+function selectValueType(props, propName, componentName) {
+  if (props[propName] == null) {
+    return;
+  }
+  if (props.multiple) {
+    ("production" !== "development" ? invariant(
+      Array.isArray(props[propName]),
+      'The `%s` prop supplied to <select> must be an array if `multiple` is ' +
+      'true.',
+      propName
+    ) : invariant(Array.isArray(props[propName])));
+  } else {
+    ("production" !== "development" ? invariant(
+      !Array.isArray(props[propName]),
+      'The `%s` prop supplied to <select> must be a scalar value if ' +
+      '`multiple` is false.',
+      propName
+    ) : invariant(!Array.isArray(props[propName])));
+  }
+}
+
+/**
+ * If `value` is supplied, updates <option> elements on mount and update.
+ * @param {ReactComponent} component Instance of ReactDOMSelect
+ * @param {?*} propValue For uncontrolled components, null/undefined. For
+ * controlled components, a string (or with `multiple`, a list of strings).
+ * @private
+ */
+function updateOptions(component, propValue) {
+  var multiple = component.props.multiple;
+  var value = propValue != null ? propValue : component.state.value;
+  var options = component.getDOMNode().options;
+  var selectedValue, i, l;
+  if (multiple) {
+    selectedValue = {};
+    for (i = 0, l = value.length; i < l; ++i) {
+      selectedValue['' + value[i]] = true;
+    }
+  } else {
+    selectedValue = '' + value;
+  }
+  for (i = 0, l = options.length; i < l; i++) {
+    var selected = multiple ?
+      selectedValue.hasOwnProperty(options[i].value) :
+      options[i].value === selectedValue;
+
+    if (selected !== options[i].selected) {
+      options[i].selected = selected;
+    }
+  }
+}
+
+/**
+ * Implements a <select> native component that allows optionally setting the
+ * props `value` and `defaultValue`. If `multiple` is false, the prop must be a
+ * string. If `multiple` is true, the prop must be an array of strings.
+ *
+ * If `value` is not supplied (or null/undefined), user actions that change the
+ * selected option will trigger updates to the rendered options.
+ *
+ * If it is supplied (and not null/undefined), the rendered options will not
+ * update in response to user actions. Instead, the `value` prop must change in
+ * order for the rendered options to update.
+ *
+ * If `defaultValue` is provided, any options with the supplied values will be
+ * selected.
+ */
+var ReactDOMSelect = ReactCompositeComponent.createClass({
+  displayName: 'ReactDOMSelect',
+
+  mixins: [AutoFocusMixin, LinkedValueUtils.Mixin, ReactBrowserComponentMixin],
+
+  propTypes: {
+    defaultValue: selectValueType,
+    value: selectValueType
+  },
+
+  getInitialState: function() {
+    return {value: this.props.defaultValue || (this.props.multiple ? [] : '')};
+  },
+
+  componentWillReceiveProps: function(nextProps) {
+    if (!this.props.multiple && nextProps.multiple) {
+      this.setState({value: [this.state.value]});
+    } else if (this.props.multiple && !nextProps.multiple) {
+      this.setState({value: this.state.value[0]});
+    }
+  },
+
+  shouldComponentUpdate: function() {
+    // Defer any updates to this component during the `onChange` handler.
+    return !this._isChanging;
+  },
+
+  render: function() {
+    // Clone `this.props` so we don't mutate the input.
+    var props = merge(this.props);
+
+    props.onChange = this._handleChange;
+    props.value = null;
+
+    return select(props, this.props.children);
+  },
+
+  componentDidMount: function() {
+    updateOptions(this, LinkedValueUtils.getValue(this));
+  },
+
+  componentDidUpdate: function() {
+    var value = LinkedValueUtils.getValue(this);
+    if (value != null) {
+      updateOptions(this, value);
+    }
+  },
+
+  _handleChange: function(event) {
+    var returnValue;
+    var onChange = LinkedValueUtils.getOnChange(this);
+    if (onChange) {
+      this._isChanging = true;
+      returnValue = onChange.call(this, event);
+      this._isChanging = false;
+    }
+
+    var selectedValue;
+    if (this.props.multiple) {
+      selectedValue = [];
+      var options = event.target.options;
+      for (var i = 0, l = options.length; i < l; i++) {
+        if (options[i].selected) {
+          selectedValue.push(options[i].value);
+        }
+      }
+    } else {
+      selectedValue = event.target.value;
+    }
+
+    this.setState({value: selectedValue});
+    return returnValue;
+  }
+
+});
+
+module.exports = ReactDOMSelect;
+
+},{"./AutoFocusMixin":1,"./LinkedValueUtils":21,"./ReactBrowserComponentMixin":25,"./ReactCompositeComponent":29,"./ReactDOM":32,"./invariant":112,"./merge":121}],41:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactDOMSelection
+ */
+
+"use strict";
+
+var getNodeForCharacterOffset = _dereq_("./getNodeForCharacterOffset");
+var getTextContentAccessor = _dereq_("./getTextContentAccessor");
+
+/**
+ * Get the appropriate anchor and focus node/offset pairs for IE.
+ *
+ * The catch here is that IE's selection API doesn't provide information
+ * about whether the selection is forward or backward, so we have to
+ * behave as though it's always forward.
+ *
+ * IE text differs from modern selection in that it behaves as though
+ * block elements end with a new line. This means character offsets will
+ * differ between the two APIs.
+ *
+ * @param {DOMElement} node
+ * @return {object}
+ */
+function getIEOffsets(node) {
+  var selection = document.selection;
+  var selectedRange = selection.createRange();
+  var selectedLength = selectedRange.text.length;
+
+  // Duplicate selection so we can move range without breaking user selection.
+  var fromStart = selectedRange.duplicate();
+  fromStart.moveToElementText(node);
+  fromStart.setEndPoint('EndToStart', selectedRange);
+
+  var startOffset = fromStart.text.length;
+  var endOffset = startOffset + selectedLength;
+
+  return {
+    start: startOffset,
+    end: endOffset
+  };
+}
+
+/**
+ * @param {DOMElement} node
+ * @return {?object}
+ */
+function getModernOffsets(node) {
+  var selection = window.getSelection();
+
+  if (selection.rangeCount === 0) {
+    return null;
+  }
+
+  var anchorNode = selection.anchorNode;
+  var anchorOffset = selection.anchorOffset;
+  var focusNode = selection.focusNode;
+  var focusOffset = selection.focusOffset;
+
+  var currentRange = selection.getRangeAt(0);
+  var rangeLength = currentRange.toString().length;
+
+  var tempRange = currentRange.cloneRange();
+  tempRange.selectNodeContents(node);
+  tempRange.setEnd(currentRange.startContainer, currentRange.startOffset);
+
+  var start = tempRange.toString().length;
+  var end = start + rangeLength;
+
+  // Detect whether the selection is backward.
+  var detectionRange = document.createRange();
+  detectionRange.setStart(anchorNode, anchorOffset);
+  detectionRange.setEnd(focusNode, focusOffset);
+  var isBackward = detectionRange.collapsed;
+  detectionRange.detach();
+
+  return {
+    start: isBackward ? end : start,
+    end: isBackward ? start : end
+  };
+}
+
+/**
+ * @param {DOMElement|DOMTextNode} node
+ * @param {object} offsets
+ */
+function setIEOffsets(node, offsets) {
+  var range = document.selection.createRange().duplicate();
+  var start, end;
+
+  if (typeof offsets.end === 'undefined') {
+    start = offsets.start;
+    end = start;
+  } else if (offsets.start > offsets.end) {
+    start = offsets.end;
+    end = offsets.start;
+  } else {
+    start = offsets.start;
+    end = offsets.end;
+  }
+
+  range.moveToElementText(node);
+  range.moveStart('character', start);
+  range.setEndPoint('EndToStart', range);
+  range.moveEnd('character', end - start);
+  range.select();
+}
+
+/**
+ * In modern non-IE browsers, we can support both forward and backward
+ * selections.
+ *
+ * Note: IE10+ supports the Selection object, but it does not support
+ * the `extend` method, which means that even in modern IE, it's not possible
+ * to programatically create a backward selection. Thus, for all IE
+ * versions, we use the old IE API to create our selections.
+ *
+ * @param {DOMElement|DOMTextNode} node
+ * @param {object} offsets
+ */
+function setModernOffsets(node, offsets) {
+  var selection = window.getSelection();
+
+  var length = node[getTextContentAccessor()].length;
+  var start = Math.min(offsets.start, length);
+  var end = typeof offsets.end === 'undefined' ?
+            start : Math.min(offsets.end, length);
+
+  // IE 11 uses modern selection, but doesn't support the extend method.
+  // Flip backward selections, so we can set with a single range.
+  if (!selection.extend && start > end) {
+    var temp = end;
+    end = start;
+    start = temp;
+  }
+
+  var startMarker = getNodeForCharacterOffset(node, start);
+  var endMarker = getNodeForCharacterOffset(node, end);
+
+  if (startMarker && endMarker) {
+    var range = document.createRange();
+    range.setStart(startMarker.node, startMarker.offset);
+    selection.removeAllRanges();
+
+    if (start > end) {
+      selection.addRange(range);
+      selection.extend(endMarker.node, endMarker.offset);
+    } else {
+      range.setEnd(endMarker.node, endMarker.offset);
+      selection.addRange(range);
+    }
+
+    range.detach();
+  }
+}
+
+var ReactDOMSelection = {
+  /**
+   * @param {DOMElement} node
+   */
+  getOffsets: function(node) {
+    var getOffsets = document.selection ? getIEOffsets : getModernOffsets;
+    return getOffsets(node);
+  },
+
+  /**
+   * @param {DOMElement|DOMTextNode} node
+   * @param {object} offsets
+   */
+  setOffsets: function(node, offsets) {
+    var setOffsets = document.selection ? setIEOffsets : setModernOffsets;
+    setOffsets(node, offsets);
+  }
+};
+
+module.exports = ReactDOMSelection;
+
+},{"./getNodeForCharacterOffset":106,"./getTextContentAccessor":108}],42:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactDOMTextarea
+ */
+
+"use strict";
+
+var AutoFocusMixin = _dereq_("./AutoFocusMixin");
+var DOMPropertyOperations = _dereq_("./DOMPropertyOperations");
+var LinkedValueUtils = _dereq_("./LinkedValueUtils");
+var ReactBrowserComponentMixin = _dereq_("./ReactBrowserComponentMixin");
+var ReactCompositeComponent = _dereq_("./ReactCompositeComponent");
+var ReactDOM = _dereq_("./ReactDOM");
+
+var invariant = _dereq_("./invariant");
+var merge = _dereq_("./merge");
+
+var warning = _dereq_("./warning");
+
+// Store a reference to the <textarea> `ReactDOMComponent`.
+var textarea = ReactDOM.textarea;
+
+/**
+ * Implements a <textarea> native component that allows setting `value`, and
+ * `defaultValue`. This differs from the traditional DOM API because value is
+ * usually set as PCDATA children.
+ *
+ * If `value` is not supplied (or null/undefined), user actions that affect the
+ * value will trigger updates to the element.
+ *
+ * If `value` is supplied (and not null/undefined), the rendered element will
+ * not trigger updates to the element. Instead, the `value` prop must change in
+ * order for the rendered element to be updated.
+ *
+ * The rendered element will be initialized with an empty value, the prop
+ * `defaultValue` if specified, or the children content (deprecated).
+ */
+var ReactDOMTextarea = ReactCompositeComponent.createClass({
+  displayName: 'ReactDOMTextarea',
+
+  mixins: [AutoFocusMixin, LinkedValueUtils.Mixin, ReactBrowserComponentMixin],
+
+  getInitialState: function() {
+    var defaultValue = this.props.defaultValue;
+    // TODO (yungsters): Remove support for children content in <textarea>.
+    var children = this.props.children;
+    if (children != null) {
+      if ("production" !== "development") {
+        ("production" !== "development" ? warning(
+          false,
+          'Use the `defaultValue` or `value` props instead of setting ' +
+          'children on <textarea>.'
+        ) : null);
+      }
+      ("production" !== "development" ? invariant(
+        defaultValue == null,
+        'If you supply `defaultValue` on a <textarea>, do not pass children.'
+      ) : invariant(defaultValue == null));
+      if (Array.isArray(children)) {
+        ("production" !== "development" ? invariant(
+          children.length <= 1,
+          '<textarea> can only have at most one child.'
+        ) : invariant(children.length <= 1));
+        children = children[0];
+      }
+
+      defaultValue = '' + children;
+    }
+    if (defaultValue == null) {
+      defaultValue = '';
+    }
+    var value = LinkedValueUtils.getValue(this);
+    return {
+      // We save the initial value so that `ReactDOMComponent` doesn't update
+      // `textContent` (unnecessary since we update value).
+      // The initial value can be a boolean or object so that's why it's
+      // forced to be a string.
+      initialValue: '' + (value != null ? value : defaultValue),
+      value: defaultValue
+    };
+  },
+
+  shouldComponentUpdate: function() {
+    // Defer any updates to this component during the `onChange` handler.
+    return !this._isChanging;
+  },
+
+  render: function() {
+    // Clone `this.props` so we don't mutate the input.
+    var props = merge(this.props);
+    var value = LinkedValueUtils.getValue(this);
+
+    ("production" !== "development" ? invariant(
+      props.dangerouslySetInnerHTML == null,
+      '`dangerouslySetInnerHTML` does not make sense on <textarea>.'
+    ) : invariant(props.dangerouslySetInnerHTML == null));
+
+    props.defaultValue = null;
+    props.value = value != null ? value : this.state.value;
+    props.onChange = this._handleChange;
+
+    // Always set children to the same thing. In IE9, the selection range will
+    // get reset if `textContent` is mutated.
+    return textarea(props, this.state.initialValue);
+  },
+
+  componentDidUpdate: function(prevProps, prevState, prevContext) {
+    var value = LinkedValueUtils.getValue(this);
+    if (value != null) {
+      var rootNode = this.getDOMNode();
+      // Cast `value` to a string to ensure the value is set correctly. While
+      // browsers typically do this as necessary, jsdom doesn't.
+      DOMPropertyOperations.setValueForProperty(rootNode, 'value', '' + value);
+    }
+  },
+
+  _handleChange: function(event) {
+    var returnValue;
+    var onChange = LinkedValueUtils.getOnChange(this);
+    if (onChange) {
+      this._isChanging = true;
+      returnValue = onChange.call(this, event);
+      this._isChanging = false;
+    }
+    this.setState({value: event.target.value});
+    return returnValue;
+  }
+
+});
+
+module.exports = ReactDOMTextarea;
+
+},{"./AutoFocusMixin":1,"./DOMPropertyOperations":9,"./LinkedValueUtils":21,"./ReactBrowserComponentMixin":25,"./ReactCompositeComponent":29,"./ReactDOM":32,"./invariant":112,"./merge":121,"./warning":134}],43:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactDefaultBatchingStrategy
+ */
+
+"use strict";
+
+var ReactUpdates = _dereq_("./ReactUpdates");
+var Transaction = _dereq_("./Transaction");
+
+var emptyFunction = _dereq_("./emptyFunction");
+var mixInto = _dereq_("./mixInto");
+
+var RESET_BATCHED_UPDATES = {
+  initialize: emptyFunction,
+  close: function() {
+    ReactDefaultBatchingStrategy.isBatchingUpdates = false;
+  }
+};
+
+var FLUSH_BATCHED_UPDATES = {
+  initialize: emptyFunction,
+  close: ReactUpdates.flushBatchedUpdates.bind(ReactUpdates)
+};
+
+var TRANSACTION_WRAPPERS = [FLUSH_BATCHED_UPDATES, RESET_BATCHED_UPDATES];
+
+function ReactDefaultBatchingStrategyTransaction() {
+  this.reinitializeTransaction();
+}
+
+mixInto(ReactDefaultBatchingStrategyTransaction, Transaction.Mixin);
+mixInto(ReactDefaultBatchingStrategyTransaction, {
+  getTransactionWrappers: function() {
+    return TRANSACTION_WRAPPERS;
+  }
+});
+
+var transaction = new ReactDefaultBatchingStrategyTransaction();
+
+var ReactDefaultBatchingStrategy = {
+  isBatchingUpdates: false,
+
+  /**
+   * Call the provided function in a context within which calls to `setState`
+   * and friends are batched such that components aren't updated unnecessarily.
+   */
+  batchedUpdates: function(callback, param) {
+    var alreadyBatchingUpdates = ReactDefaultBatchingStrategy.isBatchingUpdates;
+
+    ReactDefaultBatchingStrategy.isBatchingUpdates = true;
+
+    // The code is written this way to avoid extra allocations
+    if (alreadyBatchingUpdates) {
+      callback(param);
+    } else {
+      transaction.perform(callback, null, param);
+    }
+  }
+};
+
+module.exports = ReactDefaultBatchingStrategy;
+
+},{"./ReactUpdates":71,"./Transaction":85,"./emptyFunction":96,"./mixInto":124}],44:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactDefaultInjection
+ */
+
+"use strict";
+
+var ReactInjection = _dereq_("./ReactInjection");
+
+var ExecutionEnvironment = _dereq_("./ExecutionEnvironment");
+
+var DefaultDOMPropertyConfig = _dereq_("./DefaultDOMPropertyConfig");
+
+var ChangeEventPlugin = _dereq_("./ChangeEventPlugin");
+var ClientReactRootIndex = _dereq_("./ClientReactRootIndex");
+var CompositionEventPlugin = _dereq_("./CompositionEventPlugin");
+var DefaultEventPluginOrder = _dereq_("./DefaultEventPluginOrder");
+var EnterLeaveEventPlugin = _dereq_("./EnterLeaveEventPlugin");
+var MobileSafariClickEventPlugin = _dereq_("./MobileSafariClickEventPlugin");
+var ReactBrowserComponentMixin = _dereq_("./ReactBrowserComponentMixin");
+var ReactComponentBrowserEnvironment =
+  _dereq_("./ReactComponentBrowserEnvironment");
+var ReactEventTopLevelCallback = _dereq_("./ReactEventTopLevelCallback");
+var ReactDOM = _dereq_("./ReactDOM");
+var ReactDOMButton = _dereq_("./ReactDOMButton");
+var ReactDOMForm = _dereq_("./ReactDOMForm");
+var ReactDOMImg = _dereq_("./ReactDOMImg");
+var ReactDOMInput = _dereq_("./ReactDOMInput");
+var ReactDOMOption = _dereq_("./ReactDOMOption");
+var ReactDOMSelect = _dereq_("./ReactDOMSelect");
+var ReactDOMTextarea = _dereq_("./ReactDOMTextarea");
+var ReactInstanceHandles = _dereq_("./ReactInstanceHandles");
+var ReactMount = _dereq_("./ReactMount");
+var SelectEventPlugin = _dereq_("./SelectEventPlugin");
+var ServerReactRootIndex = _dereq_("./ServerReactRootIndex");
+var SimpleEventPlugin = _dereq_("./SimpleEventPlugin");
+
+var ReactDefaultBatchingStrategy = _dereq_("./ReactDefaultBatchingStrategy");
+
+var createFullPageComponent = _dereq_("./createFullPageComponent");
+
+function inject() {
+  ReactInjection.EventEmitter.injectTopLevelCallbackCreator(
+    ReactEventTopLevelCallback
+  );
+
+  /**
+   * Inject modules for resolving DOM hierarchy and plugin ordering.
+   */
+  ReactInjection.EventPluginHub.injectEventPluginOrder(DefaultEventPluginOrder);
+  ReactInjection.EventPluginHub.injectInstanceHandle(ReactInstanceHandles);
+  ReactInjection.EventPluginHub.injectMount(ReactMount);
+
+  /**
+   * Some important event plugins included by default (without having to require
+   * them).
+   */
+  ReactInjection.EventPluginHub.injectEventPluginsByName({
+    SimpleEventPlugin: SimpleEventPlugin,
+    EnterLeaveEventPlugin: EnterLeaveEventPlugin,
+    ChangeEventPlugin: ChangeEventPlugin,
+    CompositionEventPlugin: CompositionEventPlugin,
+    MobileSafariClickEventPlugin: MobileSafariClickEventPlugin,
+    SelectEventPlugin: SelectEventPlugin
+  });
+
+  ReactInjection.DOM.injectComponentClasses({
+    button: ReactDOMButton,
+    form: ReactDOMForm,
+    img: ReactDOMImg,
+    input: ReactDOMInput,
+    option: ReactDOMOption,
+    select: ReactDOMSelect,
+    textarea: ReactDOMTextarea,
+
+    html: createFullPageComponent(ReactDOM.html),
+    head: createFullPageComponent(ReactDOM.head),
+    title: createFullPageComponent(ReactDOM.title),
+    body: createFullPageComponent(ReactDOM.body)
+  });
+
+
+  // This needs to happen after createFullPageComponent() otherwise the mixin
+  // gets double injected.
+  ReactInjection.CompositeComponent.injectMixin(ReactBrowserComponentMixin);
+
+  ReactInjection.DOMProperty.injectDOMPropertyConfig(DefaultDOMPropertyConfig);
+
+  ReactInjection.Updates.injectBatchingStrategy(
+    ReactDefaultBatchingStrategy
+  );
+
+  ReactInjection.RootIndex.injectCreateReactRootIndex(
+    ExecutionEnvironment.canUseDOM ?
+      ClientReactRootIndex.createReactRootIndex :
+      ServerReactRootIndex.createReactRootIndex
+  );
+
+  ReactInjection.Component.injectEnvironment(ReactComponentBrowserEnvironment);
+
+  if ("production" !== "development") {
+    var url = (ExecutionEnvironment.canUseDOM && window.location.href) || '';
+    if ((/[?&]react_perf\b/).test(url)) {
+      var ReactDefaultPerf = _dereq_("./ReactDefaultPerf");
+      ReactDefaultPerf.start();
+    }
+  }
+}
+
+module.exports = {
+  inject: inject
+};
+
+},{"./ChangeEventPlugin":4,"./ClientReactRootIndex":5,"./CompositionEventPlugin":6,"./DefaultDOMPropertyConfig":11,"./DefaultEventPluginOrder":12,"./EnterLeaveEventPlugin":13,"./ExecutionEnvironment":20,"./MobileSafariClickEventPlugin":22,"./ReactBrowserComponentMixin":25,"./ReactComponentBrowserEnvironment":28,"./ReactDOM":32,"./ReactDOMButton":33,"./ReactDOMForm":35,"./ReactDOMImg":37,"./ReactDOMInput":38,"./ReactDOMOption":39,"./ReactDOMSelect":40,"./ReactDOMTextarea":42,"./ReactDefaultBatchingStrategy":43,"./ReactDefaultPerf":45,"./ReactEventTopLevelCallback":50,"./ReactInjection":51,"./ReactInstanceHandles":53,"./ReactMount":55,"./SelectEventPlugin":72,"./ServerReactRootIndex":73,"./SimpleEventPlugin":74,"./createFullPageComponent":92}],45:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactDefaultPerf
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var DOMProperty = _dereq_("./DOMProperty");
+var ReactDefaultPerfAnalysis = _dereq_("./ReactDefaultPerfAnalysis");
+var ReactMount = _dereq_("./ReactMount");
+var ReactPerf = _dereq_("./ReactPerf");
+
+var performanceNow = _dereq_("./performanceNow");
+
+function roundFloat(val) {
+  return Math.floor(val * 100) / 100;
+}
+
+var ReactDefaultPerf = {
+  _allMeasurements: [], // last item in the list is the current one
+  _injected: false,
+
+  start: function() {
+    if (!ReactDefaultPerf._injected) {
+      ReactPerf.injection.injectMeasure(ReactDefaultPerf.measure);
+    }
+
+    ReactDefaultPerf._allMeasurements.length = 0;
+    ReactPerf.enableMeasure = true;
+  },
+
+  stop: function() {
+    ReactPerf.enableMeasure = false;
+  },
+
+  getLastMeasurements: function() {
+    return ReactDefaultPerf._allMeasurements;
+  },
+
+  printExclusive: function(measurements) {
+    measurements = measurements || ReactDefaultPerf._allMeasurements;
+    var summary = ReactDefaultPerfAnalysis.getExclusiveSummary(measurements);
+    console.table(summary.map(function(item) {
+      return {
+        'Component class name': item.componentName,
+        'Total inclusive time (ms)': roundFloat(item.inclusive),
+        'Total exclusive time (ms)': roundFloat(item.exclusive),
+        'Exclusive time per instance (ms)': roundFloat(item.exclusive / item.count),
+        'Instances': item.count
+      };
+    }));
+    console.log(
+      'Total time:',
+      ReactDefaultPerfAnalysis.getTotalTime(measurements).toFixed(2) + ' ms'
+    );
+  },
+
+  printInclusive: function(measurements) {
+    measurements = measurements || ReactDefaultPerf._allMeasurements;
+    var summary = ReactDefaultPerfAnalysis.getInclusiveSummary(measurements);
+    console.table(summary.map(function(item) {
+      return {
+        'Owner > component': item.componentName,
+        'Inclusive time (ms)': roundFloat(item.time),
+        'Instances': item.count
+      };
+    }));
+    console.log(
+      'Total time:',
+      ReactDefaultPerfAnalysis.getTotalTime(measurements).toFixed(2) + ' ms'
+    );
+  },
+
+  printWasted: function(measurements) {
+    measurements = measurements || ReactDefaultPerf._allMeasurements;
+    var summary = ReactDefaultPerfAnalysis.getInclusiveSummary(
+      measurements,
+      true
+    );
+    console.table(summary.map(function(item) {
+      return {
+        'Owner > component': item.componentName,
+        'Wasted time (ms)': item.time,
+        'Instances': item.count
+      };
+    }));
+    console.log(
+      'Total time:',
+      ReactDefaultPerfAnalysis.getTotalTime(measurements).toFixed(2) + ' ms'
+    );
+  },
+
+  printDOM: function(measurements) {
+    measurements = measurements || ReactDefaultPerf._allMeasurements;
+    var summary = ReactDefaultPerfAnalysis.getDOMSummary(measurements);
+    console.table(summary.map(function(item) {
+      var result = {};
+      result[DOMProperty.ID_ATTRIBUTE_NAME] = item.id;
+      result['type'] = item.type;
+      result['args'] = JSON.stringify(item.args);
+      return result;
+    }));
+    console.log(
+      'Total time:',
+      ReactDefaultPerfAnalysis.getTotalTime(measurements).toFixed(2) + ' ms'
+    );
+  },
+
+  _recordWrite: function(id, fnName, totalTime, args) {
+    // TODO: totalTime isn't that useful since it doesn't count paints/reflows
+    var writes =
+      ReactDefaultPerf
+        ._allMeasurements[ReactDefaultPerf._allMeasurements.length - 1]
+        .writes;
+    writes[id] = writes[id] || [];
+    writes[id].push({
+      type: fnName,
+      time: totalTime,
+      args: args
+    });
+  },
+
+  measure: function(moduleName, fnName, func) {
+    return function() {var args=Array.prototype.slice.call(arguments,0);
+      var totalTime;
+      var rv;
+      var start;
+
+      if (fnName === '_renderNewRootComponent' ||
+          fnName === 'flushBatchedUpdates') {
+        // A "measurement" is a set of metrics recorded for each flush. We want
+        // to group the metrics for a given flush together so we can look at the
+        // components that rendered and the DOM operations that actually
+        // happened to determine the amount of "wasted work" performed.
+        ReactDefaultPerf._allMeasurements.push({
+          exclusive: {},
+          inclusive: {},
+          counts: {},
+          writes: {},
+          displayNames: {},
+          totalTime: 0
+        });
+        start = performanceNow();
+        rv = func.apply(this, args);
+        ReactDefaultPerf._allMeasurements[
+          ReactDefaultPerf._allMeasurements.length - 1
+        ].totalTime = performanceNow() - start;
+        return rv;
+      } else if (moduleName === 'ReactDOMIDOperations' ||
+        moduleName === 'ReactComponentBrowserEnvironment') {
+        start = performanceNow();
+        rv = func.apply(this, args);
+        totalTime = performanceNow() - start;
+
+        if (fnName === 'mountImageIntoNode') {
+          var mountID = ReactMount.getID(args[1]);
+          ReactDefaultPerf._recordWrite(mountID, fnName, totalTime, args[0]);
+        } else if (fnName === 'dangerouslyProcessChildrenUpdates') {
+          // special format
+          args[0].forEach(function(update) {
+            var writeArgs = {};
+            if (update.fromIndex !== null) {
+              writeArgs.fromIndex = update.fromIndex;
+            }
+            if (update.toIndex !== null) {
+              writeArgs.toIndex = update.toIndex;
+            }
+            if (update.textContent !== null) {
+              writeArgs.textContent = update.textContent;
+            }
+            if (update.markupIndex !== null) {
+              writeArgs.markup = args[1][update.markupIndex];
+            }
+            ReactDefaultPerf._recordWrite(
+              update.parentID,
+              update.type,
+              totalTime,
+              writeArgs
+            );
+          });
+        } else {
+          // basic format
+          ReactDefaultPerf._recordWrite(
+            args[0],
+            fnName,
+            totalTime,
+            Array.prototype.slice.call(args, 1)
+          );
+        }
+        return rv;
+      } else if (moduleName === 'ReactCompositeComponent' && (
+        fnName === 'mountComponent' ||
+        fnName === 'updateComponent' || // TODO: receiveComponent()?
+        fnName === '_renderValidatedComponent')) {
+
+        var rootNodeID = fnName === 'mountComponent' ?
+          args[0] :
+          this._rootNodeID;
+        var isRender = fnName === '_renderValidatedComponent';
+        var entry = ReactDefaultPerf._allMeasurements[
+          ReactDefaultPerf._allMeasurements.length - 1
+        ];
+
+        if (isRender) {
+          entry.counts[rootNodeID] = entry.counts[rootNodeID] || 0;
+          entry.counts[rootNodeID] += 1;
+        }
+
+        start = performanceNow();
+        rv = func.apply(this, args);
+        totalTime = performanceNow() - start;
+
+        var typeOfLog = isRender ? entry.exclusive : entry.inclusive;
+        typeOfLog[rootNodeID] = typeOfLog[rootNodeID] || 0;
+        typeOfLog[rootNodeID] += totalTime;
+
+        entry.displayNames[rootNodeID] = {
+          current: this.constructor.displayName,
+          owner: this._owner ? this._owner.constructor.displayName : '<root>'
+        };
+
+        return rv;
+      } else {
+        return func.apply(this, args);
+      }
+    };
+  }
+};
+
+module.exports = ReactDefaultPerf;
+
+},{"./DOMProperty":8,"./ReactDefaultPerfAnalysis":46,"./ReactMount":55,"./ReactPerf":60,"./performanceNow":129}],46:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactDefaultPerfAnalysis
+ */
+
+var merge = _dereq_("./merge");
+
+// Don't try to save users less than 1.2ms (a number I made up)
+var DONT_CARE_THRESHOLD = 1.2;
+var DOM_OPERATION_TYPES = {
+  'mountImageIntoNode': 'set innerHTML',
+  INSERT_MARKUP: 'set innerHTML',
+  MOVE_EXISTING: 'move',
+  REMOVE_NODE: 'remove',
+  TEXT_CONTENT: 'set textContent',
+  'updatePropertyByID': 'update attribute',
+  'deletePropertyByID': 'delete attribute',
+  'updateStylesByID': 'update styles',
+  'updateInnerHTMLByID': 'set innerHTML',
+  'dangerouslyReplaceNodeWithMarkupByID': 'replace'
+};
+
+function getTotalTime(measurements) {
+  // TODO: return number of DOM ops? could be misleading.
+  // TODO: measure dropped frames after reconcile?
+  // TODO: log total time of each reconcile and the top-level component
+  // class that triggered it.
+  var totalTime = 0;
+  for (var i = 0; i < measurements.length; i++) {
+    var measurement = measurements[i];
+    totalTime += measurement.totalTime;
+  }
+  return totalTime;
+}
+
+function getDOMSummary(measurements) {
+  var items = [];
+  for (var i = 0; i < measurements.length; i++) {
+    var measurement = measurements[i];
+    var id;
+
+    for (id in measurement.writes) {
+      measurement.writes[id].forEach(function(write) {
+        items.push({
+          id: id,
+          type: DOM_OPERATION_TYPES[write.type] || write.type,
+          args: write.args
+        });
+      });
+    }
+  }
+  return items;
+}
+
+function getExclusiveSummary(measurements) {
+  var candidates = {};
+  var displayName;
+
+  for (var i = 0; i < measurements.length; i++) {
+    var measurement = measurements[i];
+    var allIDs = merge(measurement.exclusive, measurement.inclusive);
+
+    for (var id in allIDs) {
+      displayName = measurement.displayNames[id].current;
+
+      candidates[displayName] = candidates[displayName] || {
+        componentName: displayName,
+        inclusive: 0,
+        exclusive: 0,
+        count: 0
+      };
+      if (measurement.exclusive[id]) {
+        candidates[displayName].exclusive += measurement.exclusive[id];
+      }
+      if (measurement.inclusive[id]) {
+        candidates[displayName].inclusive += measurement.inclusive[id];
+      }
+      if (measurement.counts[id]) {
+        candidates[displayName].count += measurement.counts[id];
+      }
+    }
+  }
+
+  // Now make a sorted array with the results.
+  var arr = [];
+  for (displayName in candidates) {
+    if (candidates[displayName].exclusive >= DONT_CARE_THRESHOLD) {
+      arr.push(candidates[displayName]);
+    }
+  }
+
+  arr.sort(function(a, b) {
+    return b.exclusive - a.exclusive;
+  });
+
+  return arr;
+}
+
+function getInclusiveSummary(measurements, onlyClean) {
+  var candidates = {};
+  var inclusiveKey;
+
+  for (var i = 0; i < measurements.length; i++) {
+    var measurement = measurements[i];
+    var allIDs = merge(measurement.exclusive, measurement.inclusive);
+    var cleanComponents;
+
+    if (onlyClean) {
+      cleanComponents = getUnchangedComponents(measurement);
+    }
+
+    for (var id in allIDs) {
+      if (onlyClean && !cleanComponents[id]) {
+        continue;
+      }
+
+      var displayName = measurement.displayNames[id];
+
+      // Inclusive time is not useful for many components without knowing where
+      // they are instantiated. So we aggregate inclusive time with both the
+      // owner and current displayName as the key.
+      inclusiveKey = displayName.owner + ' > ' + displayName.current;
+
+      candidates[inclusiveKey] = candidates[inclusiveKey] || {
+        componentName: inclusiveKey,
+        time: 0,
+        count: 0
+      };
+
+      if (measurement.inclusive[id]) {
+        candidates[inclusiveKey].time += measurement.inclusive[id];
+      }
+      if (measurement.counts[id]) {
+        candidates[inclusiveKey].count += measurement.counts[id];
+      }
+    }
+  }
+
+  // Now make a sorted array with the results.
+  var arr = [];
+  for (inclusiveKey in candidates) {
+    if (candidates[inclusiveKey].time >= DONT_CARE_THRESHOLD) {
+      arr.push(candidates[inclusiveKey]);
+    }
+  }
+
+  arr.sort(function(a, b) {
+    return b.time - a.time;
+  });
+
+  return arr;
+}
+
+function getUnchangedComponents(measurement) {
+  // For a given reconcile, look at which components did not actually
+  // render anything to the DOM and return a mapping of their ID to
+  // the amount of time it took to render the entire subtree.
+  var cleanComponents = {};
+  var dirtyLeafIDs = Object.keys(measurement.writes);
+  var allIDs = merge(measurement.exclusive, measurement.inclusive);
+
+  for (var id in allIDs) {
+    var isDirty = false;
+    // For each component that rendered, see if a component that triggerd
+    // a DOM op is in its subtree.
+    for (var i = 0; i < dirtyLeafIDs.length; i++) {
+      if (dirtyLeafIDs[i].indexOf(id) === 0) {
+        isDirty = true;
+        break;
+      }
+    }
+    if (!isDirty && measurement.counts[id] > 0) {
+      cleanComponents[id] = true;
+    }
+  }
+  return cleanComponents;
+}
+
+var ReactDefaultPerfAnalysis = {
+  getExclusiveSummary: getExclusiveSummary,
+  getInclusiveSummary: getInclusiveSummary,
+  getDOMSummary: getDOMSummary,
+  getTotalTime: getTotalTime
+};
+
+module.exports = ReactDefaultPerfAnalysis;
+
+},{"./merge":121}],47:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactErrorUtils
+ * @typechecks
+ */
+
+"use strict";
+
+var ReactErrorUtils = {
+  /**
+   * Creates a guarded version of a function. This is supposed to make debugging
+   * of event handlers easier. To aid debugging with the browser's debugger,
+   * this currently simply returns the original function.
+   *
+   * @param {function} func Function to be executed
+   * @param {string} name The name of the guard
+   * @return {function}
+   */
+  guard: function(func, name) {
+    return func;
+  }
+};
+
+module.exports = ReactErrorUtils;
+
+},{}],48:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactEventEmitter
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var EventConstants = _dereq_("./EventConstants");
+var EventListener = _dereq_("./EventListener");
+var EventPluginHub = _dereq_("./EventPluginHub");
+var EventPluginRegistry = _dereq_("./EventPluginRegistry");
+var ExecutionEnvironment = _dereq_("./ExecutionEnvironment");
+var ReactEventEmitterMixin = _dereq_("./ReactEventEmitterMixin");
+var ViewportMetrics = _dereq_("./ViewportMetrics");
+
+var invariant = _dereq_("./invariant");
+var isEventSupported = _dereq_("./isEventSupported");
+var merge = _dereq_("./merge");
+
+/**
+ * Summary of `ReactEventEmitter` event handling:
+ *
+ *  - Top-level delegation is used to trap native browser events. We normalize
+ *    and de-duplicate events to account for browser quirks.
+ *
+ *  - Forward these native events (with the associated top-level type used to
+ *    trap it) to `EventPluginHub`, which in turn will ask plugins if they want
+ *    to extract any synthetic events.
+ *
+ *  - The `EventPluginHub` will then process each event by annotating them with
+ *    "dispatches", a sequence of listeners and IDs that care about that event.
+ *
+ *  - The `EventPluginHub` then dispatches the events.
+ *
+ * Overview of React and the event system:
+ *
+ *                   .
+ * +------------+    .
+ * |    DOM     |    .
+ * +------------+    .                         +-----------+
+ *       +           .               +--------+|SimpleEvent|
+ *       |           .               |         |Plugin     |
+ * +-----|------+    .               v         +-----------+
+ * |     |      |    .    +--------------+                    +------------+
+ * |     +-----------.--->|EventPluginHub|                    |    Event   |
+ * |            |    .    |              |     +-----------+  | Propagators|
+ * | ReactEvent |    .    |              |     |TapEvent   |  |------------|
+ * |  Emitter   |    .    |              |<---+|Plugin     |  |other plugin|
+ * |            |    .    |              |     +-----------+  |  utilities |
+ * |     +-----------.--->|              |                    +------------+
+ * |     |      |    .    +--------------+
+ * +-----|------+    .                ^        +-----------+
+ *       |           .                |        |Enter/Leave|
+ *       +           .                +-------+|Plugin     |
+ * +-------------+   .                         +-----------+
+ * | application |   .
+ * |-------------|   .
+ * |             |   .
+ * |             |   .
+ * +-------------+   .
+ *                   .
+ *    React Core     .  General Purpose Event Plugin System
+ */
+
+var alreadyListeningTo = {};
+var isMonitoringScrollValue = false;
+var reactTopListenersCounter = 0;
+
+// For events like 'submit' which don't consistently bubble (which we trap at a
+// lower node than `document`), binding at `document` would cause duplicate
+// events so we don't include them here
+var topEventMapping = {
+  topBlur: 'blur',
+  topChange: 'change',
+  topClick: 'click',
+  topCompositionEnd: 'compositionend',
+  topCompositionStart: 'compositionstart',
+  topCompositionUpdate: 'compositionupdate',
+  topContextMenu: 'contextmenu',
+  topCopy: 'copy',
+  topCut: 'cut',
+  topDoubleClick: 'dblclick',
+  topDrag: 'drag',
+  topDragEnd: 'dragend',
+  topDragEnter: 'dragenter',
+  topDragExit: 'dragexit',
+  topDragLeave: 'dragleave',
+  topDragOver: 'dragover',
+  topDragStart: 'dragstart',
+  topDrop: 'drop',
+  topFocus: 'focus',
+  topInput: 'input',
+  topKeyDown: 'keydown',
+  topKeyPress: 'keypress',
+  topKeyUp: 'keyup',
+  topMouseDown: 'mousedown',
+  topMouseMove: 'mousemove',
+  topMouseOut: 'mouseout',
+  topMouseOver: 'mouseover',
+  topMouseUp: 'mouseup',
+  topPaste: 'paste',
+  topScroll: 'scroll',
+  topSelectionChange: 'selectionchange',
+  topTouchCancel: 'touchcancel',
+  topTouchEnd: 'touchend',
+  topTouchMove: 'touchmove',
+  topTouchStart: 'touchstart',
+  topWheel: 'wheel'
+};
+
+/**
+ * To ensure no conflicts with other potential React instances on the page
+ */
+var topListenersIDKey = "_reactListenersID" + String(Math.random()).slice(2);
+
+function getListeningForDocument(mountAt) {
+  if (mountAt[topListenersIDKey] == null) {
+    mountAt[topListenersIDKey] = reactTopListenersCounter++;
+    alreadyListeningTo[mountAt[topListenersIDKey]] = {};
+  }
+  return alreadyListeningTo[mountAt[topListenersIDKey]];
+}
+
+/**
+ * Traps top-level events by using event bubbling.
+ *
+ * @param {string} topLevelType Record from `EventConstants`.
+ * @param {string} handlerBaseName Event name (e.g. "click").
+ * @param {DOMEventTarget} element Element on which to attach listener.
+ * @internal
+ */
+function trapBubbledEvent(topLevelType, handlerBaseName, element) {
+  EventListener.listen(
+    element,
+    handlerBaseName,
+    ReactEventEmitter.TopLevelCallbackCreator.createTopLevelCallback(
+      topLevelType
+    )
+  );
+}
+
+/**
+ * Traps a top-level event by using event capturing.
+ *
+ * @param {string} topLevelType Record from `EventConstants`.
+ * @param {string} handlerBaseName Event name (e.g. "click").
+ * @param {DOMEventTarget} element Element on which to attach listener.
+ * @internal
+ */
+function trapCapturedEvent(topLevelType, handlerBaseName, element) {
+  EventListener.capture(
+    element,
+    handlerBaseName,
+    ReactEventEmitter.TopLevelCallbackCreator.createTopLevelCallback(
+      topLevelType
+    )
+  );
+}
+
+/**
+ * `ReactEventEmitter` is used to attach top-level event listeners. For example:
+ *
+ *   ReactEventEmitter.putListener('myID', 'onClick', myFunction);
+ *
+ * This would allocate a "registration" of `('onClick', myFunction)` on 'myID'.
+ *
+ * @internal
+ */
+var ReactEventEmitter = merge(ReactEventEmitterMixin, {
+
+  /**
+   * React references `ReactEventTopLevelCallback` using this property in order
+   * to allow dependency injection.
+   */
+  TopLevelCallbackCreator: null,
+
+  injection: {
+    /**
+     * @param {function} TopLevelCallbackCreator
+     */
+    injectTopLevelCallbackCreator: function(TopLevelCallbackCreator) {
+      ReactEventEmitter.TopLevelCallbackCreator = TopLevelCallbackCreator;
+    }
+  },
+
+  /**
+   * Sets whether or not any created callbacks should be enabled.
+   *
+   * @param {boolean} enabled True if callbacks should be enabled.
+   */
+  setEnabled: function(enabled) {
+    ("production" !== "development" ? invariant(
+      ExecutionEnvironment.canUseDOM,
+      'setEnabled(...): Cannot toggle event listening in a Worker thread. ' +
+      'This is likely a bug in the framework. Please report immediately.'
+    ) : invariant(ExecutionEnvironment.canUseDOM));
+    if (ReactEventEmitter.TopLevelCallbackCreator) {
+      ReactEventEmitter.TopLevelCallbackCreator.setEnabled(enabled);
+    }
+  },
+
+  /**
+   * @return {boolean} True if callbacks are enabled.
+   */
+  isEnabled: function() {
+    return !!(
+      ReactEventEmitter.TopLevelCallbackCreator &&
+      ReactEventEmitter.TopLevelCallbackCreator.isEnabled()
+    );
+  },
+
+  /**
+   * We listen for bubbled touch events on the document object.
+   *
+   * Firefox v8.01 (and possibly others) exhibited strange behavior when
+   * mounting `onmousemove` events at some node that was not the document
+   * element. The symptoms were that if your mouse is not moving over something
+   * contained within that mount point (for example on the background) the
+   * top-level listeners for `onmousemove` won't be called. However, if you
+   * register the `mousemove` on the document object, then it will of course
+   * catch all `mousemove`s. This along with iOS quirks, justifies restricting
+   * top-level listeners to the document object only, at least for these
+   * movement types of events and possibly all events.
+   *
+   * @see http://www.quirksmode.org/blog/archives/2010/09/click_event_del.html
+   *
+   * Also, `keyup`/`keypress`/`keydown` do not bubble to the window on IE, but
+   * they bubble to document.
+   *
+   * @param {string} registrationName Name of listener (e.g. `onClick`).
+   * @param {DOMDocument} contentDocument Document which owns the container
+   */
+  listenTo: function(registrationName, contentDocument) {
+    var mountAt = contentDocument;
+    var isListening = getListeningForDocument(mountAt);
+    var dependencies = EventPluginRegistry.
+      registrationNameDependencies[registrationName];
+
+    var topLevelTypes = EventConstants.topLevelTypes;
+    for (var i = 0, l = dependencies.length; i < l; i++) {
+      var dependency = dependencies[i];
+      if (!isListening[dependency]) {
+        var topLevelType = topLevelTypes[dependency];
+
+        if (topLevelType === topLevelTypes.topWheel) {
+          if (isEventSupported('wheel')) {
+            trapBubbledEvent(topLevelTypes.topWheel, 'wheel', mountAt);
+          } else if (isEventSupported('mousewheel')) {
+            trapBubbledEvent(topLevelTypes.topWheel, 'mousewheel', mountAt);
+          } else {
+            // Firefox needs to capture a different mouse scroll event.
+            // @see http://www.quirksmode.org/dom/events/tests/scroll.html
+            trapBubbledEvent(
+              topLevelTypes.topWheel,
+              'DOMMouseScroll',
+              mountAt);
+          }
+        } else if (topLevelType === topLevelTypes.topScroll) {
+
+          if (isEventSupported('scroll', true)) {
+            trapCapturedEvent(topLevelTypes.topScroll, 'scroll', mountAt);
+          } else {
+            trapBubbledEvent(topLevelTypes.topScroll, 'scroll', window);
+          }
+        } else if (topLevelType === topLevelTypes.topFocus ||
+            topLevelType === topLevelTypes.topBlur) {
+
+          if (isEventSupported('focus', true)) {
+            trapCapturedEvent(topLevelTypes.topFocus, 'focus', mountAt);
+            trapCapturedEvent(topLevelTypes.topBlur, 'blur', mountAt);
+          } else if (isEventSupported('focusin')) {
+            // IE has `focusin` and `focusout` events which bubble.
+            // @see http://www.quirksmode.org/blog/archives/2008/04/delegating_the.html
+            trapBubbledEvent(topLevelTypes.topFocus, 'focusin', mountAt);
+            trapBubbledEvent(topLevelTypes.topBlur, 'focusout', mountAt);
+          }
+
+          // to make sure blur and focus event listeners are only attached once
+          isListening[topLevelTypes.topBlur] = true;
+          isListening[topLevelTypes.topFocus] = true;
+        } else if (topEventMapping[dependency]) {
+          trapBubbledEvent(topLevelType, topEventMapping[dependency], mountAt);
+        }
+
+        isListening[dependency] = true;
+      }
+    }
+  },
+
+  /**
+   * Listens to window scroll and resize events. We cache scroll values so that
+   * application code can access them without triggering reflows.
+   *
+   * NOTE: Scroll events do not bubble.
+   *
+   * @see http://www.quirksmode.org/dom/events/scroll.html
+   */
+  ensureScrollValueMonitoring: function(){
+    if (!isMonitoringScrollValue) {
+      var refresh = ViewportMetrics.refreshScrollValues;
+      EventListener.listen(window, 'scroll', refresh);
+      EventListener.listen(window, 'resize', refresh);
+      isMonitoringScrollValue = true;
+    }
+  },
+
+  eventNameDispatchConfigs: EventPluginHub.eventNameDispatchConfigs,
+
+  registrationNameModules: EventPluginHub.registrationNameModules,
+
+  putListener: EventPluginHub.putListener,
+
+  getListener: EventPluginHub.getListener,
+
+  deleteListener: EventPluginHub.deleteListener,
+
+  deleteAllListeners: EventPluginHub.deleteAllListeners,
+
+  trapBubbledEvent: trapBubbledEvent,
+
+  trapCapturedEvent: trapCapturedEvent
+
+});
+
+module.exports = ReactEventEmitter;
+
+},{"./EventConstants":14,"./EventListener":15,"./EventPluginHub":16,"./EventPluginRegistry":17,"./ExecutionEnvironment":20,"./ReactEventEmitterMixin":49,"./ViewportMetrics":86,"./invariant":112,"./isEventSupported":113,"./merge":121}],49:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactEventEmitterMixin
+ */
+
+"use strict";
+
+var EventPluginHub = _dereq_("./EventPluginHub");
+var ReactUpdates = _dereq_("./ReactUpdates");
+
+function runEventQueueInBatch(events) {
+  EventPluginHub.enqueueEvents(events);
+  EventPluginHub.processEventQueue();
+}
+
+var ReactEventEmitterMixin = {
+
+  /**
+   * Streams a fired top-level event to `EventPluginHub` where plugins have the
+   * opportunity to create `ReactEvent`s to be dispatched.
+   *
+   * @param {string} topLevelType Record from `EventConstants`.
+   * @param {object} topLevelTarget The listening component root node.
+   * @param {string} topLevelTargetID ID of `topLevelTarget`.
+   * @param {object} nativeEvent Native environment event.
+   */
+  handleTopLevel: function(
+      topLevelType,
+      topLevelTarget,
+      topLevelTargetID,
+      nativeEvent) {
+    var events = EventPluginHub.extractEvents(
+      topLevelType,
+      topLevelTarget,
+      topLevelTargetID,
+      nativeEvent
+    );
+
+    // Event queue being processed in the same cycle allows `preventDefault`.
+    ReactUpdates.batchedUpdates(runEventQueueInBatch, events);
+  }
+};
+
+module.exports = ReactEventEmitterMixin;
+
+},{"./EventPluginHub":16,"./ReactUpdates":71}],50:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactEventTopLevelCallback
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var PooledClass = _dereq_("./PooledClass");
+var ReactEventEmitter = _dereq_("./ReactEventEmitter");
+var ReactInstanceHandles = _dereq_("./ReactInstanceHandles");
+var ReactMount = _dereq_("./ReactMount");
+
+var getEventTarget = _dereq_("./getEventTarget");
+var mixInto = _dereq_("./mixInto");
+
+/**
+ * @type {boolean}
+ * @private
+ */
+var _topLevelListenersEnabled = true;
+
+/**
+ * Finds the parent React component of `node`.
+ *
+ * @param {*} node
+ * @return {?DOMEventTarget} Parent container, or `null` if the specified node
+ *                           is not nested.
+ */
+function findParent(node) {
+  // TODO: It may be a good idea to cache this to prevent unnecessary DOM
+  // traversal, but caching is difficult to do correctly without using a
+  // mutation observer to listen for all DOM changes.
+  var nodeID = ReactMount.getID(node);
+  var rootID = ReactInstanceHandles.getReactRootIDFromNodeID(nodeID);
+  var container = ReactMount.findReactContainerForID(rootID);
+  var parent = ReactMount.getFirstReactDOM(container);
+  return parent;
+}
+
+/**
+ * Calls ReactEventEmitter.handleTopLevel for each node stored in bookKeeping's
+ * ancestor list. Separated from createTopLevelCallback to avoid try/finally
+ * deoptimization.
+ *
+ * @param {string} topLevelType
+ * @param {DOMEvent} nativeEvent
+ * @param {TopLevelCallbackBookKeeping} bookKeeping
+ */
+function handleTopLevelImpl(topLevelType, nativeEvent, bookKeeping) {
+  var topLevelTarget = ReactMount.getFirstReactDOM(
+    getEventTarget(nativeEvent)
+  ) || window;
+
+  // Loop through the hierarchy, in case there's any nested components.
+  // It's important that we build the array of ancestors before calling any
+  // event handlers, because event handlers can modify the DOM, leading to
+  // inconsistencies with ReactMount's node cache. See #1105.
+  var ancestor = topLevelTarget;
+  while (ancestor) {
+    bookKeeping.ancestors.push(ancestor);
+    ancestor = findParent(ancestor);
+  }
+
+  for (var i = 0, l = bookKeeping.ancestors.length; i < l; i++) {
+    topLevelTarget = bookKeeping.ancestors[i];
+    var topLevelTargetID = ReactMount.getID(topLevelTarget) || '';
+    ReactEventEmitter.handleTopLevel(
+      topLevelType,
+      topLevelTarget,
+      topLevelTargetID,
+      nativeEvent
+    );
+  }
+}
+
+// Used to store ancestor hierarchy in top level callback
+function TopLevelCallbackBookKeeping() {
+  this.ancestors = [];
+}
+mixInto(TopLevelCallbackBookKeeping, {
+  destructor: function() {
+    this.ancestors.length = 0;
+  }
+});
+PooledClass.addPoolingTo(TopLevelCallbackBookKeeping);
+
+/**
+ * Top-level callback creator used to implement event handling using delegation.
+ * This is used via dependency injection.
+ */
+var ReactEventTopLevelCallback = {
+
+  /**
+   * Sets whether or not any created callbacks should be enabled.
+   *
+   * @param {boolean} enabled True if callbacks should be enabled.
+   */
+  setEnabled: function(enabled) {
+    _topLevelListenersEnabled = !!enabled;
+  },
+
+  /**
+   * @return {boolean} True if callbacks are enabled.
+   */
+  isEnabled: function() {
+    return _topLevelListenersEnabled;
+  },
+
+  /**
+   * Creates a callback for the supplied `topLevelType` that could be added as
+   * a listener to the document. The callback computes a `topLevelTarget` which
+   * should be the root node of a mounted React component where the listener
+   * is attached.
+   *
+   * @param {string} topLevelType Record from `EventConstants`.
+   * @return {function} Callback for handling top-level events.
+   */
+  createTopLevelCallback: function(topLevelType) {
+    return function(nativeEvent) {
+      if (!_topLevelListenersEnabled) {
+        return;
+      }
+
+      var bookKeeping = TopLevelCallbackBookKeeping.getPooled();
+      try {
+        handleTopLevelImpl(topLevelType, nativeEvent, bookKeeping);
+      } finally {
+        TopLevelCallbackBookKeeping.release(bookKeeping);
+      }
+    };
+  }
+
+};
+
+module.exports = ReactEventTopLevelCallback;
+
+},{"./PooledClass":23,"./ReactEventEmitter":48,"./ReactInstanceHandles":53,"./ReactMount":55,"./getEventTarget":104,"./mixInto":124}],51:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactInjection
+ */
+
+"use strict";
+
+var DOMProperty = _dereq_("./DOMProperty");
+var EventPluginHub = _dereq_("./EventPluginHub");
+var ReactComponent = _dereq_("./ReactComponent");
+var ReactCompositeComponent = _dereq_("./ReactCompositeComponent");
+var ReactDOM = _dereq_("./ReactDOM");
+var ReactEventEmitter = _dereq_("./ReactEventEmitter");
+var ReactPerf = _dereq_("./ReactPerf");
+var ReactRootIndex = _dereq_("./ReactRootIndex");
+var ReactUpdates = _dereq_("./ReactUpdates");
+
+var ReactInjection = {
+  Component: ReactComponent.injection,
+  CompositeComponent: ReactCompositeComponent.injection,
+  DOMProperty: DOMProperty.injection,
+  EventPluginHub: EventPluginHub.injection,
+  DOM: ReactDOM.injection,
+  EventEmitter: ReactEventEmitter.injection,
+  Perf: ReactPerf.injection,
+  RootIndex: ReactRootIndex.injection,
+  Updates: ReactUpdates.injection
+};
+
+module.exports = ReactInjection;
+
+},{"./DOMProperty":8,"./EventPluginHub":16,"./ReactComponent":27,"./ReactCompositeComponent":29,"./ReactDOM":32,"./ReactEventEmitter":48,"./ReactPerf":60,"./ReactRootIndex":67,"./ReactUpdates":71}],52:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactInputSelection
+ */
+
+"use strict";
+
+var ReactDOMSelection = _dereq_("./ReactDOMSelection");
+
+var containsNode = _dereq_("./containsNode");
+var focusNode = _dereq_("./focusNode");
+var getActiveElement = _dereq_("./getActiveElement");
+
+function isInDocument(node) {
+  return containsNode(document.documentElement, node);
+}
+
+/**
+ * @ReactInputSelection: React input selection module. Based on Selection.js,
+ * but modified to be suitable for react and has a couple of bug fixes (doesn't
+ * assume buttons have range selections allowed).
+ * Input selection module for React.
+ */
+var ReactInputSelection = {
+
+  hasSelectionCapabilities: function(elem) {
+    return elem && (
+      (elem.nodeName === 'INPUT' && elem.type === 'text') ||
+      elem.nodeName === 'TEXTAREA' ||
+      elem.contentEditable === 'true'
+    );
+  },
+
+  getSelectionInformation: function() {
+    var focusedElem = getActiveElement();
+    return {
+      focusedElem: focusedElem,
+      selectionRange:
+          ReactInputSelection.hasSelectionCapabilities(focusedElem) ?
+          ReactInputSelection.getSelection(focusedElem) :
+          null
+    };
+  },
+
+  /**
+   * @restoreSelection: If any selection information was potentially lost,
+   * restore it. This is useful when performing operations that could remove dom
+   * nodes and place them back in, resulting in focus being lost.
+   */
+  restoreSelection: function(priorSelectionInformation) {
+    var curFocusedElem = getActiveElement();
+    var priorFocusedElem = priorSelectionInformation.focusedElem;
+    var priorSelectionRange = priorSelectionInformation.selectionRange;
+    if (curFocusedElem !== priorFocusedElem &&
+        isInDocument(priorFocusedElem)) {
+      if (ReactInputSelection.hasSelectionCapabilities(priorFocusedElem)) {
+        ReactInputSelection.setSelection(
+          priorFocusedElem,
+          priorSelectionRange
+        );
+      }
+      focusNode(priorFocusedElem);
+    }
+  },
+
+  /**
+   * @getSelection: Gets the selection bounds of a focused textarea, input or
+   * contentEditable node.
+   * -@input: Look up selection bounds of this input
+   * -@return {start: selectionStart, end: selectionEnd}
+   */
+  getSelection: function(input) {
+    var selection;
+
+    if ('selectionStart' in input) {
+      // Modern browser with input or textarea.
+      selection = {
+        start: input.selectionStart,
+        end: input.selectionEnd
+      };
+    } else if (document.selection && input.nodeName === 'INPUT') {
+      // IE8 input.
+      var range = document.selection.createRange();
+      // There can only be one selection per document in IE, so it must
+      // be in our element.
+      if (range.parentElement() === input) {
+        selection = {
+          start: -range.moveStart('character', -input.value.length),
+          end: -range.moveEnd('character', -input.value.length)
+        };
+      }
+    } else {
+      // Content editable or old IE textarea.
+      selection = ReactDOMSelection.getOffsets(input);
+    }
+
+    return selection || {start: 0, end: 0};
+  },
+
+  /**
+   * @setSelection: Sets the selection bounds of a textarea or input and focuses
+   * the input.
+   * -@input     Set selection bounds of this input or textarea
+   * -@offsets   Object of same form that is returned from get*
+   */
+  setSelection: function(input, offsets) {
+    var start = offsets.start;
+    var end = offsets.end;
+    if (typeof end === 'undefined') {
+      end = start;
+    }
+
+    if ('selectionStart' in input) {
+      input.selectionStart = start;
+      input.selectionEnd = Math.min(end, input.value.length);
+    } else if (document.selection && input.nodeName === 'INPUT') {
+      var range = input.createTextRange();
+      range.collapse(true);
+      range.moveStart('character', start);
+      range.moveEnd('character', end - start);
+      range.select();
+    } else {
+      ReactDOMSelection.setOffsets(input, offsets);
+    }
+  }
+};
+
+module.exports = ReactInputSelection;
+
+},{"./ReactDOMSelection":41,"./containsNode":89,"./focusNode":100,"./getActiveElement":102}],53:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactInstanceHandles
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var ReactRootIndex = _dereq_("./ReactRootIndex");
+
+var invariant = _dereq_("./invariant");
+
+var SEPARATOR = '.';
+var SEPARATOR_LENGTH = SEPARATOR.length;
+
+/**
+ * Maximum depth of traversals before we consider the possibility of a bad ID.
+ */
+var MAX_TREE_DEPTH = 100;
+
+/**
+ * Creates a DOM ID prefix to use when mounting React components.
+ *
+ * @param {number} index A unique integer
+ * @return {string} React root ID.
+ * @internal
+ */
+function getReactRootIDString(index) {
+  return SEPARATOR + index.toString(36);
+}
+
+/**
+ * Checks if a character in the supplied ID is a separator or the end.
+ *
+ * @param {string} id A React DOM ID.
+ * @param {number} index Index of the character to check.
+ * @return {boolean} True if the character is a separator or end of the ID.
+ * @private
+ */
+function isBoundary(id, index) {
+  return id.charAt(index) === SEPARATOR || index === id.length;
+}
+
+/**
+ * Checks if the supplied string is a valid React DOM ID.
+ *
+ * @param {string} id A React DOM ID, maybe.
+ * @return {boolean} True if the string is a valid React DOM ID.
+ * @private
+ */
+function isValidID(id) {
+  return id === '' || (
+    id.charAt(0) === SEPARATOR && id.charAt(id.length - 1) !== SEPARATOR
+  );
+}
+
+/**
+ * Checks if the first ID is an ancestor of or equal to the second ID.
+ *
+ * @param {string} ancestorID
+ * @param {string} descendantID
+ * @return {boolean} True if `ancestorID` is an ancestor of `descendantID`.
+ * @internal
+ */
+function isAncestorIDOf(ancestorID, descendantID) {
+  return (
+    descendantID.indexOf(ancestorID) === 0 &&
+    isBoundary(descendantID, ancestorID.length)
+  );
+}
+
+/**
+ * Gets the parent ID of the supplied React DOM ID, `id`.
+ *
+ * @param {string} id ID of a component.
+ * @return {string} ID of the parent, or an empty string.
+ * @private
+ */
+function getParentID(id) {
+  return id ? id.substr(0, id.lastIndexOf(SEPARATOR)) : '';
+}
+
+/**
+ * Gets the next DOM ID on the tree path from the supplied `ancestorID` to the
+ * supplied `destinationID`. If they are equal, the ID is returned.
+ *
+ * @param {string} ancestorID ID of an ancestor node of `destinationID`.
+ * @param {string} destinationID ID of the destination node.
+ * @return {string} Next ID on the path from `ancestorID` to `destinationID`.
+ * @private
+ */
+function getNextDescendantID(ancestorID, destinationID) {
+  ("production" !== "development" ? invariant(
+    isValidID(ancestorID) && isValidID(destinationID),
+    'getNextDescendantID(%s, %s): Received an invalid React DOM ID.',
+    ancestorID,
+    destinationID
+  ) : invariant(isValidID(ancestorID) && isValidID(destinationID)));
+  ("production" !== "development" ? invariant(
+    isAncestorIDOf(ancestorID, destinationID),
+    'getNextDescendantID(...): React has made an invalid assumption about ' +
+    'the DOM hierarchy. Expected `%s` to be an ancestor of `%s`.',
+    ancestorID,
+    destinationID
+  ) : invariant(isAncestorIDOf(ancestorID, destinationID)));
+  if (ancestorID === destinationID) {
+    return ancestorID;
+  }
+  // Skip over the ancestor and the immediate separator. Traverse until we hit
+  // another separator or we reach the end of `destinationID`.
+  var start = ancestorID.length + SEPARATOR_LENGTH;
+  for (var i = start; i < destinationID.length; i++) {
+    if (isBoundary(destinationID, i)) {
+      break;
+    }
+  }
+  return destinationID.substr(0, i);
+}
+
+/**
+ * Gets the nearest common ancestor ID of two IDs.
+ *
+ * Using this ID scheme, the nearest common ancestor ID is the longest common
+ * prefix of the two IDs that immediately preceded a "marker" in both strings.
+ *
+ * @param {string} oneID
+ * @param {string} twoID
+ * @return {string} Nearest common ancestor ID, or the empty string if none.
+ * @private
+ */
+function getFirstCommonAncestorID(oneID, twoID) {
+  var minLength = Math.min(oneID.length, twoID.length);
+  if (minLength === 0) {
+    return '';
+  }
+  var lastCommonMarkerIndex = 0;
+  // Use `<=` to traverse until the "EOL" of the shorter string.
+  for (var i = 0; i <= minLength; i++) {
+    if (isBoundary(oneID, i) && isBoundary(twoID, i)) {
+      lastCommonMarkerIndex = i;
+    } else if (oneID.charAt(i) !== twoID.charAt(i)) {
+      break;
+    }
+  }
+  var longestCommonID = oneID.substr(0, lastCommonMarkerIndex);
+  ("production" !== "development" ? invariant(
+    isValidID(longestCommonID),
+    'getFirstCommonAncestorID(%s, %s): Expected a valid React DOM ID: %s',
+    oneID,
+    twoID,
+    longestCommonID
+  ) : invariant(isValidID(longestCommonID)));
+  return longestCommonID;
+}
+
+/**
+ * Traverses the parent path between two IDs (either up or down). The IDs must
+ * not be the same, and there must exist a parent path between them. If the
+ * callback returns `false`, traversal is stopped.
+ *
+ * @param {?string} start ID at which to start traversal.
+ * @param {?string} stop ID at which to end traversal.
+ * @param {function} cb Callback to invoke each ID with.
+ * @param {?boolean} skipFirst Whether or not to skip the first node.
+ * @param {?boolean} skipLast Whether or not to skip the last node.
+ * @private
+ */
+function traverseParentPath(start, stop, cb, arg, skipFirst, skipLast) {
+  start = start || '';
+  stop = stop || '';
+  ("production" !== "development" ? invariant(
+    start !== stop,
+    'traverseParentPath(...): Cannot traverse from and to the same ID, `%s`.',
+    start
+  ) : invariant(start !== stop));
+  var traverseUp = isAncestorIDOf(stop, start);
+  ("production" !== "development" ? invariant(
+    traverseUp || isAncestorIDOf(start, stop),
+    'traverseParentPath(%s, %s, ...): Cannot traverse from two IDs that do ' +
+    'not have a parent path.',
+    start,
+    stop
+  ) : invariant(traverseUp || isAncestorIDOf(start, stop)));
+  // Traverse from `start` to `stop` one depth at a time.
+  var depth = 0;
+  var traverse = traverseUp ? getParentID : getNextDescendantID;
+  for (var id = start; /* until break */; id = traverse(id, stop)) {
+    var ret;
+    if ((!skipFirst || id !== start) && (!skipLast || id !== stop)) {
+      ret = cb(id, traverseUp, arg);
+    }
+    if (ret === false || id === stop) {
+      // Only break //after// visiting `stop`.
+      break;
+    }
+    ("production" !== "development" ? invariant(
+      depth++ < MAX_TREE_DEPTH,
+      'traverseParentPath(%s, %s, ...): Detected an infinite loop while ' +
+      'traversing the React DOM ID tree. This may be due to malformed IDs: %s',
+      start, stop
+    ) : invariant(depth++ < MAX_TREE_DEPTH));
+  }
+}
+
+/**
+ * Manages the IDs assigned to DOM representations of React components. This
+ * uses a specific scheme in order to traverse the DOM efficiently (e.g. in
+ * order to simulate events).
+ *
+ * @internal
+ */
+var ReactInstanceHandles = {
+
+  /**
+   * Constructs a React root ID
+   * @return {string} A React root ID.
+   */
+  createReactRootID: function() {
+    return getReactRootIDString(ReactRootIndex.createReactRootIndex());
+  },
+
+  /**
+   * Constructs a React ID by joining a root ID with a name.
+   *
+   * @param {string} rootID Root ID of a parent component.
+   * @param {string} name A component's name (as flattened children).
+   * @return {string} A React ID.
+   * @internal
+   */
+  createReactID: function(rootID, name) {
+    return rootID + name;
+  },
+
+  /**
+   * Gets the DOM ID of the React component that is the root of the tree that
+   * contains the React component with the supplied DOM ID.
+   *
+   * @param {string} id DOM ID of a React component.
+   * @return {?string} DOM ID of the React component that is the root.
+   * @internal
+   */
+  getReactRootIDFromNodeID: function(id) {
+    if (id && id.charAt(0) === SEPARATOR && id.length > 1) {
+      var index = id.indexOf(SEPARATOR, 1);
+      return index > -1 ? id.substr(0, index) : id;
+    }
+    return null;
+  },
+
+  /**
+   * Traverses the ID hierarchy and invokes the supplied `cb` on any IDs that
+   * should would receive a `mouseEnter` or `mouseLeave` event.
+   *
+   * NOTE: Does not invoke the callback on the nearest common ancestor because
+   * nothing "entered" or "left" that element.
+   *
+   * @param {string} leaveID ID being left.
+   * @param {string} enterID ID being entered.
+   * @param {function} cb Callback to invoke on each entered/left ID.
+   * @param {*} upArg Argument to invoke the callback with on left IDs.
+   * @param {*} downArg Argument to invoke the callback with on entered IDs.
+   * @internal
+   */
+  traverseEnterLeave: function(leaveID, enterID, cb, upArg, downArg) {
+    var ancestorID = getFirstCommonAncestorID(leaveID, enterID);
+    if (ancestorID !== leaveID) {
+      traverseParentPath(leaveID, ancestorID, cb, upArg, false, true);
+    }
+    if (ancestorID !== enterID) {
+      traverseParentPath(ancestorID, enterID, cb, downArg, true, false);
+    }
+  },
+
+  /**
+   * Simulates the traversal of a two-phase, capture/bubble event dispatch.
+   *
+   * NOTE: This traversal happens on IDs without touching the DOM.
+   *
+   * @param {string} targetID ID of the target node.
+   * @param {function} cb Callback to invoke.
+   * @param {*} arg Argument to invoke the callback with.
+   * @internal
+   */
+  traverseTwoPhase: function(targetID, cb, arg) {
+    if (targetID) {
+      traverseParentPath('', targetID, cb, arg, true, false);
+      traverseParentPath(targetID, '', cb, arg, false, true);
+    }
+  },
+
+  /**
+   * Traverse a node ID, calling the supplied `cb` for each ancestor ID. For
+   * example, passing `.0.$row-0.1` would result in `cb` getting called
+   * with `.0`, `.0.$row-0`, and `.0.$row-0.1`.
+   *
+   * NOTE: This traversal happens on IDs without touching the DOM.
+   *
+   * @param {string} targetID ID of the target node.
+   * @param {function} cb Callback to invoke.
+   * @param {*} arg Argument to invoke the callback with.
+   * @internal
+   */
+  traverseAncestors: function(targetID, cb, arg) {
+    traverseParentPath('', targetID, cb, arg, true, false);
+  },
+
+  /**
+   * Exposed for unit testing.
+   * @private
+   */
+  _getFirstCommonAncestorID: getFirstCommonAncestorID,
+
+  /**
+   * Exposed for unit testing.
+   * @private
+   */
+  _getNextDescendantID: getNextDescendantID,
+
+  isAncestorIDOf: isAncestorIDOf,
+
+  SEPARATOR: SEPARATOR
+
+};
+
+module.exports = ReactInstanceHandles;
+
+},{"./ReactRootIndex":67,"./invariant":112}],54:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactMarkupChecksum
+ */
+
+"use strict";
+
+var adler32 = _dereq_("./adler32");
+
+var ReactMarkupChecksum = {
+  CHECKSUM_ATTR_NAME: 'data-react-checksum',
+
+  /**
+   * @param {string} markup Markup string
+   * @return {string} Markup string with checksum attribute attached
+   */
+  addChecksumToMarkup: function(markup) {
+    var checksum = adler32(markup);
+    return markup.replace(
+      '>',
+      ' ' + ReactMarkupChecksum.CHECKSUM_ATTR_NAME + '="' + checksum + '">'
+    );
+  },
+
+  /**
+   * @param {string} markup to use
+   * @param {DOMElement} element root React element
+   * @returns {boolean} whether or not the markup is the same
+   */
+  canReuseMarkup: function(markup, element) {
+    var existingChecksum = element.getAttribute(
+      ReactMarkupChecksum.CHECKSUM_ATTR_NAME
+    );
+    existingChecksum = existingChecksum && parseInt(existingChecksum, 10);
+    var markupChecksum = adler32(markup);
+    return markupChecksum === existingChecksum;
+  }
+};
+
+module.exports = ReactMarkupChecksum;
+
+},{"./adler32":88}],55:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactMount
+ */
+
+"use strict";
+
+var DOMProperty = _dereq_("./DOMProperty");
+var ReactEventEmitter = _dereq_("./ReactEventEmitter");
+var ReactInstanceHandles = _dereq_("./ReactInstanceHandles");
+var ReactPerf = _dereq_("./ReactPerf");
+
+var containsNode = _dereq_("./containsNode");
+var getReactRootElementInContainer = _dereq_("./getReactRootElementInContainer");
+var instantiateReactComponent = _dereq_("./instantiateReactComponent");
+var invariant = _dereq_("./invariant");
+var shouldUpdateReactComponent = _dereq_("./shouldUpdateReactComponent");
+
+var SEPARATOR = ReactInstanceHandles.SEPARATOR;
+
+var ATTR_NAME = DOMProperty.ID_ATTRIBUTE_NAME;
+var nodeCache = {};
+
+var ELEMENT_NODE_TYPE = 1;
+var DOC_NODE_TYPE = 9;
+
+/** Mapping from reactRootID to React component instance. */
+var instancesByReactRootID = {};
+
+/** Mapping from reactRootID to `container` nodes. */
+var containersByReactRootID = {};
+
+if ("production" !== "development") {
+  /** __DEV__-only mapping from reactRootID to root elements. */
+  var rootElementsByReactRootID = {};
+}
+
+// Used to store breadth-first search state in findComponentRoot.
+var findComponentRootReusableArray = [];
+
+/**
+ * @param {DOMElement} container DOM element that may contain a React component.
+ * @return {?string} A "reactRoot" ID, if a React component is rendered.
+ */
+function getReactRootID(container) {
+  var rootElement = getReactRootElementInContainer(container);
+  return rootElement && ReactMount.getID(rootElement);
+}
+
+/**
+ * Accessing node[ATTR_NAME] or calling getAttribute(ATTR_NAME) on a form
+ * element can return its control whose name or ID equals ATTR_NAME. All
+ * DOM nodes support `getAttributeNode` but this can also get called on
+ * other objects so just return '' if we're given something other than a
+ * DOM node (such as window).
+ *
+ * @param {?DOMElement|DOMWindow|DOMDocument|DOMTextNode} node DOM node.
+ * @return {string} ID of the supplied `domNode`.
+ */
+function getID(node) {
+  var id = internalGetID(node);
+  if (id) {
+    if (nodeCache.hasOwnProperty(id)) {
+      var cached = nodeCache[id];
+      if (cached !== node) {
+        ("production" !== "development" ? invariant(
+          !isValid(cached, id),
+          'ReactMount: Two valid but unequal nodes with the same `%s`: %s',
+          ATTR_NAME, id
+        ) : invariant(!isValid(cached, id)));
+
+        nodeCache[id] = node;
+      }
+    } else {
+      nodeCache[id] = node;
+    }
+  }
+
+  return id;
+}
+
+function internalGetID(node) {
+  // If node is something like a window, document, or text node, none of
+  // which support attributes or a .getAttribute method, gracefully return
+  // the empty string, as if the attribute were missing.
+  return node && node.getAttribute && node.getAttribute(ATTR_NAME) || '';
+}
+
+/**
+ * Sets the React-specific ID of the given node.
+ *
+ * @param {DOMElement} node The DOM node whose ID will be set.
+ * @param {string} id The value of the ID attribute.
+ */
+function setID(node, id) {
+  var oldID = internalGetID(node);
+  if (oldID !== id) {
+    delete nodeCache[oldID];
+  }
+  node.setAttribute(ATTR_NAME, id);
+  nodeCache[id] = node;
+}
+
+/**
+ * Finds the node with the supplied React-generated DOM ID.
+ *
+ * @param {string} id A React-generated DOM ID.
+ * @return {DOMElement} DOM node with the suppled `id`.
+ * @internal
+ */
+function getNode(id) {
+  if (!nodeCache.hasOwnProperty(id) || !isValid(nodeCache[id], id)) {
+    nodeCache[id] = ReactMount.findReactNodeByID(id);
+  }
+  return nodeCache[id];
+}
+
+/**
+ * A node is "valid" if it is contained by a currently mounted container.
+ *
+ * This means that the node does not have to be contained by a document in
+ * order to be considered valid.
+ *
+ * @param {?DOMElement} node The candidate DOM node.
+ * @param {string} id The expected ID of the node.
+ * @return {boolean} Whether the node is contained by a mounted container.
+ */
+function isValid(node, id) {
+  if (node) {
+    ("production" !== "development" ? invariant(
+      internalGetID(node) === id,
+      'ReactMount: Unexpected modification of `%s`',
+      ATTR_NAME
+    ) : invariant(internalGetID(node) === id));
+
+    var container = ReactMount.findReactContainerForID(id);
+    if (container && containsNode(container, node)) {
+      return true;
+    }
+  }
+
+  return false;
+}
+
+/**
+ * Causes the cache to forget about one React-specific ID.
+ *
+ * @param {string} id The ID to forget.
+ */
+function purgeID(id) {
+  delete nodeCache[id];
+}
+
+var deepestNodeSoFar = null;
+function findDeepestCachedAncestorImpl(ancestorID) {
+  var ancestor = nodeCache[ancestorID];
+  if (ancestor && isValid(ancestor, ancestorID)) {
+    deepestNodeSoFar = ancestor;
+  } else {
+    // This node isn't populated in the cache, so presumably none of its
+    // descendants are. Break out of the loop.
+    return false;
+  }
+}
+
+/**
+ * Return the deepest cached node whose ID is a prefix of `targetID`.
+ */
+function findDeepestCachedAncestor(targetID) {
+  deepestNodeSoFar = null;
+  ReactInstanceHandles.traverseAncestors(
+    targetID,
+    findDeepestCachedAncestorImpl
+  );
+
+  var foundNode = deepestNodeSoFar;
+  deepestNodeSoFar = null;
+  return foundNode;
+}
+
+/**
+ * Mounting is the process of initializing a React component by creatings its
+ * representative DOM elements and inserting them into a supplied `container`.
+ * Any prior content inside `container` is destroyed in the process.
+ *
+ *   ReactMount.renderComponent(
+ *     component,
+ *     document.getElementById('container')
+ *   );
+ *
+ *   <div id="container">                   <-- Supplied `container`.
+ *     <div data-reactid=".3">              <-- Rendered reactRoot of React
+ *       // ...                                 component.
+ *     </div>
+ *   </div>
+ *
+ * Inside of `container`, the first element rendered is the "reactRoot".
+ */
+var ReactMount = {
+  /** Time spent generating markup. */
+  totalInstantiationTime: 0,
+
+  /** Time spent inserting markup into the DOM. */
+  totalInjectionTime: 0,
+
+  /** Whether support for touch events should be initialized. */
+  useTouchEvents: false,
+
+  /** Exposed for debugging purposes **/
+  _instancesByReactRootID: instancesByReactRootID,
+
+  /**
+   * This is a hook provided to support rendering React components while
+   * ensuring that the apparent scroll position of its `container` does not
+   * change.
+   *
+   * @param {DOMElement} container The `container` being rendered into.
+   * @param {function} renderCallback This must be called once to do the render.
+   */
+  scrollMonitor: function(container, renderCallback) {
+    renderCallback();
+  },
+
+  /**
+   * Take a component that's already mounted into the DOM and replace its props
+   * @param {ReactComponent} prevComponent component instance already in the DOM
+   * @param {ReactComponent} nextComponent component instance to render
+   * @param {DOMElement} container container to render into
+   * @param {?function} callback function triggered on completion
+   */
+  _updateRootComponent: function(
+      prevComponent,
+      nextComponent,
+      container,
+      callback) {
+    var nextProps = nextComponent.props;
+    ReactMount.scrollMonitor(container, function() {
+      prevComponent.replaceProps(nextProps, callback);
+    });
+
+    if ("production" !== "development") {
+      // Record the root element in case it later gets transplanted.
+      rootElementsByReactRootID[getReactRootID(container)] =
+        getReactRootElementInContainer(container);
+    }
+
+    return prevComponent;
+  },
+
+  /**
+   * Register a component into the instance map and starts scroll value
+   * monitoring
+   * @param {ReactComponent} nextComponent component instance to render
+   * @param {DOMElement} container container to render into
+   * @return {string} reactRoot ID prefix
+   */
+  _registerComponent: function(nextComponent, container) {
+    ("production" !== "development" ? invariant(
+      container && (
+        container.nodeType === ELEMENT_NODE_TYPE ||
+        container.nodeType === DOC_NODE_TYPE
+      ),
+      '_registerComponent(...): Target container is not a DOM element.'
+    ) : invariant(container && (
+      container.nodeType === ELEMENT_NODE_TYPE ||
+      container.nodeType === DOC_NODE_TYPE
+    )));
+
+    ReactEventEmitter.ensureScrollValueMonitoring();
+
+    var reactRootID = ReactMount.registerContainer(container);
+    instancesByReactRootID[reactRootID] = nextComponent;
+    return reactRootID;
+  },
+
+  /**
+   * Render a new component into the DOM.
+   * @param {ReactComponent} nextComponent component instance to render
+   * @param {DOMElement} container container to render into
+   * @param {boolean} shouldReuseMarkup if we should skip the markup insertion
+   * @return {ReactComponent} nextComponent
+   */
+  _renderNewRootComponent: ReactPerf.measure(
+    'ReactMount',
+    '_renderNewRootComponent',
+    function(
+        nextComponent,
+        container,
+        shouldReuseMarkup) {
+
+      var componentInstance = instantiateReactComponent(nextComponent);
+      var reactRootID = ReactMount._registerComponent(
+        componentInstance,
+        container
+      );
+      componentInstance.mountComponentIntoNode(
+        reactRootID,
+        container,
+        shouldReuseMarkup
+      );
+
+      if ("production" !== "development") {
+        // Record the root element in case it later gets transplanted.
+        rootElementsByReactRootID[reactRootID] =
+          getReactRootElementInContainer(container);
+      }
+
+      return componentInstance;
+    }
+  ),
+
+  /**
+   * Renders a React component into the DOM in the supplied `container`.
+   *
+   * If the React component was previously rendered into `container`, this will
+   * perform an update on it and only mutate the DOM as necessary to reflect the
+   * latest React component.
+   *
+   * @param {ReactComponent} nextComponent Component instance to render.
+   * @param {DOMElement} container DOM element to render into.
+   * @param {?function} callback function triggered on completion
+   * @return {ReactComponent} Component instance rendered in `container`.
+   */
+  renderComponent: function(nextComponent, container, callback) {
+    var prevComponent = instancesByReactRootID[getReactRootID(container)];
+
+    if (prevComponent) {
+      if (shouldUpdateReactComponent(prevComponent, nextComponent)) {
+        return ReactMount._updateRootComponent(
+          prevComponent,
+          nextComponent,
+          container,
+          callback
+        );
+      } else {
+        ReactMount.unmountComponentAtNode(container);
+      }
+    }
+
+    var reactRootElement = getReactRootElementInContainer(container);
+    var containerHasReactMarkup =
+      reactRootElement && ReactMount.isRenderedByReact(reactRootElement);
+
+    var shouldReuseMarkup = containerHasReactMarkup && !prevComponent;
+
+    var component = ReactMount._renderNewRootComponent(
+      nextComponent,
+      container,
+      shouldReuseMarkup
+    );
+    callback && callback.call(component);
+    return component;
+  },
+
+  /**
+   * Constructs a component instance of `constructor` with `initialProps` and
+   * renders it into the supplied `container`.
+   *
+   * @param {function} constructor React component constructor.
+   * @param {?object} props Initial props of the component instance.
+   * @param {DOMElement} container DOM element to render into.
+   * @return {ReactComponent} Component instance rendered in `container`.
+   */
+  constructAndRenderComponent: function(constructor, props, container) {
+    return ReactMount.renderComponent(constructor(props), container);
+  },
+
+  /**
+   * Constructs a component instance of `constructor` with `initialProps` and
+   * renders it into a container node identified by supplied `id`.
+   *
+   * @param {function} componentConstructor React component constructor
+   * @param {?object} props Initial props of the component instance.
+   * @param {string} id ID of the DOM element to render into.
+   * @return {ReactComponent} Component instance rendered in the container node.
+   */
+  constructAndRenderComponentByID: function(constructor, props, id) {
+    var domNode = document.getElementById(id);
+    ("production" !== "development" ? invariant(
+      domNode,
+      'Tried to get element with id of "%s" but it is not present on the page.',
+      id
+    ) : invariant(domNode));
+    return ReactMount.constructAndRenderComponent(constructor, props, domNode);
+  },
+
+  /**
+   * Registers a container node into which React components will be rendered.
+   * This also creates the "reactRoot" ID that will be assigned to the element
+   * rendered within.
+   *
+   * @param {DOMElement} container DOM element to register as a container.
+   * @return {string} The "reactRoot" ID of elements rendered within.
+   */
+  registerContainer: function(container) {
+    var reactRootID = getReactRootID(container);
+    if (reactRootID) {
+      // If one exists, make sure it is a valid "reactRoot" ID.
+      reactRootID = ReactInstanceHandles.getReactRootIDFromNodeID(reactRootID);
+    }
+    if (!reactRootID) {
+      // No valid "reactRoot" ID found, create one.
+      reactRootID = ReactInstanceHandles.createReactRootID();
+    }
+    containersByReactRootID[reactRootID] = container;
+    return reactRootID;
+  },
+
+  /**
+   * Unmounts and destroys the React component rendered in the `container`.
+   *
+   * @param {DOMElement} container DOM element containing a React component.
+   * @return {boolean} True if a component was found in and unmounted from
+   *                   `container`
+   */
+  unmountComponentAtNode: function(container) {
+    var reactRootID = getReactRootID(container);
+    var component = instancesByReactRootID[reactRootID];
+    if (!component) {
+      return false;
+    }
+    ReactMount.unmountComponentFromNode(component, container);
+    delete instancesByReactRootID[reactRootID];
+    delete containersByReactRootID[reactRootID];
+    if ("production" !== "development") {
+      delete rootElementsByReactRootID[reactRootID];
+    }
+    return true;
+  },
+
+  /**
+   * Unmounts a component and removes it from the DOM.
+   *
+   * @param {ReactComponent} instance React component instance.
+   * @param {DOMElement} container DOM element to unmount from.
+   * @final
+   * @internal
+   * @see {ReactMount.unmountComponentAtNode}
+   */
+  unmountComponentFromNode: function(instance, container) {
+    instance.unmountComponent();
+
+    if (container.nodeType === DOC_NODE_TYPE) {
+      container = container.documentElement;
+    }
+
+    // http://jsperf.com/emptying-a-node
+    while (container.lastChild) {
+      container.removeChild(container.lastChild);
+    }
+  },
+
+  /**
+   * Finds the container DOM element that contains React component to which the
+   * supplied DOM `id` belongs.
+   *
+   * @param {string} id The ID of an element rendered by a React component.
+   * @return {?DOMElement} DOM element that contains the `id`.
+   */
+  findReactContainerForID: function(id) {
+    var reactRootID = ReactInstanceHandles.getReactRootIDFromNodeID(id);
+    var container = containersByReactRootID[reactRootID];
+
+    if ("production" !== "development") {
+      var rootElement = rootElementsByReactRootID[reactRootID];
+      if (rootElement && rootElement.parentNode !== container) {
+        ("production" !== "development" ? invariant(
+          // Call internalGetID here because getID calls isValid which calls
+          // findReactContainerForID (this function).
+          internalGetID(rootElement) === reactRootID,
+          'ReactMount: Root element ID differed from reactRootID.'
+        ) : invariant(// Call internalGetID here because getID calls isValid which calls
+        // findReactContainerForID (this function).
+        internalGetID(rootElement) === reactRootID));
+
+        var containerChild = container.firstChild;
+        if (containerChild &&
+            reactRootID === internalGetID(containerChild)) {
+          // If the container has a new child with the same ID as the old
+          // root element, then rootElementsByReactRootID[reactRootID] is
+          // just stale and needs to be updated. The case that deserves a
+          // warning is when the container is empty.
+          rootElementsByReactRootID[reactRootID] = containerChild;
+        } else {
+          console.warn(
+            'ReactMount: Root element has been removed from its original ' +
+            'container. New container:', rootElement.parentNode
+          );
+        }
+      }
+    }
+
+    return container;
+  },
+
+  /**
+   * Finds an element rendered by React with the supplied ID.
+   *
+   * @param {string} id ID of a DOM node in the React component.
+   * @return {DOMElement} Root DOM node of the React component.
+   */
+  findReactNodeByID: function(id) {
+    var reactRoot = ReactMount.findReactContainerForID(id);
+    return ReactMount.findComponentRoot(reactRoot, id);
+  },
+
+  /**
+   * True if the supplied `node` is rendered by React.
+   *
+   * @param {*} node DOM Element to check.
+   * @return {boolean} True if the DOM Element appears to be rendered by React.
+   * @internal
+   */
+  isRenderedByReact: function(node) {
+    if (node.nodeType !== 1) {
+      // Not a DOMElement, therefore not a React component
+      return false;
+    }
+    var id = ReactMount.getID(node);
+    return id ? id.charAt(0) === SEPARATOR : false;
+  },
+
+  /**
+   * Traverses up the ancestors of the supplied node to find a node that is a
+   * DOM representation of a React component.
+   *
+   * @param {*} node
+   * @return {?DOMEventTarget}
+   * @internal
+   */
+  getFirstReactDOM: function(node) {
+    var current = node;
+    while (current && current.parentNode !== current) {
+      if (ReactMount.isRenderedByReact(current)) {
+        return current;
+      }
+      current = current.parentNode;
+    }
+    return null;
+  },
+
+  /**
+   * Finds a node with the supplied `targetID` inside of the supplied
+   * `ancestorNode`.  Exploits the ID naming scheme to perform the search
+   * quickly.
+   *
+   * @param {DOMEventTarget} ancestorNode Search from this root.
+   * @pararm {string} targetID ID of the DOM representation of the component.
+   * @return {DOMEventTarget} DOM node with the supplied `targetID`.
+   * @internal
+   */
+  findComponentRoot: function(ancestorNode, targetID) {
+    var firstChildren = findComponentRootReusableArray;
+    var childIndex = 0;
+
+    var deepestAncestor = findDeepestCachedAncestor(targetID) || ancestorNode;
+
+    firstChildren[0] = deepestAncestor.firstChild;
+    firstChildren.length = 1;
+
+    while (childIndex < firstChildren.length) {
+      var child = firstChildren[childIndex++];
+      var targetChild;
+
+      while (child) {
+        var childID = ReactMount.getID(child);
+        if (childID) {
+          // Even if we find the node we're looking for, we finish looping
+          // through its siblings to ensure they're cached so that we don't have
+          // to revisit this node again. Otherwise, we make n^2 calls to getID
+          // when visiting the many children of a single node in order.
+
+          if (targetID === childID) {
+            targetChild = child;
+          } else if (ReactInstanceHandles.isAncestorIDOf(childID, targetID)) {
+            // If we find a child whose ID is an ancestor of the given ID,
+            // then we can be sure that we only want to search the subtree
+            // rooted at this child, so we can throw out the rest of the
+            // search state.
+            firstChildren.length = childIndex = 0;
+            firstChildren.push(child.firstChild);
+          }
+
+        } else {
+          // If this child had no ID, then there's a chance that it was
+          // injected automatically by the browser, as when a `<table>`
+          // element sprouts an extra `<tbody>` child as a side effect of
+          // `.innerHTML` parsing. Optimistically continue down this
+          // branch, but not before examining the other siblings.
+          firstChildren.push(child.firstChild);
+        }
+
+        child = child.nextSibling;
+      }
+
+      if (targetChild) {
+        // Emptying firstChildren/findComponentRootReusableArray is
+        // not necessary for correctness, but it helps the GC reclaim
+        // any nodes that were left at the end of the search.
+        firstChildren.length = 0;
+
+        return targetChild;
+      }
+    }
+
+    firstChildren.length = 0;
+
+    ("production" !== "development" ? invariant(
+      false,
+      'findComponentRoot(..., %s): Unable to find element. This probably ' +
+      'means the DOM was unexpectedly mutated (e.g., by the browser), ' +
+      'usually due to forgetting a <tbody> when using tables or nesting <p> ' +
+      'or <a> tags. Try inspecting the child nodes of the element with React ' +
+      'ID `%s`.',
+      targetID,
+      ReactMount.getID(ancestorNode)
+    ) : invariant(false));
+  },
+
+
+  /**
+   * React ID utilities.
+   */
+
+  getReactRootID: getReactRootID,
+
+  getID: getID,
+
+  setID: setID,
+
+  getNode: getNode,
+
+  purgeID: purgeID
+};
+
+module.exports = ReactMount;
+
+},{"./DOMProperty":8,"./ReactEventEmitter":48,"./ReactInstanceHandles":53,"./ReactPerf":60,"./containsNode":89,"./getReactRootElementInContainer":107,"./instantiateReactComponent":111,"./invariant":112,"./shouldUpdateReactComponent":131}],56:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactMountReady
+ */
+
+"use strict";
+
+var PooledClass = _dereq_("./PooledClass");
+
+var mixInto = _dereq_("./mixInto");
+
+/**
+ * A specialized pseudo-event module to help keep track of components waiting to
+ * be notified when their DOM representations are available for use.
+ *
+ * This implements `PooledClass`, so you should never need to instantiate this.
+ * Instead, use `ReactMountReady.getPooled()`.
+ *
+ * @param {?array<function>} initialCollection
+ * @class ReactMountReady
+ * @implements PooledClass
+ * @internal
+ */
+function ReactMountReady(initialCollection) {
+  this._queue = initialCollection || null;
+}
+
+mixInto(ReactMountReady, {
+
+  /**
+   * Enqueues a callback to be invoked when `notifyAll` is invoked. This is used
+   * to enqueue calls to `componentDidMount` and `componentDidUpdate`.
+   *
+   * @param {ReactComponent} component Component being rendered.
+   * @param {function(DOMElement)} callback Invoked when `notifyAll` is invoked.
+   * @internal
+   */
+  enqueue: function(component, callback) {
+    this._queue = this._queue || [];
+    this._queue.push({component: component, callback: callback});
+  },
+
+  /**
+   * Invokes all enqueued callbacks and clears the queue. This is invoked after
+   * the DOM representation of a component has been created or updated.
+   *
+   * @internal
+   */
+  notifyAll: function() {
+    var queue = this._queue;
+    if (queue) {
+      this._queue = null;
+      for (var i = 0, l = queue.length; i < l; i++) {
+        var component = queue[i].component;
+        var callback = queue[i].callback;
+        callback.call(component);
+      }
+      queue.length = 0;
+    }
+  },
+
+  /**
+   * Resets the internal queue.
+   *
+   * @internal
+   */
+  reset: function() {
+    this._queue = null;
+  },
+
+  /**
+   * `PooledClass` looks for this.
+   */
+  destructor: function() {
+    this.reset();
+  }
+
+});
+
+PooledClass.addPoolingTo(ReactMountReady);
+
+module.exports = ReactMountReady;
+
+},{"./PooledClass":23,"./mixInto":124}],57:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactMultiChild
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var ReactComponent = _dereq_("./ReactComponent");
+var ReactMultiChildUpdateTypes = _dereq_("./ReactMultiChildUpdateTypes");
+
+var flattenChildren = _dereq_("./flattenChildren");
+var instantiateReactComponent = _dereq_("./instantiateReactComponent");
+var shouldUpdateReactComponent = _dereq_("./shouldUpdateReactComponent");
+
+/**
+ * Updating children of a component may trigger recursive updates. The depth is
+ * used to batch recursive updates to render markup more efficiently.
+ *
+ * @type {number}
+ * @private
+ */
+var updateDepth = 0;
+
+/**
+ * Queue of update configuration objects.
+ *
+ * Each object has a `type` property that is in `ReactMultiChildUpdateTypes`.
+ *
+ * @type {array<object>}
+ * @private
+ */
+var updateQueue = [];
+
+/**
+ * Queue of markup to be rendered.
+ *
+ * @type {array<string>}
+ * @private
+ */
+var markupQueue = [];
+
+/**
+ * Enqueues markup to be rendered and inserted at a supplied index.
+ *
+ * @param {string} parentID ID of the parent component.
+ * @param {string} markup Markup that renders into an element.
+ * @param {number} toIndex Destination index.
+ * @private
+ */
+function enqueueMarkup(parentID, markup, toIndex) {
+  // NOTE: Null values reduce hidden classes.
+  updateQueue.push({
+    parentID: parentID,
+    parentNode: null,
+    type: ReactMultiChildUpdateTypes.INSERT_MARKUP,
+    markupIndex: markupQueue.push(markup) - 1,
+    textContent: null,
+    fromIndex: null,
+    toIndex: toIndex
+  });
+}
+
+/**
+ * Enqueues moving an existing element to another index.
+ *
+ * @param {string} parentID ID of the parent component.
+ * @param {number} fromIndex Source index of the existing element.
+ * @param {number} toIndex Destination index of the element.
+ * @private
+ */
+function enqueueMove(parentID, fromIndex, toIndex) {
+  // NOTE: Null values reduce hidden classes.
+  updateQueue.push({
+    parentID: parentID,
+    parentNode: null,
+    type: ReactMultiChildUpdateTypes.MOVE_EXISTING,
+    markupIndex: null,
+    textContent: null,
+    fromIndex: fromIndex,
+    toIndex: toIndex
+  });
+}
+
+/**
+ * Enqueues removing an element at an index.
+ *
+ * @param {string} parentID ID of the parent component.
+ * @param {number} fromIndex Index of the element to remove.
+ * @private
+ */
+function enqueueRemove(parentID, fromIndex) {
+  // NOTE: Null values reduce hidden classes.
+  updateQueue.push({
+    parentID: parentID,
+    parentNode: null,
+    type: ReactMultiChildUpdateTypes.REMOVE_NODE,
+    markupIndex: null,
+    textContent: null,
+    fromIndex: fromIndex,
+    toIndex: null
+  });
+}
+
+/**
+ * Enqueues setting the text content.
+ *
+ * @param {string} parentID ID of the parent component.
+ * @param {string} textContent Text content to set.
+ * @private
+ */
+function enqueueTextContent(parentID, textContent) {
+  // NOTE: Null values reduce hidden classes.
+  updateQueue.push({
+    parentID: parentID,
+    parentNode: null,
+    type: ReactMultiChildUpdateTypes.TEXT_CONTENT,
+    markupIndex: null,
+    textContent: textContent,
+    fromIndex: null,
+    toIndex: null
+  });
+}
+
+/**
+ * Processes any enqueued updates.
+ *
+ * @private
+ */
+function processQueue() {
+  if (updateQueue.length) {
+    ReactComponent.BackendIDOperations.dangerouslyProcessChildrenUpdates(
+      updateQueue,
+      markupQueue
+    );
+    clearQueue();
+  }
+}
+
+/**
+ * Clears any enqueued updates.
+ *
+ * @private
+ */
+function clearQueue() {
+  updateQueue.length = 0;
+  markupQueue.length = 0;
+}
+
+/**
+ * ReactMultiChild are capable of reconciling multiple children.
+ *
+ * @class ReactMultiChild
+ * @internal
+ */
+var ReactMultiChild = {
+
+  /**
+   * Provides common functionality for components that must reconcile multiple
+   * children. This is used by `ReactDOMComponent` to mount, update, and
+   * unmount child components.
+   *
+   * @lends {ReactMultiChild.prototype}
+   */
+  Mixin: {
+
+    /**
+     * Generates a "mount image" for each of the supplied children. In the case
+     * of `ReactDOMComponent`, a mount image is a string of markup.
+     *
+     * @param {?object} nestedChildren Nested child maps.
+     * @return {array} An array of mounted representations.
+     * @internal
+     */
+    mountChildren: function(nestedChildren, transaction) {
+      var children = flattenChildren(nestedChildren);
+      var mountImages = [];
+      var index = 0;
+      this._renderedChildren = children;
+      for (var name in children) {
+        var child = children[name];
+        if (children.hasOwnProperty(name)) {
+          // The rendered children must be turned into instances as they're
+          // mounted.
+          var childInstance = instantiateReactComponent(child);
+          children[name] = childInstance;
+          // Inlined for performance, see `ReactInstanceHandles.createReactID`.
+          var rootID = this._rootNodeID + name;
+          var mountImage = childInstance.mountComponent(
+            rootID,
+            transaction,
+            this._mountDepth + 1
+          );
+          childInstance._mountIndex = index;
+          mountImages.push(mountImage);
+          index++;
+        }
+      }
+      return mountImages;
+    },
+
+    /**
+     * Replaces any rendered children with a text content string.
+     *
+     * @param {string} nextContent String of content.
+     * @internal
+     */
+    updateTextContent: function(nextContent) {
+      updateDepth++;
+      var errorThrown = true;
+      try {
+        var prevChildren = this._renderedChildren;
+        // Remove any rendered children.
+        for (var name in prevChildren) {
+          if (prevChildren.hasOwnProperty(name)) {
+            this._unmountChildByName(prevChildren[name], name);
+          }
+        }
+        // Set new text content.
+        this.setTextContent(nextContent);
+        errorThrown = false;
+      } finally {
+        updateDepth--;
+        if (!updateDepth) {
+          errorThrown ? clearQueue() : processQueue();
+        }
+      }
+    },
+
+    /**
+     * Updates the rendered children with new children.
+     *
+     * @param {?object} nextNestedChildren Nested child maps.
+     * @param {ReactReconcileTransaction} transaction
+     * @internal
+     */
+    updateChildren: function(nextNestedChildren, transaction) {
+      updateDepth++;
+      var errorThrown = true;
+      try {
+        this._updateChildren(nextNestedChildren, transaction);
+        errorThrown = false;
+      } finally {
+        updateDepth--;
+        if (!updateDepth) {
+          errorThrown ? clearQueue() : processQueue();
+        }
+      }
+    },
+
+    /**
+     * Improve performance by isolating this hot code path from the try/catch
+     * block in `updateChildren`.
+     *
+     * @param {?object} nextNestedChildren Nested child maps.
+     * @param {ReactReconcileTransaction} transaction
+     * @final
+     * @protected
+     */
+    _updateChildren: function(nextNestedChildren, transaction) {
+      var nextChildren = flattenChildren(nextNestedChildren);
+      var prevChildren = this._renderedChildren;
+      if (!nextChildren && !prevChildren) {
+        return;
+      }
+      var name;
+      // `nextIndex` will increment for each child in `nextChildren`, but
+      // `lastIndex` will be the last index visited in `prevChildren`.
+      var lastIndex = 0;
+      var nextIndex = 0;
+      for (name in nextChildren) {
+        if (!nextChildren.hasOwnProperty(name)) {
+          continue;
+        }
+        var prevChild = prevChildren && prevChildren[name];
+        var nextChild = nextChildren[name];
+        if (shouldUpdateReactComponent(prevChild, nextChild)) {
+          this.moveChild(prevChild, nextIndex, lastIndex);
+          lastIndex = Math.max(prevChild._mountIndex, lastIndex);
+          prevChild.receiveComponent(nextChild, transaction);
+          prevChild._mountIndex = nextIndex;
+        } else {
+          if (prevChild) {
+            // Update `lastIndex` before `_mountIndex` gets unset by unmounting.
+            lastIndex = Math.max(prevChild._mountIndex, lastIndex);
+            this._unmountChildByName(prevChild, name);
+          }
+          // The child must be instantiated before it's mounted.
+          var nextChildInstance = instantiateReactComponent(nextChild);
+          this._mountChildByNameAtIndex(
+            nextChildInstance, name, nextIndex, transaction
+          );
+        }
+        nextIndex++;
+      }
+      // Remove children that are no longer present.
+      for (name in prevChildren) {
+        if (prevChildren.hasOwnProperty(name) &&
+            !(nextChildren && nextChildren[name])) {
+          this._unmountChildByName(prevChildren[name], name);
+        }
+      }
+    },
+
+    /**
+     * Unmounts all rendered children. This should be used to clean up children
+     * when this component is unmounted.
+     *
+     * @internal
+     */
+    unmountChildren: function() {
+      var renderedChildren = this._renderedChildren;
+      for (var name in renderedChildren) {
+        var renderedChild = renderedChildren[name];
+        // TODO: When is this not true?
+        if (renderedChild.unmountComponent) {
+          renderedChild.unmountComponent();
+        }
+      }
+      this._renderedChildren = null;
+    },
+
+    /**
+     * Moves a child component to the supplied index.
+     *
+     * @param {ReactComponent} child Component to move.
+     * @param {number} toIndex Destination index of the element.
+     * @param {number} lastIndex Last index visited of the siblings of `child`.
+     * @protected
+     */
+    moveChild: function(child, toIndex, lastIndex) {
+      // If the index of `child` is less than `lastIndex`, then it needs to
+      // be moved. Otherwise, we do not need to move it because a child will be
+      // inserted or moved before `child`.
+      if (child._mountIndex < lastIndex) {
+        enqueueMove(this._rootNodeID, child._mountIndex, toIndex);
+      }
+    },
+
+    /**
+     * Creates a child component.
+     *
+     * @param {ReactComponent} child Component to create.
+     * @param {string} mountImage Markup to insert.
+     * @protected
+     */
+    createChild: function(child, mountImage) {
+      enqueueMarkup(this._rootNodeID, mountImage, child._mountIndex);
+    },
+
+    /**
+     * Removes a child component.
+     *
+     * @param {ReactComponent} child Child to remove.
+     * @protected
+     */
+    removeChild: function(child) {
+      enqueueRemove(this._rootNodeID, child._mountIndex);
+    },
+
+    /**
+     * Sets this text content string.
+     *
+     * @param {string} textContent Text content to set.
+     * @protected
+     */
+    setTextContent: function(textContent) {
+      enqueueTextContent(this._rootNodeID, textContent);
+    },
+
+    /**
+     * Mounts a child with the supplied name.
+     *
+     * NOTE: This is part of `updateChildren` and is here for readability.
+     *
+     * @param {ReactComponent} child Component to mount.
+     * @param {string} name Name of the child.
+     * @param {number} index Index at which to insert the child.
+     * @param {ReactReconcileTransaction} transaction
+     * @private
+     */
+    _mountChildByNameAtIndex: function(child, name, index, transaction) {
+      // Inlined for performance, see `ReactInstanceHandles.createReactID`.
+      var rootID = this._rootNodeID + name;
+      var mountImage = child.mountComponent(
+        rootID,
+        transaction,
+        this._mountDepth + 1
+      );
+      child._mountIndex = index;
+      this.createChild(child, mountImage);
+      this._renderedChildren = this._renderedChildren || {};
+      this._renderedChildren[name] = child;
+    },
+
+    /**
+     * Unmounts a rendered child by name.
+     *
+     * NOTE: This is part of `updateChildren` and is here for readability.
+     *
+     * @param {ReactComponent} child Component to unmount.
+     * @param {string} name Name of the child in `this._renderedChildren`.
+     * @private
+     */
+    _unmountChildByName: function(child, name) {
+      // TODO: When is this not true?
+      if (ReactComponent.isValidComponent(child)) {
+        this.removeChild(child);
+        child._mountIndex = null;
+        child.unmountComponent();
+        delete this._renderedChildren[name];
+      }
+    }
+
+  }
+
+};
+
+module.exports = ReactMultiChild;
+
+},{"./ReactComponent":27,"./ReactMultiChildUpdateTypes":58,"./flattenChildren":99,"./instantiateReactComponent":111,"./shouldUpdateReactComponent":131}],58:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactMultiChildUpdateTypes
+ */
+
+"use strict";
+
+var keyMirror = _dereq_("./keyMirror");
+
+/**
+ * When a component's children are updated, a series of update configuration
+ * objects are created in order to batch and serialize the required changes.
+ *
+ * Enumerates all the possible types of update configurations.
+ *
+ * @internal
+ */
+var ReactMultiChildUpdateTypes = keyMirror({
+  INSERT_MARKUP: null,
+  MOVE_EXISTING: null,
+  REMOVE_NODE: null,
+  TEXT_CONTENT: null
+});
+
+module.exports = ReactMultiChildUpdateTypes;
+
+},{"./keyMirror":118}],59:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactOwner
+ */
+
+"use strict";
+
+var emptyObject = _dereq_("./emptyObject");
+var invariant = _dereq_("./invariant");
+
+/**
+ * ReactOwners are capable of storing references to owned components.
+ *
+ * All components are capable of //being// referenced by owner components, but
+ * only ReactOwner components are capable of //referencing// owned components.
+ * The named reference is known as a "ref".
+ *
+ * Refs are available when mounted and updated during reconciliation.
+ *
+ *   var MyComponent = React.createClass({
+ *     render: function() {
+ *       return (
+ *         <div onClick={this.handleClick}>
+ *           <CustomComponent ref="custom" />
+ *         </div>
+ *       );
+ *     },
+ *     handleClick: function() {
+ *       this.refs.custom.handleClick();
+ *     },
+ *     componentDidMount: function() {
+ *       this.refs.custom.initialize();
+ *     }
+ *   });
+ *
+ * Refs should rarely be used. When refs are used, they should only be done to
+ * control data that is not handled by React's data flow.
+ *
+ * @class ReactOwner
+ */
+var ReactOwner = {
+
+  /**
+   * @param {?object} object
+   * @return {boolean} True if `object` is a valid owner.
+   * @final
+   */
+  isValidOwner: function(object) {
+    return !!(
+      object &&
+      typeof object.attachRef === 'function' &&
+      typeof object.detachRef === 'function'
+    );
+  },
+
+  /**
+   * Adds a component by ref to an owner component.
+   *
+   * @param {ReactComponent} component Component to reference.
+   * @param {string} ref Name by which to refer to the component.
+   * @param {ReactOwner} owner Component on which to record the ref.
+   * @final
+   * @internal
+   */
+  addComponentAsRefTo: function(component, ref, owner) {
+    ("production" !== "development" ? invariant(
+      ReactOwner.isValidOwner(owner),
+      'addComponentAsRefTo(...): Only a ReactOwner can have refs. This ' +
+      'usually means that you\'re trying to add a ref to a component that ' +
+      'doesn\'t have an owner (that is, was not created inside of another ' +
+      'component\'s `render` method). Try rendering this component inside of ' +
+      'a new top-level component which will hold the ref.'
+    ) : invariant(ReactOwner.isValidOwner(owner)));
+    owner.attachRef(ref, component);
+  },
+
+  /**
+   * Removes a component by ref from an owner component.
+   *
+   * @param {ReactComponent} component Component to dereference.
+   * @param {string} ref Name of the ref to remove.
+   * @param {ReactOwner} owner Component on which the ref is recorded.
+   * @final
+   * @internal
+   */
+  removeComponentAsRefFrom: function(component, ref, owner) {
+    ("production" !== "development" ? invariant(
+      ReactOwner.isValidOwner(owner),
+      'removeComponentAsRefFrom(...): Only a ReactOwner can have refs. This ' +
+      'usually means that you\'re trying to remove a ref to a component that ' +
+      'doesn\'t have an owner (that is, was not created inside of another ' +
+      'component\'s `render` method). Try rendering this component inside of ' +
+      'a new top-level component which will hold the ref.'
+    ) : invariant(ReactOwner.isValidOwner(owner)));
+    // Check that `component` is still the current ref because we do not want to
+    // detach the ref if another component stole it.
+    if (owner.refs[ref] === component) {
+      owner.detachRef(ref);
+    }
+  },
+
+  /**
+   * A ReactComponent must mix this in to have refs.
+   *
+   * @lends {ReactOwner.prototype}
+   */
+  Mixin: {
+
+    construct: function() {
+      this.refs = emptyObject;
+    },
+
+    /**
+     * Lazily allocates the refs object and stores `component` as `ref`.
+     *
+     * @param {string} ref Reference name.
+     * @param {component} component Component to store as `ref`.
+     * @final
+     * @private
+     */
+    attachRef: function(ref, component) {
+      ("production" !== "development" ? invariant(
+        component.isOwnedBy(this),
+        'attachRef(%s, ...): Only a component\'s owner can store a ref to it.',
+        ref
+      ) : invariant(component.isOwnedBy(this)));
+      var refs = this.refs === emptyObject ? (this.refs = {}) : this.refs;
+      refs[ref] = component;
+    },
+
+    /**
+     * Detaches a reference name.
+     *
+     * @param {string} ref Name to dereference.
+     * @final
+     * @private
+     */
+    detachRef: function(ref) {
+      delete this.refs[ref];
+    }
+
+  }
+
+};
+
+module.exports = ReactOwner;
+
+},{"./emptyObject":97,"./invariant":112}],60:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactPerf
+ * @typechecks static-only
+ */
+
+"use strict";
+
+/**
+ * ReactPerf is a general AOP system designed to measure performance. This
+ * module only has the hooks: see ReactDefaultPerf for the analysis tool.
+ */
+var ReactPerf = {
+  /**
+   * Boolean to enable/disable measurement. Set to false by default to prevent
+   * accidental logging and perf loss.
+   */
+  enableMeasure: false,
+
+  /**
+   * Holds onto the measure function in use. By default, don't measure
+   * anything, but we'll override this if we inject a measure function.
+   */
+  storedMeasure: _noMeasure,
+
+  /**
+   * Use this to wrap methods you want to measure. Zero overhead in production.
+   *
+   * @param {string} objName
+   * @param {string} fnName
+   * @param {function} func
+   * @return {function}
+   */
+  measure: function(objName, fnName, func) {
+    if ("production" !== "development") {
+      var measuredFunc = null;
+      return function() {
+        if (ReactPerf.enableMeasure) {
+          if (!measuredFunc) {
+            measuredFunc = ReactPerf.storedMeasure(objName, fnName, func);
+          }
+          return measuredFunc.apply(this, arguments);
+        }
+        return func.apply(this, arguments);
+      };
+    }
+    return func;
+  },
+
+  injection: {
+    /**
+     * @param {function} measure
+     */
+    injectMeasure: function(measure) {
+      ReactPerf.storedMeasure = measure;
+    }
+  }
+};
+
+/**
+ * Simply passes through the measured function, without measuring it.
+ *
+ * @param {string} objName
+ * @param {string} fnName
+ * @param {function} func
+ * @return {function}
+ */
+function _noMeasure(objName, fnName, func) {
+  return func;
+}
+
+module.exports = ReactPerf;
+
+},{}],61:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactPropTransferer
+ */
+
+"use strict";
+
+var emptyFunction = _dereq_("./emptyFunction");
+var invariant = _dereq_("./invariant");
+var joinClasses = _dereq_("./joinClasses");
+var merge = _dereq_("./merge");
+
+/**
+ * Creates a transfer strategy that will merge prop values using the supplied
+ * `mergeStrategy`. If a prop was previously unset, this just sets it.
+ *
+ * @param {function} mergeStrategy
+ * @return {function}
+ */
+function createTransferStrategy(mergeStrategy) {
+  return function(props, key, value) {
+    if (!props.hasOwnProperty(key)) {
+      props[key] = value;
+    } else {
+      props[key] = mergeStrategy(props[key], value);
+    }
+  };
+}
+
+/**
+ * Transfer strategies dictate how props are transferred by `transferPropsTo`.
+ * NOTE: if you add any more exceptions to this list you should be sure to
+ * update `cloneWithProps()` accordingly.
+ */
+var TransferStrategies = {
+  /**
+   * Never transfer `children`.
+   */
+  children: emptyFunction,
+  /**
+   * Transfer the `className` prop by merging them.
+   */
+  className: createTransferStrategy(joinClasses),
+  /**
+   * Never transfer the `key` prop.
+   */
+  key: emptyFunction,
+  /**
+   * Never transfer the `ref` prop.
+   */
+  ref: emptyFunction,
+  /**
+   * Transfer the `style` prop (which is an object) by merging them.
+   */
+  style: createTransferStrategy(merge)
+};
+
+/**
+ * ReactPropTransferer are capable of transferring props to another component
+ * using a `transferPropsTo` method.
+ *
+ * @class ReactPropTransferer
+ */
+var ReactPropTransferer = {
+
+  TransferStrategies: TransferStrategies,
+
+  /**
+   * Merge two props objects using TransferStrategies.
+   *
+   * @param {object} oldProps original props (they take precedence)
+   * @param {object} newProps new props to merge in
+   * @return {object} a new object containing both sets of props merged.
+   */
+  mergeProps: function(oldProps, newProps) {
+    var props = merge(oldProps);
+
+    for (var thisKey in newProps) {
+      if (!newProps.hasOwnProperty(thisKey)) {
+        continue;
+      }
+
+      var transferStrategy = TransferStrategies[thisKey];
+
+      if (transferStrategy && TransferStrategies.hasOwnProperty(thisKey)) {
+        transferStrategy(props, thisKey, newProps[thisKey]);
+      } else if (!props.hasOwnProperty(thisKey)) {
+        props[thisKey] = newProps[thisKey];
+      }
+    }
+
+    return props;
+  },
+
+  /**
+   * @lends {ReactPropTransferer.prototype}
+   */
+  Mixin: {
+
+    /**
+     * Transfer props from this component to a target component.
+     *
+     * Props that do not have an explicit transfer strategy will be transferred
+     * only if the target component does not already have the prop set.
+     *
+     * This is usually used to pass down props to a returned root component.
+     *
+     * @param {ReactComponent} component Component receiving the properties.
+     * @return {ReactComponent} The supplied `component`.
+     * @final
+     * @protected
+     */
+    transferPropsTo: function(component) {
+      ("production" !== "development" ? invariant(
+        component._owner === this,
+        '%s: You can\'t call transferPropsTo() on a component that you ' +
+        'don\'t own, %s. This usually means you are calling ' +
+        'transferPropsTo() on a component passed in as props or children.',
+        this.constructor.displayName,
+        component.constructor.displayName
+      ) : invariant(component._owner === this));
+
+      component.props = ReactPropTransferer.mergeProps(
+        component.props,
+        this.props
+      );
+
+      return component;
+    }
+
+  }
+};
+
+module.exports = ReactPropTransferer;
+
+},{"./emptyFunction":96,"./invariant":112,"./joinClasses":117,"./merge":121}],62:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactPropTypeLocationNames
+ */
+
+"use strict";
+
+var ReactPropTypeLocationNames = {};
+
+if ("production" !== "development") {
+  ReactPropTypeLocationNames = {
+    prop: 'prop',
+    context: 'context',
+    childContext: 'child context'
+  };
+}
+
+module.exports = ReactPropTypeLocationNames;
+
+},{}],63:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactPropTypeLocations
+ */
+
+"use strict";
+
+var keyMirror = _dereq_("./keyMirror");
+
+var ReactPropTypeLocations = keyMirror({
+  prop: null,
+  context: null,
+  childContext: null
+});
+
+module.exports = ReactPropTypeLocations;
+
+},{"./keyMirror":118}],64:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactPropTypes
+ */
+
+"use strict";
+
+var ReactComponent = _dereq_("./ReactComponent");
+var ReactPropTypeLocationNames = _dereq_("./ReactPropTypeLocationNames");
+
+var warning = _dereq_("./warning");
+var createObjectFrom = _dereq_("./createObjectFrom");
+
+/**
+ * Collection of methods that allow declaration and validation of props that are
+ * supplied to React components. Example usage:
+ *
+ *   var Props = require('ReactPropTypes');
+ *   var MyArticle = React.createClass({
+ *     propTypes: {
+ *       // An optional string prop named "description".
+ *       description: Props.string,
+ *
+ *       // A required enum prop named "category".
+ *       category: Props.oneOf(['News','Photos']).isRequired,
+ *
+ *       // A prop named "dialog" that requires an instance of Dialog.
+ *       dialog: Props.instanceOf(Dialog).isRequired
+ *     },
+ *     render: function() { ... }
+ *   });
+ *
+ * A more formal specification of how these methods are used:
+ *
+ *   type := array|bool|func|object|number|string|oneOf([...])|instanceOf(...)
+ *   decl := ReactPropTypes.{type}(.isRequired)?
+ *
+ * Each and every declaration produces a function with the same signature. This
+ * allows the creation of custom validation functions. For example:
+ *
+ *   var Props = require('ReactPropTypes');
+ *   var MyLink = React.createClass({
+ *     propTypes: {
+ *       // An optional string or URI prop named "href".
+ *       href: function(props, propName, componentName) {
+ *         var propValue = props[propName];
+ *         warning(
+ *           propValue == null ||
+ *           typeof propValue === 'string' ||
+ *           propValue instanceof URI,
+ *           'Invalid `%s` supplied to `%s`, expected string or URI.',
+ *           propName,
+ *           componentName
+ *         );
+ *       }
+ *     },
+ *     render: function() { ... }
+ *   });
+ *
+ * @internal
+ */
+var Props = {
+
+  array: createPrimitiveTypeChecker('array'),
+  bool: createPrimitiveTypeChecker('boolean'),
+  func: createPrimitiveTypeChecker('function'),
+  number: createPrimitiveTypeChecker('number'),
+  object: createPrimitiveTypeChecker('object'),
+  string: createPrimitiveTypeChecker('string'),
+
+  shape: createShapeTypeChecker,
+  oneOf: createEnumTypeChecker,
+  oneOfType: createUnionTypeChecker,
+  arrayOf: createArrayOfTypeChecker,
+
+  instanceOf: createInstanceTypeChecker,
+
+  renderable: createRenderableTypeChecker(),
+
+  component: createComponentTypeChecker(),
+
+  any: createAnyTypeChecker()
+};
+
+var ANONYMOUS = '<<anonymous>>';
+
+function isRenderable(propValue) {
+  switch(typeof propValue) {
+    case 'number':
+    case 'string':
+      return true;
+    case 'object':
+      if (Array.isArray(propValue)) {
+        return propValue.every(isRenderable);
+      }
+      if (ReactComponent.isValidComponent(propValue)) {
+        return true;
+      }
+      for (var k in propValue) {
+        if (!isRenderable(propValue[k])) {
+          return false;
+        }
+      }
+      return true;
+    default:
+      return false;
+  }
+}
+
+// Equivalent of typeof but with special handling for arrays
+function getPropType(propValue) {
+  var propType = typeof propValue;
+  if (propType === 'object' && Array.isArray(propValue)) {
+    return 'array';
+  }
+  return propType;
+}
+
+function createAnyTypeChecker() {
+  function validateAnyType(
+    shouldWarn, propValue, propName, componentName, location
+  ) {
+    return true; // is always valid
+  }
+  return createChainableTypeChecker(validateAnyType);
+}
+
+function createPrimitiveTypeChecker(expectedType) {
+  function validatePrimitiveType(
+    shouldWarn, propValue, propName, componentName, location
+  ) {
+    var propType = getPropType(propValue);
+    var isValid = propType === expectedType;
+    if (shouldWarn) {
+      ("production" !== "development" ? warning(
+        isValid,
+        'Invalid %s `%s` of type `%s` supplied to `%s`, expected `%s`.',
+        ReactPropTypeLocationNames[location],
+        propName,
+        propType,
+        componentName,
+        expectedType
+      ) : null);
+    }
+    return isValid;
+  }
+  return createChainableTypeChecker(validatePrimitiveType);
+}
+
+function createEnumTypeChecker(expectedValues) {
+  var expectedEnum = createObjectFrom(expectedValues);
+  function validateEnumType(
+    shouldWarn, propValue, propName, componentName, location
+  ) {
+    var isValid = expectedEnum[propValue];
+    if (shouldWarn) {
+      ("production" !== "development" ? warning(
+        isValid,
+        'Invalid %s `%s` supplied to `%s`, expected one of %s.',
+        ReactPropTypeLocationNames[location],
+        propName,
+        componentName,
+        JSON.stringify(Object.keys(expectedEnum))
+      ) : null);
+    }
+    return isValid;
+  }
+  return createChainableTypeChecker(validateEnumType);
+}
+
+function createShapeTypeChecker(shapeTypes) {
+  function validateShapeType(
+    shouldWarn, propValue, propName, componentName, location
+  ) {
+    var propType = getPropType(propValue);
+    var isValid = propType === 'object';
+    if (isValid) {
+      for (var key in shapeTypes) {
+        var checker = shapeTypes[key];
+        if (checker && !checker(propValue, key, componentName, location)) {
+          return false;
+        }
+      }
+    }
+    if (shouldWarn) {
+      ("production" !== "development" ? warning(
+        isValid,
+        'Invalid %s `%s` of type `%s` supplied to `%s`, expected `object`.',
+        ReactPropTypeLocationNames[location],
+        propName,
+        propType,
+        componentName
+      ) : null);
+    }
+    return isValid;
+  }
+  return createChainableTypeChecker(validateShapeType);
+}
+
+function createInstanceTypeChecker(expectedClass) {
+  function validateInstanceType(
+    shouldWarn, propValue, propName, componentName, location
+  ) {
+    var isValid = propValue instanceof expectedClass;
+    if (shouldWarn) {
+      ("production" !== "development" ? warning(
+        isValid,
+        'Invalid %s `%s` supplied to `%s`, expected instance of `%s`.',
+        ReactPropTypeLocationNames[location],
+        propName,
+        componentName,
+        expectedClass.name || ANONYMOUS
+      ) : null);
+    }
+    return isValid;
+  }
+  return createChainableTypeChecker(validateInstanceType);
+}
+
+function createArrayOfTypeChecker(propTypeChecker) {
+  function validateArrayType(
+    shouldWarn, propValue, propName, componentName, location
+  ) {
+    var isValid = Array.isArray(propValue);
+    if (isValid) {
+      for (var i = 0; i < propValue.length; i++) {
+        if (!propTypeChecker(propValue, i, componentName, location)) {
+          return false;
+        }
+      }
+    }
+    if (shouldWarn) {
+      ("production" !== "development" ? warning(
+        isValid,
+        'Invalid %s `%s` supplied to `%s`, expected an array.',
+        ReactPropTypeLocationNames[location],
+        propName,
+        componentName
+      ) : null);
+    }
+    return isValid;
+  }
+  return createChainableTypeChecker(validateArrayType);
+}
+
+function createRenderableTypeChecker() {
+  function validateRenderableType(
+    shouldWarn, propValue, propName, componentName, location
+  ) {
+    var isValid = isRenderable(propValue);
+    if (shouldWarn) {
+      ("production" !== "development" ? warning(
+        isValid,
+        'Invalid %s `%s` supplied to `%s`, expected a renderable prop.',
+        ReactPropTypeLocationNames[location],
+        propName,
+        componentName
+      ) : null);
+    }
+    return isValid;
+  }
+  return createChainableTypeChecker(validateRenderableType);
+}
+
+function createComponentTypeChecker() {
+  function validateComponentType(
+    shouldWarn, propValue, propName, componentName, location
+  ) {
+    var isValid = ReactComponent.isValidComponent(propValue);
+    if (shouldWarn) {
+      ("production" !== "development" ? warning(
+        isValid,
+        'Invalid %s `%s` supplied to `%s`, expected a React component.',
+        ReactPropTypeLocationNames[location],
+        propName,
+        componentName
+      ) : null);
+    }
+    return isValid;
+  }
+  return createChainableTypeChecker(validateComponentType);
+}
+
+function createUnionTypeChecker(arrayOfValidators) {
+  return function(props, propName, componentName, location) {
+    var isValid = false;
+    for (var ii = 0; ii < arrayOfValidators.length; ii++) {
+      var validate = arrayOfValidators[ii];
+      if (typeof validate.weak === 'function') {
+        validate = validate.weak;
+      }
+      if (validate(props, propName, componentName, location)) {
+        isValid = true;
+        break;
+      }
+    }
+    ("production" !== "development" ? warning(
+      isValid,
+      'Invalid %s `%s` supplied to `%s`.',
+      ReactPropTypeLocationNames[location],
+      propName,
+      componentName || ANONYMOUS
+    ) : null);
+    return isValid;
+  };
+}
+
+function createChainableTypeChecker(validate) {
+  function checkType(
+    isRequired, shouldWarn, props, propName, componentName, location
+  ) {
+    var propValue = props[propName];
+    if (propValue != null) {
+      // Only validate if there is a value to check.
+      return validate(
+        shouldWarn,
+        propValue,
+        propName,
+        componentName || ANONYMOUS,
+        location
+      );
+    } else {
+      var isValid = !isRequired;
+      if (shouldWarn) {
+        ("production" !== "development" ? warning(
+          isValid,
+          'Required %s `%s` was not specified in `%s`.',
+          ReactPropTypeLocationNames[location],
+          propName,
+          componentName || ANONYMOUS
+        ) : null);
+      }
+      return isValid;
+    }
+  }
+
+  var checker = checkType.bind(null, false, true);
+  checker.weak = checkType.bind(null, false, false);
+  checker.isRequired = checkType.bind(null, true, true);
+  checker.weak.isRequired = checkType.bind(null, true, false);
+  checker.isRequired.weak = checker.weak.isRequired;
+
+  return checker;
+}
+
+module.exports = Props;
+
+},{"./ReactComponent":27,"./ReactPropTypeLocationNames":62,"./createObjectFrom":94,"./warning":134}],65:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactPutListenerQueue
+ */
+
+"use strict";
+
+var PooledClass = _dereq_("./PooledClass");
+var ReactEventEmitter = _dereq_("./ReactEventEmitter");
+
+var mixInto = _dereq_("./mixInto");
+
+function ReactPutListenerQueue() {
+  this.listenersToPut = [];
+}
+
+mixInto(ReactPutListenerQueue, {
+  enqueuePutListener: function(rootNodeID, propKey, propValue) {
+    this.listenersToPut.push({
+      rootNodeID: rootNodeID,
+      propKey: propKey,
+      propValue: propValue
+    });
+  },
+
+  putListeners: function() {
+    for (var i = 0; i < this.listenersToPut.length; i++) {
+      var listenerToPut = this.listenersToPut[i];
+      ReactEventEmitter.putListener(
+        listenerToPut.rootNodeID,
+        listenerToPut.propKey,
+        listenerToPut.propValue
+      );
+    }
+  },
+
+  reset: function() {
+    this.listenersToPut.length = 0;
+  },
+
+  destructor: function() {
+    this.reset();
+  }
+});
+
+PooledClass.addPoolingTo(ReactPutListenerQueue);
+
+module.exports = ReactPutListenerQueue;
+
+},{"./PooledClass":23,"./ReactEventEmitter":48,"./mixInto":124}],66:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactReconcileTransaction
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var PooledClass = _dereq_("./PooledClass");
+var ReactEventEmitter = _dereq_("./ReactEventEmitter");
+var ReactInputSelection = _dereq_("./ReactInputSelection");
+var ReactMountReady = _dereq_("./ReactMountReady");
+var ReactPutListenerQueue = _dereq_("./ReactPutListenerQueue");
+var Transaction = _dereq_("./Transaction");
+
+var mixInto = _dereq_("./mixInto");
+
+/**
+ * Ensures that, when possible, the selection range (currently selected text
+ * input) is not disturbed by performing the transaction.
+ */
+var SELECTION_RESTORATION = {
+  /**
+   * @return {Selection} Selection information.
+   */
+  initialize: ReactInputSelection.getSelectionInformation,
+  /**
+   * @param {Selection} sel Selection information returned from `initialize`.
+   */
+  close: ReactInputSelection.restoreSelection
+};
+
+/**
+ * Suppresses events (blur/focus) that could be inadvertently dispatched due to
+ * high level DOM manipulations (like temporarily removing a text input from the
+ * DOM).
+ */
+var EVENT_SUPPRESSION = {
+  /**
+   * @return {boolean} The enabled status of `ReactEventEmitter` before the
+   * reconciliation.
+   */
+  initialize: function() {
+    var currentlyEnabled = ReactEventEmitter.isEnabled();
+    ReactEventEmitter.setEnabled(false);
+    return currentlyEnabled;
+  },
+
+  /**
+   * @param {boolean} previouslyEnabled Enabled status of `ReactEventEmitter`
+   *   before the reconciliation occured. `close` restores the previous value.
+   */
+  close: function(previouslyEnabled) {
+    ReactEventEmitter.setEnabled(previouslyEnabled);
+  }
+};
+
+/**
+ * Provides a `ReactMountReady` queue for collecting `onDOMReady` callbacks
+ * during the performing of the transaction.
+ */
+var ON_DOM_READY_QUEUEING = {
+  /**
+   * Initializes the internal `onDOMReady` queue.
+   */
+  initialize: function() {
+    this.reactMountReady.reset();
+  },
+
+  /**
+   * After DOM is flushed, invoke all registered `onDOMReady` callbacks.
+   */
+  close: function() {
+    this.reactMountReady.notifyAll();
+  }
+};
+
+var PUT_LISTENER_QUEUEING = {
+  initialize: function() {
+    this.putListenerQueue.reset();
+  },
+
+  close: function() {
+    this.putListenerQueue.putListeners();
+  }
+};
+
+/**
+ * Executed within the scope of the `Transaction` instance. Consider these as
+ * being member methods, but with an implied ordering while being isolated from
+ * each other.
+ */
+var TRANSACTION_WRAPPERS = [
+  PUT_LISTENER_QUEUEING,
+  SELECTION_RESTORATION,
+  EVENT_SUPPRESSION,
+  ON_DOM_READY_QUEUEING
+];
+
+/**
+ * Currently:
+ * - The order that these are listed in the transaction is critical:
+ * - Suppresses events.
+ * - Restores selection range.
+ *
+ * Future:
+ * - Restore document/overflow scroll positions that were unintentionally
+ *   modified via DOM insertions above the top viewport boundary.
+ * - Implement/integrate with customized constraint based layout system and keep
+ *   track of which dimensions must be remeasured.
+ *
+ * @class ReactReconcileTransaction
+ */
+function ReactReconcileTransaction() {
+  this.reinitializeTransaction();
+  // Only server-side rendering really needs this option (see
+  // `ReactServerRendering`), but server-side uses
+  // `ReactServerRenderingTransaction` instead. This option is here so that it's
+  // accessible and defaults to false when `ReactDOMComponent` and
+  // `ReactTextComponent` checks it in `mountComponent`.`
+  this.renderToStaticMarkup = false;
+  this.reactMountReady = ReactMountReady.getPooled(null);
+  this.putListenerQueue = ReactPutListenerQueue.getPooled();
+}
+
+var Mixin = {
+  /**
+   * @see Transaction
+   * @abstract
+   * @final
+   * @return {array<object>} List of operation wrap proceedures.
+   *   TODO: convert to array<TransactionWrapper>
+   */
+  getTransactionWrappers: function() {
+    return TRANSACTION_WRAPPERS;
+  },
+
+  /**
+   * @return {object} The queue to collect `onDOMReady` callbacks with.
+   *   TODO: convert to ReactMountReady
+   */
+  getReactMountReady: function() {
+    return this.reactMountReady;
+  },
+
+  getPutListenerQueue: function() {
+    return this.putListenerQueue;
+  },
+
+  /**
+   * `PooledClass` looks for this, and will invoke this before allowing this
+   * instance to be resused.
+   */
+  destructor: function() {
+    ReactMountReady.release(this.reactMountReady);
+    this.reactMountReady = null;
+
+    ReactPutListenerQueue.release(this.putListenerQueue);
+    this.putListenerQueue = null;
+  }
+};
+
+
+mixInto(ReactReconcileTransaction, Transaction.Mixin);
+mixInto(ReactReconcileTransaction, Mixin);
+
+PooledClass.addPoolingTo(ReactReconcileTransaction);
+
+module.exports = ReactReconcileTransaction;
+
+},{"./PooledClass":23,"./ReactEventEmitter":48,"./ReactInputSelection":52,"./ReactMountReady":56,"./ReactPutListenerQueue":65,"./Transaction":85,"./mixInto":124}],67:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactRootIndex
+ * @typechecks
+ */
+
+"use strict";
+
+var ReactRootIndexInjection = {
+  /**
+   * @param {function} _createReactRootIndex
+   */
+  injectCreateReactRootIndex: function(_createReactRootIndex) {
+    ReactRootIndex.createReactRootIndex = _createReactRootIndex;
+  }
+};
+
+var ReactRootIndex = {
+  createReactRootIndex: null,
+  injection: ReactRootIndexInjection
+};
+
+module.exports = ReactRootIndex;
+
+},{}],68:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @typechecks static-only
+ * @providesModule ReactServerRendering
+ */
+"use strict";
+
+var ReactComponent = _dereq_("./ReactComponent");
+var ReactInstanceHandles = _dereq_("./ReactInstanceHandles");
+var ReactMarkupChecksum = _dereq_("./ReactMarkupChecksum");
+var ReactServerRenderingTransaction =
+  _dereq_("./ReactServerRenderingTransaction");
+
+var instantiateReactComponent = _dereq_("./instantiateReactComponent");
+var invariant = _dereq_("./invariant");
+
+/**
+ * @param {ReactComponent} component
+ * @return {string} the HTML markup
+ */
+function renderComponentToString(component) {
+  ("production" !== "development" ? invariant(
+    ReactComponent.isValidComponent(component),
+    'renderComponentToString(): You must pass a valid ReactComponent.'
+  ) : invariant(ReactComponent.isValidComponent(component)));
+
+  ("production" !== "development" ? invariant(
+    !(arguments.length === 2 && typeof arguments[1] === 'function'),
+    'renderComponentToString(): This function became synchronous and now ' +
+    'returns the generated markup. Please remove the second parameter.'
+  ) : invariant(!(arguments.length === 2 && typeof arguments[1] === 'function')));
+
+  var transaction;
+  try {
+    var id = ReactInstanceHandles.createReactRootID();
+    transaction = ReactServerRenderingTransaction.getPooled(false);
+
+    return transaction.perform(function() {
+      var componentInstance = instantiateReactComponent(component);
+      var markup = componentInstance.mountComponent(id, transaction, 0);
+      return ReactMarkupChecksum.addChecksumToMarkup(markup);
+    }, null);
+  } finally {
+    ReactServerRenderingTransaction.release(transaction);
+  }
+}
+
+/**
+ * @param {ReactComponent} component
+ * @return {string} the HTML markup, without the extra React ID and checksum
+* (for generating static pages)
+ */
+function renderComponentToStaticMarkup(component) {
+  ("production" !== "development" ? invariant(
+    ReactComponent.isValidComponent(component),
+    'renderComponentToStaticMarkup(): You must pass a valid ReactComponent.'
+  ) : invariant(ReactComponent.isValidComponent(component)));
+
+  var transaction;
+  try {
+    var id = ReactInstanceHandles.createReactRootID();
+    transaction = ReactServerRenderingTransaction.getPooled(true);
+
+    return transaction.perform(function() {
+      var componentInstance = instantiateReactComponent(component);
+      return componentInstance.mountComponent(id, transaction, 0);
+    }, null);
+  } finally {
+    ReactServerRenderingTransaction.release(transaction);
+  }
+}
+
+module.exports = {
+  renderComponentToString: renderComponentToString,
+  renderComponentToStaticMarkup: renderComponentToStaticMarkup
+};
+
+},{"./ReactComponent":27,"./ReactInstanceHandles":53,"./ReactMarkupChecksum":54,"./ReactServerRenderingTransaction":69,"./instantiateReactComponent":111,"./invariant":112}],69:[function(_dereq_,module,exports){
+/**
+ * Copyright 2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactServerRenderingTransaction
+ * @typechecks
+ */
+
+"use strict";
+
+var PooledClass = _dereq_("./PooledClass");
+var ReactMountReady = _dereq_("./ReactMountReady");
+var ReactPutListenerQueue = _dereq_("./ReactPutListenerQueue");
+var Transaction = _dereq_("./Transaction");
+
+var emptyFunction = _dereq_("./emptyFunction");
+var mixInto = _dereq_("./mixInto");
+
+/**
+ * Provides a `ReactMountReady` queue for collecting `onDOMReady` callbacks
+ * during the performing of the transaction.
+ */
+var ON_DOM_READY_QUEUEING = {
+  /**
+   * Initializes the internal `onDOMReady` queue.
+   */
+  initialize: function() {
+    this.reactMountReady.reset();
+  },
+
+  close: emptyFunction
+};
+
+var PUT_LISTENER_QUEUEING = {
+  initialize: function() {
+    this.putListenerQueue.reset();
+  },
+
+  close: emptyFunction
+};
+
+/**
+ * Executed within the scope of the `Transaction` instance. Consider these as
+ * being member methods, but with an implied ordering while being isolated from
+ * each other.
+ */
+var TRANSACTION_WRAPPERS = [
+  PUT_LISTENER_QUEUEING,
+  ON_DOM_READY_QUEUEING
+];
+
+/**
+ * @class ReactServerRenderingTransaction
+ * @param {boolean} renderToStaticMarkup
+ */
+function ReactServerRenderingTransaction(renderToStaticMarkup) {
+  this.reinitializeTransaction();
+  this.renderToStaticMarkup = renderToStaticMarkup;
+  this.reactMountReady = ReactMountReady.getPooled(null);
+  this.putListenerQueue = ReactPutListenerQueue.getPooled();
+}
+
+var Mixin = {
+  /**
+   * @see Transaction
+   * @abstract
+   * @final
+   * @return {array} Empty list of operation wrap proceedures.
+   */
+  getTransactionWrappers: function() {
+    return TRANSACTION_WRAPPERS;
+  },
+
+  /**
+   * @return {object} The queue to collect `onDOMReady` callbacks with.
+   *   TODO: convert to ReactMountReady
+   */
+  getReactMountReady: function() {
+    return this.reactMountReady;
+  },
+
+  getPutListenerQueue: function() {
+    return this.putListenerQueue;
+  },
+
+  /**
+   * `PooledClass` looks for this, and will invoke this before allowing this
+   * instance to be resused.
+   */
+  destructor: function() {
+    ReactMountReady.release(this.reactMountReady);
+    this.reactMountReady = null;
+
+    ReactPutListenerQueue.release(this.putListenerQueue);
+    this.putListenerQueue = null;
+  }
+};
+
+
+mixInto(ReactServerRenderingTransaction, Transaction.Mixin);
+mixInto(ReactServerRenderingTransaction, Mixin);
+
+PooledClass.addPoolingTo(ReactServerRenderingTransaction);
+
+module.exports = ReactServerRenderingTransaction;
+
+},{"./PooledClass":23,"./ReactMountReady":56,"./ReactPutListenerQueue":65,"./Transaction":85,"./emptyFunction":96,"./mixInto":124}],70:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactTextComponent
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var DOMPropertyOperations = _dereq_("./DOMPropertyOperations");
+var ReactBrowserComponentMixin = _dereq_("./ReactBrowserComponentMixin");
+var ReactComponent = _dereq_("./ReactComponent");
+
+var escapeTextForBrowser = _dereq_("./escapeTextForBrowser");
+var mixInto = _dereq_("./mixInto");
+
+/**
+ * Text nodes violate a couple assumptions that React makes about components:
+ *
+ *  - When mounting text into the DOM, adjacent text nodes are merged.
+ *  - Text nodes cannot be assigned a React root ID.
+ *
+ * This component is used to wrap strings in elements so that they can undergo
+ * the same reconciliation that is applied to elements.
+ *
+ * TODO: Investigate representing React components in the DOM with text nodes.
+ *
+ * @class ReactTextComponent
+ * @extends ReactComponent
+ * @internal
+ */
+var ReactTextComponent = function(initialText) {
+  this.construct({text: initialText});
+};
+
+/**
+ * Used to clone the text descriptor object before it's mounted.
+ *
+ * @param {object} props
+ * @return {object} A new ReactTextComponent instance
+ */
+ReactTextComponent.ConvenienceConstructor = function(props) {
+  return new ReactTextComponent(props.text);
+};
+
+mixInto(ReactTextComponent, ReactComponent.Mixin);
+mixInto(ReactTextComponent, ReactBrowserComponentMixin);
+mixInto(ReactTextComponent, {
+
+  /**
+   * Creates the markup for this text node. This node is not intended to have
+   * any features besides containing text content.
+   *
+   * @param {string} rootID DOM ID of the root node.
+   * @param {ReactReconcileTransaction|ReactServerRenderingTransaction} transaction
+   * @param {number} mountDepth number of components in the owner hierarchy
+   * @return {string} Markup for this text node.
+   * @internal
+   */
+  mountComponent: function(rootID, transaction, mountDepth) {
+    ReactComponent.Mixin.mountComponent.call(
+      this,
+      rootID,
+      transaction,
+      mountDepth
+    );
+
+    var escapedText = escapeTextForBrowser(this.props.text);
+
+    if (transaction.renderToStaticMarkup) {
+      // Normally we'd wrap this in a `span` for the reasons stated above, but
+      // since this is a situation where React won't take over (static pages),
+      // we can simply return the text as it is.
+      return escapedText;
+    }
+
+    return (
+      '<span ' + DOMPropertyOperations.createMarkupForID(rootID) + '>' +
+        escapedText +
+      '</span>'
+    );
+  },
+
+  /**
+   * Updates this component by updating the text content.
+   *
+   * @param {object} nextComponent Contains the next text content.
+   * @param {ReactReconcileTransaction} transaction
+   * @internal
+   */
+  receiveComponent: function(nextComponent, transaction) {
+    var nextProps = nextComponent.props;
+    if (nextProps.text !== this.props.text) {
+      this.props.text = nextProps.text;
+      ReactComponent.BackendIDOperations.updateTextContentByID(
+        this._rootNodeID,
+        nextProps.text
+      );
+    }
+  }
+
+});
+
+// Expose the constructor on itself and the prototype for consistency with other
+// descriptors.
+ReactTextComponent.type = ReactTextComponent;
+ReactTextComponent.prototype.type = ReactTextComponent;
+
+module.exports = ReactTextComponent;
+
+},{"./DOMPropertyOperations":9,"./ReactBrowserComponentMixin":25,"./ReactComponent":27,"./escapeTextForBrowser":98,"./mixInto":124}],71:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ReactUpdates
+ */
+
+"use strict";
+
+var ReactPerf = _dereq_("./ReactPerf");
+
+var invariant = _dereq_("./invariant");
+
+var dirtyComponents = [];
+
+var batchingStrategy = null;
+
+function ensureBatchingStrategy() {
+  ("production" !== "development" ? invariant(batchingStrategy, 'ReactUpdates: must inject a batching strategy') : invariant(batchingStrategy));
+}
+
+function batchedUpdates(callback, param) {
+  ensureBatchingStrategy();
+  batchingStrategy.batchedUpdates(callback, param);
+}
+
+/**
+ * Array comparator for ReactComponents by owner depth
+ *
+ * @param {ReactComponent} c1 first component you're comparing
+ * @param {ReactComponent} c2 second component you're comparing
+ * @return {number} Return value usable by Array.prototype.sort().
+ */
+function mountDepthComparator(c1, c2) {
+  return c1._mountDepth - c2._mountDepth;
+}
+
+function runBatchedUpdates() {
+  // Since reconciling a component higher in the owner hierarchy usually (not
+  // always -- see shouldComponentUpdate()) will reconcile children, reconcile
+  // them before their children by sorting the array.
+
+  dirtyComponents.sort(mountDepthComparator);
+
+  for (var i = 0; i < dirtyComponents.length; i++) {
+    // If a component is unmounted before pending changes apply, ignore them
+    // TODO: Queue unmounts in the same list to avoid this happening at all
+    var component = dirtyComponents[i];
+    if (component.isMounted()) {
+      // If performUpdateIfNecessary happens to enqueue any new updates, we
+      // shouldn't execute the callbacks until the next render happens, so
+      // stash the callbacks first
+      var callbacks = component._pendingCallbacks;
+      component._pendingCallbacks = null;
+      component.performUpdateIfNecessary();
+      if (callbacks) {
+        for (var j = 0; j < callbacks.length; j++) {
+          callbacks[j].call(component);
+        }
+      }
+    }
+  }
+}
+
+function clearDirtyComponents() {
+  dirtyComponents.length = 0;
+}
+
+var flushBatchedUpdates = ReactPerf.measure(
+  'ReactUpdates',
+  'flushBatchedUpdates',
+  function() {
+    // Run these in separate functions so the JIT can optimize
+    try {
+      runBatchedUpdates();
+    } finally {
+      clearDirtyComponents();
+    }
+  }
+);
+
+/**
+ * Mark a component as needing a rerender, adding an optional callback to a
+ * list of functions which will be executed once the rerender occurs.
+ */
+function enqueueUpdate(component, callback) {
+  ("production" !== "development" ? invariant(
+    !callback || typeof callback === "function",
+    'enqueueUpdate(...): You called `setProps`, `replaceProps`, ' +
+    '`setState`, `replaceState`, or `forceUpdate` with a callback that ' +
+    'isn\'t callable.'
+  ) : invariant(!callback || typeof callback === "function"));
+  ensureBatchingStrategy();
+
+  if (!batchingStrategy.isBatchingUpdates) {
+    component.performUpdateIfNecessary();
+    callback && callback.call(component);
+    return;
+  }
+
+  dirtyComponents.push(component);
+
+  if (callback) {
+    if (component._pendingCallbacks) {
+      component._pendingCallbacks.push(callback);
+    } else {
+      component._pendingCallbacks = [callback];
+    }
+  }
+}
+
+var ReactUpdatesInjection = {
+  injectBatchingStrategy: function(_batchingStrategy) {
+    ("production" !== "development" ? invariant(
+      _batchingStrategy,
+      'ReactUpdates: must provide a batching strategy'
+    ) : invariant(_batchingStrategy));
+    ("production" !== "development" ? invariant(
+      typeof _batchingStrategy.batchedUpdates === 'function',
+      'ReactUpdates: must provide a batchedUpdates() function'
+    ) : invariant(typeof _batchingStrategy.batchedUpdates === 'function'));
+    ("production" !== "development" ? invariant(
+      typeof _batchingStrategy.isBatchingUpdates === 'boolean',
+      'ReactUpdates: must provide an isBatchingUpdates boolean attribute'
+    ) : invariant(typeof _batchingStrategy.isBatchingUpdates === 'boolean'));
+    batchingStrategy = _batchingStrategy;
+  }
+};
+
+var ReactUpdates = {
+  batchedUpdates: batchedUpdates,
+  enqueueUpdate: enqueueUpdate,
+  flushBatchedUpdates: flushBatchedUpdates,
+  injection: ReactUpdatesInjection
+};
+
+module.exports = ReactUpdates;
+
+},{"./ReactPerf":60,"./invariant":112}],72:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule SelectEventPlugin
+ */
+
+"use strict";
+
+var EventConstants = _dereq_("./EventConstants");
+var EventPropagators = _dereq_("./EventPropagators");
+var ReactInputSelection = _dereq_("./ReactInputSelection");
+var SyntheticEvent = _dereq_("./SyntheticEvent");
+
+var getActiveElement = _dereq_("./getActiveElement");
+var isTextInputElement = _dereq_("./isTextInputElement");
+var keyOf = _dereq_("./keyOf");
+var shallowEqual = _dereq_("./shallowEqual");
+
+var topLevelTypes = EventConstants.topLevelTypes;
+
+var eventTypes = {
+  select: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onSelect: null}),
+      captured: keyOf({onSelectCapture: null})
+    },
+    dependencies: [
+      topLevelTypes.topBlur,
+      topLevelTypes.topContextMenu,
+      topLevelTypes.topFocus,
+      topLevelTypes.topKeyDown,
+      topLevelTypes.topMouseDown,
+      topLevelTypes.topMouseUp,
+      topLevelTypes.topSelectionChange
+    ]
+  }
+};
+
+var activeElement = null;
+var activeElementID = null;
+var lastSelection = null;
+var mouseDown = false;
+
+/**
+ * Get an object which is a unique representation of the current selection.
+ *
+ * The return value will not be consistent across nodes or browsers, but
+ * two identical selections on the same node will return identical objects.
+ *
+ * @param {DOMElement} node
+ * @param {object}
+ */
+function getSelection(node) {
+  if ('selectionStart' in node &&
+      ReactInputSelection.hasSelectionCapabilities(node)) {
+    return {
+      start: node.selectionStart,
+      end: node.selectionEnd
+    };
+  } else if (document.selection) {
+    var range = document.selection.createRange();
+    return {
+      parentElement: range.parentElement(),
+      text: range.text,
+      top: range.boundingTop,
+      left: range.boundingLeft
+    };
+  } else {
+    var selection = window.getSelection();
+    return {
+      anchorNode: selection.anchorNode,
+      anchorOffset: selection.anchorOffset,
+      focusNode: selection.focusNode,
+      focusOffset: selection.focusOffset
+    };
+  }
+}
+
+/**
+ * Poll selection to see whether it's changed.
+ *
+ * @param {object} nativeEvent
+ * @return {?SyntheticEvent}
+ */
+function constructSelectEvent(nativeEvent) {
+  // Ensure we have the right element, and that the user is not dragging a
+  // selection (this matches native `select` event behavior). In HTML5, select
+  // fires only on input and textarea thus if there's no focused element we
+  // won't dispatch.
+  if (mouseDown ||
+      activeElement == null ||
+      activeElement != getActiveElement()) {
+    return;
+  }
+
+  // Only fire when selection has actually changed.
+  var currentSelection = getSelection(activeElement);
+  if (!lastSelection || !shallowEqual(lastSelection, currentSelection)) {
+    lastSelection = currentSelection;
+
+    var syntheticEvent = SyntheticEvent.getPooled(
+      eventTypes.select,
+      activeElementID,
+      nativeEvent
+    );
+
+    syntheticEvent.type = 'select';
+    syntheticEvent.target = activeElement;
+
+    EventPropagators.accumulateTwoPhaseDispatches(syntheticEvent);
+
+    return syntheticEvent;
+  }
+}
+
+/**
+ * This plugin creates an `onSelect` event that normalizes select events
+ * across form elements.
+ *
+ * Supported elements are:
+ * - input (see `isTextInputElement`)
+ * - textarea
+ * - contentEditable
+ *
+ * This differs from native browser implementations in the following ways:
+ * - Fires on contentEditable fields as well as inputs.
+ * - Fires for collapsed selection.
+ * - Fires after user input.
+ */
+var SelectEventPlugin = {
+
+  eventTypes: eventTypes,
+
+  /**
+   * @param {string} topLevelType Record from `EventConstants`.
+   * @param {DOMEventTarget} topLevelTarget The listening component root node.
+   * @param {string} topLevelTargetID ID of `topLevelTarget`.
+   * @param {object} nativeEvent Native browser event.
+   * @return {*} An accumulation of synthetic events.
+   * @see {EventPluginHub.extractEvents}
+   */
+  extractEvents: function(
+      topLevelType,
+      topLevelTarget,
+      topLevelTargetID,
+      nativeEvent) {
+
+    switch (topLevelType) {
+      // Track the input node that has focus.
+      case topLevelTypes.topFocus:
+        if (isTextInputElement(topLevelTarget) ||
+            topLevelTarget.contentEditable === 'true') {
+          activeElement = topLevelTarget;
+          activeElementID = topLevelTargetID;
+          lastSelection = null;
+        }
+        break;
+      case topLevelTypes.topBlur:
+        activeElement = null;
+        activeElementID = null;
+        lastSelection = null;
+        break;
+
+      // Don't fire the event while the user is dragging. This matches the
+      // semantics of the native select event.
+      case topLevelTypes.topMouseDown:
+        mouseDown = true;
+        break;
+      case topLevelTypes.topContextMenu:
+      case topLevelTypes.topMouseUp:
+        mouseDown = false;
+        return constructSelectEvent(nativeEvent);
+
+      // Chrome and IE fire non-standard event when selection is changed (and
+      // sometimes when it hasn't).
+      // Firefox doesn't support selectionchange, so check selection status
+      // after each key entry. The selection changes after keydown and before
+      // keyup, but we check on keydown as well in the case of holding down a
+      // key, when multiple keydown events are fired but only one keyup is.
+      case topLevelTypes.topSelectionChange:
+      case topLevelTypes.topKeyDown:
+      case topLevelTypes.topKeyUp:
+        return constructSelectEvent(nativeEvent);
+    }
+  }
+};
+
+module.exports = SelectEventPlugin;
+
+},{"./EventConstants":14,"./EventPropagators":19,"./ReactInputSelection":52,"./SyntheticEvent":78,"./getActiveElement":102,"./isTextInputElement":115,"./keyOf":119,"./shallowEqual":130}],73:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ServerReactRootIndex
+ * @typechecks
+ */
+
+"use strict";
+
+/**
+ * Size of the reactRoot ID space. We generate random numbers for React root
+ * IDs and if there's a collision the events and DOM update system will
+ * get confused. In the future we need a way to generate GUIDs but for
+ * now this will work on a smaller scale.
+ */
+var GLOBAL_MOUNT_POINT_MAX = Math.pow(2, 53);
+
+var ServerReactRootIndex = {
+  createReactRootIndex: function() {
+    return Math.ceil(Math.random() * GLOBAL_MOUNT_POINT_MAX);
+  }
+};
+
+module.exports = ServerReactRootIndex;
+
+},{}],74:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule SimpleEventPlugin
+ */
+
+"use strict";
+
+var EventConstants = _dereq_("./EventConstants");
+var EventPluginUtils = _dereq_("./EventPluginUtils");
+var EventPropagators = _dereq_("./EventPropagators");
+var SyntheticClipboardEvent = _dereq_("./SyntheticClipboardEvent");
+var SyntheticEvent = _dereq_("./SyntheticEvent");
+var SyntheticFocusEvent = _dereq_("./SyntheticFocusEvent");
+var SyntheticKeyboardEvent = _dereq_("./SyntheticKeyboardEvent");
+var SyntheticMouseEvent = _dereq_("./SyntheticMouseEvent");
+var SyntheticDragEvent = _dereq_("./SyntheticDragEvent");
+var SyntheticTouchEvent = _dereq_("./SyntheticTouchEvent");
+var SyntheticUIEvent = _dereq_("./SyntheticUIEvent");
+var SyntheticWheelEvent = _dereq_("./SyntheticWheelEvent");
+
+var invariant = _dereq_("./invariant");
+var keyOf = _dereq_("./keyOf");
+
+var topLevelTypes = EventConstants.topLevelTypes;
+
+var eventTypes = {
+  blur: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onBlur: true}),
+      captured: keyOf({onBlurCapture: true})
+    }
+  },
+  click: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onClick: true}),
+      captured: keyOf({onClickCapture: true})
+    }
+  },
+  contextMenu: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onContextMenu: true}),
+      captured: keyOf({onContextMenuCapture: true})
+    }
+  },
+  copy: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onCopy: true}),
+      captured: keyOf({onCopyCapture: true})
+    }
+  },
+  cut: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onCut: true}),
+      captured: keyOf({onCutCapture: true})
+    }
+  },
+  doubleClick: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onDoubleClick: true}),
+      captured: keyOf({onDoubleClickCapture: true})
+    }
+  },
+  drag: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onDrag: true}),
+      captured: keyOf({onDragCapture: true})
+    }
+  },
+  dragEnd: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onDragEnd: true}),
+      captured: keyOf({onDragEndCapture: true})
+    }
+  },
+  dragEnter: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onDragEnter: true}),
+      captured: keyOf({onDragEnterCapture: true})
+    }
+  },
+  dragExit: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onDragExit: true}),
+      captured: keyOf({onDragExitCapture: true})
+    }
+  },
+  dragLeave: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onDragLeave: true}),
+      captured: keyOf({onDragLeaveCapture: true})
+    }
+  },
+  dragOver: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onDragOver: true}),
+      captured: keyOf({onDragOverCapture: true})
+    }
+  },
+  dragStart: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onDragStart: true}),
+      captured: keyOf({onDragStartCapture: true})
+    }
+  },
+  drop: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onDrop: true}),
+      captured: keyOf({onDropCapture: true})
+    }
+  },
+  focus: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onFocus: true}),
+      captured: keyOf({onFocusCapture: true})
+    }
+  },
+  input: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onInput: true}),
+      captured: keyOf({onInputCapture: true})
+    }
+  },
+  keyDown: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onKeyDown: true}),
+      captured: keyOf({onKeyDownCapture: true})
+    }
+  },
+  keyPress: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onKeyPress: true}),
+      captured: keyOf({onKeyPressCapture: true})
+    }
+  },
+  keyUp: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onKeyUp: true}),
+      captured: keyOf({onKeyUpCapture: true})
+    }
+  },
+  load: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onLoad: true}),
+      captured: keyOf({onLoadCapture: true})
+    }
+  },
+  error: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onError: true}),
+      captured: keyOf({onErrorCapture: true})
+    }
+  },
+  // Note: We do not allow listening to mouseOver events. Instead, use the
+  // onMouseEnter/onMouseLeave created by `EnterLeaveEventPlugin`.
+  mouseDown: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onMouseDown: true}),
+      captured: keyOf({onMouseDownCapture: true})
+    }
+  },
+  mouseMove: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onMouseMove: true}),
+      captured: keyOf({onMouseMoveCapture: true})
+    }
+  },
+  mouseOut: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onMouseOut: true}),
+      captured: keyOf({onMouseOutCapture: true})
+    }
+  },
+  mouseOver: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onMouseOver: true}),
+      captured: keyOf({onMouseOverCapture: true})
+    }
+  },
+  mouseUp: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onMouseUp: true}),
+      captured: keyOf({onMouseUpCapture: true})
+    }
+  },
+  paste: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onPaste: true}),
+      captured: keyOf({onPasteCapture: true})
+    }
+  },
+  reset: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onReset: true}),
+      captured: keyOf({onResetCapture: true})
+    }
+  },
+  scroll: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onScroll: true}),
+      captured: keyOf({onScrollCapture: true})
+    }
+  },
+  submit: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onSubmit: true}),
+      captured: keyOf({onSubmitCapture: true})
+    }
+  },
+  touchCancel: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onTouchCancel: true}),
+      captured: keyOf({onTouchCancelCapture: true})
+    }
+  },
+  touchEnd: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onTouchEnd: true}),
+      captured: keyOf({onTouchEndCapture: true})
+    }
+  },
+  touchMove: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onTouchMove: true}),
+      captured: keyOf({onTouchMoveCapture: true})
+    }
+  },
+  touchStart: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onTouchStart: true}),
+      captured: keyOf({onTouchStartCapture: true})
+    }
+  },
+  wheel: {
+    phasedRegistrationNames: {
+      bubbled: keyOf({onWheel: true}),
+      captured: keyOf({onWheelCapture: true})
+    }
+  }
+};
+
+var topLevelEventsToDispatchConfig = {
+  topBlur:        eventTypes.blur,
+  topClick:       eventTypes.click,
+  topContextMenu: eventTypes.contextMenu,
+  topCopy:        eventTypes.copy,
+  topCut:         eventTypes.cut,
+  topDoubleClick: eventTypes.doubleClick,
+  topDrag:        eventTypes.drag,
+  topDragEnd:     eventTypes.dragEnd,
+  topDragEnter:   eventTypes.dragEnter,
+  topDragExit:    eventTypes.dragExit,
+  topDragLeave:   eventTypes.dragLeave,
+  topDragOver:    eventTypes.dragOver,
+  topDragStart:   eventTypes.dragStart,
+  topDrop:        eventTypes.drop,
+  topError:       eventTypes.error,
+  topFocus:       eventTypes.focus,
+  topInput:       eventTypes.input,
+  topKeyDown:     eventTypes.keyDown,
+  topKeyPress:    eventTypes.keyPress,
+  topKeyUp:       eventTypes.keyUp,
+  topLoad:        eventTypes.load,
+  topMouseDown:   eventTypes.mouseDown,
+  topMouseMove:   eventTypes.mouseMove,
+  topMouseOut:    eventTypes.mouseOut,
+  topMouseOver:   eventTypes.mouseOver,
+  topMouseUp:     eventTypes.mouseUp,
+  topPaste:       eventTypes.paste,
+  topReset:       eventTypes.reset,
+  topScroll:      eventTypes.scroll,
+  topSubmit:      eventTypes.submit,
+  topTouchCancel: eventTypes.touchCancel,
+  topTouchEnd:    eventTypes.touchEnd,
+  topTouchMove:   eventTypes.touchMove,
+  topTouchStart:  eventTypes.touchStart,
+  topWheel:       eventTypes.wheel
+};
+
+for (var topLevelType in topLevelEventsToDispatchConfig) {
+  topLevelEventsToDispatchConfig[topLevelType].dependencies = [topLevelType];
+}
+
+var SimpleEventPlugin = {
+
+  eventTypes: eventTypes,
+
+  /**
+   * Same as the default implementation, except cancels the event when return
+   * value is false.
+   *
+   * @param {object} Event to be dispatched.
+   * @param {function} Application-level callback.
+   * @param {string} domID DOM ID to pass to the callback.
+   */
+  executeDispatch: function(event, listener, domID) {
+    var returnValue = EventPluginUtils.executeDispatch(event, listener, domID);
+    if (returnValue === false) {
+      event.stopPropagation();
+      event.preventDefault();
+    }
+  },
+
+  /**
+   * @param {string} topLevelType Record from `EventConstants`.
+   * @param {DOMEventTarget} topLevelTarget The listening component root node.
+   * @param {string} topLevelTargetID ID of `topLevelTarget`.
+   * @param {object} nativeEvent Native browser event.
+   * @return {*} An accumulation of synthetic events.
+   * @see {EventPluginHub.extractEvents}
+   */
+  extractEvents: function(
+      topLevelType,
+      topLevelTarget,
+      topLevelTargetID,
+      nativeEvent) {
+    var dispatchConfig = topLevelEventsToDispatchConfig[topLevelType];
+    if (!dispatchConfig) {
+      return null;
+    }
+    var EventConstructor;
+    switch (topLevelType) {
+      case topLevelTypes.topInput:
+      case topLevelTypes.topLoad:
+      case topLevelTypes.topError:
+      case topLevelTypes.topReset:
+      case topLevelTypes.topSubmit:
+        // HTML Events
+        // @see http://www.w3.org/TR/html5/index.html#events-0
+        EventConstructor = SyntheticEvent;
+        break;
+      case topLevelTypes.topKeyDown:
+      case topLevelTypes.topKeyPress:
+      case topLevelTypes.topKeyUp:
+        EventConstructor = SyntheticKeyboardEvent;
+        break;
+      case topLevelTypes.topBlur:
+      case topLevelTypes.topFocus:
+        EventConstructor = SyntheticFocusEvent;
+        break;
+      case topLevelTypes.topClick:
+        // Firefox creates a click event on right mouse clicks. This removes the
+        // unwanted click events.
+        if (nativeEvent.button === 2) {
+          return null;
+        }
+        /* falls through */
+      case topLevelTypes.topContextMenu:
+      case topLevelTypes.topDoubleClick:
+      case topLevelTypes.topMouseDown:
+      case topLevelTypes.topMouseMove:
+      case topLevelTypes.topMouseOut:
+      case topLevelTypes.topMouseOver:
+      case topLevelTypes.topMouseUp:
+        EventConstructor = SyntheticMouseEvent;
+        break;
+      case topLevelTypes.topDrag:
+      case topLevelTypes.topDragEnd:
+      case topLevelTypes.topDragEnter:
+      case topLevelTypes.topDragExit:
+      case topLevelTypes.topDragLeave:
+      case topLevelTypes.topDragOver:
+      case topLevelTypes.topDragStart:
+      case topLevelTypes.topDrop:
+        EventConstructor = SyntheticDragEvent;
+        break;
+      case topLevelTypes.topTouchCancel:
+      case topLevelTypes.topTouchEnd:
+      case topLevelTypes.topTouchMove:
+      case topLevelTypes.topTouchStart:
+        EventConstructor = SyntheticTouchEvent;
+        break;
+      case topLevelTypes.topScroll:
+        EventConstructor = SyntheticUIEvent;
+        break;
+      case topLevelTypes.topWheel:
+        EventConstructor = SyntheticWheelEvent;
+        break;
+      case topLevelTypes.topCopy:
+      case topLevelTypes.topCut:
+      case topLevelTypes.topPaste:
+        EventConstructor = SyntheticClipboardEvent;
+        break;
+    }
+    ("production" !== "development" ? invariant(
+      EventConstructor,
+      'SimpleEventPlugin: Unhandled event type, `%s`.',
+      topLevelType
+    ) : invariant(EventConstructor));
+    var event = EventConstructor.getPooled(
+      dispatchConfig,
+      topLevelTargetID,
+      nativeEvent
+    );
+    EventPropagators.accumulateTwoPhaseDispatches(event);
+    return event;
+  }
+
+};
+
+module.exports = SimpleEventPlugin;
+
+},{"./EventConstants":14,"./EventPluginUtils":18,"./EventPropagators":19,"./SyntheticClipboardEvent":75,"./SyntheticDragEvent":77,"./SyntheticEvent":78,"./SyntheticFocusEvent":79,"./SyntheticKeyboardEvent":80,"./SyntheticMouseEvent":81,"./SyntheticTouchEvent":82,"./SyntheticUIEvent":83,"./SyntheticWheelEvent":84,"./invariant":112,"./keyOf":119}],75:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule SyntheticClipboardEvent
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var SyntheticEvent = _dereq_("./SyntheticEvent");
+
+/**
+ * @interface Event
+ * @see http://www.w3.org/TR/clipboard-apis/
+ */
+var ClipboardEventInterface = {
+  clipboardData: function(event) {
+    return (
+      'clipboardData' in event ?
+        event.clipboardData :
+        window.clipboardData
+    );
+  }
+};
+
+/**
+ * @param {object} dispatchConfig Configuration used to dispatch this event.
+ * @param {string} dispatchMarker Marker identifying the event target.
+ * @param {object} nativeEvent Native browser event.
+ * @extends {SyntheticUIEvent}
+ */
+function SyntheticClipboardEvent(dispatchConfig, dispatchMarker, nativeEvent) {
+  SyntheticEvent.call(this, dispatchConfig, dispatchMarker, nativeEvent);
+}
+
+SyntheticEvent.augmentClass(SyntheticClipboardEvent, ClipboardEventInterface);
+
+module.exports = SyntheticClipboardEvent;
+
+
+},{"./SyntheticEvent":78}],76:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule SyntheticCompositionEvent
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var SyntheticEvent = _dereq_("./SyntheticEvent");
+
+/**
+ * @interface Event
+ * @see http://www.w3.org/TR/DOM-Level-3-Events/#events-compositionevents
+ */
+var CompositionEventInterface = {
+  data: null
+};
+
+/**
+ * @param {object} dispatchConfig Configuration used to dispatch this event.
+ * @param {string} dispatchMarker Marker identifying the event target.
+ * @param {object} nativeEvent Native browser event.
+ * @extends {SyntheticUIEvent}
+ */
+function SyntheticCompositionEvent(
+  dispatchConfig,
+  dispatchMarker,
+  nativeEvent) {
+  SyntheticEvent.call(this, dispatchConfig, dispatchMarker, nativeEvent);
+}
+
+SyntheticEvent.augmentClass(
+  SyntheticCompositionEvent,
+  CompositionEventInterface
+);
+
+module.exports = SyntheticCompositionEvent;
+
+
+},{"./SyntheticEvent":78}],77:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule SyntheticDragEvent
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var SyntheticMouseEvent = _dereq_("./SyntheticMouseEvent");
+
+/**
+ * @interface DragEvent
+ * @see http://www.w3.org/TR/DOM-Level-3-Events/
+ */
+var DragEventInterface = {
+  dataTransfer: null
+};
+
+/**
+ * @param {object} dispatchConfig Configuration used to dispatch this event.
+ * @param {string} dispatchMarker Marker identifying the event target.
+ * @param {object} nativeEvent Native browser event.
+ * @extends {SyntheticUIEvent}
+ */
+function SyntheticDragEvent(dispatchConfig, dispatchMarker, nativeEvent) {
+  SyntheticMouseEvent.call(this, dispatchConfig, dispatchMarker, nativeEvent);
+}
+
+SyntheticMouseEvent.augmentClass(SyntheticDragEvent, DragEventInterface);
+
+module.exports = SyntheticDragEvent;
+
+},{"./SyntheticMouseEvent":81}],78:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule SyntheticEvent
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var PooledClass = _dereq_("./PooledClass");
+
+var emptyFunction = _dereq_("./emptyFunction");
+var getEventTarget = _dereq_("./getEventTarget");
+var merge = _dereq_("./merge");
+var mergeInto = _dereq_("./mergeInto");
+
+/**
+ * @interface Event
+ * @see http://www.w3.org/TR/DOM-Level-3-Events/
+ */
+var EventInterface = {
+  type: null,
+  target: getEventTarget,
+  // currentTarget is set when dispatching; no use in copying it here
+  currentTarget: emptyFunction.thatReturnsNull,
+  eventPhase: null,
+  bubbles: null,
+  cancelable: null,
+  timeStamp: function(event) {
+    return event.timeStamp || Date.now();
+  },
+  defaultPrevented: null,
+  isTrusted: null
+};
+
+/**
+ * Synthetic events are dispatched by event plugins, typically in response to a
+ * top-level event delegation handler.
+ *
+ * These systems should generally use pooling to reduce the frequency of garbage
+ * collection. The system should check `isPersistent` to determine whether the
+ * event should be released into the pool after being dispatched. Users that
+ * need a persisted event should invoke `persist`.
+ *
+ * Synthetic events (and subclasses) implement the DOM Level 3 Events API by
+ * normalizing browser quirks. Subclasses do not necessarily have to implement a
+ * DOM interface; custom application-specific events can also subclass this.
+ *
+ * @param {object} dispatchConfig Configuration used to dispatch this event.
+ * @param {string} dispatchMarker Marker identifying the event target.
+ * @param {object} nativeEvent Native browser event.
+ */
+function SyntheticEvent(dispatchConfig, dispatchMarker, nativeEvent) {
+  this.dispatchConfig = dispatchConfig;
+  this.dispatchMarker = dispatchMarker;
+  this.nativeEvent = nativeEvent;
+
+  var Interface = this.constructor.Interface;
+  for (var propName in Interface) {
+    if (!Interface.hasOwnProperty(propName)) {
+      continue;
+    }
+    var normalize = Interface[propName];
+    if (normalize) {
+      this[propName] = normalize(nativeEvent);
+    } else {
+      this[propName] = nativeEvent[propName];
+    }
+  }
+
+  var defaultPrevented = nativeEvent.defaultPrevented != null ?
+    nativeEvent.defaultPrevented :
+    nativeEvent.returnValue === false;
+  if (defaultPrevented) {
+    this.isDefaultPrevented = emptyFunction.thatReturnsTrue;
+  } else {
+    this.isDefaultPrevented = emptyFunction.thatReturnsFalse;
+  }
+  this.isPropagationStopped = emptyFunction.thatReturnsFalse;
+}
+
+mergeInto(SyntheticEvent.prototype, {
+
+  preventDefault: function() {
+    this.defaultPrevented = true;
+    var event = this.nativeEvent;
+    event.preventDefault ? event.preventDefault() : event.returnValue = false;
+    this.isDefaultPrevented = emptyFunction.thatReturnsTrue;
+  },
+
+  stopPropagation: function() {
+    var event = this.nativeEvent;
+    event.stopPropagation ? event.stopPropagation() : event.cancelBubble = true;
+    this.isPropagationStopped = emptyFunction.thatReturnsTrue;
+  },
+
+  /**
+   * We release all dispatched `SyntheticEvent`s after each event loop, adding
+   * them back into the pool. This allows a way to hold onto a reference that
+   * won't be added back into the pool.
+   */
+  persist: function() {
+    this.isPersistent = emptyFunction.thatReturnsTrue;
+  },
+
+  /**
+   * Checks if this event should be released back into the pool.
+   *
+   * @return {boolean} True if this should not be released, false otherwise.
+   */
+  isPersistent: emptyFunction.thatReturnsFalse,
+
+  /**
+   * `PooledClass` looks for `destructor` on each instance it releases.
+   */
+  destructor: function() {
+    var Interface = this.constructor.Interface;
+    for (var propName in Interface) {
+      this[propName] = null;
+    }
+    this.dispatchConfig = null;
+    this.dispatchMarker = null;
+    this.nativeEvent = null;
+  }
+
+});
+
+SyntheticEvent.Interface = EventInterface;
+
+/**
+ * Helper to reduce boilerplate when creating subclasses.
+ *
+ * @param {function} Class
+ * @param {?object} Interface
+ */
+SyntheticEvent.augmentClass = function(Class, Interface) {
+  var Super = this;
+
+  var prototype = Object.create(Super.prototype);
+  mergeInto(prototype, Class.prototype);
+  Class.prototype = prototype;
+  Class.prototype.constructor = Class;
+
+  Class.Interface = merge(Super.Interface, Interface);
+  Class.augmentClass = Super.augmentClass;
+
+  PooledClass.addPoolingTo(Class, PooledClass.threeArgumentPooler);
+};
+
+PooledClass.addPoolingTo(SyntheticEvent, PooledClass.threeArgumentPooler);
+
+module.exports = SyntheticEvent;
+
+},{"./PooledClass":23,"./emptyFunction":96,"./getEventTarget":104,"./merge":121,"./mergeInto":123}],79:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule SyntheticFocusEvent
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var SyntheticUIEvent = _dereq_("./SyntheticUIEvent");
+
+/**
+ * @interface FocusEvent
+ * @see http://www.w3.org/TR/DOM-Level-3-Events/
+ */
+var FocusEventInterface = {
+  relatedTarget: null
+};
+
+/**
+ * @param {object} dispatchConfig Configuration used to dispatch this event.
+ * @param {string} dispatchMarker Marker identifying the event target.
+ * @param {object} nativeEvent Native browser event.
+ * @extends {SyntheticUIEvent}
+ */
+function SyntheticFocusEvent(dispatchConfig, dispatchMarker, nativeEvent) {
+  SyntheticUIEvent.call(this, dispatchConfig, dispatchMarker, nativeEvent);
+}
+
+SyntheticUIEvent.augmentClass(SyntheticFocusEvent, FocusEventInterface);
+
+module.exports = SyntheticFocusEvent;
+
+},{"./SyntheticUIEvent":83}],80:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule SyntheticKeyboardEvent
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var SyntheticUIEvent = _dereq_("./SyntheticUIEvent");
+
+var getEventKey = _dereq_("./getEventKey");
+
+/**
+ * @interface KeyboardEvent
+ * @see http://www.w3.org/TR/DOM-Level-3-Events/
+ */
+var KeyboardEventInterface = {
+  key: getEventKey,
+  location: null,
+  ctrlKey: null,
+  shiftKey: null,
+  altKey: null,
+  metaKey: null,
+  repeat: null,
+  locale: null,
+  // Legacy Interface
+  'char': null,
+  charCode: null,
+  keyCode: null,
+  which: null
+};
+
+/**
+ * @param {object} dispatchConfig Configuration used to dispatch this event.
+ * @param {string} dispatchMarker Marker identifying the event target.
+ * @param {object} nativeEvent Native browser event.
+ * @extends {SyntheticUIEvent}
+ */
+function SyntheticKeyboardEvent(dispatchConfig, dispatchMarker, nativeEvent) {
+  SyntheticUIEvent.call(this, dispatchConfig, dispatchMarker, nativeEvent);
+}
+
+SyntheticUIEvent.augmentClass(SyntheticKeyboardEvent, KeyboardEventInterface);
+
+module.exports = SyntheticKeyboardEvent;
+
+},{"./SyntheticUIEvent":83,"./getEventKey":103}],81:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule SyntheticMouseEvent
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var SyntheticUIEvent = _dereq_("./SyntheticUIEvent");
+var ViewportMetrics = _dereq_("./ViewportMetrics");
+
+/**
+ * @interface MouseEvent
+ * @see http://www.w3.org/TR/DOM-Level-3-Events/
+ */
+var MouseEventInterface = {
+  screenX: null,
+  screenY: null,
+  clientX: null,
+  clientY: null,
+  ctrlKey: null,
+  shiftKey: null,
+  altKey: null,
+  metaKey: null,
+  button: function(event) {
+    // Webkit, Firefox, IE9+
+    // which:  1 2 3
+    // button: 0 1 2 (standard)
+    var button = event.button;
+    if ('which' in event) {
+      return button;
+    }
+    // IE<9
+    // which:  undefined
+    // button: 0 0 0
+    // button: 1 4 2 (onmouseup)
+    return button === 2 ? 2 : button === 4 ? 1 : 0;
+  },
+  buttons: null,
+  relatedTarget: function(event) {
+    return event.relatedTarget || (
+      event.fromElement === event.srcElement ?
+        event.toElement :
+        event.fromElement
+    );
+  },
+  // "Proprietary" Interface.
+  pageX: function(event) {
+    return 'pageX' in event ?
+      event.pageX :
+      event.clientX + ViewportMetrics.currentScrollLeft;
+  },
+  pageY: function(event) {
+    return 'pageY' in event ?
+      event.pageY :
+      event.clientY + ViewportMetrics.currentScrollTop;
+  }
+};
+
+/**
+ * @param {object} dispatchConfig Configuration used to dispatch this event.
+ * @param {string} dispatchMarker Marker identifying the event target.
+ * @param {object} nativeEvent Native browser event.
+ * @extends {SyntheticUIEvent}
+ */
+function SyntheticMouseEvent(dispatchConfig, dispatchMarker, nativeEvent) {
+  SyntheticUIEvent.call(this, dispatchConfig, dispatchMarker, nativeEvent);
+}
+
+SyntheticUIEvent.augmentClass(SyntheticMouseEvent, MouseEventInterface);
+
+module.exports = SyntheticMouseEvent;
+
+},{"./SyntheticUIEvent":83,"./ViewportMetrics":86}],82:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule SyntheticTouchEvent
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var SyntheticUIEvent = _dereq_("./SyntheticUIEvent");
+
+/**
+ * @interface TouchEvent
+ * @see http://www.w3.org/TR/touch-events/
+ */
+var TouchEventInterface = {
+  touches: null,
+  targetTouches: null,
+  changedTouches: null,
+  altKey: null,
+  metaKey: null,
+  ctrlKey: null,
+  shiftKey: null
+};
+
+/**
+ * @param {object} dispatchConfig Configuration used to dispatch this event.
+ * @param {string} dispatchMarker Marker identifying the event target.
+ * @param {object} nativeEvent Native browser event.
+ * @extends {SyntheticUIEvent}
+ */
+function SyntheticTouchEvent(dispatchConfig, dispatchMarker, nativeEvent) {
+  SyntheticUIEvent.call(this, dispatchConfig, dispatchMarker, nativeEvent);
+}
+
+SyntheticUIEvent.augmentClass(SyntheticTouchEvent, TouchEventInterface);
+
+module.exports = SyntheticTouchEvent;
+
+},{"./SyntheticUIEvent":83}],83:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule SyntheticUIEvent
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var SyntheticEvent = _dereq_("./SyntheticEvent");
+
+/**
+ * @interface UIEvent
+ * @see http://www.w3.org/TR/DOM-Level-3-Events/
+ */
+var UIEventInterface = {
+  view: null,
+  detail: null
+};
+
+/**
+ * @param {object} dispatchConfig Configuration used to dispatch this event.
+ * @param {string} dispatchMarker Marker identifying the event target.
+ * @param {object} nativeEvent Native browser event.
+ * @extends {SyntheticEvent}
+ */
+function SyntheticUIEvent(dispatchConfig, dispatchMarker, nativeEvent) {
+  SyntheticEvent.call(this, dispatchConfig, dispatchMarker, nativeEvent);
+}
+
+SyntheticEvent.augmentClass(SyntheticUIEvent, UIEventInterface);
+
+module.exports = SyntheticUIEvent;
+
+},{"./SyntheticEvent":78}],84:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule SyntheticWheelEvent
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var SyntheticMouseEvent = _dereq_("./SyntheticMouseEvent");
+
+/**
+ * @interface WheelEvent
+ * @see http://www.w3.org/TR/DOM-Level-3-Events/
+ */
+var WheelEventInterface = {
+  deltaX: function(event) {
+    return (
+      'deltaX' in event ? event.deltaX :
+      // Fallback to `wheelDeltaX` for Webkit and normalize (right is positive).
+      'wheelDeltaX' in event ? -event.wheelDeltaX : 0
+    );
+  },
+  deltaY: function(event) {
+    return (
+      'deltaY' in event ? event.deltaY :
+      // Fallback to `wheelDeltaY` for Webkit and normalize (down is positive).
+      'wheelDeltaY' in event ? -event.wheelDeltaY :
+      // Fallback to `wheelDelta` for IE<9 and normalize (down is positive).
+      'wheelDelta' in event ? -event.wheelDelta : 0
+    );
+  },
+  deltaZ: null,
+
+  // Browsers without "deltaMode" is reporting in raw wheel delta where one
+  // notch on the scroll is always +/- 120, roughly equivalent to pixels.
+  // A good approximation of DOM_DELTA_LINE (1) is 5% of viewport size or
+  // ~40 pixels, for DOM_DELTA_SCREEN (2) it is 87.5% of viewport size.
+  deltaMode: null
+};
+
+/**
+ * @param {object} dispatchConfig Configuration used to dispatch this event.
+ * @param {string} dispatchMarker Marker identifying the event target.
+ * @param {object} nativeEvent Native browser event.
+ * @extends {SyntheticMouseEvent}
+ */
+function SyntheticWheelEvent(dispatchConfig, dispatchMarker, nativeEvent) {
+  SyntheticMouseEvent.call(this, dispatchConfig, dispatchMarker, nativeEvent);
+}
+
+SyntheticMouseEvent.augmentClass(SyntheticWheelEvent, WheelEventInterface);
+
+module.exports = SyntheticWheelEvent;
+
+},{"./SyntheticMouseEvent":81}],85:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule Transaction
+ */
+
+"use strict";
+
+var invariant = _dereq_("./invariant");
+
+/**
+ * `Transaction` creates a black box that is able to wrap any method such that
+ * certain invariants are maintained before and after the method is invoked
+ * (Even if an exception is thrown while invoking the wrapped method). Whoever
+ * instantiates a transaction can provide enforcers of the invariants at
+ * creation time. The `Transaction` class itself will supply one additional
+ * automatic invariant for you - the invariant that any transaction instance
+ * should not be run while it is already being run. You would typically create a
+ * single instance of a `Transaction` for reuse multiple times, that potentially
+ * is used to wrap several different methods. Wrappers are extremely simple -
+ * they only require implementing two methods.
+ *
+ * <pre>
+ *                       wrappers (injected at creation time)
+ *                                      +        +
+ *                                      |        |
+ *                    +-----------------|--------|--------------+
+ *                    |                 v        |              |
+ *                    |      +---------------+   |              |
+ *                    |   +--|    wrapper1   |---|----+         |
+ *                    |   |  +---------------+   v    |         |
+ *                    |   |          +-------------+  |         |
+ *                    |   |     +----|   wrapper2  |--------+   |
+ *                    |   |     |    +-------------+  |     |   |
+ *                    |   |     |                     |     |   |
+ *                    |   v     v                     v     v   | wrapper
+ *                    | +---+ +---+   +---------+   +---+ +---+ | invariants
+ * perform(anyMethod) | |   | |   |   |         |   |   | |   | | maintained
+ * +----------------->|-|---|-|---|-->|anyMethod|---|---|-|---|-|-------->
+ *                    | |   | |   |   |         |   |   | |   | |
+ *                    | |   | |   |   |         |   |   | |   | |
+ *                    | |   | |   |   |         |   |   | |   | |
+ *                    | +---+ +---+   +---------+   +---+ +---+ |
+ *                    |  initialize                    close    |
+ *                    +-----------------------------------------+
+ * </pre>
+ *
+ * Bonus:
+ * - Reports timing metrics by method name and wrapper index.
+ *
+ * Use cases:
+ * - Preserving the input selection ranges before/after reconciliation.
+ *   Restoring selection even in the event of an unexpected error.
+ * - Deactivating events while rearranging the DOM, preventing blurs/focuses,
+ *   while guaranteeing that afterwards, the event system is reactivated.
+ * - Flushing a queue of collected DOM mutations to the main UI thread after a
+ *   reconciliation takes place in a worker thread.
+ * - Invoking any collected `componentDidUpdate` callbacks after rendering new
+ *   content.
+ * - (Future use case): Wrapping particular flushes of the `ReactWorker` queue
+ *   to preserve the `scrollTop` (an automatic scroll aware DOM).
+ * - (Future use case): Layout calculations before and after DOM upates.
+ *
+ * Transactional plugin API:
+ * - A module that has an `initialize` method that returns any precomputation.
+ * - and a `close` method that accepts the precomputation. `close` is invoked
+ *   when the wrapped process is completed, or has failed.
+ *
+ * @param {Array<TransactionalWrapper>} transactionWrapper Wrapper modules
+ * that implement `initialize` and `close`.
+ * @return {Transaction} Single transaction for reuse in thread.
+ *
+ * @class Transaction
+ */
+var Mixin = {
+  /**
+   * Sets up this instance so that it is prepared for collecting metrics. Does
+   * so such that this setup method may be used on an instance that is already
+   * initialized, in a way that does not consume additional memory upon reuse.
+   * That can be useful if you decide to make your subclass of this mixin a
+   * "PooledClass".
+   */
+  reinitializeTransaction: function() {
+    this.transactionWrappers = this.getTransactionWrappers();
+    if (!this.wrapperInitData) {
+      this.wrapperInitData = [];
+    } else {
+      this.wrapperInitData.length = 0;
+    }
+    if (!this.timingMetrics) {
+      this.timingMetrics = {};
+    }
+    this.timingMetrics.methodInvocationTime = 0;
+    if (!this.timingMetrics.wrapperInitTimes) {
+      this.timingMetrics.wrapperInitTimes = [];
+    } else {
+      this.timingMetrics.wrapperInitTimes.length = 0;
+    }
+    if (!this.timingMetrics.wrapperCloseTimes) {
+      this.timingMetrics.wrapperCloseTimes = [];
+    } else {
+      this.timingMetrics.wrapperCloseTimes.length = 0;
+    }
+    this._isInTransaction = false;
+  },
+
+  _isInTransaction: false,
+
+  /**
+   * @abstract
+   * @return {Array<TransactionWrapper>} Array of transaction wrappers.
+   */
+  getTransactionWrappers: null,
+
+  isInTransaction: function() {
+    return !!this._isInTransaction;
+  },
+
+  /**
+   * Executes the function within a safety window. Use this for the top level
+   * methods that result in large amounts of computation/mutations that would
+   * need to be safety checked.
+   *
+   * @param {function} method Member of scope to call.
+   * @param {Object} scope Scope to invoke from.
+   * @param {Object?=} args... Arguments to pass to the method (optional).
+   *                           Helps prevent need to bind in many cases.
+   * @return Return value from `method`.
+   */
+  perform: function(method, scope, a, b, c, d, e, f) {
+    ("production" !== "development" ? invariant(
+      !this.isInTransaction(),
+      'Transaction.perform(...): Cannot initialize a transaction when there ' +
+      'is already an outstanding transaction.'
+    ) : invariant(!this.isInTransaction()));
+    var memberStart = Date.now();
+    var errorThrown;
+    var ret;
+    try {
+      this._isInTransaction = true;
+      // Catching errors makes debugging more difficult, so we start with
+      // errorThrown set to true before setting it to false after calling
+      // close -- if it's still set to true in the finally block, it means
+      // one of these calls threw.
+      errorThrown = true;
+      this.initializeAll(0);
+      ret = method.call(scope, a, b, c, d, e, f);
+      errorThrown = false;
+    } finally {
+      var memberEnd = Date.now();
+      this.methodInvocationTime += (memberEnd - memberStart);
+      try {
+        if (errorThrown) {
+          // If `method` throws, prefer to show that stack trace over any thrown
+          // by invoking `closeAll`.
+          try {
+            this.closeAll(0);
+          } catch (err) {
+          }
+        } else {
+          // Since `method` didn't throw, we don't want to silence the exception
+          // here.
+          this.closeAll(0);
+        }
+      } finally {
+        this._isInTransaction = false;
+      }
+    }
+    return ret;
+  },
+
+  initializeAll: function(startIndex) {
+    var transactionWrappers = this.transactionWrappers;
+    var wrapperInitTimes = this.timingMetrics.wrapperInitTimes;
+    for (var i = startIndex; i < transactionWrappers.length; i++) {
+      var initStart = Date.now();
+      var wrapper = transactionWrappers[i];
+      try {
+        // Catching errors makes debugging more difficult, so we start with the
+        // OBSERVED_ERROR state before overwriting it with the real return value
+        // of initialize -- if it's still set to OBSERVED_ERROR in the finally
+        // block, it means wrapper.initialize threw.
+        this.wrapperInitData[i] = Transaction.OBSERVED_ERROR;
+        this.wrapperInitData[i] = wrapper.initialize ?
+          wrapper.initialize.call(this) :
+          null;
+      } finally {
+        var curInitTime = wrapperInitTimes[i];
+        var initEnd = Date.now();
+        wrapperInitTimes[i] = (curInitTime || 0) + (initEnd - initStart);
+
+        if (this.wrapperInitData[i] === Transaction.OBSERVED_ERROR) {
+          // The initializer for wrapper i threw an error; initialize the
+          // remaining wrappers but silence any exceptions from them to ensure
+          // that the first error is the one to bubble up.
+          try {
+            this.initializeAll(i + 1);
+          } catch (err) {
+          }
+        }
+      }
+    }
+  },
+
+  /**
+   * Invokes each of `this.transactionWrappers.close[i]` functions, passing into
+   * them the respective return values of `this.transactionWrappers.init[i]`
+   * (`close`rs that correspond to initializers that failed will not be
+   * invoked).
+   */
+  closeAll: function(startIndex) {
+    ("production" !== "development" ? invariant(
+      this.isInTransaction(),
+      'Transaction.closeAll(): Cannot close transaction when none are open.'
+    ) : invariant(this.isInTransaction()));
+    var transactionWrappers = this.transactionWrappers;
+    var wrapperCloseTimes = this.timingMetrics.wrapperCloseTimes;
+    for (var i = startIndex; i < transactionWrappers.length; i++) {
+      var wrapper = transactionWrappers[i];
+      var closeStart = Date.now();
+      var initData = this.wrapperInitData[i];
+      var errorThrown;
+      try {
+        // Catching errors makes debugging more difficult, so we start with
+        // errorThrown set to true before setting it to false after calling
+        // close -- if it's still set to true in the finally block, it means
+        // wrapper.close threw.
+        errorThrown = true;
+        if (initData !== Transaction.OBSERVED_ERROR) {
+          wrapper.close && wrapper.close.call(this, initData);
+        }
+        errorThrown = false;
+      } finally {
+        var closeEnd = Date.now();
+        var curCloseTime = wrapperCloseTimes[i];
+        wrapperCloseTimes[i] = (curCloseTime || 0) + (closeEnd - closeStart);
+
+        if (errorThrown) {
+          // The closer for wrapper i threw an error; close the remaining
+          // wrappers but silence any exceptions from them to ensure that the
+          // first error is the one to bubble up.
+          try {
+            this.closeAll(i + 1);
+          } catch (e) {
+          }
+        }
+      }
+    }
+    this.wrapperInitData.length = 0;
+  }
+};
+
+var Transaction = {
+
+  Mixin: Mixin,
+
+  /**
+   * Token to look for to determine if an error occured.
+   */
+  OBSERVED_ERROR: {}
+
+};
+
+module.exports = Transaction;
+
+},{"./invariant":112}],86:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule ViewportMetrics
+ */
+
+"use strict";
+
+var getUnboundedScrollPosition = _dereq_("./getUnboundedScrollPosition");
+
+var ViewportMetrics = {
+
+  currentScrollLeft: 0,
+
+  currentScrollTop: 0,
+
+  refreshScrollValues: function() {
+    var scrollPosition = getUnboundedScrollPosition(window);
+    ViewportMetrics.currentScrollLeft = scrollPosition.x;
+    ViewportMetrics.currentScrollTop = scrollPosition.y;
+  }
+
+};
+
+module.exports = ViewportMetrics;
+
+},{"./getUnboundedScrollPosition":109}],87:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule accumulate
+ */
+
+"use strict";
+
+var invariant = _dereq_("./invariant");
+
+/**
+ * Accumulates items that must not be null or undefined.
+ *
+ * This is used to conserve memory by avoiding array allocations.
+ *
+ * @return {*|array<*>} An accumulation of items.
+ */
+function accumulate(current, next) {
+  ("production" !== "development" ? invariant(
+    next != null,
+    'accumulate(...): Accumulated items must be not be null or undefined.'
+  ) : invariant(next != null));
+  if (current == null) {
+    return next;
+  } else {
+    // Both are not empty. Warning: Never call x.concat(y) when you are not
+    // certain that x is an Array (x could be a string with concat method).
+    var currentIsArray = Array.isArray(current);
+    var nextIsArray = Array.isArray(next);
+    if (currentIsArray) {
+      return current.concat(next);
+    } else {
+      if (nextIsArray) {
+        return [current].concat(next);
+      } else {
+        return [current, next];
+      }
+    }
+  }
+}
+
+module.exports = accumulate;
+
+},{"./invariant":112}],88:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule adler32
+ */
+
+/* jslint bitwise:true */
+
+"use strict";
+
+var MOD = 65521;
+
+// This is a clean-room implementation of adler32 designed for detecting
+// if markup is not what we expect it to be. It does not need to be
+// cryptographically strong, only reasonable good at detecting if markup
+// generated on the server is different than that on the client.
+function adler32(data) {
+  var a = 1;
+  var b = 0;
+  for (var i = 0; i < data.length; i++) {
+    a = (a + data.charCodeAt(i)) % MOD;
+    b = (b + a) % MOD;
+  }
+  return a | (b << 16);
+}
+
+module.exports = adler32;
+
+},{}],89:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule containsNode
+ * @typechecks
+ */
+
+var isTextNode = _dereq_("./isTextNode");
+
+/*jslint bitwise:true */
+
+/**
+ * Checks if a given DOM node contains or is another DOM node.
+ *
+ * @param {?DOMNode} outerNode Outer DOM node.
+ * @param {?DOMNode} innerNode Inner DOM node.
+ * @return {boolean} True if `outerNode` contains or is `innerNode`.
+ */
+function containsNode(outerNode, innerNode) {
+  if (!outerNode || !innerNode) {
+    return false;
+  } else if (outerNode === innerNode) {
+    return true;
+  } else if (isTextNode(outerNode)) {
+    return false;
+  } else if (isTextNode(innerNode)) {
+    return containsNode(outerNode, innerNode.parentNode);
+  } else if (outerNode.contains) {
+    return outerNode.contains(innerNode);
+  } else if (outerNode.compareDocumentPosition) {
+    return !!(outerNode.compareDocumentPosition(innerNode) & 16);
+  } else {
+    return false;
+  }
+}
+
+module.exports = containsNode;
+
+},{"./isTextNode":116}],90:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule copyProperties
+ */
+
+/**
+ * Copy properties from one or more objects (up to 5) into the first object.
+ * This is a shallow copy. It mutates the first object and also returns it.
+ *
+ * NOTE: `arguments` has a very significant performance penalty, which is why
+ * we don't support unlimited arguments.
+ */
+function copyProperties(obj, a, b, c, d, e, f) {
+  obj = obj || {};
+
+  if ("production" !== "development") {
+    if (f) {
+      throw new Error('Too many arguments passed to copyProperties');
+    }
+  }
+
+  var args = [a, b, c, d, e];
+  var ii = 0, v;
+  while (args[ii]) {
+    v = args[ii++];
+    for (var k in v) {
+      obj[k] = v[k];
+    }
+
+    // IE ignores toString in object iteration.. See:
+    // webreflection.blogspot.com/2007/07/quick-fix-internet-explorer-and.html
+    if (v.hasOwnProperty && v.hasOwnProperty('toString') &&
+        (typeof v.toString != 'undefined') && (obj.toString !== v.toString)) {
+      obj.toString = v.toString;
+    }
+  }
+
+  return obj;
+}
+
+module.exports = copyProperties;
+
+},{}],91:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule createArrayFrom
+ * @typechecks
+ */
+
+var toArray = _dereq_("./toArray");
+
+/**
+ * Perform a heuristic test to determine if an object is "array-like".
+ *
+ *   A monk asked Joshu, a Zen master, "Has a dog Buddha nature?"
+ *   Joshu replied: "Mu."
+ *
+ * This function determines if its argument has "array nature": it returns
+ * true if the argument is an actual array, an `arguments' object, or an
+ * HTMLCollection (e.g. node.childNodes or node.getElementsByTagName()).
+ *
+ * It will return false for other array-like objects like Filelist.
+ *
+ * @param {*} obj
+ * @return {boolean}
+ */
+function hasArrayNature(obj) {
+  return (
+    // not null/false
+    !!obj &&
+    // arrays are objects, NodeLists are functions in Safari
+    (typeof obj == 'object' || typeof obj == 'function') &&
+    // quacks like an array
+    ('length' in obj) &&
+    // not window
+    !('setInterval' in obj) &&
+    // no DOM node should be considered an array-like
+    // a 'select' element has 'length' and 'item' properties on IE8
+    (typeof obj.nodeType != 'number') &&
+    (
+      // a real array
+      (// HTMLCollection/NodeList
+      (Array.isArray(obj) ||
+      // arguments
+      ('callee' in obj) || 'item' in obj))
+    )
+  );
+}
+
+/**
+ * Ensure that the argument is an array by wrapping it in an array if it is not.
+ * Creates a copy of the argument if it is already an array.
+ *
+ * This is mostly useful idiomatically:
+ *
+ *   var createArrayFrom = require('createArrayFrom');
+ *
+ *   function takesOneOrMoreThings(things) {
+ *     things = createArrayFrom(things);
+ *     ...
+ *   }
+ *
+ * This allows you to treat `things' as an array, but accept scalars in the API.
+ *
+ * If you need to convert an array-like object, like `arguments`, into an array
+ * use toArray instead.
+ *
+ * @param {*} obj
+ * @return {array}
+ */
+function createArrayFrom(obj) {
+  if (!hasArrayNature(obj)) {
+    return [obj];
+  } else if (Array.isArray(obj)) {
+    return obj.slice();
+  } else {
+    return toArray(obj);
+  }
+}
+
+module.exports = createArrayFrom;
+
+},{"./toArray":132}],92:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule createFullPageComponent
+ * @typechecks
+ */
+
+"use strict";
+
+// Defeat circular references by requiring this directly.
+var ReactCompositeComponent = _dereq_("./ReactCompositeComponent");
+
+var invariant = _dereq_("./invariant");
+
+/**
+ * Create a component that will throw an exception when unmounted.
+ *
+ * Components like <html> <head> and <body> can't be removed or added
+ * easily in a cross-browser way, however it's valuable to be able to
+ * take advantage of React's reconciliation for styling and <title>
+ * management. So we just document it and throw in dangerous cases.
+ *
+ * @param {function} componentClass convenience constructor to wrap
+ * @return {function} convenience constructor of new component
+ */
+function createFullPageComponent(componentClass) {
+  var FullPageComponent = ReactCompositeComponent.createClass({
+    displayName: 'ReactFullPageComponent' + (
+      componentClass.componentConstructor.displayName || ''
+    ),
+
+    componentWillUnmount: function() {
+      ("production" !== "development" ? invariant(
+        false,
+        '%s tried to unmount. Because of cross-browser quirks it is ' +
+        'impossible to unmount some top-level components (eg <html>, <head>, ' +
+        'and <body>) reliably and efficiently. To fix this, have a single ' +
+        'top-level component that never unmounts render these elements.',
+        this.constructor.displayName
+      ) : invariant(false));
+    },
+
+    render: function() {
+      return this.transferPropsTo(componentClass(null, this.props.children));
+    }
+  });
+
+  return FullPageComponent;
+}
+
+module.exports = createFullPageComponent;
+
+},{"./ReactCompositeComponent":29,"./invariant":112}],93:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule createNodesFromMarkup
+ * @typechecks
+ */
+
+/*jslint evil: true, sub: true */
+
+var ExecutionEnvironment = _dereq_("./ExecutionEnvironment");
+
+var createArrayFrom = _dereq_("./createArrayFrom");
+var getMarkupWrap = _dereq_("./getMarkupWrap");
+var invariant = _dereq_("./invariant");
+
+/**
+ * Dummy container used to render all markup.
+ */
+var dummyNode =
+  ExecutionEnvironment.canUseDOM ? document.createElement('div') : null;
+
+/**
+ * Pattern used by `getNodeName`.
+ */
+var nodeNamePattern = /^\s*<(\w+)/;
+
+/**
+ * Extracts the `nodeName` of the first element in a string of markup.
+ *
+ * @param {string} markup String of markup.
+ * @return {?string} Node name of the supplied markup.
+ */
+function getNodeName(markup) {
+  var nodeNameMatch = markup.match(nodeNamePattern);
+  return nodeNameMatch && nodeNameMatch[1].toLowerCase();
+}
+
+/**
+ * Creates an array containing the nodes rendered from the supplied markup. The
+ * optionally supplied `handleScript` function will be invoked once for each
+ * <script> element that is rendered. If no `handleScript` function is supplied,
+ * an exception is thrown if any <script> elements are rendered.
+ *
+ * @param {string} markup A string of valid HTML markup.
+ * @param {?function} handleScript Invoked once for each rendered <script>.
+ * @return {array<DOMElement|DOMTextNode>} An array of rendered nodes.
+ */
+function createNodesFromMarkup(markup, handleScript) {
+  var node = dummyNode;
+  ("production" !== "development" ? invariant(!!dummyNode, 'createNodesFromMarkup dummy not initialized') : invariant(!!dummyNode));
+  var nodeName = getNodeName(markup);
+
+  var wrap = nodeName && getMarkupWrap(nodeName);
+  if (wrap) {
+    node.innerHTML = wrap[1] + markup + wrap[2];
+
+    var wrapDepth = wrap[0];
+    while (wrapDepth--) {
+      node = node.lastChild;
+    }
+  } else {
+    node.innerHTML = markup;
+  }
+
+  var scripts = node.getElementsByTagName('script');
+  if (scripts.length) {
+    ("production" !== "development" ? invariant(
+      handleScript,
+      'createNodesFromMarkup(...): Unexpected <script> element rendered.'
+    ) : invariant(handleScript));
+    createArrayFrom(scripts).forEach(handleScript);
+  }
+
+  var nodes = createArrayFrom(node.childNodes);
+  while (node.lastChild) {
+    node.removeChild(node.lastChild);
+  }
+  return nodes;
+}
+
+module.exports = createNodesFromMarkup;
+
+},{"./ExecutionEnvironment":20,"./createArrayFrom":91,"./getMarkupWrap":105,"./invariant":112}],94:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule createObjectFrom
+ */
+
+/**
+ * Construct an object from an array of keys
+ * and optionally specified value or list of values.
+ *
+ *  >>> createObjectFrom(['a','b','c']);
+ *  {a: true, b: true, c: true}
+ *
+ *  >>> createObjectFrom(['a','b','c'], false);
+ *  {a: false, b: false, c: false}
+ *
+ *  >>> createObjectFrom(['a','b','c'], 'monkey');
+ *  {c:'monkey', b:'monkey' c:'monkey'}
+ *
+ *  >>> createObjectFrom(['a','b','c'], [1,2,3]);
+ *  {a: 1, b: 2, c: 3}
+ *
+ *  >>> createObjectFrom(['women', 'men'], [true, false]);
+ *  {women: true, men: false}
+ *
+ * @param   Array   list of keys
+ * @param   mixed   optional value or value array.  defaults true.
+ * @returns object
+ */
+function createObjectFrom(keys, values /* = true */) {
+  if ("production" !== "development") {
+    if (!Array.isArray(keys)) {
+      throw new TypeError('Must pass an array of keys.');
+    }
+  }
+
+  var object = {};
+  var isArray = Array.isArray(values);
+  if (typeof values == 'undefined') {
+    values = true;
+  }
+
+  for (var ii = keys.length; ii--;) {
+    object[keys[ii]] = isArray ? values[ii] : values;
+  }
+  return object;
+}
+
+module.exports = createObjectFrom;
+
+},{}],95:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule dangerousStyleValue
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var CSSProperty = _dereq_("./CSSProperty");
+
+/**
+ * Convert a value into the proper css writable value. The `styleName` name
+ * name should be logical (no hyphens), as specified
+ * in `CSSProperty.isUnitlessNumber`.
+ *
+ * @param {string} styleName CSS property name such as `topMargin`.
+ * @param {*} value CSS property value such as `10px`.
+ * @return {string} Normalized style value with dimensions applied.
+ */
+function dangerousStyleValue(styleName, value) {
+  // Note that we've removed escapeTextForBrowser() calls here since the
+  // whole string will be escaped when the attribute is injected into
+  // the markup. If you provide unsafe user data here they can inject
+  // arbitrary CSS which may be problematic (I couldn't repro this):
+  // https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet
+  // http://www.thespanner.co.uk/2007/11/26/ultimate-xss-css-injection/
+  // This is not an XSS hole but instead a potential CSS injection issue
+  // which has lead to a greater discussion about how we're going to
+  // trust URLs moving forward. See #2115901
+
+  var isEmpty = value == null || typeof value === 'boolean' || value === '';
+  if (isEmpty) {
+    return '';
+  }
+
+  var isNonNumeric = isNaN(value);
+  if (isNonNumeric || value === 0 || CSSProperty.isUnitlessNumber[styleName]) {
+    return '' + value; // cast to string
+  }
+
+  return value + 'px';
+}
+
+module.exports = dangerousStyleValue;
+
+},{"./CSSProperty":2}],96:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule emptyFunction
+ */
+
+var copyProperties = _dereq_("./copyProperties");
+
+function makeEmptyFunction(arg) {
+  return function() {
+    return arg;
+  };
+}
+
+/**
+ * This function accepts and discards inputs; it has no side effects. This is
+ * primarily useful idiomatically for overridable function endpoints which
+ * always need to be callable, since JS lacks a null-call idiom ala Cocoa.
+ */
+function emptyFunction() {}
+
+copyProperties(emptyFunction, {
+  thatReturns: makeEmptyFunction,
+  thatReturnsFalse: makeEmptyFunction(false),
+  thatReturnsTrue: makeEmptyFunction(true),
+  thatReturnsNull: makeEmptyFunction(null),
+  thatReturnsThis: function() { return this; },
+  thatReturnsArgument: function(arg) { return arg; }
+});
+
+module.exports = emptyFunction;
+
+},{"./copyProperties":90}],97:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule emptyObject
+ */
+
+"use strict";
+
+var emptyObject = {};
+
+if ("production" !== "development") {
+  Object.freeze(emptyObject);
+}
+
+module.exports = emptyObject;
+
+},{}],98:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule escapeTextForBrowser
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var ESCAPE_LOOKUP = {
+  "&": "&amp;",
+  ">": "&gt;",
+  "<": "&lt;",
+  "\"": "&quot;",
+  "'": "&#x27;",
+  "/": "&#x2f;"
+};
+
+var ESCAPE_REGEX = /[&><"'\/]/g;
+
+function escaper(match) {
+  return ESCAPE_LOOKUP[match];
+}
+
+/**
+ * Escapes text to prevent scripting attacks.
+ *
+ * @param {*} text Text value to escape.
+ * @return {string} An escaped string.
+ */
+function escapeTextForBrowser(text) {
+  return ('' + text).replace(ESCAPE_REGEX, escaper);
+}
+
+module.exports = escapeTextForBrowser;
+
+},{}],99:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule flattenChildren
+ */
+
+"use strict";
+
+var invariant = _dereq_("./invariant");
+var traverseAllChildren = _dereq_("./traverseAllChildren");
+
+/**
+ * @param {function} traverseContext Context passed through traversal.
+ * @param {?ReactComponent} child React child component.
+ * @param {!string} name String name of key path to child.
+ */
+function flattenSingleChildIntoContext(traverseContext, child, name) {
+  // We found a component instance.
+  var result = traverseContext;
+  ("production" !== "development" ? invariant(
+    !result.hasOwnProperty(name),
+    'flattenChildren(...): Encountered two children with the same key, `%s`. ' +
+    'Children keys must be unique.',
+    name
+  ) : invariant(!result.hasOwnProperty(name)));
+  if (child != null) {
+    result[name] = child;
+  }
+}
+
+/**
+ * Flattens children that are typically specified as `props.children`. Any null
+ * children will not be included in the resulting object.
+ * @return {!object} flattened children keyed by name.
+ */
+function flattenChildren(children) {
+  if (children == null) {
+    return children;
+  }
+  var result = {};
+  traverseAllChildren(children, flattenSingleChildIntoContext, result);
+  return result;
+}
+
+module.exports = flattenChildren;
+
+},{"./invariant":112,"./traverseAllChildren":133}],100:[function(_dereq_,module,exports){
+/**
+ * Copyright 2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule focusNode
+ */
+
+"use strict";
+
+/**
+ * IE8 throws if an input/textarea is disabled and we try to focus it.
+ * Focus only when necessary.
+ *
+ * @param {DOMElement} node input/textarea to focus
+ */
+function focusNode(node) {
+  if (!node.disabled) {
+    node.focus();
+  }
+}
+
+module.exports = focusNode;
+
+},{}],101:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule forEachAccumulated
+ */
+
+"use strict";
+
+/**
+ * @param {array} an "accumulation" of items which is either an Array or
+ * a single item. Useful when paired with the `accumulate` module. This is a
+ * simple utility that allows us to reason about a collection of items, but
+ * handling the case when there is exactly one item (and we do not need to
+ * allocate an array).
+ */
+var forEachAccumulated = function(arr, cb, scope) {
+  if (Array.isArray(arr)) {
+    arr.forEach(cb, scope);
+  } else if (arr) {
+    cb.call(scope, arr);
+  }
+};
+
+module.exports = forEachAccumulated;
+
+},{}],102:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule getActiveElement
+ * @typechecks
+ */
+
+/**
+ * Same as document.activeElement but wraps in a try-catch block. In IE it is
+ * not safe to call document.activeElement if there is nothing focused.
+ *
+ * The activeElement will be null only if the document body is not yet defined.
+ */
+function getActiveElement() /*?DOMElement*/ {
+  try {
+    return document.activeElement || document.body;
+  } catch (e) {
+    return document.body;
+  }
+}
+
+module.exports = getActiveElement;
+
+},{}],103:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule getEventKey
+ * @typechecks static-only
+ */
+
+"use strict";
+
+/**
+ * Normalization of deprecated HTML5 "key" values
+ * @see https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent#Key_names
+ */
+var normalizeKey = {
+  'Esc': 'Escape',
+  'Spacebar': ' ',
+  'Left': 'ArrowLeft',
+  'Up': 'ArrowUp',
+  'Right': 'ArrowRight',
+  'Down': 'ArrowDown',
+  'Del': 'Delete',
+  'Win': 'OS',
+  'Menu': 'ContextMenu',
+  'Apps': 'ContextMenu',
+  'Scroll': 'ScrollLock',
+  'MozPrintableKey': 'Unidentified'
+};
+
+/**
+ * Translation from legacy "which/keyCode" to HTML5 "key"
+ * Only special keys supported, all others depend on keyboard layout or browser
+ * @see https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent#Key_names
+ */
+var translateToKey = {
+  8: 'Backspace',
+  9: 'Tab',
+  12: 'Clear',
+  13: 'Enter',
+  16: 'Shift',
+  17: 'Control',
+  18: 'Alt',
+  19: 'Pause',
+  20: 'CapsLock',
+  27: 'Escape',
+  32: ' ',
+  33: 'PageUp',
+  34: 'PageDown',
+  35: 'End',
+  36: 'Home',
+  37: 'ArrowLeft',
+  38: 'ArrowUp',
+  39: 'ArrowRight',
+  40: 'ArrowDown',
+  45: 'Insert',
+  46: 'Delete',
+  112: 'F1', 113: 'F2', 114: 'F3', 115: 'F4', 116: 'F5', 117: 'F6',
+  118: 'F7', 119: 'F8', 120: 'F9', 121: 'F10', 122: 'F11', 123: 'F12',
+  144: 'NumLock',
+  145: 'ScrollLock',
+  224: 'Meta'
+};
+
+/**
+ * @param {object} nativeEvent Native browser event.
+ * @return {string} Normalized `key` property.
+ */
+function getEventKey(nativeEvent) {
+  return 'key' in nativeEvent ?
+    normalizeKey[nativeEvent.key] || nativeEvent.key :
+    translateToKey[nativeEvent.which || nativeEvent.keyCode] || 'Unidentified';
+}
+
+module.exports = getEventKey;
+
+},{}],104:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule getEventTarget
+ * @typechecks static-only
+ */
+
+"use strict";
+
+/**
+ * Gets the target node from a native browser event by accounting for
+ * inconsistencies in browser DOM APIs.
+ *
+ * @param {object} nativeEvent Native browser event.
+ * @return {DOMEventTarget} Target node.
+ */
+function getEventTarget(nativeEvent) {
+  var target = nativeEvent.target || nativeEvent.srcElement || window;
+  // Safari may fire events on text nodes (Node.TEXT_NODE is 3).
+  // @see http://www.quirksmode.org/js/events_properties.html
+  return target.nodeType === 3 ? target.parentNode : target;
+}
+
+module.exports = getEventTarget;
+
+},{}],105:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule getMarkupWrap
+ */
+
+var ExecutionEnvironment = _dereq_("./ExecutionEnvironment");
+
+var invariant = _dereq_("./invariant");
+
+/**
+ * Dummy container used to detect which wraps are necessary.
+ */
+var dummyNode =
+  ExecutionEnvironment.canUseDOM ? document.createElement('div') : null;
+
+/**
+ * Some browsers cannot use `innerHTML` to render certain elements standalone,
+ * so we wrap them, render the wrapped nodes, then extract the desired node.
+ *
+ * In IE8, certain elements cannot render alone, so wrap all elements ('*').
+ */
+var shouldWrap = {
+  // Force wrapping for SVG elements because if they get created inside a <div>,
+  // they will be initialized in the wrong namespace (and will not display).
+  'circle': true,
+  'defs': true,
+  'g': true,
+  'line': true,
+  'linearGradient': true,
+  'path': true,
+  'polygon': true,
+  'polyline': true,
+  'radialGradient': true,
+  'rect': true,
+  'stop': true,
+  'text': true
+};
+
+var selectWrap = [1, '<select multiple="true">', '</select>'];
+var tableWrap = [1, '<table>', '</table>'];
+var trWrap = [3, '<table><tbody><tr>', '</tr></tbody></table>'];
+
+var svgWrap = [1, '<svg>', '</svg>'];
+
+var markupWrap = {
+  '*': [1, '?<div>', '</div>'],
+
+  'area': [1, '<map>', '</map>'],
+  'col': [2, '<table><tbody></tbody><colgroup>', '</colgroup></table>'],
+  'legend': [1, '<fieldset>', '</fieldset>'],
+  'param': [1, '<object>', '</object>'],
+  'tr': [2, '<table><tbody>', '</tbody></table>'],
+
+  'optgroup': selectWrap,
+  'option': selectWrap,
+
+  'caption': tableWrap,
+  'colgroup': tableWrap,
+  'tbody': tableWrap,
+  'tfoot': tableWrap,
+  'thead': tableWrap,
+
+  'td': trWrap,
+  'th': trWrap,
+
+  'circle': svgWrap,
+  'defs': svgWrap,
+  'g': svgWrap,
+  'line': svgWrap,
+  'linearGradient': svgWrap,
+  'path': svgWrap,
+  'polygon': svgWrap,
+  'polyline': svgWrap,
+  'radialGradient': svgWrap,
+  'rect': svgWrap,
+  'stop': svgWrap,
+  'text': svgWrap
+};
+
+/**
+ * Gets the markup wrap configuration for the supplied `nodeName`.
+ *
+ * NOTE: This lazily detects which wraps are necessary for the current browser.
+ *
+ * @param {string} nodeName Lowercase `nodeName`.
+ * @return {?array} Markup wrap configuration, if applicable.
+ */
+function getMarkupWrap(nodeName) {
+  ("production" !== "development" ? invariant(!!dummyNode, 'Markup wrapping node not initialized') : invariant(!!dummyNode));
+  if (!markupWrap.hasOwnProperty(nodeName)) {
+    nodeName = '*';
+  }
+  if (!shouldWrap.hasOwnProperty(nodeName)) {
+    if (nodeName === '*') {
+      dummyNode.innerHTML = '<link />';
+    } else {
+      dummyNode.innerHTML = '<' + nodeName + '></' + nodeName + '>';
+    }
+    shouldWrap[nodeName] = !dummyNode.firstChild;
+  }
+  return shouldWrap[nodeName] ? markupWrap[nodeName] : null;
+}
+
+
+module.exports = getMarkupWrap;
+
+},{"./ExecutionEnvironment":20,"./invariant":112}],106:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule getNodeForCharacterOffset
+ */
+
+"use strict";
+
+/**
+ * Given any node return the first leaf node without children.
+ *
+ * @param {DOMElement|DOMTextNode} node
+ * @return {DOMElement|DOMTextNode}
+ */
+function getLeafNode(node) {
+  while (node && node.firstChild) {
+    node = node.firstChild;
+  }
+  return node;
+}
+
+/**
+ * Get the next sibling within a container. This will walk up the
+ * DOM if a node's siblings have been exhausted.
+ *
+ * @param {DOMElement|DOMTextNode} node
+ * @return {?DOMElement|DOMTextNode}
+ */
+function getSiblingNode(node) {
+  while (node) {
+    if (node.nextSibling) {
+      return node.nextSibling;
+    }
+    node = node.parentNode;
+  }
+}
+
+/**
+ * Get object describing the nodes which contain characters at offset.
+ *
+ * @param {DOMElement|DOMTextNode} root
+ * @param {number} offset
+ * @return {?object}
+ */
+function getNodeForCharacterOffset(root, offset) {
+  var node = getLeafNode(root);
+  var nodeStart = 0;
+  var nodeEnd = 0;
+
+  while (node) {
+    if (node.nodeType == 3) {
+      nodeEnd = nodeStart + node.textContent.length;
+
+      if (nodeStart <= offset && nodeEnd >= offset) {
+        return {
+          node: node,
+          offset: offset - nodeStart
+        };
+      }
+
+      nodeStart = nodeEnd;
+    }
+
+    node = getLeafNode(getSiblingNode(node));
+  }
+}
+
+module.exports = getNodeForCharacterOffset;
+
+},{}],107:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule getReactRootElementInContainer
+ */
+
+"use strict";
+
+var DOC_NODE_TYPE = 9;
+
+/**
+ * @param {DOMElement|DOMDocument} container DOM element that may contain
+ *                                           a React component
+ * @return {?*} DOM element that may have the reactRoot ID, or null.
+ */
+function getReactRootElementInContainer(container) {
+  if (!container) {
+    return null;
+  }
+
+  if (container.nodeType === DOC_NODE_TYPE) {
+    return container.documentElement;
+  } else {
+    return container.firstChild;
+  }
+}
+
+module.exports = getReactRootElementInContainer;
+
+},{}],108:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule getTextContentAccessor
+ */
+
+"use strict";
+
+var ExecutionEnvironment = _dereq_("./ExecutionEnvironment");
+
+var contentKey = null;
+
+/**
+ * Gets the key used to access text content on a DOM node.
+ *
+ * @return {?string} Key used to access text content.
+ * @internal
+ */
+function getTextContentAccessor() {
+  if (!contentKey && ExecutionEnvironment.canUseDOM) {
+    // Prefer textContent to innerText because many browsers support both but
+    // SVG <text> elements don't support innerText even when <div> does.
+    contentKey = 'textContent' in document.createElement('div') ?
+      'textContent' :
+      'innerText';
+  }
+  return contentKey;
+}
+
+module.exports = getTextContentAccessor;
+
+},{"./ExecutionEnvironment":20}],109:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule getUnboundedScrollPosition
+ * @typechecks
+ */
+
+"use strict";
+
+/**
+ * Gets the scroll position of the supplied element or window.
+ *
+ * The return values are unbounded, unlike `getScrollPosition`. This means they
+ * may be negative or exceed the element boundaries (which is possible using
+ * inertial scrolling).
+ *
+ * @param {DOMWindow|DOMElement} scrollable
+ * @return {object} Map with `x` and `y` keys.
+ */
+function getUnboundedScrollPosition(scrollable) {
+  if (scrollable === window) {
+    return {
+      x: window.pageXOffset || document.documentElement.scrollLeft,
+      y: window.pageYOffset || document.documentElement.scrollTop
+    };
+  }
+  return {
+    x: scrollable.scrollLeft,
+    y: scrollable.scrollTop
+  };
+}
+
+module.exports = getUnboundedScrollPosition;
+
+},{}],110:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule hyphenate
+ * @typechecks
+ */
+
+var _uppercasePattern = /([A-Z])/g;
+
+/**
+ * Hyphenates a camelcased string, for example:
+ *
+ *   > hyphenate('backgroundColor')
+ *   < "background-color"
+ *
+ * @param {string} string
+ * @return {string}
+ */
+function hyphenate(string) {
+  return string.replace(_uppercasePattern, '-$1').toLowerCase();
+}
+
+module.exports = hyphenate;
+
+},{}],111:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule instantiateReactComponent
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var warning = _dereq_("./warning");
+
+/**
+ * Validate a `componentDescriptor`. This should be exposed publicly in a follow
+ * up diff.
+ *
+ * @param {object} descriptor
+ * @return {boolean} Returns true if this is a valid descriptor of a Component.
+ */
+function isValidComponentDescriptor(descriptor) {
+  return (
+    typeof descriptor.constructor === 'function' &&
+    typeof descriptor.constructor.prototype.construct === 'function' &&
+    typeof descriptor.constructor.prototype.mountComponent === 'function' &&
+    typeof descriptor.constructor.prototype.receiveComponent === 'function'
+  );
+}
+
+/**
+ * Given a `componentDescriptor` create an instance that will actually be
+ * mounted. Currently it just extracts an existing clone from composite
+ * components but this is an implementation detail which will change.
+ *
+ * @param {object} descriptor
+ * @return {object} A new instance of componentDescriptor's constructor.
+ * @protected
+ */
+function instantiateReactComponent(descriptor) {
+  if ("production" !== "development") {
+    ("production" !== "development" ? warning(
+      isValidComponentDescriptor(descriptor),
+      'Only React Components are valid for mounting.'
+    ) : null);
+    // We use the clone of a composite component instead of the original
+    // instance. This allows us to warn you if you're are accessing the wrong
+    // instance.
+    var instance = descriptor.__realComponentInstance || descriptor;
+    instance._descriptor = descriptor;
+    return instance;
+  }
+  // In prod we don't clone, we simply use the same instance for unaffected
+  // behavior. We have to keep the descriptor around for comparison later on.
+  // This should ideally be accepted in the constructor of the instance but
+  // since that is currently overloaded, we just manually attach it here.
+  descriptor._descriptor = descriptor;
+  return descriptor;
+}
+
+module.exports = instantiateReactComponent;
+
+},{"./warning":134}],112:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule invariant
+ */
+
+"use strict";
+
+/**
+ * Use invariant() to assert state which your program assumes to be true.
+ *
+ * Provide sprintf-style format (only %s is supported) and arguments
+ * to provide information about what broke and what you were
+ * expecting.
+ *
+ * The invariant message will be stripped in production, but the invariant
+ * will remain to ensure logic does not differ in production.
+ */
+
+var invariant = function(condition) {
+  if (!condition) {
+    var error = new Error(
+      'Minified exception occured; use the non-minified dev environment for ' +
+      'the full error message and additional helpful warnings.'
+    );
+    error.framesToPop = 1;
+    throw error;
+  }
+};
+
+if ("production" !== "development") {
+  invariant = function(condition, format, a, b, c, d, e, f) {
+    if (format === undefined) {
+      throw new Error('invariant requires an error message argument');
+    }
+
+    if (!condition) {
+      var args = [a, b, c, d, e, f];
+      var argIndex = 0;
+      var error = new Error(
+        'Invariant Violation: ' +
+        format.replace(/%s/g, function() { return args[argIndex++]; })
+      );
+      error.framesToPop = 1; // we don't care about invariant's own frame
+      throw error;
+    }
+  };
+}
+
+module.exports = invariant;
+
+},{}],113:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule isEventSupported
+ */
+
+"use strict";
+
+var ExecutionEnvironment = _dereq_("./ExecutionEnvironment");
+
+var useHasFeature;
+if (ExecutionEnvironment.canUseDOM) {
+  useHasFeature =
+    document.implementation &&
+    document.implementation.hasFeature &&
+    // always returns true in newer browsers as per the standard.
+    // @see http://dom.spec.whatwg.org/#dom-domimplementation-hasfeature
+    document.implementation.hasFeature('', '') !== true;
+}
+
+/**
+ * Checks if an event is supported in the current execution environment.
+ *
+ * NOTE: This will not work correctly for non-generic events such as `change`,
+ * `reset`, `load`, `error`, and `select`.
+ *
+ * Borrows from Modernizr.
+ *
+ * @param {string} eventNameSuffix Event name, e.g. "click".
+ * @param {?boolean} capture Check if the capture phase is supported.
+ * @return {boolean} True if the event is supported.
+ * @internal
+ * @license Modernizr 3.0.0pre (Custom Build) | MIT
+ */
+function isEventSupported(eventNameSuffix, capture) {
+  if (!ExecutionEnvironment.canUseDOM ||
+      capture && !('addEventListener' in document)) {
+    return false;
+  }
+
+  var eventName = 'on' + eventNameSuffix;
+  var isSupported = eventName in document;
+
+  if (!isSupported) {
+    var element = document.createElement('div');
+    element.setAttribute(eventName, 'return;');
+    isSupported = typeof element[eventName] === 'function';
+  }
+
+  if (!isSupported && useHasFeature && eventNameSuffix === 'wheel') {
+    // This is the only way to test support for the `wheel` event in IE9+.
+    isSupported = document.implementation.hasFeature('Events.wheel', '3.0');
+  }
+
+  return isSupported;
+}
+
+module.exports = isEventSupported;
+
+},{"./ExecutionEnvironment":20}],114:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule isNode
+ * @typechecks
+ */
+
+/**
+ * @param {*} object The object to check.
+ * @return {boolean} Whether or not the object is a DOM node.
+ */
+function isNode(object) {
+  return !!(object && (
+    typeof Node === 'function' ? object instanceof Node :
+      typeof object === 'object' &&
+      typeof object.nodeType === 'number' &&
+      typeof object.nodeName === 'string'
+  ));
+}
+
+module.exports = isNode;
+
+},{}],115:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule isTextInputElement
+ */
+
+"use strict";
+
+/**
+ * @see http://www.whatwg.org/specs/web-apps/current-work/multipage/the-input-element.html#input-type-attr-summary
+ */
+var supportedInputTypes = {
+  'color': true,
+  'date': true,
+  'datetime': true,
+  'datetime-local': true,
+  'email': true,
+  'month': true,
+  'number': true,
+  'password': true,
+  'range': true,
+  'search': true,
+  'tel': true,
+  'text': true,
+  'time': true,
+  'url': true,
+  'week': true
+};
+
+function isTextInputElement(elem) {
+  return elem && (
+    (elem.nodeName === 'INPUT' && supportedInputTypes[elem.type]) ||
+    elem.nodeName === 'TEXTAREA'
+  );
+}
+
+module.exports = isTextInputElement;
+
+},{}],116:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule isTextNode
+ * @typechecks
+ */
+
+var isNode = _dereq_("./isNode");
+
+/**
+ * @param {*} object The object to check.
+ * @return {boolean} Whether or not the object is a DOM text node.
+ */
+function isTextNode(object) {
+  return isNode(object) && object.nodeType == 3;
+}
+
+module.exports = isTextNode;
+
+},{"./isNode":114}],117:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule joinClasses
+ * @typechecks static-only
+ */
+
+"use strict";
+
+/**
+ * Combines multiple className strings into one.
+ * http://jsperf.com/joinclasses-args-vs-array
+ *
+ * @param {...?string} classes
+ * @return {string}
+ */
+function joinClasses(className/*, ... */) {
+  if (!className) {
+    className = '';
+  }
+  var nextClass;
+  var argLength = arguments.length;
+  if (argLength > 1) {
+    for (var ii = 1; ii < argLength; ii++) {
+      nextClass = arguments[ii];
+      nextClass && (className += ' ' + nextClass);
+    }
+  }
+  return className;
+}
+
+module.exports = joinClasses;
+
+},{}],118:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule keyMirror
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var invariant = _dereq_("./invariant");
+
+/**
+ * Constructs an enumeration with keys equal to their value.
+ *
+ * For example:
+ *
+ *   var COLORS = keyMirror({blue: null, red: null});
+ *   var myColor = COLORS.blue;
+ *   var isColorValid = !!COLORS[myColor];
+ *
+ * The last line could not be performed if the values of the generated enum were
+ * not equal to their keys.
+ *
+ *   Input:  {key1: val1, key2: val2}
+ *   Output: {key1: key1, key2: key2}
+ *
+ * @param {object} obj
+ * @return {object}
+ */
+var keyMirror = function(obj) {
+  var ret = {};
+  var key;
+  ("production" !== "development" ? invariant(
+    obj instanceof Object && !Array.isArray(obj),
+    'keyMirror(...): Argument must be an object.'
+  ) : invariant(obj instanceof Object && !Array.isArray(obj)));
+  for (key in obj) {
+    if (!obj.hasOwnProperty(key)) {
+      continue;
+    }
+    ret[key] = key;
+  }
+  return ret;
+};
+
+module.exports = keyMirror;
+
+},{"./invariant":112}],119:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule keyOf
+ */
+
+/**
+ * Allows extraction of a minified key. Let's the build system minify keys
+ * without loosing the ability to dynamically use key strings as values
+ * themselves. Pass in an object with a single key/val pair and it will return
+ * you the string key of that single record. Suppose you want to grab the
+ * value for a key 'className' inside of an object. Key/val minification may
+ * have aliased that key to be 'xa12'. keyOf({className: null}) will return
+ * 'xa12' in that case. Resolve keys you want to use once at startup time, then
+ * reuse those resolutions.
+ */
+var keyOf = function(oneKeyObj) {
+  var key;
+  for (key in oneKeyObj) {
+    if (!oneKeyObj.hasOwnProperty(key)) {
+      continue;
+    }
+    return key;
+  }
+  return null;
+};
+
+
+module.exports = keyOf;
+
+},{}],120:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule memoizeStringOnly
+ * @typechecks static-only
+ */
+
+"use strict";
+
+/**
+ * Memoizes the return value of a function that accepts one string argument.
+ *
+ * @param {function} callback
+ * @return {function}
+ */
+function memoizeStringOnly(callback) {
+  var cache = {};
+  return function(string) {
+    if (cache.hasOwnProperty(string)) {
+      return cache[string];
+    } else {
+      return cache[string] = callback.call(this, string);
+    }
+  };
+}
+
+module.exports = memoizeStringOnly;
+
+},{}],121:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule merge
+ */
+
+"use strict";
+
+var mergeInto = _dereq_("./mergeInto");
+
+/**
+ * Shallow merges two structures into a return value, without mutating either.
+ *
+ * @param {?object} one Optional object with properties to merge from.
+ * @param {?object} two Optional object with properties to merge from.
+ * @return {object} The shallow extension of one by two.
+ */
+var merge = function(one, two) {
+  var result = {};
+  mergeInto(result, one);
+  mergeInto(result, two);
+  return result;
+};
+
+module.exports = merge;
+
+},{"./mergeInto":123}],122:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule mergeHelpers
+ *
+ * requiresPolyfills: Array.isArray
+ */
+
+"use strict";
+
+var invariant = _dereq_("./invariant");
+var keyMirror = _dereq_("./keyMirror");
+
+/**
+ * Maximum number of levels to traverse. Will catch circular structures.
+ * @const
+ */
+var MAX_MERGE_DEPTH = 36;
+
+/**
+ * We won't worry about edge cases like new String('x') or new Boolean(true).
+ * Functions are considered terminals, and arrays are not.
+ * @param {*} o The item/object/value to test.
+ * @return {boolean} true iff the argument is a terminal.
+ */
+var isTerminal = function(o) {
+  return typeof o !== 'object' || o === null;
+};
+
+var mergeHelpers = {
+
+  MAX_MERGE_DEPTH: MAX_MERGE_DEPTH,
+
+  isTerminal: isTerminal,
+
+  /**
+   * Converts null/undefined values into empty object.
+   *
+   * @param {?Object=} arg Argument to be normalized (nullable optional)
+   * @return {!Object}
+   */
+  normalizeMergeArg: function(arg) {
+    return arg === undefined || arg === null ? {} : arg;
+  },
+
+  /**
+   * If merging Arrays, a merge strategy *must* be supplied. If not, it is
+   * likely the caller's fault. If this function is ever called with anything
+   * but `one` and `two` being `Array`s, it is the fault of the merge utilities.
+   *
+   * @param {*} one Array to merge into.
+   * @param {*} two Array to merge from.
+   */
+  checkMergeArrayArgs: function(one, two) {
+    ("production" !== "development" ? invariant(
+      Array.isArray(one) && Array.isArray(two),
+      'Tried to merge arrays, instead got %s and %s.',
+      one,
+      two
+    ) : invariant(Array.isArray(one) && Array.isArray(two)));
+  },
+
+  /**
+   * @param {*} one Object to merge into.
+   * @param {*} two Object to merge from.
+   */
+  checkMergeObjectArgs: function(one, two) {
+    mergeHelpers.checkMergeObjectArg(one);
+    mergeHelpers.checkMergeObjectArg(two);
+  },
+
+  /**
+   * @param {*} arg
+   */
+  checkMergeObjectArg: function(arg) {
+    ("production" !== "development" ? invariant(
+      !isTerminal(arg) && !Array.isArray(arg),
+      'Tried to merge an object, instead got %s.',
+      arg
+    ) : invariant(!isTerminal(arg) && !Array.isArray(arg)));
+  },
+
+  /**
+   * Checks that a merge was not given a circular object or an object that had
+   * too great of depth.
+   *
+   * @param {number} Level of recursion to validate against maximum.
+   */
+  checkMergeLevel: function(level) {
+    ("production" !== "development" ? invariant(
+      level < MAX_MERGE_DEPTH,
+      'Maximum deep merge depth exceeded. You may be attempting to merge ' +
+      'circular structures in an unsupported way.'
+    ) : invariant(level < MAX_MERGE_DEPTH));
+  },
+
+  /**
+   * Checks that the supplied merge strategy is valid.
+   *
+   * @param {string} Array merge strategy.
+   */
+  checkArrayStrategy: function(strategy) {
+    ("production" !== "development" ? invariant(
+      strategy === undefined || strategy in mergeHelpers.ArrayStrategies,
+      'You must provide an array strategy to deep merge functions to ' +
+      'instruct the deep merge how to resolve merging two arrays.'
+    ) : invariant(strategy === undefined || strategy in mergeHelpers.ArrayStrategies));
+  },
+
+  /**
+   * Set of possible behaviors of merge algorithms when encountering two Arrays
+   * that must be merged together.
+   * - `clobber`: The left `Array` is ignored.
+   * - `indexByIndex`: The result is achieved by recursively deep merging at
+   *   each index. (not yet supported.)
+   */
+  ArrayStrategies: keyMirror({
+    Clobber: true,
+    IndexByIndex: true
+  })
+
+};
+
+module.exports = mergeHelpers;
+
+},{"./invariant":112,"./keyMirror":118}],123:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule mergeInto
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var mergeHelpers = _dereq_("./mergeHelpers");
+
+var checkMergeObjectArg = mergeHelpers.checkMergeObjectArg;
+
+/**
+ * Shallow merges two structures by mutating the first parameter.
+ *
+ * @param {object} one Object to be merged into.
+ * @param {?object} two Optional object with properties to merge from.
+ */
+function mergeInto(one, two) {
+  checkMergeObjectArg(one);
+  if (two != null) {
+    checkMergeObjectArg(two);
+    for (var key in two) {
+      if (!two.hasOwnProperty(key)) {
+        continue;
+      }
+      one[key] = two[key];
+    }
+  }
+}
+
+module.exports = mergeInto;
+
+},{"./mergeHelpers":122}],124:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule mixInto
+ */
+
+"use strict";
+
+/**
+ * Simply copies properties to the prototype.
+ */
+var mixInto = function(constructor, methodBag) {
+  var methodName;
+  for (methodName in methodBag) {
+    if (!methodBag.hasOwnProperty(methodName)) {
+      continue;
+    }
+    constructor.prototype[methodName] = methodBag[methodName];
+  }
+};
+
+module.exports = mixInto;
+
+},{}],125:[function(_dereq_,module,exports){
+/**
+ * Copyright 2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule monitorCodeUse
+ */
+
+"use strict";
+
+var invariant = _dereq_("./invariant");
+
+/**
+ * Provides open-source compatible instrumentation for monitoring certain API
+ * uses before we're ready to issue a warning or refactor. It accepts an event
+ * name which may only contain the characters [a-z0-9_] and an optional data
+ * object with further information.
+ */
+
+function monitorCodeUse(eventName, data) {
+  ("production" !== "development" ? invariant(
+    eventName && !/[^a-z0-9_]/.test(eventName),
+    'You must provide an eventName using only the characters [a-z0-9_]'
+  ) : invariant(eventName && !/[^a-z0-9_]/.test(eventName)));
+}
+
+module.exports = monitorCodeUse;
+
+},{"./invariant":112}],126:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule objMap
+ */
+
+"use strict";
+
+/**
+ * For each key/value pair, invokes callback func and constructs a resulting
+ * object which contains, for every key in obj, values that are the result of
+ * of invoking the function:
+ *
+ *   func(value, key, iteration)
+ *
+ * @param {?object} obj Object to map keys over
+ * @param {function} func Invoked for each key/val pair.
+ * @param {?*} context
+ * @return {?object} Result of mapping or null if obj is falsey
+ */
+function objMap(obj, func, context) {
+  if (!obj) {
+    return null;
+  }
+  var i = 0;
+  var ret = {};
+  for (var key in obj) {
+    if (obj.hasOwnProperty(key)) {
+      ret[key] = func.call(context, obj[key], key, i++);
+    }
+  }
+  return ret;
+}
+
+module.exports = objMap;
+
+},{}],127:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule objMapKeyVal
+ */
+
+"use strict";
+
+/**
+ * Behaves the same as `objMap` but invokes func with the key first, and value
+ * second. Use `objMap` unless you need this special case.
+ * Invokes func as:
+ *
+ *   func(key, value, iteration)
+ *
+ * @param {?object} obj Object to map keys over
+ * @param {!function} func Invoked for each key/val pair.
+ * @param {?*} context
+ * @return {?object} Result of mapping or null if obj is falsey
+ */
+function objMapKeyVal(obj, func, context) {
+  if (!obj) {
+    return null;
+  }
+  var i = 0;
+  var ret = {};
+  for (var key in obj) {
+    if (obj.hasOwnProperty(key)) {
+      ret[key] = func.call(context, key, obj[key], i++);
+    }
+  }
+  return ret;
+}
+
+module.exports = objMapKeyVal;
+
+},{}],128:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule onlyChild
+ */
+"use strict";
+
+var ReactComponent = _dereq_("./ReactComponent");
+
+var invariant = _dereq_("./invariant");
+
+/**
+ * Returns the first child in a collection of children and verifies that there
+ * is only one child in the collection. The current implementation of this
+ * function assumes that a single child gets passed without a wrapper, but the
+ * purpose of this helper function is to abstract away the particular structure
+ * of children.
+ *
+ * @param {?object} children Child collection structure.
+ * @return {ReactComponent} The first and only `ReactComponent` contained in the
+ * structure.
+ */
+function onlyChild(children) {
+  ("production" !== "development" ? invariant(
+    ReactComponent.isValidComponent(children),
+    'onlyChild must be passed a children with exactly one child.'
+  ) : invariant(ReactComponent.isValidComponent(children)));
+  return children;
+}
+
+module.exports = onlyChild;
+
+},{"./ReactComponent":27,"./invariant":112}],129:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule performanceNow
+ * @typechecks static-only
+ */
+
+"use strict";
+
+var ExecutionEnvironment = _dereq_("./ExecutionEnvironment");
+
+/**
+ * Detect if we can use window.performance.now() and gracefully
+ * fallback to Date.now() if it doesn't exist.
+ * We need to support Firefox < 15 for now due to Facebook's webdriver
+ * infrastructure.
+ */
+var performance = null;
+
+if (ExecutionEnvironment.canUseDOM) {
+  performance = window.performance || window.webkitPerformance;
+}
+
+if (!performance || !performance.now) {
+  performance = Date;
+}
+
+var performanceNow = performance.now.bind(performance);
+
+module.exports = performanceNow;
+
+},{"./ExecutionEnvironment":20}],130:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule shallowEqual
+ */
+
+"use strict";
+
+/**
+ * Performs equality by iterating through keys on an object and returning
+ * false when any key has values which are not strictly equal between
+ * objA and objB. Returns true when the values of all keys are strictly equal.
+ *
+ * @return {boolean}
+ */
+function shallowEqual(objA, objB) {
+  if (objA === objB) {
+    return true;
+  }
+  var key;
+  // Test for A's keys different from B.
+  for (key in objA) {
+    if (objA.hasOwnProperty(key) &&
+        (!objB.hasOwnProperty(key) || objA[key] !== objB[key])) {
+      return false;
+    }
+  }
+  // Test for B'a keys missing from A.
+  for (key in objB) {
+    if (objB.hasOwnProperty(key) && !objA.hasOwnProperty(key)) {
+      return false;
+    }
+  }
+  return true;
+}
+
+module.exports = shallowEqual;
+
+},{}],131:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule shouldUpdateReactComponent
+ * @typechecks static-only
+ */
+
+"use strict";
+
+/**
+ * Given a `prevComponentInstance` and `nextComponent`, determines if
+ * `prevComponentInstance` should be updated as opposed to being destroyed or
+ * replaced by a new instance. The second argument is a descriptor. Future
+ * versions of the reconciler should only compare descriptors to other
+ * descriptors.
+ *
+ * @param {?object} prevComponentInstance
+ * @param {?object} nextDescriptor
+ * @return {boolean} True if `prevComponentInstance` should be updated.
+ * @protected
+ */
+function shouldUpdateReactComponent(prevComponentInstance, nextDescriptor) {
+  // TODO: Remove warning after a release.
+  if (prevComponentInstance && nextDescriptor &&
+      prevComponentInstance.constructor === nextDescriptor.constructor && (
+        (prevComponentInstance.props && prevComponentInstance.props.key) ===
+        (nextDescriptor.props && nextDescriptor.props.key)
+      )) {
+    if (prevComponentInstance._owner === nextDescriptor._owner) {
+      return true;
+    } else {
+      if ("production" !== "development") {
+        if (prevComponentInstance.state) {
+          console.warn(
+            'A recent change to React has been found to impact your code. ' +
+            'A mounted component will now be unmounted and replaced by a ' +
+            'component (of the same class) if their owners are different. ' +
+            'Previously, ownership was not considered when updating.',
+            prevComponentInstance,
+            nextDescriptor
+          );
+        }
+      }
+    }
+  }
+  return false;
+}
+
+module.exports = shouldUpdateReactComponent;
+
+},{}],132:[function(_dereq_,module,exports){
+/**
+ * Copyright 2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule toArray
+ * @typechecks
+ */
+
+var invariant = _dereq_("./invariant");
+
+/**
+ * Convert array-like objects to arrays.
+ *
+ * This API assumes the caller knows the contents of the data type. For less
+ * well defined inputs use createArrayFrom.
+ *
+ * @param {object|function} obj
+ * @return {array}
+ */
+function toArray(obj) {
+  var length = obj.length;
+
+  // Some browse builtin objects can report typeof 'function' (e.g. NodeList in
+  // old versions of Safari).
+  ("production" !== "development" ? invariant(
+    !Array.isArray(obj) &&
+    (typeof obj === 'object' || typeof obj === 'function'),
+    'toArray: Array-like object expected'
+  ) : invariant(!Array.isArray(obj) &&
+  (typeof obj === 'object' || typeof obj === 'function')));
+
+  ("production" !== "development" ? invariant(
+    typeof length === 'number',
+    'toArray: Object needs a length property'
+  ) : invariant(typeof length === 'number'));
+
+  ("production" !== "development" ? invariant(
+    length === 0 ||
+    (length - 1) in obj,
+    'toArray: Object should have keys for indices'
+  ) : invariant(length === 0 ||
+  (length - 1) in obj));
+
+  // Old IE doesn't give collections access to hasOwnProperty. Assume inputs
+  // without method will throw during the slice call and skip straight to the
+  // fallback.
+  if (obj.hasOwnProperty) {
+    try {
+      return Array.prototype.slice.call(obj);
+    } catch (e) {
+      // IE < 9 does not support Array#slice on collections objects
+    }
+  }
+
+  // Fall back to copying key by key. This assumes all keys have a value,
+  // so will not preserve sparsely populated inputs.
+  var ret = Array(length);
+  for (var ii = 0; ii < length; ii++) {
+    ret[ii] = obj[ii];
+  }
+  return ret;
+}
+
+module.exports = toArray;
+
+},{"./invariant":112}],133:[function(_dereq_,module,exports){
+/**
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule traverseAllChildren
+ */
+
+"use strict";
+
+var ReactInstanceHandles = _dereq_("./ReactInstanceHandles");
+var ReactTextComponent = _dereq_("./ReactTextComponent");
+
+var invariant = _dereq_("./invariant");
+
+var SEPARATOR = ReactInstanceHandles.SEPARATOR;
+var SUBSEPARATOR = ':';
+
+/**
+ * TODO: Test that:
+ * 1. `mapChildren` transforms strings and numbers into `ReactTextComponent`.
+ * 2. it('should fail when supplied duplicate key', function() {
+ * 3. That a single child and an array with one item have the same key pattern.
+ * });
+ */
+
+var userProvidedKeyEscaperLookup = {
+  '=': '=0',
+  '.': '=1',
+  ':': '=2'
+};
+
+var userProvidedKeyEscapeRegex = /[=.:]/g;
+
+function userProvidedKeyEscaper(match) {
+  return userProvidedKeyEscaperLookup[match];
+}
+
+/**
+ * Generate a key string that identifies a component within a set.
+ *
+ * @param {*} component A component that could contain a manual key.
+ * @param {number} index Index that is used if a manual key is not provided.
+ * @return {string}
+ */
+function getComponentKey(component, index) {
+  if (component && component.props && component.props.key != null) {
+    // Explicit key
+    return wrapUserProvidedKey(component.props.key);
+  }
+  // Implicit key determined by the index in the set
+  return index.toString(36);
+}
+
+/**
+ * Escape a component key so that it is safe to use in a reactid.
+ *
+ * @param {*} key Component key to be escaped.
+ * @return {string} An escaped string.
+ */
+function escapeUserProvidedKey(text) {
+  return ('' + text).replace(
+    userProvidedKeyEscapeRegex,
+    userProvidedKeyEscaper
+  );
+}
+
+/**
+ * Wrap a `key` value explicitly provided by the user to distinguish it from
+ * implicitly-generated keys generated by a component's index in its parent.
+ *
+ * @param {string} key Value of a user-provided `key` attribute
+ * @return {string}
+ */
+function wrapUserProvidedKey(key) {
+  return '$' + escapeUserProvidedKey(key);
+}
+
+/**
+ * @param {?*} children Children tree container.
+ * @param {!string} nameSoFar Name of the key path so far.
+ * @param {!number} indexSoFar Number of children encountered until this point.
+ * @param {!function} callback Callback to invoke with each child found.
+ * @param {?*} traverseContext Used to pass information throughout the traversal
+ * process.
+ * @return {!number} The number of children in this subtree.
+ */
+var traverseAllChildrenImpl =
+  function(children, nameSoFar, indexSoFar, callback, traverseContext) {
+    var subtreeCount = 0;  // Count of children found in the current subtree.
+    if (Array.isArray(children)) {
+      for (var i = 0; i < children.length; i++) {
+        var child = children[i];
+        var nextName = (
+          nameSoFar +
+          (nameSoFar ? SUBSEPARATOR : SEPARATOR) +
+          getComponentKey(child, i)
+        );
+        var nextIndex = indexSoFar + subtreeCount;
+        subtreeCount += traverseAllChildrenImpl(
+          child,
+          nextName,
+          nextIndex,
+          callback,
+          traverseContext
+        );
+      }
+    } else {
+      var type = typeof children;
+      var isOnlyChild = nameSoFar === '';
+      // If it's the only child, treat the name as if it was wrapped in an array
+      // so that it's consistent if the number of children grows
+      var storageName =
+        isOnlyChild ? SEPARATOR + getComponentKey(children, 0) : nameSoFar;
+      if (children == null || type === 'boolean') {
+        // All of the above are perceived as null.
+        callback(traverseContext, null, storageName, indexSoFar);
+        subtreeCount = 1;
+      } else if (children.type && children.type.prototype &&
+                 children.type.prototype.mountComponentIntoNode) {
+        callback(traverseContext, children, storageName, indexSoFar);
+        subtreeCount = 1;
+      } else {
+        if (type === 'object') {
+          ("production" !== "development" ? invariant(
+            !children || children.nodeType !== 1,
+            'traverseAllChildren(...): Encountered an invalid child; DOM ' +
+            'elements are not valid children of React components.'
+          ) : invariant(!children || children.nodeType !== 1));
+          for (var key in children) {
+            if (children.hasOwnProperty(key)) {
+              subtreeCount += traverseAllChildrenImpl(
+                children[key],
+                (
+                  nameSoFar + (nameSoFar ? SUBSEPARATOR : SEPARATOR) +
+                  wrapUserProvidedKey(key) + SUBSEPARATOR +
+                  getComponentKey(children[key], 0)
+                ),
+                indexSoFar + subtreeCount,
+                callback,
+                traverseContext
+              );
+            }
+          }
+        } else if (type === 'string') {
+          var normalizedText = new ReactTextComponent(children);
+          callback(traverseContext, normalizedText, storageName, indexSoFar);
+          subtreeCount += 1;
+        } else if (type === 'number') {
+          var normalizedNumber = new ReactTextComponent('' + children);
+          callback(traverseContext, normalizedNumber, storageName, indexSoFar);
+          subtreeCount += 1;
+        }
+      }
+    }
+    return subtreeCount;
+  };
+
+/**
+ * Traverses children that are typically specified as `props.children`, but
+ * might also be specified through attributes:
+ *
+ * - `traverseAllChildren(this.props.children, ...)`
+ * - `traverseAllChildren(this.props.leftPanelChildren, ...)`
+ *
+ * The `traverseContext` is an optional argument that is passed through the
+ * entire traversal. It can be used to store accumulations or anything else that
+ * the callback might find relevant.
+ *
+ * @param {?*} children Children tree object.
+ * @param {!function} callback To invoke upon traversing each child.
+ * @param {?*} traverseContext Context for traversal.
+ */
+function traverseAllChildren(children, callback, traverseContext) {
+  if (children !== null && children !== undefined) {
+    traverseAllChildrenImpl(children, '', 0, callback, traverseContext);
+  }
+}
+
+module.exports = traverseAllChildren;
+
+},{"./ReactInstanceHandles":53,"./ReactTextComponent":70,"./invariant":112}],134:[function(_dereq_,module,exports){
+/**
+ * Copyright 2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ *
+ * @providesModule warning
+ */
+
+"use strict";
+
+var emptyFunction = _dereq_("./emptyFunction");
+
+/**
+ * Similar to invariant but only logs a warning if the condition is not met.
+ * This can be used to log issues in development environments in critical
+ * paths. Removing the logging code for production environments will keep the
+ * same logic and follow the same code paths.
+ */
+
+var warning = emptyFunction;
+
+if ("production" !== "development") {
+  warning = function(condition, format ) {var args=Array.prototype.slice.call(arguments,2);
+    if (format === undefined) {
+      throw new Error(
+        '`warning(condition, format, ...args)` requires a warning ' +
+        'message argument'
+      );
+    }
+
+    if (!condition) {
+      var argIndex = 0;
+      console.warn('Warning: ' + format.replace(/%s/g, function()  {return args[argIndex++];}));
+    }
+  };
+}
+
+module.exports = warning;
+
+},{"./emptyFunction":96}]},{},[24])
+(24)
+});
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/js/react/react.min.js elefant-elefant_1_3_10_beta/apps/user/js/react/react.min.js
--- elefant-elefant_1_3_9_beta/apps/user/js/react/react.min.js	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/js/react/react.min.js	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,21 @@
+/**
+ * React v0.10.0
+ *
+ * Copyright 2013-2014 Facebook, Inc.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.React=e()}}(function(){return function e(t,n,o){function r(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);throw new Error("Cannot find module '"+a+"'")}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return r(n?n:e)},c,c.exports,e,t,n,o)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}({1:[function(e,t){"use strict";var n=e("./focusNode"),o={componentDidMount:function(){this.props.autoFocus&&n(this.getDOMNode())}};t.exports=o},{"./focusNode":98}],2:[function(e,t){"use strict";function n(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1)}var o={columnCount:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},r=["Webkit","ms","Moz","O"];Object.keys(o).forEach(function(e){r.forEach(function(t){o[n(t,e)]=o[e]})});var i={background:{backgroundImage:!0,backgroundPosition:!0,backgroundRepeat:!0,backgroundColor:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0}},a={isUnitlessNumber:o,shorthandPropertyExpansions:i};t.exports=a},{}],3:[function(e,t){"use strict";var n=e("./CSSProperty"),o=e("./dangerousStyleValue"),r=e("./escapeTextForBrowser"),i=e("./hyphenate"),a=e("./memoizeStringOnly"),s=a(function(e){return r(i(e))}),u={createMarkupForStyles:function(e){var t="";for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];null!=r&&(t+=s(n)+":",t+=o(n,r)+";")}return t||null},setValueForStyles:function(e,t){var r=e.style;for(var i in t)if(t.hasOwnProperty(i)){var a=o(i,t[i]);if(a)r[i]=a;else{var s=n.shorthandPropertyExpansions[i];if(s)for(var u in s)r[u]="";else r[i]=""}}}};t.exports=u},{"./CSSProperty":2,"./dangerousStyleValue":93,"./escapeTextForBrowser":96,"./hyphenate":108,"./memoizeStringOnly":118}],4:[function(e,t){"use strict";function n(e){return"SELECT"===e.nodeName||"INPUT"===e.nodeName&&"file"===e.type}function o(e){var t=M.getPooled(O.change,T,e);y.accumulateTwoPhaseDispatches(t),R.batchedUpdates(r,t)}function r(e){C.enqueueEvents(e),C.processEventQueue()}function i(e,t){I=e,T=t,I.attachEvent("onchange",o)}function a(){I&&(I.detachEvent("onchange",o),I=null,T=null)}function s(e,t,n){return e===P.topChange?n:void 0}function u(e,t,n){e===P.topFocus?(a(),i(t,n)):e===P.topBlur&&a()}function c(e,t){I=e,T=t,N=e.value,S=Object.getOwnPropertyDescriptor(e.constructor.prototype,"value"),Object.defineProperty(I,"value",A),I.attachEvent("onpropertychange",p)}function l(){I&&(delete I.value,I.detachEvent("onpropertychange",p),I=null,T=null,N=null,S=null)}function p(e){if("value"===e.propertyName){var t=e.srcElement.value;t!==N&&(N=t,o(e))}}function d(e,t,n){return e===P.topInput?n:void 0}function f(e,t,n){e===P.topFocus?(l(),c(t,n)):e===P.topBlur&&l()}function h(e){return e!==P.topSelectionChange&&e!==P.topKeyUp&&e!==P.topKeyDown||!I||I.value===N?void 0:(N=I.value,T)}function m(e){return"INPUT"===e.nodeName&&("checkbox"===e.type||"radio"===e.type)}function v(e,t,n){return e===P.topClick?n:void 0}var g=e("./EventConstants"),C=e("./EventPluginHub"),y=e("./EventPropagators"),E=e("./ExecutionEnvironment"),R=e("./ReactUpdates"),M=e("./SyntheticEvent"),D=e("./isEventSupported"),x=e("./isTextInputElement"),b=e("./keyOf"),P=g.topLevelTypes,O={change:{phasedRegistrationNames:{bubbled:b({onChange:null}),captured:b({onChangeCapture:null})},dependencies:[P.topBlur,P.topChange,P.topClick,P.topFocus,P.topInput,P.topKeyDown,P.topKeyUp,P.topSelectionChange]}},I=null,T=null,N=null,S=null,_=!1;E.canUseDOM&&(_=D("change")&&(!("documentMode"in document)||document.documentMode>8));var w=!1;E.canUseDOM&&(w=D("input")&&(!("documentMode"in document)||document.documentMode>9));var A={get:function(){return S.get.call(this)},set:function(e){N=""+e,S.set.call(this,e)}},k={eventTypes:O,extractEvents:function(e,t,o,r){var i,a;if(n(t)?_?i=s:a=u:x(t)?w?i=d:(i=h,a=f):m(t)&&(i=v),i){var c=i(e,t,o);if(c){var l=M.getPooled(O.change,c,r);return y.accumulateTwoPhaseDispatches(l),l}}a&&a(e,t,o)}};t.exports=k},{"./EventConstants":14,"./EventPluginHub":16,"./EventPropagators":19,"./ExecutionEnvironment":20,"./ReactUpdates":69,"./SyntheticEvent":76,"./isEventSupported":111,"./isTextInputElement":113,"./keyOf":117}],5:[function(e,t){"use strict";var n=0,o={createReactRootIndex:function(){return n++}};t.exports=o},{}],6:[function(e,t){"use strict";function n(e){switch(e){case g.topCompositionStart:return y.compositionStart;case g.topCompositionEnd:return y.compositionEnd;case g.topCompositionUpdate:return y.compositionUpdate}}function o(e,t){return e===g.topKeyDown&&t.keyCode===h}function r(e,t){switch(e){case g.topKeyUp:return-1!==f.indexOf(t.keyCode);case g.topKeyDown:return t.keyCode!==h;case g.topKeyPress:case g.topMouseDown:case g.topBlur:return!0;default:return!1}}function i(e){this.root=e,this.startSelection=c.getSelection(e),this.startValue=this.getText()}var a=e("./EventConstants"),s=e("./EventPropagators"),u=e("./ExecutionEnvironment"),c=e("./ReactInputSelection"),l=e("./SyntheticCompositionEvent"),p=e("./getTextContentAccessor"),d=e("./keyOf"),f=[9,13,27,32],h=229,m=u.canUseDOM&&"CompositionEvent"in window,v=!m||"documentMode"in document&&document.documentMode>8,g=a.topLevelTypes,C=null,y={compositionEnd:{phasedRegistrationNames:{bubbled:d({onCompositionEnd:null}),captured:d({onCompositionEndCapture:null})},dependencies:[g.topBlur,g.topCompositionEnd,g.topKeyDown,g.topKeyPress,g.topKeyUp,g.topMouseDown]},compositionStart:{phasedRegistrationNames:{bubbled:d({onCompositionStart:null}),captured:d({onCompositionStartCapture:null})},dependencies:[g.topBlur,g.topCompositionStart,g.topKeyDown,g.topKeyPress,g.topKeyUp,g.topMouseDown]},compositionUpdate:{phasedRegistrationNames:{bubbled:d({onCompositionUpdate:null}),captured:d({onCompositionUpdateCapture:null})},dependencies:[g.topBlur,g.topCompositionUpdate,g.topKeyDown,g.topKeyPress,g.topKeyUp,g.topMouseDown]}};i.prototype.getText=function(){return this.root.value||this.root[p()]},i.prototype.getData=function(){var e=this.getText(),t=this.startSelection.start,n=this.startValue.length-this.startSelection.end;return e.substr(t,e.length-n-t)};var E={eventTypes:y,extractEvents:function(e,t,a,u){var c,p;if(m?c=n(e):C?r(e,u)&&(c=y.compositionEnd):o(e,u)&&(c=y.compositionStart),v&&(C||c!==y.compositionStart?c===y.compositionEnd&&C&&(p=C.getData(),C=null):C=new i(t)),c){var d=l.getPooled(c,a,u);return p&&(d.data=p),s.accumulateTwoPhaseDispatches(d),d}}};t.exports=E},{"./EventConstants":14,"./EventPropagators":19,"./ExecutionEnvironment":20,"./ReactInputSelection":50,"./SyntheticCompositionEvent":74,"./getTextContentAccessor":106,"./keyOf":117}],7:[function(e,t){"use strict";function n(e,t,n){var o=e.childNodes;o[n]!==t&&(t.parentNode===e&&e.removeChild(t),n>=o.length?e.appendChild(t):e.insertBefore(t,o[n]))}var o,r=e("./Danger"),i=e("./ReactMultiChildUpdateTypes"),a=e("./getTextContentAccessor"),s=a();o="textContent"===s?function(e,t){e.textContent=t}:function(e,t){for(;e.firstChild;)e.removeChild(e.firstChild);if(t){var n=e.ownerDocument||document;e.appendChild(n.createTextNode(t))}};var u={dangerouslyReplaceNodeWithMarkup:r.dangerouslyReplaceNodeWithMarkup,updateTextContent:o,processUpdates:function(e,t){for(var a,s=null,u=null,c=0;a=e[c];c++)if(a.type===i.MOVE_EXISTING||a.type===i.REMOVE_NODE){var l=a.fromIndex,p=a.parentNode.childNodes[l],d=a.parentID;s=s||{},s[d]=s[d]||[],s[d][l]=p,u=u||[],u.push(p)}var f=r.dangerouslyRenderMarkup(t);if(u)for(var h=0;h<u.length;h++)u[h].parentNode.removeChild(u[h]);for(var m=0;a=e[m];m++)switch(a.type){case i.INSERT_MARKUP:n(a.parentNode,f[a.markupIndex],a.toIndex);break;case i.MOVE_EXISTING:n(a.parentNode,s[a.parentID][a.fromIndex],a.toIndex);break;case i.TEXT_CONTENT:o(a.parentNode,a.textContent);break;case i.REMOVE_NODE:}}};t.exports=u},{"./Danger":10,"./ReactMultiChildUpdateTypes":56,"./getTextContentAccessor":106}],8:[function(e,t){"use strict";var n=e("./invariant"),o={MUST_USE_ATTRIBUTE:1,MUST_USE_PROPERTY:2,HAS_SIDE_EFFECTS:4,HAS_BOOLEAN_VALUE:8,HAS_POSITIVE_NUMERIC_VALUE:16,injectDOMPropertyConfig:function(e){var t=e.Properties||{},r=e.DOMAttributeNames||{},a=e.DOMPropertyNames||{},s=e.DOMMutationMethods||{};e.isCustomAttribute&&i._isCustomAttributeFunctions.push(e.isCustomAttribute);for(var u in t){n(!i.isStandardName[u]),i.isStandardName[u]=!0;var c=u.toLowerCase();i.getPossibleStandardName[c]=u;var l=r[u];l&&(i.getPossibleStandardName[l]=u),i.getAttributeName[u]=l||c,i.getPropertyName[u]=a[u]||u;var p=s[u];p&&(i.getMutationMethod[u]=p);var d=t[u];i.mustUseAttribute[u]=d&o.MUST_USE_ATTRIBUTE,i.mustUseProperty[u]=d&o.MUST_USE_PROPERTY,i.hasSideEffects[u]=d&o.HAS_SIDE_EFFECTS,i.hasBooleanValue[u]=d&o.HAS_BOOLEAN_VALUE,i.hasPositiveNumericValue[u]=d&o.HAS_POSITIVE_NUMERIC_VALUE,n(!i.mustUseAttribute[u]||!i.mustUseProperty[u]),n(i.mustUseProperty[u]||!i.hasSideEffects[u]),n(!i.hasBooleanValue[u]||!i.hasPositiveNumericValue[u])}}},r={},i={ID_ATTRIBUTE_NAME:"data-reactid",isStandardName:{},getPossibleStandardName:{},getAttributeName:{},getPropertyName:{},getMutationMethod:{},mustUseAttribute:{},mustUseProperty:{},hasSideEffects:{},hasBooleanValue:{},hasPositiveNumericValue:{},_isCustomAttributeFunctions:[],isCustomAttribute:function(e){for(var t=0;t<i._isCustomAttributeFunctions.length;t++){var n=i._isCustomAttributeFunctions[t];if(n(e))return!0}return!1},getDefaultValueForProperty:function(e,t){var n,o=r[e];return o||(r[e]=o={}),t in o||(n=document.createElement(e),o[t]=n[t]),o[t]},injection:o};t.exports=i},{"./invariant":110}],9:[function(e,t){"use strict";function n(e,t){return null==t||o.hasBooleanValue[e]&&!t||o.hasPositiveNumericValue[e]&&(isNaN(t)||1>t)}var o=e("./DOMProperty"),r=e("./escapeTextForBrowser"),i=e("./memoizeStringOnly"),a=(e("./warning"),i(function(e){return r(e)+'="'})),s={createMarkupForID:function(e){return a(o.ID_ATTRIBUTE_NAME)+r(e)+'"'},createMarkupForProperty:function(e,t){if(o.isStandardName[e]){if(n(e,t))return"";var i=o.getAttributeName[e];return o.hasBooleanValue[e]?r(i):a(i)+r(t)+'"'}return o.isCustomAttribute(e)?null==t?"":a(e)+r(t)+'"':null},setValueForProperty:function(e,t,r){if(o.isStandardName[t]){var i=o.getMutationMethod[t];if(i)i(e,r);else if(n(t,r))this.deleteValueForProperty(e,t);else if(o.mustUseAttribute[t])e.setAttribute(o.getAttributeName[t],""+r);else{var a=o.getPropertyName[t];o.hasSideEffects[t]&&e[a]===r||(e[a]=r)}}else o.isCustomAttribute(t)&&(null==r?e.removeAttribute(o.getAttributeName[t]):e.setAttribute(t,""+r))},deleteValueForProperty:function(e,t){if(o.isStandardName[t]){var n=o.getMutationMethod[t];if(n)n(e,void 0);else if(o.mustUseAttribute[t])e.removeAttribute(o.getAttributeName[t]);else{var r=o.getPropertyName[t],i=o.getDefaultValueForProperty(e.nodeName,r);o.hasSideEffects[t]&&e[r]===i||(e[r]=i)}}else o.isCustomAttribute(t)&&e.removeAttribute(t)}};t.exports=s},{"./DOMProperty":8,"./escapeTextForBrowser":96,"./memoizeStringOnly":118,"./warning":131}],10:[function(e,t){"use strict";function n(e){return e.substring(1,e.indexOf(" "))}var o=e("./ExecutionEnvironment"),r=e("./createNodesFromMarkup"),i=e("./emptyFunction"),a=e("./getMarkupWrap"),s=e("./invariant"),u=/^(<[^ \/>]+)/,c="data-danger-index",l={dangerouslyRenderMarkup:function(e){s(o.canUseDOM);for(var t,l={},p=0;p<e.length;p++)s(e[p]),t=n(e[p]),t=a(t)?t:"*",l[t]=l[t]||[],l[t][p]=e[p];var d=[],f=0;for(t in l)if(l.hasOwnProperty(t)){var h=l[t];for(var m in h)if(h.hasOwnProperty(m)){var v=h[m];h[m]=v.replace(u,"$1 "+c+'="'+m+'" ')}var g=r(h.join(""),i);for(p=0;p<g.length;++p){var C=g[p];C.hasAttribute&&C.hasAttribute(c)&&(m=+C.getAttribute(c),C.removeAttribute(c),s(!d.hasOwnProperty(m)),d[m]=C,f+=1)}}return s(f===d.length),s(d.length===e.length),d},dangerouslyReplaceNodeWithMarkup:function(e,t){s(o.canUseDOM),s(t),s("html"!==e.tagName.toLowerCase());var n=r(t,i)[0];e.parentNode.replaceChild(n,e)}};t.exports=l},{"./ExecutionEnvironment":20,"./createNodesFromMarkup":91,"./emptyFunction":94,"./getMarkupWrap":103,"./invariant":110}],11:[function(e,t){"use strict";var n=e("./DOMProperty"),o=n.injection.MUST_USE_ATTRIBUTE,r=n.injection.MUST_USE_PROPERTY,i=n.injection.HAS_BOOLEAN_VALUE,a=n.injection.HAS_SIDE_EFFECTS,s=n.injection.HAS_POSITIVE_NUMERIC_VALUE,u={isCustomAttribute:RegExp.prototype.test.bind(/^(data|aria)-[a-z_][a-z\d_.\-]*$/),Properties:{accept:null,accessKey:null,action:null,allowFullScreen:o|i,allowTransparency:o,alt:null,async:i,autoComplete:null,autoPlay:i,cellPadding:null,cellSpacing:null,charSet:o,checked:r|i,className:r,cols:o|s,colSpan:null,content:null,contentEditable:null,contextMenu:o,controls:r|i,crossOrigin:null,data:null,dateTime:o,defer:i,dir:null,disabled:o|i,download:null,draggable:null,encType:null,form:o,formNoValidate:i,frameBorder:o,height:o,hidden:o|i,href:null,hrefLang:null,htmlFor:null,httpEquiv:null,icon:null,id:r,label:null,lang:null,list:null,loop:r|i,max:null,maxLength:o,mediaGroup:null,method:null,min:null,multiple:r|i,muted:r|i,name:null,noValidate:i,pattern:null,placeholder:null,poster:null,preload:null,radioGroup:null,readOnly:r|i,rel:null,required:i,role:o,rows:o|s,rowSpan:null,sandbox:null,scope:null,scrollLeft:r,scrollTop:r,seamless:o|i,selected:r|i,size:o|s,span:s,spellCheck:null,src:null,srcDoc:r,srcSet:null,step:null,style:null,tabIndex:null,target:null,title:null,type:null,value:r|a,width:o,wmode:o,autoCapitalize:null,autoCorrect:null,property:null,cx:o,cy:o,d:o,fill:o,fx:o,fy:o,gradientTransform:o,gradientUnits:o,offset:o,points:o,r:o,rx:o,ry:o,spreadMethod:o,stopColor:o,stopOpacity:o,stroke:o,strokeLinecap:o,strokeWidth:o,textAnchor:o,transform:o,version:o,viewBox:o,x1:o,x2:o,x:o,y1:o,y2:o,y:o},DOMAttributeNames:{className:"class",gradientTransform:"gradientTransform",gradientUnits:"gradientUnits",htmlFor:"for",spreadMethod:"spreadMethod",stopColor:"stop-color",stopOpacity:"stop-opacity",strokeLinecap:"stroke-linecap",strokeWidth:"stroke-width",textAnchor:"text-anchor",viewBox:"viewBox"},DOMPropertyNames:{autoCapitalize:"autocapitalize",autoComplete:"autocomplete",autoCorrect:"autocorrect",autoFocus:"autofocus",autoPlay:"autoplay",encType:"enctype",hrefLang:"hreflang",radioGroup:"radiogroup",spellCheck:"spellcheck",srcDoc:"srcdoc",srcSet:"srcset"}};t.exports=u},{"./DOMProperty":8}],12:[function(e,t){"use strict";var n=e("./keyOf"),o=[n({ResponderEventPlugin:null}),n({SimpleEventPlugin:null}),n({TapEventPlugin:null}),n({EnterLeaveEventPlugin:null}),n({ChangeEventPlugin:null}),n({SelectEventPlugin:null}),n({CompositionEventPlugin:null}),n({AnalyticsEventPlugin:null}),n({MobileSafariClickEventPlugin:null})];t.exports=o},{"./keyOf":117}],13:[function(e,t){"use strict";var n=e("./EventConstants"),o=e("./EventPropagators"),r=e("./SyntheticMouseEvent"),i=e("./ReactMount"),a=e("./keyOf"),s=n.topLevelTypes,u=i.getFirstReactDOM,c={mouseEnter:{registrationName:a({onMouseEnter:null}),dependencies:[s.topMouseOut,s.topMouseOver]},mouseLeave:{registrationName:a({onMouseLeave:null}),dependencies:[s.topMouseOut,s.topMouseOver]}},l=[null,null],p={eventTypes:c,extractEvents:function(e,t,n,a){if(e===s.topMouseOver&&(a.relatedTarget||a.fromElement))return null;if(e!==s.topMouseOut&&e!==s.topMouseOver)return null;var p;if(t.window===t)p=t;else{var d=t.ownerDocument;p=d?d.defaultView||d.parentWindow:window}var f,h;if(e===s.topMouseOut?(f=t,h=u(a.relatedTarget||a.toElement)||p):(f=p,h=t),f===h)return null;var m=f?i.getID(f):"",v=h?i.getID(h):"",g=r.getPooled(c.mouseLeave,m,a);g.type="mouseleave",g.target=f,g.relatedTarget=h;var C=r.getPooled(c.mouseEnter,v,a);return C.type="mouseenter",C.target=h,C.relatedTarget=f,o.accumulateEnterLeaveDispatches(g,C,m,v),l[0]=g,l[1]=C,l}};t.exports=p},{"./EventConstants":14,"./EventPropagators":19,"./ReactMount":53,"./SyntheticMouseEvent":79,"./keyOf":117}],14:[function(e,t){"use strict";var n=e("./keyMirror"),o=n({bubbled:null,captured:null}),r=n({topBlur:null,topChange:null,topClick:null,topCompositionEnd:null,topCompositionStart:null,topCompositionUpdate:null,topContextMenu:null,topCopy:null,topCut:null,topDoubleClick:null,topDrag:null,topDragEnd:null,topDragEnter:null,topDragExit:null,topDragLeave:null,topDragOver:null,topDragStart:null,topDrop:null,topError:null,topFocus:null,topInput:null,topKeyDown:null,topKeyPress:null,topKeyUp:null,topLoad:null,topMouseDown:null,topMouseMove:null,topMouseOut:null,topMouseOver:null,topMouseUp:null,topPaste:null,topReset:null,topScroll:null,topSelectionChange:null,topSubmit:null,topTouchCancel:null,topTouchEnd:null,topTouchMove:null,topTouchStart:null,topWheel:null}),i={topLevelTypes:r,PropagationPhases:o};t.exports=i},{"./keyMirror":116}],15:[function(e,t){var n=e("./emptyFunction"),o={listen:function(e,t,n){return e.addEventListener?(e.addEventListener(t,n,!1),{remove:function(){e.removeEventListener(t,n,!1)}}):e.attachEvent?(e.attachEvent("on"+t,n),{remove:function(){e.detachEvent(t,n)}}):void 0},capture:function(e,t,o){return e.addEventListener?(e.addEventListener(t,o,!0),{remove:function(){e.removeEventListener(t,o,!0)}}):{remove:n}}};t.exports=o},{"./emptyFunction":94}],16:[function(e,t){"use strict";var n=e("./EventPluginRegistry"),o=e("./EventPluginUtils"),r=e("./ExecutionEnvironment"),i=e("./accumulate"),a=e("./forEachAccumulated"),s=e("./invariant"),u=(e("./isEventSupported"),e("./monitorCodeUse"),{}),c=null,l=function(e){if(e){var t=o.executeDispatch,r=n.getPluginModuleForEvent(e);r&&r.executeDispatch&&(t=r.executeDispatch),o.executeDispatchesInOrder(e,t),e.isPersistent()||e.constructor.release(e)}},p=null,d={injection:{injectMount:o.injection.injectMount,injectInstanceHandle:function(e){p=e},getInstanceHandle:function(){return p},injectEventPluginOrder:n.injectEventPluginOrder,injectEventPluginsByName:n.injectEventPluginsByName},eventNameDispatchConfigs:n.eventNameDispatchConfigs,registrationNameModules:n.registrationNameModules,putListener:function(e,t,n){s(r.canUseDOM),s(!n||"function"==typeof n);var o=u[t]||(u[t]={});o[e]=n},getListener:function(e,t){var n=u[t];return n&&n[e]},deleteListener:function(e,t){var n=u[t];n&&delete n[e]},deleteAllListeners:function(e){for(var t in u)delete u[t][e]},extractEvents:function(e,t,o,r){for(var a,s=n.plugins,u=0,c=s.length;c>u;u++){var l=s[u];if(l){var p=l.extractEvents(e,t,o,r);p&&(a=i(a,p))}}return a},enqueueEvents:function(e){e&&(c=i(c,e))},processEventQueue:function(){var e=c;c=null,a(e,l),s(!c)},__purge:function(){u={}},__getListenerBank:function(){return u}};t.exports=d},{"./EventPluginRegistry":17,"./EventPluginUtils":18,"./ExecutionEnvironment":20,"./accumulate":85,"./forEachAccumulated":99,"./invariant":110,"./isEventSupported":111,"./monitorCodeUse":123}],17:[function(e,t){"use strict";function n(){if(a)for(var e in s){var t=s[e],n=a.indexOf(e);if(i(n>-1),!u.plugins[n]){i(t.extractEvents),u.plugins[n]=t;var r=t.eventTypes;for(var c in r)i(o(r[c],t,c))}}}function o(e,t,n){i(!u.eventNameDispatchConfigs[n]),u.eventNameDispatchConfigs[n]=e;var o=e.phasedRegistrationNames;if(o){for(var a in o)if(o.hasOwnProperty(a)){var s=o[a];r(s,t,n)}return!0}return e.registrationName?(r(e.registrationName,t,n),!0):!1}function r(e,t,n){i(!u.registrationNameModules[e]),u.registrationNameModules[e]=t,u.registrationNameDependencies[e]=t.eventTypes[n].dependencies}var i=e("./invariant"),a=null,s={},u={plugins:[],eventNameDispatchConfigs:{},registrationNameModules:{},registrationNameDependencies:{},injectEventPluginOrder:function(e){i(!a),a=Array.prototype.slice.call(e),n()},injectEventPluginsByName:function(e){var t=!1;for(var o in e)if(e.hasOwnProperty(o)){var r=e[o];s[o]!==r&&(i(!s[o]),s[o]=r,t=!0)}t&&n()},getPluginModuleForEvent:function(e){var t=e.dispatchConfig;if(t.registrationName)return u.registrationNameModules[t.registrationName]||null;for(var n in t.phasedRegistrationNames)if(t.phasedRegistrationNames.hasOwnProperty(n)){var o=u.registrationNameModules[t.phasedRegistrationNames[n]];if(o)return o}return null},_resetEventPlugins:function(){a=null;for(var e in s)s.hasOwnProperty(e)&&delete s[e];u.plugins.length=0;var t=u.eventNameDispatchConfigs;for(var n in t)t.hasOwnProperty(n)&&delete t[n];var o=u.registrationNameModules;for(var r in o)o.hasOwnProperty(r)&&delete o[r]}};t.exports=u},{"./invariant":110}],18:[function(e,t){"use strict";function n(e){return e===h.topMouseUp||e===h.topTouchEnd||e===h.topTouchCancel}function o(e){return e===h.topMouseMove||e===h.topTouchMove}function r(e){return e===h.topMouseDown||e===h.topTouchStart}function i(e,t){var n=e._dispatchListeners,o=e._dispatchIDs;if(Array.isArray(n))for(var r=0;r<n.length&&!e.isPropagationStopped();r++)t(e,n[r],o[r]);else n&&t(e,n,o)}function a(e,t,n){e.currentTarget=f.Mount.getNode(n);var o=t(e,n);return e.currentTarget=null,o}function s(e,t){i(e,t),e._dispatchListeners=null,e._dispatchIDs=null}function u(e){var t=e._dispatchListeners,n=e._dispatchIDs;if(Array.isArray(t)){for(var o=0;o<t.length&&!e.isPropagationStopped();o++)if(t[o](e,n[o]))return n[o]}else if(t&&t(e,n))return n;return null}function c(e){var t=e._dispatchListeners,n=e._dispatchIDs;d(!Array.isArray(t));var o=t?t(e,n):null;return e._dispatchListeners=null,e._dispatchIDs=null,o}function l(e){return!!e._dispatchListeners}var p=e("./EventConstants"),d=e("./invariant"),f={Mount:null,injectMount:function(e){f.Mount=e}},h=p.topLevelTypes,m={isEndish:n,isMoveish:o,isStartish:r,executeDirectDispatch:c,executeDispatch:a,executeDispatchesInOrder:s,executeDispatchesInOrderStopAtTrue:u,hasDispatches:l,injection:f,useTouchEvents:!1};t.exports=m},{"./EventConstants":14,"./invariant":110}],19:[function(e,t){"use strict";function n(e,t,n){var o=t.dispatchConfig.phasedRegistrationNames[n];return m(e,o)}function o(e,t,o){var r=t?h.bubbled:h.captured,i=n(e,o,r);i&&(o._dispatchListeners=d(o._dispatchListeners,i),o._dispatchIDs=d(o._dispatchIDs,e))}function r(e){e&&e.dispatchConfig.phasedRegistrationNames&&p.injection.getInstanceHandle().traverseTwoPhase(e.dispatchMarker,o,e)}function i(e,t,n){if(n&&n.dispatchConfig.registrationName){var o=n.dispatchConfig.registrationName,r=m(e,o);r&&(n._dispatchListeners=d(n._dispatchListeners,r),n._dispatchIDs=d(n._dispatchIDs,e))}}function a(e){e&&e.dispatchConfig.registrationName&&i(e.dispatchMarker,null,e)}function s(e){f(e,r)}function u(e,t,n,o){p.injection.getInstanceHandle().traverseEnterLeave(n,o,i,e,t)}function c(e){f(e,a)}var l=e("./EventConstants"),p=e("./EventPluginHub"),d=e("./accumulate"),f=e("./forEachAccumulated"),h=l.PropagationPhases,m=p.getListener,v={accumulateTwoPhaseDispatches:s,accumulateDirectDispatches:c,accumulateEnterLeaveDispatches:u};t.exports=v},{"./EventConstants":14,"./EventPluginHub":16,"./accumulate":85,"./forEachAccumulated":99}],20:[function(e,t){"use strict";var n="undefined"!=typeof window,o={canUseDOM:n,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:n&&(window.addEventListener||window.attachEvent),isInWorker:!n};t.exports=o},{}],21:[function(e,t){"use strict";function n(e){u(null==e.props.checkedLink||null==e.props.valueLink)}function o(e){n(e),u(null==e.props.value&&null==e.props.onChange)}function r(e){n(e),u(null==e.props.checked&&null==e.props.onChange)}function i(e){this.props.valueLink.requestChange(e.target.value)}function a(e){this.props.checkedLink.requestChange(e.target.checked)}var s=e("./ReactPropTypes"),u=e("./invariant"),c=(e("./warning"),{Mixin:{propTypes:{value:function(){},checked:function(){},onChange:s.func}},getValue:function(e){return e.props.valueLink?(o(e),e.props.valueLink.value):e.props.value},getChecked:function(e){return e.props.checkedLink?(r(e),e.props.checkedLink.value):e.props.checked},getOnChange:function(e){return e.props.valueLink?(o(e),i):e.props.checkedLink?(r(e),a):e.props.onChange}});t.exports=c},{"./ReactPropTypes":62,"./invariant":110,"./warning":131}],22:[function(e,t){"use strict";var n=e("./EventConstants"),o=e("./emptyFunction"),r=n.topLevelTypes,i={eventTypes:null,extractEvents:function(e,t,n,i){if(e===r.topTouchStart){var a=i.target;a&&!a.onclick&&(a.onclick=o)}}};t.exports=i},{"./EventConstants":14,"./emptyFunction":94}],23:[function(e,t){"use strict";var n=e("./invariant"),o=function(e){var t=this;if(t.instancePool.length){var n=t.instancePool.pop();return t.call(n,e),n}return new t(e)},r=function(e,t){var n=this;if(n.instancePool.length){var o=n.instancePool.pop();return n.call(o,e,t),o}return new n(e,t)},i=function(e,t,n){var o=this;if(o.instancePool.length){var r=o.instancePool.pop();return o.call(r,e,t,n),r}return new o(e,t,n)},a=function(e,t,n,o,r){var i=this;if(i.instancePool.length){var a=i.instancePool.pop();return i.call(a,e,t,n,o,r),a}return new i(e,t,n,o,r)},s=function(e){var t=this;n(e instanceof t),e.destructor&&e.destructor(),t.instancePool.length<t.poolSize&&t.instancePool.push(e)},u=10,c=o,l=function(e,t){var n=e;return n.instancePool=[],n.getPooled=t||c,n.poolSize||(n.poolSize=u),n.release=s,n},p={addPoolingTo:l,oneArgumentPooler:o,twoArgumentPooler:r,threeArgumentPooler:i,fiveArgumentPooler:a};t.exports=p},{"./invariant":110}],24:[function(e,t){"use strict";var n=e("./DOMPropertyOperations"),o=e("./EventPluginUtils"),r=e("./ReactChildren"),i=e("./ReactComponent"),a=e("./ReactCompositeComponent"),s=e("./ReactContext"),u=e("./ReactCurrentOwner"),c=e("./ReactDOM"),l=e("./ReactDOMComponent"),p=e("./ReactDefaultInjection"),d=e("./ReactInstanceHandles"),f=e("./ReactMount"),h=e("./ReactMultiChild"),m=e("./ReactPerf"),v=e("./ReactPropTypes"),g=e("./ReactServerRendering"),C=e("./ReactTextComponent"),y=e("./onlyChild");p.inject();var E={Children:{map:r.map,forEach:r.forEach,only:y},DOM:c,PropTypes:v,initializeTouchEvents:function(e){o.useTouchEvents=e},createClass:a.createClass,constructAndRenderComponent:f.constructAndRenderComponent,constructAndRenderComponentByID:f.constructAndRenderComponentByID,renderComponent:m.measure("React","renderComponent",f.renderComponent),renderComponentToString:g.renderComponentToString,renderComponentToStaticMarkup:g.renderComponentToStaticMarkup,unmountComponentAtNode:f.unmountComponentAtNode,isValidClass:a.isValidClass,isValidComponent:i.isValidComponent,withContext:s.withContext,__internals:{Component:i,CurrentOwner:u,DOMComponent:l,DOMPropertyOperations:n,InstanceHandles:d,Mount:f,MultiChild:h,TextComponent:C}};E.version="0.10.0",t.exports=E},{"./DOMPropertyOperations":9,"./EventPluginUtils":18,"./ReactChildren":26,"./ReactComponent":27,"./ReactCompositeComponent":29,"./ReactContext":30,"./ReactCurrentOwner":31,"./ReactDOM":32,"./ReactDOMComponent":34,"./ReactDefaultInjection":44,"./ReactInstanceHandles":51,"./ReactMount":53,"./ReactMultiChild":55,"./ReactPerf":58,"./ReactPropTypes":62,"./ReactServerRendering":66,"./ReactTextComponent":68,"./onlyChild":126}],25:[function(e,t){"use strict";var n=e("./ReactMount"),o=e("./invariant"),r={getDOMNode:function(){return o(this.isMounted()),n.getNode(this._rootNodeID)}};t.exports=r},{"./ReactMount":53,"./invariant":110}],26:[function(e,t){"use strict";function n(e,t){this.forEachFunction=e,this.forEachContext=t}function o(e,t,n,o){var r=e;r.forEachFunction.call(r.forEachContext,t,o)}function r(e,t,r){if(null==e)return e;var i=n.getPooled(t,r);l(e,o,i),n.release(i)}function i(e,t,n){this.mapResult=e,this.mapFunction=t,this.mapContext=n}function a(e,t,n,o){var r=e,i=r.mapResult,a=r.mapFunction.call(r.mapContext,t,o);c(!i.hasOwnProperty(n)),i[n]=a}function s(e,t,n){if(null==e)return e;var o={},r=i.getPooled(o,t,n);return l(e,a,r),i.release(r),o}var u=e("./PooledClass"),c=e("./invariant"),l=e("./traverseAllChildren"),p=u.twoArgumentPooler,d=u.threeArgumentPooler;u.addPoolingTo(n,p),u.addPoolingTo(i,d);var f={forEach:r,map:s};t.exports=f},{"./PooledClass":23,"./invariant":110,"./traverseAllChildren":130}],27:[function(e,t){"use strict";var n=e("./ReactCurrentOwner"),o=e("./ReactOwner"),r=e("./ReactUpdates"),i=e("./invariant"),a=e("./keyMirror"),s=e("./merge"),u=(e("./monitorCodeUse"),a({MOUNTED:null,UNMOUNTED:null})),c=!1,l=null,p=null,d={injection:{injectEnvironment:function(e){i(!c),p=e.mountImageIntoNode,l=e.unmountIDFromEnvironment,d.BackendIDOperations=e.BackendIDOperations,d.ReactReconcileTransaction=e.ReactReconcileTransaction,c=!0}},isValidComponent:function(e){if(!e||!e.type||!e.type.prototype)return!1;var t=e.type.prototype;return"function"==typeof t.mountComponentIntoNode&&"function"==typeof t.receiveComponent},LifeCycle:u,BackendIDOperations:null,ReactReconcileTransaction:null,Mixin:{isMounted:function(){return this._lifeCycleState===u.MOUNTED},setProps:function(e,t){this.replaceProps(s(this._pendingProps||this.props,e),t)},replaceProps:function(e,t){i(this.isMounted()),i(0===this._mountDepth),this._pendingProps=e,r.enqueueUpdate(this,t)},construct:function(e,t){this.props=e||{},this._owner=n.current,this._lifeCycleState=u.UNMOUNTED,this._pendingProps=null,this._pendingCallbacks=null,this._pendingOwner=this._owner;var o=arguments.length-1;if(1===o)this.props.children=t;else if(o>1){for(var r=Array(o),i=0;o>i;i++)r[i]=arguments[i+1];this.props.children=r}},mountComponent:function(e,t,n){i(!this.isMounted());var r=this.props;null!=r.ref&&o.addComponentAsRefTo(this,r.ref,this._owner),this._rootNodeID=e,this._lifeCycleState=u.MOUNTED,this._mountDepth=n},unmountComponent:function(){i(this.isMounted());var e=this.props;null!=e.ref&&o.removeComponentAsRefFrom(this,e.ref,this._owner),l(this._rootNodeID),this._rootNodeID=null,this._lifeCycleState=u.UNMOUNTED},receiveComponent:function(e,t){i(this.isMounted()),this._pendingOwner=e._owner,this._pendingProps=e.props,this._performUpdateIfNecessary(t)},performUpdateIfNecessary:function(){var e=d.ReactReconcileTransaction.getPooled();e.perform(this._performUpdateIfNecessary,this,e),d.ReactReconcileTransaction.release(e)},_performUpdateIfNecessary:function(e){if(null!=this._pendingProps){var t=this.props,n=this._owner;this.props=this._pendingProps,this._owner=this._pendingOwner,this._pendingProps=null,this.updateComponent(e,t,n)}},updateComponent:function(e,t,n){var r=this.props;(this._owner!==n||r.ref!==t.ref)&&(null!=t.ref&&o.removeComponentAsRefFrom(this,t.ref,n),null!=r.ref&&o.addComponentAsRefTo(this,r.ref,this._owner))},mountComponentIntoNode:function(e,t,n){var o=d.ReactReconcileTransaction.getPooled();o.perform(this._mountComponentIntoNode,this,e,t,o,n),d.ReactReconcileTransaction.release(o)},_mountComponentIntoNode:function(e,t,n,o){var r=this.mountComponent(e,n,0);p(r,t,o)},isOwnedBy:function(e){return this._owner===e},getSiblingByRef:function(e){var t=this._owner;return t&&t.refs?t.refs[e]:null}}};t.exports=d},{"./ReactCurrentOwner":31,"./ReactOwner":57,"./ReactUpdates":69,"./invariant":110,"./keyMirror":116,"./merge":119,"./monitorCodeUse":123}],28:[function(e,t){"use strict";var n=e("./ReactDOMIDOperations"),o=e("./ReactMarkupChecksum"),r=e("./ReactMount"),i=e("./ReactPerf"),a=e("./ReactReconcileTransaction"),s=e("./getReactRootElementInContainer"),u=e("./invariant"),c=1,l=9,p={ReactReconcileTransaction:a,BackendIDOperations:n,unmountIDFromEnvironment:function(e){r.purgeID(e)},mountImageIntoNode:i.measure("ReactComponentBrowserEnvironment","mountImageIntoNode",function(e,t,n){if(u(t&&(t.nodeType===c||t.nodeType===l)),n){if(o.canReuseMarkup(e,s(t)))return;u(t.nodeType!==l)}u(t.nodeType!==l),t.innerHTML=e})};t.exports=p},{"./ReactDOMIDOperations":36,"./ReactMarkupChecksum":52,"./ReactMount":53,"./ReactPerf":58,"./ReactReconcileTransaction":64,"./getReactRootElementInContainer":105,"./invariant":110}],29:[function(e,t){"use strict";
+function n(e,t){for(var n in t)t.hasOwnProperty(n)&&R("function"==typeof t[n])}function o(e,t){var n=T[t];_.hasOwnProperty(t)&&R(n===O.OVERRIDE_BASE),e.hasOwnProperty(t)&&R(n===O.DEFINE_MANY||n===O.DEFINE_MANY_MERGED)}function r(e){var t=e._compositeLifeCycleState;R(e.isMounted()||t===S.MOUNTING),R(t!==S.RECEIVING_STATE),R(t!==S.UNMOUNTING)}function i(e,t){R(!l(t)),R(!p.isValidComponent(t));var n=e.componentConstructor,r=n.prototype;for(var i in t){var a=t[i];if(t.hasOwnProperty(i))if(o(r,i),N.hasOwnProperty(i))N[i](e,a);else{var s=i in T,d=i in r,f=a&&a.__reactDontBind,h="function"==typeof a,m=h&&!s&&!d&&!f;m?(r.__reactAutoBindMap||(r.__reactAutoBindMap={}),r.__reactAutoBindMap[i]=a,r[i]=a):r[i]=d?T[i]===O.DEFINE_MANY_MERGED?u(r[i],a):c(r[i],a):a}}}function a(e,t){if(t)for(var n in t){var o=t[n];if(!t.hasOwnProperty(n))return;var r=n in e,i=o;if(r){var a=e[n],s=typeof a,u=typeof o;R("function"===s&&"function"===u),i=c(a,o)}e[n]=i,e.componentConstructor[n]=i}}function s(e,t){return R(e&&t&&"object"==typeof e&&"object"==typeof t),b(t,function(t,n){R(void 0===e[n]),e[n]=t}),e}function u(e,t){return function(){var n=e.apply(this,arguments),o=t.apply(this,arguments);return null==n?o:null==o?n:s(n,o)}}function c(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function l(e){return e instanceof Function&&"componentConstructor"in e&&e.componentConstructor instanceof Function}var p=e("./ReactComponent"),d=e("./ReactContext"),f=e("./ReactCurrentOwner"),h=e("./ReactErrorUtils"),m=e("./ReactOwner"),v=e("./ReactPerf"),g=e("./ReactPropTransferer"),C=e("./ReactPropTypeLocations"),y=(e("./ReactPropTypeLocationNames"),e("./ReactUpdates")),E=e("./instantiateReactComponent"),R=e("./invariant"),M=e("./keyMirror"),D=e("./merge"),x=e("./mixInto"),b=(e("./monitorCodeUse"),e("./objMap")),P=e("./shouldUpdateReactComponent"),O=(e("./warning"),M({DEFINE_ONCE:null,DEFINE_MANY:null,OVERRIDE_BASE:null,DEFINE_MANY_MERGED:null})),I=[],T={mixins:O.DEFINE_MANY,statics:O.DEFINE_MANY,propTypes:O.DEFINE_MANY,contextTypes:O.DEFINE_MANY,childContextTypes:O.DEFINE_MANY,getDefaultProps:O.DEFINE_MANY_MERGED,getInitialState:O.DEFINE_MANY_MERGED,getChildContext:O.DEFINE_MANY_MERGED,render:O.DEFINE_ONCE,componentWillMount:O.DEFINE_MANY,componentDidMount:O.DEFINE_MANY,componentWillReceiveProps:O.DEFINE_MANY,shouldComponentUpdate:O.DEFINE_ONCE,componentWillUpdate:O.DEFINE_MANY,componentDidUpdate:O.DEFINE_MANY,componentWillUnmount:O.DEFINE_MANY,updateComponent:O.OVERRIDE_BASE},N={displayName:function(e,t){e.componentConstructor.displayName=t},mixins:function(e,t){if(t)for(var n=0;n<t.length;n++)i(e,t[n])},childContextTypes:function(e,t){var o=e.componentConstructor;n(o,t,C.childContext),o.childContextTypes=D(o.childContextTypes,t)},contextTypes:function(e,t){var o=e.componentConstructor;n(o,t,C.context),o.contextTypes=D(o.contextTypes,t)},propTypes:function(e,t){var o=e.componentConstructor;n(o,t,C.prop),o.propTypes=D(o.propTypes,t)},statics:function(e,t){a(e,t)}},S=M({MOUNTING:null,UNMOUNTING:null,RECEIVING_PROPS:null,RECEIVING_STATE:null}),_={construct:function(){p.Mixin.construct.apply(this,arguments),m.Mixin.construct.apply(this,arguments),this.state=null,this._pendingState=null,this.context=null,this._currentContext=d.current,this._pendingContext=null,this._descriptor=null,this._compositeLifeCycleState=null},toJSON:function(){return{type:this.type,props:this.props}},isMounted:function(){return p.Mixin.isMounted.call(this)&&this._compositeLifeCycleState!==S.MOUNTING},mountComponent:v.measure("ReactCompositeComponent","mountComponent",function(e,t,n){p.Mixin.mountComponent.call(this,e,t,n),this._compositeLifeCycleState=S.MOUNTING,this.context=this._processContext(this._currentContext),this._defaultProps=this.getDefaultProps?this.getDefaultProps():null,this.props=this._processProps(this.props),this.__reactAutoBindMap&&this._bindAutoBindMethods(),this.state=this.getInitialState?this.getInitialState():null,R("object"==typeof this.state&&!Array.isArray(this.state)),this._pendingState=null,this._pendingForceUpdate=!1,this.componentWillMount&&(this.componentWillMount(),this._pendingState&&(this.state=this._pendingState,this._pendingState=null)),this._renderedComponent=E(this._renderValidatedComponent()),this._compositeLifeCycleState=null;var o=this._renderedComponent.mountComponent(e,t,n+1);return this.componentDidMount&&t.getReactMountReady().enqueue(this,this.componentDidMount),o}),unmountComponent:function(){this._compositeLifeCycleState=S.UNMOUNTING,this.componentWillUnmount&&this.componentWillUnmount(),this._compositeLifeCycleState=null,this._defaultProps=null,this._renderedComponent.unmountComponent(),this._renderedComponent=null,p.Mixin.unmountComponent.call(this)},setState:function(e,t){R("object"==typeof e||null==e),this.replaceState(D(this._pendingState||this.state,e),t)},replaceState:function(e,t){r(this),this._pendingState=e,y.enqueueUpdate(this,t)},_processContext:function(e){var t=null,n=this.constructor.contextTypes;if(n){t={};for(var o in n)t[o]=e[o]}return t},_processChildContext:function(e){var t=this.getChildContext&&this.getChildContext();if(this.constructor.displayName||"ReactCompositeComponent",t){R("object"==typeof this.constructor.childContextTypes);for(var n in t)R(n in this.constructor.childContextTypes);return D(e,t)}return e},_processProps:function(e){var t=D(e),n=this._defaultProps;for(var o in n)"undefined"==typeof t[o]&&(t[o]=n[o]);return t},_checkPropTypes:function(e,t,n){var o=this.constructor.displayName;for(var r in e)e.hasOwnProperty(r)&&e[r](t,r,o,n)},performUpdateIfNecessary:function(){var e=this._compositeLifeCycleState;e!==S.MOUNTING&&e!==S.RECEIVING_PROPS&&p.Mixin.performUpdateIfNecessary.call(this)},_performUpdateIfNecessary:function(e){if(null!=this._pendingProps||null!=this._pendingState||null!=this._pendingContext||this._pendingForceUpdate){var t=this._pendingContext||this._currentContext,n=this._processContext(t);this._pendingContext=null;var o=this.props;null!=this._pendingProps&&(o=this._processProps(this._pendingProps),this._pendingProps=null,this._compositeLifeCycleState=S.RECEIVING_PROPS,this.componentWillReceiveProps&&this.componentWillReceiveProps(o,n)),this._compositeLifeCycleState=S.RECEIVING_STATE;var r=this._pendingOwner,i=this._pendingState||this.state;this._pendingState=null;try{this._pendingForceUpdate||!this.shouldComponentUpdate||this.shouldComponentUpdate(o,i,n)?(this._pendingForceUpdate=!1,this._performComponentUpdate(o,r,i,t,n,e)):(this.props=o,this._owner=r,this.state=i,this._currentContext=t,this.context=n)}finally{this._compositeLifeCycleState=null}}},_performComponentUpdate:function(e,t,n,o,r,i){var a=this.props,s=this._owner,u=this.state,c=this.context;this.componentWillUpdate&&this.componentWillUpdate(e,n,r),this.props=e,this._owner=t,this.state=n,this._currentContext=o,this.context=r,this.updateComponent(i,a,s,u,c),this.componentDidUpdate&&i.getReactMountReady().enqueue(this,this.componentDidUpdate.bind(this,a,u,c))},receiveComponent:function(e,t){e!==this._descriptor&&(this._descriptor=e,this._pendingContext=e._currentContext,p.Mixin.receiveComponent.call(this,e,t))},updateComponent:v.measure("ReactCompositeComponent","updateComponent",function(e,t,n){p.Mixin.updateComponent.call(this,e,t,n);var o=this._renderedComponent,r=this._renderValidatedComponent();if(P(o,r))o.receiveComponent(r,e);else{var i=this._rootNodeID,a=o._rootNodeID;o.unmountComponent(),this._renderedComponent=E(r);var s=this._renderedComponent.mountComponent(i,e,this._mountDepth+1);p.BackendIDOperations.dangerouslyReplaceNodeWithMarkupByID(a,s)}}),forceUpdate:function(e){var t=this._compositeLifeCycleState;R(this.isMounted()||t===S.MOUNTING),R(t!==S.RECEIVING_STATE&&t!==S.UNMOUNTING),this._pendingForceUpdate=!0,y.enqueueUpdate(this,e)},_renderValidatedComponent:v.measure("ReactCompositeComponent","_renderValidatedComponent",function(){var e,t=d.current;d.current=this._processChildContext(this._currentContext),f.current=this;try{e=this.render()}finally{d.current=t,f.current=null}return R(p.isValidComponent(e)),e}),_bindAutoBindMethods:function(){for(var e in this.__reactAutoBindMap)if(this.__reactAutoBindMap.hasOwnProperty(e)){var t=this.__reactAutoBindMap[e];this[e]=this._bindAutoBindMethod(h.guard(t,this.constructor.displayName+"."+e))}},_bindAutoBindMethod:function(e){var t=this,n=function(){return e.apply(t,arguments)};return n}},w=function(){};x(w,p.Mixin),x(w,m.Mixin),x(w,g.Mixin),x(w,_);var A={LifeCycle:S,Base:w,createClass:function(e){var t=function(){};t.prototype=new w,t.prototype.constructor=t;var n=t,o=function(){var e=new n;return e.construct.apply(e,arguments),e};o.componentConstructor=t,t.ConvenienceConstructor=o,o.originalSpec=e,I.forEach(i.bind(null,o)),i(o,e),R(t.prototype.render),o.type=t,t.prototype.type=t;for(var r in T)t.prototype[r]||(t.prototype[r]=null);return o},isValidClass:l,injection:{injectMixin:function(e){I.push(e)}}};t.exports=A},{"./ReactComponent":27,"./ReactContext":30,"./ReactCurrentOwner":31,"./ReactErrorUtils":45,"./ReactOwner":57,"./ReactPerf":58,"./ReactPropTransferer":59,"./ReactPropTypeLocationNames":60,"./ReactPropTypeLocations":61,"./ReactUpdates":69,"./instantiateReactComponent":109,"./invariant":110,"./keyMirror":116,"./merge":119,"./mixInto":122,"./monitorCodeUse":123,"./objMap":124,"./shouldUpdateReactComponent":128,"./warning":131}],30:[function(e,t){"use strict";var n=e("./merge"),o={current:{},withContext:function(e,t){var r,i=o.current;o.current=n(i,e);try{r=t()}finally{o.current=i}return r}};t.exports=o},{"./merge":119}],31:[function(e,t){"use strict";var n={current:null};t.exports=n},{}],32:[function(e,t){"use strict";function n(e,t){var n=function(){};n.prototype=new o(e,t),n.prototype.constructor=n,n.displayName=e;var r=function(){var e=new n;return e.construct.apply(e,arguments),e};return r.type=n,n.prototype.type=n,n.ConvenienceConstructor=r,r.componentConstructor=n,r}var o=e("./ReactDOMComponent"),r=e("./mergeInto"),i=e("./objMapKeyVal"),a=i({a:!1,abbr:!1,address:!1,area:!0,article:!1,aside:!1,audio:!1,b:!1,base:!0,bdi:!1,bdo:!1,big:!1,blockquote:!1,body:!1,br:!0,button:!1,canvas:!1,caption:!1,cite:!1,code:!1,col:!0,colgroup:!1,data:!1,datalist:!1,dd:!1,del:!1,details:!1,dfn:!1,div:!1,dl:!1,dt:!1,em:!1,embed:!0,fieldset:!1,figcaption:!1,figure:!1,footer:!1,form:!1,h1:!1,h2:!1,h3:!1,h4:!1,h5:!1,h6:!1,head:!1,header:!1,hr:!0,html:!1,i:!1,iframe:!1,img:!0,input:!0,ins:!1,kbd:!1,keygen:!0,label:!1,legend:!1,li:!1,link:!0,main:!1,map:!1,mark:!1,menu:!1,menuitem:!1,meta:!0,meter:!1,nav:!1,noscript:!1,object:!1,ol:!1,optgroup:!1,option:!1,output:!1,p:!1,param:!0,pre:!1,progress:!1,q:!1,rp:!1,rt:!1,ruby:!1,s:!1,samp:!1,script:!1,section:!1,select:!1,small:!1,source:!0,span:!1,strong:!1,style:!1,sub:!1,summary:!1,sup:!1,table:!1,tbody:!1,td:!1,textarea:!1,tfoot:!1,th:!1,thead:!1,time:!1,title:!1,tr:!1,track:!0,u:!1,ul:!1,"var":!1,video:!1,wbr:!0,circle:!1,defs:!1,g:!1,line:!1,linearGradient:!1,path:!1,polygon:!1,polyline:!1,radialGradient:!1,rect:!1,stop:!1,svg:!1,text:!1},n),s={injectComponentClasses:function(e){r(a,e)}};a.injection=s,t.exports=a},{"./ReactDOMComponent":34,"./mergeInto":121,"./objMapKeyVal":125}],33:[function(e,t){"use strict";var n=e("./AutoFocusMixin"),o=e("./ReactBrowserComponentMixin"),r=e("./ReactCompositeComponent"),i=e("./ReactDOM"),a=e("./keyMirror"),s=i.button,u=a({onClick:!0,onDoubleClick:!0,onMouseDown:!0,onMouseMove:!0,onMouseUp:!0,onClickCapture:!0,onDoubleClickCapture:!0,onMouseDownCapture:!0,onMouseMoveCapture:!0,onMouseUpCapture:!0}),c=r.createClass({displayName:"ReactDOMButton",mixins:[n,o],render:function(){var e={};for(var t in this.props)!this.props.hasOwnProperty(t)||this.props.disabled&&u[t]||(e[t]=this.props[t]);return s(e,this.props.children)}});t.exports=c},{"./AutoFocusMixin":1,"./ReactBrowserComponentMixin":25,"./ReactCompositeComponent":29,"./ReactDOM":32,"./keyMirror":116}],34:[function(e,t){"use strict";function n(e){e&&(m(null==e.children||null==e.dangerouslySetInnerHTML),m(null==e.style||"object"==typeof e.style))}function o(e,t,n,o){var r=p.findReactContainerForID(e);if(r){var i=r.nodeType===x?r.ownerDocument:r;E(t,i)}o.getPutListenerQueue().enqueuePutListener(e,t,n)}function r(e,t){this._tagOpen="<"+e,this._tagClose=t?"":"</"+e+">",this.tagName=e.toUpperCase()}var i=e("./CSSPropertyOperations"),a=e("./DOMProperty"),s=e("./DOMPropertyOperations"),u=e("./ReactBrowserComponentMixin"),c=e("./ReactComponent"),l=e("./ReactEventEmitter"),p=e("./ReactMount"),d=e("./ReactMultiChild"),f=e("./ReactPerf"),h=e("./escapeTextForBrowser"),m=e("./invariant"),v=e("./keyOf"),g=e("./merge"),C=e("./mixInto"),y=l.deleteListener,E=l.listenTo,R=l.registrationNameModules,M={string:!0,number:!0},D=v({style:null}),x=1;r.Mixin={mountComponent:f.measure("ReactDOMComponent","mountComponent",function(e,t,o){return c.Mixin.mountComponent.call(this,e,t,o),n(this.props),this._createOpenTagMarkupAndPutListeners(t)+this._createContentMarkup(t)+this._tagClose}),_createOpenTagMarkupAndPutListeners:function(e){var t=this.props,n=this._tagOpen;for(var r in t)if(t.hasOwnProperty(r)){var a=t[r];if(null!=a)if(R[r])o(this._rootNodeID,r,a,e);else{r===D&&(a&&(a=t.style=g(t.style)),a=i.createMarkupForStyles(a));var u=s.createMarkupForProperty(r,a);u&&(n+=" "+u)}}if(e.renderToStaticMarkup)return n+">";var c=s.createMarkupForID(this._rootNodeID);return n+" "+c+">"},_createContentMarkup:function(e){var t=this.props.dangerouslySetInnerHTML;if(null!=t){if(null!=t.__html)return t.__html}else{var n=M[typeof this.props.children]?this.props.children:null,o=null!=n?null:this.props.children;if(null!=n)return h(n);if(null!=o){var r=this.mountChildren(o,e);return r.join("")}}return""},receiveComponent:function(e,t){e!==this&&(n(e.props),c.Mixin.receiveComponent.call(this,e,t))},updateComponent:f.measure("ReactDOMComponent","updateComponent",function(e,t,n){c.Mixin.updateComponent.call(this,e,t,n),this._updateDOMProperties(t,e),this._updateDOMChildren(t,e)}),_updateDOMProperties:function(e,t){var n,r,i,s=this.props;for(n in e)if(!s.hasOwnProperty(n)&&e.hasOwnProperty(n))if(n===D){var u=e[n];for(r in u)u.hasOwnProperty(r)&&(i=i||{},i[r]="")}else R[n]?y(this._rootNodeID,n):(a.isStandardName[n]||a.isCustomAttribute(n))&&c.BackendIDOperations.deletePropertyByID(this._rootNodeID,n);for(n in s){var l=s[n],p=e[n];if(s.hasOwnProperty(n)&&l!==p)if(n===D)if(l&&(l=s.style=g(l)),p){for(r in p)p.hasOwnProperty(r)&&!l.hasOwnProperty(r)&&(i=i||{},i[r]="");for(r in l)l.hasOwnProperty(r)&&p[r]!==l[r]&&(i=i||{},i[r]=l[r])}else i=l;else R[n]?o(this._rootNodeID,n,l,t):(a.isStandardName[n]||a.isCustomAttribute(n))&&c.BackendIDOperations.updatePropertyByID(this._rootNodeID,n,l)}i&&c.BackendIDOperations.updateStylesByID(this._rootNodeID,i)},_updateDOMChildren:function(e,t){var n=this.props,o=M[typeof e.children]?e.children:null,r=M[typeof n.children]?n.children:null,i=e.dangerouslySetInnerHTML&&e.dangerouslySetInnerHTML.__html,a=n.dangerouslySetInnerHTML&&n.dangerouslySetInnerHTML.__html,s=null!=o?null:e.children,u=null!=r?null:n.children,l=null!=o||null!=i,p=null!=r||null!=a;null!=s&&null==u?this.updateChildren(null,t):l&&!p&&this.updateTextContent(""),null!=r?o!==r&&this.updateTextContent(""+r):null!=a?i!==a&&c.BackendIDOperations.updateInnerHTMLByID(this._rootNodeID,a):null!=u&&this.updateChildren(u,t)},unmountComponent:function(){this.unmountChildren(),l.deleteAllListeners(this._rootNodeID),c.Mixin.unmountComponent.call(this)}},C(r,c.Mixin),C(r,r.Mixin),C(r,d.Mixin),C(r,u),t.exports=r},{"./CSSPropertyOperations":3,"./DOMProperty":8,"./DOMPropertyOperations":9,"./ReactBrowserComponentMixin":25,"./ReactComponent":27,"./ReactEventEmitter":46,"./ReactMount":53,"./ReactMultiChild":55,"./ReactPerf":58,"./escapeTextForBrowser":96,"./invariant":110,"./keyOf":117,"./merge":119,"./mixInto":122}],35:[function(e,t){"use strict";var n=e("./ReactBrowserComponentMixin"),o=e("./ReactCompositeComponent"),r=e("./ReactDOM"),i=e("./ReactEventEmitter"),a=e("./EventConstants"),s=r.form,u=o.createClass({displayName:"ReactDOMForm",mixins:[n],render:function(){return this.transferPropsTo(s(null,this.props.children))},componentDidMount:function(){i.trapBubbledEvent(a.topLevelTypes.topReset,"reset",this.getDOMNode()),i.trapBubbledEvent(a.topLevelTypes.topSubmit,"submit",this.getDOMNode())}});t.exports=u},{"./EventConstants":14,"./ReactBrowserComponentMixin":25,"./ReactCompositeComponent":29,"./ReactDOM":32,"./ReactEventEmitter":46}],36:[function(e,t){"use strict";var n,o=e("./CSSPropertyOperations"),r=e("./DOMChildrenOperations"),i=e("./DOMPropertyOperations"),a=e("./ReactMount"),s=e("./ReactPerf"),u=e("./invariant"),c={dangerouslySetInnerHTML:"`dangerouslySetInnerHTML` must be set using `updateInnerHTMLByID()`.",style:"`style` must be set using `updateStylesByID()`."},l={updatePropertyByID:s.measure("ReactDOMIDOperations","updatePropertyByID",function(e,t,n){var o=a.getNode(e);u(!c.hasOwnProperty(t)),null!=n?i.setValueForProperty(o,t,n):i.deleteValueForProperty(o,t)}),deletePropertyByID:s.measure("ReactDOMIDOperations","deletePropertyByID",function(e,t,n){var o=a.getNode(e);u(!c.hasOwnProperty(t)),i.deleteValueForProperty(o,t,n)}),updateStylesByID:s.measure("ReactDOMIDOperations","updateStylesByID",function(e,t){var n=a.getNode(e);o.setValueForStyles(n,t)}),updateInnerHTMLByID:s.measure("ReactDOMIDOperations","updateInnerHTMLByID",function(e,t){var o=a.getNode(e);if(void 0===n){var r=document.createElement("div");r.innerHTML=" ",n=""===r.innerHTML}n&&o.parentNode.replaceChild(o,o),n&&t.match(/^[ \r\n\t\f]/)?(o.innerHTML=""+t,o.firstChild.deleteData(0,1)):o.innerHTML=t}),updateTextContentByID:s.measure("ReactDOMIDOperations","updateTextContentByID",function(e,t){var n=a.getNode(e);r.updateTextContent(n,t)}),dangerouslyReplaceNodeWithMarkupByID:s.measure("ReactDOMIDOperations","dangerouslyReplaceNodeWithMarkupByID",function(e,t){var n=a.getNode(e);r.dangerouslyReplaceNodeWithMarkup(n,t)}),dangerouslyProcessChildrenUpdates:s.measure("ReactDOMIDOperations","dangerouslyProcessChildrenUpdates",function(e,t){for(var n=0;n<e.length;n++)e[n].parentNode=a.getNode(e[n].parentID);r.processUpdates(e,t)})};t.exports=l},{"./CSSPropertyOperations":3,"./DOMChildrenOperations":7,"./DOMPropertyOperations":9,"./ReactMount":53,"./ReactPerf":58,"./invariant":110}],37:[function(e,t){"use strict";var n=e("./ReactBrowserComponentMixin"),o=e("./ReactCompositeComponent"),r=e("./ReactDOM"),i=e("./ReactEventEmitter"),a=e("./EventConstants"),s=r.img,u=o.createClass({displayName:"ReactDOMImg",tagName:"IMG",mixins:[n],render:function(){return s(this.props)},componentDidMount:function(){var e=this.getDOMNode();i.trapBubbledEvent(a.topLevelTypes.topLoad,"load",e),i.trapBubbledEvent(a.topLevelTypes.topError,"error",e)}});t.exports=u},{"./EventConstants":14,"./ReactBrowserComponentMixin":25,"./ReactCompositeComponent":29,"./ReactDOM":32,"./ReactEventEmitter":46}],38:[function(e,t){"use strict";var n=e("./AutoFocusMixin"),o=e("./DOMPropertyOperations"),r=e("./LinkedValueUtils"),i=e("./ReactBrowserComponentMixin"),a=e("./ReactCompositeComponent"),s=e("./ReactDOM"),u=e("./ReactMount"),c=e("./invariant"),l=e("./merge"),p=s.input,d={},f=a.createClass({displayName:"ReactDOMInput",mixins:[n,r.Mixin,i],getInitialState:function(){var e=this.props.defaultValue;return{checked:this.props.defaultChecked||!1,value:null!=e?e:null}},shouldComponentUpdate:function(){return!this._isChanging},render:function(){var e=l(this.props);e.defaultChecked=null,e.defaultValue=null;var t=r.getValue(this);e.value=null!=t?t:this.state.value;var n=r.getChecked(this);return e.checked=null!=n?n:this.state.checked,e.onChange=this._handleChange,p(e,this.props.children)},componentDidMount:function(){var e=u.getID(this.getDOMNode());d[e]=this},componentWillUnmount:function(){var e=this.getDOMNode(),t=u.getID(e);delete d[t]},componentDidUpdate:function(){var e=this.getDOMNode();null!=this.props.checked&&o.setValueForProperty(e,"checked",this.props.checked||!1);var t=r.getValue(this);null!=t&&o.setValueForProperty(e,"value",""+t)},_handleChange:function(e){var t,n=r.getOnChange(this);n&&(this._isChanging=!0,t=n.call(this,e),this._isChanging=!1),this.setState({checked:e.target.checked,value:e.target.value});var o=this.props.name;if("radio"===this.props.type&&null!=o){for(var i=this.getDOMNode(),a=i;a.parentNode;)a=a.parentNode;for(var s=a.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),l=0,p=s.length;p>l;l++){var f=s[l];if(f!==i&&f.form===i.form){var h=u.getID(f);c(h);var m=d[h];c(m),m.setState({checked:!1})}}}return t}});t.exports=f},{"./AutoFocusMixin":1,"./DOMPropertyOperations":9,"./LinkedValueUtils":21,"./ReactBrowserComponentMixin":25,"./ReactCompositeComponent":29,"./ReactDOM":32,"./ReactMount":53,"./invariant":110,"./merge":119}],39:[function(e,t){"use strict";var n=e("./ReactBrowserComponentMixin"),o=e("./ReactCompositeComponent"),r=e("./ReactDOM"),i=(e("./warning"),r.option),a=o.createClass({displayName:"ReactDOMOption",mixins:[n],componentWillMount:function(){},render:function(){return i(this.props,this.props.children)}});t.exports=a},{"./ReactBrowserComponentMixin":25,"./ReactCompositeComponent":29,"./ReactDOM":32,"./warning":131}],40:[function(e,t){"use strict";function n(e,t){null!=e[t]&&c(e.multiple?Array.isArray(e[t]):!Array.isArray(e[t]))}function o(e,t){var n,o,r,i=e.props.multiple,a=null!=t?t:e.state.value,s=e.getDOMNode().options;if(i)for(n={},o=0,r=a.length;r>o;++o)n[""+a[o]]=!0;else n=""+a;for(o=0,r=s.length;r>o;o++){var u=i?n.hasOwnProperty(s[o].value):s[o].value===n;u!==s[o].selected&&(s[o].selected=u)}}var r=e("./AutoFocusMixin"),i=e("./LinkedValueUtils"),a=e("./ReactBrowserComponentMixin"),s=e("./ReactCompositeComponent"),u=e("./ReactDOM"),c=e("./invariant"),l=e("./merge"),p=u.select,d=s.createClass({displayName:"ReactDOMSelect",mixins:[r,i.Mixin,a],propTypes:{defaultValue:n,value:n},getInitialState:function(){return{value:this.props.defaultValue||(this.props.multiple?[]:"")}},componentWillReceiveProps:function(e){!this.props.multiple&&e.multiple?this.setState({value:[this.state.value]}):this.props.multiple&&!e.multiple&&this.setState({value:this.state.value[0]})},shouldComponentUpdate:function(){return!this._isChanging},render:function(){var e=l(this.props);return e.onChange=this._handleChange,e.value=null,p(e,this.props.children)},componentDidMount:function(){o(this,i.getValue(this))},componentDidUpdate:function(){var e=i.getValue(this);null!=e&&o(this,e)},_handleChange:function(e){var t,n=i.getOnChange(this);n&&(this._isChanging=!0,t=n.call(this,e),this._isChanging=!1);var o;if(this.props.multiple){o=[];for(var r=e.target.options,a=0,s=r.length;s>a;a++)r[a].selected&&o.push(r[a].value)}else o=e.target.value;return this.setState({value:o}),t}});t.exports=d},{"./AutoFocusMixin":1,"./LinkedValueUtils":21,"./ReactBrowserComponentMixin":25,"./ReactCompositeComponent":29,"./ReactDOM":32,"./invariant":110,"./merge":119}],41:[function(e,t){"use strict";function n(e){var t=document.selection,n=t.createRange(),o=n.text.length,r=n.duplicate();r.moveToElementText(e),r.setEndPoint("EndToStart",n);var i=r.text.length,a=i+o;return{start:i,end:a}}function o(e){var t=window.getSelection();if(0===t.rangeCount)return null;var n=t.anchorNode,o=t.anchorOffset,r=t.focusNode,i=t.focusOffset,a=t.getRangeAt(0),s=a.toString().length,u=a.cloneRange();u.selectNodeContents(e),u.setEnd(a.startContainer,a.startOffset);var c=u.toString().length,l=c+s,p=document.createRange();p.setStart(n,o),p.setEnd(r,i);var d=p.collapsed;return p.detach(),{start:d?l:c,end:d?c:l}}function r(e,t){var n,o,r=document.selection.createRange().duplicate();"undefined"==typeof t.end?(n=t.start,o=n):t.start>t.end?(n=t.end,o=t.start):(n=t.start,o=t.end),r.moveToElementText(e),r.moveStart("character",n),r.setEndPoint("EndToStart",r),r.moveEnd("character",o-n),r.select()}function i(e,t){var n=window.getSelection(),o=e[s()].length,r=Math.min(t.start,o),i="undefined"==typeof t.end?r:Math.min(t.end,o);if(!n.extend&&r>i){var u=i;i=r,r=u}var c=a(e,r),l=a(e,i);if(c&&l){var p=document.createRange();p.setStart(c.node,c.offset),n.removeAllRanges(),r>i?(n.addRange(p),n.extend(l.node,l.offset)):(p.setEnd(l.node,l.offset),n.addRange(p)),p.detach()}}var a=e("./getNodeForCharacterOffset"),s=e("./getTextContentAccessor"),u={getOffsets:function(e){var t=document.selection?n:o;return t(e)},setOffsets:function(e,t){var n=document.selection?r:i;n(e,t)}};t.exports=u},{"./getNodeForCharacterOffset":104,"./getTextContentAccessor":106}],42:[function(e,t){"use strict";var n=e("./AutoFocusMixin"),o=e("./DOMPropertyOperations"),r=e("./LinkedValueUtils"),i=e("./ReactBrowserComponentMixin"),a=e("./ReactCompositeComponent"),s=e("./ReactDOM"),u=e("./invariant"),c=e("./merge"),l=(e("./warning"),s.textarea),p=a.createClass({displayName:"ReactDOMTextarea",mixins:[n,r.Mixin,i],getInitialState:function(){var e=this.props.defaultValue,t=this.props.children;null!=t&&(u(null==e),Array.isArray(t)&&(u(t.length<=1),t=t[0]),e=""+t),null==e&&(e="");var n=r.getValue(this);return{initialValue:""+(null!=n?n:e),value:e}},shouldComponentUpdate:function(){return!this._isChanging},render:function(){var e=c(this.props),t=r.getValue(this);return u(null==e.dangerouslySetInnerHTML),e.defaultValue=null,e.value=null!=t?t:this.state.value,e.onChange=this._handleChange,l(e,this.state.initialValue)},componentDidUpdate:function(){var e=r.getValue(this);if(null!=e){var t=this.getDOMNode();o.setValueForProperty(t,"value",""+e)}},_handleChange:function(e){var t,n=r.getOnChange(this);return n&&(this._isChanging=!0,t=n.call(this,e),this._isChanging=!1),this.setState({value:e.target.value}),t}});t.exports=p},{"./AutoFocusMixin":1,"./DOMPropertyOperations":9,"./LinkedValueUtils":21,"./ReactBrowserComponentMixin":25,"./ReactCompositeComponent":29,"./ReactDOM":32,"./invariant":110,"./merge":119,"./warning":131}],43:[function(e,t){"use strict";function n(){this.reinitializeTransaction()}var o=e("./ReactUpdates"),r=e("./Transaction"),i=e("./emptyFunction"),a=e("./mixInto"),s={initialize:i,close:function(){p.isBatchingUpdates=!1}},u={initialize:i,close:o.flushBatchedUpdates.bind(o)},c=[u,s];a(n,r.Mixin),a(n,{getTransactionWrappers:function(){return c}});var l=new n,p={isBatchingUpdates:!1,batchedUpdates:function(e,t){var n=p.isBatchingUpdates;p.isBatchingUpdates=!0,n?e(t):l.perform(e,null,t)}};t.exports=p},{"./ReactUpdates":69,"./Transaction":83,"./emptyFunction":94,"./mixInto":122}],44:[function(e,t){"use strict";function n(){o.EventEmitter.injectTopLevelCallbackCreator(h),o.EventPluginHub.injectEventPluginOrder(c),o.EventPluginHub.injectInstanceHandle(D),o.EventPluginHub.injectMount(x),o.EventPluginHub.injectEventPluginsByName({SimpleEventPlugin:O,EnterLeaveEventPlugin:l,ChangeEventPlugin:a,CompositionEventPlugin:u,MobileSafariClickEventPlugin:p,SelectEventPlugin:b}),o.DOM.injectComponentClasses({button:v,form:g,img:C,input:y,option:E,select:R,textarea:M,html:T(m.html),head:T(m.head),title:T(m.title),body:T(m.body)}),o.CompositeComponent.injectMixin(d),o.DOMProperty.injectDOMPropertyConfig(i),o.Updates.injectBatchingStrategy(I),o.RootIndex.injectCreateReactRootIndex(r.canUseDOM?s.createReactRootIndex:P.createReactRootIndex),o.Component.injectEnvironment(f)}var o=e("./ReactInjection"),r=e("./ExecutionEnvironment"),i=e("./DefaultDOMPropertyConfig"),a=e("./ChangeEventPlugin"),s=e("./ClientReactRootIndex"),u=e("./CompositionEventPlugin"),c=e("./DefaultEventPluginOrder"),l=e("./EnterLeaveEventPlugin"),p=e("./MobileSafariClickEventPlugin"),d=e("./ReactBrowserComponentMixin"),f=e("./ReactComponentBrowserEnvironment"),h=e("./ReactEventTopLevelCallback"),m=e("./ReactDOM"),v=e("./ReactDOMButton"),g=e("./ReactDOMForm"),C=e("./ReactDOMImg"),y=e("./ReactDOMInput"),E=e("./ReactDOMOption"),R=e("./ReactDOMSelect"),M=e("./ReactDOMTextarea"),D=e("./ReactInstanceHandles"),x=e("./ReactMount"),b=e("./SelectEventPlugin"),P=e("./ServerReactRootIndex"),O=e("./SimpleEventPlugin"),I=e("./ReactDefaultBatchingStrategy"),T=e("./createFullPageComponent");t.exports={inject:n}},{"./ChangeEventPlugin":4,"./ClientReactRootIndex":5,"./CompositionEventPlugin":6,"./DefaultDOMPropertyConfig":11,"./DefaultEventPluginOrder":12,"./EnterLeaveEventPlugin":13,"./ExecutionEnvironment":20,"./MobileSafariClickEventPlugin":22,"./ReactBrowserComponentMixin":25,"./ReactComponentBrowserEnvironment":28,"./ReactDOM":32,"./ReactDOMButton":33,"./ReactDOMForm":35,"./ReactDOMImg":37,"./ReactDOMInput":38,"./ReactDOMOption":39,"./ReactDOMSelect":40,"./ReactDOMTextarea":42,"./ReactDefaultBatchingStrategy":43,"./ReactEventTopLevelCallback":48,"./ReactInjection":49,"./ReactInstanceHandles":51,"./ReactMount":53,"./SelectEventPlugin":70,"./ServerReactRootIndex":71,"./SimpleEventPlugin":72,"./createFullPageComponent":90}],45:[function(e,t){"use strict";var n={guard:function(e){return e}};t.exports=n},{}],46:[function(e,t){"use strict";function n(e){return null==e[y]&&(e[y]=g++,m[e[y]]={}),m[e[y]]}function o(e,t,n){a.listen(n,t,E.TopLevelCallbackCreator.createTopLevelCallback(e))}function r(e,t,n){a.capture(n,t,E.TopLevelCallbackCreator.createTopLevelCallback(e))}var i=e("./EventConstants"),a=e("./EventListener"),s=e("./EventPluginHub"),u=e("./EventPluginRegistry"),c=e("./ExecutionEnvironment"),l=e("./ReactEventEmitterMixin"),p=e("./ViewportMetrics"),d=e("./invariant"),f=e("./isEventSupported"),h=e("./merge"),m={},v=!1,g=0,C={topBlur:"blur",topChange:"change",topClick:"click",topCompositionEnd:"compositionend",topCompositionStart:"compositionstart",topCompositionUpdate:"compositionupdate",topContextMenu:"contextmenu",topCopy:"copy",topCut:"cut",topDoubleClick:"dblclick",topDrag:"drag",topDragEnd:"dragend",topDragEnter:"dragenter",topDragExit:"dragexit",topDragLeave:"dragleave",topDragOver:"dragover",topDragStart:"dragstart",topDrop:"drop",topFocus:"focus",topInput:"input",topKeyDown:"keydown",topKeyPress:"keypress",topKeyUp:"keyup",topMouseDown:"mousedown",topMouseMove:"mousemove",topMouseOut:"mouseout",topMouseOver:"mouseover",topMouseUp:"mouseup",topPaste:"paste",topScroll:"scroll",topSelectionChange:"selectionchange",topTouchCancel:"touchcancel",topTouchEnd:"touchend",topTouchMove:"touchmove",topTouchStart:"touchstart",topWheel:"wheel"},y="_reactListenersID"+String(Math.random()).slice(2),E=h(l,{TopLevelCallbackCreator:null,injection:{injectTopLevelCallbackCreator:function(e){E.TopLevelCallbackCreator=e}},setEnabled:function(e){d(c.canUseDOM),E.TopLevelCallbackCreator&&E.TopLevelCallbackCreator.setEnabled(e)},isEnabled:function(){return!(!E.TopLevelCallbackCreator||!E.TopLevelCallbackCreator.isEnabled())},listenTo:function(e,t){for(var a=t,s=n(a),c=u.registrationNameDependencies[e],l=i.topLevelTypes,p=0,d=c.length;d>p;p++){var h=c[p];if(!s[h]){var m=l[h];m===l.topWheel?f("wheel")?o(l.topWheel,"wheel",a):f("mousewheel")?o(l.topWheel,"mousewheel",a):o(l.topWheel,"DOMMouseScroll",a):m===l.topScroll?f("scroll",!0)?r(l.topScroll,"scroll",a):o(l.topScroll,"scroll",window):m===l.topFocus||m===l.topBlur?(f("focus",!0)?(r(l.topFocus,"focus",a),r(l.topBlur,"blur",a)):f("focusin")&&(o(l.topFocus,"focusin",a),o(l.topBlur,"focusout",a)),s[l.topBlur]=!0,s[l.topFocus]=!0):C[h]&&o(m,C[h],a),s[h]=!0}}},ensureScrollValueMonitoring:function(){if(!v){var e=p.refreshScrollValues;a.listen(window,"scroll",e),a.listen(window,"resize",e),v=!0}},eventNameDispatchConfigs:s.eventNameDispatchConfigs,registrationNameModules:s.registrationNameModules,putListener:s.putListener,getListener:s.getListener,deleteListener:s.deleteListener,deleteAllListeners:s.deleteAllListeners,trapBubbledEvent:o,trapCapturedEvent:r});t.exports=E},{"./EventConstants":14,"./EventListener":15,"./EventPluginHub":16,"./EventPluginRegistry":17,"./ExecutionEnvironment":20,"./ReactEventEmitterMixin":47,"./ViewportMetrics":84,"./invariant":110,"./isEventSupported":111,"./merge":119}],47:[function(e,t){"use strict";function n(e){o.enqueueEvents(e),o.processEventQueue()}var o=e("./EventPluginHub"),r=e("./ReactUpdates"),i={handleTopLevel:function(e,t,i,a){var s=o.extractEvents(e,t,i,a);
+r.batchedUpdates(n,s)}};t.exports=i},{"./EventPluginHub":16,"./ReactUpdates":69}],48:[function(e,t){"use strict";function n(e){var t=u.getID(e),n=s.getReactRootIDFromNodeID(t),o=u.findReactContainerForID(n),r=u.getFirstReactDOM(o);return r}function o(e,t,o){for(var r=u.getFirstReactDOM(c(t))||window,i=r;i;)o.ancestors.push(i),i=n(i);for(var s=0,l=o.ancestors.length;l>s;s++){r=o.ancestors[s];var p=u.getID(r)||"";a.handleTopLevel(e,r,p,t)}}function r(){this.ancestors=[]}var i=e("./PooledClass"),a=e("./ReactEventEmitter"),s=e("./ReactInstanceHandles"),u=e("./ReactMount"),c=e("./getEventTarget"),l=e("./mixInto"),p=!0;l(r,{destructor:function(){this.ancestors.length=0}}),i.addPoolingTo(r);var d={setEnabled:function(e){p=!!e},isEnabled:function(){return p},createTopLevelCallback:function(e){return function(t){if(p){var n=r.getPooled();try{o(e,t,n)}finally{r.release(n)}}}}};t.exports=d},{"./PooledClass":23,"./ReactEventEmitter":46,"./ReactInstanceHandles":51,"./ReactMount":53,"./getEventTarget":102,"./mixInto":122}],49:[function(e,t){"use strict";var n=e("./DOMProperty"),o=e("./EventPluginHub"),r=e("./ReactComponent"),i=e("./ReactCompositeComponent"),a=e("./ReactDOM"),s=e("./ReactEventEmitter"),u=e("./ReactPerf"),c=e("./ReactRootIndex"),l=e("./ReactUpdates"),p={Component:r.injection,CompositeComponent:i.injection,DOMProperty:n.injection,EventPluginHub:o.injection,DOM:a.injection,EventEmitter:s.injection,Perf:u.injection,RootIndex:c.injection,Updates:l.injection};t.exports=p},{"./DOMProperty":8,"./EventPluginHub":16,"./ReactComponent":27,"./ReactCompositeComponent":29,"./ReactDOM":32,"./ReactEventEmitter":46,"./ReactPerf":58,"./ReactRootIndex":65,"./ReactUpdates":69}],50:[function(e,t){"use strict";function n(e){return r(document.documentElement,e)}var o=e("./ReactDOMSelection"),r=e("./containsNode"),i=e("./focusNode"),a=e("./getActiveElement"),s={hasSelectionCapabilities:function(e){return e&&("INPUT"===e.nodeName&&"text"===e.type||"TEXTAREA"===e.nodeName||"true"===e.contentEditable)},getSelectionInformation:function(){var e=a();return{focusedElem:e,selectionRange:s.hasSelectionCapabilities(e)?s.getSelection(e):null}},restoreSelection:function(e){var t=a(),o=e.focusedElem,r=e.selectionRange;t!==o&&n(o)&&(s.hasSelectionCapabilities(o)&&s.setSelection(o,r),i(o))},getSelection:function(e){var t;if("selectionStart"in e)t={start:e.selectionStart,end:e.selectionEnd};else if(document.selection&&"INPUT"===e.nodeName){var n=document.selection.createRange();n.parentElement()===e&&(t={start:-n.moveStart("character",-e.value.length),end:-n.moveEnd("character",-e.value.length)})}else t=o.getOffsets(e);return t||{start:0,end:0}},setSelection:function(e,t){var n=t.start,r=t.end;if("undefined"==typeof r&&(r=n),"selectionStart"in e)e.selectionStart=n,e.selectionEnd=Math.min(r,e.value.length);else if(document.selection&&"INPUT"===e.nodeName){var i=e.createTextRange();i.collapse(!0),i.moveStart("character",n),i.moveEnd("character",r-n),i.select()}else o.setOffsets(e,t)}};t.exports=s},{"./ReactDOMSelection":41,"./containsNode":87,"./focusNode":98,"./getActiveElement":100}],51:[function(e,t){"use strict";function n(e){return d+e.toString(36)}function o(e,t){return e.charAt(t)===d||t===e.length}function r(e){return""===e||e.charAt(0)===d&&e.charAt(e.length-1)!==d}function i(e,t){return 0===t.indexOf(e)&&o(t,e.length)}function a(e){return e?e.substr(0,e.lastIndexOf(d)):""}function s(e,t){if(p(r(e)&&r(t)),p(i(e,t)),e===t)return e;for(var n=e.length+f,a=n;a<t.length&&!o(t,a);a++);return t.substr(0,a)}function u(e,t){var n=Math.min(e.length,t.length);if(0===n)return"";for(var i=0,a=0;n>=a;a++)if(o(e,a)&&o(t,a))i=a;else if(e.charAt(a)!==t.charAt(a))break;var s=e.substr(0,i);return p(r(s)),s}function c(e,t,n,o,r,u){e=e||"",t=t||"",p(e!==t);var c=i(t,e);p(c||i(e,t));for(var l=0,d=c?a:s,f=e;;f=d(f,t)){var m;if(r&&f===e||u&&f===t||(m=n(f,c,o)),m===!1||f===t)break;p(l++<h)}}var l=e("./ReactRootIndex"),p=e("./invariant"),d=".",f=d.length,h=100,m={createReactRootID:function(){return n(l.createReactRootIndex())},createReactID:function(e,t){return e+t},getReactRootIDFromNodeID:function(e){if(e&&e.charAt(0)===d&&e.length>1){var t=e.indexOf(d,1);return t>-1?e.substr(0,t):e}return null},traverseEnterLeave:function(e,t,n,o,r){var i=u(e,t);i!==e&&c(e,i,n,o,!1,!0),i!==t&&c(i,t,n,r,!0,!1)},traverseTwoPhase:function(e,t,n){e&&(c("",e,t,n,!0,!1),c(e,"",t,n,!1,!0))},traverseAncestors:function(e,t,n){c("",e,t,n,!0,!1)},_getFirstCommonAncestorID:u,_getNextDescendantID:s,isAncestorIDOf:i,SEPARATOR:d};t.exports=m},{"./ReactRootIndex":65,"./invariant":110}],52:[function(e,t){"use strict";var n=e("./adler32"),o={CHECKSUM_ATTR_NAME:"data-react-checksum",addChecksumToMarkup:function(e){var t=n(e);return e.replace(">"," "+o.CHECKSUM_ATTR_NAME+'="'+t+'">')},canReuseMarkup:function(e,t){var r=t.getAttribute(o.CHECKSUM_ATTR_NAME);r=r&&parseInt(r,10);var i=n(e);return i===r}};t.exports=o},{"./adler32":86}],53:[function(e,t){"use strict";function n(e){var t=v(e);return t&&T.getID(t)}function o(e){var t=r(e);if(t)if(M.hasOwnProperty(t)){var n=M[t];n!==e&&(C(!s(n,t)),M[t]=e)}else M[t]=e;return t}function r(e){return e&&e.getAttribute&&e.getAttribute(R)||""}function i(e,t){var n=r(e);n!==t&&delete M[n],e.setAttribute(R,t),M[t]=e}function a(e){return M.hasOwnProperty(e)&&s(M[e],e)||(M[e]=T.findReactNodeByID(e)),M[e]}function s(e,t){if(e){C(r(e)===t);var n=T.findReactContainerForID(t);if(n&&m(n,e))return!0}return!1}function u(e){delete M[e]}function c(e){var t=M[e];return t&&s(t,e)?void(I=t):!1}function l(e){I=null,f.traverseAncestors(e,c);var t=I;return I=null,t}var p=e("./DOMProperty"),d=e("./ReactEventEmitter"),f=e("./ReactInstanceHandles"),h=e("./ReactPerf"),m=e("./containsNode"),v=e("./getReactRootElementInContainer"),g=e("./instantiateReactComponent"),C=e("./invariant"),y=e("./shouldUpdateReactComponent"),E=f.SEPARATOR,R=p.ID_ATTRIBUTE_NAME,M={},D=1,x=9,b={},P={},O=[],I=null,T={totalInstantiationTime:0,totalInjectionTime:0,useTouchEvents:!1,_instancesByReactRootID:b,scrollMonitor:function(e,t){t()},_updateRootComponent:function(e,t,n,o){var r=t.props;return T.scrollMonitor(n,function(){e.replaceProps(r,o)}),e},_registerComponent:function(e,t){C(t&&(t.nodeType===D||t.nodeType===x)),d.ensureScrollValueMonitoring();var n=T.registerContainer(t);return b[n]=e,n},_renderNewRootComponent:h.measure("ReactMount","_renderNewRootComponent",function(e,t,n){var o=g(e),r=T._registerComponent(o,t);return o.mountComponentIntoNode(r,t,n),o}),renderComponent:function(e,t,o){var r=b[n(t)];if(r){if(y(r,e))return T._updateRootComponent(r,e,t,o);T.unmountComponentAtNode(t)}var i=v(t),a=i&&T.isRenderedByReact(i),s=a&&!r,u=T._renderNewRootComponent(e,t,s);return o&&o.call(u),u},constructAndRenderComponent:function(e,t,n){return T.renderComponent(e(t),n)},constructAndRenderComponentByID:function(e,t,n){var o=document.getElementById(n);return C(o),T.constructAndRenderComponent(e,t,o)},registerContainer:function(e){var t=n(e);return t&&(t=f.getReactRootIDFromNodeID(t)),t||(t=f.createReactRootID()),P[t]=e,t},unmountComponentAtNode:function(e){var t=n(e),o=b[t];return o?(T.unmountComponentFromNode(o,e),delete b[t],delete P[t],!0):!1},unmountComponentFromNode:function(e,t){for(e.unmountComponent(),t.nodeType===x&&(t=t.documentElement);t.lastChild;)t.removeChild(t.lastChild)},findReactContainerForID:function(e){var t=f.getReactRootIDFromNodeID(e),n=P[t];return n},findReactNodeByID:function(e){var t=T.findReactContainerForID(e);return T.findComponentRoot(t,e)},isRenderedByReact:function(e){if(1!==e.nodeType)return!1;var t=T.getID(e);return t?t.charAt(0)===E:!1},getFirstReactDOM:function(e){for(var t=e;t&&t.parentNode!==t;){if(T.isRenderedByReact(t))return t;t=t.parentNode}return null},findComponentRoot:function(e,t){var n=O,o=0,r=l(t)||e;for(n[0]=r.firstChild,n.length=1;o<n.length;){for(var i,a=n[o++];a;){var s=T.getID(a);s?t===s?i=a:f.isAncestorIDOf(s,t)&&(n.length=o=0,n.push(a.firstChild)):n.push(a.firstChild),a=a.nextSibling}if(i)return n.length=0,i}n.length=0,C(!1)},getReactRootID:n,getID:o,setID:i,getNode:a,purgeID:u};t.exports=T},{"./DOMProperty":8,"./ReactEventEmitter":46,"./ReactInstanceHandles":51,"./ReactPerf":58,"./containsNode":87,"./getReactRootElementInContainer":105,"./instantiateReactComponent":109,"./invariant":110,"./shouldUpdateReactComponent":128}],54:[function(e,t){"use strict";function n(e){this._queue=e||null}var o=e("./PooledClass"),r=e("./mixInto");r(n,{enqueue:function(e,t){this._queue=this._queue||[],this._queue.push({component:e,callback:t})},notifyAll:function(){var e=this._queue;if(e){this._queue=null;for(var t=0,n=e.length;n>t;t++){var o=e[t].component,r=e[t].callback;r.call(o)}e.length=0}},reset:function(){this._queue=null},destructor:function(){this.reset()}}),o.addPoolingTo(n),t.exports=n},{"./PooledClass":23,"./mixInto":122}],55:[function(e,t){"use strict";function n(e,t,n){h.push({parentID:e,parentNode:null,type:c.INSERT_MARKUP,markupIndex:m.push(t)-1,textContent:null,fromIndex:null,toIndex:n})}function o(e,t,n){h.push({parentID:e,parentNode:null,type:c.MOVE_EXISTING,markupIndex:null,textContent:null,fromIndex:t,toIndex:n})}function r(e,t){h.push({parentID:e,parentNode:null,type:c.REMOVE_NODE,markupIndex:null,textContent:null,fromIndex:t,toIndex:null})}function i(e,t){h.push({parentID:e,parentNode:null,type:c.TEXT_CONTENT,markupIndex:null,textContent:t,fromIndex:null,toIndex:null})}function a(){h.length&&(u.BackendIDOperations.dangerouslyProcessChildrenUpdates(h,m),s())}function s(){h.length=0,m.length=0}var u=e("./ReactComponent"),c=e("./ReactMultiChildUpdateTypes"),l=e("./flattenChildren"),p=e("./instantiateReactComponent"),d=e("./shouldUpdateReactComponent"),f=0,h=[],m=[],v={Mixin:{mountChildren:function(e,t){var n=l(e),o=[],r=0;this._renderedChildren=n;for(var i in n){var a=n[i];if(n.hasOwnProperty(i)){var s=p(a);n[i]=s;var u=this._rootNodeID+i,c=s.mountComponent(u,t,this._mountDepth+1);s._mountIndex=r,o.push(c),r++}}return o},updateTextContent:function(e){f++;var t=!0;try{var n=this._renderedChildren;for(var o in n)n.hasOwnProperty(o)&&this._unmountChildByName(n[o],o);this.setTextContent(e),t=!1}finally{f--,f||(t?s():a())}},updateChildren:function(e,t){f++;var n=!0;try{this._updateChildren(e,t),n=!1}finally{f--,f||(n?s():a())}},_updateChildren:function(e,t){var n=l(e),o=this._renderedChildren;if(n||o){var r,i=0,a=0;for(r in n)if(n.hasOwnProperty(r)){var s=o&&o[r],u=n[r];if(d(s,u))this.moveChild(s,a,i),i=Math.max(s._mountIndex,i),s.receiveComponent(u,t),s._mountIndex=a;else{s&&(i=Math.max(s._mountIndex,i),this._unmountChildByName(s,r));var c=p(u);this._mountChildByNameAtIndex(c,r,a,t)}a++}for(r in o)!o.hasOwnProperty(r)||n&&n[r]||this._unmountChildByName(o[r],r)}},unmountChildren:function(){var e=this._renderedChildren;for(var t in e){var n=e[t];n.unmountComponent&&n.unmountComponent()}this._renderedChildren=null},moveChild:function(e,t,n){e._mountIndex<n&&o(this._rootNodeID,e._mountIndex,t)},createChild:function(e,t){n(this._rootNodeID,t,e._mountIndex)},removeChild:function(e){r(this._rootNodeID,e._mountIndex)},setTextContent:function(e){i(this._rootNodeID,e)},_mountChildByNameAtIndex:function(e,t,n,o){var r=this._rootNodeID+t,i=e.mountComponent(r,o,this._mountDepth+1);e._mountIndex=n,this.createChild(e,i),this._renderedChildren=this._renderedChildren||{},this._renderedChildren[t]=e},_unmountChildByName:function(e,t){u.isValidComponent(e)&&(this.removeChild(e),e._mountIndex=null,e.unmountComponent(),delete this._renderedChildren[t])}}};t.exports=v},{"./ReactComponent":27,"./ReactMultiChildUpdateTypes":56,"./flattenChildren":97,"./instantiateReactComponent":109,"./shouldUpdateReactComponent":128}],56:[function(e,t){"use strict";var n=e("./keyMirror"),o=n({INSERT_MARKUP:null,MOVE_EXISTING:null,REMOVE_NODE:null,TEXT_CONTENT:null});t.exports=o},{"./keyMirror":116}],57:[function(e,t){"use strict";var n=e("./emptyObject"),o=e("./invariant"),r={isValidOwner:function(e){return!(!e||"function"!=typeof e.attachRef||"function"!=typeof e.detachRef)},addComponentAsRefTo:function(e,t,n){o(r.isValidOwner(n)),n.attachRef(t,e)},removeComponentAsRefFrom:function(e,t,n){o(r.isValidOwner(n)),n.refs[t]===e&&n.detachRef(t)},Mixin:{construct:function(){this.refs=n},attachRef:function(e,t){o(t.isOwnedBy(this));var r=this.refs===n?this.refs={}:this.refs;r[e]=t},detachRef:function(e){delete this.refs[e]}}};t.exports=r},{"./emptyObject":95,"./invariant":110}],58:[function(e,t){"use strict";function n(e,t,n){return n}var o={enableMeasure:!1,storedMeasure:n,measure:function(e,t,n){return n},injection:{injectMeasure:function(e){o.storedMeasure=e}}};t.exports=o},{}],59:[function(e,t){"use strict";function n(e){return function(t,n,o){t[n]=t.hasOwnProperty(n)?e(t[n],o):o}}var o=e("./emptyFunction"),r=e("./invariant"),i=e("./joinClasses"),a=e("./merge"),s={children:o,className:n(i),key:o,ref:o,style:n(a)},u={TransferStrategies:s,mergeProps:function(e,t){var n=a(e);for(var o in t)if(t.hasOwnProperty(o)){var r=s[o];r&&s.hasOwnProperty(o)?r(n,o,t[o]):n.hasOwnProperty(o)||(n[o]=t[o])}return n},Mixin:{transferPropsTo:function(e){return r(e._owner===this),e.props=u.mergeProps(e.props,this.props),e}}};t.exports=u},{"./emptyFunction":94,"./invariant":110,"./joinClasses":115,"./merge":119}],60:[function(e,t){"use strict";var n={};t.exports=n},{}],61:[function(e,t){"use strict";var n=e("./keyMirror"),o=n({prop:null,context:null,childContext:null});t.exports=o},{"./keyMirror":116}],62:[function(e,t){"use strict";function n(e){switch(typeof e){case"number":case"string":return!0;case"object":if(Array.isArray(e))return e.every(n);if(h.isValidComponent(e))return!0;for(var t in e)if(!n(e[t]))return!1;return!0;default:return!1}}function o(e){var t=typeof e;return"object"===t&&Array.isArray(e)?"array":t}function r(){function e(){return!0}return f(e)}function i(e){function t(t,n){var r=o(n),i=r===e;return i}return f(t)}function a(e){function t(e,t){var o=n[t];return o}var n=m(e);return f(t)}function s(e){function t(t,n,r,i,a){var s=o(n),u="object"===s;if(u)for(var c in e){var l=e[c];if(l&&!l(n,c,i,a))return!1}return u}return f(t)}function u(e){function t(t,n){var o=n instanceof e;return o}return f(t)}function c(e){function t(t,n,o,r,i){var a=Array.isArray(n);if(a)for(var s=0;s<n.length;s++)if(!e(n,s,r,i))return!1;return a}return f(t)}function l(){function e(e,t){var o=n(t);return o}return f(e)}function p(){function e(e,t){var n=h.isValidComponent(t);return n}return f(e)}function d(e){return function(t,n,o,r){for(var i=!1,a=0;a<e.length;a++){var s=e[a];if("function"==typeof s.weak&&(s=s.weak),s(t,n,o,r)){i=!0;break}}return i}}function f(e){function t(t,n,o,r,i,a){var s=o[r];if(null!=s)return e(n,s,r,i||g,a);var u=!t;return u}var n=t.bind(null,!1,!0);return n.weak=t.bind(null,!1,!1),n.isRequired=t.bind(null,!0,!0),n.weak.isRequired=t.bind(null,!0,!1),n.isRequired.weak=n.weak.isRequired,n}var h=e("./ReactComponent"),m=(e("./ReactPropTypeLocationNames"),e("./warning"),e("./createObjectFrom")),v={array:i("array"),bool:i("boolean"),func:i("function"),number:i("number"),object:i("object"),string:i("string"),shape:s,oneOf:a,oneOfType:d,arrayOf:c,instanceOf:u,renderable:l(),component:p(),any:r()},g="<<anonymous>>";t.exports=v},{"./ReactComponent":27,"./ReactPropTypeLocationNames":60,"./createObjectFrom":92,"./warning":131}],63:[function(e,t){"use strict";function n(){this.listenersToPut=[]}var o=e("./PooledClass"),r=e("./ReactEventEmitter"),i=e("./mixInto");i(n,{enqueuePutListener:function(e,t,n){this.listenersToPut.push({rootNodeID:e,propKey:t,propValue:n})},putListeners:function(){for(var e=0;e<this.listenersToPut.length;e++){var t=this.listenersToPut[e];r.putListener(t.rootNodeID,t.propKey,t.propValue)}},reset:function(){this.listenersToPut.length=0},destructor:function(){this.reset()}}),o.addPoolingTo(n),t.exports=n},{"./PooledClass":23,"./ReactEventEmitter":46,"./mixInto":122}],64:[function(e,t){"use strict";function n(){this.reinitializeTransaction(),this.renderToStaticMarkup=!1,this.reactMountReady=a.getPooled(null),this.putListenerQueue=s.getPooled()}var o=e("./PooledClass"),r=e("./ReactEventEmitter"),i=e("./ReactInputSelection"),a=e("./ReactMountReady"),s=e("./ReactPutListenerQueue"),u=e("./Transaction"),c=e("./mixInto"),l={initialize:i.getSelectionInformation,close:i.restoreSelection},p={initialize:function(){var e=r.isEnabled();return r.setEnabled(!1),e},close:function(e){r.setEnabled(e)}},d={initialize:function(){this.reactMountReady.reset()},close:function(){this.reactMountReady.notifyAll()}},f={initialize:function(){this.putListenerQueue.reset()},close:function(){this.putListenerQueue.putListeners()}},h=[f,l,p,d],m={getTransactionWrappers:function(){return h},getReactMountReady:function(){return this.reactMountReady},getPutListenerQueue:function(){return this.putListenerQueue},destructor:function(){a.release(this.reactMountReady),this.reactMountReady=null,s.release(this.putListenerQueue),this.putListenerQueue=null}};c(n,u.Mixin),c(n,m),o.addPoolingTo(n),t.exports=n},{"./PooledClass":23,"./ReactEventEmitter":46,"./ReactInputSelection":50,"./ReactMountReady":54,"./ReactPutListenerQueue":63,"./Transaction":83,"./mixInto":122}],65:[function(e,t){"use strict";var n={injectCreateReactRootIndex:function(e){o.createReactRootIndex=e}},o={createReactRootIndex:null,injection:n};t.exports=o},{}],66:[function(e,t){"use strict";function n(e){c(r.isValidComponent(e)),c(!(2===arguments.length&&"function"==typeof arguments[1]));var t;try{var n=i.createReactRootID();return t=s.getPooled(!1),t.perform(function(){var o=u(e),r=o.mountComponent(n,t,0);return a.addChecksumToMarkup(r)},null)}finally{s.release(t)}}function o(e){c(r.isValidComponent(e));var t;try{var n=i.createReactRootID();return t=s.getPooled(!0),t.perform(function(){var o=u(e);return o.mountComponent(n,t,0)},null)}finally{s.release(t)}}var r=e("./ReactComponent"),i=e("./ReactInstanceHandles"),a=e("./ReactMarkupChecksum"),s=e("./ReactServerRenderingTransaction"),u=e("./instantiateReactComponent"),c=e("./invariant");t.exports={renderComponentToString:n,renderComponentToStaticMarkup:o}},{"./ReactComponent":27,"./ReactInstanceHandles":51,"./ReactMarkupChecksum":52,"./ReactServerRenderingTransaction":67,"./instantiateReactComponent":109,"./invariant":110}],67:[function(e,t){"use strict";function n(e){this.reinitializeTransaction(),this.renderToStaticMarkup=e,this.reactMountReady=r.getPooled(null),this.putListenerQueue=i.getPooled()}var o=e("./PooledClass"),r=e("./ReactMountReady"),i=e("./ReactPutListenerQueue"),a=e("./Transaction"),s=e("./emptyFunction"),u=e("./mixInto"),c={initialize:function(){this.reactMountReady.reset()},close:s},l={initialize:function(){this.putListenerQueue.reset()},close:s},p=[l,c],d={getTransactionWrappers:function(){return p},getReactMountReady:function(){return this.reactMountReady},getPutListenerQueue:function(){return this.putListenerQueue},destructor:function(){r.release(this.reactMountReady),this.reactMountReady=null,i.release(this.putListenerQueue),this.putListenerQueue=null}};u(n,a.Mixin),u(n,d),o.addPoolingTo(n),t.exports=n},{"./PooledClass":23,"./ReactMountReady":54,"./ReactPutListenerQueue":63,"./Transaction":83,"./emptyFunction":94,"./mixInto":122}],68:[function(e,t){"use strict";var n=e("./DOMPropertyOperations"),o=e("./ReactBrowserComponentMixin"),r=e("./ReactComponent"),i=e("./escapeTextForBrowser"),a=e("./mixInto"),s=function(e){this.construct({text:e})};s.ConvenienceConstructor=function(e){return new s(e.text)},a(s,r.Mixin),a(s,o),a(s,{mountComponent:function(e,t,o){r.Mixin.mountComponent.call(this,e,t,o);var a=i(this.props.text);return t.renderToStaticMarkup?a:"<span "+n.createMarkupForID(e)+">"+a+"</span>"},receiveComponent:function(e){var t=e.props;t.text!==this.props.text&&(this.props.text=t.text,r.BackendIDOperations.updateTextContentByID(this._rootNodeID,t.text))}}),s.type=s,s.prototype.type=s,t.exports=s},{"./DOMPropertyOperations":9,"./ReactBrowserComponentMixin":25,"./ReactComponent":27,"./escapeTextForBrowser":96,"./mixInto":122}],69:[function(e,t){"use strict";function n(){c(p)}function o(e,t){n(),p.batchedUpdates(e,t)}function r(e,t){return e._mountDepth-t._mountDepth}function i(){l.sort(r);for(var e=0;e<l.length;e++){var t=l[e];if(t.isMounted()){var n=t._pendingCallbacks;if(t._pendingCallbacks=null,t.performUpdateIfNecessary(),n)for(var o=0;o<n.length;o++)n[o].call(t)}}}function a(){l.length=0}function s(e,t){return c(!t||"function"==typeof t),n(),p.isBatchingUpdates?(l.push(e),void(t&&(e._pendingCallbacks?e._pendingCallbacks.push(t):e._pendingCallbacks=[t]))):(e.performUpdateIfNecessary(),void(t&&t.call(e)))}var u=e("./ReactPerf"),c=e("./invariant"),l=[],p=null,d=u.measure("ReactUpdates","flushBatchedUpdates",function(){try{i()}finally{a()}}),f={injectBatchingStrategy:function(e){c(e),c("function"==typeof e.batchedUpdates),c("boolean"==typeof e.isBatchingUpdates),p=e}},h={batchedUpdates:o,enqueueUpdate:s,flushBatchedUpdates:d,injection:f};t.exports=h},{"./ReactPerf":58,"./invariant":110}],70:[function(e,t){"use strict";function n(e){if("selectionStart"in e&&a.hasSelectionCapabilities(e))return{start:e.selectionStart,end:e.selectionEnd};if(document.selection){var t=document.selection.createRange();return{parentElement:t.parentElement(),text:t.text,top:t.boundingTop,left:t.boundingLeft}}var n=window.getSelection();return{anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}}function o(e){if(!g&&null!=h&&h==u()){var t=n(h);if(!v||!p(v,t)){v=t;var o=s.getPooled(f.select,m,e);return o.type="select",o.target=h,i.accumulateTwoPhaseDispatches(o),o}}}var r=e("./EventConstants"),i=e("./EventPropagators"),a=e("./ReactInputSelection"),s=e("./SyntheticEvent"),u=e("./getActiveElement"),c=e("./isTextInputElement"),l=e("./keyOf"),p=e("./shallowEqual"),d=r.topLevelTypes,f={select:{phasedRegistrationNames:{bubbled:l({onSelect:null}),captured:l({onSelectCapture:null})},dependencies:[d.topBlur,d.topContextMenu,d.topFocus,d.topKeyDown,d.topMouseDown,d.topMouseUp,d.topSelectionChange]}},h=null,m=null,v=null,g=!1,C={eventTypes:f,extractEvents:function(e,t,n,r){switch(e){case d.topFocus:(c(t)||"true"===t.contentEditable)&&(h=t,m=n,v=null);break;case d.topBlur:h=null,m=null,v=null;break;case d.topMouseDown:g=!0;break;case d.topContextMenu:case d.topMouseUp:return g=!1,o(r);case d.topSelectionChange:case d.topKeyDown:case d.topKeyUp:return o(r)}}};t.exports=C},{"./EventConstants":14,"./EventPropagators":19,"./ReactInputSelection":50,"./SyntheticEvent":76,"./getActiveElement":100,"./isTextInputElement":113,"./keyOf":117,"./shallowEqual":127}],71:[function(e,t){"use strict";var n=Math.pow(2,53),o={createReactRootIndex:function(){return Math.ceil(Math.random()*n)}};t.exports=o},{}],72:[function(e,t){"use strict";var n=e("./EventConstants"),o=e("./EventPluginUtils"),r=e("./EventPropagators"),i=e("./SyntheticClipboardEvent"),a=e("./SyntheticEvent"),s=e("./SyntheticFocusEvent"),u=e("./SyntheticKeyboardEvent"),c=e("./SyntheticMouseEvent"),l=e("./SyntheticDragEvent"),p=e("./SyntheticTouchEvent"),d=e("./SyntheticUIEvent"),f=e("./SyntheticWheelEvent"),h=e("./invariant"),m=e("./keyOf"),v=n.topLevelTypes,g={blur:{phasedRegistrationNames:{bubbled:m({onBlur:!0}),captured:m({onBlurCapture:!0})}},click:{phasedRegistrationNames:{bubbled:m({onClick:!0}),captured:m({onClickCapture:!0})}},contextMenu:{phasedRegistrationNames:{bubbled:m({onContextMenu:!0}),captured:m({onContextMenuCapture:!0})}},copy:{phasedRegistrationNames:{bubbled:m({onCopy:!0}),captured:m({onCopyCapture:!0})}},cut:{phasedRegistrationNames:{bubbled:m({onCut:!0}),captured:m({onCutCapture:!0})}},doubleClick:{phasedRegistrationNames:{bubbled:m({onDoubleClick:!0}),captured:m({onDoubleClickCapture:!0})}},drag:{phasedRegistrationNames:{bubbled:m({onDrag:!0}),captured:m({onDragCapture:!0})}},dragEnd:{phasedRegistrationNames:{bubbled:m({onDragEnd:!0}),captured:m({onDragEndCapture:!0})}},dragEnter:{phasedRegistrationNames:{bubbled:m({onDragEnter:!0}),captured:m({onDragEnterCapture:!0})}},dragExit:{phasedRegistrationNames:{bubbled:m({onDragExit:!0}),captured:m({onDragExitCapture:!0})}},dragLeave:{phasedRegistrationNames:{bubbled:m({onDragLeave:!0}),captured:m({onDragLeaveCapture:!0})}},dragOver:{phasedRegistrationNames:{bubbled:m({onDragOver:!0}),captured:m({onDragOverCapture:!0})}},dragStart:{phasedRegistrationNames:{bubbled:m({onDragStart:!0}),captured:m({onDragStartCapture:!0})}},drop:{phasedRegistrationNames:{bubbled:m({onDrop:!0}),captured:m({onDropCapture:!0})}},focus:{phasedRegistrationNames:{bubbled:m({onFocus:!0}),captured:m({onFocusCapture:!0})}},input:{phasedRegistrationNames:{bubbled:m({onInput:!0}),captured:m({onInputCapture:!0})}},keyDown:{phasedRegistrationNames:{bubbled:m({onKeyDown:!0}),captured:m({onKeyDownCapture:!0})}},keyPress:{phasedRegistrationNames:{bubbled:m({onKeyPress:!0}),captured:m({onKeyPressCapture:!0})}},keyUp:{phasedRegistrationNames:{bubbled:m({onKeyUp:!0}),captured:m({onKeyUpCapture:!0})}},load:{phasedRegistrationNames:{bubbled:m({onLoad:!0}),captured:m({onLoadCapture:!0})}},error:{phasedRegistrationNames:{bubbled:m({onError:!0}),captured:m({onErrorCapture:!0})}},mouseDown:{phasedRegistrationNames:{bubbled:m({onMouseDown:!0}),captured:m({onMouseDownCapture:!0})}},mouseMove:{phasedRegistrationNames:{bubbled:m({onMouseMove:!0}),captured:m({onMouseMoveCapture:!0})}},mouseOut:{phasedRegistrationNames:{bubbled:m({onMouseOut:!0}),captured:m({onMouseOutCapture:!0})}},mouseOver:{phasedRegistrationNames:{bubbled:m({onMouseOver:!0}),captured:m({onMouseOverCapture:!0})}},mouseUp:{phasedRegistrationNames:{bubbled:m({onMouseUp:!0}),captured:m({onMouseUpCapture:!0})}},paste:{phasedRegistrationNames:{bubbled:m({onPaste:!0}),captured:m({onPasteCapture:!0})}},reset:{phasedRegistrationNames:{bubbled:m({onReset:!0}),captured:m({onResetCapture:!0})}},scroll:{phasedRegistrationNames:{bubbled:m({onScroll:!0}),captured:m({onScrollCapture:!0})}},submit:{phasedRegistrationNames:{bubbled:m({onSubmit:!0}),captured:m({onSubmitCapture:!0})}},touchCancel:{phasedRegistrationNames:{bubbled:m({onTouchCancel:!0}),captured:m({onTouchCancelCapture:!0})}},touchEnd:{phasedRegistrationNames:{bubbled:m({onTouchEnd:!0}),captured:m({onTouchEndCapture:!0})}},touchMove:{phasedRegistrationNames:{bubbled:m({onTouchMove:!0}),captured:m({onTouchMoveCapture:!0})}},touchStart:{phasedRegistrationNames:{bubbled:m({onTouchStart:!0}),captured:m({onTouchStartCapture:!0})}},wheel:{phasedRegistrationNames:{bubbled:m({onWheel:!0}),captured:m({onWheelCapture:!0})}}},C={topBlur:g.blur,topClick:g.click,topContextMenu:g.contextMenu,topCopy:g.copy,topCut:g.cut,topDoubleClick:g.doubleClick,topDrag:g.drag,topDragEnd:g.dragEnd,topDragEnter:g.dragEnter,topDragExit:g.dragExit,topDragLeave:g.dragLeave,topDragOver:g.dragOver,topDragStart:g.dragStart,topDrop:g.drop,topError:g.error,topFocus:g.focus,topInput:g.input,topKeyDown:g.keyDown,topKeyPress:g.keyPress,topKeyUp:g.keyUp,topLoad:g.load,topMouseDown:g.mouseDown,topMouseMove:g.mouseMove,topMouseOut:g.mouseOut,topMouseOver:g.mouseOver,topMouseUp:g.mouseUp,topPaste:g.paste,topReset:g.reset,topScroll:g.scroll,topSubmit:g.submit,topTouchCancel:g.touchCancel,topTouchEnd:g.touchEnd,topTouchMove:g.touchMove,topTouchStart:g.touchStart,topWheel:g.wheel};for(var y in C)C[y].dependencies=[y];var E={eventTypes:g,executeDispatch:function(e,t,n){var r=o.executeDispatch(e,t,n);r===!1&&(e.stopPropagation(),e.preventDefault())},extractEvents:function(e,t,n,o){var m=C[e];if(!m)return null;var g;switch(e){case v.topInput:case v.topLoad:case v.topError:case v.topReset:case v.topSubmit:g=a;break;case v.topKeyDown:case v.topKeyPress:case v.topKeyUp:g=u;break;case v.topBlur:case v.topFocus:g=s;break;case v.topClick:if(2===o.button)return null;case v.topContextMenu:case v.topDoubleClick:case v.topMouseDown:case v.topMouseMove:case v.topMouseOut:case v.topMouseOver:case v.topMouseUp:g=c;break;case v.topDrag:case v.topDragEnd:case v.topDragEnter:case v.topDragExit:case v.topDragLeave:case v.topDragOver:case v.topDragStart:case v.topDrop:g=l;break;case v.topTouchCancel:case v.topTouchEnd:case v.topTouchMove:case v.topTouchStart:g=p;break;case v.topScroll:g=d;break;case v.topWheel:g=f;break;case v.topCopy:case v.topCut:case v.topPaste:g=i}h(g);var y=g.getPooled(m,n,o);return r.accumulateTwoPhaseDispatches(y),y}};t.exports=E},{"./EventConstants":14,"./EventPluginUtils":18,"./EventPropagators":19,"./SyntheticClipboardEvent":73,"./SyntheticDragEvent":75,"./SyntheticEvent":76,"./SyntheticFocusEvent":77,"./SyntheticKeyboardEvent":78,"./SyntheticMouseEvent":79,"./SyntheticTouchEvent":80,"./SyntheticUIEvent":81,"./SyntheticWheelEvent":82,"./invariant":110,"./keyOf":117}],73:[function(e,t){"use strict";function n(e,t,n){o.call(this,e,t,n)}var o=e("./SyntheticEvent"),r={clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}};o.augmentClass(n,r),t.exports=n},{"./SyntheticEvent":76}],74:[function(e,t){"use strict";function n(e,t,n){o.call(this,e,t,n)}var o=e("./SyntheticEvent"),r={data:null};o.augmentClass(n,r),t.exports=n},{"./SyntheticEvent":76}],75:[function(e,t){"use strict";function n(e,t,n){o.call(this,e,t,n)}var o=e("./SyntheticMouseEvent"),r={dataTransfer:null};o.augmentClass(n,r),t.exports=n},{"./SyntheticMouseEvent":79}],76:[function(e,t){"use strict";function n(e,t,n){this.dispatchConfig=e,this.dispatchMarker=t,this.nativeEvent=n;var o=this.constructor.Interface;for(var i in o)if(o.hasOwnProperty(i)){var a=o[i];this[i]=a?a(n):n[i]}var s=null!=n.defaultPrevented?n.defaultPrevented:n.returnValue===!1;this.isDefaultPrevented=s?r.thatReturnsTrue:r.thatReturnsFalse,this.isPropagationStopped=r.thatReturnsFalse}var o=e("./PooledClass"),r=e("./emptyFunction"),i=e("./getEventTarget"),a=e("./merge"),s=e("./mergeInto"),u={type:null,target:i,currentTarget:r.thatReturnsNull,eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null};s(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e.preventDefault?e.preventDefault():e.returnValue=!1,this.isDefaultPrevented=r.thatReturnsTrue},stopPropagation:function(){var e=this.nativeEvent;e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,this.isPropagationStopped=r.thatReturnsTrue},persist:function(){this.isPersistent=r.thatReturnsTrue},isPersistent:r.thatReturnsFalse,destructor:function(){var e=this.constructor.Interface;for(var t in e)this[t]=null;this.dispatchConfig=null,this.dispatchMarker=null,this.nativeEvent=null}}),n.Interface=u,n.augmentClass=function(e,t){var n=this,r=Object.create(n.prototype);s(r,e.prototype),e.prototype=r,e.prototype.constructor=e,e.Interface=a(n.Interface,t),e.augmentClass=n.augmentClass,o.addPoolingTo(e,o.threeArgumentPooler)},o.addPoolingTo(n,o.threeArgumentPooler),t.exports=n},{"./PooledClass":23,"./emptyFunction":94,"./getEventTarget":102,"./merge":119,"./mergeInto":121}],77:[function(e,t){"use strict";function n(e,t,n){o.call(this,e,t,n)}var o=e("./SyntheticUIEvent"),r={relatedTarget:null};o.augmentClass(n,r),t.exports=n},{"./SyntheticUIEvent":81}],78:[function(e,t){"use strict";function n(e,t,n){o.call(this,e,t,n)}var o=e("./SyntheticUIEvent"),r=e("./getEventKey"),i={key:r,location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,"char":null,charCode:null,keyCode:null,which:null};o.augmentClass(n,i),t.exports=n},{"./SyntheticUIEvent":81,"./getEventKey":101}],79:[function(e,t){"use strict";function n(e,t,n){o.call(this,e,t,n)}var o=e("./SyntheticUIEvent"),r=e("./ViewportMetrics"),i={screenX:null,screenY:null,clientX:null,clientY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,button:function(e){var t=e.button;return"which"in e?t:2===t?2:4===t?1:0},buttons:null,relatedTarget:function(e){return e.relatedTarget||(e.fromElement===e.srcElement?e.toElement:e.fromElement)},pageX:function(e){return"pageX"in e?e.pageX:e.clientX+r.currentScrollLeft},pageY:function(e){return"pageY"in e?e.pageY:e.clientY+r.currentScrollTop
+}};o.augmentClass(n,i),t.exports=n},{"./SyntheticUIEvent":81,"./ViewportMetrics":84}],80:[function(e,t){"use strict";function n(e,t,n){o.call(this,e,t,n)}var o=e("./SyntheticUIEvent"),r={touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null};o.augmentClass(n,r),t.exports=n},{"./SyntheticUIEvent":81}],81:[function(e,t){"use strict";function n(e,t,n){o.call(this,e,t,n)}var o=e("./SyntheticEvent"),r={view:null,detail:null};o.augmentClass(n,r),t.exports=n},{"./SyntheticEvent":76}],82:[function(e,t){"use strict";function n(e,t,n){o.call(this,e,t,n)}var o=e("./SyntheticMouseEvent"),r={deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:null,deltaMode:null};o.augmentClass(n,r),t.exports=n},{"./SyntheticMouseEvent":79}],83:[function(e,t){"use strict";var n=e("./invariant"),o={reinitializeTransaction:function(){this.transactionWrappers=this.getTransactionWrappers(),this.wrapperInitData?this.wrapperInitData.length=0:this.wrapperInitData=[],this.timingMetrics||(this.timingMetrics={}),this.timingMetrics.methodInvocationTime=0,this.timingMetrics.wrapperInitTimes?this.timingMetrics.wrapperInitTimes.length=0:this.timingMetrics.wrapperInitTimes=[],this.timingMetrics.wrapperCloseTimes?this.timingMetrics.wrapperCloseTimes.length=0:this.timingMetrics.wrapperCloseTimes=[],this._isInTransaction=!1},_isInTransaction:!1,getTransactionWrappers:null,isInTransaction:function(){return!!this._isInTransaction},perform:function(e,t,o,r,i,a,s,u){n(!this.isInTransaction());var c,l,p=Date.now();try{this._isInTransaction=!0,c=!0,this.initializeAll(0),l=e.call(t,o,r,i,a,s,u),c=!1}finally{var d=Date.now();this.methodInvocationTime+=d-p;try{if(c)try{this.closeAll(0)}catch(f){}else this.closeAll(0)}finally{this._isInTransaction=!1}}return l},initializeAll:function(e){for(var t=this.transactionWrappers,n=this.timingMetrics.wrapperInitTimes,o=e;o<t.length;o++){var i=Date.now(),a=t[o];try{this.wrapperInitData[o]=r.OBSERVED_ERROR,this.wrapperInitData[o]=a.initialize?a.initialize.call(this):null}finally{var s=n[o],u=Date.now();if(n[o]=(s||0)+(u-i),this.wrapperInitData[o]===r.OBSERVED_ERROR)try{this.initializeAll(o+1)}catch(c){}}}},closeAll:function(e){n(this.isInTransaction());for(var t=this.transactionWrappers,o=this.timingMetrics.wrapperCloseTimes,i=e;i<t.length;i++){var a,s=t[i],u=Date.now(),c=this.wrapperInitData[i];try{a=!0,c!==r.OBSERVED_ERROR&&s.close&&s.close.call(this,c),a=!1}finally{var l=Date.now(),p=o[i];if(o[i]=(p||0)+(l-u),a)try{this.closeAll(i+1)}catch(d){}}}this.wrapperInitData.length=0}},r={Mixin:o,OBSERVED_ERROR:{}};t.exports=r},{"./invariant":110}],84:[function(e,t){"use strict";var n=e("./getUnboundedScrollPosition"),o={currentScrollLeft:0,currentScrollTop:0,refreshScrollValues:function(){var e=n(window);o.currentScrollLeft=e.x,o.currentScrollTop=e.y}};t.exports=o},{"./getUnboundedScrollPosition":107}],85:[function(e,t){"use strict";function n(e,t){if(o(null!=t),null==e)return t;var n=Array.isArray(e),r=Array.isArray(t);return n?e.concat(t):r?[e].concat(t):[e,t]}var o=e("./invariant");t.exports=n},{"./invariant":110}],86:[function(e,t){"use strict";function n(e){for(var t=1,n=0,r=0;r<e.length;r++)t=(t+e.charCodeAt(r))%o,n=(n+t)%o;return t|n<<16}var o=65521;t.exports=n},{}],87:[function(e,t){function n(e,t){return e&&t?e===t?!0:o(e)?!1:o(t)?n(e,t.parentNode):e.contains?e.contains(t):e.compareDocumentPosition?!!(16&e.compareDocumentPosition(t)):!1:!1}var o=e("./isTextNode");t.exports=n},{"./isTextNode":114}],88:[function(e,t){function n(e,t,n,o,r,i){e=e||{};for(var a,s=[t,n,o,r,i],u=0;s[u];){a=s[u++];for(var c in a)e[c]=a[c];a.hasOwnProperty&&a.hasOwnProperty("toString")&&"undefined"!=typeof a.toString&&e.toString!==a.toString&&(e.toString=a.toString)}return e}t.exports=n},{}],89:[function(e,t){function n(e){return!!e&&("object"==typeof e||"function"==typeof e)&&"length"in e&&!("setInterval"in e)&&"number"!=typeof e.nodeType&&(Array.isArray(e)||"callee"in e||"item"in e)}function o(e){return n(e)?Array.isArray(e)?e.slice():r(e):[e]}var r=e("./toArray");t.exports=o},{"./toArray":129}],90:[function(e,t){"use strict";function n(e){var t=o.createClass({displayName:"ReactFullPageComponent"+(e.componentConstructor.displayName||""),componentWillUnmount:function(){r(!1)},render:function(){return this.transferPropsTo(e(null,this.props.children))}});return t}var o=e("./ReactCompositeComponent"),r=e("./invariant");t.exports=n},{"./ReactCompositeComponent":29,"./invariant":110}],91:[function(e,t){function n(e){var t=e.match(c);return t&&t[1].toLowerCase()}function o(e,t){var o=u;s(!!u);var r=n(e),c=r&&a(r);if(c){o.innerHTML=c[1]+e+c[2];for(var l=c[0];l--;)o=o.lastChild}else o.innerHTML=e;var p=o.getElementsByTagName("script");p.length&&(s(t),i(p).forEach(t));for(var d=i(o.childNodes);o.lastChild;)o.removeChild(o.lastChild);return d}var r=e("./ExecutionEnvironment"),i=e("./createArrayFrom"),a=e("./getMarkupWrap"),s=e("./invariant"),u=r.canUseDOM?document.createElement("div"):null,c=/^\s*<(\w+)/;t.exports=o},{"./ExecutionEnvironment":20,"./createArrayFrom":89,"./getMarkupWrap":103,"./invariant":110}],92:[function(e,t){function n(e,t){var n={},o=Array.isArray(t);"undefined"==typeof t&&(t=!0);for(var r=e.length;r--;)n[e[r]]=o?t[r]:t;return n}t.exports=n},{}],93:[function(e,t){"use strict";function n(e,t){var n=null==t||"boolean"==typeof t||""===t;if(n)return"";var r=isNaN(t);return r||0===t||o.isUnitlessNumber[e]?""+t:t+"px"}var o=e("./CSSProperty");t.exports=n},{"./CSSProperty":2}],94:[function(e,t){function n(e){return function(){return e}}function o(){}var r=e("./copyProperties");r(o,{thatReturns:n,thatReturnsFalse:n(!1),thatReturnsTrue:n(!0),thatReturnsNull:n(null),thatReturnsThis:function(){return this},thatReturnsArgument:function(e){return e}}),t.exports=o},{"./copyProperties":88}],95:[function(e,t){"use strict";var n={};t.exports=n},{}],96:[function(e,t){"use strict";function n(e){return r[e]}function o(e){return(""+e).replace(i,n)}var r={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;","/":"&#x2f;"},i=/[&><"'\/]/g;t.exports=o},{}],97:[function(e,t){"use strict";function n(e,t,n){var o=e;r(!o.hasOwnProperty(n)),null!=t&&(o[n]=t)}function o(e){if(null==e)return e;var t={};return i(e,n,t),t}var r=e("./invariant"),i=e("./traverseAllChildren");t.exports=o},{"./invariant":110,"./traverseAllChildren":130}],98:[function(e,t){"use strict";function n(e){e.disabled||e.focus()}t.exports=n},{}],99:[function(e,t){"use strict";var n=function(e,t,n){Array.isArray(e)?e.forEach(t,n):e&&t.call(n,e)};t.exports=n},{}],100:[function(e,t){function n(){try{return document.activeElement||document.body}catch(e){return document.body}}t.exports=n},{}],101:[function(e,t){"use strict";function n(e){return"key"in e?o[e.key]||e.key:r[e.which||e.keyCode]||"Unidentified"}var o={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},r={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"};t.exports=n},{}],102:[function(e,t){"use strict";function n(e){var t=e.target||e.srcElement||window;return 3===t.nodeType?t.parentNode:t}t.exports=n},{}],103:[function(e,t){function n(e){return r(!!i),p.hasOwnProperty(e)||(e="*"),a.hasOwnProperty(e)||(i.innerHTML="*"===e?"<link />":"<"+e+"></"+e+">",a[e]=!i.firstChild),a[e]?p[e]:null}var o=e("./ExecutionEnvironment"),r=e("./invariant"),i=o.canUseDOM?document.createElement("div"):null,a={circle:!0,defs:!0,g:!0,line:!0,linearGradient:!0,path:!0,polygon:!0,polyline:!0,radialGradient:!0,rect:!0,stop:!0,text:!0},s=[1,'<select multiple="true">',"</select>"],u=[1,"<table>","</table>"],c=[3,"<table><tbody><tr>","</tr></tbody></table>"],l=[1,"<svg>","</svg>"],p={"*":[1,"?<div>","</div>"],area:[1,"<map>","</map>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],legend:[1,"<fieldset>","</fieldset>"],param:[1,"<object>","</object>"],tr:[2,"<table><tbody>","</tbody></table>"],optgroup:s,option:s,caption:u,colgroup:u,tbody:u,tfoot:u,thead:u,td:c,th:c,circle:l,defs:l,g:l,line:l,linearGradient:l,path:l,polygon:l,polyline:l,radialGradient:l,rect:l,stop:l,text:l};t.exports=n},{"./ExecutionEnvironment":20,"./invariant":110}],104:[function(e,t){"use strict";function n(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function o(e){for(;e;){if(e.nextSibling)return e.nextSibling;e=e.parentNode}}function r(e,t){for(var r=n(e),i=0,a=0;r;){if(3==r.nodeType){if(a=i+r.textContent.length,t>=i&&a>=t)return{node:r,offset:t-i};i=a}r=n(o(r))}}t.exports=r},{}],105:[function(e,t){"use strict";function n(e){return e?e.nodeType===o?e.documentElement:e.firstChild:null}var o=9;t.exports=n},{}],106:[function(e,t){"use strict";function n(){return!r&&o.canUseDOM&&(r="textContent"in document.createElement("div")?"textContent":"innerText"),r}var o=e("./ExecutionEnvironment"),r=null;t.exports=n},{"./ExecutionEnvironment":20}],107:[function(e,t){"use strict";function n(e){return e===window?{x:window.pageXOffset||document.documentElement.scrollLeft,y:window.pageYOffset||document.documentElement.scrollTop}:{x:e.scrollLeft,y:e.scrollTop}}t.exports=n},{}],108:[function(e,t){function n(e){return e.replace(o,"-$1").toLowerCase()}var o=/([A-Z])/g;t.exports=n},{}],109:[function(e,t){"use strict";function n(e){return e._descriptor=e,e}e("./warning");t.exports=n},{"./warning":131}],110:[function(e,t){"use strict";var n=function(e){if(!e){var t=new Error("Minified exception occured; use the non-minified dev environment for the full error message and additional helpful warnings.");throw t.framesToPop=1,t}};t.exports=n},{}],111:[function(e,t){"use strict";function n(e,t){if(!r.canUseDOM||t&&!("addEventListener"in document))return!1;var n="on"+e,i=n in document;if(!i){var a=document.createElement("div");a.setAttribute(n,"return;"),i="function"==typeof a[n]}return!i&&o&&"wheel"===e&&(i=document.implementation.hasFeature("Events.wheel","3.0")),i}var o,r=e("./ExecutionEnvironment");r.canUseDOM&&(o=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0),t.exports=n},{"./ExecutionEnvironment":20}],112:[function(e,t){function n(e){return!(!e||!("function"==typeof Node?e instanceof Node:"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName))}t.exports=n},{}],113:[function(e,t){"use strict";function n(e){return e&&("INPUT"===e.nodeName&&o[e.type]||"TEXTAREA"===e.nodeName)}var o={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};t.exports=n},{}],114:[function(e,t){function n(e){return o(e)&&3==e.nodeType}var o=e("./isNode");t.exports=n},{"./isNode":112}],115:[function(e,t){"use strict";function n(e){e||(e="");var t,n=arguments.length;if(n>1)for(var o=1;n>o;o++)t=arguments[o],t&&(e+=" "+t);return e}t.exports=n},{}],116:[function(e,t){"use strict";var n=e("./invariant"),o=function(e){var t,o={};n(e instanceof Object&&!Array.isArray(e));for(t in e)e.hasOwnProperty(t)&&(o[t]=t);return o};t.exports=o},{"./invariant":110}],117:[function(e,t){var n=function(e){var t;for(t in e)if(e.hasOwnProperty(t))return t;return null};t.exports=n},{}],118:[function(e,t){"use strict";function n(e){var t={};return function(n){return t.hasOwnProperty(n)?t[n]:t[n]=e.call(this,n)}}t.exports=n},{}],119:[function(e,t){"use strict";var n=e("./mergeInto"),o=function(e,t){var o={};return n(o,e),n(o,t),o};t.exports=o},{"./mergeInto":121}],120:[function(e,t){"use strict";var n=e("./invariant"),o=e("./keyMirror"),r=36,i=function(e){return"object"!=typeof e||null===e},a={MAX_MERGE_DEPTH:r,isTerminal:i,normalizeMergeArg:function(e){return void 0===e||null===e?{}:e},checkMergeArrayArgs:function(e,t){n(Array.isArray(e)&&Array.isArray(t))},checkMergeObjectArgs:function(e,t){a.checkMergeObjectArg(e),a.checkMergeObjectArg(t)},checkMergeObjectArg:function(e){n(!i(e)&&!Array.isArray(e))},checkMergeLevel:function(e){n(r>e)},checkArrayStrategy:function(e){n(void 0===e||e in a.ArrayStrategies)},ArrayStrategies:o({Clobber:!0,IndexByIndex:!0})};t.exports=a},{"./invariant":110,"./keyMirror":116}],121:[function(e,t){"use strict";function n(e,t){if(r(e),null!=t){r(t);for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}}var o=e("./mergeHelpers"),r=o.checkMergeObjectArg;t.exports=n},{"./mergeHelpers":120}],122:[function(e,t){"use strict";var n=function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e.prototype[n]=t[n])};t.exports=n},{}],123:[function(e,t){"use strict";function n(e){o(e&&!/[^a-z0-9_]/.test(e))}var o=e("./invariant");t.exports=n},{"./invariant":110}],124:[function(e,t){"use strict";function n(e,t,n){if(!e)return null;var o=0,r={};for(var i in e)e.hasOwnProperty(i)&&(r[i]=t.call(n,e[i],i,o++));return r}t.exports=n},{}],125:[function(e,t){"use strict";function n(e,t,n){if(!e)return null;var o=0,r={};for(var i in e)e.hasOwnProperty(i)&&(r[i]=t.call(n,i,e[i],o++));return r}t.exports=n},{}],126:[function(e,t){"use strict";function n(e){return r(o.isValidComponent(e)),e}var o=e("./ReactComponent"),r=e("./invariant");t.exports=n},{"./ReactComponent":27,"./invariant":110}],127:[function(e,t){"use strict";function n(e,t){if(e===t)return!0;var n;for(n in e)if(e.hasOwnProperty(n)&&(!t.hasOwnProperty(n)||e[n]!==t[n]))return!1;for(n in t)if(t.hasOwnProperty(n)&&!e.hasOwnProperty(n))return!1;return!0}t.exports=n},{}],128:[function(e,t){"use strict";function n(e,t){return e&&t&&e.constructor===t.constructor&&(e.props&&e.props.key)===(t.props&&t.props.key)&&e._owner===t._owner?!0:!1}t.exports=n},{}],129:[function(e,t){function n(e){var t=e.length;if(o(!Array.isArray(e)&&("object"==typeof e||"function"==typeof e)),o("number"==typeof t),o(0===t||t-1 in e),e.hasOwnProperty)try{return Array.prototype.slice.call(e)}catch(n){}for(var r=Array(t),i=0;t>i;i++)r[i]=e[i];return r}var o=e("./invariant");t.exports=n},{"./invariant":110}],130:[function(e,t){"use strict";function n(e){return d[e]}function o(e,t){return e&&e.props&&null!=e.props.key?i(e.props.key):t.toString(36)}function r(e){return(""+e).replace(f,n)}function i(e){return"$"+r(e)}function a(e,t,n){null!==e&&void 0!==e&&h(e,"",0,t,n)}var s=e("./ReactInstanceHandles"),u=e("./ReactTextComponent"),c=e("./invariant"),l=s.SEPARATOR,p=":",d={"=":"=0",".":"=1",":":"=2"},f=/[=.:]/g,h=function(e,t,n,r,a){var s=0;if(Array.isArray(e))for(var d=0;d<e.length;d++){var f=e[d],m=t+(t?p:l)+o(f,d),v=n+s;s+=h(f,m,v,r,a)}else{var g=typeof e,C=""===t,y=C?l+o(e,0):t;if(null==e||"boolean"===g)r(a,null,y,n),s=1;else if(e.type&&e.type.prototype&&e.type.prototype.mountComponentIntoNode)r(a,e,y,n),s=1;else if("object"===g){c(!e||1!==e.nodeType);for(var E in e)e.hasOwnProperty(E)&&(s+=h(e[E],t+(t?p:l)+i(E)+p+o(e[E],0),n+s,r,a))}else if("string"===g){var R=new u(e);r(a,R,y,n),s+=1}else if("number"===g){var M=new u(""+e);r(a,M,y,n),s+=1}}return s};t.exports=a},{"./ReactInstanceHandles":51,"./ReactTextComponent":68,"./invariant":110}],131:[function(e,t){"use strict";var n=e("./emptyFunction"),o=n;t.exports=o},{"./emptyFunction":94}]},{},[24])(24)});
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/lib/API/Link.php elefant-elefant_1_3_10_beta/apps/user/lib/API/Link.php
--- elefant-elefant_1_3_9_beta/apps/user/lib/API/Link.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/lib/API/Link.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,47 @@
+<?php
+
+namespace user\API;
+
+use Restful;
+
+class Link extends Restful {
+	public function get__default ($id) {
+		return \user\Link::for_user ($id);
+	}
+
+	public function post_add () {
+		if (! isset ($_POST['user'])) return $this->error ('Missing parameter: user');
+		if (! isset ($_POST['service'])) return $this->error ('Missing parameter: service');
+		if (! isset ($_POST['handle'])) return $this->error ('Missing parameter: handle');
+		
+		$link = new \user\Link (array (
+			'user_id' => $_POST['user'],
+			'service' => $_POST['service'],
+			'handle' => $_POST['handle']
+		));
+		if (! $link->put ()) {
+			error_log ($link->error);
+			return $this->error ('An unexpected error occurred.');
+		}
+		return $this->get__default ($_POST['user']);
+		//return $link->orig ();
+	}
+	
+	public function post_delete () {
+		if (! isset ($_POST['id'])) return $this->error ('Missing parameter: id');
+		if (! isset ($_POST['user'])) return $this->error ('Missing parameter: user');
+		
+		$link = new \user\Link ($_POST['id']);
+		if ($link->error) {
+			error_log ($link->error);
+			return $this->error ('An unexpected error occurred.');
+		}
+		
+		if (! $link->remove ()) {
+			error_log ($link->error);
+			return $this->error ('An unexpected error occurred.');
+		}
+		return $this->get__default ($_POST['user']);
+		//return true;
+	}
+}
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/lib/API/Note.php elefant-elefant_1_3_10_beta/apps/user/lib/API/Note.php
--- elefant-elefant_1_3_9_beta/apps/user/lib/API/Note.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/lib/API/Note.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,48 @@
+<?php
+
+namespace user\API;
+
+use User;
+use Restful;
+
+class Note extends Restful {
+	public function get__default ($id) {
+		return \user\Note::for_user ($id);
+	}
+
+	public function post_add () {
+		if (! isset ($_POST['user'])) return $this->error ('Missing parameter: user');
+		if (! isset ($_POST['note'])) return $this->error ('Missing parameter: note');
+		
+		$note = new \user\Note (array (
+			'user_id' => $_POST['user'],
+			'ts' => gmdate ('Y-m-d H:i:s'),
+			'made_by' => User::val ('id'),
+			'note' => $_POST['note']
+		));
+		if (! $note->put ()) {
+			error_log ($note->error);
+			return $this->error ('An unexpected error occurred.');
+		}
+		return $this->get__default ($_POST['user']);
+		//return $note->orig ();
+	}
+	
+	public function post_delete () {
+		if (! isset ($_POST['id'])) return $this->error ('Missing parameter: id');
+		if (! isset ($_POST['user'])) return $this->error ('Missing parameter: user');
+		
+		$note = new \user\Note ($_POST['id']);
+		if ($note->error) {
+			error_log ($note->error);
+			return $this->error ('An unexpected error occurred.');
+		}
+		
+		if (! $note->remove ()) {
+			error_log ($note->error);
+			return $this->error ('An unexpected error occurred.');
+		}
+		return $this->get__default ($_POST['user']);
+		//return true;
+	}
+}
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/lib/Auth/Basic.php elefant-elefant_1_3_10_beta/apps/user/lib/Auth/Basic.php
--- elefant-elefant_1_3_9_beta/apps/user/lib/Auth/Basic.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/lib/Auth/Basic.php	2014-12-03 23:59:25.000000000 -0600
@@ -51,5 +51,3 @@
 		);
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/lib/Auth/HMAC.php elefant-elefant_1_3_10_beta/apps/user/lib/Auth/HMAC.php
--- elefant-elefant_1_3_9_beta/apps/user/lib/Auth/HMAC.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/lib/Auth/HMAC.php	2014-12-03 23:59:25.000000000 -0600
@@ -151,5 +151,3 @@
 		return TRUE;
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/lib/Data.php elefant-elefant_1_3_10_beta/apps/user/lib/Data.php
--- elefant-elefant_1_3_9_beta/apps/user/lib/Data.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/lib/Data.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,391 @@
+<?php
+
+namespace user;
+
+/**
+ * Data to populate user forms, mainly countries and states/provinces.
+ * Also provides an easy way to look up a country or province via:
+ *
+ *     $country_name = user\Data::country ($province_code);
+ *     $state_name = user\Data::state ($state_code);
+ */
+class Data {
+	/**
+	 * List of states/provinces in the US and Canada.
+	 */
+	public static $states = array (
+		'AB' => 'Alberta',
+		'BC' => 'British Columbia / Colombie Britanique',
+		'MB' => 'Manitoba',
+		'NB' => 'New Brunswick / Nouveau-Brunswick',
+		'NL' => 'Newfoundland & Labrador',
+		'NS' => 'Nova Scotia',
+		'NT' => 'Northwest Territories',
+		'NU' => 'Nunavut',
+		'ON' => 'Ontario',
+		'PE' => 'Prince Edward Island',
+		'QC' => 'Quebec',
+		'SK' => 'Saskatchewan',
+		'YT' => 'Yukon',
+		'AK' => 'Alaska',
+		'AL' => 'Alabama',
+		'AR' => 'Arkansas',
+		'AS' => 'American Samoa',
+		'AZ' => 'Arizona',
+		'CA' => 'California',
+		'CO' => 'Colorado',
+		'CT' => 'Connecticut',
+		'DC' => 'District Of Columbia',
+		'DE' => 'Delaware',
+		'FL' => 'Florida',
+		'FM' => 'Federated States of Micronesia',
+		'GA' => 'Georgia',
+		'GU' => 'Guam',
+		'HI' => 'Hawaii',
+		'IA' => 'Iowa',
+		'ID' => 'Idaho',
+		'IL' => 'Illinois',
+		'IN' => 'Indiana',
+		'KS' => 'Kansas',
+		'KY' => 'Kentucky',
+		'LA' => 'Louisiana',
+		'MA' => 'Massachusetts',
+		'MD' => 'Maryland',
+		'ME' => 'Maine',
+		'MH' => 'Marshall Islands',
+		'MI' => 'Michigan',
+		'MN' => 'Minnesota',
+		'MO' => 'Missouri',
+		'MP' => 'Northern Mariana Islands',
+		'MS' => 'Mississippi',
+		'MT' => 'Montana',
+		'NC' => 'North Carolina',
+		'ND' => 'North Dakota',
+		'NE' => 'Nebraska',
+		'NH' => 'New Hampshire',
+		'NJ' => 'New Jersey',
+		'NM' => 'New Mexico',
+		'NV' => 'Nevada',
+		'NY' => 'New York',
+		'OH' => 'Ohio',
+		'OK' => 'Oklahoma',
+		'OR' => 'Oregon',
+		'PA' => 'Pennsylvania',
+		'PR' => 'Puerto Rico',
+		'PW' => 'Palau',
+		'RI' => 'Rhode Island',
+		'SC' => 'South Carolina',
+		'SD' => 'South Dakota',
+		'TN' => 'Tennessee',
+		'TX' => 'Texas',
+		'UM' => 'Minor Outlying Islands',
+		'UT' => 'Utah',
+		'VA' => 'Virginia',
+		'VI' => 'Virgin Islands',
+		'VT' => 'Vermont',
+		'WA' => 'Washington',
+		'WI' => 'Wisconsin',
+		'WV' => 'West Virginia',
+		'WY' => 'Wyoming'
+	);
+	
+	/**
+	 * List of countries.
+	 *
+	 * Source: https://github.com/umpirsky/country-list
+	 */
+	public static $countries = array (
+		'AF' => 'Afghanistan',
+		'AL' => 'Albania',
+		'DZ' => 'Algeria',
+		'AS' => 'American Samoa',
+		'AD' => 'Andorra',
+		'AO' => 'Angola',
+		'AI' => 'Anguilla',
+		'AQ' => 'Antarctica',
+		'AG' => 'Antigua and Barbuda',
+		'AR' => 'Argentina',
+		'AM' => 'Armenia',
+		'AW' => 'Aruba',
+		'AU' => 'Australia',
+		'AT' => 'Austria',
+		'AZ' => 'Azerbaijan',
+		'BS' => 'Bahamas',
+		'BH' => 'Bahrain',
+		'BD' => 'Bangladesh',
+		'BB' => 'Barbados',
+		'BY' => 'Belarus',
+		'BE' => 'Belgium',
+		'BZ' => 'Belize',
+		'BJ' => 'Benin',
+		'BM' => 'Bermuda',
+		'BT' => 'Bhutan',
+		'BO' => 'Bolivia',
+		'BA' => 'Bosnia and Herzegovina',
+		'BW' => 'Botswana',
+		'BV' => 'Bouvet Island',
+		'BR' => 'Brazil',
+		'BQ' => 'British Antarctic Territory',
+		'IO' => 'British Indian Ocean Territory',
+		'VG' => 'British Virgin Islands',
+		'BN' => 'Brunei',
+		'BG' => 'Bulgaria',
+		'BF' => 'Burkina Faso',
+		'BI' => 'Burundi',
+		'KH' => 'Cambodia',
+		'CM' => 'Cameroon',
+		'CA' => 'Canada',
+		'CT' => 'Canton and Enderbury Islands',
+		'CV' => 'Cape Verde',
+		'KY' => 'Cayman Islands',
+		'CF' => 'Central African Republic',
+		'TD' => 'Chad',
+		'CL' => 'Chile',
+		'CN' => 'China',
+		'CX' => 'Christmas Island',
+		'CC' => 'Cocos [Keeling] Islands',
+		'CO' => 'Colombia',
+		'KM' => 'Comoros',
+		'CG' => 'Congo - Brazzaville',
+		'CD' => 'Congo - Kinshasa',
+		'CK' => 'Cook Islands',
+		'CR' => 'Costa Rica',
+		'HR' => 'Croatia',
+		'CU' => 'Cuba',
+		'CY' => 'Cyprus',
+		'CZ' => 'Czech Republic',
+		'CI' => 'Côte d’Ivoire',
+		'DK' => 'Denmark',
+		'DJ' => 'Djibouti',
+		'DM' => 'Dominica',
+		'DO' => 'Dominican Republic',
+		'NQ' => 'Dronning Maud Land',
+		'DD' => 'East Germany',
+		'EC' => 'Ecuador',
+		'EG' => 'Egypt',
+		'SV' => 'El Salvador',
+		'GQ' => 'Equatorial Guinea',
+		'ER' => 'Eritrea',
+		'EE' => 'Estonia',
+		'ET' => 'Ethiopia',
+		'FK' => 'Falkland Islands',
+		'FO' => 'Faroe Islands',
+		'FJ' => 'Fiji',
+		'FI' => 'Finland',
+		'FR' => 'France',
+		'GF' => 'French Guiana',
+		'PF' => 'French Polynesia',
+		'TF' => 'French Southern Territories',
+		'FQ' => 'French Southern and Antarctic Territories',
+		'GA' => 'Gabon',
+		'GM' => 'Gambia',
+		'GE' => 'Georgia',
+		'DE' => 'Germany',
+		'GH' => 'Ghana',
+		'GI' => 'Gibraltar',
+		'GR' => 'Greece',
+		'GL' => 'Greenland',
+		'GD' => 'Grenada',
+		'GP' => 'Guadeloupe',
+		'GU' => 'Guam',
+		'GT' => 'Guatemala',
+		'GG' => 'Guernsey',
+		'GN' => 'Guinea',
+		'GW' => 'Guinea-Bissau',
+		'GY' => 'Guyana',
+		'HT' => 'Haiti',
+		'HM' => 'Heard Island and McDonald Islands',
+		'HN' => 'Honduras',
+		'HK' => 'Hong Kong SAR China',
+		'HU' => 'Hungary',
+		'IS' => 'Iceland',
+		'IN' => 'India',
+		'ID' => 'Indonesia',
+		'IR' => 'Iran',
+		'IQ' => 'Iraq',
+		'IE' => 'Ireland',
+		'IM' => 'Isle of Man',
+		'IL' => 'Israel',
+		'IT' => 'Italy',
+		'JM' => 'Jamaica',
+		'JP' => 'Japan',
+		'JE' => 'Jersey',
+		'JT' => 'Johnston Island',
+		'JO' => 'Jordan',
+		'KZ' => 'Kazakhstan',
+		'KE' => 'Kenya',
+		'KI' => 'Kiribati',
+		'KW' => 'Kuwait',
+		'KG' => 'Kyrgyzstan',
+		'LA' => 'Laos',
+		'LV' => 'Latvia',
+		'LB' => 'Lebanon',
+		'LS' => 'Lesotho',
+		'LR' => 'Liberia',
+		'LY' => 'Libya',
+		'LI' => 'Liechtenstein',
+		'LT' => 'Lithuania',
+		'LU' => 'Luxembourg',
+		'MO' => 'Macau SAR China',
+		'MK' => 'Macedonia',
+		'MG' => 'Madagascar',
+		'MW' => 'Malawi',
+		'MY' => 'Malaysia',
+		'MV' => 'Maldives',
+		'ML' => 'Mali',
+		'MT' => 'Malta',
+		'MH' => 'Marshall Islands',
+		'MQ' => 'Martinique',
+		'MR' => 'Mauritania',
+		'MU' => 'Mauritius',
+		'YT' => 'Mayotte',
+		'FX' => 'Metropolitan France',
+		'MX' => 'Mexico',
+		'FM' => 'Micronesia',
+		'MI' => 'Midway Islands',
+		'MD' => 'Moldova',
+		'MC' => 'Monaco',
+		'MN' => 'Mongolia',
+		'ME' => 'Montenegro',
+		'MS' => 'Montserrat',
+		'MA' => 'Morocco',
+		'MZ' => 'Mozambique',
+		'MM' => 'Myanmar [Burma]',
+		'NA' => 'Namibia',
+		'NR' => 'Nauru',
+		'NP' => 'Nepal',
+		'NL' => 'Netherlands',
+		'AN' => 'Netherlands Antilles',
+		'NT' => 'Neutral Zone',
+		'NC' => 'New Caledonia',
+		'NZ' => 'New Zealand',
+		'NI' => 'Nicaragua',
+		'NE' => 'Niger',
+		'NG' => 'Nigeria',
+		'NU' => 'Niue',
+		'NF' => 'Norfolk Island',
+		'KP' => 'North Korea',
+		'VD' => 'North Vietnam',
+		'MP' => 'Northern Mariana Islands',
+		'NO' => 'Norway',
+		'OM' => 'Oman',
+		'PC' => 'Pacific Islands Trust Territory',
+		'PK' => 'Pakistan',
+		'PW' => 'Palau',
+		'PS' => 'Palestinian Territories',
+		'PA' => 'Panama',
+		'PZ' => 'Panama Canal Zone',
+		'PG' => 'Papua New Guinea',
+		'PY' => 'Paraguay',
+		'YD' => 'People\'s Democratic Republic of Yemen',
+		'PE' => 'Peru',
+		'PH' => 'Philippines',
+		'PN' => 'Pitcairn Islands',
+		'PL' => 'Poland',
+		'PT' => 'Portugal',
+		'PR' => 'Puerto Rico',
+		'QA' => 'Qatar',
+		'RO' => 'Romania',
+		'RU' => 'Russia',
+		'RW' => 'Rwanda',
+		'RE' => 'Réunion',
+		'BL' => 'Saint Barthélemy',
+		'SH' => 'Saint Helena',
+		'KN' => 'Saint Kitts and Nevis',
+		'LC' => 'Saint Lucia',
+		'MF' => 'Saint Martin',
+		'PM' => 'Saint Pierre and Miquelon',
+		'VC' => 'Saint Vincent and the Grenadines',
+		'WS' => 'Samoa',
+		'SM' => 'San Marino',
+		'SA' => 'Saudi Arabia',
+		'SN' => 'Senegal',
+		'RS' => 'Serbia',
+		'CS' => 'Serbia and Montenegro',
+		'SC' => 'Seychelles',
+		'SL' => 'Sierra Leone',
+		'SG' => 'Singapore',
+		'SK' => 'Slovakia',
+		'SI' => 'Slovenia',
+		'SB' => 'Solomon Islands',
+		'SO' => 'Somalia',
+		'ZA' => 'South Africa',
+		'GS' => 'South Georgia and the South Sandwich Islands',
+		'KR' => 'South Korea',
+		'ES' => 'Spain',
+		'LK' => 'Sri Lanka',
+		'SD' => 'Sudan',
+		'SR' => 'Suriname',
+		'SJ' => 'Svalbard and Jan Mayen',
+		'SZ' => 'Swaziland',
+		'SE' => 'Sweden',
+		'CH' => 'Switzerland',
+		'SY' => 'Syria',
+		'ST' => 'São Tomé and Príncipe',
+		'TW' => 'Taiwan',
+		'TJ' => 'Tajikistan',
+		'TZ' => 'Tanzania',
+		'TH' => 'Thailand',
+		'TL' => 'Timor-Leste',
+		'TG' => 'Togo',
+		'TK' => 'Tokelau',
+		'TO' => 'Tonga',
+		'TT' => 'Trinidad and Tobago',
+		'TN' => 'Tunisia',
+		'TR' => 'Turkey',
+		'TM' => 'Turkmenistan',
+		'TC' => 'Turks and Caicos Islands',
+		'TV' => 'Tuvalu',
+		'UM' => 'U.S. Minor Outlying Islands',
+		'PU' => 'U.S. Miscellaneous Pacific Islands',
+		'VI' => 'U.S. Virgin Islands',
+		'UG' => 'Uganda',
+		'UA' => 'Ukraine',
+		'SU' => 'Union of Soviet Socialist Republics',
+		'AE' => 'United Arab Emirates',
+		'GB' => 'United Kingdom',
+		'US' => 'United States',
+		'ZZ' => 'Unknown or Invalid Region',
+		'UY' => 'Uruguay',
+		'UZ' => 'Uzbekistan',
+		'VU' => 'Vanuatu',
+		'VA' => 'Vatican City',
+		'VE' => 'Venezuela',
+		'VN' => 'Vietnam',
+		'WK' => 'Wake Island',
+		'WF' => 'Wallis and Futuna',
+		'EH' => 'Western Sahara',
+		'YE' => 'Yemen',
+		'ZM' => 'Zambia',
+		'ZW' => 'Zimbabwe',
+		'AX' => 'Åland Islands'
+	);
+
+	/**
+	 * List of states and provinces for the user forms.
+	 */
+	public static function states () {
+		return self::$states;
+	}
+
+	/**
+	 * Fetch a state/province name from its code.
+	 */
+	public static function state ($code) {
+		return self::$states[$code];
+	}
+	
+	/**
+	 * List of countries for the user forms.
+	 */
+	public static function countries () {
+		return self::$countries;
+	}
+
+	/**
+	 * Fetch a state/province name from its code.
+	 */
+	public static function country ($code) {
+		return self::$countries[$code];
+	}
+}
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/lib/Filter.php elefant-elefant_1_3_10_beta/apps/user/lib/Filter.php
--- elefant-elefant_1_3_9_beta/apps/user/lib/Filter.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/lib/Filter.php	2014-12-03 23:59:25.000000000 -0600
@@ -10,5 +10,3 @@
 		return str_replace ('/', '-', $resource);
 	}
 }
-
-?>
\ No newline at end of file
Files elefant-elefant_1_3_9_beta/apps/user/lib/LightOpenID.php and elefant-elefant_1_3_10_beta/apps/user/lib/LightOpenID.php are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/lib/Rules.php elefant-elefant_1_3_10_beta/apps/user/lib/Rules.php
--- elefant-elefant_1_3_9_beta/apps/user/lib/Rules.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/lib/Rules.php	2014-12-03 23:59:25.000000000 -0600
@@ -13,5 +13,3 @@
 		return true;
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/lib/tmhOAuth.php elefant-elefant_1_3_10_beta/apps/user/lib/tmhOAuth.php
--- elefant-elefant_1_3_9_beta/apps/user/lib/tmhOAuth.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/lib/tmhOAuth.php	2014-12-03 23:59:25.000000000 -0600
@@ -601,5 +601,3 @@
     return $code;
   }
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/lib/tmhUtilities.php elefant-elefant_1_3_10_beta/apps/user/lib/tmhUtilities.php
--- elefant-elefant_1_3_9_beta/apps/user/lib/tmhUtilities.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/lib/tmhUtilities.php	2014-12-03 23:59:25.000000000 -0600
@@ -241,5 +241,3 @@
     return substr_compare($haystack, $needle, -$needlelen) === 0;
   }
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/lib/vCard.php elefant-elefant_1_3_10_beta/apps/user/lib/vCard.php
--- elefant-elefant_1_3_9_beta/apps/user/lib/vCard.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/lib/vCard.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,688 @@
+<?php
+/**
+ * vCard class for parsing a vCard and/or creating one
+ *
+ * @link https://github.com/nuovo/vCard-parser
+ * @author Martins Pilsetnieks, Roberts Bruveris
+ * @see RFC 2426, RFC 2425
+ * @version 0.4.8
+*/
+	class vCard implements Countable, Iterator
+	{
+		const MODE_ERROR = 'error';
+		const MODE_SINGLE = 'single';
+		const MODE_MULTIPLE = 'multiple';
+
+		const endl = "\n";
+
+		/**
+		 * @var string Current object mode - error, single or multiple (for a single vCard within a file and multiple combined vCards)
+		 */
+		private $Mode;  //single, multiple, error
+
+		private $Path = '';
+		private $RawData = '';
+
+		/**
+		 * @var array Internal options container. Options:
+		 *	bool Collapse: If true, elements that can have multiple values but have only a single value are returned as that value instead of an array
+		 *		If false, an array is returned even if it has only one value.
+		 */
+		private $Options = array(
+			'Collapse' => false
+		);
+
+		/**
+		 * @var array Internal data container. Contains vCard objects for multiple vCards and just the data for single vCards.
+		 */
+		private $Data = array();
+
+		/**
+		 * @static Parts of structured elements according to the spec.
+		 */
+		private static $Spec_StructuredElements = array(
+			'n' => array('LastName', 'FirstName', 'AdditionalNames', 'Prefixes', 'Suffixes'),
+			'adr' => array('POBox', 'ExtendedAddress', 'StreetAddress', 'Locality', 'Region', 'PostalCode', 'Country'),
+			'geo' => array('Latitude', 'Longitude'),
+			'org' => array('Name', 'Unit1', 'Unit2')
+		);
+		private static $Spec_MultipleValueElements = array('nickname', 'categories');
+
+		private static $Spec_ElementTypes = array(
+			'email' => array('internet', 'x400', 'pref'),
+			'adr' => array('dom', 'intl', 'postal', 'parcel', 'home', 'work', 'pref'),
+			'label' => array('dom', 'intl', 'postal', 'parcel', 'home', 'work', 'pref'),
+			'tel' => array('home', 'msg', 'work', 'pref', 'voice', 'fax', 'cell', 'video', 'pager', 'bbs', 'modem', 'car', 'isdn', 'pcs'),
+			'impp' => array('personal', 'business', 'home', 'work', 'mobile', 'pref')
+		);
+
+		private static $Spec_FileElements = array('photo', 'logo', 'sound');
+
+		/**
+		 * vCard constructor
+		 *
+		 * @param string Path to file, optional.
+		 * @param string Raw data, optional.
+		 * @param array Additional options, optional. Currently supported options:
+		 *	bool Collapse: If true, elements that can have multiple values but have only a single value are returned as that value instead of an array
+		 *		If false, an array is returned even if it has only one value.
+		 *
+		 * One of these parameters must be provided, otherwise an exception is thrown.
+		 */
+		public function __construct($Path = false, $RawData = false, array $Options = null)
+		{
+			// Checking preconditions for the parser.
+			// If path is given, the file should be accessible.
+			// If raw data is given, it is taken as it is.
+			// In both cases the real content is put in $this -> RawData
+			if ($Path)
+			{
+				if (!is_readable($Path))
+				{
+					throw new Exception('vCard: Path not accessible ('.$Path.')');
+				}
+
+				$this -> Path = $Path;
+				$this -> RawData = file_get_contents($this -> Path);
+			}
+			elseif ($RawData)
+			{
+				$this -> RawData = $RawData;
+			}
+			else
+			{
+				//throw new Exception('vCard: No content provided');
+				// Not necessary anymore as possibility to create vCards is added
+			}
+
+			if (!$this -> Path && !$this -> RawData)
+			{
+				return true;
+			}
+
+			if ($Options)
+			{
+				$this -> Options = array_merge($this -> Options, $Options);
+			}
+
+			// Counting the begin/end separators. If there aren't any or the count doesn't match, there is a problem with the file.
+			// If there is only one, this is a single vCard, if more, multiple vCards are combined.
+			$Matches = array();
+			$vCardBeginCount = preg_match_all('{^BEGIN\:VCARD}miS', $this -> RawData, $Matches);
+			$vCardEndCount = preg_match_all('{^END\:VCARD}miS', $this -> RawData, $Matches);
+
+			if (($vCardBeginCount != $vCardEndCount) || !$vCardBeginCount)
+			{
+				$this -> Mode = vCard::MODE_ERROR;
+				throw new Exception('vCard: invalid vCard');
+			}
+
+			$this -> Mode = $vCardBeginCount == 1 ? vCard::MODE_SINGLE : vCard::MODE_MULTIPLE;
+
+			// Removing/changing inappropriate newlines, i.e., all CRs or multiple newlines are changed to a single newline
+			$this -> RawData = str_replace("\r", "\n", $this -> RawData);
+			$this -> RawData = preg_replace('{(\n+)}', "\n", $this -> RawData);
+
+			// In multiple card mode the raw text is split at card beginning markers and each
+			//	fragment is parsed in a separate vCard object.
+			if ($this -> Mode == self::MODE_MULTIPLE)
+			{
+				$this -> RawData = explode('BEGIN:VCARD', $this -> RawData);
+				$this -> RawData = array_filter($this -> RawData);
+
+				foreach ($this -> RawData as $SinglevCardRawData)
+				{
+					// Prepending "BEGIN:VCARD" to the raw string because we exploded on that one.
+					// If there won't be the BEGIN marker in the new object, it will fail.
+					$SinglevCardRawData = 'BEGIN:VCARD'."\n".$SinglevCardRawData;
+
+					$ClassName = get_class($this);
+					$this -> Data[] = new $ClassName(false, $SinglevCardRawData);
+				}
+			}
+			else
+			{
+				// Protect the BASE64 final = sign (detected by the line beginning with whitespace), otherwise the next replace will get rid of it
+				$this -> RawData = preg_replace('{(\n\s.+)=(\n)}', '$1-base64=-$2', $this -> RawData);
+
+				// Joining multiple lines that are split with a hard wrap and indicated by an equals sign at the end of line
+				// (quoted-printable-encoded values in v2.1 vCards)
+				$this -> RawData = str_replace("=\n", '', $this -> RawData);
+
+				// Joining multiple lines that are split with a soft wrap (space or tab on the beginning of the next line
+				$this -> RawData = str_replace(array("\n ", "\n\t"), '-wrap-', $this -> RawData);
+
+				// Restoring the BASE64 final equals sign (see a few lines above)
+				$this -> RawData = str_replace("-base64=-\n", "=\n", $this -> RawData);
+
+				$Lines = explode("\n", $this -> RawData);
+
+				foreach ($Lines as $Line)
+				{
+					// Lines without colons are skipped because, most likely, they contain no data.
+					if (strpos($Line, ':') === false)
+					{
+						continue;
+					}
+
+					// Each line is split into two parts. The key contains the element name and additional parameters, if present,
+					//	value is just the value
+					list($Key, $Value) = explode(':', $Line, 2);
+
+					// Key is transformed to lowercase because, even though the element and parameter names are written in uppercase,
+					//	it is quite possible that they will be in lower- or mixed case.
+					// The key is trimmed to allow for non-significant WSP characters as allowed by v2.1
+					$Key = strtolower(trim(self::Unescape($Key)));
+
+					// These two lines can be skipped as they aren't necessary at all.
+					if ($Key == 'begin' || $Key == 'end')
+					{
+						continue;
+					}
+
+					if ((strpos($Key, 'agent') === 0) && (stripos($Value, 'begin:vcard') !== false))
+					{
+						$ClassName = get_class($this);
+						$Value = new $ClassName(false, str_replace('-wrap-', "\n", $Value));
+						if (!isset($this -> Data[$Key]))
+						{
+							$this -> Data[$Key] = array();
+						}
+						$this -> Data[$Key][] = $Value;
+						continue;
+					}
+					else
+					{
+						$Value = str_replace('-wrap-', '', $Value);
+					}
+
+					$Value = trim(self::Unescape($Value));
+					$Type = array();
+
+					// Here additional parameters are parsed
+					$KeyParts = explode(';', $Key);
+					$Key = $KeyParts[0];
+					$Encoding = false;
+
+					if (strpos($Key, 'item') === 0)
+					{
+						$TmpKey = explode('.', $Key, 2);
+						$Key = $TmpKey[1];
+						$ItemIndex = (int)str_ireplace('item', '', $TmpKey[0]);
+					}
+
+					if (count($KeyParts) > 1)
+					{
+						$Parameters = self::ParseParameters($Key, array_slice($KeyParts, 1));
+
+						foreach ($Parameters as $ParamKey => $ParamValue)
+						{
+							switch ($ParamKey)
+							{
+								case 'encoding':
+									$Encoding = $ParamValue;
+									if (in_array($ParamValue, array('b', 'base64')))
+									{
+										//$Value = base64_decode($Value);
+									}
+									elseif ($ParamValue == 'quoted-printable') // v2.1
+									{
+										$Value = quoted_printable_decode($Value);
+									}
+									break;
+								case 'charset': // v2.1
+									if ($ParamValue != 'utf-8' && $ParamValue != 'utf8')
+									{
+										$Value = mb_convert_encoding($Value, 'UTF-8', $ParamValue);
+									}
+									break;
+								case 'type':
+									$Type = $ParamValue;
+									break;
+							}
+						}
+					}
+
+					// Checking files for colon-separated additional parameters (Apple's Address Book does this), for example, "X-ABCROP-RECTANGLE" for photos
+					if (in_array($Key, self::$Spec_FileElements) && isset($Parameters['encoding']) && in_array($Parameters['encoding'], array('b', 'base64')))
+					{
+						// If colon is present in the value, it must contain Address Book parameters
+						//	(colon is an invalid character for base64 so it shouldn't appear in valid files)
+						if (strpos($Value, ':') !== false)
+						{
+							$Value = explode(':', $Value);
+							$Value = array_pop($Value);
+						}
+					}
+
+					// Values are parsed according to their type
+					if (isset(self::$Spec_StructuredElements[$Key]))
+					{
+						$Value = self::ParseStructuredValue($Value, $Key);
+						if ($Type)
+						{
+							$Value['Type'] = $Type;
+						}
+					}
+					else
+					{
+						if (in_array($Key, self::$Spec_MultipleValueElements))
+						{
+							$Value = self::ParseMultipleTextValue($Value, $Key);
+						}
+
+						if ($Type)
+						{
+							$Value = array(
+								'Value' => $Value,
+								'Type' => $Type
+							);
+						}
+					}
+
+					if (is_array($Value) && $Encoding)
+					{
+						$Value['Encoding'] = $Encoding;
+					}
+
+					if (!isset($this -> Data[$Key]))
+					{
+						$this -> Data[$Key] = array();
+					}
+
+					$this -> Data[$Key][] = $Value;
+				}
+			}
+		}
+
+		/**
+		 * Magic method to get the various vCard values as object members, e.g.
+		 *	a call to $vCard -> N gets the "N" value
+		 *
+		 * @param string Key
+		 *
+		 * @return mixed Value
+		 */
+		public function __get($Key)
+		{
+			$Key = strtolower($Key);
+			if (isset($this -> Data[$Key]))
+			{
+				if ($Key == 'agent')
+				{
+					return $this -> Data[$Key];
+				}
+				elseif (in_array($Key, self::$Spec_FileElements))
+				{
+					$Value = $this -> Data[$Key];
+					foreach ($Value as $K => $V)
+					{
+						if (stripos($V['Value'], 'uri:') === 0)
+						{
+							$Value[$K]['Value'] = substr($V, 4);
+							$Value[$K]['Encoding'] = 'uri';
+						}
+					}
+					return $Value;
+				}
+
+				if ($this -> Options['Collapse'] && is_array($this -> Data[$Key]) && (count($this -> Data[$Key]) == 1))
+				{
+					return $this -> Data[$Key][0];
+				}
+				return $this -> Data[$Key];
+			}
+			elseif ($Key == 'Mode')
+			{
+				return $this -> Mode;
+			}
+			return array();
+		}
+
+		/**
+		 * Saves an embedded file
+		 *
+		 * @param string Key
+		 * @param int Index of the file, defaults to 0
+		 * @param string Target path where the file should be saved, including the filename
+		 *
+		 * @return bool Operation status
+		 */
+		public function SaveFile($Key, $Index = 0, $TargetPath = '')
+		{
+			if (!isset($this -> Data[$Key]))
+			{
+				return false;
+			}
+			if (!isset($this -> Data[$Key][$Index]))
+			{
+				return false;
+			}
+
+			// Returing false if it is an image URL
+			if (stripos($this -> Data[$Key][$Index]['Value'], 'uri:') === 0)
+			{
+				return false;
+			}
+
+			if (is_writable($TargetPath) || (!file_exists($TargetPath) && is_writable(dirname($TargetPath))))
+			{
+				$RawContent = $this -> Data[$Key][$Index]['Value'];
+				if (isset($this -> Data[$Key][$Index]['Encoding']) && $this -> Data[$Key][$Index]['Encoding'] == 'b')
+				{
+					$RawContent = base64_decode($RawContent);
+				}
+				$Status = file_put_contents($TargetPath, $RawContent);
+				return (bool)$Status;
+			}
+			else
+			{
+				throw new Exception('vCard: Cannot save file ('.$Key.'), target path not writable ('.$TargetPath.')');
+			}
+			return false;
+		}
+
+		/**
+		 * Magic method for adding data to the vCard
+		 *
+		 * @param string Key
+		 * @param string Method call arguments. First element is value.
+		 *
+		 * @return vCard Current object for method chaining
+		 */
+		public function __call($Key, $Arguments)
+		{
+			$Key = strtolower($Key);
+
+			if (!isset($this -> Data[$Key]))
+			{
+				$this -> Data[$Key] = array();
+			}
+
+			$Value = isset($Arguments[0]) ? $Arguments[0] : false;
+
+			if (count($Arguments) > 1)
+			{
+				$Types = array_values(array_slice($Arguments, 1));
+
+				if (isset(self::$Spec_StructuredElements[$Key]) &&
+					in_array($Arguments[1], self::$Spec_StructuredElements[$Key])
+				)
+				{
+					$LastElementIndex = 0;
+
+					if (count($this -> Data[$Key]))
+					{
+						$LastElementIndex = count($this -> Data[$Key]) - 1;
+					}
+
+					if (isset($this -> Data[$Key][$LastElementIndex]))
+					{
+						if (empty($this -> Data[$Key][$LastElementIndex][$Types[0]]))
+						{
+							$this -> Data[$Key][$LastElementIndex][$Types[0]] = $Value;
+						}
+						else
+						{
+							$LastElementIndex++;
+						}
+					}
+
+					if (!isset($this -> Data[$Key][$LastElementIndex]))
+					{
+						$this -> Data[$Key][$LastElementIndex] = array(
+							$Types[0] => $Value
+						);
+					}
+				}
+				elseif (isset(self::$Spec_ElementTypes[$Key]))
+				{
+					$this -> Data[$Key][] = array(
+						'Value' => $Value,
+						'Type' => $Types
+					);
+				}
+			}
+			elseif ($Value)
+			{
+				$this -> Data[$Key][] = $Value;
+			}
+
+			return $this;
+		}
+
+		/**
+		 * Magic method for getting vCard content out
+		 *
+		 * @return string Raw vCard content
+		 */
+		public function __toString()
+		{
+			$Text = 'BEGIN:VCARD'.self::endl;
+			$Text .= 'VERSION:3.0'.self::endl;
+
+			foreach ($this -> Data as $Key => $Values)
+			{
+				$KeyUC = strtoupper($Key);
+				$Key = strtolower($Key);
+
+				if (in_array($KeyUC, array('PHOTO', 'VERSION')))
+				{
+					continue;
+				}
+
+				foreach ($Values as $Index => $Value)
+				{
+					$Text .= $KeyUC;
+					if (is_array($Value) && isset($Value['Type']))
+					{
+						$Text .= ';TYPE='.self::PrepareTypeStrForOutput($Value['Type']);
+					}
+					$Text .= ':';
+
+					if (isset(self::$Spec_StructuredElements[$Key]))
+					{
+						$PartArray = array();
+						foreach (self::$Spec_StructuredElements[$Key] as $Part)
+						{
+							$PartArray[] = isset($Value[$Part]) ? $Value[$Part] : '';
+						}
+						$Text .= implode(';', $PartArray);
+					}
+					elseif (is_array($Value) && isset(self::$Spec_ElementTypes[$Key]))
+					{
+						$Text .= $Value['Value'];
+					}
+					else
+					{
+						$Text .= $Value;
+					}
+
+					$Text .= self::endl;
+				}
+			}
+
+			$Text .= 'END:VCARD'.self::endl;
+			return $Text;
+		}
+
+		// !Helper methods
+
+		private static function PrepareTypeStrForOutput($Type)
+		{
+			return implode(',', array_map('strtoupper', $Type));
+		}
+
+	 	/**
+		 * Removes the escaping slashes from the text.
+		 *
+		 * @access private
+		 *
+		 * @param string Text to prepare.
+		 *
+		 * @return string Resulting text.
+		 */
+		private static function Unescape($Text)
+		{
+			return str_replace(array('\:', '\;', '\,', "\n"), array(':', ';', ',', ''), $Text);
+		}
+
+		/**
+		 * Separates the various parts of a structured value according to the spec.
+		 *
+		 * @access private
+		 *
+		 * @param string Raw text string
+		 * @param string Key (e.g., N, ADR, ORG, etc.)
+		 *
+		 * @return array Parts in an associative array.
+		 */
+		private static function ParseStructuredValue($Text, $Key)
+		{
+			$Text = array_map('trim', explode(';', $Text));
+
+			$Result = array();
+			$Ctr = 0;
+
+			foreach (self::$Spec_StructuredElements[$Key] as $Index => $StructurePart)
+			{
+				$Result[$StructurePart] = isset($Text[$Index]) ? $Text[$Index] : null;
+			}
+			return $Result;
+		}
+
+		/**
+		 * @access private
+		 */
+		private static function ParseMultipleTextValue($Text)
+		{
+			return explode(',', $Text);
+		}
+
+		/**
+		 * @access private
+		 */
+		private static function ParseParameters($Key, array $RawParams = null)
+		{
+			if (!$RawParams)
+			{
+				return array();
+			}
+
+			// Parameters are split into (key, value) pairs
+			$Parameters = array();
+			foreach ($RawParams as $Item)
+			{
+				$Parameters[] = explode('=', strtolower($Item));
+			}
+
+			$Type = array();
+			$Result = array();
+
+			// And each parameter is checked whether anything can/should be done because of it
+			foreach ($Parameters as $Index => $Parameter)
+			{
+				// Skipping empty elements
+				if (!$Parameter)
+				{
+					continue;
+				}
+
+				// Handling type parameters without the explicit TYPE parameter name (2.1 valid)
+				if (count($Parameter) == 1)
+				{
+					// Checks if the type value is allowed for the specific element
+					// The second part of the "if" statement means that email elements can have non-standard types (see the spec)
+					if (
+						(isset(self::$Spec_ElementTypes[$Key]) && in_array($Parameter[0], self::$Spec_ElementTypes[$Key])) ||
+						($Key == 'email' && is_scalar($Parameter[0]))
+					)
+					{
+						$Type[] = $Parameter[0];
+					}
+				}
+				elseif (count($Parameter) > 2)
+				{
+					$TempTypeParams = self::ParseParameters($Key, explode(',', $RawParams[$Index]));
+					if ($TempTypeParams['type'])
+					{
+						$Type = array_merge($Type, $TempTypeParams['type']);
+					}
+				}
+				else
+				{
+					switch ($Parameter[0])
+					{
+						case 'encoding':
+							if (in_array($Parameter[1], array('quoted-printable', 'b', 'base64')))
+							{
+								$Result['encoding'] = $Parameter[1] == 'base64' ? 'b' : $Parameter[1];
+							}
+							break;
+						case 'charset':
+							$Result['charset'] = $Parameter[1];
+							break;
+						case 'type':
+							$Type = array_merge($Type, explode(',', $Parameter[1]));
+							break;
+						case 'value':
+							if (strtolower($Parameter[1]) == 'url')
+							{
+								$Result['encoding'] = 'uri';
+							}
+							break;
+					}
+				}
+			}
+
+			$Result['type'] = $Type;
+
+			return $Result;
+		}
+
+		// !Interface methods
+
+		// Countable interface
+		public function count()
+		{
+			switch ($this -> Mode)
+			{
+				case self::MODE_ERROR:
+					return 0;
+					break;
+				case self::MODE_SINGLE:
+					return 1;
+					break;
+				case self::MODE_MULTIPLE:
+					return count($this -> Data);
+					break;
+			}
+			return 0;
+		}
+
+		// Iterator interface
+		public function rewind()
+		{
+			reset($this -> Data);
+		}
+
+		public function current()
+		{
+			return current($this -> Data);
+		}
+
+		public function next()
+		{
+			return next($this -> Data);
+		}
+
+		public function valid()
+		{
+			return ($this -> current() !== false);
+		}
+
+		public function key()
+		{
+			return key($this -> Data);
+		}
+	}
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/models/Link.php elefant-elefant_1_3_10_beta/apps/user/models/Link.php
--- elefant-elefant_1_3_9_beta/apps/user/models/Link.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/models/Link.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,59 @@
+<?php
+
+namespace user;
+
+use DB;
+
+class Link extends \Model {
+	public $table = '#prefix#user_links';
+	
+	public $fields = array (
+		'user' => array (
+			'belongs_to' => 'User',
+			'field_name' => 'user_id'
+		)
+	);
+	
+	/**
+	 * Get all links for the specified user.
+	 */
+	public static function for_user ($id) {
+		$o = new Link;
+		$res = DB::fetch (
+			'select * from ' . $o->table . '
+			 where user_id = ?
+			 order by service asc',
+			$id
+		);
+		foreach ($res as $k => $v) {
+			$res[$k]->link = self::get_link ($v->service, $v->handle);
+		}
+		return $res;
+	}
+	
+	/**
+	 * Filter a handle by service to return a link.
+	 */
+	public static function get_link ($service, $handle) {
+		if (preg_match ('/^https?\:\/\//', $handle)) {
+			return $handle;
+		}
+
+		switch ($service) {
+			case 'Twitter':
+				return 'https://twitter.com/' . ltrim ($handle, '@');
+
+			case 'Instagram':
+				return 'http://instagram.com/' . $handle;
+
+			case 'Tumblr':
+				return 'http://' . $handle . '.tumblr.com/';
+
+			case 'Facebook':
+			case 'Google+':
+			case 'Website':
+			case 'YouTube':
+				return 'http://' . $handle;
+		}
+	}
+}
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/models/Note.php elefant-elefant_1_3_10_beta/apps/user/models/Note.php
--- elefant-elefant_1_3_9_beta/apps/user/models/Note.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/models/Note.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,38 @@
+<?php
+
+namespace user;
+
+use User;
+use DB;
+use I18n;
+
+class Note extends \Model {
+	public $table = '#prefix#user_notes';
+	
+	public $fields = array (
+		'user' => array (
+			'belongs_to' => 'User',
+			'field_name' => 'user_id'
+		)
+	);
+	
+	/**
+	 * Get all notes for the specified user.
+	 */
+	public static function for_user ($id) {
+		$o = new Note;
+		$u = new User;
+		$res = DB::fetch (
+			'select n.*, u.name as made_by_name
+			 from ' . $o->table . ' n, ' . $u->table . ' u
+			 where n.user_id = ?
+			 and n.made_by = u.id
+			 order by n.ts desc',
+			$id
+		);
+		foreach ($res as $k => $v) {
+			$res[$k]->date = I18n::short_date_time ($v->ts);
+		}
+		return $res;
+	}
+}
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/models/User.php elefant-elefant_1_3_10_beta/apps/user/models/User.php
--- elefant-elefant_1_3_9_beta/apps/user/models/User.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/models/User.php	2014-12-03 23:59:25.000000000 -0600
@@ -109,15 +109,29 @@
 	public static $acl = null;
 
 	/**
-	 * Generates a random salt and encrypts a password using MD5.
+	 * Get all social links for the current user.
+	 * Alias of `user\Link::for_user ($user_id)`
+	 */
+	public function links () {
+		return user\Link::for_user ($this->id);
+	}
+
+	/**
+	 * Get all notes for the current user.
+	 * Alias of `user\Note::for_user ($user_id)`
+	 */
+	public function notes () {
+		return user\Note::for_user ($this->id);
+	}
+
+	/**
+	 * Generates a random salt and encrypts a password using Blowfish.
 	 */
 	public static function encrypt_pass ($plain) {
-		$base = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
-		$salt = '$2a$07$';
-		for ($i = 0; $i < 22; $i++) {
-			$salt .= $base[rand (0, 61)];
+		if (defined ('PASSWORD_DEFAULT')) {
+			return password_hash ($plain, PASSWORD_BCRYPT);
 		}
-		return crypt ($plain, $salt . '$');
+		return crypt ($plain, '$2a$10$' . substr (sha1 (mt_rand ()), 0, 22) . '$');
 	}
 
 	/**
@@ -139,6 +153,7 @@
 			$name = $name ? $name : conf ('General', 'session_name');
 			$duration = $duration ? $duration : conf ('General', 'session_duration');
 			$domain = $domain ? $domain : conf ('General', 'session_domain');
+			$handler_class = conf ('General', 'session_save_handler');
 
 			if ($domain === 'full') {
 				$domain = $_SERVER['HTTP_HOST'];
@@ -147,8 +162,21 @@
 				$tld = array_pop ($parts);
 				$domain = '.' . array_pop ($parts) . '.' . $tld;
 			}
+			ini_set ('session.gc_maxlifetime', (int) $duration);
 			@session_set_cookie_params ($duration, $path, $domain, $secure, $httponly);
 			@session_name ($name);
+
+			if ($handler_class) {
+				if (strpos ($handler_class, ':') !== false) {
+					list ($handler, $save_path) = explode (':', $handler_class, 2);
+					ini_set ('session.save_handler', $handler);
+					ini_set ('session.save_path', $save_path);
+				} elseif (class_exists ($handler_class)) {
+					$handler = new $handler_class (conf ('General', 'site_key'));
+					@session_set_save_handler ($handler, true);
+				}
+			}
+
 			@session_start ();
 
 			if (isset ($_COOKIE[$name])) {
@@ -346,9 +374,26 @@
 	 * Where `User::require_acl('resource')` is good for validating
 	 * access to any resource type, `User::access('member')` is used
 	 * for content access levels.
+	 *
+	 * Can also be called via `User::access()` and it will return an
+	 * array of the access values which the current user may access,
+	 * for example:
+	 *
+	 *     array ('public' => 'Public', 'member' => 'Member')
 	 */
-	public static function access ($access) {
-		return self::require_acl ('content/' . $access);
+	public static function access ($access = null) {
+		if ($access !== null) {
+			return self::require_acl ('content/' . $access);
+		}
+		
+		$access = array ();
+		$list = self::access_list ();
+		foreach ($list as $k => $v) {
+			if (User::access ($k)) {
+				$access[$k] = $v;
+			}
+		}
+		return $access;
 	}
 
 	/**
@@ -394,6 +439,20 @@
 
 		return self::$acl;
 	}
+	
+	/**
+	 * Fetch the roles that an admin user is allowed to assign.
+	 */
+	public static function allowed_roles () {
+		$allowed_roles = array ();
+		$roles = array_keys (self::acl ()->rules);
+		foreach ($roles as $role) {
+			if (self::acl ()->allowed ('user/allowed_roles/' . $role)) {
+				$allowed_roles[] = $role;
+			}
+		}
+		return $allowed_roles;
+	}
 
 	/**
 	 * Get or set a specific field's value.
@@ -449,5 +508,3 @@
 		}
 	}
 }
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/models/User_OpenID.php elefant-elefant_1_3_10_beta/apps/user/models/User_OpenID.php
--- elefant-elefant_1_3_9_beta/apps/user/models/User_OpenID.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/models/User_OpenID.php	2014-12-03 23:59:25.000000000 -0600
@@ -59,5 +59,3 @@
 		return false;
 	}
 }
-
-?>
\ No newline at end of file
Files elefant-elefant_1_3_9_beta/apps/user/pix/facebook.png and elefant-elefant_1_3_10_beta/apps/user/pix/facebook.png are identical
Files elefant-elefant_1_3_9_beta/apps/user/pix/google.png and elefant-elefant_1_3_10_beta/apps/user/pix/google.png are identical
Files elefant-elefant_1_3_9_beta/apps/user/pix/openid.png and elefant-elefant_1_3_10_beta/apps/user/pix/openid.png are identical
Files elefant-elefant_1_3_9_beta/apps/user/pix/persona.png and elefant-elefant_1_3_10_beta/apps/user/pix/persona.png are identical
Files elefant-elefant_1_3_9_beta/apps/user/pix/twitter.png and elefant-elefant_1_3_10_beta/apps/user/pix/twitter.png are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/views/add.html elefant-elefant_1_3_10_beta/apps/user/views/add.html
--- elefant-elefant_1_3_9_beta/apps/user/views/add.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/views/add.html	2014-12-03 23:59:25.000000000 -0600
@@ -1,25 +1,105 @@
+{! filemanager/util/browser !}
+
 <div class="form">
 
 <form method="POST" id="add-form">
-<p>{"Name"}:<br /><input type="text" name="name" size="40" value="{{ name }}" />
+<p>{"Name"}:<br /><input type="text" name="name" size="40" value="{{ name|quotes }}" />
 <span class="notice" id="name-notice">{"You must enter a name."}</span></p>
-<p>{"Email"}:<br /><input type="text" name="email" size="40" value="{{ email }}" />
+<p>{"Email"}:<br /><input type="text" name="email" size="40" value="{{ email|quotes }}" />
 <span class="notice" id="email-notice">{"You must enter an email address."}</span></p>
-<p>{"Password"}:<br /><input type="password" name="password" size="20" value="{{ password }}" />
+<p>{"Password"}:<br /><input type="password" name="password" size="20" value="{{ password|quotes }}" />
 <span class="notice" id="password-notice">{"You must enter a password."}</span></p>
-<p>{"Verify password"}:<br /><input type="password" name="verify_pass" size="20" value="{{ verify_pass }}" />
+<p>{"Verify password"}:<br /><input type="password" name="verify_pass" size="20" value="{{ verify_pass|quotes }}" />
 <span class="notice" id="verify_pass-notice">{"Your password doesn't match."}</span></p>
-<p>{"User role"}:<br />
-<select name="type">
-{% foreach types %}
-	<option value="{{ loop_value }}"{% if type === $data->loop_value %} selected {% end %}>{{ loop_value|ucfirst }}</option>
+
+{% if User::require_acl ('user/edit_roles') %}
+	<p>{"Member role"}:<br />
+	<select name="type">
+	{% foreach types %}
+		<option value="{{ loop_value|quotes }}"{% if type === $data->loop_value %} selected {% end %}>{{ loop_value|ucfirst }}</option>
+	{% end %}
+	</select></p>
+{% else %}
+	<input type="hidden" name="type" value="{{type}}" />
 {% end %}
-</select></p>
+
+<p>
+	{"Company"}:<br />
+	<input type="text" name="company" size="40" value="{{ company|quotes }}" />
+</p>
+
+<p>
+	{"Title"}:<br />
+	<input type="text" name="title" size="40" value="{{ title|quotes }}" />
+</p>
+
+<p>
+	{"Website"}:<br />
+	<input type="text" name="website" size="40" value="{{ website|quotes }}" />
+</p>
+
+<p>
+	{"Photo"}:<br />
+	<input type="text" name="photo" id="photo" size="40" value="{{ photo|quotes }}" />
+	<input type="submit" id="photo-browse" value="{"Choose"}" />
+</p>
+
+<p>
+	{"About"}:<br />
+	<textarea cols="70" rows="4" name="about">{{ about }}</textarea>
+</p>
+
+<h4>{"Contact information"}</h4>
+
+<p>
+	{"Phone"}:<br />
+	<input type="text" name="phone" size="30" value="{{ phone|quotes }}" />
+</p>
+
+<p>
+	{"Address"}:<br />
+	<input type="text" name="address" size="40" value="{{ address|quotes }}" />
+</p>
+
+<p>
+	{"Address line 2"}:<br />
+	<input type="text" name="address2" size="40" value="{{ address2|quotes }}" />
+</p>
+
+<p>
+	{"City"}:<br />
+	<input type="text" name="city" size="40" value="{{ city|quotes }}" />
+</p>
+
+<p>
+	{"State/province"}:<br />
+	<select name="state">
+		<option value="">{"- select -"}</option>
+	{% foreach _states as _state, _name %}
+		<option value="{{ _state|quotes }}"{% if state === $data->_state %} selected {% end %}>{{ _name|ucfirst }}</option>
+	{% end %}
+	</select>
+</p>
+
+<p>
+	{"Country"}:<br />
+	<select name="country">
+		<option value="">{"- select -"}</option>
+	{% foreach _countries as _country, _name %}
+		<option value="{{ _country|quotes }}"{% if country === $data->_country %} selected {% end %}>{{ _name|ucfirst }}</option>
+	{% end %}
+	</select>
+</p>
+
+<p>
+	{"Zip/postal code"}:<br />
+	<input type="text" name="zip" size="20" value="{{ zip|quotes }}" />
+</p>
 
 {! admin/util/extended?extends=User&name=Users !}
 
 <p>
-	<input type="submit" value="{"Add User"}" />&nbsp;
+	<input type="submit" value="{"Add Member"}" />&nbsp;
 	<a href="javascript:history.go(-1)" onclick="return $.cancel_autosave ('{"Are you sure you want to cancel and lose any changes?"}')">{"Cancel"}</a>
 </p>
 </form>
@@ -46,5 +126,15 @@
 	{% foreach failed %}
 	$('#{{ loop_value }}-notice').show ();
 	{% end %}
+	
+	$('#photo-browse').click (function (e) {
+		e.preventDefault ();
+		$.filebrowser ({
+			allowed: ['jpg', 'jpeg', 'png', 'gif'],
+			set_value: '#photo',
+			title: "{"Choose an image"}",
+			thumbs: true
+		});
+	});
 });
 </script>
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/views/admin.html elefant-elefant_1_3_10_beta/apps/user/views/admin.html
--- elefant-elefant_1_3_9_beta/apps/user/views/admin.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/views/admin.html	2014-12-03 23:59:25.000000000 -0600
@@ -1,46 +1,91 @@
-<p>
-	<a href="/user/add">{"Add User"}</a>
-	{% if User::require_acl ('user/roles') %}
-	&nbsp;|&nbsp;
-	<a href="/user/roles">{"Roles"}</a>
-	{% end %}
-	{% if User::require_acl ('settings') %}
-	&nbsp;|&nbsp;
-	<a href="/user/settings">{"Settings"}</a>
-	&nbsp;|&nbsp;
-	<a href="/admin/extended?extends=User&name=Users">{"Custom Fields"}</a>
-	{% end %}
-</p>
+{! admin/util/minimal-grid !}
+{! admin/util/search !}
 
-<p style="float: left">
-{! navigation/pager?style=results&url=[url]&total=[total]&count=[count]&limit=[limit] !}
-</p>
+<div class="e-row-variable" style="margin-bottom: 20px">
+	<div class="e-col-50 e-no-padding">
+		<a href="/user/add">{"Add Member"}</a>
+		&nbsp;|&nbsp;
+		<a href="/user/import">{"Import Members"}</a>
+		{% if User::require_acl ('user/roles') %}
+		&nbsp;|&nbsp;
+		<a href="/user/roles">{"Roles"}</a>
+		{% end %}
+		{% if User::require_acl ('settings') %}
+		&nbsp;|&nbsp;
+		<a href="/user/settings">{"Settings"}</a>
+		&nbsp;|&nbsp;
+		<a href="/admin/extended?extends=User&name=Members">{"Custom Fields"}</a>
+		{% end %}
+	</div>
+	<div class="e-col-50 e-no-padding" style="text-align: right">
+		<form method="get" id="search-form">
+			<input type="text" name="q" id="search-query" size="40" value="{{q|quotes}}" />
+			<button>{"Search"}</button>
+			{% if q != '' %}
+			<button onclick="window.location.href = '/user/admin'; return false">{"Clear"}</button>
+			{% end %}
+		</form>
+	</div>
+</div>
 
-{% if total > $data->limit %}
-<div style="float: right">
-{! navigation/pager?style=numbers&url=[url]&total=[total]&count=[count]&limit=[limit] !}
+<div class="e-row-variable">
+	<div class="e-col-50 e-no-padding">
+		{! navigation/pager?style=results&url=[url]&total=[total]&count=[count]&limit=[limit] !}
+	</div>
+	<div class="e-col-50 e-no-padding" style="text-align: right">
+		{% if total > $data->limit %}
+		{! navigation/pager?style=numbers&url=[url]&total=[total]&count=[count]&limit=[limit] !}
+		{% end %}
+	</div>
 </div>
-{% end %}
 
-<p>
 <table width="100%">
 	<tr>
-		<th width="30%">{"Name"}</th>
-		<th width="30%">{"Email"}</th>
-		<th width="25%">{"Type"}</th>
-		<th width="15%">&nbsp;</th>
+		<th width="18%">{"Name"}</th>
+		<th width="13%">{"Phone"}</th>
+		<th width="20%">{"Email"}</th>
+		<th width="16%">{"Company"}</th>
+		<th width="15%">{"Title"}</th>
+		<th width="8%">
+			<select class="search-option" data-prefix="type">
+				<option value="">{"Role"}</option>
+				{% foreach User::allowed_roles () as _role %}
+				<option value="{{_role}}">{{_role|ucfirst}}</option>
+				{% end %}
+			</select>
+		</th>
+		<th width="10%">&nbsp;</th>
 	</tr>
 {% foreach users %}
 	<tr>
-		<td>{{ loop_value->name }}</td>
-		<td>{{ loop_value->email }}</td>
-		<td>{{ loop_value->type|ucfirst }}</td>
-		<td style="text-align: right"><a href="/user/edit?id={{ loop_value->id }}">{"Edit"}</a> | <a href="/user/delete?id={{ loop_value->id }}" onclick="return confirm ('{"Are you sure you want to delete this user?"}');">{"Delete"}</a></td>
+		<td class="title"><a href="/user/details?id={{ loop_value->id }}">{{ loop_value->name }}</a></td>
+		<td>{{ loop_value->phone }}</td>
+		<td><a href="mailto:{{ loop_value->email }}">{{ loop_value->email }}</a></td>
+		<td><a href="#" class="search-for" data-search="company:&quot;{{ loop_value->company }}&quot;">{{ loop_value->company }}</td>
+		<td>{{ loop_value->title }}</td>
+		<td><a href="#" class="search-for" data-search="type:{{ loop_value->type}}">{{ loop_value->type|ucfirst }}</a></td>
+		<td class="edit">
+			<a href="/user/edit?id={{ loop_value->id }}">{"Edit"}</a>
+			{% if User::val ('id') != $data->loop_value->id %}
+			|
+			<a href="/user/delete?id={{ loop_value->id }}" onclick="return confirm ('{"Are you sure you want to delete this user?"}');">{"Delete"}</a>
+			{% end %}
+			</td>
 	</tr>
 {% end %}
 </table>
-</p>
 
 {% if total > $data->limit %}
 {! navigation/pager?style=numbers&url=[url]&total=[total]&count=[count]&limit=[limit] !}
 {% end %}
+
+<script>
+$(function () {
+	$.search_init ({
+		form: '#search-form',
+		query: '#search-query',
+		links: '.search-for',
+		options: '.search-option'
+	});
+});
+</script>
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/views/chooser/addform.html elefant-elefant_1_3_10_beta/apps/user/views/chooser/addform.html
--- elefant-elefant_1_3_9_beta/apps/user/views/chooser/addform.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/views/chooser/addform.html	2014-12-03 23:59:25.000000000 -0600
@@ -9,17 +9,22 @@
 <span class="notice" id="password-notice">{"You must enter a password."}</span></p>
 <p>{"Verify password"}:<br /><input type="password" name="verify_pass" size="20" value="{{ verify_pass }}" />
 <span class="notice" id="verify_pass-notice">{"Your password doesn't match."}</span></p>
-<p>{"User type"}:<br />
-<select name="type">
-{% foreach types %}
-	<option value="{{ loop_value }}"{% if type === $data->loop_value %} selected {% end %}>{{ loop_value|ucfirst }}</option>
+
+{% if User::require_acl ('user/edit_roles') %}
+	<p>{"Member role"}:<br />
+	<select name="type">
+	{% foreach types %}
+		<option value="{{ loop_value }}"{% if type === $data->loop_value %} selected {% end %}>{{ loop_value|ucfirst }}</option>
+	{% end %}
+	</select></p>
+{% else %}
+	<input type="hidden" name="type" value="{{type}}" />
 {% end %}
-</select></p>
 
 {! admin/util/extended?extends=User&modal=true !}
 
 <p>
-	<input type="submit" value="{"Add User"}" />&nbsp;
+	<input type="submit" value="{"Add Member"}" />&nbsp;
 	<a href="javascript:void(0)" id="adduser-cancel">{"Cancel"}</a>
 </p>
 </form>
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/views/details.html elefant-elefant_1_3_10_beta/apps/user/views/details.html
--- elefant-elefant_1_3_9_beta/apps/user/views/details.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/views/details.html	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,87 @@
+{! admin/util/dates !}
+{! admin/util/fontawesome !}
+
+<p>
+	<a href="/user/admin">&laquo; {"Back"}</a>
+	&nbsp;|&nbsp;
+	<a href="/user/edit?id={{id}}">{"Edit"}</a>
+	&nbsp;|&nbsp;
+	<a href="/user/delete?id={{id}}" onclick="return confirm ('{"Are you sure you want to delete this user?"}');">{"Delete"}</a>
+</p>
+
+<h4>{"Contact information"}</h4>
+
+{% if photo != '' %}
+<img src="{{photo}}" id="photo" />
+{% end %}
+
+<p>
+	<b>{"Email"}:</b> <a href="mailto:{{email}}">{{email}}</a><br />
+	<b>{"Phone"}:</b> {{phone}}<br />
+	<b>{"Website"}:</b> <a href="{{website}}">{{website}}</a>
+</p>
+
+<p>
+	<b>{"Company"}:</b> {{company}}<br />
+	<b>{"Title"}:</b> {{title}}
+</p>
+
+<p>
+	{{address}}{% if address2 != '' %},<br />{{address2}}{% end %}<br />
+	{{city}}, {{state|user\Data::state}}<br />
+	{{country|user\Data::country}} {{zip}}
+</p>
+
+{% if about != '' %}
+<p><b>{"About"}:</b><br />{{about}}</p>
+{% end %}
+
+<h4 class="clear-photo">{"Social links"}</h4>
+
+<div id="links"></div>
+
+<h4>{"Notes"}</h4>
+
+<div id="notes"></div>
+
+<script>
+var I18N = {
+	add_link: '{"Add Link"}',
+	add_note: '{"Add Note"}',
+	link_placeholder: '{"Link or handle"}',
+	service: '{"- service -"}',
+	edit: '{"Edit"}',
+	del: '{"Delete"}',
+	confirm_delete_link: '{"Are you sure you want to delete this link?"}',
+	confirm_delete_note: '{"Are you sure you want to permanently delete this note?"}',
+	link_deleted: '{"Link deleted."}',
+	note_deleted: '{"Note deleted."}',
+	link_added: '{"Link added."}',
+	note_added: '{"Note added."}'
+};
+</script>
+
+<script>
+React.renderComponent (
+	LinkBox ({
+		init_url: '/user/api/link/{{id}}',
+		add_url: '/user/api/link/add',
+		del_url: '/user/api/link/delete',
+		user_id: {{id}},
+		current_user: {{User::val ('id')}},
+		i18n: I18N
+	}),
+	document.getElementById ('links')
+);
+React.renderComponent (
+	NoteBox ({
+		init_url: '/user/api/note/{{id}}',
+		add_url: '/user/api/note/add',
+		del_url: '/user/api/note/delete',
+		user_id: {{id}},
+		current_user: {{User::val ('id')}},
+		i18n: I18N
+	}),
+	document.getElementById ('notes')
+);
+</script>
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/views/edit.html elefant-elefant_1_3_10_beta/apps/user/views/edit.html
--- elefant-elefant_1_3_9_beta/apps/user/views/edit.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/views/edit.html	2014-12-03 23:59:25.000000000 -0600
@@ -1,7 +1,9 @@
+{! filemanager/util/browser !}
+
 <div class="form">
 
 <form method="POST" id="add-form">
-<p>{"Name"}:<br /><input type="text" name="name" size="40" value="{{ name|quotes }}" />
+<p>{"Name"}:<br /><input type="text" name="name" size="40" value="{{ name }}" />
 <span class="notice" id="name-notice">{"You must enter a name."}</span></p>
 <p>{"Email"}:<br /><input type="text" name="email" size="40" value="{{ email }}" />
 <span class="notice" id="email-notice">{"You must enter an email address."}</span></p>
@@ -9,17 +11,95 @@
 <span class="notice" id="password-notice">{"You must enter a password."}</span></p>
 <p>{"Verify password"}:<br /><input type="password" name="verify_pass" size="20" value="{{ verify_pass }}" />
 <span class="notice" id="verify_pass-notice">{"Your password doesn't match."}</span></p>
-<p>{"User role"}:<br />
-<select name="type">
-{% foreach types %}
-	<option value="{{ loop_value }}"{% if type === $data->loop_value %} selected {% end %}>{{ loop_value|ucfirst }}</option>
+
+{% if User::require_acl ('user/edit_roles') %}
+	<p>{"Member role"}:<br />
+	<select name="type">
+	{% foreach types %}
+		<option value="{{ loop_value }}"{% if type === $data->loop_value %} selected {% end %}>{{ loop_value|ucfirst }}</option>
+	{% end %}
+	</select></p>
+{% else %}
+	<input type="hidden" name="type" value="{{type}}" />
 {% end %}
-</select></p>
 
-{! admin/util/extended?extends=User&name=Users&values=[userdata|none] !}
+<p>
+	{"Company"}:<br />
+	<input type="text" name="company" size="40" value="{{ company }}" />
+</p>
+
+<p>
+	{"Title"}:<br />
+	<input type="text" name="title" size="40" value="{{ title }}" />
+</p>
+
+<p>
+	{"Website"}:<br />
+	<input type="text" name="website" size="40" value="{{ website }}" />
+</p>
+
+<p>
+	{"Photo"}:<br />
+	<input type="text" name="photo" id="photo" size="40" value="{{ photo }}" />
+	<input type="submit" id="photo-browse" value="{"Choose"}" />
+</p>
 
 <p>
-	<input type="submit" value="{"Save User"}" />&nbsp;
+	{"About"}:<br />
+	<textarea cols="70" rows="4" name="about">{{ about }}</textarea>
+</p>
+
+<h4>{"Contact information"}</h4>
+
+<p>
+	{"Phone"}:<br />
+	<input type="text" name="phone" size="30" value="{{ phone }}" />
+</p>
+
+<p>
+	{"Address"}:<br />
+	<input type="text" name="address" size="40" value="{{ address }}" />
+</p>
+
+<p>
+	{"Address line 2"}:<br />
+	<input type="text" name="address2" size="40" value="{{ address2 }}" />
+</p>
+
+<p>
+	{"City"}:<br />
+	<input type="text" name="city" size="40" value="{{ city }}" />
+</p>
+
+<p>
+	{"State/province"}:<br />
+	<select name="state">
+		<option value="">{"- select -"}</option>
+	{% foreach _states as _state, _name %}
+		<option value="{{ _state }}"{% if state === $data->_state %} selected {% end %}>{{ _name|ucfirst }}</option>
+	{% end %}
+	</select>
+</p>
+
+<p>
+	{"Country"}:<br />
+	<select name="country">
+		<option value="">{"- select -"}</option>
+	{% foreach _countries as _country, _name %}
+		<option value="{{ _country }}"{% if country === $data->_country %} selected {% end %}>{{ _name|ucfirst }}</option>
+	{% end %}
+	</select>
+</p>
+
+<p>
+	{"Zip/postal code"}:<br />
+	<input type="text" name="zip" size="20" value="{{ zip }}" />
+</p>
+
+{! admin/util/extended?extends=User&name=Users&values=[userdata|none]&id=[id] !}
+
+<p>
+	<input type="submit" value="{"Save Member"}" />&nbsp;
 	<a href="javascript:history.go(-1)" onclick="return $.cancel_autosave ('{"Are you sure you want to cancel and lose any changes?"}')">{"Cancel"}</a>
 </p>
 </form>
@@ -46,5 +126,15 @@
 	{% foreach failed %}
 	$('#{{ loop_value }}-notice').show ();
 	{% end %}
+	
+	$('#photo-browse').click (function (e) {
+		e.preventDefault ();
+		$.filebrowser ({
+			allowed: ['jpg', 'jpeg', 'png', 'gif'],
+			set_value: '#photo',
+			title: "{"Choose an image"}",
+			thumbs: true
+		});
+	});
 });
 </script>
Files elefant-elefant_1_3_9_beta/apps/user/views/email/recover.html and elefant-elefant_1_3_10_beta/apps/user/views/email/recover.html are identical
Files elefant-elefant_1_3_9_beta/apps/user/views/email/verification.html and elefant-elefant_1_3_10_beta/apps/user/views/email/verification.html are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/views/import/csv.html elefant-elefant_1_3_10_beta/apps/user/views/import/csv.html
--- elefant-elefant_1_3_9_beta/apps/user/views/import/csv.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/views/import/csv.html	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,11 @@
+<form method="post" enctype="multipart/form-data">
+
+<p>1. {"Upload the CSV file"}:</p>
+
+<p><input type="file" name="import_file" /></p>
+
+<p>
+	<input type="submit" value="{"Next"}" />&nbsp;
+	<a href="/user/admin">{"Cancel"}</a>&nbsp;
+</p>
+</form>
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/views/import/csv2.html elefant-elefant_1_3_10_beta/apps/user/views/import/csv2.html
--- elefant-elefant_1_3_9_beta/apps/user/views/import/csv2.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/views/import/csv2.html	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,50 @@
+<p>2. {"Which columns should be imported?"}</p>
+
+<form method="post" action="/user/import/csv2">
+
+<p>
+<table width="100%">
+	<tr>
+{% foreach headers %}
+		<th>{{ loop_value }}</th>
+{% end %}
+	</tr>
+{% foreach samples %}
+	<tr>
+	{{ loop_value|blog_filter_csv_line }}
+	</tr>
+{% end %}
+	<tr>
+{% foreach headers %}
+		<td>
+<select name="map-{{ loop_index }}">
+	<option value="">{"Import as..."}</option>
+	<option value="name">{"Full name"}</option>
+	<option value="first_name">{"First name"}</option>
+	<option value="last_name">{"Last name"}</option>
+	<option value="email">{"Email"}</option>
+	<option value="company">{"Company"}</option>
+	<option value="title">{"Title"}</option>
+	<option value="website">{"Website"}</option>
+	<option value="photo">{"Photo"}</option>
+	<option value="about">{"About"}</option>
+	<option value="phone">{"Phone"}</option>
+	<option value="address">{"Address"}</option>
+	<option value="address2">{"Address line 2"}</option>
+	<option value="city">{"City"}</option>
+	<option value="state">{"State/province"}</option>
+	<option value="country">{"Country"}</option>
+	<option value="zip">{"Zip/postal code"}</option>
+{% foreach extended as _field %}
+	<option value="{{_field->name}}">{{_field->label}}</option>
+{% end %}
+</select>
+		</td>
+{% end %}
+	</tr>
+</table>
+</p>
+
+<p><input type="submit" value="{"Finish importing"}" /></p>
+
+</form>
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/views/import/vcf.html elefant-elefant_1_3_10_beta/apps/user/views/import/vcf.html
--- elefant-elefant_1_3_9_beta/apps/user/views/import/vcf.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/views/import/vcf.html	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,10 @@
+<form method="post" enctype="multipart/form-data">
+
+<p>{"VCF file"}:<br />
+<input type="file" name="import_file" /></p>
+
+<p>
+	<input type="submit" value="{"Import Members"}" />&nbsp;
+	<a href="/user/admin">{"Cancel"}</a>&nbsp;
+</p>
+</form>
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/views/import.html elefant-elefant_1_3_10_beta/apps/user/views/import.html
--- elefant-elefant_1_3_9_beta/apps/user/views/import.html	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/views/import.html	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,6 @@
+<ul>
+	<li><a href="/user/import/vcf">VCF File</a></li>
+	<li><a href="/user/import/csv">CSV File</a></li>
+</ul>
+
+<p><a href="/user/admin">{"Cancel"}</a></p>
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/views/index.html elefant-elefant_1_3_10_beta/apps/user/views/index.html
--- elefant-elefant_1_3_9_beta/apps/user/views/index.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/views/index.html	2014-12-03 23:59:25.000000000 -0600
@@ -1,9 +1,24 @@
-<p><a href="http://www.gravatar.com/site/login/" target="_blank" title="{"Click to update photo"} (Gravatar)"><img src="http://www.gravatar.com/avatar/{{ hash }}?s=42&d=mm" style="float: left; margin-right: 15px" /></a>
+{% if photo == '' %}
+	<img src="{{Appconf::user ('User', 'default_photo')}}" align="left" style="margin-right: 15px; width: {{Appconf::user ('User', 'photo_width')}}px; height: {{Appconf::user ('User', 'photo_height')}}px" />
+{% else %}
+	<img src="/{{photo}}" align="left" style="margin-right: 15px; width: {{Appconf::user ('User', 'photo_width')}}px; height: {{Appconf::user ('User', 'photo_height')}}px" />
+{% end %}
+
+<p>
+
+{% if website != '' %}
+	<a href="{{website}}" rel="nofollow">{"Visit Website"}</a>
+{% end %}
 
 {% if is_current %}
-<a href="/user/update">{"Edit Profile"}</a>
+	{% if website != '' %}|{% end %}
+	<a href="/user/update" class="user-edit-profile">{"Edit Profile"}</a>
 {% end %}
 
 </p>
 
+{% if about != '' %}
+<p>{{about|Template::sanitize|nl2br}}</p>
+{% end %}
+
 <br clear="both" />
Files elefant-elefant_1_3_9_beta/apps/user/views/login/newuser.html and elefant-elefant_1_3_10_beta/apps/user/views/login/newuser.html are identical
Files elefant-elefant_1_3_9_beta/apps/user/views/login/openid.html and elefant-elefant_1_3_10_beta/apps/user/views/login/openid.html are identical
Files elefant-elefant_1_3_9_beta/apps/user/views/login.html and elefant-elefant_1_3_10_beta/apps/user/views/login.html are identical
Files elefant-elefant_1_3_9_beta/apps/user/views/newpass.html and elefant-elefant_1_3_10_beta/apps/user/views/newpass.html are identical
Files elefant-elefant_1_3_9_beta/apps/user/views/recover.html and elefant-elefant_1_3_10_beta/apps/user/views/recover.html are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/views/role/add.html elefant-elefant_1_3_10_beta/apps/user/views/role/add.html
--- elefant-elefant_1_3_9_beta/apps/user/views/role/add.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/views/role/add.html	2014-12-03 23:59:25.000000000 -0600
@@ -19,6 +19,16 @@
 	<tr>
 		<td><input type="checkbox" name="resources[{{resource}}]" id="resources-{{resource|user\Filter::resource_id}}" value="on" /> <label for="resources-{{resource|user\Filter::resource_id}}" style="display: inline-block; width: 95%">{{label|__}}</label></td>
 	</tr>
+		{% if resource == 'user/edit_roles' %}
+		<tr>
+			<td  style="padding-left: 30px; height: 29px; line-height: 29px">{"Allowed roles"}:</td>
+		</tr>
+			{% foreach _roles as role %}
+			<tr>
+				<td style="padding-left: 30px"><input type="checkbox" name="resources[user/allowed_roles/{{role}}]" id="resources-user-allowed_roles-{{role}}" value="on" /> <label for="resources-allowed-roles-{{role}}" style="display: inline-block; width: 85%">{{role|ucfirst}}</label></td>
+			</tr>
+			{% end %}
+		{% end %}
 	{% end %}
 </table>
 </p>
@@ -37,7 +47,7 @@
 	// re-check on re-render
 	var resources = {{resources|json_encode}};
 	for (var resource in resources) {
-		$('#resources-' + resource.replace ('/', '-'))[0].checked = true;
+		$('#resources-' + resource.replace (/\//g, '-'))[0].checked = true;
 	}
 	
 	// check all if default is checked because
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/views/role/edit.html elefant-elefant_1_3_10_beta/apps/user/views/role/edit.html
--- elefant-elefant_1_3_9_beta/apps/user/views/role/edit.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/views/role/edit.html	2014-12-03 23:59:25.000000000 -0600
@@ -19,6 +19,16 @@
 	<tr>
 		<td><input type="checkbox" name="resources[{{resource}}]" id="resources-{{resource|user\Filter::resource_id}}" value="on" /> <label for="resources-{{resource|user\Filter::resource_id}}" style="display: inline-block; width: 95%">{{label|__}}</label></td>
 	</tr>
+		{% if resource == 'user/edit_roles' %}
+		<tr>
+			<td  style="padding-left: 30px; height: 29px; line-height: 29px">{"Allowed roles"}:</td>
+		</tr>
+			{% foreach _roles as role %}
+			<tr>
+				<td style="padding-left: 30px"><input type="checkbox" name="resources[user/allowed_roles/{{role}}]" id="resources-user-allowed_roles-{{role}}" value="on" /> <label for="resources-allowed-roles-{{role}}" style="display: inline-block; width: 85%">{{role|ucfirst}}</label></td>
+			</tr>
+			{% end %}
+		{% end %}
 	{% end %}
 </table>
 </p>
@@ -37,7 +47,7 @@
 	// re-check on re-render
 	var resources = {{resources|json_encode}};
 	for (var resource in resources) {
-		$('#resources-' + resource.replace ('/', '-'))[0].checked = true;
+		$('#resources-' + resource.replace (/\//g, '-'))[0].checked = true;
 	}
 	
 	// check all if default is checked because
Files elefant-elefant_1_3_9_beta/apps/user/views/roles.html and elefant-elefant_1_3_10_beta/apps/user/views/roles.html are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/views/settings.html elefant-elefant_1_3_10_beta/apps/user/views/settings.html
--- elefant-elefant_1_3_9_beta/apps/user/views/settings.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/views/settings.html	2014-12-03 23:59:25.000000000 -0600
@@ -9,6 +9,13 @@
 <input type="checkbox" name="login_twitter" id="login_twitter" value="yes"{% if login_twitter %} checked{% end %} /> {"Twitter"}<br />
 <input type="checkbox" name="login_persona" id="login_persona" value="yes"{% if login_persona %} checked{% end %} /> {"Persona"}<br />
 
+<p>{"Default member role"}:<br />
+<select name="default_role">
+{% foreach roles %}
+	<option value="{{ loop_value }}"{% if default_role === $data->loop_value %} selected {% end %}>{{ loop_value|ucfirst }}</option>
+{% end %}
+</select></p>
+
 <div id="facebook-info">
 
 <p>
Files elefant-elefant_1_3_9_beta/apps/user/views/sidebar.html and elefant-elefant_1_3_10_beta/apps/user/views/sidebar.html are identical
Files elefant-elefant_1_3_9_beta/apps/user/views/signup.html and elefant-elefant_1_3_10_beta/apps/user/views/signup.html are identical
diff -urBNs elefant-elefant_1_3_9_beta/apps/user/views/update.html elefant-elefant_1_3_10_beta/apps/user/views/update.html
--- elefant-elefant_1_3_9_beta/apps/user/views/update.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/apps/user/views/update.html	2014-12-03 23:59:25.000000000 -0600
@@ -2,7 +2,7 @@
 .notice { display: none; }
 </style>
 
-<form method="POST" id="update-form">
+<form method="POST" id="{{_form}}" enctype="multipart/form-data">
 <p>{"Your name"}:<br /><input type="text" name="name" size="40" value="{{ name }}" />
 <span class="notice" id="name-notice">{"You must enter a name."}</span></p>
 <p>{"Email address"}:<br /><input type="text" name="email" size="40" value="{{ email }}" />
@@ -11,28 +11,83 @@
 <span class="notice" id="password-notice">{"Your password must be at least 6 characters."}</span></p>
 <p>{"Verify new password"}:<br /><input type="password" name="verify_pass" size="20" value="{{ verify_pass }}" />
 <span class="notice" id="verify_pass-notice">{"Your password doesn't match."}</span></p>
-<p><input type="submit" value="{"Update Profile"}" /></p>
-</form>
 
-<script type="text/javascript" src="/js/jquery.verify_values.js"></script>
-<script type="text/javascript">
-$(function () {
-	$('#update-form').verify_values ({
-		handler: 'user/update',
-		callback: function (failed) {
-			// highlight the failed elements
-			for (var i = 0; i < failed.length; i++) {
-				$('#' + failed[i] + '-notice').show ();
-			}
-		},
-		reset: function (fields) {
-			for (var i = 0; i < fields.length; i++) {
-				$('#' + fields[i] + '-notice').hide ();
-			}
-		}
-	});
-	{% foreach failed %}
-	$('#{{ loop_value }}-notice').show ();
+<h2>{"About you"}</h2>
+
+<p>
+	{"Personal bio"}:<br />
+	<textarea cols="70" rows="5" name="about">{{ about }}</textarea>
+</p>
+
+<p>
+	{"Profile photo"}:<br />
+	{% if photo != '' %}
+	<img src="/{{photo}}#{{mt_rand()}}" style="width: {{Appconf::user ('User', 'photo_width')}}px; height: {{Appconf::user ('User', 'photo_height')}}px" /><br />
+	{% end %}
+	<input type="file" name="photo" id="photo" size="40" value="{{ photo|quotes }}" />
+</p>
+
+<p>
+	{"Website"}:<br />
+	<input type="text" name="website" size="40" value="{{ website|quotes }}" />
+</p>
+
+<p>
+	{"Company"}:<br />
+	<input type="text" name="company" size="40" value="{{ company|quotes }}" />
+</p>
+
+<p>
+	{"Job title"}:<br />
+	<input type="text" name="title" size="40" value="{{ title|quotes }}" />
+</p>
+
+<h2>{"Contact info"}</h2>
+
+<p>
+	{"Phone number"}:<br />
+	<input type="text" name="phone" size="30" value="{{ phone|quotes }}" />
+</p>
+
+<p>
+	{"Address"}:<br />
+	<input type="text" name="address" size="40" value="{{ address|quotes }}" />
+</p>
+
+<p>
+	{"Address line 2"}:<br />
+	<input type="text" name="address2" size="40" value="{{ address2|quotes }}" />
+</p>
+
+<p>
+	{"City"}:<br />
+	<input type="text" name="city" size="40" value="{{ city|quotes }}" />
+</p>
+
+<p>
+	{"State/province"}:<br />
+	<select name="state">
+		<option value="">{"- select -"}</option>
+	{% foreach _states as _state, _name %}
+		<option value="{{ _state|quotes }}"{% if state === $data->_state %} selected {% end %}>{{ _name|ucfirst }}</option>
+	{% end %}
+	</select>
+</p>
+
+<p>
+	{"Country"}:<br />
+	<select name="country">
+		<option value="">{"- select -"}</option>
+	{% foreach _countries as _country, _name %}
+		<option value="{{ _country|quotes }}"{% if country === $data->_country %} selected {% end %}>{{ _name|ucfirst }}</option>
 	{% end %}
-});
-</script>
+	</select>
+</p>
+
+<p>
+	{"Zip/postal code"}:<br />
+	<input type="text" name="zip" size="20" value="{{ zip|quotes }}" />
+</p>
+
+<p><input type="submit" value="{"Update Profile"}" /></p>
+</form>
Files elefant-elefant_1_3_9_beta/cache/.htaccess and elefant-elefant_1_3_10_beta/cache/.htaccess are identical
diff -urBNs elefant-elefant_1_3_9_beta/composer.json elefant-elefant_1_3_10_beta/composer.json
--- elefant-elefant_1_3_9_beta/composer.json	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/composer.json	2014-12-03 23:59:25.000000000 -0600
@@ -4,9 +4,9 @@
 	"keywords": ["cms", "content management", "wysiwyg", "elefant"],
 	"homepage": "http://www.elefantcms.com/",
 	"license": "MIT",
-	"version": "1.3.5-beta",
+	"version": "1.3.10-beta",
 	"require": {
-		"php": ">=5.3.2"
+		"php": ">=5.3.7"
 	},
 	"config": {
 		"process-timeout": 600,
Files elefant-elefant_1_3_9_beta/conf/.htaccess and elefant-elefant_1_3_10_beta/conf/.htaccess are identical
diff -urBNs elefant-elefant_1_3_9_beta/conf/acl.php elefant-elefant_1_3_10_beta/conf/acl.php
--- elefant-elefant_1_3_9_beta/conf/acl.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/conf/acl.php	2014-12-03 23:59:25.000000000 -0600
@@ -8,6 +8,7 @@
 
 default                 = Off
 admin                   = On
+admin/pages             = On
 admin/add               = On
 admin/edit              = On
 admin/delete            = On
@@ -22,4 +23,4 @@
 default                 = Off
 content/member          = On
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/conf/config.php elefant-elefant_1_3_10_beta/conf/config.php
--- elefant-elefant_1_3_9_beta/conf/config.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/conf/config.php	2014-12-03 23:59:25.000000000 -0600
@@ -61,6 +61,21 @@
 
 session_name = elefant_user
 
+; This can be set to a session save handler such as memcached
+; or redis, or the name of a class that implements SessionHandlerInterface.
+; The default is Off, which uses PHP's internal session handler.
+; Here are 3 example options:
+;
+; session_save_handler = "memcached:192.0.2.25:11211,192.0.2.26:11211"
+; session_save_handler = "redis:tcp://192.0.2.5:6379?timeout=0.5"
+; session_save_handler = SessionHandlerCookie
+;
+; The first two specify a session handler followed by a string that
+; session.save_path will be set to. The third uses the SessionHandlerCookie
+; class to store session data in an HMAC-verified cookie.
+
+session_save_handler = Off
+
 ; For development, turn debugging on and Elefant will output
 ; helpful information on errors.
 
@@ -193,6 +208,11 @@
 email_from = default
 email_name = default
 
+; If you are using the Resque app, set this to On and the mailer will
+; automatically queue outgoing messages for increased scalability and
+; responsiveness to end users.
+use_resque = Off
+
 ; To send using PHP's mail() function, use this:
 transport[type] = sendmail
 
diff -urBNs elefant-elefant_1_3_9_beta/conf/defaults.php elefant-elefant_1_3_10_beta/conf/defaults.php
--- elefant-elefant_1_3_9_beta/conf/defaults.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/conf/defaults.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,243 @@
+; <?php /* Global configurations go here
+
+[General]
+
+; The name of your website.
+site_name = "Your Site Name"
+
+; Default outbound email address.
+email_from = "you@example.com"
+
+; Default character set for output.
+
+charset = UTF-8
+
+; Default timezone for date functions.
+
+timezone = GMT
+
+; Default handler for requests to / and /(.*) that don't match
+; any other handler.
+
+default_handler = "admin/page"
+
+; Default layout template (aka theme) to use for page rendering.
+
+default_layout = "default"
+
+; Handler for errors, to be called by other handlers via
+; $controller->error() with 'code', 'title' and an optional
+; 'message' parameters.
+
+error_handler = "admin/error"
+
+; Whether to gzip output for browsers that support it.
+; This usually gives a noticeable performance boost.
+
+compress_output = On
+
+; Set this to 'flat' to have all pages appear at the top-level,
+; for example /about-us, /products. Set this to 'nested' to have
+; page URLs appear as they are in your navigation tree, for
+; example /products/flowbee/benefits. Default is flat.
+
+page_url_style = flat
+
+; The domain to set the session cookie for. If set to 'full'
+; (the default) it will set it to the full domain of the current
+; request, including subdomain. If set to 'top', it will set
+; the session cookie to '.domain.com' so that it will work
+; across subdomains of the site.
+
+session_domain = full
+
+; Session duration in seconds. Default is 2592000, or 30 days.
+; Set this to 0 for the session to expire when the user closes
+; their browser.
+
+session_duration = 2592000
+
+; The name of the session cookie.
+
+session_name = elefant_user
+
+; This can be set to a session save handler such as memcached
+; or redis, or the name of a class that implements SessionHandlerInterface.
+; The default is Off, which uses PHP's internal session handler.
+; Here are 3 example options:
+;
+; session_save_handler = "memcached:192.0.2.25:11211,192.0.2.26:11211"
+; session_save_handler = "redis:tcp://192.0.2.5:6379?timeout=0.5"
+; session_save_handler = SessionHandlerCookie
+;
+; The first two specify a session handler followed by a string that
+; session.save_path will be set to. The third uses the SessionHandlerCookie
+; class to store session data in an HMAC-verified cookie.
+
+session_save_handler = Off
+
+; For development, turn debugging on and Elefant will output
+; helpful information on errors.
+
+debug = Off
+
+; For development, turn display_errors on and Elefant will
+; output fatal error messages in addition to the debugger.
+
+display_errors = Off
+
+; Check for updates and display an update notice in the top bar
+; when new updates are available for the CMS.
+
+check_for_updates = On
+
+; Unique secret site key
+site_key = Elefant_Secret_Key
+
+[I18n]
+
+; Turn this on if your site is multilingual. This will change
+; the behaviour of the site navigation so that the appropriate
+; language's section of the site tree is shown, depending on
+; the user's language choice.
+
+multilingual = Off
+
+; This is the method for determining which language to show the
+; current visitor. Options are: url (e.g., /fr/), subdomain
+; (e.g., fr.example.com), http (uses Accept-Language header),
+; or cookie.
+
+negotiation_method = http
+
+[Paths]
+
+; The path to your navigation structure file.
+; Note: Leave the leading slash out of the path.
+
+navigation_json = conf/navigation.json
+
+; The path to your file uploads. Note: Leave
+; the leading and trailing slashes out of the path.
+
+filemanager_path = files
+
+; The path to your role definitions and their access
+; rules. Note: Leave the leading slash out of the
+; path.
+
+access_control_list = conf/acl.php
+
+[Database]
+
+; Database settings go here. Driver must be a valid PDO driver.
+; For examples of various database configurations, visit:
+; http://www.elefantcms.com/wiki/Database-configuration-examples
+
+master[driver] = sqlite
+master[file] = "conf/site.db"
+
+; The database table name prefix.
+
+prefix = "elefant_"
+
+[Mongo]
+
+; Settings to connect to MongoDB. Must have PHP Mongo extension
+; installed via `pecl install mongo`.
+
+;host = localhost:27017
+;user = username
+;pass = password
+;set_name = my_replica_set
+
+[Hooks]
+
+; This is a list of hooks in the system and associated handlers
+; to trigger when they occur. It's a good idea to name the hooks
+; you define after the handler they occur in, to make it easier
+; to look up the parameters they will receive.
+
+admin/edit[] = navigation/hook/edit
+admin/delete[] = navigation/hook/delete
+;admin/add[] = search/add
+;admin/edit[] = search/add
+;admin/delete[] = search/delete
+;blog/add[] = search/add
+;blog/edit[] = search/add
+;blog/delete[] = search/delete
+
+[Cache]
+
+; Configure your cache server list. This will be available in
+; your handlers via the $cache object. If blank, or cache
+; is unavailable, it will emulate Memcache via the lib/Cache
+; object, storing the cache in the `conf/datastore` folder.
+; Alternately add `backend = redis` to use Redis as the cache
+; backend, `backend = apc` to use APC as the cache backend, or
+; `backend = xcache` to use XCache as the cache backend.
+; Each of these cache options uses an identical API so you can
+; implement caching without worrying about the backend in
+; development versus production.
+;
+; Note: To use Redis auth, add the password after the port,
+; separated by a comma, e.g. "localhost:6379,PASSWORD"
+
+;backend = memcache
+;server[] = localhost:11211
+
+; Enable external cache control for the content.
+; If On, it will allow to inform frontend proxy to cache this response
+; and use it next "expires" seconds. Currently nginx as frontend proxy is
+; supported.
+control = Off
+
+; Sets when to expire the content in the external cache, if one is used.
+expires = 86400
+
+[Mailer]
+
+; This is where you configure your settings for sending emails.
+; Email sending is powered by the Zend Framework's Mail package.
+; For more info on the configuration options for the various
+; transport methods here, see:
+; http://framework.zend.com/manual/en/zend.mail.html
+
+; To override the default email from info in the
+; global config file, edit these:
+email_from = default
+email_name = default
+
+; If you are using the Resque app, set this to On and the mailer will
+; automatically queue outgoing messages for increased scalability and
+; responsiveness to end users.
+use_resque = Off
+
+; To send using PHP's mail() function, use this:
+transport[type] = sendmail
+
+; To send using an SMTP server, use this:
+;transport[type] = smtp
+;transport[host] = 127.0.0.1
+;transport[name] = localhost
+
+; To add TLS-based encryption to the SMTP connection:
+;transport[ssl]  = tls
+;transport[port] = 25
+
+; To add SSL-based encryption to the SMTP connection:
+;transport[ssl]  = ssl
+;transport[port] = 465
+
+; To add authentication to the SMTP connection:
+;transport[auth] = plain
+;transport[auth] = login
+;transport[auth] = crammd5
+;transport[username] = username
+;transport[password] = password
+
+; To send to a file in conf/mailer, use this:
+;transport[type] = file
+;transport[folder] = cache/mailer
+
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/conf/install_mysql.sql elefant-elefant_1_3_10_beta/conf/install_mysql.sql
--- elefant-elefant_1_3_9_beta/conf/install_mysql.sql	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/conf/install_mysql.sql	2014-12-03 23:59:25.000000000 -0600
@@ -38,6 +38,18 @@
 	signed_up datetime not null,
 	updated datetime not null,
 	userdata text not null,
+	phone char(32) not null default '',
+	address char(48) not null default '',
+	address2 char(48) not null default '',
+	city char(48) not null default '',
+	state char(3) not null default '',
+	country char(3) not null default '',
+	zip char(16) not null default '',
+	title char(48) not null default '',
+	company char(48) not null default '',
+	photo char(128) not null default '',
+	about text not null,
+	website char(128) not null default '',
 	index(email, password),
 	index(session_id)
 ) default charset=utf8;
@@ -49,6 +61,24 @@
 	user_id int not null
 ) default charset=utf8;
 
+create table #prefix#user_links (
+	id int not null auto_increment primary key,
+	user_id int not null,
+	service char(32) not null default '',
+	handle char(72) not null,
+	index (user_id, service)
+);
+
+create table #prefix#user_notes (
+	id int not null auto_increment primary key,
+	user_id int not null,
+	ts datetime not null,
+	made_by int not null,
+	note text not null,
+	index (user_id, ts),
+	index (made_by, ts)
+);
+
 create table #prefix#versions (
 	id int not null auto_increment primary key,
 	class char(72) not null,
@@ -73,10 +103,11 @@
 	title char(72) not null,
 	ts datetime not null,
 	author char(32) not null,
-	published enum('yes','no') not null,
+	published enum('yes','no','que') not null,
 	body text not null,
 	tags text not null,
 	extra text not null,
+	thumbnail char(128) not null default '',
 	index (ts),
 	index (ts, published)
 ) default charset=utf8;
@@ -115,8 +146,8 @@
 	version char(16) not null
 ) default charset=utf8;
 
-insert into #prefix#apps (name, version) values ('elefant', '1.3.6');
-insert into #prefix#apps (name, version) values ('blog', '1.1.3-stable');
+insert into #prefix#apps (name, version) values ('elefant', '1.3.10');
+insert into #prefix#apps (name, version) values ('blog', '1.1.4-stable');
 insert into #prefix#apps (name, version) values ('user', '1.1.3-stable');
 insert into #prefix#apps (name, version) values ('filemanager', '1.3.0-beta');
 
diff -urBNs elefant-elefant_1_3_9_beta/conf/install_pgsql.sql elefant-elefant_1_3_10_beta/conf/install_pgsql.sql
--- elefant-elefant_1_3_9_beta/conf/install_pgsql.sql	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/conf/install_pgsql.sql	2014-12-03 23:59:25.000000000 -0600
@@ -45,7 +45,19 @@
 	type varchar(32) not null,
 	signed_up timestamp not null,
 	updated timestamp not null,
-	userdata text not null
+	userdata text not null,
+	phone char(32) not null default '',
+	address char(48) not null default '',
+	address2 char(48) not null default '',
+	city char(48) not null default '',
+	state char(3) not null default '',
+	country char(3) not null default '',
+	zip char(16) not null default '',
+	title char(48) not null default '',
+	company char(48) not null default '',
+	photo char(128) not null default '',
+	about text not null default '',
+	website char(128) not null default ''
 );
 
 create index #prefix#user_email_password on #prefix#user (email, password);
@@ -58,6 +70,30 @@
 	user_id integer not null
 );
 
+create sequence #prefix#user_links_seq;
+
+create table #prefix#user_links (
+	id integer not null default nextval('#prefix#user_links_seq') primary key,
+	user_id int not null,
+	service char(32) not null default '',
+	handle char(72) not null
+);
+
+create index #prefix#user_links_user on #prefix#user_links (user_id, service);
+
+create sequence #prefix#user_notes_seq;
+
+create table #prefix#user_notes (
+	id integer not null default nextval('#prefix#user_notes_seq') primary key,
+	user_id int not null,
+	ts timestamp not null,
+	made_by int not null,
+	note text not null
+);
+
+create index #prefix#user_notes_user on #prefix#user_notes (user_id, ts);
+create index #prefix#user_notes_made_by on #prefix#user_notes (made_by, ts);
+
 create sequence #prefix#versions_id_seq;
 
 create table #prefix#versions (
@@ -92,7 +128,8 @@
 	body text not null,
 	tags text not null,
 	extra text not null,
-	check (published in ('yes', 'no'))
+	thumbnail char(128) not null default '',
+	check (published in ('yes', 'no', 'que'))
 );
 
 create index #prefix#blog_post_ts on #prefix#blog_post (ts);
@@ -135,8 +172,8 @@
 	version varchar(16) not null
 );
 
-insert into #prefix#apps (name, version) values ('elefant', '1.3.6');
-insert into #prefix#apps (name, version) values ('blog', '1.1.3-stable');
+insert into #prefix#apps (name, version) values ('elefant', '1.3.10');
+insert into #prefix#apps (name, version) values ('blog', '1.1.4-stable');
 insert into #prefix#apps (name, version) values ('user', '1.1.3-stable');
 insert into #prefix#apps (name, version) values ('filemanager', '1.3.0-beta');
 
diff -urBNs elefant-elefant_1_3_9_beta/conf/install_sqlite.sql elefant-elefant_1_3_10_beta/conf/install_sqlite.sql
--- elefant-elefant_1_3_9_beta/conf/install_sqlite.sql	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/conf/install_sqlite.sql	2014-12-03 23:59:25.000000000 -0600
@@ -39,7 +39,19 @@
 	type char(32) not null,
 	signed_up datetime not null,
 	updated datetime not null,
-	userdata text not null
+	userdata text not null,
+	phone char(32) not null default '',
+	address char(48) not null default '',
+	address2 char(48) not null default '',
+	city char(48) not null default '',
+	state char(3) not null default '',
+	country char(3) not null default '',
+	zip char(16) not null default '',
+	title char(48) not null default '',
+	company char(48) not null default '',
+	photo char(128) not null default '',
+	about text not null default '',
+	website char(128) not null default ''
 );
 
 create index #prefix#user_email_password on #prefix#user (email, password);
@@ -52,6 +64,26 @@
 	user_id int not null
 );
 
+create table #prefix#user_links (
+	id integer primary key,
+	user_id int not null,
+	service char(32) not null default '',
+	handle char(72) not null
+);
+
+create index #prefix#user_links_user on #prefix#user_links (user_id, service);
+
+create table #prefix#user_notes (
+	id integer primary key,
+	user_id int not null,
+	ts datetime not null,
+	made_by int not null,
+	note text not null
+);
+
+create index #prefix#user_notes_user on #prefix#user_notes (user_id, ts);
+create index #prefix#user_notes_made_by on #prefix#user_notes (made_by, ts);
+
 create table #prefix#versions (
 	id integer primary key,
 	class char(72) not null,
@@ -81,7 +113,8 @@
 	published char(3) not null,
 	body text not null,
 	tags text not null,
-	extra text not null
+	extra text not null,
+	thumbnail char(128) not null default ''
 );
 
 create index #prefix#blog_post_ts on #prefix#blog_post (ts);
@@ -123,8 +156,8 @@
 	version char(16) not null
 );
 
-insert into #prefix#apps (name, version) values ('elefant', '1.3.6');
-insert into #prefix#apps (name, version) values ('blog', '1.1.3-stable');
+insert into #prefix#apps (name, version) values ('elefant', '1.3.10');
+insert into #prefix#apps (name, version) values ('blog', '1.1.4-stable');
 insert into #prefix#apps (name, version) values ('user', '1.1.3-stable');
 insert into #prefix#apps (name, version) values ('filemanager', '1.3.0-beta');
 
Files elefant-elefant_1_3_9_beta/conf/navigation.json and elefant-elefant_1_3_10_beta/conf/navigation.json are identical
Files elefant-elefant_1_3_9_beta/conf/package.xml and elefant-elefant_1_3_10_beta/conf/package.xml are identical
diff -urBNs elefant-elefant_1_3_9_beta/conf/product.php elefant-elefant_1_3_10_beta/conf/product.php
--- elefant-elefant_1_3_9_beta/conf/product.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/conf/product.php	2014-12-03 23:59:25.000000000 -0600
@@ -6,5 +6,6 @@
 logo_toolbar = "/apps/admin/css/admin/elefant_logo.png"
 stylesheet = "/apps/admin/css/admin.css"
 toolbar_stylesheet = "/apps/admin/css/top-bar.css"
+admin_layout = admin
 
-; */ ?>
\ No newline at end of file
+; */ ?>
Files elefant-elefant_1_3_9_beta/conf/site.db and elefant-elefant_1_3_10_beta/conf/site.db are identical
Files elefant-elefant_1_3_9_beta/conf/test.php and elefant-elefant_1_3_10_beta/conf/test.php are identical
diff -urBNs elefant-elefant_1_3_9_beta/conf/tools.php elefant-elefant_1_3_10_beta/conf/tools.php
--- elefant-elefant_1_3_9_beta/conf/tools.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/conf/tools.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,22 @@
+; <?php /*
+
+[Content]
+
+admin/pages = Web Pages
+blog/admin = Blog Posts
+blocks/admin = Content Blocks
+filemanager/index = Files
+
+[Administration]
+
+user/admin = Members
+navigation/admin = Navigation
+designer/admin = Designer
+translator/index = Languages
+admin/versions = Versions
+
+[Extras]
+
+* = *
+
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/conf/version.php elefant-elefant_1_3_10_beta/conf/version.php
--- elefant-elefant_1_3_9_beta/conf/version.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/conf/version.php	2014-12-03 23:59:25.000000000 -0600
@@ -1 +1 @@
-<?php define ('ELEFANT_VERSION', '1.3.9'); ?>
\ No newline at end of file
+<?php define ('ELEFANT_VERSION', '1.3.10');
Files elefant-elefant_1_3_9_beta/css/960.css and elefant-elefant_1_3_10_beta/css/960.css are identical
Files elefant-elefant_1_3_9_beta/css/960_compiled.css and elefant-elefant_1_3_10_beta/css/960_compiled.css are identical
Files elefant-elefant_1_3_9_beta/css/mobile.css and elefant-elefant_1_3_10_beta/css/mobile.css are identical
Files elefant-elefant_1_3_9_beta/css/print.css and elefant-elefant_1_3_10_beta/css/print.css are identical
Files elefant-elefant_1_3_9_beta/css/reset.css and elefant-elefant_1_3_10_beta/css/reset.css are identical
Files elefant-elefant_1_3_9_beta/css/style.css and elefant-elefant_1_3_10_beta/css/style.css are identical
Files elefant-elefant_1_3_9_beta/css/text.css and elefant-elefant_1_3_10_beta/css/text.css are identical
Files elefant-elefant_1_3_9_beta/elefant and elefant-elefant_1_3_10_beta/elefant are identical
Files elefant-elefant_1_3_9_beta/favicon.ico and elefant-elefant_1_3_10_beta/favicon.ico are identical
Files elefant-elefant_1_3_9_beta/files/.htaccess and elefant-elefant_1_3_10_beta/files/.htaccess are identical
Files elefant-elefant_1_3_9_beta/files/design/bg.png and elefant-elefant_1_3_10_beta/files/design/bg.png are identical
Files elefant-elefant_1_3_9_beta/files/homepage/photo1.jpg and elefant-elefant_1_3_10_beta/files/homepage/photo1.jpg are identical
Files elefant-elefant_1_3_9_beta/files/homepage/photo2.jpg and elefant-elefant_1_3_10_beta/files/homepage/photo2.jpg are identical
Files elefant-elefant_1_3_9_beta/files/homepage/photo3.jpg and elefant-elefant_1_3_10_beta/files/homepage/photo3.jpg are identical
Files elefant-elefant_1_3_9_beta/files/homepage/photo4.jpg and elefant-elefant_1_3_10_beta/files/homepage/photo4.jpg are identical
diff -urBNs elefant-elefant_1_3_9_beta/index.php elefant-elefant_1_3_10_beta/index.php
--- elefant-elefant_1_3_9_beta/index.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/index.php	2014-12-03 23:59:25.000000000 -0600
@@ -29,6 +29,6 @@
  * are sent here to be handled and served.
  */
 require 'lib/FrontController.php';
-FrontController::run ($argv);
-
-?>
\ No newline at end of file
+$argc = isset ($argc) ? $argc : null;
+$argv = isset ($argv) ? $argv : null;
+return FrontController::run ($argv, $argc);
Files elefant-elefant_1_3_9_beta/install/cache/.htaccess and elefant-elefant_1_3_10_beta/install/cache/.htaccess are identical
Files elefant-elefant_1_3_9_beta/install/css/style.css and elefant-elefant_1_3_10_beta/install/css/style.css are identical
Files elefant-elefant_1_3_9_beta/install/css/title.png and elefant-elefant_1_3_10_beta/install/css/title.png are identical
diff -urBNs elefant-elefant_1_3_9_beta/install/index.php elefant-elefant_1_3_10_beta/install/index.php
--- elefant-elefant_1_3_9_beta/install/index.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/install/index.php	2014-12-03 23:59:25.000000000 -0600
@@ -238,5 +238,3 @@
 echo '<br clear="both" />';
 info ($data);
 //*/
-
-?>
\ No newline at end of file
Files elefant-elefant_1_3_9_beta/install/layouts/database.html and elefant-elefant_1_3_10_beta/install/layouts/database.html are identical
Files elefant-elefant_1_3_9_beta/install/layouts/dbinfo.html and elefant-elefant_1_3_10_beta/install/layouts/dbinfo.html are identical
Files elefant-elefant_1_3_9_beta/install/layouts/finished.html and elefant-elefant_1_3_10_beta/install/layouts/finished.html are identical
Files elefant-elefant_1_3_9_beta/install/layouts/introduction.html and elefant-elefant_1_3_10_beta/install/layouts/introduction.html are identical
Files elefant-elefant_1_3_9_beta/install/layouts/license.html and elefant-elefant_1_3_10_beta/install/layouts/license.html are identical
Files elefant-elefant_1_3_9_beta/install/layouts/requirements.html and elefant-elefant_1_3_10_beta/install/layouts/requirements.html are identical
Files elefant-elefant_1_3_9_beta/install/layouts/settings.html and elefant-elefant_1_3_10_beta/install/layouts/settings.html are identical
Files elefant-elefant_1_3_9_beta/js/jquery-1.8.3.min.js and elefant-elefant_1_3_10_beta/js/jquery-1.8.3.min.js are identical
Files elefant-elefant_1_3_9_beta/js/jquery-ui/images/ui-bg_flat_0_aaaaaa_40x100.png and elefant-elefant_1_3_10_beta/js/jquery-ui/images/ui-bg_flat_0_aaaaaa_40x100.png are identical
Files elefant-elefant_1_3_9_beta/js/jquery-ui/images/ui-bg_flat_75_ffffff_40x100.png and elefant-elefant_1_3_10_beta/js/jquery-ui/images/ui-bg_flat_75_ffffff_40x100.png are identical
Files elefant-elefant_1_3_9_beta/js/jquery-ui/images/ui-bg_glass_55_fbf9ee_1x400.png and elefant-elefant_1_3_10_beta/js/jquery-ui/images/ui-bg_glass_55_fbf9ee_1x400.png are identical
Files elefant-elefant_1_3_9_beta/js/jquery-ui/images/ui-bg_glass_65_ffffff_1x400.png and elefant-elefant_1_3_10_beta/js/jquery-ui/images/ui-bg_glass_65_ffffff_1x400.png are identical
Files elefant-elefant_1_3_9_beta/js/jquery-ui/images/ui-bg_glass_75_dadada_1x400.png and elefant-elefant_1_3_10_beta/js/jquery-ui/images/ui-bg_glass_75_dadada_1x400.png are identical
Files elefant-elefant_1_3_9_beta/js/jquery-ui/images/ui-bg_glass_75_e6e6e6_1x400.png and elefant-elefant_1_3_10_beta/js/jquery-ui/images/ui-bg_glass_75_e6e6e6_1x400.png are identical
Files elefant-elefant_1_3_9_beta/js/jquery-ui/images/ui-bg_glass_95_fef1ec_1x400.png and elefant-elefant_1_3_10_beta/js/jquery-ui/images/ui-bg_glass_95_fef1ec_1x400.png are identical
Files elefant-elefant_1_3_9_beta/js/jquery-ui/images/ui-bg_highlight-soft_75_cccccc_1x100.png and elefant-elefant_1_3_10_beta/js/jquery-ui/images/ui-bg_highlight-soft_75_cccccc_1x100.png are identical
Files elefant-elefant_1_3_9_beta/js/jquery-ui/images/ui-icons_222222_256x240.png and elefant-elefant_1_3_10_beta/js/jquery-ui/images/ui-icons_222222_256x240.png are identical
Files elefant-elefant_1_3_9_beta/js/jquery-ui/images/ui-icons_2e83ff_256x240.png and elefant-elefant_1_3_10_beta/js/jquery-ui/images/ui-icons_2e83ff_256x240.png are identical
Files elefant-elefant_1_3_9_beta/js/jquery-ui/images/ui-icons_454545_256x240.png and elefant-elefant_1_3_10_beta/js/jquery-ui/images/ui-icons_454545_256x240.png are identical
Files elefant-elefant_1_3_9_beta/js/jquery-ui/images/ui-icons_888888_256x240.png and elefant-elefant_1_3_10_beta/js/jquery-ui/images/ui-icons_888888_256x240.png are identical
Files elefant-elefant_1_3_9_beta/js/jquery-ui/images/ui-icons_cd0a0a_256x240.png and elefant-elefant_1_3_10_beta/js/jquery-ui/images/ui-icons_cd0a0a_256x240.png are identical
Files elefant-elefant_1_3_9_beta/js/jquery-ui/jquery-ui.css and elefant-elefant_1_3_10_beta/js/jquery-ui/jquery-ui.css are identical
Files elefant-elefant_1_3_9_beta/js/jquery-ui/jquery-ui.min.js and elefant-elefant_1_3_10_beta/js/jquery-ui/jquery-ui.min.js are identical
Files elefant-elefant_1_3_9_beta/js/jquery.autosave.js and elefant-elefant_1_3_10_beta/js/jquery.autosave.js are identical
Files elefant-elefant_1_3_9_beta/js/jquery.bgsave.js and elefant-elefant_1_3_10_beta/js/jquery.bgsave.js are identical
Files elefant-elefant_1_3_9_beta/js/jquery.cookie.js and elefant-elefant_1_3_10_beta/js/jquery.cookie.js are identical
Files elefant-elefant_1_3_9_beta/js/jquery.localize.min.js and elefant-elefant_1_3_10_beta/js/jquery.localize.min.js are identical
Files elefant-elefant_1_3_9_beta/js/jquery.password_strength.js and elefant-elefant_1_3_10_beta/js/jquery.password_strength.js are identical
Files elefant-elefant_1_3_9_beta/js/jquery.quickpager.js and elefant-elefant_1_3_10_beta/js/jquery.quickpager.js are identical
Files elefant-elefant_1_3_9_beta/js/jquery.verify_values.js and elefant-elefant_1_3_10_beta/js/jquery.verify_values.js are identical
Files elefant-elefant_1_3_9_beta/js/json2.js and elefant-elefant_1_3_10_beta/js/json2.js are identical
Files elefant-elefant_1_3_9_beta/js/jstorage.js and elefant-elefant_1_3_10_beta/js/jstorage.js are identical
Files elefant-elefant_1_3_9_beta/js/urlify.js and elefant-elefant_1_3_10_beta/js/urlify.js are identical
diff -urBNs elefant-elefant_1_3_9_beta/lang/cs.php elefant-elefant_1_3_10_beta/lang/cs.php
--- elefant-elefant_1_3_9_beta/lang/cs.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lang/cs.php	2014-12-03 23:59:25.000000000 -0600
@@ -512,4 +512,3 @@
 	'Save event' => 'Uložit událost',
 	'Edit Event' => 'Upravit událost'
 );
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lang/de.php elefant-elefant_1_3_10_beta/lang/de.php
--- elefant-elefant_1_3_9_beta/lang/de.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lang/de.php	2014-12-03 23:59:25.000000000 -0600
@@ -742,5 +742,3 @@
 	'Modify translations and language settings' => 'Übersetzungen und Spracheinstellungen wurden geändert',
 	'Translated' => 'übersetzt'
 );
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lang/en.php elefant-elefant_1_3_10_beta/lang/en.php
--- elefant-elefant_1_3_9_beta/lang/en.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lang/en.php	2014-12-03 23:59:25.000000000 -0600
@@ -3,5 +3,3 @@
 $this->lang_hash['en'] = array (
 	'Home' => 'Home'
 );
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lang/fr.php elefant-elefant_1_3_10_beta/lang/fr.php
--- elefant-elefant_1_3_9_beta/lang/fr.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lang/fr.php	2014-12-03 23:59:25.000000000 -0600
@@ -76,8 +76,8 @@
 	'Changed on' => 'Changé le',
 	'Charset' => 'Charset',
 	'String not found.' => 'Chaîne non trouvée.',
-	'Invalid Path' => 'Chemin non valide',
 	'Invalid path' => 'Chemin non valide',
+	'Invalid Path' => 'Chemin non valide',
 	'Choose' => 'Choisir',
 	'Choose a file' => 'Choisir un fichier',
 	'Choose a new password' => 'Choisir un nouveau mot de passe',
@@ -121,12 +121,14 @@
 	'Date/Time' => 'Date/Heure',
 	'Fallback' => 'De repli',
 	'Latest Posts' => 'Derniers Messages',
-	'Last modified' => 'Dernière mise à jour',
 	'Last Modified' => 'Dernière mise à jour',
+	'Last modified' => 'Dernière mise à jour',
 	'Last changed' => 'Dernière modification',
 	'Auto-saved data found for this form.' => 'Des données d&apos;auto-enregistrés a été trouvée pour cette forme.',
 	'Auto-saved data found.' => 'Des données d&apos;auto-enregistrés a été trouvée.',
 	'Description' => 'Description',
+	'Sun Mon Tue Wed Thu Fri Sat' => 'Dim Lun Mar Mer Jeu Ven Sam',
+	'Sunday Monday Tuesday Wednesday Thursday Friday Saturday' => 'Dimanche Lundi Mardi Mercredi Jeudi Vendredi Samedi',
 	'Disqus' => 'Disqus',
 	'Folder' => 'Dossier',
 	'Folder created.' => 'Dossier créé.',
@@ -242,8 +244,8 @@
 	'Unable to parse the uploaded file.' => 'Impossible d&apos;analyser le fichier téléchargé.',
 	'Saving Stylesheet Failed' => 'Impossible d&apos;enregistrer la feuille de style',
 	'Saving Layout Failed' => 'Impossible d&apos;enregistrer la mise en page',
-	'Unable to save the file' => 'Impossible d&apos;enregistrer le fichier',
 	'Failed to save file' => 'Impossible d&apos;enregistrer le fichier',
+	'Unable to save the file' => 'Impossible d&apos;enregistrer le fichier',
 	'Unable to save the file.' => 'Impossible d&apos;enregistrer le fichier.',
 	'Unable to save changes. Check your folder permissions and try again.' => 'Impossible d&apos;enregistrer les changements. Vérifiez les permissions du dossier et réessayez.',
 	'Failed to save...' => 'Impossible d&apos;enregistrer...',
@@ -330,8 +332,8 @@
 	'.htaccess file is missing from the site root. Please save the following file to your server:' => 'Le fichier .htaccess est absent de la racine du site. Veuillez enregistrez le fichier suivant sur votre serveur :',
 	'Uploaded CSV file not found.' => 'Le fichier CSV téléchargé n&apos;est pas trouvé.',
 	'Configuration file not found.' => 'Le fichier de configuration ne trouve pas.',
-	'File Already Exists' => 'Le fichier existe déjà',
 	'File already exists' => 'Le fichier existe déjà',
+	'File Already Exists' => 'Le fichier existe déjà',
 	'The file was only partially uploaded.' => 'Le fichier n&apos;a été que partiellement envoyé.',
 	'The following file is too large to upload' => 'Le fichier suivant est trop gros pour être envoyé',
 	'The link appears to be invalid.' => 'Le lien semble être invalide.',
@@ -365,20 +367,20 @@
 	'Member' => 'Membre',
 	'Members' => 'Membres',
 	'Thanks for using Elefant!' => 'Merci d&apos;utiliser Elefant !',
-	'Error message' => 'Message d&apos;erreur',
 	'Error Message' => 'Message d&apos;erreur',
+	'Error message' => 'Message d&apos;erreur',
 	'Blog Posts' => 'Messages blog',
 	'Minutes' => 'Minutes',
 	'Minutes, zero-padded' => 'Minutes, complétées par des zéros',
-	'Page layout' => 'Mise en page',
 	'Layout' => 'Mise en page',
+	'Page layout' => 'Mise en page',
 	'Layout added.' => 'Mise en page ajouté.',
 	'Post page layout' => 'Mise en page du billet',
 	'Default layout updated.' => 'Mise en page par défaut mise à jour.',
 	'Layout saved.' => 'Mise en page sauvé.',
 	'Upgrading Files App' => 'Mise à jour des fichiers de l&apos;application',
-	'Profile Updated' => 'Mise à jour le profil',
 	'Update Profile' => 'Mise à jour le profil',
+	'Profile Updated' => 'Mise à jour le profil',
 	'Upgrade completed' => 'Mise à niveau complete',
 	'Upgrading Blog App' => 'Mise à niveau de l&apos;App Blog',
 	'Upgrading User App' => 'Mise à niveau de l&apos;App Utilisateur',
@@ -413,8 +415,8 @@
 	'Password does not match.' => 'Mot de passe ne correspond pas.',
 	'Very strong password' => 'Mot de passe très fort',
 	'Tags' => 'Mots-clés',
-	'Keywords (comma-separated)' => 'Mots-clés (séparés par virgules)',
 	'Tags (comma-separated)' => 'Mots-clés (séparés par virgules)',
+	'Keywords (comma-separated)' => 'Mots-clés (séparés par virgules)',
 	'Login methods' => 'Méthodes de connexion',
 	'Browsers' => 'Navigateurs',
 	'Navigation' => 'Navigation',
@@ -540,16 +542,16 @@
 	'Submit' => 'Soumettre',
 	'Source' => 'Source',
 	'Next' => 'Suivant',
-	'Unlink' => 'Supprimer',
 	'Delete' => 'Supprimer',
+	'Unlink' => 'Supprimer',
 	'Delete Page' => 'Supprimer la page',
 	'Delete Block' => 'Supprimer le bloc',
 	'Delete content' => 'Supprimer le contenu',
 	'Date formatting reference' => 'Syntaxe pour les formats de date',
 	'Drop down' => 'Sélecteur',
 	'Select' => 'Sélectionner',
-	'File Size' => 'Taille du fichier',
 	'File size' => 'Taille du fichier',
+	'File Size' => 'Taille du fichier',
 	'Temporary' => 'Temporaire',
 	'Too many login attempts' => 'Tentatives de connexion trop nombreuses',
 	'Finish importing' => 'Termine l&apos;importation',
@@ -563,8 +565,8 @@
 	'Block title' => 'Titre du bloc',
 	'Blog title' => 'Titre du blog',
 	'All tags' => 'Toutes les balises',
-	'All pages' => 'Toutes les pages',
 	'All Pages' => 'Toutes les pages',
+	'All pages' => 'Toutes les pages',
 	'Translated' => 'Traduit',
 	'Too weak' => 'Trop faible',
 	'Twitter' => 'Twitter',
@@ -631,8 +633,8 @@
 	'You do not have enough access privileges for this operation.' => 'Vous n&apos;avez pas les permissions pour cette opération.',
 	'True' => 'Vrai',
 	'Invalid Verifier' => 'Vérificateur non valide',
-	'Verify Password' => 'Vérifiez le mot de passe',
 	'Verify password' => 'Vérifiez le mot de passe',
+	'Verify Password' => 'Vérifiez le mot de passe',
 	'Verify new password' => 'Vérifiez le nouveau mot de passe',
 	'Check that your permissions are correct and try again.' => 'Vérifiez que vos autorisations sont correctes et essayez à nouveau.',
 	'Check your inbox' => 'Vérifiez votre boîte de réception',
@@ -664,5 +666,3 @@
 	'Are you sure you want to delete this {{appname}}?' => 'Êtes-vous sûr de vouloir supprimer ce {{appname}} ?',
 	'Are you sure you want to delete the default block? This will remove it from all pages using this block' => 'Êtes-vous sûr de vouloir supprimer le bloc par défaut ? Il sera supprimé dans toutes les pages qui l&apos;utilisent'
 );
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lang/it.php elefant-elefant_1_3_10_beta/lang/it.php
--- elefant-elefant_1_3_9_beta/lang/it.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lang/it.php	2014-12-03 23:59:25.000000000 -0600
@@ -561,6 +561,4 @@
 	'Admin access required.' => 'È richiesto l\'accesso amministrativo ',
 	'An email has been sent with a link to reset your password.' => 'È stata inviata una email con un link per annullare la password.',
 	'is required' => 'è richiesto'
-);                                      
-
-?>
+);
diff -urBNs elefant-elefant_1_3_9_beta/lang/ja.php elefant-elefant_1_3_10_beta/lang/ja.php
--- elefant-elefant_1_3_9_beta/lang/ja.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lang/ja.php	2014-12-03 23:59:25.000000000 -0600
@@ -459,5 +459,3 @@
 	'Add Item' => '項目追加',
 	'by' => '：'
 );
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lang/languages.php elefant-elefant_1_3_10_beta/lang/languages.php
--- elefant-elefant_1_3_9_beta/lang/languages.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lang/languages.php	2014-12-03 23:59:25.000000000 -0600
@@ -120,4 +120,4 @@
 fallback                = Off
 default                 = Off
 
-; */ ?>
\ No newline at end of file
+; */ ?>
diff -urBNs elefant-elefant_1_3_9_beta/lang/new_lang.php elefant-elefant_1_3_10_beta/lang/new_lang.php
--- elefant-elefant_1_3_9_beta/lang/new_lang.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lang/new_lang.php	2014-12-03 23:59:25.000000000 -0600
@@ -380,5 +380,3 @@
 	'official blog' => '',
 	'results' => ''
 );
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lang/nl.php elefant-elefant_1_3_10_beta/lang/nl.php
--- elefant-elefant_1_3_9_beta/lang/nl.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lang/nl.php	2014-12-03 23:59:25.000000000 -0600
@@ -385,5 +385,3 @@
 	'lang folder is not writeable. Please run:</p><p><tt>chmod -R 775 cache conf css files lang layouts</tt>' => 'lang map is niet beschrijfbaar. Run aub </p><p><tt>chmod -R 775 cache conf css files lang layouts</tt>',
 	'layouts folder is not writeable. Please run:</p><p><tt>chmod -R 775 cache conf css files lang layouts</tt>' => 'layouts map is niet beschrijfbaar. Run aub </p><p><tt>chmod -R 775 cache conf css files lang layouts</tt>'
 );
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lang/pt_br.php elefant-elefant_1_3_10_beta/lang/pt_br.php
--- elefant-elefant_1_3_9_beta/lang/pt_br.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lang/pt_br.php	2014-12-03 23:59:25.000000000 -0600
@@ -424,5 +424,3 @@
 	'Site tree' => 'árvore do local',
 	'Building index' => 'índice de construção'
 );
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lang/ru.php elefant-elefant_1_3_10_beta/lang/ru.php
--- elefant-elefant_1_3_9_beta/lang/ru.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lang/ru.php	2014-12-03 23:59:25.000000000 -0600
@@ -559,5 +559,3 @@
 	'Zip file installation failed' => 'Установка zip-архива не удалась',
 	'Zip file was invalid or could not be installed.' => 'Zip-архив бракованный и не может быть установлен.'
 );
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lang/sl_si.php elefant-elefant_1_3_10_beta/lang/sl_si.php
--- elefant-elefant_1_3_9_beta/lang/sl_si.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lang/sl_si.php	2014-12-03 23:59:25.000000000 -0600
@@ -494,5 +494,3 @@
 	'Weak password' => 'Šibko geslo',
 	'You must enter a valid email, or your email may already be registered.' => 'Že uporabljen ali neveljaven email.'
 );
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lang/uk.php elefant-elefant_1_3_10_beta/lang/uk.php
--- elefant-elefant_1_3_9_beta/lang/uk.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lang/uk.php	2014-12-03 23:59:25.000000000 -0600
@@ -2,6 +2,4 @@
 
 $this->lang_hash['uk'] = array (
 	'Nobody' => '(ніхто)',	'Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec' => '01 02 03 04 05 06 07 08 09 10 11 12',	'Rebuilding index' => 'Іде переіндексування',	'Block ID' => 'Ідентифікатор блоку',	'Page ID' => 'Ідентифікатор сторінкт',	'Name' => 'Імя',	'No name specified' => 'Імя не задано',	'Indexing completed' => 'Індексацію закінчено',	'Tools' => 'Інструменти',	'Other versions' => 'Інші версії',	'Other pages' => 'Інші сторінки',	'Auto-saved data found for this form.' => 'Авто-збереженні данні знайдено для цієї форми.',	'Author' => 'Автор',	'Alternate window title' => 'Альтернативний заголовок вікна',	'Alternate menu title' => 'Альтернативний заголовок меню',	'Blocks' => 'Блоки',	'Please enter the language code.' => 'Будь-ласка введіть код мови.',	'Please enter the name of the language.' => 'Будь-ласка ввеліть назву мови.',	'Please try again later.' => 'Будь-ласка повторіть пізніше.',	'Please confirm your email address' => 'Будь-ласка підтвердіть вашу поштову адресу',	'Please log in to continue.' => 'Будь-ласка, увійдіть для продовження.',	'Alphabetical' => 'В алфавітному порядку',	'Your ID must be a lowercase alphanumeric value and can\'t already exist.' => 'Ваш ідентифікатор повинен буди введено латиницею (малими літерами) та не повинен існувати.',	'Your ID must be a lowercase alphanumeric value.' => 'Ваш ідентифікатор повинен буди введено латиницею (малими літерами) та не повинен існувати.',	'Your ID must be a lowercase alphanumeric value and can\'t already exist. It must also not share the name of an app.' => 'Ваш ідентифікатор повинен буди введено латиницею (малими літерами) та не повинен існувати. Також не повинен співпадати з іменем аплікації.',	'Your ID must be a lowercase alphanumeric value. It must also not share the name of an app.' => 'Ваш ідентифікатор повинен буди введено латиницею (малими літерами). Також не повинен співпадати з іменем аплікації.',	'Your name' => 'Ваше імя',	'The layout you entered doesn\'t exist.' => 'Введена розмітка сторінки не існує',	'Website' => 'Вебсайт',	'Versions' => 'Версії',	'Versions of' => 'Версії',	'Are you sure you want to delete the current block?' => 'Ви впевнені що хочете видалити поточний блок?',	'Are you sure you want to delete the current page?' => 'Ви впевнені що хочете видалити поточну сторінку?',	'Are you sure you want to delete this block?' => 'Ви впевнені що хочете видалити цей блок?',	'Are you sure you want to delete this user?' => 'Ви впевнені що хочете видалити цього користувача?',	'Are you sure you want to delete this language?' => 'Ви впевнені що хочете видалити цю мову?',	'Are you sure you want to delete this page?' => 'Ви впевнені що хочете видалити цю сторінку?',	'Are you sure you want to cancel and lose any changes?' => 'Ви впевнені що хочете відмінити операцію (зроблені зміни не будуть збережені)?',	'Are you sure you want to cancel?' => 'Ви впевнені що хочете відмінити операцію?',	'You must enter a page title.' => 'Ви повинні ввести заголовок сторінки.',	'You must enter body content.' => 'Ви повинні ввести контент сторінки.',	'You must enter a block title.' => 'Ви повинні ввести назву блоку.',	'You must enter a password.' => 'Ви повинні ввести пароль.',	'You must enter an email address.' => 'Ви повинні ввести поштову адресу.',	'You must enter a valid email, or your email may already be registered.' => 'Ви повинні ввести робочу поштову адресу або така адреса уже зареєстрована.',	'You must enter a valid email, or email not found.' => 'Ви повинні ввести робочу поштову адресу або такої адреси не знайдено.',	'You must enter your name.' => 'Ви повинні ввести імя.',	'You must enter a name.' => 'Ви повинні ввести імя.',	'Choose a new password' => 'Виберіть новий пароль',	'Choose a password for your new account.' => 'Виберіть пароль',	'Choose a password' => 'Виберіть пароль',	'Delete' => 'Видалити',	'Delete Block' => 'Видалити блок',	'Delete Page' => 'Видалити сторінку',	'Log out' => 'Вийти',	'Admin access required.' => 'Вимагаються права адміністратора.',	'Authorization required.' => 'Вимагається авторизація.',	'Properties' => 'Властивості',	'Properties saved.' => 'Властивості збережено.',	'Visit your website.' => 'Відвідайте Ваш вебсайт.',	'Cancel' => 'Відмінити',	'Restore' => 'Відновити',	'Reset Password' => 'Відновити пароль',	'Password recovery' => 'Відновлення пароля',	'Submit' => 'Відіслати',	'Date' => 'Дата',	'Day of the week' => 'День тижня',	'Site tree' => 'Дерево вебсайту',	'Source' => 'Джерело',	'Dynamic Objects' => 'Динамічні обєкти',	'Add' => 'Добавити',	'Add Block' => 'Добавити блок',	'Add User' => 'Добавити користувача',	'Add language' => 'Добавити мову',	'Add Page' => 'Добавити сторінку',	'Extra Options' => 'Додаткові опції',	'Access' => 'Доступ',	'An email has been sent with a link to reset your password.' => 'Електронне повідомлення з посиланням для відновлення паролю відправлено!',	'Too many login attempts' => 'Забагато спроб входу',	'Forgot your password?' => 'Забули пароль?',	'Upload' => 'Завантажити',	'Title' => 'Заголовок',	'Page title' => 'Заголовок сторінки',	'Sign in with' => 'Зайти з',	'Done editing' => 'Закінчити редагування',	'Sign Up' => 'Зареєструйтеся',	'Sign up here' => 'Зареєструйтися тут',	'Drag these pages to the site tree to include them in your navigation.' => 'Захопіть ці сторінки щоби включити їх в навігацію по сайту.',	'Drag and drop pages to organize your navigation.' => 'Захопіть і вставте сторінку мишкою, щоби організувати навігацію',	'Save' => 'Зберегти',	'Save Block' => 'Зберегти блок',	'Save User' => 'Зберегти користувача',	'Save Page' => 'Зберегти сторінку',	'Save &amp; Keep Editing' => 'Зберегти та продовжити редагування',	'Saved!' => 'Збережено!',	'Saving...' => 'Зберігання...',	'Change password' => 'Зміна пароля',	'Changed on' => 'Змінено',	'Make default' => 'Зробити по замовчуванню',	'Done.' => 'Зроблено.',	'Keywords (comma-separated)' => 'Ключові слова (розділенні комою)',	'Code' => 'Код',	'Language code' => 'Код мови',	'Body' => 'Контент',	'User deleted.' => 'Користувача видалено.',	'User added.' => 'Користувача додано.',	'User saved.' => 'Користувача збережено.',	'Users' => 'Користувачі',	'File Manager' => 'Менеджер файлів',	'Language' => 'Мова',	'Languages' => 'Мови',	'Language deleted.' => 'Мову видалено.',	'Language added.' => 'Мову додано.',	'Language updated.' => 'Мову обновлено.',	'Default language updated.' => 'Мову по замовчуванню обновленно.',	'Last modified' => 'Модифіковано',	'Contains text...' => 'Містить текст...',	'Navigation' => 'Навігація',	'Back' => 'Назад',	'Block title' => 'Назва блоку',	'Month name' => 'Назва місяця',	'Settings' => 'Настройки',	'Click to update photo' => 'Натисніть для обновлення фото',	'Click here to restore.' => 'Натисніть тут для відновдлення.',	'Home' => 'Начальная страница',	'Not found' => 'Не знайдено',	'Not a member?' => 'Не учасник?',	'Unknown error' => 'Невідома помилка',	'No file uploaded or file too large.' => 'Немає файлу для завантаження або файл занадто великий.',	'Unable to delete' => 'Неможливо видалити',	'Unable to delete folders' => 'Неможливо видалити папку',	'Unable to save the file.' => 'Неможливо зберегти файл.',	'Unable to rename' => 'Неможливо перейменувати',	'No audio playback capabilities' => 'Неможливо програти аудіо-файл',	'No video playback capabilities' => 'Неможливо програти відео-файл',	'Unable to create folder' => 'Неможливо створити папку',	'Login required' => 'Необхідно увійти',	'Invalid directory' => 'Неправильна директорія',	'Invalid location' => 'Неправильна локація',	'Incorrect email or password, please try again.' => 'Неправильна поштова адреса чи пароль. Будь-ласка повторіть.',	'Invalid or expired recovery link' => 'Неправильне або просрочене посилання для відновлення',	'Invalid name' => 'Неправильне імя',	'Invalid folder name' => 'Неправильне імя папки',	'Invalid file name' => 'Неправильне імя файлу',	'Invalid Path' => 'Неправильний шлях',	'New folder' => 'Нова папка',	'New User' => 'Новий користувач',	'New password' => 'Новий пароль',	'New file' => 'Новий файл',	'Newest first' => 'Новіші спочатку',	'No' => 'Ні',	'No file was uploaded.' => 'Ніякого файлу не завантажено.',	'Update Profile' => 'Обновити профіль',	'Upgrade completed' => 'Обновлення завершено',	'Hmm, we can\'t seem to find the page you wanted at the moment.' => 'Ой... ми ще не добавили таку сторінку ;)',	'Description' => 'Опис',	'Last changed' => 'Остання зміна',	'Clear' => 'Очистити',	'Folder' => 'Папка',	'Folder already exists' => 'Папка уже існує',	'Folder renamed.' => 'Папку перейменовано.',	'Folder created.' => 'Папку створено.',	'Password' => 'Пароль',	'Password updated' => 'Пароль обновлено',	'Your password doesn\'t match.' => 'Паролі не співпадають.',	'Verify new password' => 'Перевірити новий пароль',	'Verify password' => 'Перевірити пароль',	'Check your inbox' => 'Перевірте вашу поштову скриньку.',	'Preview' => 'Перегляд',	'Browse' => 'Перегляд',	'View current' => 'Переглянути поточний',	'View profile' => 'Перегянути профіль',	'Rename' => 'Перейминувати',	'Translated' => 'Перекладено',	'Drag pages here to remove them from the tree.' => 'Перемістіть сторінку сюди щоби видалити з дерева.',	'Rebuild index' => 'Переіндексувати',	'Building index' => 'Побудова індексу',	'Show versions' => 'Показати версії',	'Display title' => 'Показати заголовок',	'Show empty fields' => 'Показати пусті поля',	'Show all fields' => 'Показати усі поля',	'Field' => 'Поле',	'Error message' => 'Помилка',	'Error Message' => 'Помилка',	'File upload failed' => 'Помилка при завантаженні файлу',	'Failed to write the file to disk.' => 'Помилка при записі файлу на диск.',	'Failed to save...' => 'Помилка при записі...',	'File save failed' => 'Помилка при збереженні файлу',	'Comparing' => 'Порівняння',	'Compare to current' => 'Порівняти з поточним',	'Send verification' => 'Послати верифікацію',	'Permanent (best for SEO)' => 'Постійно (краще для SEO)',	'Current' => 'Поточна',	'Current version' => 'Поточна версія',	'Email' => 'Поштова адреса',	'Email address' => 'Поштова адреса',	'Go' => 'Пошук',	'Private' => 'Приватно',	'Note: Pages that are not publicly visible will not be listed here.' => 'Примітка: Сторінки, що не відмічені як публічні, тут не перечисленні.',	'Continue' => 'Продовжити',	'Missing property name' => 'Пропущено імя властивості',	'Profile Updated' => 'Профіль обновлено',	'Public' => 'Публічно',	'Editing Locked' => 'Редагування блоковано',	'Edit' => 'Редагувати',	'Edit Block' => 'Редагувати блок',	'Edit User' => 'Редагувати користувача',	'Editing language' => 'Редагувати мову',	'Edit Profile' => 'Редагувати профайл',	'Edit Page' => 'Редагувати сторінку',	'Account Verified' => 'Реєстрацію перевірено',	'File size' => 'Розмір файлу',	'Page layout' => 'Розмітка сторінки',	'An Error Occurred' => 'Сталася помилка',	'Oldest first' => 'Старші спочатку',	'Page saved.' => 'Сторінку збережено.',	'Page not found' => 'Сторінку не знайдено',	'The page you requested could not be found.' => 'Сторінку не знайдено',	'Page created.' => 'Сторінку створено',	'Page deleted.' => 'Строрінку видалено.',	'January February March April May June July August September October November December' => 'Січень Лютий Березень Квітень Травень Червень Липень Серпень Вересень Жовтень Листопад Грудень',	'Yes' => 'Так',	'Temporary' => 'Тимчасово',	'Type' => 'Тип',	'User type' => 'Тип користувача',	'Sign in' => 'Увійти',	'All Pages' => 'Усі сторінки',	'Member' => 'Учасник',	'Members' => 'Учасники',	'File Already Exists' => 'Файл Уже Існує',	'File deleted.' => 'Файл видалено.',	'A file by that name already exists.' => 'Файл з таким іменем уже існує.',	'The file was only partially uploaded.' => 'Файл завантажено частково.',	'File size is too large.' => 'Файл занадто великий.',	'File saved.' => 'Файл збережено.',	'File not found' => 'Файл не знайдено',	'File renamed.' => 'Файл перейменовано.',	'File already exists' => 'Файл уже існує',	'Files' => 'Файли',	'This object is already being edited by' => 'Цей обєкт редагується',	'This page forwards visitors to the following link' => 'Ця сторінка переправляє візіторів по наступному лінку',	'Time zone offset' => 'Часова зона',	'or' => 'або',	'click to install' => 'натиснути для встановлення',	'click to upgrade' => 'натиснути для обновдення',	'optional' => 'опціонально'
-);
-
-?>
\ No newline at end of file
+);
diff -urBNs elefant-elefant_1_3_9_beta/lang/zh.php elefant-elefant_1_3_10_beta/lang/zh.php
--- elefant-elefant_1_3_9_beta/lang/zh.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lang/zh.php	2014-12-03 23:59:25.000000000 -0600
@@ -604,5 +604,3 @@
 	'Zip file installation failed' => 'zip文件安装失败',
 	'Zip file was invalid or could not be installed.' => 'zip文件无效或者不能安装。'
 );
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/layouts/admin.html elefant-elefant_1_3_10_beta/layouts/admin.html
--- elefant-elefant_1_3_9_beta/layouts/admin.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/layouts/admin.html	2014-12-03 23:59:25.000000000 -0600
@@ -7,27 +7,30 @@
 	<link rel="stylesheet" type="text/css" href="/apps/admin/css/reset.css" />
 	<link rel="stylesheet" type="text/css" href="/apps/admin/css/text.css" />
 	<link rel="stylesheet" type="text/css" href="/apps/admin/css/960.css" />
-	<link rel="stylesheet" type="text/css" href="{{ Product::stylesheet() }}" />	
+	<link rel="stylesheet" type="text/css" href="{{ Product::stylesheet() }}" />
+	<script>var elefant_focus_input = true;</script>
 	{! admin/head !}
 	{{ head|none }}
 </head>
-<body data-admin-last-page="{{ isset ($_COOKIE['elefant_last_page']) ? $_COOKIE['elefant_last_page'] : '' }}"  class="is-admin">
-<div id="wrapper" class="container_12">
-	<div id="body" class="grid_12">
-	{% if title != '' %}<h2>{{ title|none }}</h2>{% end %}
-	{{ body|none }}
+<body data-admin-last-page="{{ isset ($_COOKIE['elefant_last_page']) ? $_COOKIE['elefant_last_page'] : '' }}"
+      class="is-admin page-{{id}}">
+<div id="wrapper">
+	<div class="section section-title container_12">
+		<div id="title" class="grid_12">
+			{% if title != '' %}<h2>{{ title|none }}</h2>{% end %}
+		</div>
 	</div>
-	<div class="clear"></div>
-	<div id="footer" class="grid_12">
-		<div class="grid_6 alpha">
-			&nbsp;
+	<div class="section section-body container_12">
+		<div id="body" class="grid_12">
+			{{ body|none }}
 		</div>
-		<div class="grid_6 omega copyright">
+	</div>
+	<div class="section section-footer container_12">
+		<div id="footer" class="grid_12">
 			{"Powered by"} <a href="{{ Product::website() }}">{{ Product::name() }} {{ constant('ELEFANT_VERSION') }}</a>
 		</div>
 	</div>
-	<div class="clear"></div>
 </div>
 {{ tail|none }}
 </body>
-</html>
\ No newline at end of file
+</html>
diff -urBNs elefant-elefant_1_3_9_beta/layouts/default.html elefant-elefant_1_3_10_beta/layouts/default.html
--- elefant-elefant_1_3_9_beta/layouts/default.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/layouts/default.html	2014-12-03 23:59:25.000000000 -0600
@@ -29,7 +29,7 @@
 {% if id === 'index' %}
 	<div id="body" class="grid_12 index-body">
 
-{! filemanager/slideshow?path=homepage !}
+{! filemanager/slideshow?path=homepage&dimensions=940x240 !}
 
 {% if title != '' %}<h1>{{ title|none }}</h1>{% end %}
 {{ body|none }}
@@ -60,4 +60,4 @@
 </div>
 {{ tail|none }}
 </body>
-</html>
\ No newline at end of file
+</html>
diff -urBNs elefant-elefant_1_3_9_beta/layouts/single column.html elefant-elefant_1_3_10_beta/layouts/single column.html
--- elefant-elefant_1_3_9_beta/layouts/single column.html	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/layouts/single column.html	2014-12-03 23:59:25.000000000 -0600
@@ -46,4 +46,4 @@
 </div>
 {{ tail|none }}
 </body>
-</html>
\ No newline at end of file
+</html>
diff -urBNs elefant-elefant_1_3_9_beta/lib/Acl.php elefant-elefant_1_3_10_beta/lib/Acl.php
--- elefant-elefant_1_3_9_beta/lib/Acl.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/Acl.php	2014-12-03 23:59:25.000000000 -0600
@@ -197,5 +197,3 @@
 		return $this->resources;
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lib/AppTest.php elefant-elefant_1_3_10_beta/lib/AppTest.php
--- elefant-elefant_1_3_9_beta/lib/AppTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/AppTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -193,5 +193,3 @@
 		}
 	}
 }
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/lib/Appconf.php elefant-elefant_1_3_10_beta/lib/Appconf.php
--- elefant-elefant_1_3_9_beta/lib/Appconf.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/Appconf.php	2014-12-03 23:59:25.000000000 -0600
@@ -187,5 +187,3 @@
 		return $merged;
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lib/Autoloader.php elefant-elefant_1_3_10_beta/lib/Autoloader.php
--- elefant-elefant_1_3_9_beta/lib/Autoloader.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/Autoloader.php	2014-12-03 23:59:25.000000000 -0600
@@ -74,7 +74,7 @@
 		return true;
 	} else {
 		// No namespace, check in app lib and models folders
-		$res = glob ('apps/*/{models,lib}/' . $class . '.php', GLOB_BRACE);
+		$res = glob ('apps/*/{lib,models}/' . $class . '.php', GLOB_BRACE);
 		if (is_array ($res) && count ($res) > 0) {
 			require_once ($res[0]);
 			return true;
@@ -88,5 +88,3 @@
 }
 
 spl_autoload_register ('elefant_autoloader');
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lib/CRUD.php elefant-elefant_1_3_10_beta/lib/CRUD.php
--- elefant-elefant_1_3_9_beta/lib/CRUD.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/CRUD.php	2014-12-03 23:59:25.000000000 -0600
@@ -299,5 +299,3 @@
 		return $this->delete__default ($id);
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lib/Cache.php elefant-elefant_1_3_10_beta/lib/Cache.php
--- elefant-elefant_1_3_9_beta/lib/Cache.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/Cache.php	2014-12-03 23:59:25.000000000 -0600
@@ -132,7 +132,11 @@
 	 */
 	public function cache ($key, $timeout, $function) {
 		if (($val = $this->get ($key)) === false) {
-			$val = $function ();
+			if (is_callable ($function)) {
+				$val = call_user_func ($function);
+			} else {
+				$val = $function;
+			}
 			$this->set ($key, $val, 0, $timeout);
 		}
 		return $val;
@@ -269,5 +273,3 @@
 		return true;
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lib/Controller.php elefant-elefant_1_3_10_beta/lib/Controller.php
--- elefant-elefant_1_3_9_beta/lib/Controller.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/Controller.php	2014-12-03 23:59:25.000000000 -0600
@@ -263,6 +263,11 @@
 	 * Template object.
 	 */
 	private $_tpl;
+	
+	/**
+	 * A list of apps whose hooks have been loaded already.
+	 */
+	private static $_hooks_loaded = array ();
 
 	/**
 	 * Constructor method. Receives a list of hooks as well
@@ -319,7 +324,7 @@
 	 * Run an internal request from one handler to another.
 	 */
 	public function run ($uri, $data = array (), $internal = true) {
-		$c = new Controller (conf ('Hooks'));
+		$c = new Controller (count (self::$hooks) > 0 ? self::$hooks : conf ('Hooks'));
 		$c->page ($this->_page);
 		$c->i18n ($this->_i18n);
 		$c->template ($this->_tpl);
@@ -367,10 +372,32 @@
 	}
 
 	/**
-	 * Run any handlers for the specified hook type. Note that the
-	 * output for hooks is ignored.
+	 * Run any handlers for the specified hook type. Output of the
+	 * handlers is concatenated and returned. Hooks are specified in
+	 * the `[Hooks]` section of each app's `conf/config.php` file,
+	 * like follows:
+	 *
+	 *     [Hooks]
+	 *     
+	 *     myapp/newpost[] = search/add
+	 *     myapp/newpost[] = twitter/posttweet
+	 *
+	 * Hooks may also be listed in the global `conf/config.php` in
+	 * the same format.
 	 */
 	public function hook ($type, $data = array ()) {
+		$pos = strpos ($type, '/');
+		if ($pos > 0) {
+			$app = substr ($type, 0, $pos);
+			if (! isset (self::$_hooks_loaded[$app])) {
+				$hooks = Appconf::get ($app, 'Hooks');
+				if (is_array ($hooks)) {
+					self::$hooks = array_merge_recursive (self::$hooks, $hooks);
+				}
+				self::$_hooks_loaded[$app] = true;
+			}
+		}
+
 		if (! isset (self::$hooks[$type])) {
 			return false;
 		}
@@ -677,6 +704,9 @@
 	 * Get the raw POST data.
 	 */
 	public function get_raw_post_data () {
+		if (! isset ($GLOBALS['HTTP_RAW_POST_DATA'])) {
+			$GLOBALS['HTTP_RAW_POST_DATA'] = http_build_query ($_POST);
+		}
 		return $GLOBALS['HTTP_RAW_POST_DATA'];
 	}
 
@@ -754,7 +784,10 @@
 	public function restful ($obj) {
 		// Disable page layout and set JSON header.
 		$this->_page->layout = false;
+		$this->header ('Cache-Control: no-store, no-cache, must-revalidate');
 		$this->header ('Content-Type: application/json');
+		$this->header ('Pragma: no-cache');
+		$this->header ('Expires: 0');
 
 		// Try to determine a method to call from the HTTP request method
 		// and the first extra parameter of the URL, or `_default`. For
@@ -841,6 +874,7 @@
 			if (strpos ($msg, 'Missing argument') === 0) {
 				return $obj->error ('Missing required argument');
 			}
+			error_log ('Restful error in ' . get_class ($obj) . '->' . $method . ' on line ' . $e->getLine () . ': ' . $msg);
 			return $obj->error ('Unexpected error occurred');
 		}
 
@@ -978,7 +1012,9 @@
 	/**
 	 * Require the user to have access to one or more resources. Accepts
 	 * any number of parameters, which should be resource names. If any
-	 * resource fails, it will redirect to the `/admin` login screen.
+	 * resource fails, it will redirect to either the member login screen
+	 * at `/user/login`, or the `/admin` login screen if the `admin`
+	 * resource is included in the list.
 	 *
 	 * Usage:
 	 *
@@ -986,9 +1022,10 @@
 	 */
 	public function require_acl ($resource) {
 		$args = func_get_args ();
+		$redirect = in_array ('admin', $args) ? '/admin' : '/user/login';
 		foreach ($args as $resource) {
 			if (! User::require_acl ($resource)) {
-				$this->redirect ('/admin');
+				$this->redirect ($redirect . '?redirect=' . urlencode ($_SERVER['REQUEST_URI']));
 			}
 		}
 	}
@@ -1034,5 +1071,3 @@
 		return DB::execute ('insert into #prefix#apps (name, version) values (?, ?)', $app, $version);
 	}
 }
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/lib/DB.php elefant-elefant_1_3_10_beta/lib/DB.php
--- elefant-elefant_1_3_9_beta/lib/DB.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/DB.php	2014-12-03 23:59:25.000000000 -0600
@@ -126,7 +126,10 @@
 					if (strstr ($conf['host'], ':')) {
 						$conf['host'] = str_replace (':', ';port=', $conf['host']);
 					}
-					self::$connections[$id] = new PDO ($conf['driver'] . ':host=' . $conf['host'] . ';dbname=' . $conf['name'], $conf['user'], $conf['pass']);
+					if (!isset($conf['charset'])) {
+						$conf['charset']='utf8';
+					}
+					self::$connections[$id] = new PDO ($conf['driver'] . ':host=' . $conf['host'] . ';dbname=' . $conf['name'] . ';charset=' . $conf['charset'], $conf['user'], $conf['pass']);
 			}
 		} catch (PDOException $e) {
 			self::$error = $e->getMessage ();
@@ -373,8 +376,8 @@
 	/**
 	 * Get the last inserted id value.
 	 */
-	public static function last_id () {
-		return self::$connections[self::$last_conn]->lastInsertId ();
+	public static function last_id ($name=null) {
+		return self::$connections[self::$last_conn]->lastInsertId ($name);
 	}
 	
 	/**
@@ -502,5 +505,3 @@
 function db_last_args () {
 	return DB::last_args ();
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lib/Debugger.php elefant-elefant_1_3_10_beta/lib/Debugger.php
--- elefant-elefant_1_3_9_beta/lib/Debugger.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/Debugger.php	2014-12-03 23:59:25.000000000 -0600
@@ -42,10 +42,17 @@
  */
 class Debugger {
 	/**
+	 * This is set to true if an error is converted into an exception
+	 * in `Debugger::handle_error()`.
+	 */
+	public static $is_error = false;
+
+	/**
 	 * Set the error and exception handlers.
 	 */
 	public static function start ($on = true) {
 		if ($on) {
+			error_reporting (E_ALL | E_STRICT);
 			set_error_handler (array ('Debugger', 'handle_error'));
 			set_exception_handler (array ('Debugger', 'handle_exception'));
 		} else {
@@ -66,7 +73,16 @@
 			get_class ($e),
 			$e->getMessage ()
 		);
-		Debugger::show_trace ($e->getTrace ());
+		$trace = $e->getTrace ();
+		if (! Debugger::$is_error) {
+			array_unshift ($trace, array (
+				'file' => $e->getFile (),
+				'line' => $e->getLine (),
+				'function' => get_class ($e),
+				'args' => array ($e->getMessage ())
+			));
+		}
+		Debugger::show_trace ($trace);
 	}
 	
 	/**
@@ -102,9 +118,14 @@
 		for ($i = $start, $count = count ($trace); $i < $count; $i++) {
 			echo Debugger::show_trace_step ($trace[$i]);
 		}
+		$context = array (
+			'_COOKIE' => isset ($_COOKIE) ? $_COOKIE : array (),
+			'_SERVER' => $_SERVER
+		);
 		if (isset ($trace[0]['args']) && is_array ($trace[0]['args'][4])) {
-			Debugger::show_context ($trace[0]['args'][4]);
+			$context = array_merge ($context, $trace[0]['args'][4]);
 		}
+		Debugger::show_context ($context);
 	}
 
 	/**
@@ -114,6 +135,7 @@
 		if ($errno === 8) {
 			return;
 		}
+		Debugger::$is_error = true;
 		throw new ErrorException ($errstr, 0, $errno, $errfile, $errline);
 	}
 
@@ -332,5 +354,3 @@
 		return false;
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lib/ExtendedModel.php elefant-elefant_1_3_10_beta/lib/ExtendedModel.php
--- elefant-elefant_1_3_9_beta/lib/ExtendedModel.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/ExtendedModel.php	2014-12-03 23:59:25.000000000 -0600
@@ -259,5 +259,3 @@
 		return $ext[$key];
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lib/Form.php elefant-elefant_1_3_10_beta/lib/Form.php
--- elefant-elefant_1_3_9_beta/lib/Form.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/Form.php	2014-12-03 23:59:25.000000000 -0600
@@ -577,5 +577,3 @@
 		return $out;
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lib/FrontController.php elefant-elefant_1_3_10_beta/lib/FrontController.php
--- elefant-elefant_1_3_9_beta/lib/FrontController.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/FrontController.php	2014-12-03 23:59:25.000000000 -0600
@@ -40,7 +40,7 @@
 	 * The front controller only has one static method, `run()`, which
 	 * 
 	 */
-	public static function run ($argv) {
+	public static function run ($argv, $argc) {
 		/**
 		 * For compatibility with PHP 5.4's built-in web server, we bypass
 		 * the front controller for requests with file extensions and
@@ -216,13 +216,10 @@
 		 */
 		$out = $page->render ($tpl, $controller);
 		if (extension_loaded ('zlib') && conf ('General', 'compress_output')) {
-			$zlib_oc = ini_get ('zlib.output_compression');
-			if ($zlib_oc === '' || $zlib_oc === 'Off' || ! $zlib_oc) {
-				ob_start ('ob_gzhandler');
-			}
+			ini_set ('zlib.output_compression', 4096);
 		}
+		@session_write_close ();
 		echo $out;
+		return true;
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lib/Functions.php elefant-elefant_1_3_10_beta/lib/Functions.php
--- elefant-elefant_1_3_9_beta/lib/Functions.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/Functions.php	2014-12-03 23:59:25.000000000 -0600
@@ -74,7 +74,7 @@
  *     // Enable debugging
  *     conf ('General', 'debug', true);
  */
-function conf ($section, $value = false, $update = null) {
+function conf ($section = false, $value = false, $update = null) {
 	static $conf;
 	if ($conf === null) {
 		if (isset ($GLOBALS['conf'])) {
@@ -97,7 +97,10 @@
 		}
 		return @$conf[$section][$value];
 	}
-	return @$conf[$section];
+	if ($section) {
+		return @$conf[$section];
+	}
+	return @$conf;
 }
 
 /**
@@ -304,5 +307,3 @@
 	}
 	return file_get_contents ($url);
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lib/I18n.php elefant-elefant_1_3_10_beta/lib/I18n.php
--- elefant-elefant_1_3_9_beta/lib/I18n.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/I18n.php	2014-12-03 23:59:25.000000000 -0600
@@ -75,6 +75,16 @@
 	/**
 	 * The full date format to send to jQuery.localize.
 	 */
+	public $day_date_format = 'dddd, mmmm d, yyyy';
+
+	/**
+	 * The full date format to send to jQuery.localize.
+	 */
+	public $short_day_date_format = 'ddd, mmm d';
+
+	/**
+	 * The full date format to send to jQuery.localize.
+	 */
 	public $date_format = 'mmmm d, yyyy';
 
 	/**
@@ -86,6 +96,11 @@
 	 * The time format to send to jQuery.localize.
 	 */
 	public $time_format = 'h:MMa';
+	
+	/**
+	 * The year format to send to jQuery.localize.
+	 */
+	public $year_format = 'yyyy';
 
 	/**
 	 * Contains fallback text replacements.
@@ -452,6 +467,45 @@
 	}
 
 	/**
+	 * Filter for outputting a shortened date with year included.
+	 * Used with the jQuery localize plugin to convert dates into the
+	 * current user's time zone.
+	 *
+	 * Usage:
+	 *
+	 *     {{ date_value|I18n::short_date_year }}
+	 */
+	public static function short_date_year ($date) {
+		return self::_date ($date, 'shortdateyear', 'M j, Y');
+	}
+
+	/**
+	 * Filter for outputting a shortened day and date. Used with the
+	 * jQuery localize plugin to convert dates into the
+	 * current user's time zone.
+	 *
+	 * Usage:
+	 *
+	 *     {{ date_value|I18n::day_date }}
+	 */
+	public static function day_date ($date) {
+		return self::_date ($date, 'daydate', 'l, F j, Y');
+	}
+
+	/**
+	 * Filter for outputting a shortened day and date. Used with the
+	 * jQuery localize plugin to convert dates into the
+	 * current user's time zone.
+	 *
+	 * Usage:
+	 *
+	 *     {{ date_value|I18n::short_day_date }}
+	 */
+	public static function short_day_date ($date) {
+		return self::_date ($date, 'shortdaydate', 'D, M j');
+	}
+
+	/**
 	 * Filter for outputting times. Used with the jQuery
 	 * localize plugin to convert dates into the current user's
 	 * time zone.
@@ -484,11 +538,37 @@
 	 *
 	 * Usage:
 	 *
+	 *     {{ date_value|I18n::day_date_time }}
+	 */
+	public static function day_date_time ($date) {
+		return self::_date ($date, 'daydatetime', 'l, F j - g:ia');
+	}
+
+	/**
+	 * Filter for outputting a shortened date and time. Used
+	 * with the jQuery localize plugin to convert dates into
+	 * the current user's time zone.
+	 *
+	 * Usage:
+	 *
 	 *     {{ date_value|I18n::short_date_time }}
 	 */
 	public static function short_date_time ($date) {
 		return self::_date ($date, 'shortdatetime', 'M j - g:ia');
 	}
+
+	/**
+	 * Filter for outputting a shortened date and time. Used
+	 * with the jQuery localize plugin to convert dates into
+	 * the current user's time zone.
+	 *
+	 * Usage:
+	 *
+	 *     {{ date_value|I18n::short_day_date_time }}
+	 */
+	public static function short_day_date_time ($date) {
+		return self::_date ($date, 'shortdaydatetime', 'D, M j - g:ia');
+	}
 }
 
 /**
@@ -518,5 +598,3 @@
 	$args = func_get_args ();
 	return call_user_func_array (array ($GLOBALS['i18n'], 'getf'), $args);
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lib/Ini.php elefant-elefant_1_3_10_beta/lib/Ini.php
--- elefant-elefant_1_3_9_beta/lib/Ini.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/Ini.php	2014-12-03 23:59:25.000000000 -0600
@@ -106,5 +106,3 @@
 		return file_put_contents ($file, $out);
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lib/Mailer.php elefant-elefant_1_3_10_beta/lib/Mailer.php
--- elefant-elefant_1_3_9_beta/lib/Mailer.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/Mailer.php	2014-12-03 23:59:25.000000000 -0600
@@ -167,6 +167,11 @@
 	 * called and the `Zend_Mail` object is returned immediately.
 	 */
 	public static function send ($msg, $send = true) {
+		if ($send === true && conf ('Mailer', 'use_resque')) {
+			$GLOBALS['controller']->run ('resque/init');
+			return Resque::enqueue ('email', 'Mailer', $msg, true);
+		}
+
 		$mailer = self::getInstance ();
 		if ($mailer === false) {
 			// see Mailer::$error for info
@@ -240,6 +245,14 @@
 		}
 		return $mailer;
 	}
-}
 
-?>
+	/**
+	 * Handles jobs from a Resque queue if `use_resque = On` is set in the
+	 * `[Mailer]` configuration. Mailer will automatically queue messages
+	 * when this setting is set, and this method performs the job at a
+	 * later time.
+	 */
+	public function perform () {
+		Mailer::send ($this->args, 2);
+	}
+}
diff -urBNs elefant-elefant_1_3_9_beta/lib/MemcacheAPC.php elefant-elefant_1_3_10_beta/lib/MemcacheAPC.php
--- elefant-elefant_1_3_9_beta/lib/MemcacheAPC.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/MemcacheAPC.php	2014-12-03 23:59:25.000000000 -0600
@@ -55,7 +55,11 @@
 	 */
 	public function cache ($key, $timeout, $function) {
 		if (($val = $this->get (self::$key_prefix.$key)) === false) {
-			$val = $function ();
+			if (is_callable ($function)) {
+				$val = call_user_func ($function);
+			} else {
+				$val = $function;
+			}
 			$this->set (self::$key_prefix.$key, $val, 0, $timeout);
 		}
 		return $val;
@@ -139,5 +143,3 @@
 		return apc_clear_cache ('user');
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lib/MemcacheExt.php elefant-elefant_1_3_10_beta/lib/MemcacheExt.php
--- elefant-elefant_1_3_9_beta/lib/MemcacheExt.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/MemcacheExt.php	2014-12-03 23:59:25.000000000 -0600
@@ -47,11 +47,13 @@
 	 */
 	public function cache ($key, $timeout, $function) {
 		if (($val = $this->get ($key)) === false) {
-			$val = $function ();
+			if (is_callable ($function)) {
+				$val = call_user_func ($function);
+			} else {
+				$val = $function;
+			}
 			$this->set ($key, $val, 0, $timeout);
 		}
 		return $val;
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lib/MemcacheRedis.php elefant-elefant_1_3_10_beta/lib/MemcacheRedis.php
--- elefant-elefant_1_3_9_beta/lib/MemcacheRedis.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/MemcacheRedis.php	2014-12-03 23:59:25.000000000 -0600
@@ -74,7 +74,11 @@
 	 */
 	public function cache ($key, $timeout, $function) {
 		if (($val = $this->get ($key)) === false) {
-			$val = $function ();
+			if (is_callable ($function)) {
+				$val = call_user_func ($function);
+			} else {
+				$val = $function;
+			}
 			$this->set ($key, $val, 0, $timeout);
 		}
 		return $val;
@@ -152,5 +156,3 @@
 		return self::$redis->flushDB ();
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lib/MemcacheXCache.php elefant-elefant_1_3_10_beta/lib/MemcacheXCache.php
--- elefant-elefant_1_3_9_beta/lib/MemcacheXCache.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/MemcacheXCache.php	2014-12-03 23:59:25.000000000 -0600
@@ -55,7 +55,11 @@
 	 */
 	public function cache ($key, $timeout, $function) {
 		if (($val = $this->get (self::$key_prefix.$key)) === false) {
-			$val = $function ();
+			if (is_callable ($function)) {
+				$val = call_user_func ($function);
+			} else {
+				$val = $function;
+			}
 			$this->set (self::$key_prefix.$key, $val, 0, $timeout);
 		}
 		return $val;
@@ -139,5 +143,3 @@
 		return xcache_unset_by_prefix (self::$key_prefix);
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lib/Model.php elefant-elefant_1_3_10_beta/lib/Model.php
--- elefant-elefant_1_3_9_beta/lib/Model.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/Model.php	2014-12-03 23:59:25.000000000 -0600
@@ -406,7 +406,7 @@
 				return false;
 			}
 			if (! isset ($this->data[$this->key])) {
-				$this->data[$this->key] = DB::last_id ();
+				$this->data[$this->key] = (DB::get_connection(DB::$last_conn)->getAttribute(PDO::ATTR_DRIVER_NAME) == 'pgsql') ? DB::last_id(str_replace ('#prefix#', DB::$prefix, $this->table) . '_' . $this->key . '_seq') : DB::last_id();
 				$this->keyval = $this->data[$this->key];
 			}
 			$this->is_new = false;
@@ -567,13 +567,87 @@
 	}
 
 	/**
-	 * Creates an or clause with additional where conditions.
+	 * Creates an `AND` clause with additional where conditions.
+	 * Accepts the same parameters as `where()`.
+	 */
+	public function and_where ($key, $val = null) {
+		array_push ($this->query_filters, ' and ');
+		return $this->where ($key, $val);
+	}
+
+	/**
+	 * Creates an `OR` clause with additional where conditions.
 	 * Accepts the same parameters as `where()`.
 	 */
 	public function or_where ($key, $val = null) {
 		array_push ($this->query_filters, ' or ');
 		return $this->where ($key, $val);
 	}
+	
+	/**
+	 * Searches a list of fields for the specified query using
+	 * a `LIKE '%query%'` clause, resulting in a query of the
+	 * form:
+	 *
+	 *     (field1 like '%query%' or field2 like '%query%')
+	 *
+	 * Providing a list of exact fields, you can also add exact
+	 * qualifiers using the form `field:value` or `field:"Some Value"`,
+	 * resulting in a query of the form:
+	 *
+	 *     field1 = "Some Value" and (field2 like '%query%' or field3 like '%query%')
+	 *
+	 * Query examples:
+	 *
+	 *     Smith
+	 *     Joe Smith
+	 *     published:yes Joe Smith
+	 *     author:"Joe Smith" Chemistry
+	 * 
+	 * These would become:
+	 *
+	 *     (field1 like '%Smith%' or field2 like '%Smith%')
+	 *     (field1 like '%Joe Smith%' or field2 like '%Joe Smith%')
+	 *     published = "yes" and (field1 like '%Joe Smith%' or field2 like '%Joe Smith%')
+	 *     author = "Joe Smith" and (field1 like '%Chemistry%' or field2 like '%Chemistry%')
+	 */
+	public function where_search ($query, $fields, $exact = array ()) {
+		$q = $this;
+		$exact_matches = false;
+
+		$query = trim ($query);
+
+		if (count ($exact) > 0) {
+			$query = preg_replace_callback (
+				'/ ?(' . join ('|', $exact) . '):("[a-z0-9\'\. _-]+"|[a-z0-9\'\._-]+) ?/i',
+				function ($regs) use ($q, &$exact_matches) {
+					$q->where ($regs[1], trim ($regs[2], '"'));
+					$exact_matches = true;
+					return '';
+				},
+				$query
+			);
+		}
+
+		if (strlen ($query) > 0) {
+			$where_method = $exact_matches ? 'and_where' : 'where';
+
+			$q->{$where_method} (function ($q) use ($query, $fields) {
+				$like = '%' . trim ($query) . '%';
+				foreach ($fields as $n => $field) {
+					if ($n === 0) {
+						$q->where ($field . ' like ?', $like);
+					} else {
+						$q->or_where ($field . ' like ?', $like);
+					}
+				}
+			});
+		} elseif (! $exact_matches) {
+			$q->where ('1 = 1');
+		}
+
+		return $q;
+	}
 
 	/**
 	 * Add a having condition to the query. Can be either a field/value
@@ -652,7 +726,7 @@
 			$sql .= ' where ';
 			$and = '';
 			foreach ($this->query_filters as $where) {
-				if ($where === '(' || $where === ' or ') {
+				if ($where === '(' || $where === ' or ' || $where === ' and ') {
 					$sql .= $where;
 					$and = '';
 				} elseif ($where === ')') {
@@ -772,7 +846,7 @@
 	 * Fetch as an associative array of the specified key/value fields.
 	 */
 	public function fetch_assoc ($key, $value, $limit = false, $offset = 0) {
-		$tmp = $this->fetch ($limit, $offset);
+		$tmp = $this->fetch_orig ($limit, $offset);
 		if (! $tmp) {
 			return $tmp;
 		}
@@ -787,7 +861,7 @@
 	 * Fetch as an array of the specified field name.
 	 */
 	public function fetch_field ($value, $limit = false, $offset = 0) {
-		$tmp = $this->fetch ($limit, $offset);
+		$tmp = $this->fetch_orig ($limit, $offset);
 		if (! $tmp) {
 			return $tmp;
 		}
@@ -812,7 +886,6 @@
 	 *     {{ user_id|User::field (%s, 'name') }}
 	 */
 	public static function field ($id, $field) {
-		error_log ($id . ': ' . $field);
 		$class = get_called_class ();
 		$obj = new $class;
 		return DB::shift (
@@ -953,5 +1026,3 @@
 		return $o->key;
 	}
 }
-
-?>
diff -urBNs elefant-elefant_1_3_9_beta/lib/MongoManager.php elefant-elefant_1_3_10_beta/lib/MongoManager.php
--- elefant-elefant_1_3_9_beta/lib/MongoManager.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/MongoManager.php	2014-12-03 23:59:25.000000000 -0600
@@ -112,5 +112,3 @@
 		return $conn->{conf ('Mongo', 'name')};
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lib/MongoModel.php elefant-elefant_1_3_10_beta/lib/MongoModel.php
--- elefant-elefant_1_3_9_beta/lib/MongoModel.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/MongoModel.php	2014-12-03 23:59:25.000000000 -0600
@@ -661,5 +661,3 @@
 		return $orig;
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lib/Page.php elefant-elefant_1_3_10_beta/lib/Page.php
--- elefant-elefant_1_3_9_beta/lib/Page.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/Page.php	2014-12-03 23:59:25.000000000 -0600
@@ -153,6 +153,9 @@
 		// Fetch the default layout setting
 		if ($this->layout === 'default') {
 			$this->layout = conf ('General', 'default_layout');
+		} elseif ($this->layout === 'admin') {
+			$admin_layout = Product::admin_layout ();
+			$this->layout = $admin_layout ? $admin_layout : 'admin';
 		}
 
 		// Determine render method (preview or real)
@@ -183,8 +186,8 @@
 	 * be added once. This makes it a good replacement for adding script include tags
 	 * to view templates.
 	 */
-	public function add_script ($script, $add_to = 'head') {
-		$script = Page::wrap_script ($script);
+	public function add_script ($script, $add_to = 'head', $type = '') {
+		$script = Page::wrap_script ($script, $type);
 
 		if (! in_array ($script, $this->scripts)) {
 			$this->scripts[] = $script;
@@ -205,8 +208,35 @@
 	 * they both do the same thing, and `add_script()` always handled stylesheets
 	 * as well.
 	 */
-	public function add_style ($script, $add_to = 'head') {
-		return $this->add_script ($script, $add_to);
+	public function add_style ($script, $add_to = 'head', $type = '') {
+		return $this->add_script ($script, $add_to, $type);
+	}
+
+	/**
+	 * Add a meta tag to the page. Example usage:
+	 *
+	 *     $page->add_meta ('keywords', 'One, Two, Three');
+	 *     $page->add_meta ('UTF-8', '', 'charset');
+	 *     $page->add_meta ('og:image', 'http://example.com/foo.jpg', 'property');
+	 *     $page->add_meta ('refresh', '30;url=http://example.com/', 'http-equiv');
+	 *     $page->add_meta ('<meta charset="utf-8" />');
+	 */
+	public function add_meta ($name, $content = '', $attr = 'name') {
+		if (strpos ($name, '<') === 0) {
+			$script = trim ($name) . "\n";
+		} else {
+			$script = '<meta ' . $attr . '="' . $name . '"'
+				. (($content !== '') ? ' content="' . Template::quotes ($content) . '"' : '')
+				. " />\n";
+		}
+		
+		if (! in_array ($script, $this->scripts)) {
+			$this->scripts[] = $script;
+			
+			if (! $this->is_being_rendered) {
+				$this->head .= $script;
+			}
+		}
 	}
 
 	/**
@@ -214,15 +244,16 @@
 	 * including `<link>` tags for CSS files. Will pass through
 	 * on scripts that are already HTML.
 	 */
-	public static function wrap_script ($script) {
+	public static function wrap_script ($script, $type = '') {
 		if (strpos ($script, '<') === 0) {
 			return $script;
 		}
+		if ($type !== '') {
+			$type = ' type="' . $type . '"';
+		}
 		if (preg_match ('/\.css$/i', $script)) {
-			return '<link rel="stylesheet" href="' . $script . "\" />\n";
+			return '<link rel="stylesheet"' . $type . ' href="' . $script . "\" />\n";
 		}
-		return '<script src="' . $script . "\"></script>\n";
+		return '<script' . $type . ' src="' . $script . "\"></script>\n";
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lib/Product.php elefant-elefant_1_3_10_beta/lib/Product.php
--- elefant-elefant_1_3_9_beta/lib/Product.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/Product.php	2014-12-03 23:59:25.000000000 -0600
@@ -68,6 +68,12 @@
 		$info = Product::get_info ();
 		return $info['toolbar_stylesheet'];
 	}
-}
 
-?>
\ No newline at end of file
+	/**
+	 * Returns the `admin_layout` value.
+	 */
+	public static function admin_layout () {
+		$info = Product::get_info ();
+		return $info['admin_layout'];
+	}
+}
diff -urBNs elefant-elefant_1_3_9_beta/lib/Restful.php elefant-elefant_1_3_10_beta/lib/Restful.php
--- elefant-elefant_1_3_9_beta/lib/Restful.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/Restful.php	2014-12-03 23:59:25.000000000 -0600
@@ -207,5 +207,3 @@
 		return true;
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lib/Template.php elefant-elefant_1_3_10_beta/lib/Template.php
--- elefant-elefant_1_3_9_beta/lib/Template.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/Template.php	2014-12-03 23:59:25.000000000 -0600
@@ -300,26 +300,37 @@
 	}
 
 	/**
-	 * Render a template string for preview purposes. Generates a temporary
-	 * cached version but unlinks it immediately after use.
+	 * Render a template from a string with the given data. Generates
+	 * the PHP and caches it.
 	 */
-	public function render_preview ($template, $data = array ()) {
+	public function render_string ($template, $data = array (), $file_prefix = '_string_') {
 		if (is_array ($data)) {
 			$data = (object) $data;
 		}
 		$data->is_being_rendered = true;
-
-		// Parse and save to a temporary file
-		$cache_file = $this->cache_folder . '/_preview_' . md5 ($template) . '.php';
-		$out = $this->parse_template ($template);
-		if (! file_put_contents ($cache_file, $out)) {
-			throw new RuntimeException ('Failed to generate cached template: ' . $cache_file);
+		
+		$cache_file = $this->cache_folder . '/' . $file_prefix . '' . md5 ($template) . '.php';
+		if (! file_exists ($cache_file)) {
+			$out = $this->parse_template ($template);
+			if (! file_put_contents ($cache_file, $out)) {
+				throw new RuntimeException ('Failed to generate cached template: ' . $cache_file);
+			}
 		}
-
-		// Include the temp file, then delete it, and return the output
+		
+		// Include the temp file and return the output
 		ob_start ();
 		require ($cache_file);
 		$out = ob_get_clean ();
+		return $out;
+	}
+
+	/**
+	 * Render a template string for preview purposes. Generates a temporary
+	 * cached version but unlinks it immediately after use.
+	 */
+	public function render_preview ($template, $data = array ()) {
+		$out = $this->render_string ($template, $data, '_preview_');
+		$cache_file = $this->cache_folder . '/_preview_' . md5 ($template) . '.php';
 		unlink ($cache_file);
 		return $out;
 	}
@@ -692,5 +703,3 @@
 		throw new LogicException ('Invalid template block: ' . $val);
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lib/Validator.php elefant-elefant_1_3_10_beta/lib/Validator.php
--- elefant-elefant_1_3_9_beta/lib/Validator.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/Validator.php	2014-12-03 23:59:25.000000000 -0600
@@ -347,5 +347,3 @@
 		return $failed;
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lib/View.php elefant-elefant_1_3_10_beta/lib/View.php
--- elefant-elefant_1_3_9_beta/lib/View.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/View.php	2014-12-03 23:59:25.000000000 -0600
@@ -148,5 +148,3 @@
 		return self::$tpl->render ($view, $params);
 	}
 }
-
-?>
\ No newline at end of file
Files elefant-elefant_1_3_9_beta/lib/vendor/.htaccess and elefant-elefant_1_3_10_beta/lib/vendor/.htaccess are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/ActiveResource/ActiveResource.php and elefant-elefant_1_3_10_beta/lib/vendor/ActiveResource/ActiveResource.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/ActiveResource.php and elefant-elefant_1_3_10_beta/lib/vendor/ActiveResource.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Analog/Analog.php and elefant-elefant_1_3_10_beta/lib/vendor/Analog/Analog.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Analog/Handler/Amon.php and elefant-elefant_1_3_10_beta/lib/vendor/Analog/Handler/Amon.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Analog/Handler/Buffer/Destructor.php and elefant-elefant_1_3_10_beta/lib/vendor/Analog/Handler/Buffer/Destructor.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Analog/Handler/Buffer.php and elefant-elefant_1_3_10_beta/lib/vendor/Analog/Handler/Buffer.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Analog/Handler/ChromeLogger.php and elefant-elefant_1_3_10_beta/lib/vendor/Analog/Handler/ChromeLogger.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Analog/Handler/File.php and elefant-elefant_1_3_10_beta/lib/vendor/Analog/Handler/File.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Analog/Handler/FirePHP.php and elefant-elefant_1_3_10_beta/lib/vendor/Analog/Handler/FirePHP.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Analog/Handler/GELF.php and elefant-elefant_1_3_10_beta/lib/vendor/Analog/Handler/GELF.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Analog/Handler/LevelBuffer.php and elefant-elefant_1_3_10_beta/lib/vendor/Analog/Handler/LevelBuffer.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Analog/Handler/Mail.php and elefant-elefant_1_3_10_beta/lib/vendor/Analog/Handler/Mail.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Analog/Handler/Mongo.php and elefant-elefant_1_3_10_beta/lib/vendor/Analog/Handler/Mongo.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Analog/Handler/Multi.php and elefant-elefant_1_3_10_beta/lib/vendor/Analog/Handler/Multi.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Analog/Handler/Null.php and elefant-elefant_1_3_10_beta/lib/vendor/Analog/Handler/Null.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Analog/Handler/Post.php and elefant-elefant_1_3_10_beta/lib/vendor/Analog/Handler/Post.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Analog/Handler/Stderr.php and elefant-elefant_1_3_10_beta/lib/vendor/Analog/Handler/Stderr.php are identical
diff -urBNs elefant-elefant_1_3_9_beta/lib/vendor/Analog/Handler/Syslog.php elefant-elefant_1_3_10_beta/lib/vendor/Analog/Handler/Syslog.php
--- elefant-elefant_1_3_9_beta/lib/vendor/Analog/Handler/Syslog.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/vendor/Analog/Handler/Syslog.php	2014-12-03 23:59:25.000000000 -0600
@@ -14,10 +14,12 @@
 	public static $levels = array (
 		\Analog\Analog::DEBUG    => LOG_DEBUG,
 		\Analog\Analog::INFO     => LOG_INFO,
+		\Analog\Analog::NOTICE   => LOG_NOTICE,
 		\Analog\Analog::WARNING  => LOG_WARNING,
 		\Analog\Analog::ERROR    => LOG_ERR,
 		\Analog\Analog::CRITICAL => LOG_CRIT,
-		\Analog\Analog::ALERT    => LOG_ALERT
+		\Analog\Analog::ALERT    => LOG_ALERT,
+		\Analog\Analog::URGENT   => LOG_EMERG
 	);
 
 	public static $facilities = array (
@@ -62,4 +64,4 @@
 			closelog ();
 		};
 	}
-}
\ No newline at end of file
+}
Files elefant-elefant_1_3_9_beta/lib/vendor/Analog/Handler/Threshold.php and elefant-elefant_1_3_10_beta/lib/vendor/Analog/Handler/Threshold.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Analog/Handler/Variable.php and elefant-elefant_1_3_10_beta/lib/vendor/Analog/Handler/Variable.php are identical
diff -urBNs elefant-elefant_1_3_9_beta/lib/vendor/Analog/Logger.php elefant-elefant_1_3_10_beta/lib/vendor/Analog/Logger.php
--- elefant-elefant_1_3_9_beta/lib/vendor/Analog/Logger.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/vendor/Analog/Logger.php	2014-12-03 23:59:25.000000000 -0600
@@ -103,9 +103,22 @@
 	 * Interpolates context values into the message placeholders.
 	 */
 	private function interpolate ($message, array $context = array ()) {
+		if (is_array ($message)) {
+			return $message;
+		}
+
 		// build a replacement array with braces around the context keys
 		$replace = array ();
 		foreach ($context as $key => $val) {
+			if (is_object ($val) && get_class ($val) === 'DateTime') {
+				$val = $val->format ('Y-m-d H:i:s');
+			} elseif (is_object ($val)) {
+				$val = json_encode ($val);
+			} elseif (is_array ($val)) {
+				$val = json_encode ($val);
+			} elseif (is_resource ($val)) {
+				$val = (string) $val;
+			}
 			$replace['{' . $key . '}'] = $val;
 		}
 		
Files elefant-elefant_1_3_9_beta/lib/vendor/Analog.php and elefant-elefant_1_3_10_beta/lib/vendor/Analog.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Bench.php and elefant-elefant_1_3_10_beta/lib/vendor/Bench.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/ChromePhp.php and elefant-elefant_1_3_10_beta/lib/vendor/ChromePhp.php are identical
diff -urBNs elefant-elefant_1_3_9_beta/lib/vendor/Pimple.php elefant-elefant_1_3_10_beta/lib/vendor/Pimple.php
--- elefant-elefant_1_3_9_beta/lib/vendor/Pimple.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/vendor/Pimple.php	2014-12-03 23:59:25.000000000 -0600
@@ -41,7 +41,7 @@
      *
      * @param array $values The parameters or objects.
      */
-    public function __construct (array $values = array())
+    public function __construct(array $values = array())
     {
         $this->values = $values;
     }
@@ -106,15 +106,19 @@
     }
 
     /**
-     * Returns a closure that stores the result of the given closure for
-     * uniqueness in the scope of this instance of Pimple.
+     * Returns a closure that stores the result of the given service definition
+     * for uniqueness in the scope of this instance of Pimple.
      *
-     * @param Closure $callable A closure to wrap for uniqueness
+     * @param callable $callable A service definition to wrap for uniqueness
      *
      * @return Closure The wrapped closure
      */
-    public static function share(Closure $callable)
+    public static function share($callable)
     {
+        if (!is_object($callable) || !method_exists($callable, '__invoke')) {
+            throw new InvalidArgumentException('Service definition is not a Closure or invokable object.');
+        }
+
         return function ($c) use ($callable) {
             static $object;
 
@@ -131,12 +135,16 @@
      *
      * This is useful when you want to store a callable as a parameter.
      *
-     * @param Closure $callable A closure to protect from being evaluated
+     * @param callable $callable A callable to protect from being evaluated
      *
      * @return Closure The protected closure
      */
-    public static function protect(Closure $callable)
+    public static function protect($callable)
     {
+        if (!is_object($callable) || !method_exists($callable, '__invoke')) {
+            throw new InvalidArgumentException('Callable is not a Closure or invokable object.');
+        }
+
         return function ($c) use ($callable) {
             return $callable;
         };
@@ -166,25 +174,29 @@
      * Useful when you want to extend an existing object definition,
      * without necessarily loading that object.
      *
-     * @param string  $id       The unique identifier for the object
-     * @param Closure $callable A closure to extend the original
+     * @param string $id       The unique identifier for the object
+     * @param callable $callable A service definition to extend the original
      *
      * @return Closure The wrapped closure
      *
-     * @throws InvalidArgumentException if the identifier is not defined
+     * @throws InvalidArgumentException if the identifier is not defined or not a service definition
      */
-    public function extend($id, Closure $callable)
+    public function extend($id, $callable)
     {
         if (!array_key_exists($id, $this->values)) {
             throw new InvalidArgumentException(sprintf('Identifier "%s" is not defined.', $id));
         }
 
-        $factory = $this->values[$id];
-
-        if (!($factory instanceof Closure)) {
+        if (!is_object($this->values[$id]) || !method_exists($this->values[$id], '__invoke')) {
             throw new InvalidArgumentException(sprintf('Identifier "%s" does not contain an object definition.', $id));
         }
 
+        if (!is_object($callable) || !method_exists($callable, '__invoke')) {
+            throw new InvalidArgumentException('Extension service definition is not a Closure or invokable object.');
+        }
+
+        $factory = $this->values[$id];
+
         return $this->values[$id] = function ($c) use ($callable, $factory) {
             return $callable($factory($c), $c);
         };
diff -urBNs elefant-elefant_1_3_9_beta/lib/vendor/SessionHandlerCookie.php elefant-elefant_1_3_10_beta/lib/vendor/SessionHandlerCookie.php
--- elefant-elefant_1_3_9_beta/lib/vendor/SessionHandlerCookie.php	1969-12-31 18:00:00.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/vendor/SessionHandlerCookie.php	2014-12-03 23:59:25.000000000 -0600
@@ -0,0 +1,116 @@
+<?php
+
+/**
+ * Session Handling Cookie Class
+ *
+ * Modified version of original class by Steve Corona to accept constructor of HASH information
+ *
+ * In addition to Vijay Mahrra's changes, this version also reads the additional cookie
+ * parameters from session_get_cookie_params()
+ *
+ * <example>
+ * $handler = new SessionHandlerCookie('SECRET');
+ * session_set_save_handler($handler, true);
+ * session_start();
+ * </example>
+ *
+ * @author Steve Corona
+ * @author Vijay Mahrra <vijay@yoyo.org>
+ * @copyright (c) 2012, Steve Corona
+ * @see https://www.scalingphpbook.com/
+ * @see https://github.com/stevencorona/SessionHandlerCookie
+ * @see https://github.com/vijinho/SessionHandlerCookie
+ */
+class SessionHandlerCookie implements SessionHandlerInterface {
+
+    private $data = array();
+    private $save_path = null;
+    public $HASH_LEN;
+    public $HASH_ALGO;
+    public $HASH_SECRET;
+
+    public function __construct($HASH_SECRET = 'YOUR_SECRET_STRING', $HASH_ALGO = 'sha512', $HASH_LEN = 128) {
+        $this->HASH_SECRET = $HASH_SECRET;
+        $this->HASH_ALGO = $HASH_ALGO;
+        $this->HASH_LEN = $HASH_LEN;
+    }
+
+    public function getHashLength() {
+        return $this->HASH_LEN;
+    }
+
+    public function getHashAlgorithm() {
+        return $this->HASH_ALGO;
+    }
+
+    public function getSecret() {
+        return $this->HASH_SECRET;
+    }
+
+    public function open($save_path, $name) {
+        $this->save_path = $save_path;
+        return true;
+    }
+
+    public function read($id) {
+
+        // Check for the existance of a cookie with the name of the session id
+        // Make sure that the cookie is atleast the size of our hash, otherwise it's invalid
+        // Return an empty string if it's invalid.
+        if (!isset($_COOKIE[$id]))
+            return '';
+
+        // We expect the cookie to be base64 encoded, so let's decode it and make sure
+        // that the cookie, at a minimum, is longer than our expact hash length.
+        $raw = gzuncompress(base64_decode($_COOKIE[$id]));
+        if ($raw === false || strlen($raw) < $this->HASH_LEN)
+            return '';
+
+        // The cookie data contains the actual data w/ the hash concatonated to the end,
+        // since the hash is a fixed length, we can extract the last HMAC_LENGTH chars
+        // to get the hash.
+        $hash = substr($raw, strlen($raw) - $this->HASH_LEN, $this->HASH_LEN);
+        $data = substr($raw, 0, -($this->HASH_LEN));
+
+        // Calculate what the hash should be, based on the data. If the data has not been
+        // tampered with, $hash and $hash_calculated will be the same
+        $hash_calculated = hash_hmac($this->HASH_ALGO, $data, $this->HASH_SECRET);
+
+        // If we calculate a different hash, we can't trust the data. Return an empty string.
+        if ($hash_calculated !== $hash)
+            return '';
+
+        // Return the data, now that it's been verified.
+        return (string) $data;
+    }
+
+    public function write($id, $data) {
+
+        // Calculate a hash for the data and append it to the end of the data string
+        $hash = hash_hmac($this->HASH_ALGO, $data, $this->HASH_SECRET);
+        $data .= $hash;
+
+        // Set a cookie with the data
+        $this->_setcookie($id, base64_encode(gzcompress($data, 9)));
+    }
+
+    public function destroy($id) {
+        $this->_setcookie($id, '', time());
+    }
+
+    // In the context of cookies, these two methods are unneccessary, but must
+    // be implemented as part of the SessionHandlerInterface.
+    public function gc($maxlifetime) {
+
+    }
+
+    public function close() {
+
+    }
+
+	private function _setcookie($id, $data, $duration = null) {
+		extract (session_get_cookie_params ());
+		$duration = $duration ? $duration : time () + $lifetime;
+		setcookie ($id, $data, $duration, $path, $domain, $secure, $httponly);
+	}
+}
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/lib/vendor/URLify.php elefant-elefant_1_3_10_beta/lib/vendor/URLify.php
--- elefant-elefant_1_3_9_beta/lib/vendor/URLify.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/lib/vendor/URLify.php	2014-12-03 23:59:25.000000000 -0600
@@ -11,7 +11,7 @@
  *
  *     echo URLify::filter (' J\'étudie le français ');
  *     // "jetudie-le-francais"
- *     
+ *
  *     echo URLify::filter ('Lo siento, no hablo español.');
  *     // "lo-siento-no-hablo-espanol"
  */
@@ -78,7 +78,7 @@
 			'Ź' => 'Z', 'Ż' => 'Z'
 		),
 		'ro' => array ( /* Romanian */
-			'ă' => 'a', 'â' => 'a', 'î' => 'i', 'ș' => 's', 'ț' => 't'
+			'ă' => 'a', 'â' => 'a', 'î' => 'i', 'ș' => 's', 'ț' => 't', 'Ţ' => 'T', 'ţ' => 't'
 		),
 		'lv' => array ( /* Latvian */
 			'ā' => 'a', 'č' => 'c', 'ē' => 'e', 'ģ' => 'g', 'ī' => 'i', 'ķ' => 'k', 'ļ' => 'l', 'ņ' => 'n',
@@ -88,6 +88,33 @@
 		'lt' => array ( /* Lithuanian */
 			'ą' => 'a', 'č' => 'c', 'ę' => 'e', 'ė' => 'e', 'į' => 'i', 'š' => 's', 'ų' => 'u', 'ū' => 'u', 'ž' => 'z',
 			'Ą' => 'A', 'Č' => 'C', 'Ę' => 'E', 'Ė' => 'E', 'Į' => 'I', 'Š' => 'S', 'Ų' => 'U', 'Ū' => 'U', 'Ž' => 'Z'
+		),
+		'vn' => array ( /* Vietnamese */
+			'Á' => 'A', 'À' => 'A', 'Ả' => 'A', 'Ã' => 'A', 'Ạ' => 'A', 'Ă' => 'A', 'Ắ' => 'A', 'Ằ' => 'A', 'Ẳ' => 'A', 'Ẵ' => 'A', 'Ặ' => 'A', 'Â' => 'A', 'Ấ' => 'A', 'Ầ' => 'A', 'Ẩ' => 'A', 'Ẫ' => 'A', 'Ậ' => 'A',
+			'á' => 'a', 'à' => 'a', 'ả' => 'a', 'ã' => 'a', 'ạ' => 'a', 'ă' => 'a', 'ắ' => 'a', 'ằ' => 'a', 'ẳ' => 'a', 'ẵ' => 'a', 'ặ' => 'a', 'â' => 'a', 'ấ' => 'a', 'ầ' => 'a', 'ẩ' => 'a', 'ẫ' => 'a', 'ậ' => 'a',
+			'É' => 'E', 'È' => 'E', 'Ẻ' => 'E', 'Ẽ' => 'E', 'Ẹ' => 'E', 'Ê' => 'E', 'Ế' => 'E', 'Ề' => 'E', 'Ể' => 'E', 'Ễ' => 'E', 'Ệ' => 'E',
+			'é' => 'e', 'è' => 'e', 'ẻ' => 'e', 'ẽ' => 'e', 'ẹ' => 'e', 'ê' => 'e', 'ế' => 'e', 'ề' => 'e', 'ể' => 'e', 'ễ' => 'e', 'ệ' => 'e',
+			'Í' => 'I', 'Ì' => 'I', 'Ỉ' => 'I', 'Ĩ' => 'I', 'Ị' => 'I', 'í' => 'i', 'ì' => 'i', 'ỉ' => 'i', 'ĩ' => 'i', 'ị' => 'i',
+			'Ó' => 'O', 'Ò' => 'O', 'Ỏ' => 'O', 'Õ' => 'O', 'Ọ' => 'O', 'Ô' => 'O', 'Ố' => 'O', 'Ồ' => 'O', 'Ổ' => 'O', 'Ỗ' => 'O', 'Ộ' => 'O', 'Ơ' => 'O', 'Ớ' => 'O', 'Ờ' => 'O', 'Ở' => 'O', 'Ỡ' => 'O', 'Ợ' => 'O',
+			'ó' => 'o', 'ò' => 'o', 'ỏ' => 'o', 'õ' => 'o', 'ọ' => 'o', 'ô' => 'o', 'ố' => 'o', 'ồ' => 'o', 'ổ' => 'o', 'ỗ' => 'o', 'ộ' => 'o', 'ơ' => 'o', 'ớ' => 'o', 'ờ' => 'o', 'ở' => 'o', 'ỡ' => 'o', 'ợ' => 'o',
+			'Ú' => 'U', 'Ù' => 'U', 'Ủ' => 'U', 'Ũ' => 'U', 'Ụ' => 'U', 'Ư' => 'U', 'Ứ' => 'U', 'Ừ' => 'U', 'Ử' => 'U', 'Ữ' => 'U', 'Ự' => 'U',
+			'ú' => 'u', 'ù' => 'u', 'ủ' => 'u', 'ũ' => 'u', 'ụ' => 'u', 'ư' => 'u', 'ứ' => 'u', 'ừ' => 'u', 'ử' => 'u', 'ữ' => 'u', 'ự' => 'u',
+			'Ý' => 'Y', 'Ỳ' => 'Y', 'Ỷ' => 'Y', 'Ỹ' => 'Y', 'Ỵ' => 'Y', 'ý' => 'y', 'ỳ' => 'y', 'ỷ' => 'y', 'ỹ' => 'y', 'ỵ' => 'y',
+			'Đ' => 'D', 'đ' => 'd'
+		),
+		'ar' => array ( /* Arabic */
+			'أ' => 'a', 'ب' => 'b', 'ت' => 't', 'ث' => 'th', 'ج' => 'g', 'ح' => 'h', 'خ' => 'kh', 'د' => 'd',
+			'ذ' => 'th', 'ر' => 'r', 'ز' => 'z', 'س' => 's', 'ش' => 'sh', 'ص' => 's', 'ض' => 'd', 'ط' => 't',
+			'ظ' => 'th', 'ع' => 'aa', 'غ' => 'gh', 'ف' => 'f', 'ق' => 'k', 'ك' => 'k', 'ل' => 'l', 'م' => 'm',
+			'ن' => 'n', 'ه' => 'h', 'و' => 'o', 'ي' => 'y'
+		),
+		'sr' => array ( /* Serbian */
+			'ђ' => 'dj', 'ј' => 'j', 'љ' => 'lj', 'њ' => 'nj', 'ћ' => 'c', 'џ' => 'dz', 'đ' => 'dj',
+			'Ђ' => 'Dj', 'Ј' => 'j', 'Љ' => 'Lj', 'Њ' => 'Nj', 'Ћ' => 'C', 'Џ' => 'Dz', 'Đ' => 'Dj'
+		),
+		'az' => array ( /* Azerbaijani */
+			'ç' => 'c', 'ə' => 'e', 'ğ' => 'g', 'ı' => 'i', 'ö' => 'o', 'ş' => 's', 'ü' => 'u',
+			'Ç' => 'C', 'Ə' => 'E', 'Ğ' => 'G', 'İ' => 'I', 'Ö' => 'O', 'Ş' => 'S', 'Ü' => 'U'
 		)
 	);
 
@@ -174,7 +201,7 @@
 
 	/**
 	 * Transliterates characters to their ASCII equivalents.
-     * $language specifies a priority for a specific language. 
+     * $language specifies a priority for a specific language.
      * The latter is useful if languages have different rules for the same character.
 	 */
 	public static function downcode ($text, $language = "") {
@@ -201,13 +228,13 @@
 		$text = preg_replace ('/\b(' . join ('|', self::$remove_list) . ')\b/i', '', $text);
 
 		// if downcode doesn't hit, the char will be stripped here
-		$remove_pattern = ($file_name) ? '/[^-.\w\s]/' : '/[^-\w\s]/';
-		$text = preg_replace ($remove_pattern, '', $text);		// remove unneeded chars
-		$text = str_replace ('_', ' ', $text);		// treat underscores as spaces
-		$text = preg_replace ('/^\s+|\s+$/', '', $text);	// trim leading/trailing spaces
-		$text = preg_replace ('/[-\s]+/', '-', $text);		// convert spaces to hyphens
-		$text = strtolower ($text);							// convert to lowercase						
-		return trim (substr ($text, 0, $length), '-');	// trim to first $length chars
+		$remove_pattern = ($file_name) ? '/[^-.\w\s]/u' : '/[^-\w\s]/u';
+		$text = preg_replace ($remove_pattern, '', $text); // remove unneeded chars
+		$text = str_replace ('_', ' ', $text);             // treat underscores as spaces
+		$text = preg_replace ('/^\s+|\s+$/', '', $text);   // trim leading/trailing spaces
+		$text = preg_replace ('/[-\s]+/', '-', $text);     // convert spaces to hyphens
+		$text = strtolower ($text);                        // convert to lowercase
+		return trim (substr ($text, 0, $length), '-');     // trim to first $length chars
 	}
 
 	/**
@@ -217,5 +244,3 @@
 		return self::downcode ($text);
 	}
 }
-
-?>
\ No newline at end of file
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Exception.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Exception.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Loader.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Loader.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Exception.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Exception.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Message/File.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Message/File.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Message/Interface.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Message/Interface.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Message.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Message.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Part/File.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Part/File.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Part/Interface.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Part/Interface.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Part.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Part.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Protocol/Abstract.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Protocol/Abstract.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Protocol/Exception.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Protocol/Exception.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Protocol/Imap.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Protocol/Imap.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Protocol/Pop3.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Protocol/Pop3.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Protocol/Smtp/Auth/Crammd5.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Protocol/Smtp/Auth/Crammd5.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Protocol/Smtp/Auth/Login.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Protocol/Smtp/Auth/Login.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Protocol/Smtp/Auth/Plain.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Protocol/Smtp/Auth/Plain.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Protocol/Smtp.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Protocol/Smtp.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Storage/Abstract.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Storage/Abstract.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Storage/Exception.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Storage/Exception.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Storage/Folder/Interface.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Storage/Folder/Interface.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Storage/Folder/Maildir.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Storage/Folder/Maildir.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Storage/Folder/Mbox.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Storage/Folder/Mbox.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Storage/Folder.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Storage/Folder.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Storage/Imap.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Storage/Imap.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Storage/Maildir.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Storage/Maildir.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Storage/Mbox.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Storage/Mbox.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Storage/Pop3.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Storage/Pop3.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Storage/Writable/Interface.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Storage/Writable/Interface.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Storage/Writable/Maildir.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Storage/Writable/Maildir.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Storage.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Storage.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Transport/Abstract.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Transport/Abstract.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Transport/Exception.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Transport/Exception.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Transport/File.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Transport/File.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Transport/Sendmail.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Transport/Sendmail.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail/Transport/Smtp.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail/Transport/Smtp.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mail.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mail.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mime/Decode.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mime/Decode.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mime/Exception.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mime/Exception.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mime/Message.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mime/Message.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mime/Part.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mime/Part.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Mime.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Mime.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Registry.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Registry.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Abstract.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Abstract.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Alnum.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Alnum.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Alpha.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Alpha.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Barcode/AdapterAbstract.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Barcode/AdapterAbstract.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Barcode/AdapterInterface.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Barcode/AdapterInterface.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Barcode/Code25.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Barcode/Code25.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Barcode/Code25interleaved.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Barcode/Code25interleaved.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Barcode/Code39.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Barcode/Code39.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Barcode/Code39ext.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Barcode/Code39ext.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Barcode/Code93.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Barcode/Code93.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Barcode/Code93ext.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Barcode/Code93ext.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Barcode/Ean12.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Barcode/Ean12.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Barcode/Ean13.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Barcode/Ean13.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Barcode/Ean14.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Barcode/Ean14.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Barcode/Ean18.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Barcode/Ean18.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Barcode/Ean2.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Barcode/Ean2.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Barcode/Ean5.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Barcode/Ean5.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Barcode/Ean8.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Barcode/Ean8.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Barcode/Gtin12.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Barcode/Gtin12.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Barcode/Gtin13.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Barcode/Gtin13.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Barcode/Gtin14.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Barcode/Gtin14.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Barcode/Identcode.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Barcode/Identcode.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Barcode/Intelligentmail.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Barcode/Intelligentmail.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Barcode/Issn.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Barcode/Issn.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Barcode/Itf14.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Barcode/Itf14.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Barcode/Leitcode.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Barcode/Leitcode.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Barcode/Planet.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Barcode/Planet.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Barcode/Postnet.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Barcode/Postnet.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Barcode/Royalmail.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Barcode/Royalmail.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Barcode/Sscc.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Barcode/Sscc.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Barcode/Upca.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Barcode/Upca.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Barcode/Upce.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Barcode/Upce.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Barcode.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Barcode.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Between.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Between.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Callback.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Callback.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Ccnum.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Ccnum.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/CreditCard.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/CreditCard.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Date.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Date.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Db/Abstract.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Db/Abstract.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Db/NoRecordExists.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Db/NoRecordExists.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Db/RecordExists.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Db/RecordExists.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Digits.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Digits.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/EmailAddress.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/EmailAddress.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Exception.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Exception.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/File/Count.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/File/Count.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/File/Crc32.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/File/Crc32.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/File/ExcludeExtension.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/File/ExcludeExtension.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/File/ExcludeMimeType.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/File/ExcludeMimeType.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/File/Exists.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/File/Exists.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/File/Extension.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/File/Extension.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/File/FilesSize.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/File/FilesSize.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/File/Hash.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/File/Hash.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/File/ImageSize.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/File/ImageSize.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/File/IsCompressed.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/File/IsCompressed.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/File/IsImage.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/File/IsImage.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/File/Md5.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/File/Md5.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/File/MimeType.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/File/MimeType.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/File/NotExists.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/File/NotExists.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/File/Sha1.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/File/Sha1.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/File/Size.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/File/Size.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/File/Upload.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/File/Upload.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/File/WordCount.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/File/WordCount.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Float.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Float.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/GreaterThan.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/GreaterThan.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Hex.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Hex.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Hostname/Biz.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Hostname/Biz.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Hostname/Cn.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Hostname/Cn.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Hostname/Com.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Hostname/Com.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Hostname/Jp.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Hostname/Jp.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Hostname.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Hostname.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Iban.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Iban.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Identical.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Identical.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/InArray.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/InArray.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Int.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Int.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Interface.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Interface.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Ip.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Ip.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Isbn.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Isbn.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/LessThan.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/LessThan.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/NotEmpty.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/NotEmpty.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/PostCode.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/PostCode.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Regex.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Regex.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Sitemap/Changefreq.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Sitemap/Changefreq.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Sitemap/Lastmod.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Sitemap/Lastmod.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Sitemap/Loc.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Sitemap/Loc.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/Sitemap/Priority.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/Sitemap/Priority.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate/StringLength.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate/StringLength.php are identical
Files elefant-elefant_1_3_9_beta/lib/vendor/Zend/Validate.php and elefant-elefant_1_3_10_beta/lib/vendor/Zend/Validate.php are identical
Files elefant-elefant_1_3_9_beta/nginx.conf and elefant-elefant_1_3_10_beta/nginx.conf are identical
Files elefant-elefant_1_3_9_beta/phpunit.xml.dist and elefant-elefant_1_3_10_beta/phpunit.xml.dist are identical
Files elefant-elefant_1_3_9_beta/robots.txt and elefant-elefant_1_3_10_beta/robots.txt are identical
Files elefant-elefant_1_3_9_beta/tests/.htaccess and elefant-elefant_1_3_10_beta/tests/.htaccess are identical
diff -urBNs elefant-elefant_1_3_9_beta/tests/AclTest.php elefant-elefant_1_3_10_beta/tests/AclTest.php
--- elefant-elefant_1_3_9_beta/tests/AclTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/AclTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -129,5 +129,3 @@
 		$this->assertFalse ((bool) self::$acl->allowed ('other'));
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/ActiveResourceTest.php elefant-elefant_1_3_10_beta/tests/ActiveResourceTest.php
--- elefant-elefant_1_3_9_beta/tests/ActiveResourceTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/ActiveResourceTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -200,5 +200,3 @@
 		$this->assertEquals ($t->_xml_entities ('ž'), '&#x17E;');
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/AdminAppTest.php elefant-elefant_1_3_10_beta/tests/AdminAppTest.php
--- elefant-elefant_1_3_9_beta/tests/AdminAppTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/AdminAppTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -24,5 +24,3 @@
 		$this->assertContains ('<h3>Congratulations!</h3>', $res);
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/AdminFunctionsTest.php elefant-elefant_1_3_10_beta/tests/AdminFunctionsTest.php
--- elefant-elefant_1_3_9_beta/tests/AdminFunctionsTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/AdminFunctionsTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -35,5 +35,3 @@
 		$this->assertFalse (admin_layout_exists ('this-is-a-nonexistent-layout'));
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/AnalogTest.php elefant-elefant_1_3_10_beta/tests/AnalogTest.php
--- elefant-elefant_1_3_9_beta/tests/AnalogTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/AnalogTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -45,5 +45,3 @@
 		);
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/AppconfTest.php elefant-elefant_1_3_10_beta/tests/AppconfTest.php
--- elefant-elefant_1_3_9_beta/tests/AppconfTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/AppconfTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -55,5 +55,3 @@
 		$this->assertEquals ('admin/versions', $conf);
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/BlogAppTest.php elefant-elefant_1_3_10_beta/tests/BlogAppTest.php
--- elefant-elefant_1_3_9_beta/tests/BlogAppTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/BlogAppTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -18,5 +18,3 @@
 		$this->userAnon ();
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/CacheTest.php elefant-elefant_1_3_10_beta/tests/CacheTest.php
--- elefant-elefant_1_3_9_beta/tests/CacheTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/CacheTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -63,5 +63,3 @@
 		$this->assertEquals (count ($files), 2);
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/ControllerTest.php elefant-elefant_1_3_10_beta/tests/ControllerTest.php
--- elefant-elefant_1_3_9_beta/tests/ControllerTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/ControllerTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -58,5 +58,3 @@
 		$this->assertEquals ('http://www.example.com/sub/page', $this->c->absolutize ('page', 'http://www.example.com/sub/'));
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/CsvParserTest.php elefant-elefant_1_3_10_beta/tests/CsvParserTest.php
--- elefant-elefant_1_3_9_beta/tests/CsvParserTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/CsvParserTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -49,5 +49,3 @@
 		$this->assertEquals ("three, four", $parsed[2][5]);
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/DBTest.php elefant-elefant_1_3_10_beta/tests/DBTest.php
--- elefant-elefant_1_3_9_beta/tests/DBTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/DBTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -114,5 +114,3 @@
 		$this->assertEquals (3, DB::shift ('select count(*) from transaction_test'));
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/DiffTest.php elefant-elefant_1_3_10_beta/tests/DiffTest.php
--- elefant-elefant_1_3_9_beta/tests/DiffTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/DiffTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -52,5 +52,3 @@
 		$this->assertEquals ($out, $expected);
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/ExtendedModelTest.php elefant-elefant_1_3_10_beta/tests/ExtendedModelTest.php
--- elefant-elefant_1_3_9_beta/tests/ExtendedModelTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/ExtendedModelTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -111,5 +111,3 @@
 		$this->assertEquals (json_encode ($extra), self::$o->data['extra']);
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/FileManagerTest.php elefant-elefant_1_3_10_beta/tests/FileManagerTest.php
--- elefant-elefant_1_3_9_beta/tests/FileManagerTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/FileManagerTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -212,5 +212,3 @@
 		);
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/FormTest.php elefant-elefant_1_3_10_beta/tests/FormTest.php
--- elefant-elefant_1_3_9_beta/tests/FormTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/FormTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -84,5 +84,3 @@
 		$this->assertFalse ($form->verify_csrf ());
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/FunctionsTest.php elefant-elefant_1_3_10_beta/tests/FunctionsTest.php
--- elefant-elefant_1_3_9_beta/tests/FunctionsTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/FunctionsTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -232,5 +232,3 @@
 		$this->assertFalse (file_exists ('rmdir_recursive_test'));
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/I18nTest.php elefant-elefant_1_3_10_beta/tests/I18nTest.php
--- elefant-elefant_1_3_9_beta/tests/I18nTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/I18nTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -157,5 +157,3 @@
 		$this->assertEquals ($expected, I18n::short_date_time ($time));
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/IniTest.php elefant-elefant_1_3_10_beta/tests/IniTest.php
--- elefant-elefant_1_3_9_beta/tests/IniTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/IniTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -47,5 +47,3 @@
 		$this->assertEquals ($ini, Ini::write ($data));
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/LinkTest.php elefant-elefant_1_3_10_beta/tests/LinkTest.php
--- elefant-elefant_1_3_9_beta/tests/LinkTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/LinkTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -179,5 +179,3 @@
 		$this->assertEquals ($expected, Link::single ('news', 'News'));
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/LockTest.php elefant-elefant_1_3_10_beta/tests/LockTest.php
--- elefant-elefant_1_3_9_beta/tests/LockTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/LockTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -116,5 +116,3 @@
 		$this->assertNotEquals (false, self::$lock->error);
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/ModelTest.php elefant-elefant_1_3_10_beta/tests/ModelTest.php
--- elefant-elefant_1_3_9_beta/tests/ModelTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/ModelTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -447,5 +447,3 @@
 		$this->assertEquals ('id', Cover::key ());
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/MongoModelTest.php elefant-elefant_1_3_10_beta/tests/MongoModelTest.php
--- elefant-elefant_1_3_9_beta/tests/MongoModelTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/MongoModelTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -234,5 +234,3 @@
 		$this->assertEquals (2, count ($two['items']));
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/NavigationAppTest.php elefant-elefant_1_3_10_beta/tests/NavigationAppTest.php
--- elefant-elefant_1_3_9_beta/tests/NavigationAppTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/NavigationAppTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -86,5 +86,3 @@
 		$this->assertContains ('<li><a href="/contactez-nous">Contactez-nous', $res);
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/NavigationTest.php elefant-elefant_1_3_10_beta/tests/NavigationTest.php
--- elefant-elefant_1_3_9_beta/tests/NavigationTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/NavigationTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -76,5 +76,3 @@
 		$this->assertEquals ($expected_index, $index_node);
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/PageTest.php elefant-elefant_1_3_10_beta/tests/PageTest.php
--- elefant-elefant_1_3_9_beta/tests/PageTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/PageTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -30,6 +30,20 @@
 		$this->assertEquals ("<script src=\"/foo.js\"></script>\n", $p->head);
 		$this->assertEquals ("<script src=\"/bar.js\"></script>\n", $p->tail);
 	}
-}
+	
+	function test_add_meta () {
+		$p = new Page;
+
+		$p->add_meta ('keywords', 'One, Two');
+		$expected_head = "<meta name=\"keywords\" content=\"One, Two\" />\n";
+		$this->assertEquals ($expected_head, $p->head);
+
+		$p->add_meta ('refresh', '0;url=http://example.com/', 'http-equiv');
+		$expected_head .= "<meta http-equiv=\"refresh\" content=\"0;url=http://example.com/\" />\n";
+		$this->assertEquals ($expected_head, $p->head);
 
-?>
\ No newline at end of file
+		$p->add_meta ('<meta charset="utf-8" />');
+		$expected_head .= "<meta charset=\"utf-8\" />\n";
+		$this->assertEquals ($expected_head, $p->head);
+	}
+}
diff -urBNs elefant-elefant_1_3_9_beta/tests/RestfulTest.php elefant-elefant_1_3_10_beta/tests/RestfulTest.php
--- elefant-elefant_1_3_9_beta/tests/RestfulTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/RestfulTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -203,5 +203,3 @@
 		$this->assertEquals ($err, $res);
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/TemplateTest.php elefant-elefant_1_3_10_beta/tests/TemplateTest.php
--- elefant-elefant_1_3_9_beta/tests/TemplateTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/TemplateTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -119,5 +119,3 @@
 		);
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/TreeTest.php elefant-elefant_1_3_10_beta/tests/TreeTest.php
--- elefant-elefant_1_3_9_beta/tests/TreeTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/TreeTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -407,5 +407,3 @@
 		$this->assertEquals (count (self::$n->node ('index')->children), 2);
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/URLifyTest.php elefant-elefant_1_3_10_beta/tests/URLifyTest.php
--- elefant-elefant_1_3_9_beta/tests/URLifyTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/URLifyTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -39,5 +39,3 @@
 	}
 
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/UserTest.php elefant-elefant_1_3_10_beta/tests/UserTest.php
--- elefant-elefant_1_3_9_beta/tests/UserTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/UserTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -79,5 +79,3 @@
 		$this->assertEquals ($user, $u3);
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/ValidatorTest.php elefant-elefant_1_3_10_beta/tests/ValidatorTest.php
--- elefant-elefant_1_3_9_beta/tests/ValidatorTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/ValidatorTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -179,5 +179,3 @@
 		$this->assertEquals (array (), Validator::$invalid);
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/VersionsTest.php elefant-elefant_1_3_10_beta/tests/VersionsTest.php
--- elefant-elefant_1_3_9_beta/tests/VersionsTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/VersionsTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -133,5 +133,3 @@
 		$this->assertEquals (count ($recent), 2);
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/ViewTest.php elefant-elefant_1_3_10_beta/tests/ViewTest.php
--- elefant-elefant_1_3_9_beta/tests/ViewTest.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/ViewTest.php	2014-12-03 23:59:25.000000000 -0600
@@ -53,5 +53,3 @@
 		);
 	}
 }
-
-?>
\ No newline at end of file
diff -urBNs elefant-elefant_1_3_9_beta/tests/bootstrap.php elefant-elefant_1_3_10_beta/tests/bootstrap.php
--- elefant-elefant_1_3_9_beta/tests/bootstrap.php	2014-03-01 21:36:42.000000000 -0600
+++ elefant-elefant_1_3_10_beta/tests/bootstrap.php	2014-12-03 23:59:25.000000000 -0600
@@ -3,5 +3,3 @@
 define ('ELEFANT_ENV', 'test');
 require_once ('lib/Functions.php');
 require_once ('lib/Autoloader.php');
-
-?>
\ No newline at end of file
Files elefant-elefant_1_3_9_beta/tests/travis_conf.ini and elefant-elefant_1_3_10_beta/tests/travis_conf.ini are identical
Files elefant-elefant_1_3_9_beta/tests/zombie/admin-login-failure.coffee and elefant-elefant_1_3_10_beta/tests/zombie/admin-login-failure.coffee are identical
Files elefant-elefant_1_3_9_beta/tests/zombie/admin-login-failure.js and elefant-elefant_1_3_10_beta/tests/zombie/admin-login-failure.js are identical
Files elefant-elefant_1_3_9_beta/tests/zombie/admin-login-success.coffee and elefant-elefant_1_3_10_beta/tests/zombie/admin-login-success.coffee are identical
Files elefant-elefant_1_3_9_beta/tests/zombie/admin-login-success.js and elefant-elefant_1_3_10_beta/tests/zombie/admin-login-success.js are identical
Files elefant-elefant_1_3_9_beta/tests/zombie/homepage.coffee and elefant-elefant_1_3_10_beta/tests/zombie/homepage.coffee are identical
Files elefant-elefant_1_3_9_beta/tests/zombie/homepage.js and elefant-elefant_1_3_10_beta/tests/zombie/homepage.js are identical
